function getURIparam(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+name+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(window.location.href);return null==results?"":results[1]}!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);return"function"!==type&&!jQuery.isWindow(obj)&&(!(1!==obj.nodeType||!length)||("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj))}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function detach(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))}function completed(){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())}function dataAttr(elem,key,data){if(void 0===data&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data||"false"!==data&&("null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data)}catch(e){}jQuery.data(elem,key,data)}else data=void 0}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||void 0!==data||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),"object"!=typeof name&&"function"!=typeof name||(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),void 0!==data&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):void 0;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}}function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(null!=condition)return condition?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;index<length;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;index<length;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;i<4;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(val<=0||null==val){if(val=curCSS(elem,name,styles),(val<0||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?jQuery._data(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(support.inlineBlockNeedsLayout&&"inline"!==defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",support.shrinkWrapBlocks()||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType.charAt(0)?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&(elem.defaultView||elem.parentWindow)}var deletedIds=[],slice=deletedIds.slice,concat=deletedIds.concat,push=deletedIds.push,indexOf=deletedIds.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},version="1.11.3",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?num<0?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:deletedIds.sort,splice:deletedIds.splice},jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(support.ownLast)for(key in obj)return hasOwn.call(obj,key);for(key in obj);return void 0===key||hasOwn.call(obj,key)},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;i<length&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;i<length&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(indexOf)return indexOf.call(arr,elem,i);for(len=arr.length,i=i?i<0?Math.max(0,len+i):i:0;i<len;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;)first[i++]=second[j++];if(len!==len)for(;void 0!==second[j];)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;i<length;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},now:function(){return+new Date},support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],nodeType=context.nodeType,"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&documentIsHTML){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=1!==nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;
for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,parent=doc.defaultView,parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler)),documentIsHTML=!isXML(doc),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\f]' msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;i<len;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(void 0===until||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}}),jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingIndex<firingLength;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(index<=firingLength&&firingLength--,index<=firingIndex&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);i<length;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready")));
}}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)};var i,strundefined="undefined";for(i in jQuery(support))break;support.ownLast="0"!==i,support.inlineBlockNeedsLayout=!1,jQuery(function(){var val,div,body,container;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",support.inlineBlockNeedsLayout=val=3===div.offsetWidth,val&&(body.style.zoom=1)),body.removeChild(container))}),function(){var div=document.createElement("div");if(null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}div=null}(),jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return(1===nodeType||9===nodeType)&&(!noData||noData!==!0&&elem.getAttribute("classid")===noData)};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):void 0},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<length;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var input=document.createElement("input"),div=document.createElement("div"),fragment=document.createDocumentFragment();if(div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,input.type="checkbox",input.checked=!0,fragment.appendChild(input),support.appendChecked=input.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue,fragment.appendChild(div),div.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,support.noCloneEvent=!0,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click()),null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}}(),function(){var i,eventName,div=document.createElement("div");for(i in{submit:!0,change:!0,focusin:!0})eventName="on"+i,(support[i+"Bubbles"]=eventName in window)||(div.setAttribute(eventName,"t"),support[i+"Bubbles"]=div.attributes[eventName].expando===!1);div=null}();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===strundefined||e&&jQuery.event.triggered===e.type?void 0:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.namespace_re&&!event.namespace_re.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;i<delegateCount;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.submitBubbles||(jQuery.event.special.submit={setup:function(){return!jQuery.nodeName(this,"form")&&void jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:void 0;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))})},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return!jQuery.nodeName(this,"form")&&void jQuery.event.remove(this,"._submit")}}),support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):void jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type)return event.handleObj.handler.apply(this,arguments)},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);attaches||doc.addEventListener(orig,handler,!0),jQuery._data(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;attaches?jQuery._data(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),jQuery._removeData(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return selector!==!1&&"function"!=typeof selector||(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(support.noCloneEvent&&support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;i<l;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||jQuery.inArray(elem,selection)===-1)&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,deletedIds.push(id))}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):void 0;if("string"==typeof value&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={};!function(){var shrinkWrapBlocksVal;support.shrinkWrapBlocks=function(){if(null!=shrinkWrapBlocksVal)return shrinkWrapBlocksVal;shrinkWrapBlocksVal=!1;var div,body,container;return body=document.getElementsByTagName("body")[0],body&&body.style?(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",div.appendChild(document.createElement("div")).style.width="5px",shrinkWrapBlocksVal=3!==div.offsetWidth),body.removeChild(container),shrinkWrapBlocksVal):void 0}}();var getStyles,curCSS,rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),rposition=/^(top|right|bottom|left)$/;
window.getComputedStyle?(getStyles=function(elem){return elem.ownerDocument.defaultView.opener?elem.ownerDocument.defaultView.getComputedStyle(elem,null):window.getComputedStyle(elem,null)},curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:void 0,computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0===ret?ret:ret+""}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed[name]:void 0,null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),void 0===ret?ret:ret+""||"auto"}),function(){function computeStyleTests(){var div,body,container,contents;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",pixelPositionVal=boxSizingReliableVal=!1,reliableMarginRightVal=!0,window.getComputedStyle&&(pixelPositionVal="1%"!==(window.getComputedStyle(div,null)||{}).top,boxSizingReliableVal="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,contents=div.appendChild(document.createElement("div")),contents.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",contents.style.marginRight=contents.style.width="0",div.style.width="1px",reliableMarginRightVal=!parseFloat((window.getComputedStyle(contents,null)||{}).marginRight),div.removeChild(contents)),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",contents=div.getElementsByTagName("td"),contents[0].style.cssText="margin:0;border:0;padding:0;display:none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight,reliableHiddenOffsetsVal&&(contents[0].style.display="",contents[1].style.display="none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight),body.removeChild(container))}var div,style,a,pixelPositionVal,boxSizingReliableVal,reliableHiddenOffsetsVal,reliableMarginRightVal;div=document.createElement("div"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],style=a&&a.style,style&&(style.cssText="float:left;opacity:.5",support.opacity="0.5"===style.opacity,support.cssFloat=!!style.cssFloat,div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,support.boxSizing=""===style.boxSizing||""===style.MozBoxSizing||""===style.WebkitBoxSizing,jQuery.extend(support,{reliableHiddenOffsets:function(){return null==reliableHiddenOffsetsVal&&computeStyleTests(),reliableHiddenOffsetsVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computeStyleTests(),boxSizingReliableVal},pixelPosition:function(){return null==pixelPositionVal&&computeStyleTests(),pixelPositionVal},reliableMarginRight:function(){return null==reliableMarginRightVal&&computeStyleTests(),reliableMarginRightVal}}))}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),!(hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra)))))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed)return rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed)return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,null!=opt.queue&&opt.queue!==!0||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input,div,select,a,opt;div=document.createElement("div"),div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px",support.getSetAttribute="t"!==div.className,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value}();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&(support.optDisabled?!option.disabled:null===option.getAttribute("disabled"))&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)if(option=options[i],jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0)try{option.selected=optionSet=!0}catch(_){option.scrollHeight}else option.selected=!1;return optionSet||(elem.selectedIndex=-1),options}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}:function(elem,name,isXML){if(!isXML)return elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?void(elem.defaultValue=value):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name))return value}},attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;if(!isXML)return(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);if(ret&&ret.specified)return ret.value},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""!==value&&value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(""===value)return elem.setAttribute(name,"auto"),value}}})),support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||void 0},set:function(elem,value){return elem.style.cssText=value+""}});var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=void 0,delete this[name]}catch(e){}})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),support.enctype||(jQuery.propFix.enctype="encoding");var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];i<len;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];i<len;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else type!==strundefined&&"boolean"!==type||(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;i<l;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/,rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data+"");var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){return requireNonComma&&comma&&(depth=0),0===depth?token:(requireNonComma=open||comma,depth+=!close-!open,"")}))?Function("return "+str)():jQuery.error("Invalid JSON: "+data)},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=void 0}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(state<2)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),
s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(state<2))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!support.reliableHiddenOffsets()&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var key in xhrCallbacks)xhrCallbacks[key](void 0,!0)}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)void 0!==headers[i]&&xhr.setRequestHeader(i,headers[i]+"");xhr.send(options.hasContent&&options.data||null),callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||4===xhr.readyState))if(delete xhrCallbacks[id],callback=void 0,xhr.onreadystatechange=jQuery.noop,isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!options.isLocal||options.crossDomain?1223===status&&(status=204):status=responses.text?200:404}responses&&complete(status,statusText,responses,xhr.getAllResponseHeaders())},options.async?4===xhr.readyState?setTimeout(callback):xhr.onreadystatechange=xhrCallbacks[id]=callback:callback()},abort:function(){callback&&callback(void 0,!0)}}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(void 0,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=jQuery.trim(url.slice(off,url.length)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:void(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();return"area"===nodeName?(map=element.parentNode,mapName=map.name,!(!element.href||!mapName||"map"!==map.nodeName.toLowerCase())&&(img=$("img[usemap='#"+mapName+"']")[0],!!img&&visible(img))):(/^(input|select|textarea|button|object)$/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}function datepicker_getZindex(elem){for(var position,value;elem.length&&elem[0]!==document;){if(position=elem.css("position"),("absolute"===position||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0}function Datepicker(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.regional.en=$.extend(!0,{},this.regional[""]),this.regional["en-US"]=$.extend(!0,{},this.regional.en),this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&$(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(selector,"mouseover",datepicker_handleMouseover)}function datepicker_handleMouseover(){$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&$(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&$(this).addClass("ui-datepicker-next-hover"))}function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props)null==props[name]&&(target[name]=props[name]);return target}function spinner_modifier(fn){return function(){var previous=this.element.val();fn.apply(this,arguments),this._refresh(),previous!==this.element.val()&&this._trigger("change")}}$.ui=$.ui||{},$.extend($.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent="absolute"===position,overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);return(!excludeStaticParent||"static"!==parent.css("position"))&&overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(this[0].ownerDocument||document)},uniqueId:function(){var uuid=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++uuid)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(i,name){function reduce(elem,size,border,margin){return $.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0,border&&(size-=parseFloat($.css(elem,"border"+this+"Width"))||0),margin&&(size-=parseFloat($.css(elem,"margin"+this))||0)}),size}var side="Width"===name?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+name]=function(size){return void 0===size?orig["inner"+name].call(this):this.each(function(){$(this).css(type,reduce(this,size)+"px")})},$.fn["outer"+name]=function(size,margin){return"number"!=typeof size?orig["outer"+name].call(this,size):this.each(function(){$(this).css(type,reduce(this,size,!0,margin)+"px")})}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=function(removeData){return function(key){return arguments.length?removeData.call(this,$.camelCase(key)):removeData.call(this)}}($.fn.removeData)),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.fn.extend({focus:function(orig){return function(delay,fn){return"number"==typeof delay?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus(),fn&&fn.call(elem)},delay)}):orig.apply(this,arguments)}}($.fn.focus),disableSelection:function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".ui-disableSelection",function(event){event.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(zIndex){if(void 0!==zIndex)return this.css("zIndex",zIndex);if(this.length)for(var position,value,elem=$(this[0]);elem.length&&elem[0]!==document;){if(position=elem.css("position"),("absolute"===position||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0}}),$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set)proto.plugins[i]=proto.plugins[i]||[],proto.plugins[i].push([option,set[i]])},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(set&&(allowDisconnected||instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType))for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}};var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;null!=(elem=elems[i]);i++)try{events=$._data(elem,"events"),events&&events.remove&&$(elem).triggerHandler("remove")}catch(e){}orig(elems)}}($.cleanData),$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];return name=name.split(".")[1],fullName=namespace+"-"+name,prototype||(prototype=base,base=$.Widget),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){return this._createWidget?void(arguments.length&&this._createWidget(options,element)):new constructor(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),basePrototype=new base,basePrototype.options=$.widget.extend({},basePrototype.options),$.each(prototype,function(prop,value){return $.isFunction(value)?void(proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}()):void(proxiedPrototype[prop]=value)}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor),constructor},$.widget.extend=function(target){for(var key,value,input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length;inputIndex<inputLength;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&void 0!==value&&($.isPlainObject(value)?target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):target[key]=value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=widget_slice.call(arguments,1),returnValue=this;return isMethodCall?this.each(function(){var methodValue,instance=$.data(this,fullName);return"instance"===options?(returnValue=instance,!1):instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args),methodValue!==instance&&void 0!==methodValue?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0):$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}):(args.length&&(options=$.widget.extend.apply(null,[options].concat(args))),this.each(function(){var instance=$.data(this,fullName);instance?(instance.option(options||{}),instance._init&&instance._init()):$.data(this,fullName,new object(options,this))})),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=widget_uuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},parts=key.split("."),key=parts.shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),1===arguments.length)return void 0===curOption[key]?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return void 0===this.options[key]?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return this.options[key]=value,"disabled"===key&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!value),value&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){if(suppressDisabledCheck||instance.options.disabled!==!0&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.delegate(selector,eventName,handlerProxy):element.bind(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.unbind(eventName).undelegate(eventName),this.bindings=$(this.bindings.not(element).get()),this.focusable=$(this.focusable.not(element).get()),this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){function handlerProxy(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),
!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===!1||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?options===!0||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;options=options||{},"number"==typeof options&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()})}});var mouseHandled=($.widget,!1);$(document).mouseup(function(){mouseHandled=!1});$.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(!0===$.data(event.target,that.widgetName+".preventClickEvent"))return $.removeData(event.target,that.widgetName+".preventClickEvent"),event.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(event),this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel=!("string"!=typeof this.options.cancel||!event.target.nodeName)&&$(event.target).closest(this.options.cancel).length;return!(btnIsLeft&&!elIsCancel&&this._mouseCapture(event))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=this._mouseStart(event)!==!1,!this._mouseStarted)?(event.preventDefault(),!0):(!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(event){return that._mouseMove(event)},this._mouseUpDelegate=function(event){return that._mouseUp(event)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),event.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button)return this._mouseUp(event);if(!event.which)return this._mouseUp(event)}return(event.which||event.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(event),event.preventDefault()):(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==!1,this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)),!this._mouseStarted)},_mouseUp:function(event){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(event)),mouseHandled=!1,!1},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});!function(){function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];return 9===raw.nodeType?{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}:$.isWindow(raw)?{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}:raw.preventDefault?{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}:{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}$.ui=$.ui||{};var cachedScrollbarWidth,supportsOffsetFractions,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;$.position={scrollbarWidth:function(){if(void 0!==cachedScrollbarWidth)return cachedScrollbarWidth;var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];return $("body").append(div),w1=innerDiv.offsetWidth,div.css("overflow","scroll"),w2=innerDiv.offsetWidth,w1===w2&&(w2=div[0].clientWidth),div.remove(),cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX="scroll"===overflowX||"auto"===overflowX&&within.width<within.element[0].scrollWidth,hasOverflowY="scroll"===overflowY||"auto"===overflowY&&within.height<within.element[0].scrollHeight;return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&9===withinElement[0].nodeType;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow||isDocument?withinElement.width():withinElement.outerWidth(),height:isWindow||isDocument?withinElement.height():withinElement.outerHeight()}}},$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};return dimensions=getDimensions(target),target[0].preventDefault&&(options.at="left top"),targetWidth=dimensions.width,targetHeight=dimensions.height,targetOffset=dimensions.offset,basePosition=$.extend({},targetOffset),$.each(["my","at"],function(){var horizontalOffset,verticalOffset,pos=(options[this]||"").split(" ");1===pos.length&&(pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]),pos[0]=rhorizontal.test(pos[0])?pos[0]:"center",pos[1]=rvertical.test(pos[1])?pos[1]:"center",horizontalOffset=roffset.exec(pos[0]),verticalOffset=roffset.exec(pos[1]),offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0],options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]}),1===collision.length&&(collision[1]=collision[0]),"right"===options.at[0]?basePosition.left+=targetWidth:"center"===options.at[0]&&(basePosition.left+=targetWidth/2),"bottom"===options.at[1]?basePosition.top+=targetHeight:"center"===options.at[1]&&(basePosition.top+=targetHeight/2),atOffset=getOffsets(offsets.at,targetWidth,targetHeight),basePosition.left+=atOffset[0],basePosition.top+=atOffset[1],this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());"right"===options.my[0]?position.left-=elemWidth:"center"===options.my[0]&&(position.left-=elemWidth/2),"bottom"===options.my[1]?position.top-=elemHeight:"center"===options.my[1]&&(position.top-=elemHeight/2),position.left+=myOffset[0],position.top+=myOffset[1],supportsOffsetFractions||(position.left=round(position.left),position.top=round(position.top)),collisionPosition={marginLeft:marginLeft,marginTop:marginTop},$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}),options.using&&(using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};targetWidth<elemWidth&&abs(left+right)<targetWidth&&(feedback.horizontal="center"),targetHeight<elemHeight&&abs(top+bottom)<targetHeight&&(feedback.vertical="middle"),max(abs(left),abs(right))>max(abs(top),abs(bottom))?feedback.important="horizontal":feedback.important="vertical",options.using.call(this,props,feedback)}),elem.offset($.extend(position,{using:using}))})},$.ui.position={fit:{left:function(position,data){var newOverRight,within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset;data.collisionWidth>outerWidth?overLeft>0&&overRight<=0?(newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset,position.left+=overLeft-newOverRight):overRight>0&&overLeft<=0?position.left=withinOffset:overLeft>overRight?position.left=withinOffset+outerWidth-data.collisionWidth:position.left=withinOffset:overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=max(position.left-collisionPosLeft,position.left)},top:function(position,data){var newOverBottom,within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset;data.collisionHeight>outerHeight?overTop>0&&overBottom<=0?(newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset,position.top+=overTop-newOverBottom):overBottom>0&&overTop<=0?position.top=withinOffset:overTop>overBottom?position.top=withinOffset+outerHeight-data.collisionHeight:position.top=withinOffset:overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){var newOverRight,newOverLeft,within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset="left"===data.my[0]?-data.elemWidth:"right"===data.my[0]?data.elemWidth:0,atOffset="left"===data.at[0]?data.targetWidth:"right"===data.at[0]?-data.targetWidth:0,offset=-2*data.offset[0];overLeft<0?(newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset,(newOverRight<0||newOverRight<abs(overLeft))&&(position.left+=myOffset+atOffset+offset)):overRight>0&&(newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft,(newOverLeft>0||abs(newOverLeft)<overRight)&&(position.left+=myOffset+atOffset+offset))},top:function(position,data){var newOverTop,newOverBottom,within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top="top"===data.my[1],myOffset=top?-data.elemHeight:"bottom"===data.my[1]?data.elemHeight:0,atOffset="top"===data.at[1]?data.targetHeight:"bottom"===data.at[1]?-data.targetHeight:0,offset=-2*data.offset[1];overTop<0?(newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset,(newOverBottom<0||newOverBottom<abs(overTop))&&(position.top+=myOffset+atOffset+offset)):overBottom>0&&(newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop,(newOverTop>0||abs(newOverTop)<overBottom)&&(position.top+=myOffset+atOffset+offset))}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}},function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body"),testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},body&&$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});for(i in testElementStyle)testElement.style[i]=testElementStyle[i];testElement.appendChild(div),testElementParent=body||document.documentElement,testElementParent.insertBefore(testElement,testElementParent.firstChild),div.style.cssText="position: absolute; left: 10.7432222px;",offsetLeft=$(div).offset().left,supportsOffsetFractions=offsetLeft>10&&offsetLeft<11,testElement.innerHTML="",testElementParent.removeChild(testElement)}()}();$.ui.position,$.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var options=this.options;this.prevShow=this.prevHide=$(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),options.collapsible||options.active!==!1&&null!=options.active||(options.active=0),this._processPanels(),options.active<0&&(options.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$()}},_createIcons:function(){var icons=this.options.icons;icons&&($("<span>").addClass("ui-accordion-header-icon ui-icon "+icons.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(icons.header).addClass(icons.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var contents;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),contents=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&contents.css("height","")},_setOption:function(key,value){return"active"===key?void this._activate(value):("event"===key&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(value)),this._super(key,value),"collapsible"!==key||value||this.options.active!==!1||this._activate(0),"icons"===key&&(this._destroyIcons(),value&&this._createIcons()),void("disabled"===key&&(this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!value))))},_keydown:function(event){if(!event.altKey&&!event.ctrlKey){var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=!1;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1]}toFocus&&($(event.target).attr("tabIndex",-1),$(toFocus).attr("tabIndex",0),toFocus.focus(),event.preventDefault())}},_panelKeyDown:function(event){event.keyCode===$.ui.keyCode.UP&&event.ctrlKey&&$(event.currentTarget).prev().focus()},refresh:function(){var options=this.options;this._processPanels(),options.active===!1&&options.collapsible===!0||!this.headers.length?(options.active=!1,this.active=$()):options.active===!1?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(options.active=!1,this.active=$()):this._activate(Math.max(0,options.active-1)):options.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var prevHeaders=this.headers,prevPanels=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),prevPanels&&(this._off(prevHeaders.not(this.headers)),this._off(prevPanels.not(this.panels)))},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent();this.active=this._findActive(options.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var header=$(this),headerId=header.uniqueId().attr("id"),panel=header.next(),panelId=panel.uniqueId().attr("id");header.attr("aria-controls",panelId),panel.attr("aria-labelledby",headerId)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(options.event),"fill"===heightStyle?(maxHeight=parent.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.headers.each(function(){maxHeight-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).css("height","").height())}).height(maxHeight))},_activate:function(index){var active=this._findActive(index)[0];active!==this.active[0]&&(active=active||this.active[0],this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop}))},_findActive:function(selector){return"number"==typeof selector?this.headers.eq(selector):$()},_setupEvents:function(event){var events={keydown:"_keydown"};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,events),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(event){var options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault(),clickedIsActive&&!options.collapsible||this._trigger("beforeActivate",event,eventData)===!1||(options.active=!collapsing&&this.headers.index(clicked),this.active=clickedIsActive?$():clicked,this._toggle(eventData),active.removeClass("ui-accordion-header-active ui-state-active"),options.icons&&active.children(".ui-accordion-header-icon").removeClass(options.icons.activeHeader).addClass(options.icons.header),clickedIsActive||(clicked.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),options.icons&&clicked.children(".ui-accordion-header-icon").removeClass(options.icons.header).addClass(options.icons.activeHeader),clicked.next().addClass("ui-accordion-content-active")))},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=toShow,this.prevHide=toHide,this.options.animate?this._animate(toShow,toHide,data):(toHide.hide(),toShow.show(),this._toggleComplete(data)),toHide.attr({"aria-hidden":"true"}),toHide.prev().attr({"aria-selected":"false","aria-expanded":"false"}),toShow.length&&toHide.length?toHide.prev().attr({tabIndex:-1,"aria-expanded":"false"}):toShow.length&&this.headers.filter(function(){return 0===parseInt($(this).attr("tabIndex"),10)}).attr("tabIndex",-1),toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,boxSizing=toShow.css("box-sizing"),down=toShow.length&&(!toHide.length||toShow.index()<toHide.index()),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data)};return"number"==typeof options&&(duration=options),"string"==typeof options&&(easing=options),easing=easing||options.easing||animate.easing,duration=duration||options.duration||animate.duration,toHide.length?toShow.length?(total=toShow.show().outerHeight(),toHide.animate(this.hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now)}}),void toShow.hide().animate(this.showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now),"height"!==fx.prop?"content-box"===boxSizing&&(adjust+=fx.now):"content"!==that.options.heightStyle&&(fx.now=Math.round(total-toHide.outerHeight()-adjust),adjust=0)}})):toHide.animate(this.hideProps,duration,easing,complete):toShow.animate(this.showProps,duration,easing,complete)},_toggleComplete:function(data){var toHide=data.oldPanel;toHide.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),toHide.length&&(toHide.parent()[0].className=toHide.parent()[0].className),this._trigger("activate",null,data)}}),$.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(event){event.preventDefault()},"click .ui-menu-item":function(event){var target=$(event.target);!this.mouseHandled&&target.not(".ui-state-disabled").length&&(this.select(event),event.isPropagationStopped()||(this.mouseHandled=!0),target.has(".ui-menu").length?this.expand(event):!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(event){if(!this.previousFilter){var target=$(event.currentTarget);target.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(event,target)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);keepActiveItem||this.focus(event,item)},blur:function(event){this._delay(function(){$.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(event)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(event){this._closeOnDocumentClick(event)&&this.collapseAll(event),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var elem=$(this);elem.data("ui-menu-submenu-carat")&&elem.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(event){var match,prev,character,skip,preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(event);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=!1,prev=this.previousFilter||"",character=String.fromCharCode(event.keyCode),skip=!1,clearTimeout(this.filterTimer),character===prev?skip=!0:character=prev+character,match=this._filterMenuItems(character),match=skip&&match.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):match,match.length||(character=String.fromCharCode(event.keyCode),match=this._filterMenuItems(character)),match.length?(this.focus(event,match),this.previousFilter=character,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}preventDefault&&event.preventDefault()},_activate:function(event){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(event):this.select(event))},refresh:function(){var menus,items,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),submenus.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.parent(),submenuCarat=$("<span>").addClass("ui-menu-icon ui-icon "+icon).data("ui-menu-submenu-carat",!0);item.attr("aria-haspopup","true").prepend(submenuCarat),menu.attr("aria-labelledby",item.attr("id"))}),menus=submenus.add(this.element),items=menus.find(this.options.items),items.not(".ui-menu-item").each(function(){var item=$(this);that._isDivider(item)&&item.addClass("ui-widget-content ui-menu-divider")}),items.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),items.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){"icons"===key&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(value.submenu),"disabled"===key&&this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value),this._super(key,value)},focus:function(event,item){var nested,focused;this.blur(event,event&&"focus"===event.type),this._scrollIntoView(item),this.active=item.first(),focused=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",focused.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),event&&"keydown"===event.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),nested=item.children(".ui-menu"),nested.length&&event&&/^mouse/.test(event.type)&&this._startOpening(nested),this.activeMenu=item.parent(),this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;this._hasScroll()&&(borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop,scroll=this.activeMenu.scrollTop(),elementHeight=this.activeMenu.height(),itemHeight=item.outerHeight(),offset<0?this.activeMenu.scrollTop(scroll+offset):offset+itemHeight>elementHeight&&this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight))},blur:function(event,fromFocus){fromFocus||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",event,{item:this.active}))},_startOpening:function(submenu){clearTimeout(this.timer),"true"===submenu.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(submenu)},this.delay))},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true"),submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer),this.timer=this._delay(function(){
var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));currentMenu.length||(currentMenu=this.element),this._close(currentMenu),this.blur(event),this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){startMenu||(startMenu=this.active?this.active.parent():this.element),startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text())},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);newItem&&newItem.length&&(this._close(),this.focus(event,newItem))},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();newItem&&newItem.length&&(this._open(newItem.parent()),this._delay(function(){this.focus(event,newItem)}))},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,filter,event){var next;this.active&&(next="first"===direction||"last"===direction?this.active["first"===direction?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[direction+"All"](".ui-menu-item").eq(0)),next&&next.length&&this.active||(next=this.activeMenu.find(this.options.items)[filter]()),this.focus(event,next)},nextPage:function(event){var item,base,height;return this.active?void(this.isLastItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base-height<0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(event)},previousPage:function(event){var item,base,height;return this.active?void(this.isFirstItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base+height>0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items).first()))):void this.next(event)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(event,!0),this._trigger("select",event,ui)},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return regex.test($.trim($(this).text()))})}});$.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea="textarea"===nodeName,isInput="input"===nodeName;this.isMultiLine=!!isTextarea||!isInput&&this.element.prop("isContentEditable"),this.valueMethod=this.element[isTextarea||isInput?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly"))return suppressKeyPress=!0,suppressInput=!0,void(suppressKeyPressRepeat=!0);suppressKeyPress=!1,suppressInput=!1,suppressKeyPressRepeat=!1;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=!0,this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=!0,this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=!0,this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=!0,this._keyEvent("next",event);break;case keyCode.ENTER:this.menu.active&&(suppressKeyPress=!0,event.preventDefault(),this.menu.select(event));break;case keyCode.TAB:this.menu.active&&this.menu.select(event);break;case keyCode.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(event),event.preventDefault());break;default:suppressKeyPressRepeat=!0,this._searchTimeout(event)}},keypress:function(event){if(suppressKeyPress)return suppressKeyPress=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||event.preventDefault());if(!suppressKeyPressRepeat){var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event)}}},input:function(event){return suppressInput?(suppressInput=!1,void event.preventDefault()):void this._searchTimeout(event)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(event){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(event),void this._change(event))}}),this._initSource(),this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(event){event.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var menuElement=this.menu.element[0];$(event.target).closest(".ui-menu-item").length||this._delay(function(){var that=this;this.document.one("mousedown",function(event){event.target===that.element[0]||event.target===menuElement||$.contains(menuElement,event.target)||that.close()})})},menufocus:function(event,ui){var label,item;return this.isNewMenu&&(this.isNewMenu=!1,event.originalEvent&&/^mouse/.test(event.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)})):(item=ui.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",event,{item:item})&&event.originalEvent&&/^key/.test(event.originalEvent.type)&&this._value(item.value),label=ui.item.attr("aria-label")||item.value,void(label&&$.trim(label).length&&(this.liveRegion.children().hide(),$("<div>").text(label).appendTo(this.liveRegion))))},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=previous,this._delay(function(){this.previous=previous,this.selectedItem=item})),!1!==this._trigger("select",event,{item:item})&&this._value(item.value),this.term=this._value(),this.close(event),this.selectedItem=item}}),this.liveRegion=$("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value),"source"===key&&this._initSource(),"appendTo"===key&&this.menu.element.appendTo(this._appendTo()),"disabled"===key&&value&&this.xhr&&this.xhr.abort()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front")),element.length||(element=this.document[0].body),element},_initSource:function(){var array,url,that=this;$.isArray(this.options.source)?(array=this.options.source,this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}):"string"==typeof this.options.source?(url=this.options.source,this.source=function(request,response){that.xhr&&that.xhr.abort(),that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}):this.source=this.options.source},_searchTimeout:function(event){clearTimeout(this.searching),this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;equalValues&&(!equalValues||menuVisible||modifierKey)||(this.selectedItem=null,this.search(null,event))},this.options.delay)},search:function(value,event){return value=null!=value?value:this._value(),this.term=this._value(),value.length<this.options.minLength?this.close(event):this._trigger("search",event)!==!1?this._search(value):void 0},_search:function(value){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:value},this._response())},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){index===this.requestIndex&&this.__response(content),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(content){content&&(content=this._normalize(content)),this._trigger("response",null,{content:content}),!this.options.disabled&&content&&content.length&&!this.cancelSearch?(this._suggest(content),this._trigger("open")):this._close()},close:function(event){this.cancelSearch=!0,this._close(event)},_close:function(event){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",event))},_change:function(event){this.previous!==this._value()&&this._trigger("change",event,{item:this.selectedItem})},_normalize:function(items){return items.length&&items[0].label&&items[0].value?items:$.map(items,function(item){return"string"==typeof item?{label:item,value:item}:$.extend({},item,{label:item.label||item.value,value:item.value||item.label})})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items),this.isNewMenu=!0,this.menu.refresh(),ul.show(),this._resizeMenu(),ul.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").text(item.label).appendTo(ul)},_move:function(direction,event){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[direction](event):void this.search(null,event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(keyEvent,event),event.preventDefault())}}),$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments),this.options.disabled||this.cancelSearch||(message=content&&content.length?this.options.messages.results(content.length):this.options.messages.noResults,this.liveRegion.children().hide(),$("<div>").text(message).appendTo(this.liveRegion))}});var lastActive,baseClasses=($.ui.autocomplete,"ui-button ui-widget ui-state-default ui-corner-all"),typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",formResetHandler=function(){var form=$(this);setTimeout(function(){form.find(":ui-button").button("refresh")},1)},radioGroup=function(radio){var name=radio.name,form=radio.form,radios=$([]);return name&&(name=name.replace(/'/g,"\\'"),radios=form?$(form).find("[name='"+name+"'][type=radio]"):$("[name='"+name+"'][type=radio]",radio.ownerDocument).filter(function(){return!this.form})),radios};$.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,formResetHandler),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var that=this,options=this.options,toggleButton="checkbox"===this.type||"radio"===this.type,activeClass=toggleButton?"":"ui-state-active";null===options.label&&(options.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(baseClasses).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){options.disabled||this===lastActive&&$(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){options.disabled||$(this).removeClass(activeClass)}).bind("click"+this.eventNamespace,function(event){options.disabled&&(event.preventDefault(),event.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),toggleButton&&this.element.bind("change"+this.eventNamespace,function(){that.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled)return!1}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled)return!1;$(this).addClass("ui-state-active"),that.buttonElement.attr("aria-pressed","true");var radio=that.element[0];radioGroup(radio).not(radio).map(function(){return $(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!options.disabled&&($(this).addClass("ui-state-active"),lastActive=this,void that.document.one("mouseup",function(){lastActive=null}))}).bind("mouseup"+this.eventNamespace,function(){return!options.disabled&&void $(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(event){return!options.disabled&&void(event.keyCode!==$.ui.keyCode.SPACE&&event.keyCode!==$.ui.keyCode.ENTER||$(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(event){event.keyCode===$.ui.keyCode.SPACE&&$(this).click()})),this._setOption("disabled",options.disabled),this._resetButton()},_determineButtonType:function(){var ancestor,labelSelector,checked;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(ancestor=this.element.parents().last(),labelSelector="label[for='"+this.element.attr("id")+"']",this.buttonElement=ancestor.find(labelSelector),this.buttonElement.length||(ancestor=ancestor.length?ancestor.siblings():this.element.siblings(),this.buttonElement=ancestor.filter(labelSelector),this.buttonElement.length||(this.buttonElement=ancestor.find(labelSelector))),this.element.addClass("ui-helper-hidden-accessible"),checked=this.element.is(":checked"),checked&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",checked)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(baseClasses+" ui-state-active "+typeClasses).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(key,value){return this._super(key,value),"disabled"===key?(this.widget().toggleClass("ui-state-disabled",!!value),this.element.prop("disabled",!!value),void(value&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var isDisabled=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");isDisabled!==this.options.disabled&&this._setOption("disabled",isDisabled),"radio"===this.type?radioGroup(this.element[0]).each(function(){$(this).is(":checked")?$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var buttonElement=this.buttonElement.removeClass(typeClasses),buttonText=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(buttonElement.empty()).text(),icons=this.options.icons,multipleIcons=icons.primary&&icons.secondary,buttonClasses=[];icons.primary||icons.secondary?(this.options.text&&buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":icons.primary?"-primary":"-secondary")),icons.primary&&buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>"),icons.secondary&&buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>"),this.options.text||(buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||buttonElement.attr("title",$.trim(buttonText)))):buttonClasses.push("ui-button-text-only"),buttonElement.addClass(buttonClasses.join(" "))}}),$.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(key,value){"disabled"===key&&this.buttons.button("option",key,value),this._super(key,value)},refresh:function(){var rtl="rtl"===this.element.css("direction"),allButtons=this.element.find(this.options.items),existingButtons=allButtons.filter(":ui-button");allButtons.not(":ui-button").button(),existingButtons.button("refresh"),this.buttons=allButtons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(rtl?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(rtl?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}});$.ui.button;$.extend($.ui,{datepicker:{version:"1.11.4"}});var datepicker_instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){return datepicker_extendRemove(this._defaults,settings||{}),this},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase(),inline="div"===nodeName||"span"===nodeName,target.id||(this.uuid+=1,target.id="dp"+this.uuid),inst=this._newInst($(target),inline),inst.settings=$.extend({},settings||{}),"input"===nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:inline?datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]),inst.trigger=$([]),input.hasClass(this.markerClassName)||(this._attachments(input,inst),input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(inst),$.data(target,"datepicker",inst),inst.settings.disabled&&this._disableDatepicker(target))},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");inst.append&&inst.append.remove(),appendText&&(inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>"),input[isRTL?"before":"after"](inst.append)),input.unbind("focus",this._showDatepicker),inst.trigger&&inst.trigger.remove(),showOn=this._get(inst,"showOn"),"focus"!==showOn&&"both"!==showOn||input.focus(this._showDatepicker),"button"!==showOn&&"both"!==showOn||(buttonText=this._get(inst,"buttonText"),buttonImage=this._get(inst,"buttonImage"),inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(buttonImage?$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText}):buttonText)),input[isRTL?"before":"after"](inst.trigger),inst.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(input[0])):$.datepicker._showDatepicker(input[0]),!1}))},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,11,20),dateFormat=this._get(inst,"dateFormat");dateFormat.match(/[DM]/)&&(findMax=function(names){for(max=0,maxI=0,i=0;i<names.length;i++)names[i].length>max&&(max=names[i].length,maxI=i);return maxI},date.setMonth(findMax(this._get(inst,dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))),date.setDate(findMax(this._get(inst,dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())),inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);divSpan.hasClass(this.markerClassName)||(divSpan.addClass(this.markerClassName).append(inst.dpDiv),$.data(target,"datepicker",inst),this._setDate(inst,this._getDefaultDate(inst),!0),this._updateDatepicker(inst),this._updateAlternate(inst),inst.settings.disabled&&this._disableDatepicker(target),inst.dpDiv.css("display","block"))},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;return inst||(this.uuid+=1,id="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),inst=this._dialogInst=this._newInst(this._dialogInput,!1),inst.settings={},$.data(this._dialogInput[0],"datepicker",inst)),datepicker_extendRemove(inst.settings,settings||{}),date=date&&date.constructor===Date?this._formatDate(inst,date):date,this._dialogInput.val(date),this._pos=pos?pos.length?pos:[pos.pageX,pos.pageY]:null,this._pos||(browserWidth=document.documentElement.clientWidth,browserHeight=document.documentElement.clientHeight,scrollX=document.documentElement.scrollLeft||document.body.scrollLeft,scrollY=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[browserWidth/2-100+scrollX,browserHeight/2-150+scrollY]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),inst.settings.onSelect=onSelect,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],"datepicker",inst),this},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),$.removeData(target,"datepicker"),"input"===nodeName?(inst.append.remove(),inst.trigger.remove(),$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==nodeName&&"span"!==nodeName||$target.removeClass(this.markerClassName).empty(),datepicker_instActive===inst&&(datepicker_instActive=null))},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!1,inst.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==nodeName&&"span"!==nodeName||(inline=$target.children("."+this._inlineClass),inline.children().removeClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}))},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!0,inst.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==nodeName&&"span"!==nodeName||(inline=$target.children("."+this._inlineClass),inline.children().addClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}),this._disabledInputs[this._disabledInputs.length]=target)},_isDisabledDatepicker:function(target){if(!target)return!1;for(var i=0;i<this._disabledInputs.length;i++)if(this._disabledInputs[i]===target)return!0;return!1},_getInst:function(target){try{return $.data(target,"datepicker")}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);return 2===arguments.length&&"string"==typeof name?"defaults"===name?$.extend({},$.datepicker._defaults):inst?"all"===name?$.extend({},inst.settings):this._get(inst,name):null:(settings=name||{},"string"==typeof name&&(settings={},settings[name]=value),void(inst&&(this._curInst===inst&&this._hideDatepicker(),date=this._getDateDatepicker(target,!0),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),datepicker_extendRemove(inst.settings,settings),null!==minDate&&void 0!==settings.dateFormat&&void 0===settings.minDate&&(inst.settings.minDate=this._formatDate(inst,minDate)),null!==maxDate&&void 0!==settings.dateFormat&&void 0===settings.maxDate&&(inst.settings.maxDate=this._formatDate(inst,maxDate)),"disabled"in settings&&(settings.disabled?this._disableDatepicker(target):this._enableDatepicker(target)),this._attachments($(target),inst),this._autoSize(inst),this._setDate(inst,date),this._updateAlternate(inst),this._updateDatepicker(inst))))},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);inst&&this._updateDatepicker(inst)},_setDateDatepicker:function(target,date){var inst=this._getInst(target);inst&&(this._setDate(inst,date),this._updateDatepicker(inst),this._updateAlternate(inst))},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);return inst&&!inst.inline&&this._setDateFromField(inst,noDefault),inst?this._getDate(inst):null},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=!0,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");if(inst._keyEvent=!0,$.datepicker._datepickerShowing)switch(event.keyCode){case 9:$.datepicker._hideDatepicker(),handled=!1;break;case 13:return sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv),sel[0]&&$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]),onSelect=$.datepicker._get(inst,"onSelect"),onSelect?(dateStr=$.datepicker._formatDate(inst),onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 35:(event.ctrlKey||event.metaKey)&&$.datepicker._clearDate(event.target),handled=event.ctrlKey||event.metaKey;break;case 36:(event.ctrlKey||event.metaKey)&&$.datepicker._gotoToday(event.target),handled=event.ctrlKey||event.metaKey;break;case 37:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?1:-1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 38:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,-7,"D"),handled=event.ctrlKey||event.metaKey;break;case 39:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?-1:1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 40:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,7,"D"),handled=event.ctrlKey||event.metaKey;break;default:handled=!1}else 36===event.keyCode&&event.ctrlKey?$.datepicker._showDatepicker(this):handled=!1;handled&&(event.preventDefault(),event.stopPropagation())},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput"))return chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),chr=String.fromCharCode(null==event.charCode?event.keyCode:event.charCode),event.ctrlKey||event.metaKey||chr<" "||!chars||chars.indexOf(chr)>-1},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal)try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),inst.input?inst.input.val():null,$.datepicker._getFormatConfig(inst)),
date&&($.datepicker._setDateFromField(inst),$.datepicker._updateAlternate(inst),$.datepicker._updateDatepicker(inst))}catch(err){}return!0},_showDatepicker:function(input){if(input=input.target||input,"input"!==input.nodeName.toLowerCase()&&(input=$("input",input.parentNode)[0]),!$.datepicker._isDisabledDatepicker(input)&&$.datepicker._lastInput!==input){var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input),$.datepicker._curInst&&$.datepicker._curInst!==inst&&($.datepicker._curInst.dpDiv.stop(!0,!0),inst&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0])),beforeShow=$.datepicker._get(inst,"beforeShow"),beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{},beforeShowSettings!==!1&&(datepicker_extendRemove(inst.settings,beforeShowSettings),inst.lastVal=null,$.datepicker._lastInput=input,$.datepicker._setDateFromField(inst),$.datepicker._inDialog&&(input.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(input),$.datepicker._pos[1]+=input.offsetHeight),isFixed=!1,$(input).parents().each(function(){return isFixed|="fixed"===$(this).css("position"),!isFixed}),offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]},$.datepicker._pos=null,inst.dpDiv.empty(),inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(inst),offset=$.datepicker._checkOffset(inst,offset,isFixed),inst.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":isFixed?"fixed":"absolute",display:"none",left:offset.left+"px",top:offset.top+"px"}),inst.inline||(showAnim=$.datepicker._get(inst,"showAnim"),duration=$.datepicker._get(inst,"duration"),inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects.effect[showAnim]?inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration):inst.dpDiv[showAnim||"show"](showAnim?duration:null),$.datepicker._shouldFocusInput(inst)&&inst.input.focus(),$.datepicker._curInst=inst))}},_updateDatepicker:function(inst){this.maxRows=4,datepicker_instActive=inst,inst.dpDiv.empty().append(this._generateHTML(inst)),this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],width=17,activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");activeCell.length>0&&datepicker_handleMouseover.apply(activeCell.get(0)),inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),cols>1&&inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",width*cols+"em"),inst.dpDiv[(1!==numMonths[0]||1!==numMonths[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)&&inst.input.focus(),inst.yearshtml&&(origyearshtml=inst.yearshtml,setTimeout(function(){origyearshtml===inst.yearshtml&&inst.yearshtml&&inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml),origyearshtml=inst.yearshtml=null},0))},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus")},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());return offset.left-=this._get(inst,"isRTL")?dpWidth-inputWidth:0,offset.left-=isFixed&&offset.left===inst.input.offset().left?$(document).scrollLeft():0,offset.top-=isFixed&&offset.top===inst.input.offset().top+inputHeight?$(document).scrollTop():0,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight):0),offset},_findPos:function(obj){for(var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");obj&&("hidden"===obj.type||1!==obj.nodeType||$.expr.filters.hidden(obj));)obj=obj[isRTL?"previousSibling":"nextSibling"];return position=$(obj).offset(),[position.left,position.top]},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;!inst||input&&inst!==$.data(input,"datepicker")||this._datepickerShowing&&(showAnim=this._get(inst,"showAnim"),duration=this._get(inst,"duration"),postProcess=function(){$.datepicker._tidyDialog(inst)},$.effects&&($.effects.effect[showAnim]||$.effects[showAnim])?inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess):inst.dpDiv["slideDown"===showAnim?"slideUp":"fadeIn"===showAnim?"fadeOut":"hide"](showAnim?duration:null,postProcess),showAnim||postProcess(),this._datepickerShowing=!1,onClose=this._get(inst,"onClose"),onClose&&onClose.apply(inst.input?inst.input[0]:null,[inst.input?inst.input.val():"",inst]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if($.datepicker._curInst){var $target=$(event.target),inst=$.datepicker._getInst($target[0]);($target[0].id===$.datepicker._mainDivId||0!==$target.parents("#"+$.datepicker._mainDivId).length||$target.hasClass($.datepicker.markerClassName)||$target.closest("."+$.datepicker._triggerClass).length||!$.datepicker._datepickerShowing||$.datepicker._inDialog&&$.blockUI)&&(!$target.hasClass($.datepicker.markerClassName)||$.datepicker._curInst===inst)||$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);this._isDisabledDatepicker(target[0])||(this._adjustInstDate(inst,offset+("M"===period?this._get(inst,"showCurrentAtPos"):0),period),this._updateDatepicker(inst))},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);this._get(inst,"gotoCurrent")&&inst.currentDay?(inst.selectedDay=inst.currentDay,inst.drawMonth=inst.selectedMonth=inst.currentMonth,inst.drawYear=inst.selectedYear=inst.currentYear):(date=new Date,inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear()),this._notifyChange(inst),this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+("M"===period?"Month":"Year")]=inst["draw"+("M"===period?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10),this._notifyChange(inst),this._adjustDate(target)},_selectDay:function(id,month,year,td){var inst,target=$(id);$(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])||(inst=this._getInst(target[0]),inst.selectedDay=inst.currentDay=$("a",td).html(),inst.selectedMonth=inst.currentMonth=month,inst.selectedYear=inst.currentYear=year,this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear)))},_clearDate:function(id){var target=$(id);this._selectDate(target,"")},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=null!=dateStr?dateStr:this._formatDate(inst),inst.input&&inst.input.val(dateStr),this._updateAlternate(inst),onSelect=this._get(inst,"onSelect"),onSelect?onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst]):inst.input&&inst.input.trigger("change"),inst.inline?this._updateDatepicker(inst):(this._hideDatepicker(),this._lastInput=inst.input[0],"object"!=typeof inst.input[0]&&inst.input.focus(),this._lastInput=null)},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");altField&&(altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat"),date=this._getDate(inst),dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst)),$(altField).each(function(){$(this).val(dateStr)}))},noWeekends:function(date){var day=date.getDay();return[day>0&&day<6,""]},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());return checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7)),time=checkDate.getTime(),checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1},parseDate:function(format,value,settings){if(null==format||null==value)throw"Invalid arguments";if(value="object"==typeof value?value.toString():value+"",""===value)return null;var iFormat,dim,extra,date,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff="string"!=typeof shortYearCutoffTemp?shortYearCutoffTemp:(new Date).getFullYear()%100+parseInt(shortYearCutoffTemp,10),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},getNumber=function(match){var isDoubled=lookAhead(match),size="@"===match?14:"!"===match?20:"y"===match&&isDoubled?4:"o"===match?3:2,minSize="y"===match?size:1,digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num)throw"Missing number at position "+iValue;return iValue+=num[0].length,parseInt(num[0],10)},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if($.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase())return index=pair[0],iValue+=name.length,!1}),index!==-1)return index+1;throw"Unknown name at position "+iValue},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat))throw"Unexpected literal at position "+iValue;iValue++};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?checkLiteral():literal=!1;else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@")),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/1e4),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"'":lookAhead("'")?checkLiteral():literal=!0;break;default:checkLiteral()}if(iValue<value.length&&(extra=value.substr(iValue),!/^\s+/.test(extra)))throw"Extra/unparsed characters found in date: "+extra;if(year===-1?year=(new Date).getFullYear():year<100&&(year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(year<=shortYearCutoff?0:-100)),doy>-1)for(month=1,day=doy;;){if(dim=this._getDaysInMonth(year,month-1),day<=dim)break;month++,day-=dim}if(date=this._daylightSavingAdjust(new Date(year,month-1,day)),date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day)throw"Invalid date";return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(format,date,settings){if(!date)return"";var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match))for(;num.length<len;)num="0"+num;return num},formatName=function(match,value,shortNames,longNames){return lookAhead(match)?longNames[value]:shortNames[value]},output="",literal=!1;if(date)for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?output+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100;break;case"@":output+=date.getTime();break;case"!":output+=1e4*date.getTime()+this._ticksTo1970;break;case"'":lookAhead("'")?output+="'":literal=!0;break;default:output+=format.charAt(iFormat)}return output},_possibleChars:function(format){var iFormat,chars="",literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?chars+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":lookAhead("'")?chars+="'":literal=!0;break;default:chars+=format.charAt(iFormat)}return chars},_get:function(inst,name){return void 0!==inst.settings[name]?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()!==inst.lastVal){var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){dates=noDefault?"":dates}inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),inst.currentDay=dates?date.getDate():0,inst.currentMonth=dates?date.getMonth():0,inst.currentYear=dates?date.getFullYear():0,this._adjustInstDate(inst)}},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date;return date.setDate(date.getDate()+offset),date},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}for(var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date,year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);matches;){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=7*parseInt(matches[1],10);break;case"m":case"M":month+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month))}matches=pattern.exec(offset)}return new Date(year,month,day)},newDate=null==date||""===date?defaultDate:"string"==typeof date?offsetString(date):"number"==typeof date?isNaN(date)?defaultDate:offsetNumeric(date):new Date(date.getTime());return newDate=newDate&&"Invalid Date"===newDate.toString()?defaultDate:newDate,newDate&&(newDate.setHours(0),newDate.setMinutes(0),newDate.setSeconds(0),newDate.setMilliseconds(0)),this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){return date?(date.setHours(date.getHours()>12?date.getHours()+2:0),date):null},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date));inst.selectedDay=inst.currentDay=newDate.getDate(),inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth(),inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear(),origMonth===inst.selectedMonth&&origYear===inst.selectedYear||noChange||this._notifyChange(inst),this._adjustInstDate(inst),inst.input&&inst.input.val(clear?"":this._formatDate(inst))},_getDate:function(inst){var startDate=!inst.currentYear||inst.input&&""===inst.input.val()?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M")},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(id)},selectDay:function(){return $.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return $.datepicker._selectMonthYear(id,this,"M"),!1},selectYear:function(){return $.datepicker._selectMonthYear(id,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date,today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=1!==numMonths[0]||1!==numMonths[1],currentDate=this._daylightSavingAdjust(inst.currentDay?new Date(inst.currentYear,inst.currentMonth,inst.currentDay):new Date(9999,9,9)),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0&&(drawMonth+=12,drawYear--),maxDate)for(maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[0]*numMonths[1]+1,maxDate.getDate())),maxDraw=minDate&&maxDraw<minDate?minDate:maxDraw;this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw;)drawMonth--,drawMonth<0&&(drawMonth=11,drawYear--);for(inst.drawMonth=drawMonth,inst.drawYear=drawYear,prevText=this._get(inst,"prevText"),prevText=navigationAsDateFormat?this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)):prevText,prev=this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>",nextText=this._get(inst,"nextText"),nextText=navigationAsDateFormat?this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)):nextText,next=this._canAdjustMonth(inst,1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>",currentText=this._get(inst,"currentText"),gotoDate=this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today,currentText=navigationAsDateFormat?this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)):currentText,controls=inst.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(inst,"closeText")+"</button>",buttonPanel=showButtonPanel?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"",firstDay=parseInt(this._get(inst,"firstDay"),10),firstDay=isNaN(firstDay)?0:firstDay,showWeek=this._get(inst,"showWeek"),dayNames=this._get(inst,"dayNames"),dayNamesMin=this._get(inst,"dayNamesMin"),monthNames=this._get(inst,"monthNames"),monthNamesShort=this._get(inst,"monthNamesShort"),beforeShowDay=this._get(inst,"beforeShowDay"),showOtherMonths=this._get(inst,"showOtherMonths"),selectOtherMonths=this._get(inst,"selectOtherMonths"),defaultDate=this._getDefaultDate(inst),html="",row=0;row<numMonths[0];row++){for(group="",this.maxRows=4,col=0;col<numMonths[1];col++){if(selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay)),cornerClass=" ui-corner-all",calender="",isMultiMonth){if(calender+="<div class='ui-datepicker-group",numMonths[1]>1)switch(col){case 0:calender+=" ui-datepicker-group-first",cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last",cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle",cornerClass=""}calender+="'>"}for(calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+(/all|left/.test(cornerClass)&&0===row?isRTL?next:prev:"")+(/all|right/.test(cornerClass)&&0===row?isRTL?prev:next:"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead><tr>",thead=showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"",dow=0;dow<7;dow++)day=(dow+firstDay)%7,thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";for(calender+=thead+"</tr></thead><tbody>",daysInMonth=this._getDaysInMonth(drawYear,drawMonth),drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth&&(inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)),leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7,curRows=Math.ceil((leadDays+daysInMonth)/7),numRows=isMultiMonth&&this.maxRows>curRows?this.maxRows:curRows,this.maxRows=numRows,printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays)),dRow=0;dRow<numRows;dRow++){for(calender+="<tr>",tbody=showWeek?"<td class='ui-datepicker-week-col'>"+this._get(inst,"calculateWeek")(printDate)+"</td>":"",dow=0;dow<7;dow++)daySettings=beforeShowDay?beforeShowDay.apply(inst.input?inst.input[0]:null,[printDate]):[!0,""],otherMonth=printDate.getMonth()!==drawMonth,unselectable=otherMonth&&!selectOtherMonths||!daySettings[0]||minDate&&printDate<minDate||maxDate&&printDate>maxDate,tbody+="<td class='"+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent||defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime()?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+(otherMonth&&!showOtherMonths||!daySettings[2]?"":" title='"+daySettings[2].replace(/'/g,"&#39;")+"'")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>")+"</td>",printDate.setDate(printDate.getDate()+1),printDate=this._daylightSavingAdjust(printDate);calender+=tbody+"</tr>"}drawMonth++,drawMonth>11&&(drawMonth=0,drawYear++),calender+="</tbody></table>"+(isMultiMonth?"</div>"+(numMonths[0]>0&&col===numMonths[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),group+=calender}html+=group}return html+=buttonPanel,inst._keyEvent=!1,html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth)monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";else{for(inMinYear=minDate&&minDate.getFullYear()===drawYear,inMaxYear=maxDate&&maxDate.getFullYear()===drawYear,monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",month=0;month<12;month++)(!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())&&(monthHtml+="<option value='"+month+"'"+(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>");monthHtml+="</select>"}if(showMonthAfterYear||(html+=monthHtml+(!secondary&&changeMonth&&changeYear?"":"&#xa0;")),!inst.yearshtml)if(inst.yearshtml="",secondary||!changeYear)html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";else{for(years=this._get(inst,"yearRange").split(":"),thisYear=(new Date).getFullYear(),determineYear=function(value){var year=value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10);return isNaN(year)?thisYear:year},year=determineYear(years[0]),endYear=Math.max(year,determineYear(years[1]||"")),year=minDate?Math.max(year,minDate.getFullYear()):year,endYear=maxDate?Math.min(endYear,maxDate.getFullYear()):endYear,inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";year<=endYear;year++)inst.yearshtml+="<option value='"+year+"'"+(year===drawYear?" selected='selected'":"")+">"+year+"</option>";inst.yearshtml+="</select>",html+=inst.yearshtml,inst.yearshtml=null}return html+=this._get(inst,"yearSuffix"),showMonthAfterYear&&(html+=(!secondary&&changeMonth&&changeYear?"":"&#xa0;")+monthHtml),html+="</div>"},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+("Y"===period?offset:0),month=inst.drawMonth+("M"===period?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+("D"===period?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),"M"!==period&&"Y"!==period||this._notifyChange(inst)},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=minDate&&date<minDate?minDate:date;return maxDate&&newDate>maxDate?maxDate:newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");onChange&&onChange.apply(inst.input?inst.input[0]:null,[inst.selectedYear,inst.selectedMonth+1,inst])},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return null==numMonths?[1,1]:"number"==typeof numMonths?[1,numMonths]:numMonths},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));return offset<0&&date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth())),this._isInRange(inst,date)},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");return years&&(yearSplit=years.split(":"),currentYear=(new Date).getFullYear(),minYear=parseInt(yearSplit[0],10),maxYear=parseInt(yearSplit[1],10),yearSplit[0].match(/[+\-].*/)&&(minYear+=currentYear),yearSplit[1].match(/[+\-].*/)&&(maxYear+=currentYear)),(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear)},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");return shortYearCutoff="string"!=typeof shortYearCutoff?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10),{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){day||(inst.currentDay=inst.selectedDay,inst.currentMonth=inst.selectedMonth,inst.currentYear=inst.selectedYear);var date=day?"object"==typeof day?day:this._daylightSavingAdjust(new Date(year,month,day)):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}}),$.fn.datepicker=function(options){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick),$.datepicker.initialized=!0),0===$("#"+$.datepicker._mainDivId).length&&$("body").append($.datepicker.dpDiv);var otherArgs=Array.prototype.slice.call(arguments,1);return"string"!=typeof options||"isDisabled"!==options&&"getDate"!==options&&"widget"!==options?"option"===options&&2===arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs)):this.each(function(){"string"==typeof options?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options);
}):$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.11.4";$.datepicker;$.widget("ui.draggable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(key,value){this._super(key,value),"handle"===key&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(event){var o=this.options;return this._blurActiveElement(event),!(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(event),!!this.handle&&(this._blockFrames(o.iframeFix===!0?"iframe":o.iframeFix),!0))},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(event){var document=this.document[0];if(this.handleElement.is(event.target))try{document.activeElement&&"body"!==document.activeElement.nodeName.toLowerCase()&&$(document.activeElement).blur()}catch(error){}},_mouseStart:function(event){var o=this.options;return this.helper=this._createHelper(event),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===$(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(event),this.originalPosition=this.position=this._generatePosition(event,!1),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),this._trigger("start",event)===!1?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this._normalizeRightBottom(),this._mouseDrag(event,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event),!0)},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top}},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(event,!0),this.positionAbs=this._convertPositionTo("absolute"),!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===!1)return this._mouseUp({}),!1;this.position=ui.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),!1},_mouseStop:function(event){var that=this,dropped=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event)),this.dropped&&(dropped=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){that._trigger("stop",event)!==!1&&that._clear()}):this._trigger("stop",event)!==!1&&this._clear(),!1},_mouseUp:function(event){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event),this.handleElement.is(event.target)&&this.element.focus(),$.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(event){return!this.options.handle||!!$(event.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),helperIsFunction&&helper[0]===this.element[0]&&this._setPositionRelative(),helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute"),helper},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_isRootNode:function(element){return/(html|body)/i.test(element.tagName)||element===this.document[0]},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollTop()),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];return this.relativeContainer=null,o.containment?"window"===o.containment?void(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),c=$(o.containment),ce=c[0],void(ce&&(isUserScrollable=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)*mod}},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;return scrollIsRootNode&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),constrainPosition&&(this.containment&&(this.relativeContainer?(co=this.relativeContainer.offset(),containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]):containment=this.containment,event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)),o.grid&&(top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left),"y"===o.axis&&(pageX=this.originalPageX),"x"===o.axis&&(pageY=this.originalPageY)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(type,event,ui){return ui=ui||this._uiHash(),$.ui.plugin.call(this,type,[event,ui,this],!0),/^(drag|start|stop)/.test(type)&&(this.positionAbs=this._convertPositionTo("absolute"),ui.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[],$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");sortable&&!sortable.options.disabled&&(draggable.sortables.push(sortable),sortable.refreshPositions(),sortable._trigger("activate",event,uiSortable))})},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=!1,$.each(draggable.sortables,function(){var sortable=this;sortable.isOver?(sortable.isOver=0,draggable.cancelHelperRemoval=!0,sortable.cancelHelperRemoval=!1,sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")},sortable._mouseStop(event),sortable.options.helper=sortable.options._helper):(sortable.cancelHelperRemoval=!0,sortable._trigger("deactivate",event,uiSortable))})},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=!1,sortable=this;sortable.positionAbs=draggable.positionAbs,sortable.helperProportions=draggable.helperProportions,sortable.offset.click=draggable.offset.click,sortable._intersectsWith(sortable.containerCache)&&(innermostIntersecting=!0,$.each(draggable.sortables,function(){return this.positionAbs=draggable.positionAbs,this.helperProportions=draggable.helperProportions,this.offset.click=draggable.offset.click,this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])&&(innermostIntersecting=!1),innermostIntersecting})),innermostIntersecting?(sortable.isOver||(sortable.isOver=1,draggable._parent=ui.helper.parent(),sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",!0),sortable.options._helper=sortable.options.helper,sortable.options.helper=function(){return ui.helper[0]},event.target=sortable.currentItem[0],sortable._mouseCapture(event,!0),sortable._mouseStart(event,!0,!0),sortable.offset.click.top=draggable.offset.click.top,sortable.offset.click.left=draggable.offset.click.left,sortable.offset.parent.left-=draggable.offset.parent.left-sortable.offset.parent.left,sortable.offset.parent.top-=draggable.offset.parent.top-sortable.offset.parent.top,draggable._trigger("toSortable",event),draggable.dropped=sortable.element,$.each(draggable.sortables,function(){this.refreshPositions()}),draggable.currentItem=draggable.element,sortable.fromOutside=draggable),sortable.currentItem&&(sortable._mouseDrag(event),ui.position=sortable.position)):sortable.isOver&&(sortable.isOver=0,sortable.cancelHelperRemoval=!0,sortable.options._revert=sortable.options.revert,sortable.options.revert=!1,sortable._trigger("out",event,sortable._uiHash(sortable)),sortable._mouseStop(event,!0),sortable.options.revert=sortable.options._revert,sortable.options.helper=sortable.options._helper,sortable.placeholder&&sortable.placeholder.remove(),ui.helper.appendTo(draggable._parent),draggable._refreshOffsets(event),ui.position=draggable._generatePosition(event,!0),draggable._trigger("fromSortable",event),draggable.dropped=!1,$.each(draggable.sortables,function(){this.refreshPositions()}))})}}),$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;t.css("cursor")&&(o._cursor=t.css("cursor")),t.css("cursor",o.cursor)},stop:function(event,ui,instance){var o=instance.options;o._cursor&&$("body").css("cursor",o._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(event,ui,instance){var o=instance.options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(event,ui,i){var o=i.options,scrolled=!1,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];scrollParent!==document&&"HTML"!==scrollParent.tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+scrollParent.offsetHeight-event.pageY<o.scrollSensitivity?scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+scrollParent.offsetWidth-event.pageX<o.scrollSensitivity?scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))),scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}}),$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[],$(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--)l=inst.snapElements[i].left-inst.margins.left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top-inst.margins.top,b=t+inst.snapElements[i].height,x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)?(inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=!1):("inner"!==o.snapMode&&(ts=Math.abs(t-y2)<=d,bs=Math.abs(b-y1)<=d,ls=Math.abs(l-x2)<=d,rs=Math.abs(r-x1)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left)),first=ts||bs||ls||rs,"outer"!==o.snapMode&&(ts=Math.abs(t-y1)<=d,bs=Math.abs(b-y2)<=d,ls=Math.abs(l-x1)<=d,rs=Math.abs(r-x2)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left)),!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=ts||bs||ls||rs||first)}}),$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});group.length&&(min=parseInt($(group[0]).css("zIndex"),10)||0,$(group).each(function(i){$(this).css("zIndex",min+i)}),this.css("zIndex",min+group.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(event,ui,instance){var o=instance.options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}});$.ui.draggable;$.widget("ui.resizable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseInt(value,10)||0},_isNumber:function(value){return!isNaN(parseInt(value,10))},_hasScroll:function(el,a){if("hidden"===$(el).css("overflow"))return!1;var scroll=a&&"left"===a?"scrollLeft":"scrollTop",has=!1;return el[scroll]>0||(el[scroll]=1,has=el[scroll]>0,el[scroll]=0,has)},_create:function(){var n,i,handle,axis,hname,that=this,o=this.options;if(this.element.addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=$(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;i<n.length;i++)handle=$.trim(n[i]),hname="ui-resizable-"+handle,axis=$("<div class='ui-resizable-handle "+hname+"'></div>"),axis.css({zIndex:o.zIndex}),"se"===handle&&axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[handle]=".ui-resizable-"+handle,this.element.append(axis);this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=$(this.handles[i]),this._on(this.handles[i],{mousedown:that._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(axis=$(this.handles[i],this.element),padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth(),padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),target.css(padPos,padWrapper),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){that.resizing||(this.className&&(axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),that.axis=axis&&axis[1]?axis[1]:"se")}),o.autoHide&&(this._handles.hide(),$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){o.disabled||($(this).removeClass("ui-resizable-autohide"),that._handles.show())}).mouseleave(function(){o.disabled||that.resizing||($(this).addClass("ui-resizable-autohide"),that._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(_destroy(this.element),wrapper=this.element,this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper),wrapper.remove()),this.originalElement.css("resize",this.originalResizeStyle),_destroy(this.originalElement),this},_mouseCapture:function(event){var i,handle,capture=!1;for(i in this.handles)handle=$(this.handles[i])[0],(handle===event.target||$.contains(handle,event.target))&&(capture=!0);return!this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;return this.resizing=!0,this._renderProxy(),curleft=this._num(this.helper.css("left")),curtop=this._num(this.helper.css("top")),o.containment&&(curleft+=$(o.containment).scrollLeft()||0,curtop+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:curleft,top:curtop},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()},this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()},this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()},this.originalPosition={left:curleft,top:curtop},this.originalMousePosition={left:event.pageX,top:event.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,cursor=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===cursor?this.axis+"-resize":cursor),el.addClass("ui-resizable-resizing"),this._propagate("start",event),!0},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=event.pageX-smp.left||0,dy=event.pageY-smp.top||0,trigger=this._change[a];return this._updatePrevProperties(),!!trigger&&(data=trigger.apply(this,[event,dx,dy]),this._updateVirtualBoundaries(event.shiftKey),(this._aspectRatio||event.shiftKey)&&(data=this._updateRatio(data,event)),data=this._respectSize(data,event),this._updateCache(data),this._propagate("resize",event),props=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(props)||(this._updatePrevProperties(),this._trigger("resize",event,this.ui()),this._applyChanges()),!1)},_mouseStop:function(event){this.resizing=!1;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;return this._helper&&(pr=this._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,s={width:that.helper.width()-soffsetw,height:that.helper.height()-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null,o.animate||this.element.css($.extend(s,{top:top,left:left})),that.helper.height(that.size.height),that.helper.width(that.size.width),this._helper&&!o.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",event),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var props={};return this.position.top!==this.prevPosition.top&&(props.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(props.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(props.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(props.height=this.size.height+"px"),this.helper.css(props),props},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||forceAspectRatio)&&(pMinWidth=b.minHeight*this.aspectRatio,pMinHeight=b.minWidth/this.aspectRatio,pMaxWidth=b.maxHeight*this.aspectRatio,pMaxHeight=b.maxWidth/this.aspectRatio,pMinWidth>b.minWidth&&(b.minWidth=pMinWidth),pMinHeight>b.minHeight&&(b.minHeight=pMinHeight),pMaxWidth<b.maxWidth&&(b.maxWidth=pMaxWidth),pMaxHeight<b.maxHeight&&(b.maxHeight=pMaxHeight)),this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset(),this._isNumber(data.left)&&(this.position.left=data.left),this._isNumber(data.top)&&(this.position.top=data.top),this._isNumber(data.height)&&(this.size.height=data.height),this._isNumber(data.width)&&(this.size.width=data.width)},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;return this._isNumber(data.height)?data.width=data.height*this.aspectRatio:this._isNumber(data.width)&&(data.height=data.width/this.aspectRatio),"sw"===a&&(data.left=cpos.left+(csize.width-data.width),data.top=null),"nw"===a&&(data.top=cpos.top+(csize.height-data.height),data.left=cpos.left+(csize.width-data.width)),data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&o.maxWidth<data.width,ismaxh=this._isNumber(data.height)&&o.maxHeight&&o.maxHeight<data.height,isminw=this._isNumber(data.width)&&o.minWidth&&o.minWidth>data.width,isminh=this._isNumber(data.height)&&o.minHeight&&o.minHeight>data.height,dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);return isminw&&(data.width=o.minWidth),isminh&&(data.height=o.minHeight),ismaxw&&(data.width=o.maxWidth),ismaxh&&(data.height=o.maxHeight),isminw&&cw&&(data.left=dw-o.minWidth),ismaxw&&cw&&(data.left=dw-o.maxWidth),
isminh&&ch&&(data.top=dh-o.minHeight),ismaxh&&ch&&(data.top=dh-o.maxHeight),data.width||data.height||data.left||!data.top?data.width||data.height||data.top||!data.left||(data.left=null):data.top=null,data},_getPaddingPlusBorderDimensions:function(element){for(var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];i<4;i++)widths[i]=parseInt(borders[i],10)||0,widths[i]+=parseInt(paddings[i],10)||0;return{height:widths[0]+widths[2],width:widths[1]+widths[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var prel,i=0,element=this.helper||this.element;i<this._proportionallyResizeElements.length;i++)prel=this._proportionallyResizeElements[i],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(prel)),prel.css({height:element.height()-this.outerDimensions.height||0,width:element.width()-this.outerDimensions.width||0})},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]),"resize"!==n&&this._trigger(n,event,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:that.size.width-soffsetw,height:that.size.height-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(that.element.css("width"),10),height:parseInt(that.element.css("height"),10),top:parseInt(that.element.css("top"),10),left:parseInt(that.element.css("left"),10)};pr&&pr.length&&$(pr[0]).css({width:data.width,height:data.height}),that._updateCache(data),that._propagate("resize",event)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=oc instanceof $?oc.get(0):/parent/.test(oc)?el.parent().get(0):oc;ce&&(that.containerElement=$(ce),/document/.test(oc)||oc===document?(that.containerOffset={left:0,top:0},that.containerPosition={left:0,top:0},that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(element=$(ce),p=[],$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name))}),that.containerOffset=element.offset(),that.containerPosition=element.position(),that.containerSize={height:element.innerHeight()-p[3],width:element.innerWidth()-p[1]},co=that.containerOffset,ch=that.containerSize.height,cw=that.containerSize.width,width=that._hasScroll(ce,"left")?ce.scrollWidth:cw,height=that._hasScroll(ce)?ce.scrollHeight:ch,that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}))},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=!0;ce[0]!==document&&/static/.test(ce.css("position"))&&(cop=co),cp.left<(that._helper?co.left:0)&&(that.size.width=that.size.width+(that._helper?that.position.left-co.left:that.position.left-cop.left),pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1),that.position.left=o.helper?co.left:0),cp.top<(that._helper?co.top:0)&&(that.size.height=that.size.height+(that._helper?that.position.top-co.top:that.position.top),pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1),that.position.top=that._helper?co.top:0),isParent=that.containerElement.get(0)===that.element.parent().get(0),isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position")),isParent&&isOffsetRelative?(that.offset.left=that.parentData.left+that.position.left,that.offset.top=that.parentData.top+that.position.top):(that.offset.left=that.element.offset().left,that.offset.top=that.element.offset().top),woset=Math.abs(that.sizeDiff.width+(that._helper?that.offset.left-cop.left:that.offset.left-co.left)),hoset=Math.abs(that.sizeDiff.height+(that._helper?that.offset.top-cop.top:that.offset.top-co.top)),woset+that.size.width>=that.parentData.width&&(that.size.width=that.parentData.width-woset,pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1)),hoset+that.size.height>=that.parentData.height&&(that.size.height=that.parentData.height-hoset,pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1)),continueResize||(that.position.left=that.prevPosition.left,that.position.top=that.prevPosition.top,that.size.width=that.prevSize.width,that.size.height=that.prevSize.height)},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;that._helper&&!o.animate&&/relative/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h}),that._helper&&!o.animate&&/static/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).resizable("instance"),o=that.options;$(o.alsoResize).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)})})},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:that.size.height-os.height||0,width:that.size.width-os.width||0,top:that.position.top-op.top||0,left:that.position.left-op.left||0};$(o.alsoResize).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);sum&&sum>=0&&(style[prop]=sum||null)}),el.css(style)})},stop:function(){$(this).removeData("resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),o=that.options,cs=that.size;that.ghost=that.originalElement.clone(),that.ghost.css({opacity:.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof o.ghost?o.ghost:""),that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).resizable("instance");that.ghost&&that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})},stop:function(){var that=$(this).resizable("instance");that.ghost&&that.helper&&that.helper.get(0).removeChild(that.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid="number"==typeof o.grid?[o.grid,o.grid]:o.grid,gridX=grid[0]||1,gridY=grid[1]||1,ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&o.maxWidth<newWidth,isMaxHeight=o.maxHeight&&o.maxHeight<newHeight,isMinWidth=o.minWidth&&o.minWidth>newWidth,isMinHeight=o.minHeight&&o.minHeight>newHeight;o.grid=grid,isMinWidth&&(newWidth+=gridX),isMinHeight&&(newHeight+=gridY),isMaxWidth&&(newWidth-=gridX),isMaxHeight&&(newHeight-=gridY),/^(se|s|e)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight):/^(ne)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.top=op.top-oy):/^(sw)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.left=op.left-ox):((newHeight-gridY<=0||newWidth-gridX<=0)&&(outerDimensions=that._getPaddingPlusBorderDimensions(this)),newHeight-gridY>0?(that.size.height=newHeight,that.position.top=op.top-oy):(newHeight=gridY-outerDimensions.height,that.size.height=newHeight,that.position.top=op.top+os.height-newHeight),newWidth-gridX>0?(that.size.width=newWidth,that.position.left=op.left-ox):(newWidth=gridX-outerDimensions.width,that.size.width=newWidth,that.position.left=op.left+os.width-newWidth))}});$.ui.resizable,$.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;topOffset<0&&$(this).css("top",pos.top-topOffset)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var element=this.options.appendTo;return element&&(element.jquery||element.nodeType)?$(element):this.document.find(element||"body").eq(0)},_destroy:function(){var next,originalPosition=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),next=originalPosition.parent.children().eq(originalPosition.index),next.length&&next[0]!==this.element[0]?next.before(this.element):originalPosition.parent.append(this.element)},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(event){var activeElement,that=this;if(this._isOpen&&this._trigger("beforeClose",event)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{activeElement=this.document[0].activeElement,activeElement&&"body"!==activeElement.nodeName.toLowerCase()&&$(activeElement).blur()}catch(error){}this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(event,silent){var moved=!1,zIndices=this.uiDialog.siblings(".ui-front:visible").map(function(){return+$(this).css("z-index")}).get(),zIndexMax=Math.max.apply(null,zIndices);return zIndexMax>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",zIndexMax+1),moved=!0),moved&&!silent&&this._trigger("focus",event),moved},open:function(){var that=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=$(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){that._focusTabbable(),that._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var hasFocus=this._focusedElement;hasFocus||(hasFocus=this.element.find("[autofocus]")),hasFocus.length||(hasFocus=this.element.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogButtonPane.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogTitlebarClose.filter(":tabbable")),hasFocus.length||(hasFocus=this.uiDialog),hasFocus.eq(0).focus()},_keepFocus:function(event){function checkFocus(){var activeElement=this.document[0].activeElement,isActive=this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement);isActive||this._focusTabbable()}event.preventDefault(),checkFocus.call(this),this._delay(checkFocus)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE)return event.preventDefault(),void this.close(event);if(event.keyCode===$.ui.keyCode.TAB&&!event.isDefaultPrevented()){var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");event.target!==last[0]&&event.target!==this.uiDialog[0]||event.shiftKey?event.target!==first[0]&&event.target!==this.uiDialog[0]||!event.shiftKey||(this._delay(function(){last.focus()}),event.preventDefault()):(this._delay(function(){first.focus()}),event.preventDefault())}},mousedown:function(event){this._moveToTop(event)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(event){$(event.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault(),this.close(event)}}),uiDialogTitle=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(uiDialogTitle),this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")})},_title:function(title){this.options.title||title.html("&#160;"),title.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var that=this,buttons=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(buttons)||$.isArray(buttons)&&!buttons.length?void this.uiDialog.removeClass("ui-dialog-buttons"):($.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props,props=$.extend({type:"button"},props),click=props.click,props.click=function(){click.apply(that.element[0],arguments)},buttonOptions={icons:props.icons,text:props.showText},delete props.icons,delete props.showText,$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function filteredUi(ui){return{position:ui.position,offset:ui.offset}}var that=this,options=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){$(this).addClass("ui-dialog-dragging"),that._blockFrames(),that._trigger("dragStart",event,filteredUi(ui))},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui))},stop:function(event,ui){var left=ui.offset.left-that.document.scrollLeft(),top=ui.offset.top-that.document.scrollTop();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},$(this).removeClass("ui-dialog-dragging"),that._unblockFrames(),that._trigger("dragStop",event,filteredUi(ui))}})},_makeResizable:function(){function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size}}var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles="string"==typeof handles?handles:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){$(this).addClass("ui-dialog-resizing"),that._blockFrames(),that._trigger("resizeStart",event,filteredUi(ui))},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui))},stop:function(event,ui){var offset=that.uiDialog.offset(),left=offset.left-that.document.scrollLeft(),top=offset.top-that.document.scrollTop();options.height=that.uiDialog.height(),options.width=that.uiDialog.width(),options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},$(this).removeClass("ui-dialog-resizing"),that._unblockFrames(),that._trigger("resizeStop",event,filteredUi(ui))}}).css("position",position)},_trackFocus:function(){this._on(this.widget(),{focusin:function(event){this._makeFocusTarget(),this._focusedElement=$(event.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var instances=this._trackingInstances(),exists=$.inArray(this,instances);exists!==-1&&instances.splice(exists,1)},_trackingInstances:function(){var instances=this.document.data("ui-dialog-instances");return instances||(instances=[],this.document.data("ui-dialog-instances",instances)),instances},_minHeight:function(){var options=this.options;return"auto"===options.height?options.minHeight:Math.min(options.minHeight,options.height)},_position:function(){var isVisible=this.uiDialog.is(":visible");isVisible||this.uiDialog.show(),this.uiDialog.position(this.options.position),isVisible||this.uiDialog.hide()},_setOptions:function(options){var that=this,resize=!1,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value),key in that.sizeRelatedOptions&&(resize=!0),key in that.resizableRelatedOptions&&(resizableOptions[key]=value)}),resize&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",resizableOptions)},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;"dialogClass"===key&&uiDialog.removeClass(this.options.dialogClass).addClass(value),"disabled"!==key&&(this._super(key,value),"appendTo"===key&&this.uiDialog.appendTo(this._appendTo()),"buttons"===key&&this._createButtons(),"closeText"===key&&this.uiDialogTitlebarClose.button({label:""+value}),"draggable"===key&&(isDraggable=uiDialog.is(":data(ui-draggable)"),isDraggable&&!value&&uiDialog.draggable("destroy"),!isDraggable&&value&&this._makeDraggable()),"position"===key&&this._position(),"resizable"===key&&(isResizable=uiDialog.is(":data(ui-resizable)"),isResizable&&!value&&uiDialog.resizable("destroy"),isResizable&&"string"==typeof value&&uiDialog.resizable("option","handles",value),isResizable||value===!1||this._makeResizable()),"title"===key&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),options.minWidth>options.width&&(options.width=options.minWidth),nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight(),minContentHeight=Math.max(0,options.minHeight-nonContentHeight),maxContentHeight="number"==typeof options.maxHeight?Math.max(0,options.maxHeight-nonContentHeight):"none","auto"===options.height?this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"}):this.element.height(Math.max(0,options.height-nonContentHeight)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(event){return!!$(event.target).closest(".ui-dialog").length||!!$(event.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var isOpening=!0;this._delay(function(){isOpening=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(event){isOpening||this._allowInteraction(event)||(event.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var overlays=this.document.data("ui-dialog-overlays")-1;overlays?this.document.data("ui-dialog-overlays",overlays):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}});$.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)},this.proportions=function(){return arguments.length?void(proportions=arguments[0]):proportions?proportions:proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(o.scope),o.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[],$.ui.ddmanager.droppables[scope].push(this)},_splice:function(drop){for(var i=0;i<drop.length;i++)drop[i]===this&&drop.splice(i,1)},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(key,value){if("accept"===key)this.accept=$.isFunction(value)?value:function(d){return d.is(value)};else if("scope"===key){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop),this._addToManager(value)}this._super(key,value)},_activate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),draggable&&this._trigger("activate",event,this.ui(draggable))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),draggable&&this._trigger("deactivate",event,this.ui(draggable))},_over:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",event,this.ui(draggable)))},_out:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",event,this.ui(draggable)))},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=!1;return!(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],draggable.currentItem||draggable.element)&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event))return childrenIntersection=!0,!1}),!childrenIntersection&&(!!this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",event,this.ui(draggable)),this.element)))},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}}}),$.ui.intersect=function(){function isOverAxis(x,reference,size){return x>=reference&&x<reference+size}return function(draggable,droppable,toleranceMode,event){if(!droppable.offset)return!1;var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return l<=x1&&x2<=r&&t<=y1&&y2<=b;case"intersect":return l<x1+draggable.helperProportions.width/2&&x2-draggable.helperProportions.width/2<r&&t<y1+draggable.helperProportions.height/2&&y2-draggable.helperProportions.height/2<b;case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return(y1>=t&&y1<=b||y2>=t&&y2<=b||y1<t&&y2>b)&&(x1>=l&&x1<=r||x2>=l&&x2<=r||x1<l&&x2>r);default:return!1}}}(),$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++)if(!(m[i].options.disabled||t&&!m[i].accept.call(m[i].element[0],t.currentItem||t.element))){for(j=0;j<list.length;j++)if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop}m[i].visible="none"!==m[i].element.css("display"),m[i].visible&&("mousedown"===type&&m[i]._activate.call(m[i],event),m[i].offset=m[i].element.offset(),m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}))}},drop:function(draggable,event){var dropped=!1;return $.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance,event)&&(dropped=this._drop.call(this,event)||dropped),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,event)))}),dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)})},drag:function(draggable,event){draggable.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(draggable,event),$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":intersects&&!this.isover?"isover":null;c&&(this.options.greedy&&(scope=this.options.scope,parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope}),parent.length&&(parentInstance=$(parent[0]).droppable("instance"),parentInstance.greedyChild="isover"===c)),parentInstance&&"isover"===c&&(parentInstance.isover=!1,parentInstance.isout=!0,parentInstance._out.call(parentInstance,event)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,event),parentInstance&&"isout"===c&&(parentInstance.isout=!1,parentInstance.isover=!0,parentInstance._over.call(parentInstance,event)))}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable"),draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)}};var dataSpace=($.ui.droppable,"ui-effects-"),jQuery=$;$.effects={effect:{}},function(jQuery,undefined){function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};return null==value?allowEmpty||!prop.def?null:prop.def:(value=type.floor?~~value:parseFloat(value),isNaN(value)?prop.def:type.mod?(value+type.mod)%type.mod:0>value?0:type.max<value?type.max:value)}function stringParse(string){var inst=color(),rgba=inst._rgba=[];return string=string.toLowerCase(),each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values)return parsed=inst[spaceName](values),
inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache],rgba=inst._rgba=parsed._rgba,!1}),rgba.length?("0,0,0,0"===rgba.join()&&jQuery.extend(rgba,colors.transparent),inst):colors[string]}function hue2rgb(p,q,h){return h=(h+1)%1,6*h<1?p+(q-p)*h*6:2*h<1?q:3*h<2?p+(q-p)*(2/3-h)*6:p}var colors,stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},support=color.support={},supportElem=jQuery("<p>")[0],each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)",support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1,each(spaces,function(spaceName,space){space.cache="_"+spaceName,space.props.alpha={idx:3,type:"percent",def:1}}),color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined)return this._rgba=[null,null,null,null],this;(red.jquery||red.nodeType)&&(red=jQuery(red).css(green),green=undefined);var inst=this,type=jQuery.type(red),rgba=this._rgba=[];return green!==undefined&&(red=[red,green,blue,alpha],type="array"),"string"===type?this.parse(stringParse(red)||colors._default):"array"===type?(each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)}),this):"object"===type?(red instanceof color?each(spaces,function(spaceName,space){red[space.cache]&&(inst[space.cache]=red[space.cache].slice())}):each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if("alpha"===key||null==red[key])return;inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,!0)}),inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0&&(inst[cache][3]=1,space.from&&(inst._rgba=space.from(inst[cache])))}),this):void 0},is:function(compare){var is=color(compare),same=!0,inst=this;return each(spaces,function(_,space){var localCache,isCache=is[space.cache];return isCache&&(localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[],each(space.props,function(_,prop){if(null!=isCache[prop.idx])return same=isCache[prop.idx]===localCache[prop.idx]})),same}),same},_space:function(){var used=[],inst=this;return each(spaces,function(spaceName,space){inst[space.cache]&&used.push(spaceName)}),used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=0===this.alpha()?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();return end=end[space.cache],each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};null!==endValue&&(null===startValue?result[index]=endValue:(type.mod&&(endValue-startValue>type.mod/2?startValue+=type.mod:startValue-endValue>type.mod/2&&(startValue-=type.mod)),result[index]=clamp((endValue-startValue)*distance+startValue,prop)))}),this[spaceName](result)},blend:function(opaque){if(1===this._rgba[3])return this;var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return null==v?i>2?1:0:v});return 1===rgba[3]&&(rgba.pop(),prefix="rgb("),prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){return null==v&&(v=i>2?1:0),i&&i<3&&(v=Math.round(100*v)+"%"),v});return 1===hsla[3]&&(hsla.pop(),prefix="hsl("),prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();return includeAlpha&&rgba.push(~~(255*alpha)),"#"+jQuery.map(rgba,function(v){return v=(v||0).toString(16),1===v.length?"0"+v:v}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),color.fn.parse.prototype=color.fn,spaces.hsla.to=function(rgba){if(null==rgba[0]||null==rgba[1]||null==rgba[2])return[null,null,null,rgba[3]];var h,s,r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=.5*add;return h=min===max?0:r===max?60*(g-b)/diff+360:g===max?60*(b-r)/diff+120:60*(r-g)/diff+240,s=0===diff?0:l<=.5?diff/add:diff/(2-add),[Math.round(h)%360,s,l,null==a?1:a]},spaces.hsla.from=function(hsla){if(null==hsla[0]||null==hsla[1]||null==hsla[2])return[null,null,null,hsla[3]];var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(255*hue2rgb(p,q,h+1/3)),Math.round(255*hue2rgb(p,q,h)),Math.round(255*hue2rgb(p,q,h-1/3)),a]},each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]&&(this[cache]=to(this._rgba)),value===undefined)return this[cache].slice();var ret,type=jQuery.type(value),arr="array"===type||"object"===type?value:arguments,local=this[cache].slice();return each(props,function(key,prop){var val=arr["object"===type?key:prop.idx];null==val&&(val=local[prop.idx]),local[prop.idx]=clamp(val,prop)}),from?(ret=color(from(local)),ret[cache]=local,ret):color(local)},each(props,function(key,prop){color.fn[key]||(color.fn[key]=function(value){var match,vtype=jQuery.type(value),fn="alpha"===key?this._hsla?"hsla":"rgba":spaceName,local=this[fn](),cur=local[prop.idx];return"undefined"===vtype?cur:("function"===vtype&&(value=value.call(this,cur),vtype=jQuery.type(value)),null==value&&prop.empty?this:("string"===vtype&&(match=rplusequals.exec(value),match&&(value=cur+parseFloat(match[2])*("+"===match[1]?1:-1))),local[prop.idx]=value,this[fn](local)))})})}),color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if("transparent"!==value&&("string"!==jQuery.type(value)||(parsed=stringParse(value)))){if(value=color(parsed||value),!support.rgba&&1!==value._rgba[3]){for(curElem="backgroundColor"===hook?elem.parentNode:elem;(""===backgroundColor||"transparent"===backgroundColor)&&curElem&&curElem.style;)try{backgroundColor=jQuery.css(curElem,"backgroundColor"),curElem=curElem.parentNode}catch(e){}value=value.blend(backgroundColor&&"transparent"!==backgroundColor?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}},jQuery.fx.step[hook]=function(fx){fx.colorInit||(fx.start=color(fx.elem,hook),fx.end=color(fx.end),fx.colorInit=!0),jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})},color.hook(stepHooks),jQuery.cssHooks.borderColor={expand:function(value){var expanded={};return each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value}),expanded}},colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]])for(len=style.length;len--;)key=style[len],"string"==typeof style[key]&&(styles[$.camelCase(key)]=style[key]);else for(key in style)"string"==typeof style[key]&&(styles[key]=style[key]);return styles}function styleDifference(oldStyle,newStyle){var name,value,diff={};for(name in newStyle)value=newStyle[name],oldStyle[name]!==value&&(shorthandStyles[name]||!$.fx.step[name]&&isNaN(parseFloat(value))||(diff[name]=value));return diff}var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){("none"!==fx.end&&!fx.setAttr||1===fx.pos&&!fx.setAttr)&&(jQuery.style(fx.elem,prop,fx.end),fx.setAttr=!0)}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var applyClassChange,animated=$(this),baseClass=animated.attr("class")||"",allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,start:getElementStyles(this)}}),applyClassChange=function(){$.each(classAnimationActions,function(i,action){value[action]&&animated[action+"Class"](value[action])})},applyClassChange(),allAnimations=allAnimations.map(function(){return this.end=getElementStyles(this.el[0]),this.diff=styleDifference(this.start,this.end),this}),animated.attr("class",baseClass),allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:!1,complete:function(){dfd.resolve(styleInfo)}});return this.el.animate(this.diff,opts),dfd.promise()}),$.when.apply($,allAnimations.get()).done(function(){applyClassChange(),$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"")})}),o.complete.call(animated[0])})})},$.fn.extend({addClass:function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.addClass),removeClass:function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.removeClass),toggleClass:function(orig){return function(classNames,force,speed,easing,callback){return"boolean"==typeof force||void 0===force?speed?$.effects.animateClass.call(this,force?{add:classNames}:{remove:classNames},speed,easing,callback):orig.apply(this,arguments):$.effects.animateClass.call(this,{toggle:classNames},force,speed,easing)}}($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback)}})}(),function(){function _normalizeArguments(effect,options,speed,callback){return $.isPlainObject(effect)&&(options=effect,effect=effect.effect),effect={effect:effect},null==options&&(options={}),$.isFunction(options)&&(callback=options,speed=null,options={}),("number"==typeof options||$.fx.speeds[options])&&(callback=speed,speed=options,options={}),$.isFunction(speed)&&(callback=speed,speed=null),options&&$.extend(effect,options),speed=speed||options.duration,effect.duration=$.fx.off?0:"number"==typeof speed?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default,effect.complete=callback||options.complete,effect}function standardAnimationOption(option){return!(option&&"number"!=typeof option&&!$.fx.speeds[option])||("string"==typeof option&&!$.effects.effect[option]||(!!$.isFunction(option)||"object"==typeof option&&!option.effect))}$.extend($.effects,{version:"1.11.4",save:function(element,set){for(var i=0;i<set.length;i++)null!==set[i]&&element.data(dataSpace+set[i],element[0].style[set[i]])},restore:function(element,set){var val,i;for(i=0;i<set.length;i++)null!==set[i]&&(val=element.data(dataSpace+set[i]),void 0===val&&(val=""),element.css(set[i],val))},setMode:function(el,mode){return"toggle"===mode&&(mode=el.is(":hidden")?"show":"hide"),mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper"))return element.parent();var props={width:element.outerWidth(!0),height:element.outerHeight(!0),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id}catch(e){active=document.body}return element.wrap(wrapper),(element[0]===active||$.contains(element[0],active))&&$(active).focus(),wrapper=element.parent(),"static"===element.css("position")?(wrapper.css({position:"relative"}),element.css({position:"relative"})):($.extend(props,{position:element.css("position"),zIndex:element.css("z-index")}),$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos),isNaN(parseInt(props[pos],10))&&(props[pos]="auto")}),element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),element.css(size),wrapper.css(props).show()},removeWrapper:function(element){var active=document.activeElement;return element.parent().is(".ui-effects-wrapper")&&(element.parent().replaceWith(element),(element[0]===active||$.contains(element[0],active))&&$(active).focus()),element},setTransition:function(element,list,factor,value){return value=value||{},$.each(list,function(i,x){var unit=element.cssUnit(x);unit[0]>0&&(value[x]=unit[0]*factor+unit[1])}),value}}),$.fn.extend({effect:function(){function run(next){function done(){$.isFunction(complete)&&complete.call(elem[0]),$.isFunction(next)&&next()}var elem=$(this),complete=args.complete,mode=args.mode;(elem.is(":hidden")?"hide"===mode:"show"===mode)?(elem[mode](),done()):effectMethod.call(elem[0],args,done)}var args=_normalizeArguments.apply(this,arguments),mode=args.mode,queue=args.queue,effectMethod=$.effects.effect[args.effect];return $.fx.off||!effectMethod?mode?this[mode](args.duration,args.complete):this.each(function(){args.complete&&args.complete.call(this)}):queue===!1?this.each(run):this.queue(queue||"fx",run)},show:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="show",this.effect.call(this,args)}}($.fn.show),hide:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="hide",this.effect.call(this,args)}}($.fn.hide),toggle:function(orig){return function(option){if(standardAnimationOption(option)||"boolean"==typeof option)return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="toggle",this.effect.call(this,args)}}($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];return $.each(["em","px","%","pt"],function(i,unit){style.indexOf(unit)>0&&(val=[parseFloat(style),unit])}),val}})}(),function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2)}}),$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2)},Circ:function(p){return 1-Math.sqrt(1-p*p)},Elastic:function(p){return 0===p||1===p?p:-Math.pow(2,8*(p-1))*Math.sin((80*(p-1)-7.5)*Math.PI/15)},Back:function(p){return p*p*(3*p-2)},Bounce:function(p){for(var pow2,bounce=4;p<((pow2=Math.pow(2,--bounce))-1)/11;);return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((3*pow2-2)/22-p,2)}}),$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn,$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p)},$.easing["easeInOut"+name]=function(p){return p<.5?easeIn(2*p)/2:1-easeIn(p*-2+2)/2}})}();$.effects,$.effects.effect.blind=function(o,done){var wrapper,distance,margin,el=$(this),rvertical=/up|down|vertical/,rpositivemotion=/up|left|vertical|horizontal/,props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),direction=o.direction||"up",vertical=rvertical.test(direction),ref=vertical?"height":"width",ref2=vertical?"top":"left",motion=rpositivemotion.test(direction),animation={},show="show"===mode;el.parent().is(".ui-effects-wrapper")?$.effects.save(el.parent(),props):$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),distance=wrapper[ref](),margin=parseFloat(wrapper.css(ref2))||0,animation[ref]=show?distance:0,motion||(el.css(vertical?"bottom":"right",0).css(vertical?"top":"left","auto").css({position:"absolute"}),animation[ref2]=show?margin:distance+margin),show&&(wrapper.css(ref,0),motion||wrapper.css(ref2,margin+distance)),wrapper.animate(animation,{duration:o.duration,easing:o.easing,queue:!1,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})},$.effects.effect.bounce=function(o,done){var i,upAnim,downAnim,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),hide="hide"===mode,show="show"===mode,direction=o.direction||"up",distance=o.distance,times=o.times||5,anims=2*times+(show||hide?1:0),speed=o.duration/anims,easing=o.easing,ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction,queue=el.queue(),queuelen=queue.length;for((show||hide)&&props.push("opacity"),$.effects.save(el,props),el.show(),$.effects.createWrapper(el),distance||(distance=el["top"===ref?"outerHeight":"outerWidth"]()/3),show&&(downAnim={opacity:1},downAnim[ref]=0,el.css("opacity",0).css(ref,motion?2*-distance:2*distance).animate(downAnim,speed,easing)),hide&&(distance/=Math.pow(2,times-1)),downAnim={},downAnim[ref]=0,i=0;i<times;i++)upAnim={},upAnim[ref]=(motion?"-=":"+=")+distance,el.animate(upAnim,speed,easing).animate(downAnim,speed,easing),distance=hide?2*distance:distance/2;hide&&(upAnim={opacity:0},upAnim[ref]=(motion?"-=":"+=")+distance,el.animate(upAnim,speed,easing)),el.queue(function(){hide&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),el.dequeue()},$.effects.effect.clip=function(o,done){var wrapper,animate,distance,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,direction=o.direction||"vertical",vert="vertical"===direction,size=vert?"height":"width",position=vert?"top":"left",animation={};$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),animate="IMG"===el[0].tagName?wrapper:el,distance=animate[size](),show&&(animate.css(size,0),animate.css(position,distance/2)),animation[size]=show?distance:0,animation[position]=show?0:distance/2,animate.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){show||el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})},$.effects.effect.drop=function(o,done){var distance,el=$(this),props=["position","top","bottom","left","right","opacity","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,direction=o.direction||"left",ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction?"pos":"neg",animation={opacity:show?1:0};$.effects.save(el,props),el.show(),$.effects.createWrapper(el),distance=o.distance||el["top"===ref?"outerHeight":"outerWidth"](!0)/2,show&&el.css("opacity",0).css(ref,"pos"===motion?-distance:distance),animation[ref]=(show?"pos"===motion?"+=":"-=":"pos"===motion?"-=":"+=")+distance,el.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})},$.effects.effect.explode=function(o,done){function childComplete(){pieces.push(this),pieces.length===rows*cells&&animComplete()}function animComplete(){el.css({visibility:"visible"}),$(pieces).remove(),show||el.hide(),done()}var i,j,left,top,mx,my,rows=o.pieces?Math.round(Math.sqrt(o.pieces)):3,cells=rows,el=$(this),mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,offset=el.show().css("visibility","hidden").offset(),width=Math.ceil(el.outerWidth()/cells),height=Math.ceil(el.outerHeight()/rows),pieces=[];for(i=0;i<rows;i++)for(top=offset.top+i*height,my=i-(rows-1)/2,j=0;j<cells;j++)left=offset.left+j*width,mx=j-(cells-1)/2,el.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},o.duration||500,o.easing,childComplete)},$.effects.effect.fade=function(o,done){var el=$(this),mode=$.effects.setMode(el,o.mode||"toggle");el.animate({opacity:mode},{queue:!1,duration:o.duration,easing:o.easing,complete:done})},$.effects.effect.fold=function(o,done){var wrapper,distance,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,hide="hide"===mode,size=o.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!o.horizFirst,widthFirst=show!==horizFirst,ref=widthFirst?["width","height"]:["height","width"],duration=o.duration/2,animation1={},animation2={};$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),distance=widthFirst?[wrapper.width(),wrapper.height()]:[wrapper.height(),wrapper.width()],percent&&(size=parseInt(percent[1],10)/100*distance[hide?0:1]),show&&wrapper.css(horizFirst?{height:0,width:size}:{height:size,width:0}),animation1[ref[0]]=show?distance[0]:size,animation2[ref[1]]=show?distance[1]:0,wrapper.animate(animation1,duration,o.easing).animate(animation2,duration,o.easing,function(){hide&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()})},$.effects.effect.highlight=function(o,done){var elem=$(this),props=["backgroundImage","backgroundColor","opacity"],mode=$.effects.setMode(elem,o.mode||"show"),animation={backgroundColor:elem.css("backgroundColor")};"hide"===mode&&(animation.opacity=0),$.effects.save(elem,props),elem.show().css({backgroundImage:"none",backgroundColor:o.color||"#ffff99"}).animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&elem.hide(),$.effects.restore(elem,props),done()}})},$.effects.effect.size=function(o,done){var original,baseline,factor,el=$(this),props0=["position","top","bottom","left","right","width","height","overflow","opacity"],props1=["position","top","bottom","left","right","overflow","opacity"],props2=["width","height","overflow"],cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=$.effects.setMode(el,o.mode||"effect"),restore=o.restore||"effect"!==mode,scale=o.scale||"both",origin=o.origin||["middle","center"],position=el.css("position"),props=restore?props0:props1,zero={height:0,width:0,outerHeight:0,outerWidth:0};"show"===mode&&el.show(),original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},"toggle"===o.mode&&"show"===mode?(el.from=o.to||zero,el.to=o.from||original):(el.from=o.from||("show"===mode?zero:original),el.to=o.to||("hide"===mode?zero:original)),factor={from:{y:el.from.height/original.height,x:el.from.width/original.width},to:{y:el.to.height/original.height,x:el.to.width/original.width}},"box"!==scale&&"both"!==scale||(factor.from.y!==factor.to.y&&(props=props.concat(vProps),el.from=$.effects.setTransition(el,vProps,factor.from.y,el.from),el.to=$.effects.setTransition(el,vProps,factor.to.y,el.to)),factor.from.x!==factor.to.x&&(props=props.concat(hProps),el.from=$.effects.setTransition(el,hProps,factor.from.x,el.from),el.to=$.effects.setTransition(el,hProps,factor.to.x,el.to))),"content"!==scale&&"both"!==scale||factor.from.y!==factor.to.y&&(props=props.concat(cProps).concat(props2),el.from=$.effects.setTransition(el,cProps,factor.from.y,el.from),el.to=$.effects.setTransition(el,cProps,factor.to.y,el.to)),$.effects.save(el,props),el.show(),$.effects.createWrapper(el),el.css("overflow","hidden").css(el.from),origin&&(baseline=$.effects.getBaseline(origin,original),el.from.top=(original.outerHeight-el.outerHeight())*baseline.y,el.from.left=(original.outerWidth-el.outerWidth())*baseline.x,el.to.top=(original.outerHeight-el.to.outerHeight)*baseline.y,el.to.left=(original.outerWidth-el.to.outerWidth)*baseline.x),el.css(el.from),"content"!==scale&&"both"!==scale||(vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps),hProps=hProps.concat(["marginLeft","marginRight"]),props2=props0.concat(vProps).concat(hProps),el.find("*[width]").each(function(){var child=$(this),c_original={height:child.height(),width:child.width(),outerHeight:child.outerHeight(),outerWidth:child.outerWidth()};restore&&$.effects.save(child,props2),child.from={height:c_original.height*factor.from.y,width:c_original.width*factor.from.x,outerHeight:c_original.outerHeight*factor.from.y,outerWidth:c_original.outerWidth*factor.from.x},child.to={height:c_original.height*factor.to.y,width:c_original.width*factor.to.x,outerHeight:c_original.height*factor.to.y,outerWidth:c_original.width*factor.to.x},factor.from.y!==factor.to.y&&(child.from=$.effects.setTransition(child,vProps,factor.from.y,child.from),child.to=$.effects.setTransition(child,vProps,factor.to.y,child.to)),factor.from.x!==factor.to.x&&(child.from=$.effects.setTransition(child,hProps,factor.from.x,child.from),child.to=$.effects.setTransition(child,hProps,factor.to.x,child.to)),child.css(child.from),child.animate(child.to,o.duration,o.easing,function(){restore&&$.effects.restore(child,props2)})})),el.animate(el.to,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){0===el.to.opacity&&el.css("opacity",el.from.opacity),"hide"===mode&&el.hide(),$.effects.restore(el,props),restore||("static"===position?el.css({position:"relative",top:el.to.top,left:el.to.left}):$.each(["top","left"],function(idx,pos){el.css(pos,function(_,str){var val=parseInt(str,10),toRef=idx?el.to.left:el.to.top;return"auto"===str?toRef+"px":val+toRef+"px"})})),$.effects.removeWrapper(el),done()}})},$.effects.effect.scale=function(o,done){var el=$(this),options=$.extend(!0,{},o),mode=$.effects.setMode(el,o.mode||"effect"),percent=parseInt(o.percent,10)||(0===parseInt(o.percent,10)?0:"hide"===mode?0:100),direction=o.direction||"both",origin=o.origin,original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},factor={y:"horizontal"!==direction?percent/100:1,x:"vertical"!==direction?percent/100:1};options.effect="size",options.queue=!1,options.complete=done,"effect"!==mode&&(options.origin=origin||["middle","center"],options.restore=!0),options.from=o.from||("show"===mode?{height:0,width:0,outerHeight:0,outerWidth:0}:original),options.to={height:original.height*factor.y,width:original.width*factor.x,outerHeight:original.outerHeight*factor.y,outerWidth:original.outerWidth*factor.x},options.fade&&("show"===mode&&(options.from.opacity=0,options.to.opacity=1),"hide"===mode&&(options.from.opacity=1,options.to.opacity=0)),el.effect(options)},$.effects.effect.puff=function(o,done){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"hide"),hide="hide"===mode,percent=parseInt(o.percent,10)||150,factor=percent/100,original={height:elem.height(),width:elem.width(),outerHeight:elem.outerHeight(),outerWidth:elem.outerWidth()};$.extend(o,{effect:"scale",queue:!1,fade:!0,mode:mode,complete:done,percent:hide?percent:100,from:hide?original:{height:original.height*factor,width:original.width*factor,outerHeight:original.outerHeight*factor,outerWidth:original.outerWidth*factor}}),elem.effect(o)},$.effects.effect.pulsate=function(o,done){var i,elem=$(this),mode=$.effects.setMode(elem,o.mode||"show"),show="show"===mode,hide="hide"===mode,showhide=show||"hide"===mode,anims=2*(o.times||5)+(showhide?1:0),duration=o.duration/anims,animateTo=0,queue=elem.queue(),queuelen=queue.length;for(!show&&elem.is(":visible")||(elem.css("opacity",0).show(),animateTo=1),i=1;i<anims;i++)elem.animate({opacity:animateTo},duration,o.easing),animateTo=1-animateTo;elem.animate({opacity:animateTo},duration,o.easing),elem.queue(function(){hide&&elem.hide(),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),elem.dequeue()},$.effects.effect.shake=function(o,done){var i,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),direction=o.direction||"left",distance=o.distance||20,times=o.times||3,anims=2*times+1,speed=Math.round(o.duration/anims),ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={},animation1={},animation2={},queue=el.queue(),queuelen=queue.length;for($.effects.save(el,props),el.show(),$.effects.createWrapper(el),animation[ref]=(positiveMotion?"-=":"+=")+distance,animation1[ref]=(positiveMotion?"+=":"-=")+2*distance,animation2[ref]=(positiveMotion?"-=":"+=")+2*distance,el.animate(animation,speed,o.easing),i=1;i<times;i++)el.animate(animation1,speed,o.easing).animate(animation2,speed,o.easing);el.animate(animation1,speed,o.easing).animate(animation,speed/2,o.easing).queue(function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),el.dequeue()},$.effects.effect.slide=function(o,done){var distance,el=$(this),props=["position","top","bottom","left","right","width","height"],mode=$.effects.setMode(el,o.mode||"show"),show="show"===mode,direction=o.direction||"left",ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={};$.effects.save(el,props),el.show(),distance=o.distance||el["top"===ref?"outerHeight":"outerWidth"](!0),$.effects.createWrapper(el).css({overflow:"hidden"}),show&&el.css(ref,positiveMotion?isNaN(distance)?"-"+distance:-distance:distance),animation[ref]=(show?positiveMotion?"+=":"-=":positiveMotion?"-=":"+=")+distance,el.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),
$.effects.removeWrapper(el),done()}})},$.effects.effect.transfer=function(o,done){var elem=$(this),target=$(o.to),targetFixed="fixed"===target.css("position"),body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=elem.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(o.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:elem.innerHeight(),width:elem.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,o.duration,o.easing,function(){transfer.remove(),done()})},$.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(newValue){return void 0===newValue?this.options.value:(this.options.value=this._constrainedValue(newValue),void this._refreshValue())},_constrainedValue:function(newValue){return void 0===newValue&&(newValue=this.options.value),this.indeterminate=newValue===!1,"number"!=typeof newValue&&(newValue=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,newValue))},_setOptions:function(options){var value=options.value;delete options.value,this._super(options),this.options.value=this._constrainedValue(value),this._refreshValue()},_setOption:function(key,value){"max"===key&&(value=Math.max(this.min,value)),"disabled"===key&&this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value),this._super(key,value)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).toggleClass("ui-corner-right",value===this.options.max).width(percentage.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==value&&(this.oldValue=value,this._trigger("change")),value===this.options.max&&this._trigger("complete")}}),$.widget("ui.selectable",$.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var selectees,that=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){selectees=$(that.options.filter,that.element[0]),selectees.addClass("ui-selectee"),selectees.each(function(){var $this=$(this),pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:!1,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=selectees.addClass("ui-selectee"),this._mouseInit(),this.helper=$("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY],this.options.disabled||(this.selectees=$(options.filter,this.element[0]),this._trigger("start",event),$(options.appendTo).append(this.helper),this.helper.css({left:event.pageX,top:event.pageY,width:0,height:0}),options.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=!0,event.metaKey||event.ctrlKey||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element}))}),$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");if(selectee)return doSelect=!event.metaKey&&!event.ctrlKey||!selectee.$element.hasClass("ui-selected"),selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting"),selectee.unselecting=!doSelect,selectee.selecting=doSelect,selectee.selected=doSelect,doSelect?that._trigger("selecting",event,{selecting:selectee.element}):that._trigger("unselecting",event,{unselecting:selectee.element}),!1}))},_mouseDrag:function(event){if(this.dragged=!0,!this.options.disabled){var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;return x1>x2&&(tmp=x2,x2=x1,x1=tmp),y1>y2&&(tmp=y2,y2=y1,y1=tmp),this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1}),this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=!1;selectee&&selectee.element!==that.element[0]&&("touch"===options.tolerance?hit=!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1):"fit"===options.tolerance&&(hit=selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2),hit?(selectee.selected&&(selectee.$element.removeClass("ui-selected"),selectee.selected=!1),selectee.unselecting&&(selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1),selectee.selecting||(selectee.$element.addClass("ui-selecting"),selectee.selecting=!0,that._trigger("selecting",event,{selecting:selectee.element}))):(selectee.selecting&&((event.metaKey||event.ctrlKey)&&selectee.startselected?(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.$element.addClass("ui-selected"),selectee.selected=!0):(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.startselected&&(selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0),that._trigger("unselecting",event,{unselecting:selectee.element}))),selectee.selected&&(event.metaKey||event.ctrlKey||selectee.startselected||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element})))))}),!1}},_mouseStop:function(event){var that=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1,selectee.startselected=!1,that._trigger("unselected",event,{unselected:selectee.element})}),$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected"),selectee.selecting=!1,selectee.selected=!0,selectee.startselected=!0,that._trigger("selected",event,{selected:selectee.element})}),this._trigger("stop",event),this.helper.remove(),!1}}),$.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var selectmenuId=this.element.uniqueId().attr("id");this.ids={element:selectmenuId,button:selectmenuId+"-button",menu:selectmenuId+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var that=this;this.label=$("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(event){this.button.focus(),event.preventDefault()}}),this.element.hide(),this.button=$("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),$("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=$("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){that.menuItems||that._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var that=this;this.menu=$("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=$("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(event,ui){event.preventDefault(),that._setSelection(),that._select(ui.item.data("ui-selectmenu-item"),event)},focus:function(event,ui){var item=ui.item.data("ui-selectmenu-item");null!=that.focusIndex&&item.index!==that.focusIndex&&(that._trigger("focus",event,{item:item}),that.isOpen||that._select(item,event)),that.focusIndex=item.index,that.button.attr("aria-activedescendant",that.menuItems.eq(item.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var item,options=this.element.find("option");options.length&&(this._parseOptions(options),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),item=this._getSelectedItem(),this.menuInstance.focus(null,item),this._setAria(item.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(event){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",event))},_position:function(){this.menuWrap.position($.extend({of:this.button},this.options.position))},close:function(event){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",event))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(ul,items){var that=this,currentOptgroup="";$.each(items,function(index,item){item.optgroup!==currentOptgroup&&($("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(item.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:item.optgroup}).appendTo(ul),currentOptgroup=item.optgroup),that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-selectmenu-item",item)},_renderItem:function(ul,item){var li=$("<li>");return item.disabled&&li.addClass("ui-state-disabled"),this._setText(li,item.label),li.appendTo(ul)},_setText:function(element,value){value?element.text(value):element.html("&#160;")},_move:function(direction,event){var item,next,filter=".ui-menu-item";this.isOpen?item=this.menuItems.eq(this.focusIndex):(item=this.menuItems.eq(this.element[0].selectedIndex),filter+=":not(.ui-state-disabled)"),next="first"===direction||"last"===direction?item["first"===direction?"prevAll":"nextAll"](filter).eq(-1):item[direction+"All"](filter).eq(0),next.length&&this.menuInstance.focus(event,next)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(event){this[this.isOpen?"close":"open"](event)},_setSelection:function(){var selection;this.range&&(window.getSelection?(selection=window.getSelection(),selection.removeAllRanges(),selection.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(event){this.isOpen&&($(event.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(event))}},_buttonEvents:{mousedown:function(){var selection;window.getSelection?(selection=window.getSelection(),selection.rangeCount&&(this.range=selection.getRangeAt(0))):this.range=document.selection.createRange()},click:function(event){this._setSelection(),this._toggle(event)},keydown:function(event){var preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event),preventDefault=!1;break;case $.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(event);break;case $.ui.keyCode.UP:event.altKey?this._toggle(event):this._move("prev",event);break;case $.ui.keyCode.DOWN:event.altKey?this._toggle(event):this._move("next",event);break;case $.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(event):this._toggle(event);break;case $.ui.keyCode.LEFT:this._move("prev",event);break;case $.ui.keyCode.RIGHT:this._move("next",event);break;case $.ui.keyCode.HOME:case $.ui.keyCode.PAGE_UP:this._move("first",event);break;case $.ui.keyCode.END:case $.ui.keyCode.PAGE_DOWN:this._move("last",event);break;default:this.menu.trigger(event),preventDefault=!1}preventDefault&&event.preventDefault()}},_selectFocusedItem:function(event){var item=this.menuItems.eq(this.focusIndex);item.hasClass("ui-state-disabled")||this._select(item.data("ui-selectmenu-item"),event)},_select:function(item,event){var oldIndex=this.element[0].selectedIndex;this.element[0].selectedIndex=item.index,this._setText(this.buttonText,item.label),this._setAria(item),this._trigger("select",event,{item:item}),item.index!==oldIndex&&this._trigger("change",event,{item:item}),this.close(event)},_setAria:function(item){var id=this.menuItems.eq(item.index).attr("id");this.button.attr({"aria-labelledby":id,"aria-activedescendant":id}),this.menu.attr("aria-activedescendant",id)},_setOption:function(key,value){"icons"===key&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(value.button),this._super(key,value),"appendTo"===key&&this.menuWrap.appendTo(this._appendTo()),"disabled"===key&&(this.menuInstance.option("disabled",value),this.button.toggleClass("ui-state-disabled",value).attr("aria-disabled",value),this.element.prop("disabled",value),value?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===key&&this._resizeButton()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front")),element.length||(element=this.document[0].body),element},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var width=this.options.width;width||(width=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(width)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(options){var data=[];options.each(function(index,item){var option=$(item),optgroup=option.parent("optgroup");data.push({element:option,index:index,value:option.val(),label:option.text(),optgroup:optgroup.attr("label")||"",disabled:optgroup.prop("disabled")||option.prop("disabled")})}),this.items=data},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),$.widget("ui.slider",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",handles=[];for(handleCount=options.values&&options.values.length||1,existingHandles.length>handleCount&&(existingHandles.slice(handleCount).remove(),existingHandles=existingHandles.slice(0,handleCount)),i=existingHandles.length;i<handleCount;i++)handles.push(handle);this.handles=existingHandles.add($(handles.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(i){$(this).data("ui-slider-handle-index",i)})},_createRange:function(){var options=this.options,classes="";options.range?(options.range===!0&&(options.values?options.values.length&&2!==options.values.length?options.values=[options.values[0],options.values[0]]:$.isArray(options.values)&&(options.values=options.values.slice(0)):options.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=$("<div></div>").appendTo(this.element),classes="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(classes+("min"===options.range||"max"===options.range?" ui-slider-range-"+options.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;return!o.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position),distance=this._valueMax()-this._valueMin()+1,this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))&&(distance=thisDistance,closestHandle=$(this),index=i)}),allowed=this._start(event,index),allowed!==!1&&(this._mouseSliding=!0,this._handleIndex=index,closestHandle.addClass("ui-state-active").focus(),offset=closestHandle.offset(),mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(event,index,normValue),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);return this._slide(event,this._handleIndex,normValue),!1},_mouseStop:function(event){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(event,this._handleIndex),this._change(event,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;return"horizontal"===this.orientation?(pixelTotal=this.elementSize.width,pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(pixelTotal=this.elementSize.height,pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),percentMouse=pixelMouse/pixelTotal,percentMouse>1&&(percentMouse=1),percentMouse<0&&(percentMouse=0),"vertical"===this.orientation&&(percentMouse=1-percentMouse),valueTotal=this._valueMax()-this._valueMin(),valueMouse=this._valueMin()+percentMouse*valueTotal,this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};return this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;this.options.values&&this.options.values.length?(otherVal=this.values(index?0:1),2===this.options.values.length&&this.options.range===!0&&(0===index&&newVal>otherVal||1===index&&newVal<otherVal)&&(newVal=otherVal),newVal!==this.values(index)&&(newValues=this.values(),newValues[index]=newVal,allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues}),otherVal=this.values(index?0:1),allowed!==!1&&this.values(index,newVal))):newVal!==this.value()&&(allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal}),allowed!==!1&&this.value(newVal))},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._lastChangedValue=index,this._trigger("change",event,uiHash)}},value:function(newValue){return arguments.length?(this.options.value=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,0)):this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1)return this.options.values[index]=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,index);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(index):this.value();for(vals=this.options.values,newValues=arguments[0],i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(newValues[i]),this._change(null,i);this._refreshValue()},_setOption:function(key,value){var i,valsLength=0;switch("range"===key&&this.options.range===!0&&("min"===value?(this.options.value=this._values(0),this.options.values=null):"max"===value&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(valsLength=this.options.values.length),"disabled"===key&&this.element.toggleClass("ui-state-disabled",!!value),this._super(key,value),key){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===value?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;i<valsLength;i+=1)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var val=this.options.value;return val=this._trimAlignValue(val)},_values:function(index){var val,vals,i;if(arguments.length)return val=this.options.values[index],val=this._trimAlignValue(val);if(this.options.values&&this.options.values.length){for(vals=this.options.values.slice(),i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(vals[i]);return vals}return[]},_trimAlignValue:function(val){if(val<=this._valueMin())return this._valueMin();if(val>=this._valueMax())return this._valueMax();var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;return 2*Math.abs(valModStep)>=step&&(alignValue+=valModStep>0?step:-step),parseFloat(alignValue.toFixed(5))},_calculateNewMax:function(){var max=this.options.max,min=this._valueMin(),step=this.options.step,aboveMin=Math.floor(+(max-min).toFixed(this._precision())/step)*step;max=aboveMin+min,this.max=parseFloat(max.toFixed(this._precision()))},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=!this._animateOff&&o.animate,_set={};this.options.values&&this.options.values.length?this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100,_set["horizontal"===that.orientation?"left":"bottom"]=valPercent+"%",$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate),that.options.range===!0&&("horizontal"===that.orientation?(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate})):(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate}))),lastValPercent=valPercent}):(value=this.value(),valueMin=this._valueMin(),valueMax=this._valueMax(),valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0,_set["horizontal"===this.orientation?"left":"bottom"]=valPercent+"%",this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate),"min"===oRange&&"horizontal"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate),"max"===oRange&&"horizontal"===this.orientation&&this.range[animate?"animate":"css"]({width:100-valPercent+"%"},{queue:!1,duration:o.animate}),"min"===oRange&&"vertical"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate),"max"===oRange&&"vertical"===this.orientation&&this.range[animate?"animate":"css"]({height:100-valPercent+"%"},{queue:!1,duration:o.animate}))},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(event.preventDefault(),!this._keySliding&&(this._keySliding=!0,$(event.target).addClass("ui-state-active"),allowed=this._start(event,index),allowed===!1))return}switch(step=this.options.step,curVal=newVal=this.options.values&&this.options.values.length?this.values(index):this.value(),event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax())return;newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin())return;newVal=this._trimAlignValue(curVal-step)}this._slide(event,index,newVal)},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(event,index),this._change(event,index),$(event.target).removeClass("ui-state-active"))}}}),$.widget("ui.sortable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return x>=reference&&x<reference+size},_isFloating:function(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(key,value){this._super(key,value),"handle"===key&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),$.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--)this.items[i].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=!1,that=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(event),$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that)return currentItem=$(this),!1}),$.data(event.target,that.widgetName+"-item")===that&&(currentItem=$(event.target)),!!currentItem&&(!(this.options.handle&&!overrideHandle&&($(this.options.handle,currentItem).find("*").addBack().each(function(){this===event.target&&(validHandle=!0)}),!validHandle))&&(this.currentItem=currentItem,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;
if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(event),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(body=this.document.find("body"),this.storedCursor=body.css("cursor"),body.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",event,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!noActivation)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",event,this._uiHash(this));return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(event),!0},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=!1;for(this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(event.pageY-this.document.scrollTop()<o.scrollSensitivity?scrolled=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(event.pageY-this.document.scrollTop())<o.scrollSensitivity&&(scrolled=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),event.pageX-this.document.scrollLeft()<o.scrollSensitivity?scrolled=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(event.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(scrolled=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(item=this.items[i],itemElement=item.item[0],intersection=this._intersectsWithPointer(item),intersection&&item.instance===this.currentContainer&&!(itemElement===this.currentItem[0]||this.placeholder[1===intersection?"next":"prev"]()[0]===itemElement||$.contains(this.placeholder[0],itemElement)||"semi-dynamic"===this.options.type&&$.contains(this.element[0],itemElement))){if(this.direction=1===intersection?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(item))break;this._rearrange(event,item),this._trigger("change",event,this._uiHash());break}return this._contactContainers(event),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),this._trigger("sort",event,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(event,noPropagation){if(event){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,event),this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};axis&&"x"!==axis||(animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),axis&&"y"!==axis||(animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event)})}else this._clear(event,noPropagation);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("deactivate",null,this._uiHash(this)),this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",null,this._uiHash(this)),this.containers[i].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];return o=o||{},$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||/(.+)[\-=_](.+)/);res&&str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}),!str.length&&o.key&&str.push(o.key+"="),str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];return o=o||{},items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")}),ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight="x"===this.options.axis||y1+dyClick>t&&y1+dyClick<b,isOverElementWidth="y"===this.options.axis||x1+dxClick>l&&x1+dxClick<r,isOverElement=isOverElementHeight&&isOverElementWidth;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"]?isOverElement:l<x1+this.helperProportions.width/2&&x2-this.helperProportions.width/2<r&&t<y1+this.helperProportions.height/2&&y2-this.helperProportions.height/2<b},_intersectsWithPointer:function(item){var isOverElementHeight="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return!!isOverElement&&(this.floating?horizontalDirection&&"right"===horizontalDirection||"down"===verticalDirection?2:1:verticalDirection&&("down"===verticalDirection?2:1))},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+item.height/2,item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+item.width/2,item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return this.floating&&horizontalDirection?"right"===horizontalDirection&&isOverRightHalf||"left"===horizontalDirection&&!isOverRightHalf:verticalDirection&&("down"===verticalDirection&&isOverBottomHalf||"up"===verticalDirection&&!isOverBottomHalf)},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return 0!==delta&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return 0!==delta&&(delta>0?"right":"left")},refresh:function(event){return this._refreshItems(event),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){function addItems(){items.push(this)}var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i],this.document[0]),j=cur.length-1;j>=0;j--)inst=$.data(cur[j],this.widgetFullName),inst&&inst!==this&&!inst.options.disabled&&queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);for(queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=queries.length-1;i>=0;i--)queries[i][0].each(addItems);return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++)if(list[j]===item.item[0])return!1;return!0})},_refreshItems:function(event){this.items=[],this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i],this.document[0]),j=cur.length-1;j>=0;j--)inst=$.data(cur[j],this.widgetFullName),inst&&inst!==this&&!inst.options.disabled&&(queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]),this.containers.push(inst));for(i=queries.length-1;i>=0;i--)for(targetData=queries[i][1],_queries=queries[i][0],j=0,queriesLength=_queries.length;j<queriesLength;j++)item=$(_queries[j]),item.data(this.widgetName+"-item",targetData),items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})},refreshPositions:function(fast){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,item,t,p;for(i=this.items.length-1;i>=0;i--)item=this.items[i],item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]||(t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item,fast||(item.width=t.outerWidth(),item.height=t.outerHeight()),p=t.offset(),item.left=p.left,item.top=p.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)p=this.containers[i].element.offset(),this.containers[i].containerCache.left=p.left,this.containers[i].containerCache.top=p.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(that){that=that||this;var className,o=that.options;o.placeholder&&o.placeholder.constructor!==String||(className=o.placeholder,o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===nodeName?that._createTrPlaceholder(that.currentItem.find("tr").eq(0),$("<tr>",that.document[0]).appendTo(element)):"tr"===nodeName?that._createTrPlaceholder(that.currentItem,element):"img"===nodeName&&element.attr("src",that.currentItem.attr("src")),className||element.css("visibility","hidden"),element},update:function(container,p){className&&!o.forcePlaceholderSize||(p.height()||p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10)),p.width()||p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10)))}}),that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem)),that.currentItem.after(that.placeholder),o.placeholder.update(that,that.placeholder)},_createTrPlaceholder:function(sourceTr,targetTr){var that=this;sourceTr.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(targetTr)})},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--)if(!$.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0]))continue;innermostContainer=this.containers[i],innermostIndex=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",event,this._uiHash(this)),this.containers[i].containerCache.over=0);if(innermostContainer)if(1===this.containers.length)this.containers[innermostIndex].containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1);else{for(dist=1e4,itemWithLeastDistance=null,floating=innermostContainer.floating||this._isFloating(this.currentItem),posProperty=floating?"left":"top",sizeProperty=floating?"width":"height",axis=floating?"clientX":"clientY",j=this.items.length-1;j>=0;j--)$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])&&this.items[j].item[0]!==this.currentItem[0]&&(cur=this.items[j].item.offset()[posProperty],nearBottom=!1,event[axis]-cur>this.items[j][sizeProperty]/2&&(nearBottom=!0),Math.abs(event[axis]-cur)<dist&&(dist=Math.abs(event[axis]-cur),itemWithLeastDistance=this.items[j],this.direction=nearBottom?"up":"down"));if(!itemWithLeastDistance&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[innermostIndex])return void(this.currentContainer.containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash()),this.currentContainer.containerCache.over=1));itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,!0):this._rearrange(event,null,this.containers[innermostIndex].element,!0),this._trigger("change",event,this._uiHash()),this.containers[innermostIndex]._trigger("change",event,this._uiHash(this)),this.currentContainer=this.containers[innermostIndex],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return helper.parents("body").length||$("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]),helper[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),helper[0].style.width&&!o.forceHelperSize||helper.width(this.currentItem.width()),helper[0].style.height&&!o.forceHelperSize||helper.height(this.currentItem.height()),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ce,co,over,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===o.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===o.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(ce=$(o.containment)[0],co=$(o.containment).offset(),over="hidden"!==$(ce).css("overflow"),this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop())*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod}},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(event.pageX-this.offset.click.left<this.containment[0]&&(pageX=this.containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<this.containment[1]&&(pageY=this.containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>this.containment[2]&&(pageX=this.containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>this.containment[3]&&(pageY=this.containment[3]+this.offset.click.top)),o.grid&&(top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1],pageY=this.containment?top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3]?top:top-this.offset.click.top>=this.containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0],pageX=this.containment?left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2]?left:left-this.offset.click.left>=this.containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop()),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?i.item[0]:i.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){counter===this.counter&&this.refreshPositions(!hardRefresh)})},_clear:function(event,noPropagation){function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance))}}this.reverting=!1;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!noPropagation&&delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||noPropagation||delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())}),this!==this.currentContainer&&(noPropagation||(delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())}),delayedTriggers.push(function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}.call(this,this.currentContainer)),delayedTriggers.push(function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)noPropagation||delayedTriggers.push(delayEvent("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(delayedTriggers.push(delayEvent("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,noPropagation||this._trigger("beforeStop",event,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!noPropagation){for(i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){$.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null}}}),$.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var options={},element=this.element;return $.each(["min","max","step"],function(i,option){var value=element.attr(option);void 0!==value&&value.length&&(options[option]=value)}),options},_events:{keydown:function(event){this._start(event)&&this._keydown(event)&&event.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(event){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",event)))},mousewheel:function(event,delta){if(delta){if(!this.spinning&&!this._start(event))return!1;this._spin((delta>0?1:-1)*this.options.step,event),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(event)},100),event.preventDefault()}},"mousedown .ui-spinner-button":function(event){function checkFocus(){var isActive=this.element[0]===this.document[0].activeElement;isActive||(this.element.focus(),this.previous=previous,this._delay(function(){this.previous=previous}))}var previous;previous=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),event.preventDefault(),checkFocus.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,checkFocus.call(this)}),this._start(event)!==!1&&this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){if($(event.currentTarget).hasClass("ui-state-active"))return this._start(event)!==!1&&void this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var uiSpinner=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=uiSpinner.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*uiSpinner.height())&&uiSpinner.height()>0&&uiSpinner.height(uiSpinner.height()),this.options.disabled&&this.disable()},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:return this._repeat(null,1,event),!0;case keyCode.DOWN:return this._repeat(null,-1,event),!0;case keyCode.PAGE_UP:return this._repeat(null,options.page,event),!0;case keyCode.PAGE_DOWN:return this._repeat(null,-options.page,event),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(event){return!(!this.spinning&&this._trigger("start",event)===!1)&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(i,steps,event){i=i||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,steps,event)},i),this._spin(steps*this.options.step,event)},_spin:function(step,event){var value=this.value()||0;this.counter||(this.counter=1),value=this._adjustValue(value+step*this._increment(this.counter)),this.spinning&&this._trigger("spin",event,{value:value})===!1||(this._value(value),this.counter++)},_increment:function(i){var incremental=this.options.incremental;return incremental?$.isFunction(incremental)?incremental(i):Math.floor(i*i*i/5e4-i*i/500+17*i/200+1):1},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1},_adjustValue:function(value){var base,aboveMin,options=this.options;return base=null!==options.min?options.min:0,aboveMin=value-base,aboveMin=Math.round(aboveMin/options.step)*options.step,value=base+aboveMin,value=parseFloat(value.toFixed(this._precision())),null!==options.max&&value>options.max?options.max:null!==options.min&&value<options.min?options.min:value},_stop:function(event){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",event))},_setOption:function(key,value){if("culture"===key||"numberFormat"===key){var prevValue=this._parse(this.element.val());return this.options[key]=value,void this.element.val(this._format(prevValue))}"max"!==key&&"min"!==key&&"step"!==key||"string"==typeof value&&(value=this._parse(value)),"icons"===key&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(value.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(value.down)),this._super(key,value),"disabled"===key&&(this.widget().toggleClass("ui-state-disabled",!!value),this.element.prop("disabled",!!value),this.buttons.button(value?"disable":"enable"))},_setOptions:spinner_modifier(function(options){this._super(options)}),_parse:function(val){return"string"==typeof val&&""!==val&&(val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val),""===val||isNaN(val)?null:val},_format:function(value){return""===value?"":window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value},_refresh:function(){
this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var value=this.value();return null!==value&&value===this._adjustValue(value)},_value:function(value,allowAny){var parsed;""!==value&&(parsed=this._parse(value),null!==parsed&&(allowAny||(parsed=this._adjustValue(parsed)),value=this._format(parsed))),this.element.val(value),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:spinner_modifier(function(steps){this._stepUp(steps)}),_stepUp:function(steps){this._start()&&(this._spin((steps||1)*this.options.step),this._stop())},stepDown:spinner_modifier(function(steps){this._stepDown(steps)}),_stepDown:function(steps){this._start()&&(this._spin((steps||1)*-this.options.step),this._stop())},pageUp:spinner_modifier(function(pages){this._stepUp((pages||1)*this.options.page)}),pageDown:spinner_modifier(function(pages){this._stepDown((pages||1)*this.options.page)}),value:function(newVal){return arguments.length?void spinner_modifier(this._value).call(this,newVal):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),$.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchor=anchor.cloneNode(!1),anchorUrl=anchor.href.replace(rhash,""),locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl)}catch(error){}try{locationUrl=decodeURIComponent(locationUrl)}catch(error){}return anchor.hash.length>1&&anchorUrl===locationUrl}}(),_create:function(){var that=this,options=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible),this._processTabs(),options.active=this._initialActive(),$.isArray(options.disabled)&&(options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(options.active):this.active=$(),this._refresh(),this.active.length&&this.load(options.active)},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);return null===active&&(locationHash&&this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash)return active=i,!1}),null===active&&(active=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==active&&active!==-1||(active=!!this.tabs.length&&0)),active!==!1&&(active=this.tabs.index(this.tabs.eq(active)),active===-1&&(active=!collapsible&&0)),!collapsible&&active===!1&&this.anchors.length&&(active=0),active},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=!0;if(!this._handlePageNav(event)){switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=!1,selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex);case $.ui.keyCode.ENTER:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex!==this.options.active&&selectedIndex);default:return}event.preventDefault(),clearTimeout(this.activating),selectedIndex=this._focusNextTab(selectedIndex,goingForward),event.ctrlKey||event.metaKey||(focusedTab.attr("aria-selected","false"),this.tabs.eq(selectedIndex).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",selectedIndex)},this.delay))}},_panelKeydown:function(event){this._handlePageNav(event)||event.ctrlKey&&event.keyCode===$.ui.keyCode.UP&&(event.preventDefault(),this.active.focus())},_handlePageNav:function(event){return event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(index,goingForward){function constrain(){return index>lastTabIndex&&(index=0),index<0&&(index=lastTabIndex),index}for(var lastTabIndex=this.tabs.length-1;$.inArray(constrain(),this.options.disabled)!==-1;)index=goingForward?index+1:index-1;return index},_focusNextTab:function(index,goingForward){return index=this._findNextTab(index,goingForward),this.tabs.eq(index).focus(),index},_setOption:function(key,value){return"active"===key?void this._activate(value):"disabled"===key?void this._setupDisabled(value):(this._super(key,value),"collapsible"===key&&(this.element.toggleClass("ui-tabs-collapsible",value),value||this.options.active!==!1||this._activate(0)),"event"===key&&this._setupEvents(value),void("heightStyle"===key&&this._setupHeightStyle(value)))},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)}),this._processTabs(),options.active!==!1&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===options.disabled.length?(options.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,options.active-1),!1)):options.active=this.tabs.index(this.active):(options.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(event){$(this).is(".ui-state-disabled")&&event.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){$(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=$(),this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");that._isLocal(anchor)?(selector=anchor.hash,panelId=selector.substring(1),panel=that.element.find(that._sanitizeSelector(selector))):(panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id,selector="#"+panelId,panel=that.element.find(selector),panel.length||(panel=that._createPanel(panelId),panel.insertAfter(that.panels[i-1]||that.tablist)),panel.attr("aria-live","polite")),panel.length&&(that.panels=that.panels.add(panel)),originalAriaControls&&tab.data("ui-tabs-aria-controls",originalAriaControls),tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId}),panel.attr("aria-labelledby",anchorId)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),prevTabs&&(this._off(prevTabs.not(this.tabs)),this._off(prevAnchors.not(this.anchors)),this._off(prevPanels.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(disabled){$.isArray(disabled)&&(disabled.length?disabled.length===this.anchors.length&&(disabled=!0):disabled=!1);for(var li,i=0;li=this.tabs[i];i++)disabled===!0||$.inArray(i,disabled)!==-1?$(li).addClass("ui-state-disabled").attr("aria-disabled","true"):$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=disabled},_setupEvents:function(event){var events={};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(event){event.preventDefault()}}),this._on(this.anchors,events),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();"fill"===heightStyle?(maxHeight=parent.height(),maxHeight-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(!0)}),this.panels.each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight))},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=active.length?this._getPanelForTab(active):$(),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault(),tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||clickedIsActive&&!options.collapsible||this._trigger("beforeActivate",event,eventData)===!1||(options.active=!collapsing&&this.tabs.index(tab),this.active=clickedIsActive?$():tab,this.xhr&&this.xhr.abort(),toHide.length||toShow.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),toShow.length&&this.load(this.tabs.index(tab),event),this._toggle(event,eventData))},_toggle:function(event,eventData){function complete(){that.running=!1,that._trigger("activate",event,eventData)}function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),toShow.length&&that.options.show?that._show(toShow,that.options.show,complete):(toShow.show(),complete())}var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=!0,toHide.length&&this.options.hide?this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),show()}):(eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),toHide.hide(),show()),toHide.attr("aria-hidden","true"),eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),toShow.length&&toHide.length?eventData.oldTab.attr("tabIndex",-1):toShow.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),toShow.attr("aria-hidden","false"),eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(index){var anchor,active=this._findActive(index);active[0]!==this.active[0]&&(active.length||(active=this.active),anchor=active.find(".ui-tabs-anchor")[0],this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop}))},_findActive:function(index){return index===!1?$():this.tabs.eq(index)},_getIndex:function(index){return"string"==typeof index&&(index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"))),index},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){$.data(this,"ui-tabs-destroy")?$(this).remove():$(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");prev?li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls"):li.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(index){var disabled=this.options.disabled;disabled!==!1&&(void 0===index?disabled=!1:(index=this._getIndex(index),disabled=$.isArray(disabled)?$.map(disabled,function(num){return num!==index?num:null}):$.map(this.tabs,function(li,num){return num!==index?num:null})),this._setupDisabled(disabled))},disable:function(index){var disabled=this.options.disabled;if(disabled!==!0){if(void 0===index)disabled=!0;else{if(index=this._getIndex(index),$.inArray(index,disabled)!==-1)return;disabled=$.isArray(disabled)?$.merge([index],disabled).sort():[index]}this._setupDisabled(disabled)}},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel},complete=function(jqXHR,status){"abort"===status&&that.panels.stop(!1,!0),tab.removeClass("ui-tabs-loading"),panel.removeAttr("aria-busy"),jqXHR===that.xhr&&delete that.xhr};this._isLocal(anchor[0])||(this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData)),this.xhr&&"canceled"!==this.xhr.statusText&&(tab.addClass("ui-tabs-loading"),panel.attr("aria-busy","true"),this.xhr.done(function(response,status,jqXHR){setTimeout(function(){panel.html(response),that._trigger("load",event,eventData),complete(jqXHR,status)},1)}).fail(function(jqXHR,status){setTimeout(function(){complete(jqXHR,status)},1)})))},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}}},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}}),$.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id),elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")))},_removeDescribedBy:function(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);index!==-1&&describedby.splice(index,1),elem.removeData("ui-tooltip-id"),describedby=$.trim(describedby.join(" ")),describedby?elem.attr("aria-describedby",describedby):elem.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(key,value){var that=this;return"disabled"===key?(this[value?"_disable":"_enable"](),void(this.options[key]=value)):(this._super(key,value),void("content"===key&&$.each(this.tooltips,function(id,tooltipData){that._updateContent(tooltipData.element)})))},_disable:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur");event.target=event.currentTarget=tooltipData.element[0],that.close(event,!0)}),this.element.find(this.options.items).addBack().each(function(){var element=$(this);element.is("[title]")&&element.data("ui-tooltip-title",element.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var element=$(this);element.data("ui-tooltip-title")&&element.attr("title",element.data("ui-tooltip-title"))})},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);target.length&&!target.data("ui-tooltip-id")&&(target.attr("title")&&target.data("ui-tooltip-title",target.attr("title")),target.data("ui-tooltip-open",!0),event&&"mouseover"===event.type&&target.parents().each(function(){var blurEvent,parent=$(this);parent.data("ui-tooltip-open")&&(blurEvent=$.Event("blur"),blurEvent.target=blurEvent.currentTarget=this,that.close(blurEvent,!0)),parent.attr("title")&&(parent.uniqueId(),that.parents[this.id]={element:this,title:parent.attr("title")},parent.attr("title",""))}),this._registerCloseHandlers(event,target),this._updateContent(target,event))},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;return"string"==typeof contentOption?this._open(event,target,contentOption):(content=contentOption.call(target[0],function(response){that._delay(function(){target.data("ui-tooltip-open")&&(event&&(event.type=eventType),this._open(event,target,response))})}),void(content&&this._open(event,target,content)))},_open:function(event,target,content){function position(event){positionOption.of=event,tooltip.is(":hidden")||tooltip.position(positionOption)}var tooltipData,tooltip,delayedShow,a11yContent,positionOption=$.extend({},this.options.position);if(content){if(tooltipData=this._find(target))return void tooltipData.tooltip.find(".ui-tooltip-content").html(content);target.is("[title]")&&(event&&"mouseover"===event.type?target.attr("title",""):target.removeAttr("title")),tooltipData=this._tooltip(target),tooltip=tooltipData.tooltip,this._addDescribedBy(target,tooltip.attr("id")),tooltip.find(".ui-tooltip-content").html(content),this.liveRegion.children().hide(),content.clone?(a11yContent=content.clone(),a11yContent.removeAttr("id").find("[id]").removeAttr("id")):a11yContent=content,$("<div>").html(a11yContent).appendTo(this.liveRegion),this.options.track&&event&&/^mouse/.test(event.type)?(this._on(this.document,{mousemove:position}),position(event)):tooltip.position($.extend({of:target},this.options.position)),tooltip.hide(),this._show(tooltip,this.options.show),this.options.show&&this.options.show.delay&&(delayedShow=this.delayedShow=setInterval(function(){tooltip.is(":visible")&&(position(positionOption.of),clearInterval(delayedShow))},$.fx.interval)),this._trigger("open",event,{tooltip:tooltip})}},_registerCloseHandlers:function(event,target){var events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0],this.close(fakeEvent,!0)}}};target[0]!==this.element[0]&&(events.remove=function(){this._removeTooltip(this._find(target).tooltip)}),event&&"mouseover"!==event.type||(events.mouseleave="close"),event&&"focusin"!==event.type||(events.focusout="close"),this._on(!0,target,events)},close:function(event){var tooltip,that=this,target=$(event?event.currentTarget:this.element),tooltipData=this._find(target);return tooltipData?(tooltip=tooltipData.tooltip,void(tooltipData.closing||(clearInterval(this.delayedShow),target.data("ui-tooltip-title")&&!target.attr("title")&&target.attr("title",target.data("ui-tooltip-title")),this._removeDescribedBy(target),tooltipData.hiding=!0,tooltip.stop(!0),this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this))}),target.removeData("ui-tooltip-open"),this._off(target,"mouseleave focusout keyup"),target[0]!==this.element[0]&&this._off(target,"remove"),this._off(this.document,"mousemove"),event&&"mouseleave"===event.type&&$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title),delete that.parents[id]}),tooltipData.closing=!0,this._trigger("close",event,{tooltip:tooltip}),tooltipData.hiding||(tooltipData.closing=!1)))):void target.removeData("ui-tooltip-open")},_tooltip:function(element){var tooltip=$("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),id=tooltip.uniqueId().attr("id");return $("<div>").addClass("ui-tooltip-content").appendTo(tooltip),tooltip.appendTo(this.document[0].body),this.tooltips[id]={element:element,tooltip:tooltip}},_find:function(target){var id=target.data("ui-tooltip-id");return id?this.tooltips[id]:null},_removeTooltip:function(tooltip){tooltip.remove(),delete this.tooltips[tooltip.attr("id")]},_destroy:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur"),element=tooltipData.element;event.target=event.currentTarget=element[0],that.close(event,!0),$("#"+id).remove(),element.data("ui-tooltip-title")&&(element.attr("title")||element.attr("title",element.data("ui-tooltip-title")),element.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.moment=factory()}(this,function(){"use strict";function utils_hooks__hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return input instanceof Array||"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return input instanceof Date||"[object Date]"===Object.prototype.toString.call(input)}function map(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function create_utc__createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function getParsingFlags(m){return null==m._pf&&(m._pf=defaultParsingFlags()),m._pf}function valid__isValid(m){if(null==m._isValid){var flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,function(i){return null!=i});m._isValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts),m._strict&&(m._isValid=m._isValid&&0===flags.charsLeftOver&&0===flags.unusedTokens.length&&void 0===flags.bigHour)}return m._isValid}function valid__createInvalid(flags){var m=create_utc__createUTC(NaN);return null!=flags?extend(getParsingFlags(m),flags):getParsingFlags(m).userInvalidated=!0,m}function isUndefined(input){return void 0===input}function copyConfig(to,from){var i,prop,val;if(isUndefined(from._isAMomentObject)||(to._isAMomentObject=from._isAMomentObject),isUndefined(from._i)||(to._i=from._i),isUndefined(from._f)||(to._f=from._f),isUndefined(from._l)||(to._l=from._l),isUndefined(from._strict)||(to._strict=from._strict),isUndefined(from._tzm)||(to._tzm=from._tzm),isUndefined(from._isUTC)||(to._isUTC=from._isUTC),isUndefined(from._offset)||(to._offset=from._offset),isUndefined(from._pf)||(to._pf=getParsingFlags(from)),isUndefined(from._locale)||(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)prop=momentProperties[i],val=from[prop],isUndefined(val)||(to[prop]=val);return to}function Moment(config){copyConfig(this,config),this._d=new Date(null!=config._d?config._d.getTime():NaN),updateInProgress===!1&&(updateInProgress=!0,utils_hooks__hooks.updateOffset(this),updateInProgress=!1)}function isMoment(obj){return obj instanceof Moment||null!=obj&&null!=obj._isAMomentObject}function absFloor(number){return number<0?Math.ceil(number):Math.floor(number)}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=absFloor(coercedNumber)),value}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function warn(msg){utils_hooks__hooks.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return null!=utils_hooks__hooks.deprecationHandler&&utils_hooks__hooks.deprecationHandler(null,msg),firstTime&&(warn(msg+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),firstTime=!1),fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){null!=utils_hooks__hooks.deprecationHandler&&utils_hooks__hooks.deprecationHandler(name,msg),deprecations[name]||(warn(msg),deprecations[name]=!0)}function isFunction(input){return input instanceof Function||"[object Function]"===Object.prototype.toString.call(input)}function isObject(input){return"[object Object]"===Object.prototype.toString.call(input)}function locale_set__set(config){var prop,i;for(i in config)prop=config[i],isFunction(prop)?this[i]=prop:this["_"+i]=prop;this._config=config,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var prop,res=extend({},parentConfig);for(prop in childConfig)hasOwnProp(childConfig,prop)&&(isObject(parentConfig[prop])&&isObject(childConfig[prop])?(res[prop]={},extend(res[prop],parentConfig[prop]),extend(res[prop],childConfig[prop])):null!=childConfig[prop]?res[prop]=childConfig[prop]:delete res[prop]);return res}function Locale(config){null!=config&&this.set(config)}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(split=normalizeLocale(names[i]).split("-"),j=split.length,next=normalizeLocale(names[i+1]),next=next?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&"undefined"!=typeof module&&module&&module.exports)try{oldLocale=globalLocale._abbr,require("./locale/"+name),locale_locales__getSetGlobalLocale(oldLocale)}catch(e){}return locales[name]}function locale_locales__getSetGlobalLocale(key,values){var data;return key&&(data=isUndefined(values)?locale_locales__getLocale(key):defineLocale(key,values),data&&(globalLocale=data)),globalLocale._abbr}function defineLocale(name,config){return null!==config?(config.abbr=name,null!=locales[name]?(deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),config=mergeConfigs(locales[name]._config,config)):null!=config.parentLocale&&(null!=locales[config.parentLocale]?config=mergeConfigs(locales[config.parentLocale]._config,config):deprecateSimple("parentLocaleUndefined","specified parentLocale is not defined yet")),locales[name]=new Locale(config),locale_locales__getSetGlobalLocale(name),locales[name]):(delete locales[name],null)}function updateLocale(name,config){if(null!=config){var locale;null!=locales[name]&&(config=mergeConfigs(locales[name]._config,config)),locale=new Locale(config),locale.parentLocale=locales[name],locales[name]=locale,locale_locales__getSetGlobalLocale(name)}else null!=locales[name]&&(null!=locales[name].parentLocale?locales[name]=locales[name].parentLocale:null!=locales[name]&&delete locales[name]);return locales[name]}function locale_locales__getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return globalLocale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)}function locale_locales__listLocales(){return keys(locales)}function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return"string"==typeof units?aliases[units]||aliases[units.toLowerCase()]:void 0}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeGetSet(unit,keepTime){return function(value){return null!=value?(get_set__set(this,unit,value),utils_hooks__hooks.updateOffset(this,keepTime),this):get_set__get(this,unit)}}function get_set__get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function get_set__set(mom,unit,value){mom.isValid()&&mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function getSet(units,value){var unit;if("object"==typeof units)for(unit in units)this.set(unit,units[unit]);else if(units=normalizeUnits(units),isFunction(this[units]))return this[units](value);return this}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}function addFormatToken(token,padded,ordinal,callback){var func=callback;"string"==typeof callback&&(func=function(){return this[callback]()}),token&&(formatTokenFunctions[token]=func),padded&&(formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}),ordinal&&(formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)})}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=removeFormattingTokens(array[i]);return function(mom){
var i,output="";for(i=0;i<length;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){return hasOwnProp(regexes,token)?regexes[token](config._strict,config._locale):new RegExp(unescapeFormat(token))}function unescapeFormat(s){return regexEscape(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function addParseToken(token,callback){var i,func=callback;for("string"==typeof token&&(token=[token]),"number"==typeof callback&&(func=function(input,array){array[callback]=toInt(input)}),i=0;i<token.length;i++)tokens[token[i]]=func}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{},callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){null!=input&&hasOwnProp(tokens,token)&&tokens[token](input,config._a,config,token)}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function localeMonths(m,format){return isArray(this._months)?this._months[m.month()]:this._months[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function localeMonthsShort(m,format){return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function units_month__handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)mom=create_utc__createUTC([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase();return strict?"MMM"===format?(ii=indexOf.call(this._shortMonthsParse,llc),ii!==-1?ii:null):(ii=indexOf.call(this._longMonthsParse,llc),ii!==-1?ii:null):"MMM"===format?(ii=indexOf.call(this._shortMonthsParse,llc),ii!==-1?ii:(ii=indexOf.call(this._longMonthsParse,llc),ii!==-1?ii:null)):(ii=indexOf.call(this._longMonthsParse,llc),ii!==-1?ii:(ii=indexOf.call(this._shortMonthsParse,llc),ii!==-1?ii:null))}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact)return units_month__handleStrictParse.call(this,monthName,format,strict);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(mom=create_utc__createUTC([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid())return mom;if("string"==typeof value)if(/^\d+$/.test(value))value=toInt(value);else if(value=mom.localeData().monthsParse(value),"number"!=typeof value)return mom;return dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom}function getSetMonth(value){return null!=value?(setMonth(this,value),utils_hooks__hooks.updateOffset(this,!0),this):get_set__get(this,"Month")}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex}function monthsRegex(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<12;i++)mom=create_utc__createUTC([2e3,i]),shortPieces.push(this.monthsShort(mom,"")),longPieces.push(this.months(mom,"")),mixedPieces.push(this.months(mom,"")),mixedPieces.push(this.monthsShort(mom,""));for(shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),i=0;i<12;i++)shortPieces[i]=regexEscape(shortPieces[i]),longPieces[i]=regexEscape(longPieces[i]),mixedPieces[i]=regexEscape(mixedPieces[i]);this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function checkOverflow(m){var overflow,a=m._a;return a&&getParsingFlags(m).overflow===-2&&(overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||24===a[HOUR]&&(0!==a[MINUTE]||0!==a[SECOND]||0!==a[MILLISECOND])?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),getParsingFlags(m)._overflowWeeks&&overflow===-1&&(overflow=WEEK),getParsingFlags(m)._overflowWeekday&&overflow===-1&&(overflow=WEEKDAY),getParsingFlags(m).overflow=overflow),m}function configFromISO(config){var i,l,allowTime,dateFormat,timeFormat,tzFormat,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string);if(match){for(getParsingFlags(config).iso=!0,i=0,l=isoDates.length;i<l;i++)if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0],allowTime=isoDates[i][2]!==!1;break}if(null==dateFormat)return void(config._isValid=!1);if(match[3]){for(i=0,l=isoTimes.length;i<l;i++)if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}if(null==timeFormat)return void(config._isValid=!1)}if(!allowTime&&null!=timeFormat)return void(config._isValid=!1);if(match[4]){if(!tzRegex.exec(match[4]))return void(config._isValid=!1);tzFormat="Z"}config._f=dateFormat+(timeFormat||"")+(tzFormat||""),configFromStringAndFormat(config)}else config._isValid=!1}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);return null!==matched?void(config._d=new Date((+matched[1]))):(configFromISO(config),void(config._isValid===!1&&(delete config._isValid,utils_hooks__hooks.createFromInputFallback(config))))}function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return y<100&&y>=0&&isFinite(date.getFullYear())&&date.setFullYear(y),date}function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return y<100&&y>=0&&isFinite(date.getUTCFullYear())&&date.setUTCFullYear(y),date}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function getIsLeapYear(){return isLeapYear(this.year())}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var resYear,resDayOfYear,localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset;return dayOfYear<=0?(resYear=year-1,resDayOfYear=daysInYear(resYear)+dayOfYear):dayOfYear>daysInYear(year)?(resYear=year+1,resDayOfYear=dayOfYear-daysInYear(year)):(resYear=year,resDayOfYear=dayOfYear),{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var resWeek,resYear,weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1;return week<1?(resYear=mom.year()-1,resWeek=week+weeksInYear(resYear,dow,doy)):week>weeksInYear(mom.year(),dow,doy)?(resWeek=week-weeksInYear(mom.year(),dow,doy),resYear=mom.year()+1):(resYear=mom.year(),resWeek=week),{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}function defaults(a,b,c){return null!=a?a:null!=b?b:c}function currentDateArray(config){var nowValue=new Date(utils_hooks__hooks.now());return config._useUTC?[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]:[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=defaults(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(getParsingFlags(config)._overflowDayOfYear=!0),date=createUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?createUTCDate:createDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(local__createLocal(),1,4).year),week=defaults(w.W,1),weekday=defaults(w.E,1),(weekday<1||weekday>7)&&(weekdayOverflow=!0)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=defaults(w.gg,config._a[YEAR],weekOfYear(local__createLocal(),dow,doy).year),week=defaults(w.w,1),null!=w.d?(weekday=w.d,(weekday<0||weekday>6)&&(weekdayOverflow=!0)):null!=w.e?(weekday=w.e+dow,(w.e<0||w.e>6)&&(weekdayOverflow=!0)):weekday=dow),week<1||week>weeksInYear(weekYear,dow,doy)?getParsingFlags(config)._overflowWeeks=!0:null!=weekdayOverflow?getParsingFlags(config)._overflowWeekday=!0:(temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear)}function configFromStringAndFormat(config){if(config._f===utils_hooks__hooks.ISO_8601)return void configFromISO(config);config._a=[],getParsingFlags(config).empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&getParsingFlags(config).unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?getParsingFlags(config).empty=!1:getParsingFlags(config).unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&getParsingFlags(config).unusedTokens.push(token);getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&getParsingFlags(config).unusedInput.push(string),getParsingFlags(config).bigHour===!0&&config._a[HOUR]<=12&&config._a[HOUR]>0&&(getParsingFlags(config).bigHour=void 0),getParsingFlags(config).parsedDateParts=config._a.slice(0),getParsingFlags(config).meridiem=config._meridiem,config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem),configFromArray(config),checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;return null==meridiem?hour:null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?(isPm=locale.isPM(meridiem),isPm&&hour<12&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return getParsingFlags(config).invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._f=config._f[i],configFromStringAndFormat(tempConfig),valid__isValid(tempConfig)&&(currentScore+=getParsingFlags(tempConfig).charsLeftOver,currentScore+=10*getParsingFlags(tempConfig).unusedTokens.length,getParsingFlags(tempConfig).score=currentScore,(null==scoreToBeat||currentScore<scoreToBeat)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function configFromObject(config){if(!config._d){var i=normalizeObjectUnits(config._i);config._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)}),configFromArray(config)}}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));return res._nextDay&&(res.add(1,"d"),res._nextDay=void 0),res}function prepareConfig(config){var input=config._i,format=config._f;return config._locale=config._locale||locale_locales__getLocale(config._l),null===input||void 0===format&&""===input?valid__createInvalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),isMoment(input)?new Moment(checkOverflow(input)):(isArray(format)?configFromStringAndArray(config):format?configFromStringAndFormat(config):isDate(input)?config._d=input:configFromInput(config),valid__isValid(config)||(config._d=null),config))}function configFromInput(config){var input=config._i;void 0===input?config._d=new Date(utils_hooks__hooks.now()):isDate(input)?config._d=new Date(input.valueOf()):"string"==typeof input?configFromString(config):isArray(input)?(config._a=map(input.slice(0),function(obj){return parseInt(obj,10)}),configFromArray(config)):"object"==typeof input?configFromObject(config):"number"==typeof input?config._d=new Date(input):utils_hooks__hooks.createFromInputFallback(config)}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};return"boolean"==typeof locale&&(strict=locale,locale=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=isUTC,c._l=locale,c._i=input,c._f=format,c._strict=strict,createFromConfig(c)}function local__createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!1)}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return local__createLocal();for(res=moments[0],i=1;i<moments.length;++i)moments[i].isValid()&&!moments[i][fn](res)||(res=moments[i]);return res}function min(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+1e3*hours*60*60,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=locale_locales__getLocale(),this._bubble()}function isDuration(obj){return obj instanceof Duration}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign="+";return offset<0&&(offset=-offset,sign="-"),sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}function offsetFromString(matcher,string){var matches=(string||"").match(matcher)||[],chunk=matches[matches.length-1]||[],parts=(chunk+"").match(chunkOffset)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(isMoment(input)||isDate(input)?input.valueOf():local__createLocal(input).valueOf())-res.valueOf(),res._d.setTime(res._d.valueOf()+diff),utils_hooks__hooks.updateOffset(res,!1),res):local__createLocal(input).local()}function getDateOffset(m){return 15*-Math.round(m._d.getTimezoneOffset()/15)}function getSetOffset(input,keepLocalTime){var localAdjust,offset=this._offset||0;return this.isValid()?null!=input?("string"==typeof input?input=offsetFromString(matchShortOffset,input):Math.abs(input)<16&&(input=60*input),!this._isUTC&&keepLocalTime&&(localAdjust=getDateOffset(this)),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?add_subtract__addSubtract(this,create__createDuration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,utils_hooks__hooks.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?offset:getDateOffset(this):null!=input?this:NaN}function getSetZone(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(offsetFromString(matchOffset,this._i)),this}function hasAlignedHourOffset(input){return!!this.isValid()&&(input=input?local__createLocal(input).utcOffset():0,(this.utcOffset()-input)%60===0)}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted))return this._isDSTShifted;var c={};if(copyConfig(c,this),c=prepareConfig(c),c._a){var other=c._isUTC?create_utc__createUTC(c._a):local__createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function isLocal(){return!!this.isValid()&&!this._isUTC}function isUtcOffset(){return!!this.isValid()&&this._isUTC}function isUtc(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function create__createDuration(input,key){var sign,ret,diffRes,duration=input,match=null;return isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(local__createLocal(duration.from),local__createLocal(duration.to)),duration={},duration.ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),ret}function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return base.isValid()&&other.isValid()?(other=cloneWithOffset(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):(res=positiveMomentsDifference(other,base),res.milliseconds=-res.milliseconds,res.months=-res.months),res):{milliseconds:0,months:0}}function absRound(number){return number<0?Math.round(-1*number)*-1:Math.round(number)}function createAdder(direction,name){return function(val,period){var dur,tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,dur=create__createDuration(val,period),add_subtract__addSubtract(this,dur,direction),this}}function add_subtract__addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);mom.isValid()&&(updateOffset=null==updateOffset||updateOffset,milliseconds&&mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding),days&&get_set__set(mom,"Date",get_set__get(mom,"Date")+days*isAdding),months&&setMonth(mom,get_set__get(mom,"Month")+months*isAdding),updateOffset&&utils_hooks__hooks.updateOffset(mom,days||months))}function moment_calendar__calendar(time,formats){var now=time||local__createLocal(),sod=cloneWithOffset(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse",output=formats&&(isFunction(formats[format])?formats[format]():formats[format]);return this.format(output||this.localeData().calendar(format,this,local__createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:local__createLocal(input);return!(!this.isValid()||!localInput.isValid())&&(units=normalizeUnits(isUndefined(units)?"millisecond":units),"millisecond"===units?this.valueOf()>localInput.valueOf():localInput.valueOf()<this.clone().startOf(units).valueOf())}function isBefore(input,units){var localInput=isMoment(input)?input:local__createLocal(input);return!(!this.isValid()||!localInput.isValid())&&(units=normalizeUnits(isUndefined(units)?"millisecond":units),"millisecond"===units?this.valueOf()<localInput.valueOf():this.clone().endOf(units).valueOf()<localInput.valueOf())}function isBetween(from,to,units,inclusivity){return inclusivity=inclusivity||"()",("("===inclusivity[0]?this.isAfter(from,units):!this.isBefore(from,units))&&(")"===inclusivity[1]?this.isBefore(to,units):!this.isAfter(to,units))}function isSame(input,units){var inputMs,localInput=isMoment(input)?input:local__createLocal(input);return!(!this.isValid()||!localInput.isValid())&&(units=normalizeUnits(units||"millisecond"),"millisecond"===units?this.valueOf()===localInput.valueOf():(inputMs=localInput.valueOf(),this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()))}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,delta,output;return this.isValid()?(that=cloneWithOffset(input,this),that.isValid()?(zoneDelta=6e4*(that.utcOffset()-this.utcOffset()),units=normalizeUnits(units),"year"===units||"month"===units||"quarter"===units?(output=monthDiff(this,that),"quarter"===units?output/=3:"year"===units&&(output/=12)):(delta=this-that,output="second"===units?delta/1e3:"minute"===units?delta/6e4:"hour"===units?delta/36e5:"day"===units?(delta-zoneDelta)/864e5:"week"===units?(delta-zoneDelta)/6048e5:delta),asFloat?output:absFloor(output)):NaN):NaN}function monthDiff(a,b){var anchor2,adjust,wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return b-anchor<0?(anchor2=a.clone().add(wholeMonthDiff-1,"months"),adjust=(b-anchor)/(anchor-anchor2)):(anchor2=a.clone().add(wholeMonthDiff+1,"months"),adjust=(b-anchor)/(anchor2-anchor)),-(wholeMonthDiff+adjust)||0}function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function moment_format__toISOString(){var m=this.clone().utc();return 0<m.year()&&m.year()<=9999?isFunction(Date.prototype.toISOString)?this.toDate().toISOString():formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function format(inputString){inputString||(inputString=this.isUtc()?utils_hooks__hooks.defaultFormatUtc:utils_hooks__hooks.defaultFormat);var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||local__createLocal(time).isValid())?create__createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()}function fromNow(withoutSuffix){return this.from(local__createLocal(),withoutSuffix)}function to(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||local__createLocal(time).isValid())?create__createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()}function toNow(withoutSuffix){return this.to(local__createLocal(),withoutSuffix)}function locale(key){var newLocaleData;return void 0===key?this._locale._abbr:(newLocaleData=locale_locales__getLocale(key),null!=newLocaleData&&(this._locale=newLocaleData),this)}function localeData(){return this._locale}function startOf(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units&&this.weekday(0),"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this}function endOf(units){return units=normalizeUnits(units),void 0===units||"millisecond"===units?this:("date"===units&&(units="day"),this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms"))}function to_type__valueOf(){return this._d.valueOf()-6e4*(this._offset||0)}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return this._offset?new Date(this.valueOf()):this._d}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function moment_valid__isValid(){return valid__isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;return null==input?weekOfYear(this,dow,doy).year:(weeksTarget=weeksInYear(input,dow,doy),week>weeksTarget&&(week=weeksTarget),setWeekAll.call(this,input,week,weekday,dow,doy))}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);return this.year(date.getUTCFullYear()),this.month(date.getUTCMonth()),this.date(date.getUTCDate()),this}function getSetQuarter(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)}function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")}function parseWeekday(input,locale){return"string"!=typeof input?input:isNaN(input)?(input=locale.weekdaysParse(input),"number"==typeof input?input:null):parseInt(input,10)}function localeWeekdays(m,format){return isArray(this._weekdays)?this._weekdays[m.day()]:this._weekdays[this._weekdays.isFormat.test(format)?"format":"standalone"][m.day()]}function localeWeekdaysShort(m){return this._weekdaysShort[m.day()]}function localeWeekdaysMin(m){return this._weekdaysMin[m.day()]}function day_of_week__handleStrictParse(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)mom=create_utc__createUTC([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase();return strict?"dddd"===format?(ii=indexOf.call(this._weekdaysParse,llc),ii!==-1?ii:null):"ddd"===format?(ii=indexOf.call(this._shortWeekdaysParse,llc),ii!==-1?ii:null):(ii=indexOf.call(this._minWeekdaysParse,llc),ii!==-1?ii:null):"dddd"===format?(ii=indexOf.call(this._weekdaysParse,llc),ii!==-1?ii:(ii=indexOf.call(this._shortWeekdaysParse,llc),ii!==-1?ii:(ii=indexOf.call(this._minWeekdaysParse,llc),ii!==-1?ii:null))):"ddd"===format?(ii=indexOf.call(this._shortWeekdaysParse,llc),ii!==-1?ii:(ii=indexOf.call(this._weekdaysParse,llc),ii!==-1?ii:(ii=indexOf.call(this._minWeekdaysParse,llc),ii!==-1?ii:null))):(ii=indexOf.call(this._minWeekdaysParse,llc),ii!==-1?ii:(ii=indexOf.call(this._weekdaysParse,llc),ii!==-1?ii:(ii=indexOf.call(this._shortWeekdaysParse,llc),ii!==-1?ii:null)))}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact)return day_of_week__handleStrictParse.call(this,weekdayName,format,strict);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(mom=create_utc__createUTC([2e3,1]).day(i),strict&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".",".?")+"$","i"),
this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"dddd"===format&&this._fullWeekdaysParse[i].test(weekdayName))return i;if(strict&&"ddd"===format&&this._shortWeekdaysParse[i].test(weekdayName))return i;if(strict&&"dd"===format&&this._minWeekdaysParse[i].test(weekdayName))return i;if(!strict&&this._weekdaysParse[i].test(weekdayName))return i}}function getSetDayOfWeek(input){if(!this.isValid())return null!=input?this:NaN;var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day}function getSetLocaleDayOfWeek(input){if(!this.isValid())return null!=input?this:NaN;var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){return this.isValid()?null==input?this.day()||7:this.day(this.day()%7?input:input-7):null!=input?this:NaN}function weekdaysRegex(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysStrictRegex:this._weekdaysRegex):this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex}function weekdaysShortRegex(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}function weekdaysMinRegex(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,minp,shortp,longp,minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<7;i++)mom=create_utc__createUTC([2e3,1]).day(i),minp=this.weekdaysMin(mom,""),shortp=this.weekdaysShort(mom,""),longp=this.weekdays(mom,""),minPieces.push(minp),shortPieces.push(shortp),longPieces.push(longp),mixedPieces.push(minp),mixedPieces.push(shortp),mixedPieces.push(longp);for(minPieces.sort(cmpLenRev),shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),i=0;i<7;i++)shortPieces[i]=regexEscape(shortPieces[i]),longPieces[i]=regexEscape(longPieces[i]),mixedPieces[i]=regexEscape(mixedPieces[i]);this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}function matchMeridiem(isStrict,locale){return locale._meridiemParse}function localeIsPM(input){return"p"===(input+"").toLowerCase().charAt(0)}function localeMeridiem(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"}function parseMs(input,array){array[MILLISECOND]=toInt(1e3*("0."+input))}function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}function moment__createUnix(input){return local__createLocal(1e3*input)}function moment__createInZone(){return local__createLocal.apply(null,arguments).parseZone()}function locale_calendar__calendar(key,mom,now){var output=this._calendar[key];return isFunction(output)?output.call(mom,now):output}function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];return format||!formatUpper?format:(this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key])}function invalidDate(){return this._invalidDate}function ordinal(number){return this._ordinal.replace("%d",number)}function preParsePostFormat(string){return string}function relative__relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)}function lists__get(format,index,field,setter){var locale=locale_locales__getLocale(),utc=create_utc__createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if("number"==typeof format&&(index=format,format=void 0),format=format||"",null!=index)return lists__get(format,index,field,"month");var i,out=[];for(i=0;i<12;i++)out[i]=lists__get(format,i,field,"month");return out}function listWeekdaysImpl(localeSorted,format,index,field){"boolean"==typeof localeSorted?("number"==typeof format&&(index=format,format=void 0),format=format||""):(format=localeSorted,index=format,localeSorted=!1,"number"==typeof format&&(index=format,format=void 0),format=format||"");var locale=locale_locales__getLocale(),shift=localeSorted?locale._week.dow:0;if(null!=index)return lists__get(format,(index+shift)%7,field,"day");var i,out=[];for(i=0;i<7;i++)out[i]=lists__get(format,(i+shift)%7,field,"day");return out}function lists__listMonths(format,index){return listMonthsImpl(format,index,"months")}function lists__listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function lists__listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function lists__listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function lists__listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}function duration_abs__abs(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this}function duration_add_subtract__addSubtract(duration,input,value,direction){var other=create__createDuration(input,value);return duration._milliseconds+=direction*other._milliseconds,duration._days+=direction*other._days,duration._months+=direction*other._months,duration._bubble()}function duration_add_subtract__add(input,value){return duration_add_subtract__addSubtract(this,input,value,1)}function duration_add_subtract__subtract(input,value){return duration_add_subtract__addSubtract(this,input,value,-1)}function absCeil(number){return number<0?Math.floor(number):Math.ceil(number)}function bubble(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;return milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0||(milliseconds+=864e5*absCeil(monthsToDays(months)+days),days=0,months=0),data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,days+=absFloor(hours/24),monthsFromDays=absFloor(daysToMonths(days)),months+=monthsFromDays,days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this}function daysToMonths(days){return 4800*days/146097}function monthsToDays(months){return 146097*months/4800}function as(units){var days,months,milliseconds=this._milliseconds;if(units=normalizeUnits(units),"month"===units||"year"===units)return days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),"month"===units?months:months/12;switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}}function duration_as__valueOf(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)}function makeAs(alias){return function(){return this.as(alias)}}function duration_get__get(units){return units=normalizeUnits(units),this[units+"s"]()}function makeGetter(name){return function(){return this._data[name]}}function weeks(){return absFloor(this.days()/7)}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function duration_humanize__relativeTime(posNegDuration,withoutSuffix,locale){var duration=create__createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),a=seconds<thresholds.s&&["s",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days]||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];return a[2]=withoutSuffix,a[3]=+posNegDuration>0,a[4]=locale,substituteTimeAgo.apply(null,a)}function duration_humanize__getSetRelativeTimeThreshold(threshold,limit){return void 0!==thresholds[threshold]&&(void 0===limit?thresholds[threshold]:(thresholds[threshold]=limit,!0))}function humanize(withSuffix){var locale=this.localeData(),output=duration_humanize__relativeTime(this,!withSuffix,locale);return withSuffix&&(output=locale.pastFuture(+this,output)),locale.postformat(output)}function iso_string__toISOString(){var minutes,hours,years,seconds=iso_string__abs(this._milliseconds)/1e3,days=iso_string__abs(this._days),months=iso_string__abs(this._months);minutes=absFloor(seconds/60),hours=absFloor(minutes/60),seconds%=60,minutes%=60,years=absFloor(months/12),months%=12;var Y=years,M=months,D=days,h=hours,m=minutes,s=seconds,total=this.asSeconds();return total?(total<0?"-":"")+"P"+(Y?Y+"Y":"")+(M?M+"M":"")+(D?D+"D":"")+(h||m||s?"T":"")+(h?h+"H":"")+(m?m+"M":"")+(s?s+"S":""):"P0D"}var hookCallback,some;some=Array.prototype.some?Array.prototype.some:function(fun){for(var t=Object(this),len=t.length>>>0,i=0;i<len;i++)if(i in t&&fun.call(this,t[i],i,t))return!0;return!1};var momentProperties=utils_hooks__hooks.momentProperties=[],updateInProgress=!1,deprecations={};utils_hooks__hooks.suppressDeprecationWarnings=!1,utils_hooks__hooks.deprecationHandler=null;var keys;keys=Object.keys?Object.keys:function(obj){var i,res=[];for(i in obj)hasOwnProp(obj,i)&&res.push(i);return res};var globalLocale,indexOf,locales={},aliases={},formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={},match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,regexes={},tokens={},YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;indexOf=Array.prototype.indexOf?Array.prototype.indexOf:function(o){var i;for(i=0;i<this.length;++i)if(this[i]===o)return i;return-1},addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1}),addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)}),addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)}),addUnitAlias("month","M"),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)}),addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)}),addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1}),addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);null!=month?array[MONTH]=month:getParsingFlags(config).invalidMonth=input});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord,extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;utils_hooks__hooks.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?""+y:"+"+y}),addFormatToken(0,["YY",2],0,function(){return this.year()%100}),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addUnitAlias("year","y"),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",function(input,array){array[YEAR]=2===input.length?utils_hooks__hooks.parseTwoDigitYear(input):toInt(input)}),addParseToken("YY",function(input,array){array[YEAR]=utils_hooks__hooks.parseTwoDigitYear(input)}),addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)}),utils_hooks__hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);utils_hooks__hooks.ISO_8601=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other<this?this:other:valid__createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other>this?this:other:valid__createInvalid()}),now=function(){return Date.now?Date.now():+new Date};offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=!0,config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;utils_hooks__hooks.updateOffset=function(){};var aspNetRegex=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,isoRegex=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;create__createDuration.fn=Duration.prototype;var add_subtract__add=createAdder(1,"add"),add_subtract__subtract=createAdder(-1,"subtract");utils_hooks__hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",utils_hooks__hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return void 0===key?this.localeData():this.locale(key)});addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100}),addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100}),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addUnitAlias("weekYear","gg"),addUnitAlias("isoWeekYear","GG"),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)}),addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=utils_hooks__hooks.parseTwoDigitYear(input)}),addFormatToken("Q",0,"Qo","quarter"),addUnitAlias("quarter","Q"),addRegexToken("Q",match1),addParseToken("Q",function(input,array){array[MONTH]=3*(toInt(input)-1)}),addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addUnitAlias("week","w"),addUnitAlias("isoWeek","W"),addRegexToken("w",match1to2),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});var defaultLocaleWeek={dow:0,doy:6};addFormatToken("D",["DD",2],"Do","date"),addUnitAlias("date","D"),addRegexToken("D",match1to2),addRegexToken("DD",match1to2,match2),addRegexToken("Do",function(isStrict,locale){return isStrict?locale._ordinalParse:locale._ordinalParseLenient}),addParseToken(["D","DD"],DATE),addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0],10)});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)}),addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)}),addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)}),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)}),addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)}),addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)}),addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);null!=weekday?week.d=weekday:getParsingFlags(config).invalidWeekday=input}),addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addUnitAlias("dayOfYear","DDD"),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)}),addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,kFormat),addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)}),addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)}),addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),meridiem("a",!0),meridiem("A",!1),addUnitAlias("hour","h"),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2),addRegexToken("h",match1to2),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input),config._meridiem=input}),addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input),getParsingFlags(config).bigHour=!0}),addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos)),getParsingFlags(config).bigHour=!0}),addParseToken("hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2)),getParsingFlags(config).bigHour=!0}),addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos))}),addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2))});var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);addFormatToken("m",["mm",2],0,"minute"),addUnitAlias("minute","m"),addRegexToken("m",match1to2),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addUnitAlias("second","s"),addRegexToken("s",match1to2),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)}),addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,function(){return 10*this.millisecond()}),addFormatToken(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),addFormatToken(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),addFormatToken(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),addFormatToken(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),addFormatToken(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),addUnitAlias("millisecond","ms"),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3);var token;for(token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);var getSetMillisecond=makeGetSet("Milliseconds",!1);addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var momentPrototype__proto=Moment.prototype;momentPrototype__proto.add=add_subtract__add,momentPrototype__proto.calendar=moment_calendar__calendar,momentPrototype__proto.clone=clone,momentPrototype__proto.diff=diff,momentPrototype__proto.endOf=endOf,momentPrototype__proto.format=format,momentPrototype__proto.from=from,momentPrototype__proto.fromNow=fromNow,momentPrototype__proto.to=to,momentPrototype__proto.toNow=toNow,momentPrototype__proto.get=getSet,momentPrototype__proto.invalidAt=invalidAt,momentPrototype__proto.isAfter=isAfter,momentPrototype__proto.isBefore=isBefore,momentPrototype__proto.isBetween=isBetween,momentPrototype__proto.isSame=isSame,momentPrototype__proto.isSameOrAfter=isSameOrAfter,momentPrototype__proto.isSameOrBefore=isSameOrBefore,momentPrototype__proto.isValid=moment_valid__isValid,momentPrototype__proto.lang=lang,momentPrototype__proto.locale=locale,momentPrototype__proto.localeData=localeData,momentPrototype__proto.max=prototypeMax,momentPrototype__proto.min=prototypeMin,momentPrototype__proto.parsingFlags=parsingFlags,momentPrototype__proto.set=getSet,momentPrototype__proto.startOf=startOf,momentPrototype__proto.subtract=add_subtract__subtract,momentPrototype__proto.toArray=toArray,momentPrototype__proto.toObject=toObject,momentPrototype__proto.toDate=toDate,momentPrototype__proto.toISOString=moment_format__toISOString,momentPrototype__proto.toJSON=toJSON,momentPrototype__proto.toString=toString,momentPrototype__proto.unix=unix,momentPrototype__proto.valueOf=to_type__valueOf,momentPrototype__proto.creationData=creationData,momentPrototype__proto.year=getSetYear,momentPrototype__proto.isLeapYear=getIsLeapYear,momentPrototype__proto.weekYear=getSetWeekYear,momentPrototype__proto.isoWeekYear=getSetISOWeekYear,momentPrototype__proto.quarter=momentPrototype__proto.quarters=getSetQuarter,momentPrototype__proto.month=getSetMonth,momentPrototype__proto.daysInMonth=getDaysInMonth,momentPrototype__proto.week=momentPrototype__proto.weeks=getSetWeek,momentPrototype__proto.isoWeek=momentPrototype__proto.isoWeeks=getSetISOWeek,momentPrototype__proto.weeksInYear=getWeeksInYear,momentPrototype__proto.isoWeeksInYear=getISOWeeksInYear,momentPrototype__proto.date=getSetDayOfMonth,momentPrototype__proto.day=momentPrototype__proto.days=getSetDayOfWeek,momentPrototype__proto.weekday=getSetLocaleDayOfWeek,momentPrototype__proto.isoWeekday=getSetISODayOfWeek,momentPrototype__proto.dayOfYear=getSetDayOfYear,momentPrototype__proto.hour=momentPrototype__proto.hours=getSetHour,momentPrototype__proto.minute=momentPrototype__proto.minutes=getSetMinute,momentPrototype__proto.second=momentPrototype__proto.seconds=getSetSecond,momentPrototype__proto.millisecond=momentPrototype__proto.milliseconds=getSetMillisecond,momentPrototype__proto.utcOffset=getSetOffset,momentPrototype__proto.utc=setOffsetToUTC,momentPrototype__proto.local=setOffsetToLocal,momentPrototype__proto.parseZone=setOffsetToParsedOffset,momentPrototype__proto.hasAlignedHourOffset=hasAlignedHourOffset,momentPrototype__proto.isDST=isDaylightSavingTime,momentPrototype__proto.isDSTShifted=isDaylightSavingTimeShifted,momentPrototype__proto.isLocal=isLocal,momentPrototype__proto.isUtcOffset=isUtcOffset,momentPrototype__proto.isUtc=isUtc,momentPrototype__proto.isUTC=isUtc,momentPrototype__proto.zoneAbbr=getZoneAbbr,momentPrototype__proto.zoneName=getZoneName,momentPrototype__proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),momentPrototype__proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),momentPrototype__proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),momentPrototype__proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",getSetZone);var momentPrototype=momentPrototype__proto,defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},defaultInvalidDate="Invalid date",defaultOrdinal="%d",defaultOrdinalParse=/\d{1,2}/,defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},prototype__proto=Locale.prototype;prototype__proto._calendar=defaultCalendar,prototype__proto.calendar=locale_calendar__calendar,prototype__proto._longDateFormat=defaultLongDateFormat,prototype__proto.longDateFormat=longDateFormat,prototype__proto._invalidDate=defaultInvalidDate,prototype__proto.invalidDate=invalidDate,prototype__proto._ordinal=defaultOrdinal,prototype__proto.ordinal=ordinal,prototype__proto._ordinalParse=defaultOrdinalParse,prototype__proto.preparse=preParsePostFormat,prototype__proto.postformat=preParsePostFormat,prototype__proto._relativeTime=defaultRelativeTime,prototype__proto.relativeTime=relative__relativeTime,prototype__proto.pastFuture=pastFuture,prototype__proto.set=locale_set__set,prototype__proto.months=localeMonths,prototype__proto._months=defaultLocaleMonths,prototype__proto.monthsShort=localeMonthsShort,prototype__proto._monthsShort=defaultLocaleMonthsShort,prototype__proto.monthsParse=localeMonthsParse,prototype__proto._monthsRegex=defaultMonthsRegex,prototype__proto.monthsRegex=monthsRegex,prototype__proto._monthsShortRegex=defaultMonthsShortRegex,prototype__proto.monthsShortRegex=monthsShortRegex,prototype__proto.week=localeWeek,prototype__proto._week=defaultLocaleWeek,prototype__proto.firstDayOfYear=localeFirstDayOfYear,prototype__proto.firstDayOfWeek=localeFirstDayOfWeek,prototype__proto.weekdays=localeWeekdays,prototype__proto._weekdays=defaultLocaleWeekdays,prototype__proto.weekdaysMin=localeWeekdaysMin,prototype__proto._weekdaysMin=defaultLocaleWeekdaysMin,prototype__proto.weekdaysShort=localeWeekdaysShort,prototype__proto._weekdaysShort=defaultLocaleWeekdaysShort,prototype__proto.weekdaysParse=localeWeekdaysParse,prototype__proto._weekdaysRegex=defaultWeekdaysRegex,prototype__proto.weekdaysRegex=weekdaysRegex,prototype__proto._weekdaysShortRegex=defaultWeekdaysShortRegex,prototype__proto.weekdaysShortRegex=weekdaysShortRegex,prototype__proto._weekdaysMinRegex=defaultWeekdaysMinRegex,prototype__proto.weekdaysMinRegex=weekdaysMinRegex,prototype__proto.isPM=localeIsPM,prototype__proto._meridiemParse=defaultLocaleMeridiemParse,prototype__proto.meridiem=localeMeridiem,locale_locales__getSetGlobalLocale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),utils_hooks__hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",locale_locales__getSetGlobalLocale),
utils_hooks__hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",locale_locales__getLocale);var mathAbs=Math.abs,asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asYears=makeAs("y"),milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years"),round=Math.round,thresholds={s:45,m:45,h:22,d:26,M:11},iso_string__abs=Math.abs,duration_prototype__proto=Duration.prototype;duration_prototype__proto.abs=duration_abs__abs,duration_prototype__proto.add=duration_add_subtract__add,duration_prototype__proto.subtract=duration_add_subtract__subtract,duration_prototype__proto.as=as,duration_prototype__proto.asMilliseconds=asMilliseconds,duration_prototype__proto.asSeconds=asSeconds,duration_prototype__proto.asMinutes=asMinutes,duration_prototype__proto.asHours=asHours,duration_prototype__proto.asDays=asDays,duration_prototype__proto.asWeeks=asWeeks,duration_prototype__proto.asMonths=asMonths,duration_prototype__proto.asYears=asYears,duration_prototype__proto.valueOf=duration_as__valueOf,duration_prototype__proto._bubble=bubble,duration_prototype__proto.get=duration_get__get,duration_prototype__proto.milliseconds=milliseconds,duration_prototype__proto.seconds=seconds,duration_prototype__proto.minutes=minutes,duration_prototype__proto.hours=hours,duration_prototype__proto.days=days,duration_prototype__proto.weeks=weeks,duration_prototype__proto.months=months,duration_prototype__proto.years=years,duration_prototype__proto.humanize=humanize,duration_prototype__proto.toISOString=iso_string__toISOString,duration_prototype__proto.toString=iso_string__toISOString,duration_prototype__proto.toJSON=iso_string__toISOString,duration_prototype__proto.locale=locale,duration_prototype__proto.localeData=localeData,duration_prototype__proto.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",iso_string__toISOString),duration_prototype__proto.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",matchTimestamp),addParseToken("X",function(input,array,config){config._d=new Date(1e3*parseFloat(input,10))}),addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))}),utils_hooks__hooks.version="2.13.0",setHookCallback(local__createLocal),utils_hooks__hooks.fn=momentPrototype,utils_hooks__hooks.min=min,utils_hooks__hooks.max=max,utils_hooks__hooks.now=now,utils_hooks__hooks.utc=create_utc__createUTC,utils_hooks__hooks.unix=moment__createUnix,utils_hooks__hooks.months=lists__listMonths,utils_hooks__hooks.isDate=isDate,utils_hooks__hooks.locale=locale_locales__getSetGlobalLocale,utils_hooks__hooks.invalid=valid__createInvalid,utils_hooks__hooks.duration=create__createDuration,utils_hooks__hooks.isMoment=isMoment,utils_hooks__hooks.weekdays=lists__listWeekdays,utils_hooks__hooks.parseZone=moment__createInZone,utils_hooks__hooks.localeData=locale_locales__getLocale,utils_hooks__hooks.isDuration=isDuration,utils_hooks__hooks.monthsShort=lists__listMonthsShort,utils_hooks__hooks.weekdaysMin=lists__listWeekdaysMin,utils_hooks__hooks.defineLocale=defineLocale,utils_hooks__hooks.updateLocale=updateLocale,utils_hooks__hooks.locales=locale_locales__listLocales,utils_hooks__hooks.weekdaysShort=lists__listWeekdaysShort,utils_hooks__hooks.normalizeUnits=normalizeUnits,utils_hooks__hooks.relativeTimeThreshold=duration_humanize__getSetRelativeTimeThreshold,utils_hooks__hooks.prototype=momentPrototype;var _moment=utils_hooks__hooks;return _moment}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module&&"function"==typeof require?factory(require("../moment")):"function"==typeof define&&define.amd?define(["moment"],factory):factory(global.moment)}(this,function(moment){"use strict";var en_gb=moment.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1===~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}});return en_gb}),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["moment"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("moment")):factory(root.moment)}(this,function(moment){"use strict";function charCodeToInt(charCode){return charCode>96?charCode-87:charCode>64?charCode-29:charCode-48}function unpackBase60(string){var num,i=0,parts=string.split("."),whole=parts[0],fractional=parts[1]||"",multiplier=1,out=0,sign=1;for(45===string.charCodeAt(0)&&(i=1,sign=-1),i;i<whole.length;i++)num=charCodeToInt(whole.charCodeAt(i)),out=60*out+num;for(i=0;i<fractional.length;i++)multiplier/=60,num=charCodeToInt(fractional.charCodeAt(i)),out+=num*multiplier;return out*sign}function arrayToInt(array){for(var i=0;i<array.length;i++)array[i]=unpackBase60(array[i])}function intToUntil(array,length){for(var i=0;i<length;i++)array[i]=Math.round((array[i-1]||0)+6e4*array[i]);array[length-1]=1/0}function mapIndices(source,indices){var i,out=[];for(i=0;i<indices.length;i++)out[i]=source[indices[i]];return out}function unpack(string){var data=string.split("|"),offsets=data[2].split(" "),indices=data[3].split(""),untils=data[4].split(" ");return arrayToInt(offsets),arrayToInt(indices),arrayToInt(untils),intToUntil(untils,indices.length),{name:data[0],abbrs:mapIndices(data[1].split(" "),indices),offsets:mapIndices(offsets,indices),untils:untils,population:0|data[5]}}function Zone(packedString){packedString&&this._set(unpack(packedString))}function OffsetAt(at){var timeString=at.toTimeString(),abbr=timeString.match(/\([a-z ]+\)/i);abbr&&abbr[0]?(abbr=abbr[0].match(/[A-Z]/g),abbr=abbr?abbr.join(""):void 0):(abbr=timeString.match(/[A-Z]{3,5}/g),abbr=abbr?abbr[0]:void 0),"GMT"===abbr&&(abbr=void 0),this.at=+at,this.abbr=abbr,this.offset=at.getTimezoneOffset()}function ZoneScore(zone){this.zone=zone,this.offsetScore=0,this.abbrScore=0}function findChange(low,high){for(var mid,diff;diff=6e4*((high.at-low.at)/12e4|0);)mid=new OffsetAt(new Date(low.at+diff)),mid.offset===low.offset?low=mid:high=mid;return low}function userOffsets(){var change,next,i,startYear=(new Date).getFullYear()-2,last=new OffsetAt(new Date(startYear,0,1)),offsets=[last];for(i=1;i<48;i++)next=new OffsetAt(new Date(startYear,i,1)),next.offset!==last.offset&&(change=findChange(last,next),offsets.push(change),offsets.push(new OffsetAt(new Date(change.at+6e4)))),last=next;for(i=0;i<4;i++)offsets.push(new OffsetAt(new Date(startYear+i,0,1))),offsets.push(new OffsetAt(new Date(startYear+i,6,1)));return offsets}function sortZoneScores(a,b){return a.offsetScore!==b.offsetScore?a.offsetScore-b.offsetScore:a.abbrScore!==b.abbrScore?a.abbrScore-b.abbrScore:b.zone.population-a.zone.population}function addToGuesses(name,offsets){var i,offset;for(arrayToInt(offsets),i=0;i<offsets.length;i++)offset=offsets[i],guesses[offset]=guesses[offset]||{},guesses[offset][name]=!0}function guessesForUserOffsets(offsets){var i,j,guessesOffset,offsetsLength=offsets.length,filteredGuesses={},out=[];for(i=0;i<offsetsLength;i++){guessesOffset=guesses[offsets[i].offset]||{};for(j in guessesOffset)guessesOffset.hasOwnProperty(j)&&(filteredGuesses[j]=!0)}for(i in filteredGuesses)filteredGuesses.hasOwnProperty(i)&&out.push(names[i]);return out}function rebuildGuess(){try{var intlName=Intl.DateTimeFormat().resolvedOptions().timeZone;if(intlName){var name=names[normalizeName(intlName)];if(name)return name;logError("Moment Timezone found "+intlName+" from the Intl api, but did not have that data loaded.")}}catch(e){}var zoneScore,i,j,offsets=userOffsets(),offsetsLength=offsets.length,guesses=guessesForUserOffsets(offsets),zoneScores=[];for(i=0;i<guesses.length;i++){for(zoneScore=new ZoneScore(getZone(guesses[i]),offsetsLength),j=0;j<offsetsLength;j++)zoneScore.scoreOffsetAt(offsets[j]);zoneScores.push(zoneScore)}return zoneScores.sort(sortZoneScores),zoneScores.length>0?zoneScores[0].zone.name:void 0}function guess(ignoreCache){return cachedGuess&&!ignoreCache||(cachedGuess=rebuildGuess()),cachedGuess}function normalizeName(name){return(name||"").toLowerCase().replace(/\//g,"_")}function addZone(packed){var i,name,split,normalized;for("string"==typeof packed&&(packed=[packed]),i=0;i<packed.length;i++)split=packed[i].split("|"),name=split[0],normalized=normalizeName(name),zones[normalized]=packed[i],names[normalized]=name,split[5]&&addToGuesses(normalized,split[2].split(" "))}function getZone(name,caller){name=normalizeName(name);var link,zone=zones[name];return zone instanceof Zone?zone:"string"==typeof zone?(zone=new Zone(zone),zones[name]=zone,zone):links[name]&&caller!==getZone&&(link=getZone(links[name],getZone))?(zone=zones[name]=new Zone,zone._set(link),zone.name=names[name],zone):null}function getNames(){var i,out=[];for(i in names)names.hasOwnProperty(i)&&(zones[i]||zones[links[i]])&&names[i]&&out.push(names[i]);return out.sort()}function addLink(aliases){var i,alias,normal0,normal1;for("string"==typeof aliases&&(aliases=[aliases]),i=0;i<aliases.length;i++)alias=aliases[i].split("|"),normal0=normalizeName(alias[0]),normal1=normalizeName(alias[1]),links[normal0]=normal1,names[normal0]=alias[0],links[normal1]=normal0,names[normal1]=alias[1]}function loadData(data){addZone(data.zones),addLink(data.links),tz.dataVersion=data.version}function zoneExists(name){return zoneExists.didShowError||(zoneExists.didShowError=!0,logError("moment.tz.zoneExists('"+name+"') has been deprecated in favor of !moment.tz.zone('"+name+"')")),!!getZone(name)}function needsOffset(m){return!(!m._a||void 0!==m._tzm)}function logError(message){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message)}function tz(input){var args=Array.prototype.slice.call(arguments,0,-1),name=arguments[arguments.length-1],zone=getZone(name),out=moment.utc.apply(null,args);return zone&&!moment.isMoment(input)&&needsOffset(out)&&out.add(zone.parse(out),"minutes"),out.tz(name),out}function abbrWrap(old){return function(){return this._z?this._z.abbr(this):old.call(this)}}function resetZoneWrap(old){return function(){return this._z=null,old.apply(this,arguments)}}if(void 0!==moment.tz)return logError("Moment Timezone "+moment.tz.version+" was already loaded "+(moment.tz.dataVersion?"with data from ":"without any data")+moment.tz.dataVersion),moment;var cachedGuess,VERSION="0.5.5",zones={},links={},names={},guesses={},momentVersion=moment.version.split("."),major=+momentVersion[0],minor=+momentVersion[1];(major<2||2===major&&minor<6)&&logError("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+moment.version+". See momentjs.com"),Zone.prototype={_set:function(unpacked){this.name=unpacked.name,this.abbrs=unpacked.abbrs,this.untils=unpacked.untils,this.offsets=unpacked.offsets,this.population=unpacked.population},_index:function(timestamp){var i,target=+timestamp,untils=this.untils;for(i=0;i<untils.length;i++)if(target<untils[i])return i},parse:function(timestamp){var offset,offsetNext,offsetPrev,i,target=+timestamp,offsets=this.offsets,untils=this.untils,max=untils.length-1;for(i=0;i<max;i++)if(offset=offsets[i],offsetNext=offsets[i+1],offsetPrev=offsets[i?i-1:i],offset<offsetNext&&tz.moveAmbiguousForward?offset=offsetNext:offset>offsetPrev&&tz.moveInvalidForward&&(offset=offsetPrev),target<untils[i]-6e4*offset)return offsets[i];return offsets[max]},abbr:function(mom){return this.abbrs[this._index(mom)]},offset:function(mom){return this.offsets[this._index(mom)]}},ZoneScore.prototype.scoreOffsetAt=function(offsetAt){this.offsetScore+=Math.abs(this.zone.offset(offsetAt.at)-offsetAt.offset),this.zone.abbr(offsetAt.at).replace(/[^A-Z]/g,"")!==offsetAt.abbr&&this.abbrScore++},tz.version=VERSION,tz.dataVersion="",tz._zones=zones,tz._links=links,tz._names=names,tz.add=addZone,tz.link=addLink,tz.load=loadData,tz.zone=getZone,tz.zoneExists=zoneExists,tz.guess=guess,tz.names=getNames,tz.Zone=Zone,tz.unpack=unpack,tz.unpackBase60=unpackBase60,tz.needsOffset=needsOffset,tz.moveInvalidForward=!0,tz.moveAmbiguousForward=!1;var fn=moment.fn;moment.tz=tz,moment.defaultZone=null,moment.updateOffset=function(mom,keepTime){var offset,zone=moment.defaultZone;void 0===mom._z&&(zone&&needsOffset(mom)&&!mom._isUTC&&(mom._d=moment.utc(mom._a)._d,mom.utc().add(zone.parse(mom),"minutes")),mom._z=zone),mom._z&&(offset=mom._z.offset(mom),Math.abs(offset)<16&&(offset/=60),void 0!==mom.utcOffset?mom.utcOffset(-offset,keepTime):mom.zone(offset,keepTime))},fn.tz=function(name){return name?(this._z=getZone(name),this._z?moment.updateOffset(this):logError("Moment Timezone has no data for "+name+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},fn.zoneName=abbrWrap(fn.zoneName),fn.zoneAbbr=abbrWrap(fn.zoneAbbr),fn.utc=resetZoneWrap(fn.utc),moment.tz.setDefault=function(name){return(major<2||2===major&&minor<9)&&logError("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+moment.version+"."),moment.defaultZone=name?getZone(name):null,moment};var momentProperties=moment.momentProperties;return"[object Array]"===Object.prototype.toString.call(momentProperties)?(momentProperties.push("_z"),momentProperties.push("_a")):momentProperties&&(momentProperties._z=null),loadData({version:"2016f",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Khartoum|EAT|-30|0||51e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET EEST|-20 -30|010101010|1Cby0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0|15e6","Africa/Casablanca|WET WEST|0 -10|01010101010101010101010101010101010101010|1Cco0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00|11e5","Africa/Windhoek|WAST WAT|-20 -10|01010101010101010101010|1C1c0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1BR00 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1BQX0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Araguaina|BRT BRST|30 20|010|1IdD0 Lz0|14e4","America/Argentina/Buenos_Aires|ART|30|0|","America/Asuncion|PYST PYT|30 40|01010101010101010101010|1C430 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5","America/Panama|EST|50|0||15e5","America/Bahia|BRT BRST|30 20|010|1FJf0 Rb0|27e5","America/Bahia_Banderas|MST CDT CST|70 50 60|01212121212121212121212|1C1l0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|84e3","America/Fortaleza|BRT|30|0||34e5","America/Managua|CST|60|0||22e5","America/Manaus|AMT|40|0||19e5","America/Bogota|COT|50|0||90e5","America/Denver|MST MDT|70 60|01010101010101010101010|1BQV0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|AMST AMT|30 40|01010101010101010101010|1BIr0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10|77e4","America/Cancun|CST CDT EST|60 50 50|010101010102|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|VET VET|4u 40|01|1QMT0|29e5","America/Cayenne|GFT|30|0||58e3","America/Chicago|CST CDT|60 50|01010101010101010101010|1BQU0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1C1l0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|81e4","America/Phoenix|MST|70|0||42e5","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/New_York|EST EDT|50 40|01010101010101010101010|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Rio_Branco|AMT ACT|40 50|01|1KLE0|31e4","America/Fort_Nelson|PST PDT MST|80 70 70|010101010102|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Halifax|AST ADT|40 30|01010101010101010101010|1BQS0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Godthab|WGT WGST|30 20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e3","America/Goose_Bay|AST ADT|40 30|01010101010101010101010|1BQQ1 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|76e2","America/Grand_Turk|EST EDT AST|50 40 40|0101010101012|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Guayaquil|ECT|50|0||27e5","America/Guyana|GYT|40|0||80e4","America/Havana|CST CDT|50 40|01010101010101010101010|1BQR0 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/La_Paz|BOT|40|0||19e5","America/Lima|PET|50|0||11e6","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|20e6","America/Metlakatla|PST AKST AKDT|80 90 80|012121212121|1PAa0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Miquelon|PMST PMDT|30 20|01010101010101010101010|1BQR0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Montevideo|UYST UYT|20 30|010101010101|1BQQ0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Noronha|FNT|20|0||30e2","America/North_Dakota/Beulah|MST MDT CST CDT|70 60 60 50|01232323232323232323232|1BQV0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Paramaribo|SRT|30|0||24e4","America/Port-au-Prince|EST EDT|50 40|010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Santiago|CLST CLT|30 40|010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|62e5","America/Sao_Paulo|BRST BRT|20 30|01010101010101010101010|1BIq0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10|20e6","America/Scoresbysund|EGT EGST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|452","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1BQPv 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|CAST AWST|-b0 -80|0101|1BN30 40P0 KL0|10","Antarctica/Davis|DAVT DAVT|-50 -70|0101|1BPw0 3Wn0 KN0|70","Antarctica/DumontDUrville|DDUT|-a0|0||80","Antarctica/Macquarie|AEDT MIST|-b0 -b0|01|1C140|1","Antarctica/Mawson|MAWT|-50|0||60","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|14e5","Antarctica/Rothera|ROTT|30|0||130","Antarctica/Syowa|SYOT|-30|0||20","Antarctica/Troll|UTC CEST|0 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|40","Antarctica/Vostok|VOST|-60|0||25","Asia/Baghdad|AST|-30|0||66e5","Asia/Almaty|+06|-60|0||15e5","Asia/Amman|EET EEST|-20 -30|010101010101010101010|1BVy0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0|25e5","Asia/Anadyr|ANAT ANAST ANAT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0|13e3","Asia/Aqtobe|+05|-50|0||27e4","Asia/Ashgabat|TMT|-50|0||41e4","Asia/Baku|AZT AZST|-40 -50|0101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|ICT|-70|0||15e6","Asia/Barnaul|+06 +07|-60 -70|010101|1BWk0 1qM0 WM0 8Hz0 3rd0","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1BWm0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|22e5","Asia/Bishkek|KGT|-60|0||87e4","Asia/Brunei|BNT|-80|0||42e4","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|YAKT YAKST YAKT IRKT|-90 -a0 -a0 -80|010230|1BWh0 1qM0 WM0 8Hz0 3re0|33e4","Asia/Choibalsan|CHOT CHOST|-80 -90|0101010101010|1O8G0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|38e3","Asia/Shanghai|CST|-80|0||23e6","Asia/Dhaka|BDT|-60|0||16e6","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1C0m0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0|26e5","Asia/Dili|TLT|-90|0||19e4","Asia/Dubai|GST|-40|0||39e5","Asia/Dushanbe|TJT|-50|0||76e4","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1BVW1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0|18e5","Asia/Hebron|EET EEST|-20 -30|0101010101010101010101010|1BVy0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0|25e4","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|HOVT HOVST|-70 -80|0101010101010|1O8H0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|IRKT IRKST IRKT|-80 -90 -90|01020|1BWi0 1qM0 WM0 8Hz0|60e4","Europe/Istanbul|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1BVA0 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0|81e4","Asia/Kabul|AFT|-4u|0||46e5","Asia/Kamchatka|PETT PETST PETT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0|18e4","Asia/Karachi|PKT|-50|0||24e6","Asia/Urumqi|XJT|-60|0||32e5","Asia/Kathmandu|NPT|-5J|0||12e5","Asia/Khandyga|VLAT VLAST VLAT YAKT YAKT|-a0 -b0 -b0 -a0 -90|010234|1BWg0 1qM0 WM0 17V0 7zD0|66e2","Asia/Krasnoyarsk|KRAT KRAST KRAT|-70 -80 -80|01020|1BWj0 1qM0 WM0 8Hz0|10e5","Asia/Kuala_Lumpur|MYT|-80|0||71e5","Asia/Magadan|MAGT MAGST MAGT MAGT|-b0 -c0 -c0 -a0|010230|1BWf0 1qM0 WM0 8Hz0 3Cq0|95e3","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PHT|-80|0||24e6","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|35e5","Asia/Novokuznetsk|+07 +06|-70 -60|010|1Dp80 WM0|55e4","Asia/Novosibirsk|+06 +07|-60 -70|010101|1BWk0 1qM0 WM0 8Hz0 4eN0|15e5","Asia/Omsk|OMST OMSST OMST|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0|12e5","Asia/Pyongyang|KST KST|-90 -8u|01|1P4D0|29e5","Asia/Rangoon|MMT|-6u|0||48e5","Asia/Sakhalin|SAKT SAKST SAKT|-a0 -b0 -b0|010202|1BWg0 1qM0 WM0 8Hz0 3rd0|58e4","Asia/Tashkent|UZT|-50|0||23e5","Asia/Seoul|KST|-90|0||23e6","Asia/Singapore|SGT|-80|0||56e5","Asia/Srednekolymsk|MAGT MAGST MAGT SRET|-b0 -c0 -c0 -b0|01023|1BWf0 1qM0 WM0 8Hz0|35e2","Asia/Tbilisi|GET|-40|0||11e5","Asia/Tehran|IRST IRDT|-3u -4u|01010101010101010101010|1BTUu 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Thimphu|BTT|-60|0||79e3","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+06 +07|-60 -70|010101|1BWk0 1qM0 WM0 8Hz0 3Qp0|10e5","Asia/Ulaanbaatar|ULAT ULAST|-80 -90|0101010101010|1O8G0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|12e5","Asia/Ust-Nera|MAGT MAGST MAGT VLAT VLAT|-b0 -c0 -c0 -b0 -a0|010234|1BWf0 1qM0 WM0 17V0 7zD0|65e2","Asia/Vladivostok|VLAT VLAST VLAT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0|60e4","Asia/Yakutsk|YAKT YAKST YAKT|-90 -a0 -a0|01020|1BWh0 1qM0 WM0 8Hz0|28e4","Asia/Yekaterinburg|YEKT YEKST YEKT|-50 -60 -60|01020|1BWl0 1qM0 WM0 8Hz0|14e5","Asia/Yerevan|AMT AMST|-40 -50|01010|1BWm0 1qM0 WM0 1qM0|13e5","Atlantic/Azores|AZOT AZOST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|25e4","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5","Atlantic/Cape_Verde|CVT|10|0||50e4","Atlantic/South_Georgia|GST|20|0||30","Atlantic/Stanley|FKST FKT|30 40|010|1C6R0 U10|21e2","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1C140 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1C14u 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|ACWST|-8J|0||368","Australia/Lord_Howe|LHDT LHST|-b0 -au|01010101010101010101010|1C130 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|EASST EAST|50 60|010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Etc/GMT+1|GMT+1|10|0|","Etc/GMT+10|GMT+10|a0|0|","Etc/GMT+11|GMT+11|b0|0|","Etc/GMT+12|GMT+12|c0|0|","Etc/GMT+2|GMT+2|20|0|","Etc/GMT+3|GMT+3|30|0|","Etc/GMT+4|GMT+4|40|0|","Etc/GMT+5|GMT+5|50|0|","Etc/GMT+6|GMT+6|60|0|","Etc/GMT+7|GMT+7|70|0|","Etc/GMT+8|GMT+8|80|0|","Etc/GMT+9|GMT+9|90|0|","Etc/GMT-1|GMT-1|-10|0|","Etc/GMT-10|GMT-10|-a0|0|","Etc/GMT-11|GMT-11|-b0|0|","Etc/GMT-12|GMT-12|-c0|0|","Etc/GMT-13|GMT-13|-d0|0|","Etc/GMT-14|GMT-14|-e0|0|","Etc/GMT-2|GMT-2|-20|0|","Etc/GMT-3|GMT-3|-30|0|","Etc/GMT-4|GMT-4|-40|0|","Etc/GMT-5|GMT-5|-50|0|","Etc/GMT-6|GMT-6|-60|0|","Etc/GMT-7|GMT-7|-70|0|","Etc/GMT-8|GMT-8|-80|0|","Etc/GMT-9|GMT-9|-90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Astrakhan|+03 +04|-30 -40|010101|1BWn0 1qM0 WM0 8Hz0 3rd0","Europe/London|GMT BST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|67e4","Europe/Kaliningrad|EET EEST FET|-20 -30 -30|01020|1BWo0 1qM0 WM0 8Hz0|44e4","Europe/Kirov|+03 +04|-30 -40|01010|1BWn0 1qM0 WM0 8Hz0|48e4","Europe/Minsk|EET EEST FET MSK|-20 -30 -30 -30|01023|1BWo0 1qM0 WM0 8Hy0|19e5","Europe/Moscow|MSK MSD MSK|-30 -40 -40|01020|1BWn0 1qM0 WM0 8Hz0|16e6","Europe/Samara|SAMT SAMST SAMT|-40 -40 -30|0120|1BWm0 1qN0 WM0|12e5","Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|01010101023|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0|33e4","Pacific/Honolulu|HST|a0|0||37e4","Indian/Chagos|IOT|-60|0||30e2","Indian/Christmas|CXT|-70|0||21e2","Indian/Cocos|CCT|-6u|0||596","Indian/Kerguelen|TFT|-50|0||130","Indian/Mahe|SCT|-40|0||79e3","Indian/Maldives|MVT|-50|0||35e4","Indian/Mauritius|MUT|-40|0||15e4","Indian/Reunion|RET|-40|0||84e4","Pacific/Majuro|MHT|-c0|0||28e3","MET|MET MEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Pacific/Chatham|CHADT CHAST|-dJ -cJ|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|600","Pacific/Apia|SST SDT WSDT WSST|b0 a0 -e0 -d0|01012323232323232323232|1Dbn0 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|PGT BST|-a0 -b0|01|1NwE0|18e4","Pacific/Chuuk|CHUT|-a0|0||49e3","Pacific/Efate|VUT|-b0|0||66e3","Pacific/Enderbury|PHOT|-d0|0||1","Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0|483","Pacific/Fiji|FJST FJT|-d0 -c0|01010101010101010101010|1BWe0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0|88e4","Pacific/Funafuti|TVT|-c0|0||45e2","Pacific/Galapagos|GALT|60|0||25e3","Pacific/Gambier|GAMT|90|0||125","Pacific/Guadalcanal|SBT|-b0|0||11e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Kiritimati|LINT|-e0|0||51e2","Pacific/Kosrae|KOST|-b0|0||66e2","Pacific/Marquesas|MART|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Nauru|NRT|-c0|0||10e3","Pacific/Niue|NUT|b0|0||12e2","Pacific/Norfolk|NFT NFT|-bu -b0|01|1PoCu|25e4","Pacific/Noumea|NCT|-b0|0||98e3","Pacific/Palau|PWT|-90|0||21e3","Pacific/Pitcairn|PST|80|0||56","Pacific/Pohnpei|PONT|-b0|0||34e3","Pacific/Port_Moresby|PGT|-a0|0||25e4","Pacific/Rarotonga|CKT|a0|0||13e3","Pacific/Tahiti|TAHT|a0|0||18e4","Pacific/Tarawa|GILT|-c0|0||29e3","Pacific/Tongatapu|TOT|-d0|0||75e3","Pacific/Wake|WAKT|-c0|0||16e3","Pacific/Wallis|WFT|-c0|0||94"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Khartoum|Africa/Addis_Ababa","Africa/Khartoum|Africa/Asmara","Africa/Khartoum|Africa/Asmera","Africa/Khartoum|Africa/Dar_es_Salaam","Africa/Khartoum|Africa/Djibouti","Africa/Khartoum|Africa/Juba","Africa/Khartoum|Africa/Kampala","Africa/Khartoum|Africa/Mogadishu","Africa/Khartoum|Africa/Nairobi","Africa/Khartoum|Indian/Antananarivo","Africa/Khartoum|Indian/Comoro","Africa/Khartoum|Indian/Mayotte","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Argentina/Buenos_Aires|America/Argentina/Catamarca","America/Argentina/Buenos_Aires|America/Argentina/ComodRivadavia","America/Argentina/Buenos_Aires|America/Argentina/Cordoba","America/Argentina/Buenos_Aires|America/Argentina/Jujuy","America/Argentina/Buenos_Aires|America/Argentina/La_Rioja","America/Argentina/Buenos_Aires|America/Argentina/Mendoza","America/Argentina/Buenos_Aires|America/Argentina/Rio_Gallegos","America/Argentina/Buenos_Aires|America/Argentina/Salta","America/Argentina/Buenos_Aires|America/Argentina/San_Juan","America/Argentina/Buenos_Aires|America/Argentina/San_Luis","America/Argentina/Buenos_Aires|America/Argentina/Tucuman","America/Argentina/Buenos_Aires|America/Argentina/Ushuaia","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Buenos_Aires|America/Catamarca","America/Argentina/Buenos_Aires|America/Cordoba","America/Argentina/Buenos_Aires|America/Jujuy","America/Argentina/Buenos_Aires|America/Mendoza","America/Argentina/Buenos_Aires|America/Rosario","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Belem","America/Fortaleza|America/Maceio","America/Fortaleza|America/Recife","America/Fortaleza|America/Santarem","America/Halifax|America/Glace_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Los_Angeles|America/Dawson","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|America/Whitehorse","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Canada/Yukon","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/East-Saskatchewan","America/Managua|Canada/Saskatchewan","America/Manaus|America/Boa_Vista","America/Manaus|America/Porto_Velho","America/Manaus|Brazil/West","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Brazil/DeNoronha","America/Panama|America/Atikokan","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Rio_Branco|America/Eirunepe","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Antarctica/Palmer","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Asia/Almaty|Asia/Qyzylorda","Asia/Aqtobe|Asia/Aqtau","Asia/Aqtobe|Asia/Oral","Asia/Ashgabat|Asia/Ashkhabad","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Dhaka|Asia/Dacca","Asia/Dubai|Asia/Muscat","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kolkata|Asia/Colombo","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Makassar|Asia/Ujung_Pandang","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Singapore|Singapore","Asia/Tashkent|Asia/Samarkand","Asia/Tehran|Iran","Asia/Thimphu|Asia/Thimbu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Urumqi|Asia/Kashgar","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Astrakhan|Europe/Ulyanovsk","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|Europe/Volgograd","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Easter|Chile/EasterIsland","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Majuro|Kwajalein","Pacific/Majuro|Pacific/Kwajalein","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pohnpei|Pacific/Ponape"]
}),moment}),function(root,undefined){function isString(obj){return!!(""===obj||obj&&obj.charCodeAt&&obj.substr)}function isArray(obj){return nativeIsArray?nativeIsArray(obj):"[object Array]"===toString.call(obj)}function isObject(obj){return"[object Object]"===toString.call(obj)}function defaults(object,defs){var key;object=object||{},defs=defs||{};for(key in defs)defs.hasOwnProperty(key)&&null==object[key]&&(object[key]=defs[key]);return object}function map(obj,iterator,context){var i,j,results=[];if(!obj)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);for(i=0,j=obj.length;i<j;i++)results[i]=iterator.call(context,obj[i],i,obj);return results}function checkPrecision(val,base){return val=Math.round(Math.abs(val)),isNaN(val)?base:val}function checkCurrencyFormat(format){var defaults=lib.settings.currency.format;return"function"==typeof format&&(format=format()),isString(format)&&format.match("%v")?{pos:format,neg:format.replace("-","").replace("%v","-%v"),zero:format}:format&&format.pos&&format.pos.match("%v")?format:isString(defaults)?lib.settings.currency.format={pos:defaults,neg:defaults.replace("%v","-%v"),zero:defaults}:defaults}var lib={};lib.version="0.3.2",lib.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var nativeMap=Array.prototype.map,nativeIsArray=Array.isArray,toString=Object.prototype.toString,unformat=lib.unformat=lib.parse=function(value,decimal){if(isArray(value))return map(value,function(val){return unformat(val,decimal)});if(value=value||0,"number"==typeof value)return value;decimal=decimal||".";var regex=new RegExp("[^0-9-"+decimal+"]",["g"]),unformatted=parseFloat((""+value).replace(/\((.*)\)/,"-$1").replace(regex,"").replace(decimal,"."));return isNaN(unformatted)?0:unformatted},toFixed=lib.toFixed=function(value,precision){precision=checkPrecision(precision,lib.settings.number.precision);var power=Math.pow(10,precision);return(Math.round(lib.unformat(value)*power)/power).toFixed(precision)},formatNumber=lib.formatNumber=function(number,precision,thousand,decimal){if(isArray(number))return map(number,function(val){return formatNumber(val,precision,thousand,decimal)});number=unformat(number);var opts=defaults(isObject(precision)?precision:{precision:precision,thousand:thousand,decimal:decimal},lib.settings.number),usePrecision=checkPrecision(opts.precision),negative=number<0?"-":"",base=parseInt(toFixed(Math.abs(number||0),usePrecision),10)+"",mod=base.length>3?base.length%3:0;return negative+(mod?base.substr(0,mod)+opts.thousand:"")+base.substr(mod).replace(/(\d{3})(?=\d)/g,"$1"+opts.thousand)+(usePrecision?opts.decimal+toFixed(Math.abs(number),usePrecision).split(".")[1]:"")},formatMoney=lib.formatMoney=function(number,symbol,precision,thousand,decimal,format){if(isArray(number))return map(number,function(val){return formatMoney(val,symbol,precision,thousand,decimal,format)});number=unformat(number);var opts=defaults(isObject(symbol)?symbol:{symbol:symbol,precision:precision,thousand:thousand,decimal:decimal,format:format},lib.settings.currency),formats=checkCurrencyFormat(opts.format),useFormat=number>0?formats.pos:number<0?formats.neg:formats.zero;return useFormat.replace("%s",opts.symbol).replace("%v",formatNumber(Math.abs(number),checkPrecision(opts.precision),opts.thousand,opts.decimal))};lib.formatColumn=function(list,symbol,precision,thousand,decimal,format){if(!list)return[];var opts=defaults(isObject(symbol)?symbol:{symbol:symbol,precision:precision,thousand:thousand,decimal:decimal,format:format},lib.settings.currency),formats=checkCurrencyFormat(opts.format),padAfterSymbol=formats.pos.indexOf("%s")<formats.pos.indexOf("%v"),maxLength=0,formatted=map(list,function(val,i){if(isArray(val))return lib.formatColumn(val,opts);val=unformat(val);var useFormat=val>0?formats.pos:val<0?formats.neg:formats.zero,fVal=useFormat.replace("%s",opts.symbol).replace("%v",formatNumber(Math.abs(val),checkPrecision(opts.precision),opts.thousand,opts.decimal));return fVal.length>maxLength&&(maxLength=fVal.length),fVal});return map(formatted,function(val,i){return isString(val)&&val.length<maxLength?padAfterSymbol?val.replace(opts.symbol,opts.symbol+new Array(maxLength-val.length+1).join(" ")):new Array(maxLength-val.length+1).join(" ")+val:val})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=lib),exports.accounting=lib):"function"==typeof define&&define.amd?define([],function(){return lib}):(lib.noConflict=function(oldAccounting){return function(){return root.accounting=oldAccounting,lib.noConflict=undefined,lib}}(root.accounting),root.accounting=lib)}(this),function(window){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var paramPrefix,i,SKIP_INDEXES=2,templateArgs=arguments,code=templateArgs[0],message="["+(module?module+":":"")+code+"] ",template=templateArgs[1];for(message+=template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1),shiftedIndex=index+SKIP_INDEXES;return shiftedIndex<templateArgs.length?toDebugString(templateArgs[shiftedIndex]):match}),message+="\nhttp://errors.angularjs.org/1.5.8/"+(module?module+"/":"")+code,i=SKIP_INDEXES,paramPrefix="?";i<templateArgs.length;i++,paramPrefix="&")message+=paramPrefix+"p"+(i-SKIP_INDEXES)+"="+encodeURIComponent(toDebugString(templateArgs[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;if(isArray(obj)||isString(obj)||jqLite&&obj instanceof jqLite)return!0;var length="length"in Object(obj)&&obj.length;return isNumber(length)&&(length>=0&&(length-1 in obj||obj instanceof Array)||"function"==typeof obj.item)}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;key<length;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(isBlankObject(obj))for(key in obj)iterator.call(context,obj[key],key,obj);else if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);return obj}function forEachSorted(obj,iterator,context){for(var keys=Object.keys(obj).sort(),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function baseExtend(dst,objs,deep){for(var h=dst.$$hashKey,i=0,ii=objs.length;i<ii;++i){var obj=objs[i];if(isObject(obj)||isFunction(obj))for(var keys=Object.keys(obj),j=0,jj=keys.length;j<jj;j++){var key=keys[j],src=obj[key];deep&&isObject(src)?isDate(src)?dst[key]=new Date(src.valueOf()):isRegExp(src)?dst[key]=new RegExp(src):src.nodeName?dst[key]=src.cloneNode(!0):isElement(src)?dst[key]=src.clone():(isObject(dst[key])||(dst[key]=isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return setHashKey(dst,h),dst}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function merge(dst){return baseExtend(dst,slice.call(arguments,1),!0)}function toInt(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function hasCustomToString(obj){return isFunction(obj.toString)&&obj.toString!==toString}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isBlankObject(value){return null!==value&&"object"==typeof value&&!getPrototypeOf(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isFormData(obj){return"[object FormData]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isTypedArray(value){return value&&isNumber(value.length)&&TYPED_ARRAY_REGEXP.test(toString.call(value))}function isArrayBuffer(obj){return"[object ArrayBuffer]"===toString.call(obj)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),index}function copy(source,destination){function copyRecurse(source,destination){var key,h=destination.$$hashKey;if(isArray(source))for(var i=0,ii=source.length;i<ii;i++)destination.push(copyElement(source[i]));else if(isBlankObject(source))for(key in source)destination[key]=copyElement(source[key]);else if(source&&"function"==typeof source.hasOwnProperty)for(key in source)source.hasOwnProperty(key)&&(destination[key]=copyElement(source[key]));else for(key in source)hasOwnProperty.call(source,key)&&(destination[key]=copyElement(source[key]));return setHashKey(destination,h),destination}function copyElement(source){if(!isObject(source))return source;var index=stackSource.indexOf(source);if(index!==-1)return stackDest[index];if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var needsRecurse=!1,destination=copyType(source);return void 0===destination&&(destination=isArray(source)?[]:Object.create(getPrototypeOf(source)),needsRecurse=!0),stackSource.push(source),stackDest.push(destination),needsRecurse?copyRecurse(source,destination):destination}function copyType(source){switch(toString.call(source)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new source.constructor(copyElement(source.buffer),source.byteOffset,source.length);case"[object ArrayBuffer]":if(!source.slice){var copied=new ArrayBuffer(source.byteLength);return new Uint8Array(copied).set(new Uint8Array(source)),copied}return source.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new source.constructor(source.valueOf());case"[object RegExp]":var re=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]);return re.lastIndex=source.lastIndex,re;case"[object Blob]":return new source.constructor([source],{type:source.type})}if(isFunction(source.cloneNode))return source.cloneNode(!0)}var stackSource=[],stackDest=[];if(destination){if(isTypedArray(destination)||isArrayBuffer(destination))throw ngMinErr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");return isArray(destination)?destination.length=0:forEach(destination,function(value,key){"$$hashKey"!==key&&delete destination[key]}),stackSource.push(source),stackDest.push(destination),copyRecurse(source,destination)}return copyElement(source)}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return!!isDate(o2)&&equals(o1.getTime(),o2.getTime());if(isRegExp(o1))return!!isRegExp(o2)&&o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2)||isDate(o2)||isRegExp(o2))return!1;keySet=createMap();for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!(key in keySet)&&"$"!==key.charAt(0)&&isDefined(o2[key])&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;key<length;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=void 0:isWindow(value)?val="$WINDOW":value&&window.document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){if(!isUndefined(obj))return isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty)}function fromJson(json){return isString(json)?JSON.parse(json):json}function timezoneToOffset(timezone,fallback){timezone=timezone.replace(ALL_COLONS,"");var requestedTimezoneOffset=Date.parse("Jan 01, 1970 00:00:00 "+timezone)/6e4;return isNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset}function addDateMinutes(date,minutes){return date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+minutes),date}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var dateTimezoneOffset=date.getTimezoneOffset(),timezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset);return addDateMinutes(date,reverse*(timezoneOffset-dateTimezoneOffset))}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={};return forEach((keyValue||"").split("&"),function(keyValue){var splitPoint,key,val;keyValue&&(key=keyValue=keyValue.replace(/\+/g,"%20"),splitPoint=keyValue.indexOf("="),splitPoint!==-1&&(key=keyValue.substring(0,splitPoint),val=keyValue.substring(splitPoint+1)),key=tryDecodeURIComponent(key),isDefined(key)&&(val=!isDefined(val)||tryDecodeURIComponent(val),hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val))}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.getAttribute(attr)))return attr;return null}function angularInit(element,bootstrap){var appElement,module,config={};forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement&&(config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config))}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===window.document?"document":startingTag(element);throw ngMinErr("btstrpd","App already bootstrapped with this element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},void(isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap()))}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;if(!bindJQueryFired){var jqName=jq();jQuery=isUndefined(jqName)?window.jQuery:jqName?window[jqName]:void 0,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){for(var events,elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0}}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;i<len;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){for(var blockNodes,node=nodes[0],endNode=nodes[nodes.length-1],i=1;node!==endNode&&(node=node.nextSibling);i++)(blockNodes||nodes[i]!==node)&&(blockNodes||(blockNodes=jqLite(slice.call(nodes,0,i))),blockNodes.push(node));return blockNodes||nodes}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}function invokeLaterAndSetModuleName(provider,method){return function(recipeName,factoryFunction){return factoryFunction&&isFunction(factoryFunction)&&(factoryFunction.$$moduleName=name),invokeQueue.push([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLaterAndSetModuleName("$provide","provider"),factory:invokeLaterAndSetModuleName("$provide","factory"),service:invokeLaterAndSetModuleName("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),decorator:invokeLaterAndSetModuleName("$provide","decorator"),animation:invokeLaterAndSetModuleName("$animateProvider","register"),filter:invokeLaterAndSetModuleName("$filterProvider","register"),controller:invokeLaterAndSetModuleName("$controllerProvider","register"),directive:invokeLaterAndSetModuleName("$compileProvider","directive"),component:invokeLaterAndSetModuleName("$compileProvider","component"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"...";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):isUndefined(obj)?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,merge:merge,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{$$counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),(angularModule=setupModuleLoader(window))("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$animateCss:$CoreAnimateCssProvider,$$animateJs:$$CoreAnimateJsProvider,$$animateQueue:$$CoreAnimateQueueProvider,$$AnimateRunner:$$AnimateRunnerFactoryProvider,$$animateAsyncRun:$$AnimateAsyncRunFactoryProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$$forceReflow:$$ForceReflowProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpParamSerializer:$HttpParamSerializerProvider,$httpParamSerializerJQLike:$HttpParamSerializerJQLikeProvider,$httpBackend:$HttpBackendProvider,$xhrFactory:$xhrFactoryProvider,$jsonpCallbacks:$jsonpCallbacksProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$jqLite:$$jqLiteProvider,$$HashMap:$$HashMapProvider,$$cookieReader:$$CookieReaderProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteHasData(node){for(var key in jqCache[node.ng339])return!0;return!1}function jqLiteCleanData(nodes){for(var i=0,ii=nodes.length;i<ii;i++)jqLiteRemoveData(nodes[i])}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||window.document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function jqLiteWrapNode(node,wrapper){var parent=node.parentNode;parent&&parent.replaceChild(wrapper,node),wrapper.appendChild(node)}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;i<l;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type){var removeHandler=function(type){var listenerFns=events[type];isDefined(fn)&&arrayRemove(listenerFns||[],fn),isDefined(fn)&&listenerFns&&listenerFns.length>0||(removeEventListenerFn(element,type,handle),delete events[type])};forEach(type.split(" "),function(type){removeHandler(type),MOUSE_EVENT_MAP[type]&&removeHandler(MOUSE_EVENT_MAP[type])})}else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return void delete expandoStore.data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=void 0}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:void 0}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return!!element.getAttribute&&(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),existingClasses.indexOf(" "+cssClass+" ")===-1&&(existingClasses+=cssClass+" ");
}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;i<length;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType==NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;i<ii;i++)if(isDefined(value=jqLite.data(element,names[i])))return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(name){return ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return event.immediatePropagationStopped===!0};var handlerWrapper=eventFns.specialHandlerWrapper||defaultHandlerWrapper;eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;i<eventFnsLength;i++)event.isImmediatePropagationStopped()||handlerWrapper(element,event,eventFns[i])}};return eventHandler.elem=element,eventHandler}function defaultHandlerWrapper(element,event,handler){handler.call(element,event)}function specialMouseHandlerWrapper(target,event,handler){var related=event.relatedTarget;related&&(related===target||jqLiteContains.call(target,related))||handler.call(target,event)}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"==objType||"object"==objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function stringifyFn(fn){return Function.prototype.toString.call(fn)+" "}function extractArgs(fn){var fnText=stringifyFn(fn).replace(STRIP_COMMENTS,""),args=fnText.match(ARROW_ARG)||fnText.match(FN_ARGS);return args}function anonFn(fn){var args=extractArgs(fn);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);argDecl=extractArgs(fn),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){assertArg(isUndefined(modulesToLoad)||isArray(modulesToLoad),"modulesToLoad","not an array");var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;i<ii;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&e.stack.indexOf(e.message)==-1&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function injectionArgs(fn,locals,serviceName){for(var args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName),i=0,length=$inject.length;i<length;i++){var key=$inject[i];if("string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return args}function isClass(func){return!(msie<=11)&&("function"==typeof func&&/^(?:class\b|constructor\()/.test(stringifyFn(func)))}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var args=injectionArgs(fn,locals,serviceName);return isArray(fn)&&(fn=fn[fn.length-1]),isClass(fn)?(args.unshift(null),new(Function.prototype.bind.apply(fn,args))):fn.apply(self,args)}function instantiate(Type,locals,serviceName){var ctor=isArray(Type)?Type[Type.length-1]:Type,args=injectionArgs(Type,locals,serviceName);return args.unshift(null),new(Function.prototype.bind.apply(ctor,args))}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],(!0)),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},protoInstanceInjector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,void 0,serviceName)}),instanceInjector=protoInstanceInjector;providerCache["$injector"+providerSuffix]={$get:valueFn(protoInstanceInjector)};var runBlocks=loadModules(modulesToLoad);return instanceInjector=protoInstanceInjector.get("$injector"),instanceInjector.strictDi=strictDi,forEach(runBlocks,function(fn){fn&&instanceInjector.invoke(fn)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){if("a"===nodeName_(element))return result=element,!0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(hash){hash=isString(hash)?hash:$location.hash();var elm;hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){newVal===oldVal&&""===newVal||jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function mergeClasses(a,b){return a||b?a?b?(isArray(a)&&(a=a.join(" ")),isArray(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType===ELEMENT_NODE)return elm}}function splitClasses(classes){isString(classes)&&(classes=classes.split(" "));var obj=createMap();return forEach(classes,function(klass){klass.length&&(obj[klass]=!0)}),obj}function prepareAnimateOptions(options){return isObject(options)?options:{}}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function getHash(url){var index=url.indexOf("#");return index===-1?"":url.substr(index)}function cacheStateAndFireUrlChange(){pendingLocation=null,cacheState(),fireUrlChange()}function cacheState(){cachedState=getCurrentState(),cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){lastBrowserUrl===self.url()&&lastHistoryState===cachedState||(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}var self=this,location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),pendingLocation=null,getCurrentState=$sniffer.history?function(){try{return history.state}catch(e){}}:noop;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?(sameBase||(pendingLocation=url),replace?location.replace(url):sameBase?location.hash=getHash(url):location.href=url,location.href!==url&&(pendingLocation=url)):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),pendingLocation&&(pendingLocation=url),self}return pendingLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$applicationDestroyed=function(){jqLite(window).off("hashchange popstate",cacheStateAndFireUrlChange)},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return!!pendingDeferIds[deferId]&&(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0)}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data=createMap(),capacity=options&&options.capacity||Number.MAX_VALUE,lruHash=createMap(),freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(!isUndefined(value)){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value}},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}key in data&&(delete data[key],size--)},removeAll:function(){data=createMap(),size=0,lruHash=createMap(),freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function UNINITIALIZED_VALUE(){}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName,isController){var LOCAL_REGEXP=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,bindings=createMap();return forEach(scope,function(definition,scopeName){if(definition in bindingCache)return void(bindings[scopeName]=bindingCache[definition]);var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition,isController?"controller bindings definition":"isolate scope definition");bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName},match[4]&&(bindingCache[definition]=bindings[scopeName])}),bindings}function parseDirectiveBindings(directive,directiveName){var bindings={isolateScope:null,bindToController:null};if(isObject(directive.scope)&&(directive.bindToController===!0?(bindings.bindToController=parseIsolateBindings(directive.scope,directiveName,!0),bindings.isolateScope={}):bindings.isolateScope=parseIsolateBindings(directive.scope,directiveName,!1)),isObject(directive.bindToController)&&(bindings.bindToController=parseIsolateBindings(directive.bindToController,directiveName,!0)),isObject(bindings.bindToController)){var controller=directive.controller,controllerAs=directive.controllerAs;if(!controller)throw $compileMinErr("noctrl","Cannot bind to controller without directive '{0}'s controller.",directiveName);if(!identifierForController(controller,controllerAs))throw $compileMinErr("noident","Cannot bind to controller without identifier for directive '{0}'.",directiveName)}return bindings}function assertValidDirectiveName(name){var letter=name.charAt(0);if(!letter||letter!==lowercase(letter))throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",name);if(name!==name.trim())throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",name)}function getDirectiveRequire(directive){var require=directive.require||directive.controller&&directive.name;return!isArray(require)&&isObject(require)&&forEach(require,function(value,key){var match=value.match(REQUIRE_PREFIX_REGEXP),name=value.substring(match[0].length);name||(require[key]=match[0]+key)}),require}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?:\:([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/,bindingCache=createMap();this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertValidDirectiveName(name),assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=getDirectiveRequire(directive),directive.restrict=directive.restrict||"EA",directive.$$moduleName=directiveFactory.$$moduleName,directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.component=function(name,options){function factory($injector){function makeInjectable(fn){return isFunction(fn)||isArray(fn)?function(tElement,tAttrs){return $injector.invoke(fn,this,{$element:tElement,$attrs:tAttrs})}:fn}var template=options.template||options.templateUrl?options.template:"",ddo={controller:controller,controllerAs:identifierForController(options.controller)||options.controllerAs||"$ctrl",template:makeInjectable(template),templateUrl:makeInjectable(options.templateUrl),transclude:options.transclude,scope:{},bindToController:options.bindings||{},restrict:"E",require:options.require};return forEach(options,function(val,key){"$"===key.charAt(0)&&(ddo[key]=val)}),ddo}var controller=options.controller||function(){};return forEach(options,function(val,key){"$"===key.charAt(0)&&(factory[key]=val,isFunction(controller)&&(controller[key]=val))}),factory.$inject=["$injector"],this.directive(name,factory)},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled};var TTL=10;this.onChangesTtl=function(value){return arguments.length?(TTL=value,this):TTL},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$sce,$animate,$$sanitizeUri){function flushOnChangesQueue(){try{if(!--onChangesTtl)throw onChangesQueue=void 0,$compileMinErr("infchng","{0} $onChanges() iterations reached. Aborting!\n",TTL);$rootScope.$apply(function(){for(var errors=[],i=0,ii=onChangesQueue.length;i<ii;++i)try{onChangesQueue[i]()}catch(e){errors.push(e)}if(onChangesQueue=void 0,errors.length)throw errors})}finally{onChangesTtl++}}function Attributes(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;i<l;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element}function setSpecialAttr(element,attrName,value){specialAttrHolder.innerHTML="<span "+attrName+">";var attributes=specialAttrHolder.firstChild.attributes,attribute=attributes[0];attributes.removeNamedItem(attribute.name),attribute.value=value,element.attributes.setNamedItem(attribute)}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes));for(var NOT_EMPTY=/\S+/,i=0,len=$compileNodes.length;i<len;i++){var domNode=$compileNodes[i];domNode.nodeType===NODE_TYPE_TEXT&&domNode.nodeValue.match(NOT_EMPTY)&&jqLiteWrapNode(domNode,$compileNodes[i]=window.document.createElement("span"))}var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),previousCompileContext&&previousCompileContext.needsNewScope&&(scope=scope.$parent.$new()),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node&&"foreignobject"!==nodeName_(node)&&toString.call(node).match(/SVG/)?"svg":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;i<ii;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,void 0,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:void 0,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){function boundTranscludeFn(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})}var boundSlots=boundTranscludeFn.$$slots=createMap();for(var slotName in transcludeFn.$$slots)transcludeFn.$$slots[slotName]?boundSlots[slotName]=createBoundTranscludeFn(scope,transcludeFn.$$slots[slotName],previousBoundTranscludeFn):boundSlots[slotName]=null;return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;j<jj;j++){var attrStartName=!1,attrEndName=!1;attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=name.replace(PREFIX_REGEXP,"").substr(8).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()}));var multiElementMatch=ngAttrName.match(MULTI_ELEMENT_DIR_RE);multiElementMatch&&directiveIsMultiElement(multiElementMatch[1])&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,!isNgAttr&&attrs.hasOwnProperty(nName)||(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if(className=node.className,isObject(className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:if(11===msie)for(;node.parentNode&&node.nextSibling&&node.nextSibling.nodeType===NODE_TYPE_TEXT;)node.nodeValue=node.nodeValue+node.nextSibling.nodeValue,node.parentNode.removeChild(node.nextSibling);addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective)}return directives.sort(byPriority),directives}function collectCommentDirectives(node,directives,attrs,maxPriority,ignoreDirective){try{var match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue);if(match){var nName=directiveNormalize(match[1]);addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2]))}}catch(e){}}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType==NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function compilationGenerator(eager,$compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){var compiled;return eager?compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext):function(){return compiled||(compiled=compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext),$compileNodes=transcludeFn=previousCompileContext=null),compiled.apply(this,arguments);
}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement,slotName){var transcludeControllers;if(isScope(scope)||(slotName=futureParentElement,futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=void 0),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),!slotName)return boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);var slotTranscludeFn=boundTranscludeFn.$$slots[slotName];if(slotTranscludeFn)return slotTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);if(isUndefined(slotTranscludeFn))throw $compileMinErr("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',slotName,startingTag($element))}var i,ii,linkFn,isolateScope,controllerScope,elementControllers,transcludeFn,$element,attrs,scopeBindingInfo;compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),controllerScope=scope,newIsolateScopeDirective?isolateScope=scope.$new(!0):newScopeDirective&&(controllerScope=scope.$parent),boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn,transcludeFn.isSlotFilled=function(slotName){return!!boundTranscludeFn.$$slots[slotName]}),controllerDirectives&&(elementControllers=setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective)),newIsolateScopeDirective&&(compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0),isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,scopeBindingInfo=initializeDirectiveBindings(scope,attrs,isolateScope,isolateScope.$$isolateBindings,newIsolateScopeDirective),scopeBindingInfo.removeWatches&&isolateScope.$on("$destroy",scopeBindingInfo.removeWatches));for(var name in elementControllers){var controllerDirective=controllerDirectives[name],controller=elementControllers[name],bindings=controllerDirective.$$bindings.bindToController;controller.identifier&&bindings?controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective):controller.bindingInfo={};var controllerResult=controller();controllerResult!==controller.instance&&(controller.instance=controllerResult,$element.data("$"+controllerDirective.name+"Controller",controllerResult),controller.bindingInfo.removeWatches&&controller.bindingInfo.removeWatches(),controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective))}for(forEach(controllerDirectives,function(controllerDirective,name){var require=controllerDirective.require;controllerDirective.bindToController&&!isArray(require)&&isObject(require)&&extend(elementControllers[name].instance,getControllers(name,require,$element,elementControllers))}),forEach(elementControllers,function(controller){var controllerInstance=controller.instance;if(isFunction(controllerInstance.$onChanges))try{controllerInstance.$onChanges(controller.bindingInfo.initialChanges)}catch(e){$exceptionHandler(e)}if(isFunction(controllerInstance.$onInit))try{controllerInstance.$onInit()}catch(e){$exceptionHandler(e)}isFunction(controllerInstance.$doCheck)&&(controllerScope.$watch(function(){controllerInstance.$doCheck()}),controllerInstance.$doCheck()),isFunction(controllerInstance.$onDestroy)&&controllerScope.$on("$destroy",function(){controllerInstance.$onDestroy()})}),i=0,ii=preLinkFns.length;i<ii;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,void 0,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);forEach(elementControllers,function(controller){var controllerInstance=controller.instance;isFunction(controllerInstance.$postLink)&&controllerInstance.$postLink()})}previousCompileContext=previousCompileContext||{};for(var directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,newScopeDirective=previousCompileContext.newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,didScanForMultipleTransclusion=!1,mightHaveMultipleTransclusionError=!1,i=0,ii=directives.length;i<ii;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=void 0,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!didScanForMultipleTransclusion&&(directive.replace&&(directive.templateUrl||directive.template)||directive.transclude&&!directive.$$tlb)){for(var candidateDirective,scanningIndex=i+1;candidateDirective=directives[scanningIndex++];)if(candidateDirective.transclude&&!candidateDirective.$$tlb||candidateDirective.replace&&(candidateDirective.templateUrl||candidateDirective.template)){mightHaveMultipleTransclusionError=!0;break}didScanForMultipleTransclusion=!0}if(!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||createMap(),assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),directiveValue=directive.transclude)if(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue)hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(compile.$$createComment(directiveName,templateAttrs[directiveName])),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),$template[0].$$parentNode=$template[0].parentNode,childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective});else{var slots=createMap();if($template=jqLite(jqLiteClone(compileNode)).contents(),isObject(directiveValue)){$template=[];var slotMap=createMap(),filledSlots=createMap();forEach(directiveValue,function(elementSelector,slotName){var optional="?"===elementSelector.charAt(0);elementSelector=optional?elementSelector.substring(1):elementSelector,slotMap[elementSelector]=slotName,slots[slotName]=null,filledSlots[slotName]=optional}),forEach($compileNode.contents(),function(node){var slotName=slotMap[directiveNormalize(nodeName_(node))];slotName?(filledSlots[slotName]=!0,slots[slotName]=slots[slotName]||[],slots[slotName].push(node)):$template.push(node)}),forEach(filledSlots,function(filled,slotName){if(!filled)throw $compileMinErr("reqslot","Required transclusion slot `{0}` was not filled.",slotName)});for(var slotName in slots)slots[slotName]&&(slots[slotName]=compilationGenerator(mightHaveMultipleTransclusionError,slots[slotName],transcludeFn))}$compileNode.empty(),childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,void 0,void 0,{needsNewScope:directive.$$isolateScope||directive.$$newScope}),childTranscludeFn.$$slots=slots}if(directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));(newIsolateScopeDirective||newScopeDirective)&&markDirectiveScope(templateDirectives,newIsolateScopeDirective,newScopeDirective),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newScopeDirective:newScopeDirective!==directive&&newScopeDirective,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn);var context=directive.$$originalDirective||directive;isFunction(linkFn)?addLinkFns(null,bind(context,linkFn),attrStart,attrEnd):linkFn&&addLinkFns(bind(context,linkFn.pre),bind(context,linkFn.post),attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function getControllers(directiveName,require,$element,elementControllers){var value;if(isString(require)){var match=require.match(REQUIRE_PREFIX_REGEXP),name=require.substring(match[0].length),inheritType=match[1]||match[3],optional="?"===match[2];if("^^"===inheritType?$element=$element.parent():(value=elementControllers&&elementControllers[name],value=value&&value.instance),!value){var dataName="$"+name+"Controller";value=inheritType?$element.inheritedData(dataName):$element.data(dataName)}if(!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",name,directiveName)}else if(isArray(require)){value=[];for(var i=0,ii=require.length;i<ii;i++)value[i]=getControllers(directiveName,require[i],$element,elementControllers)}else isObject(require)&&(value={},forEach(require,function(controller,property){value[property]=getControllers(directiveName,controller,$element,elementControllers)}));return value||null}function setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective){var elementControllers=createMap();for(var controllerKey in controllerDirectives){var directive=controllerDirectives[controllerKey],locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controller=directive.controller;"@"==controller&&(controller=attrs[directive.name]);var controllerInstance=$controller(controller,locals,!0,directive.controllerAs);elementControllers[directive.name]=controllerInstance,$element.data("$"+directive.name+"Controller",controllerInstance.instance)}return elementControllers}function markDirectiveScope(directives,isolateScope,newScope){for(var j=0,jj=directives.length;j<jj;j++)directives[j]=inherit(directives[j],{$$isolateScope:isolateScope,$$newScope:newScope})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)try{if(directive=directives[i],(isUndefined(maxPriority)||maxPriority>directive.priority)&&directive.restrict.indexOf(location)!=-1){if(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),!directive.$$bindings){var bindings=directive.$$bindings=parseDirectiveBindings(directive,directive.name);isObject(bindings.isolateScope)&&(directive.$$isolateBindings=bindings.isolateScope)}tDirectives.push(directive),match=directive}}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr;dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){dst.hasOwnProperty(key)||"$"===key.charAt(0)||(dst[key]=value,"class"!==key&&"style"!==key&&(dstAttr[key]=srcAttr[key]))})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest(templateUrl).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectiveScope(templateDirectives,!0),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){function wrapModuleNameIfDefined(moduleName){return moduleName?" (module: "+moduleName+")":""}if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",previousDirective.name,wrapModuleNameIfDefined(previousDirective.$$moduleName),directive.name,wrapModuleNameIfDefined(directive.$$moduleName),what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=window.document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"form"==tag&&"action"==attrNormalizedName||"img"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var trustedContext=getTrustedContext(node,name);allOrNothing=ALL_OR_NOTHING_ATTRS[name]||allOrNothing;var interpolateFn=$interpolate(value,!0,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers=createMap());if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;i<ii;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;j<jj;j++,j2++)j2<jj?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=window.document.createDocumentFragment();for(i=0;i<removeCount;i++)fragment.appendChild(elementsToRemove[i]);for(jqLite.hasData(firstElementToRemove)&&(jqLite.data(newNode,jqLite.data(firstElementToRemove)),jqLite(firstElementToRemove).off("$destroy")),jqLite.cleanData(fragment.querySelectorAll("*")),i=1;i<removeCount;i++)delete elementsToRemove[i];elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}function initializeDirectiveBindings(scope,attrs,destination,bindings,directive){function recordChanges(key,currentValue,previousValue){isFunction(destination.$onChanges)&&currentValue!==previousValue&&(onChangesQueue||(scope.$$postDigest(flushOnChangesQueue),onChangesQueue=[]),changes||(changes={},onChangesQueue.push(triggerOnChangesHook)),changes[key]&&(previousValue=changes[key].previousValue),changes[key]=new SimpleChange(previousValue,currentValue))}function triggerOnChangesHook(){destination.$onChanges(changes),changes=void 0}var changes,removeWatchCollection=[],initialChanges={};return forEach(bindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,removeWatch,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":optional||hasOwnProperty.call(attrs,attrName)||(destination[scopeName]=attrs[attrName]=void 0),attrs.$observe(attrName,function(value){if(isString(value)||isBoolean(value)){var oldValue=destination[scopeName];recordChanges(scopeName,value,oldValue),destination[scopeName]=value}}),attrs.$$observers[attrName].$$scope=scope,lastValue=attrs[attrName],isString(lastValue)?destination[scopeName]=$interpolate(lastValue)(scope):isBoolean(lastValue)&&(destination[scopeName]=lastValue),initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]);break;case"=":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=destination[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",attrs[attrName],attrName,directive.name)},lastValue=destination[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,destination[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=destination[scopeName]):destination[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0,removeWatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),removeWatchCollection.push(removeWatch);break;case"<":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]);var initialValue=destination[scopeName]=parentGet(scope);initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]),removeWatch=scope.$watch(parentGet,function(newValue,oldValue){if(oldValue===newValue){if(oldValue===initialValue)return;oldValue=initialValue}recordChanges(scopeName,newValue,oldValue),destination[scopeName]=newValue},parentGet.literal),removeWatchCollection.push(removeWatch);break;case"&":if(parentGet=attrs.hasOwnProperty(attrName)?$parse(attrs[attrName]):noop,parentGet===noop&&optional)break;destination[scopeName]=function(locals){return parentGet(scope,locals)}}}),{initialChanges:initialChanges,removeWatches:removeWatchCollection.length&&function(){for(var i=0,ii=removeWatchCollection.length;i<ii;++i)removeWatchCollection[i]()}}}var onChangesQueue,SIMPLE_ATTR_NAME=/^\w/,specialAttrHolder=window.document.createElement("div"),onChangesTtl=TTL;Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&("href"===key||"xlinkHref"===key)||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key&&isDefined(value)){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;i<nbrUrisWith2parts;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||isUndefined(value)?this.$$element.removeAttr(attrName):SIMPLE_ATTR_NAME.test(attrName)?this.$$element.attr(attrName,value):setSpecialAttr(this.$$element[0],attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||!attrs.hasOwnProperty(key)||isUndefined(attrs[key])||fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol&&"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/,MULTI_ELEMENT_DIR_RE=/^(.+)Start$/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile.$$createComment=function(directiveName,comment){var content="";return debugInfoEnabled&&(content=" "+(directiveName||"")+": ",comment&&(content+=comment+" ")),window.document.createComment(content)},compile}]}function SimpleChange(previous,current){this.previousValue=previous,this.currentValue=current}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(i<=1)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function identifierForController(controller,ident){if(ident&&isString(ident))return ident;if(isString(controller)){var match=CNTRL_REG.exec(controller);if(match)return match[3]}}function $ControllerProvider(){var controllers={},globals=!1;this.has=function(name){return controllers.hasOwnProperty(name)},this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(match=expression.match(CNTRL_REG),!match)throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);
constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):void 0),assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name);var instantiate;return instantiate=extend(function(){var result=$injector.invoke(expression,instance,locals,constructor);return result!==instance&&(isObject(result)||isFunction(result))&&(instance=result,identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name)),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}function serializeValue(v){return isObject(v)?isDate(v)?v.toISOString():toJson(v):v}function $HttpParamSerializerProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)?forEach(value,function(v){parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(v)))}):parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(value))))}),parts.join("&")}}}function $HttpParamSerializerJQLikeProvider(){this.$get=function(){return function(params){function serialize(toSerialize,prefix,topLevel){null===toSerialize||isUndefined(toSerialize)||(isArray(toSerialize)?forEach(toSerialize,function(value,index){serialize(value,prefix+"["+(isObject(value)?index:"")+"]")}):isObject(toSerialize)&&!isDate(toSerialize)?forEachSorted(toSerialize,function(value,key){serialize(value,prefix+(topLevel?"":"[")+key+(topLevel?"":"]"))}):parts.push(encodeUriQuery(prefix)+"="+encodeUriQuery(serializeValue(toSerialize))))}if(!params)return"";var parts=[];return serialize(params,"",!0),parts.join("&")}}}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();if(tempData){var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)||isJsonLike(tempData))&&(data=fromJson(tempData))}}return data}function isJsonLike(str){var jsonStart=str.match(JSON_START);return jsonStart&&JSON_ENDS[jsonStart[0]].test(str)}function parseHeaders(headers){function fillInParsed(key,val){key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}var i,parsed=createMap();return isString(headers)?forEach(headers.split("\n"),function(line){i=line.indexOf(":"),fillInParsed(lowercase(trim(line.substr(0,i))),trim(line.substr(i+1)))}):isObject(headers)&&forEach(headers,function(headerVal,headerKey){fillInParsed(lowercase(headerKey),trim(headerVal))}),parsed}function headersGetter(headers){var headersObj;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return 200<=status&&status<300}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)||isFormData(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var useLegacyPromise=!0;this.useLegacyPromiseExtensions=function(value){return isDefined(value)?(useLegacyPromise=!!value,this):useLegacyPromise};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$$cookieReader,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function chainInterceptors(promise,interceptors){for(var i=0,ii=interceptors.length;i<ii;){var thenFn=interceptors[i++],rejectFn=interceptors[i++];promise=promise.then(thenFn,rejectFn)}return interceptors.length=0,promise}function executeHeaderFns(headers,config){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?(headerContent=headerFn(config),null!=headerContent&&(processedHeaders[header]=headerContent)):processedHeaders[header]=headerFn}),processedHeaders}function mergeHeaders(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return executeHeaderFns(reqHeaders,shallowCopy(config))}function serverRequest(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),void 0,config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData).then(transformResponse,transformResponse)}function transformResponse(response){var resp=extend({},response);return resp.data=transformData(response.data,response.headers,response.status,config.transformResponse),isSuccess(response.status)?resp:$q.reject(resp)}if(!isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);if(!isString(requestConfig.url))throw minErr("$http")("badreq","Http request configuration url must be a string.  Received: {0}",requestConfig.url);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse,paramSerializer:defaults.paramSerializer},requestConfig);config.headers=mergeHeaders(requestConfig),config.method=uppercase(config.method),config.paramSerializer=isString(config.paramSerializer)?$injector.get(config.paramSerializer):config.paramSerializer;var requestInterceptors=[],responseInterceptors=[],promise=$q.when(config);return forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&requestInterceptors.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&responseInterceptors.push(interceptor.response,interceptor.responseError)}),promise=chainInterceptors(promise,requestInterceptors),promise=promise.then(serverRequest),promise=chainInterceptors(promise,responseInterceptors),useLegacyPromise?(promise.success=function(fn){return assertArgFn(fn,"fn"),promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return assertArgFn(fn,"fn"),promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise}):(promise.success=$httpMinErrLegacyFn("success"),promise.error=$httpMinErrLegacyFn("error")),promise}function createShortMethods(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend({},config||{},{method:name,url:url}))}})}function createShortMethodsWithData(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend({},config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData){function createApplyHandlers(eventHandlers){if(eventHandlers){var applyHandlers={};return forEach(eventHandlers,function(eventHandler,key){applyHandlers[key]=function(event){function callEventHandler(){eventHandler(event)}useApplyAsync?$rootScope.$applyAsync(callEventHandler):$rootScope.$$phase?callEventHandler():$rootScope.$apply(callEventHandler)}}),applyHandlers}}function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=status>=-1?status:0,(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);idx!==-1&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,url=buildUrl(config.url,config.paramSerializer(config.params));if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache&&(cachedResp=cache.get(url),isDefined(cachedResp)?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK"):cache.put(url,promise)),isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$$cookieReader()[config.xsrfCookieName||defaults.xsrfCookieName]:void 0;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType,createApplyHandlers(config.eventHandlers),createApplyHandlers(config.uploadEventHandlers))}return promise}function buildUrl(url,serializedParams){return serializedParams.length>0&&(url+=(url.indexOf("?")==-1?"?":"&")+serializedParams),url}var defaultCache=$cacheFactory("$http");defaults.paramSerializer=isString(defaults.paramSerializer)?$injector.get(defaults.paramSerializer):defaults.paramSerializer;var reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function $xhrFactoryProvider(){this.$get=function(){return function(){return new window.XMLHttpRequest}}}function $HttpBackendProvider(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function($browser,$jsonpCallbacks,$document,$xhrFactory){return createHttpBackend($browser,$xhrFactory,$browser.defer,$jsonpCallbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackPath,done){url=url.replace("JSON_CALLBACK",callbackPath);var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks.wasCalled(callbackPath)||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType,eventHandlers,uploadEventHandlers){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){isDefined(timeoutId)&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"===lowercase(method))var callbackPath=callbacks.createCallback(url),jsonpDone=jsonpReq(url,callbackPath,function(status,text){var response=200===status&&callbacks.getResponse(callbackPath);completeRequest(callback,status,response,"",text),callbacks.removeCallback(callbackPath)});else{var xhr=createXhr(method,url);xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,forEach(eventHandlers,function(value,key){xhr.addEventListener(key,value)}),forEach(uploadEventHandlers,function(value,key){xhr.upload.addEventListener(key,value)}),withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(isUndefined(post)?null:post)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function stringify(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value}function constantWatchDelegate(scope,listener,objectEquality,constantInterp){var unwatch;return unwatch=scope.$watch(function(scope){return unwatch(),constantInterp(scope)},listener,objectEquality)}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}}if(!text.length||text.indexOf(startSymbol)===-1){var constantInterp;if(!mustHaveExpression){var unescapedText=unescapeText(text);constantInterp=valueFn(unescapedText),constantInterp.exp=text,constantInterp.expressions=[],constantInterp.$$watchDelegate=constantWatchDelegate}return constantInterp}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];index<textLength;){if((startIndex=text.indexOf(startSymbol,index))==-1||(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))==-1){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1&&$interpolateMinErr.throwNoconcat(text),!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;i<ii;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;i<ii;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue})}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q","$browser",function($rootScope,$window,$q,$$q,$browser){function interval(fn,delay,count,invokeApply){function callback(){hasParams?fn.apply(null,args):fn(iteration)}var hasParams=arguments.length>4,args=hasParams?sliceArgs(arguments,4):[],setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.$$intervalId=setInterval(function(){skipApply?$browser.defer(callback):$rootScope.$evalAsync(callback),deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return!!(promise&&promise.$$intervalId in intervals)&&(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0)},interval}]}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=toInt(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function startsWith(haystack,needle){return 0===haystack.lastIndexOf(needle,0)}function stripBaseUrl(base,url){if(startsWith(url,base))return url.substr(base.length)}function stripHash(url){var index=url.indexOf("#");return index==-1?url:url.substr(0,index)}function trimEmptyHash(url){return url.replace(/(#.+)|#$/,"$1")}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,appBaseNoFile,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"",parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=stripBaseUrl(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return isDefined(appUrl=stripBaseUrl(appBase,url))?(prevAppUrl=appUrl,rewrittenUrl=isDefined(appUrl=stripBaseUrl(basePrefix,appUrl))?appBaseNoFile+(stripBaseUrl("/",appUrl)||appUrl):appBase+prevAppUrl):isDefined(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,appBaseNoFile,hashPrefix){parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return startsWith(url,base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutHashUrl,withoutBaseUrl=stripBaseUrl(appBase,url)||stripBaseUrl(appBaseNoFile,url);isUndefined(withoutBaseUrl)||"#"!==withoutBaseUrl.charAt(0)?this.$$html5?withoutHashUrl=withoutBaseUrl:(withoutHashUrl="",isUndefined(withoutBaseUrl)&&(appBase=url,this.replace())):(withoutHashUrl=stripBaseUrl(hashPrefix,withoutBaseUrl),isUndefined(withoutHashUrl)&&(withoutHashUrl=withoutBaseUrl)),parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url,relHref){return stripHash(appBase)==stripHash(url)&&(this.$$parse(url),!0)}}function LocationHashbangInHtml5Url(appBase,appBaseNoFile,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;var appBaseNoFile=stripFile(appBase);$location=new LocationMode(appBase,appBaseNoFile,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!=event.which&&2!=event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),$window.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($location.absUrl())!=trimEmptyHash(initialUrl)&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){return isUndefined(stripBaseUrl(appBaseNoFile,newUrl))?void($window.location.href=newUrl):($rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;newUrl=trimEmptyHash(newUrl),$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),void($rootScope.$$phase||$rootScope.$digest()))}),$rootScope.$watch(function(){var oldUrl=trimEmptyHash($browser.url()),newUrl=trimEmptyHash($location.absUrl()),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==newUrl||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&arg.stack.indexOf(arg.message)===-1?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function getStringValue(name){return name+""}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function ensureSafeAssignContext(obj,fullExpression){if(obj&&(obj===(0).constructor||obj===(!1).constructor||obj==="".constructor||obj==={}.constructor||obj===[].constructor||obj===Function.constructor))throw $parseMinErr("isecaf","Assigning to a constructor is disallowed! Expression: {0}",fullExpression)}function ifDefined(v,d){return"undefined"!=typeof v?v:d}function plusFn(l,r){return"undefined"==typeof l?r:"undefined"==typeof r?l:l+r}function isStateless($filter,filterName){var fn=$filter(filterName);return!fn.$stateful}function findConstantAndWatchExpressions(ast,$filter){var allConstants,argsToWatch;switch(ast.type){case AST.Program:allConstants=!0,forEach(ast.body,function(expr){findConstantAndWatchExpressions(expr.expression,$filter),allConstants=allConstants&&expr.expression.constant}),ast.constant=allConstants;break;case AST.Literal:ast.constant=!0,ast.toWatch=[];break;case AST.UnaryExpression:findConstantAndWatchExpressions(ast.argument,$filter),ast.constant=ast.argument.constant,ast.toWatch=ast.argument.toWatch;break;case AST.BinaryExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.left.toWatch.concat(ast.right.toWatch);break;case AST.LogicalExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.ConditionalExpression:findConstantAndWatchExpressions(ast.test,$filter),findConstantAndWatchExpressions(ast.alternate,$filter),findConstantAndWatchExpressions(ast.consequent,$filter),ast.constant=ast.test.constant&&ast.alternate.constant&&ast.consequent.constant,
ast.toWatch=ast.constant?[]:[ast];break;case AST.Identifier:ast.constant=!1,ast.toWatch=[ast];break;case AST.MemberExpression:findConstantAndWatchExpressions(ast.object,$filter),ast.computed&&findConstantAndWatchExpressions(ast.property,$filter),ast.constant=ast.object.constant&&(!ast.computed||ast.property.constant),ast.toWatch=[ast];break;case AST.CallExpression:allConstants=!!ast.filter&&isStateless($filter,ast.callee.name),argsToWatch=[],forEach(ast.arguments,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=ast.filter&&isStateless($filter,ast.callee.name)?argsToWatch:[ast];break;case AST.AssignmentExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=[ast];break;case AST.ArrayExpression:allConstants=!0,argsToWatch=[],forEach(ast.elements,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ObjectExpression:allConstants=!0,argsToWatch=[],forEach(ast.properties,function(property){findConstantAndWatchExpressions(property.value,$filter),allConstants=allConstants&&property.value.constant&&!property.computed,property.value.constant||argsToWatch.push.apply(argsToWatch,property.value.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ThisExpression:ast.constant=!1,ast.toWatch=[];break;case AST.LocalsExpression:ast.constant=!1,ast.toWatch=[]}}function getInputs(body){if(1==body.length){var lastExpression=body[0].expression,candidate=lastExpression.toWatch;return 1!==candidate.length?candidate:candidate[0]!==lastExpression?candidate:void 0}}function isAssignable(ast){return ast.type===AST.Identifier||ast.type===AST.MemberExpression}function assignableAST(ast){if(1===ast.body.length&&isAssignable(ast.body[0].expression))return{type:AST.AssignmentExpression,left:ast.body[0].expression,right:{type:AST.NGValueParameter},operator:"="}}function isLiteral(ast){return 0===ast.body.length||1===ast.body.length&&(ast.body[0].expression.type===AST.Literal||ast.body[0].expression.type===AST.ArrayExpression||ast.body[0].expression.type===AST.ObjectExpression)}function isConstant(ast){return ast.constant}function ASTCompiler(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function ASTInterpreter(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function isPossiblyDangerousMemberName(name){return"constructor"==name}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var identStart,identContinue,cacheDefault=createMap(),cacheExpensive=createMap(),literals={"true":!0,"false":!1,"null":null,undefined:void 0};this.addLiteral=function(literalName,literalValue){literals[literalName]=literalValue},this.setIdentifierFns=function(identifierStart,identifierContinue){return identStart=identifierStart,identContinue=identifierContinue,this},this.$get=["$filter",function($filter){function $parse(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(expensiveChecks=expensiveChecks||runningChecksEnabled,typeof exp){case"string":exp=exp.trim(),cacheKey=exp;var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate:parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),expensiveChecks&&(parsedExpression=expensiveChecksInterceptor(parsedExpression)),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}function expensiveChecksInterceptor(fn){function expensiveCheckFn(scope,locals,assign,inputs){var expensiveCheckOldValue=runningChecksEnabled;runningChecksEnabled=!0;try{return fn(scope,locals,assign,inputs)}finally{runningChecksEnabled=expensiveCheckOldValue}}if(!fn)return fn;expensiveCheckFn.$$watchDelegate=fn.$$watchDelegate,expensiveCheckFn.assign=expensiveChecksInterceptor(fn.assign),expensiveCheckFn.constant=fn.constant,expensiveCheckFn.literal=fn.literal;for(var i=0;fn.inputs&&i<fn.inputs.length;++i)fn.inputs[i]=expensiveChecksInterceptor(fn.inputs[i]);return expensiveCheckFn.inputs=fn.inputs,expensiveCheckFn}function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:("object"!=typeof newValue||(newValue=getValueOf(newValue),"object"!=typeof newValue))&&(newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue)}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var lastResult,inputExpressions=parsedExpression.inputs;if(1===inputExpressions.length){var oldInputValueOf=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValueOf)||(lastResult=parsedExpression(scope,void 0,void 0,[newInputValue]),oldInputValueOf=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality,prettyPrintExpression)}for(var oldInputValueOfValues=[],oldInputValues=[],i=0,ii=inputExpressions.length;i<ii;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck,oldInputValues[i]=null;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;i<ii;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValues[i]=newInputValue,oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope,void 0,void 0,oldInputValues)),lastResult},listener,objectEquality,prettyPrintExpression)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch;return unwatch=scope.$watch(function(scope){return unwatch(),parsedExpression(scope)},listener,objectEquality)}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,useInputs=!1,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals,assign,inputs){var value=useInputs&&inputs?inputs[0]:parsedExpression(scope,locals,assign,inputs);return interceptorFn(value,scope,locals)}:function(scope,locals,assign,inputs){var value=parsedExpression(scope,locals,assign,inputs),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,useInputs=!parsedExpression.inputs,fn.inputs=parsedExpression.inputs?parsedExpression.inputs:[parsedExpression]),fn}var noUnsafeEval=csp().noUnsafeEval,$parseOptions={csp:noUnsafeEval,expensiveChecks:!1,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},$parseOptionsExpensive={csp:noUnsafeEval,expensiveChecks:!0,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue},runningChecksEnabled=!1;return $parse.$$runningExpensiveChecks=function(){return runningChecksEnabled},$parse}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,deferred,pending;pending=state.pending,state.processScheduled=!1,state.pending=void 0;for(var i=0,ii=pending.length;i<ii;++i){deferred=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?deferred.resolve(fn(state.value)):1===state.status?deferred.resolve(state.value):deferred.reject(state.value)}catch(e){deferred.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}function race(promises){var deferred=defer();return forEach(promises,function(promise){when(promise).then(deferred.resolve,deferred.reject)}),deferred.promise}var $qMinErr=minErr("$q",TypeError),defer=function(){var d=new Deferred;return d.resolve=simpleBind(d,d.resolve),d.reject=simpleBind(d,d.reject),d.notify=simpleBind(d,d.notify),d};extend(Promise.prototype,{then:function(onFulfilled,onRejected,progressBack){if(isUndefined(onFulfilled)&&isUndefined(onRejected)&&isUndefined(progressBack))return this;var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}}),extend(Deferred.prototype,{resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){function resolvePromise(val){done||(done=!0,that.$$resolve(val))}function rejectPromise(val){done||(done=!0,that.$$reject(val))}var then,that=this,done=!1;try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,resolvePromise,rejectPromise,simpleBind(this,this.notify))):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){rejectPromise(e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;i<ii;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}});var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},resolve=when,$Q=function(resolver){function resolveFn(value){deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.prototype=Promise.prototype,$Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.resolve=resolve,$Q.all=all,$Q.race=race,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){function createChildScopeClass(parent){function ChildScope(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=nextUid(),this.$$ChildScope=null}return ChildScope.prototype=parent,ChildScope}var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$exceptionHandler","$parse","$browser",function($exceptionHandler,$parse,$browser){function destroyChildScope($event){$event.currentScope.$$destroyed=!0}function cleanUpScope($scope){9===msie&&($scope.$$childHead&&cleanUpScope($scope.$$childHead),$scope.$$nextSibling&&cleanUpScope($scope.$$nextSibling)),$scope.$parent=$scope.$$nextSibling=$scope.$$prevSibling=$scope.$$childHead=$scope.$$childTail=$scope.$root=$scope.$$watchers=null}function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function incrementWatchersCount(current,count){do current.$$watchersCount+=count;while(current=current.$parent)}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=createChildScopeClass(this)),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!=this)&&child.$on("$destroy",destroyChildScope),child},$watch:function(watchExp,listener,objectEquality,prettyPrintExpression){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get,watchExp);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:prettyPrintExpression||watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),incrementWatchersCount(this,1),function(){arrayRemove(array,watcher)>=0&&incrementWatchersCount(scope,-1),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;i<newLength;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)hasOwnProperty.call(newValue,key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)hasOwnProperty.call(newValue,key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,fn,get,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{dirty=!1,current=target;for(var asyncQueuePosition=0;asyncQueuePosition<asyncQueue.length;asyncQueuePosition++){try{asyncTask=asyncQueue[asyncQueuePosition],asyncTask.scope.$eval(asyncTask.expression,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}asyncQueue.length=0;traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if(get=watch.get,(value=get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,fn=watch.fn,fn(value,last===initWatchVal?value:last,current),ttl<5&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$watchersCount&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueuePosition<postDigestQueue.length;)try{postDigestQueue[postDigestQueuePosition++]()}catch(e){$exceptionHandler(e)}postDigestQueue.length=postDigestQueuePosition=0},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===$rootScope&&$browser.$$applicationDestroyed(),incrementWatchersCount(this,-this.$$watchersCount);for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent&&parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent&&parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$$nextSibling=null,cleanUpScope(this)}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:$parse(expr),locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{beginPhase("$apply");try{return this.$eval(expr)}finally{clearPhase()}}catch(e){$exceptionHandler(e)}finally{try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),expr=$parse(expr),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);indexOfListener!==-1&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name,args){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;i<length;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name,args){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;i<length;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[],postDigestQueuePosition=0;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;i<n;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;i<n;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||isUndefined(trustedValue)||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||isUndefined(maybeTrusted)||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&msie<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;
return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},isChromePackagedApp=$window.chrome&&$window.chrome.app&&$window.chrome.app.runtime,hasHistoryPushState=!isChromePackagedApp&&$window.history&&$window.history.pushState,android=toInt((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix[0].toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(bodyStyle.webkitTransition),animations=isString(bodyStyle.webkitAnimation))}return{history:!(!hasHistoryPushState||android<4||boxee),hasEvent:function(event){if("input"===event&&msie<=11)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){var httpOptions;this.httpOptions=function(val){return val?(httpOptions=val,this):httpOptions},this.$get=["$templateCache","$http","$q","$sce",function($templateCache,$http,$q,$sce){function handleRequestFn(tpl,ignoreRequestError){function handleError(resp){if(!ignoreRequestError)throw $templateRequestMinErr("tpload","Failed to load template: {0} (HTTP status: {1} {2})",tpl,resp.status,resp.statusText);return $q.reject(resp)}handleRequestFn.totalPendingRequests++,isString(tpl)&&!isUndefined($templateCache.get(tpl))||(tpl=$sce.getTrustedResourceUrl(tpl));var transformResponse=$http.defaults&&$http.defaults.transformResponse;return isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null),$http.get(tpl,extend({cache:$templateCache,transformResponse:transformResponse},httpOptions))["finally"](function(){handleRequestFn.totalPendingRequests--}).then(function(response){return $templateCache.put(tpl,response.data),response.data},handleError)}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else bindingName.indexOf(expression)!=-1&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop);var timeoutId,args=sliceArgs(arguments,3),skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn.apply(null,args))}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return!!(promise&&promise.$$timeoutId in deferreds)&&(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId))},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $$CookieReader($document){function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var rawDocument=$document[0]||{},lastCookies={},lastCookieString="";return function(){var cookieArray,cookie,i,index,name,currentCookieString=rawDocument.cookie||"";if(currentCookieString!==lastCookieString)for(lastCookieString=currentCookieString,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),isUndefined(lastCookies[name])&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}}function $$CookieReaderProvider(){this.$get=$$CookieReader}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator,anyPropertyKey){if(!isArrayLike(array)){if(null==array)return array;throw minErr("filter")("notarray","Expected array but received: {0}",array)}anyPropertyKey=anyPropertyKey||"$";var predicateFn,matchAgainstAnyProp,expressionType=getTypeForFilter(expression);switch(expressionType){case"function":predicateFn=expression;break;case"boolean":case"null":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp);break;default:return array}return Array.prototype.filter.call(array,predicateFn)}}function createPredicateFn(expression,comparator,anyPropertyKey,matchAgainstAnyProp){var predicateFn,shouldMatchPrimitives=isObject(expression)&&anyPropertyKey in expression;return comparator===!0?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return!isUndefined(actual)&&(null===actual||null===expected?actual===expected:!(isObject(expected)||isObject(actual)&&!hasCustomToString(actual))&&(actual=lowercase(""+actual),expected=lowercase(""+expected),actual.indexOf(expected)!==-1))}),predicateFn=function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression[anyPropertyKey],comparator,anyPropertyKey,!1):deepCompare(item,expression,comparator,anyPropertyKey,matchAgainstAnyProp)}}function deepCompare(actual,expected,comparator,anyPropertyKey,matchAgainstAnyProp,dontMatchWholeObject){var actualType=getTypeForFilter(actual),expectedType=getTypeForFilter(expected);if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,anyPropertyKey,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,anyPropertyKey,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if("$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,anyPropertyKey,!0))return!0;return!dontMatchWholeObject&&deepCompare(actual,expected,comparator,anyPropertyKey,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)&&!isUndefined(expectedVal)){var matchAnyProperty=key===anyPropertyKey,actualVal=matchAnyProperty?actual:actual[key];if(!deepCompare(actualVal,expectedVal,comparator,anyPropertyKey,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function getTypeForFilter(val){return null===val?"null":typeof val}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function parse(numStr){var digits,numberOfIntegerDigits,i,j,zeros,exponent=0;for((numberOfIntegerDigits=numStr.indexOf(DECIMAL_SEP))>-1&&(numStr=numStr.replace(DECIMAL_SEP,"")),(i=numStr.search(/e/i))>0?(numberOfIntegerDigits<0&&(numberOfIntegerDigits=i),numberOfIntegerDigits+=+numStr.slice(i+1),numStr=numStr.substring(0,i)):numberOfIntegerDigits<0&&(numberOfIntegerDigits=numStr.length),i=0;numStr.charAt(i)==ZERO_CHAR;i++);if(i==(zeros=numStr.length))digits=[0],numberOfIntegerDigits=1;else{for(zeros--;numStr.charAt(zeros)==ZERO_CHAR;)zeros--;for(numberOfIntegerDigits-=i,digits=[],j=0;i<=zeros;i++,j++)digits[j]=+numStr.charAt(i)}return numberOfIntegerDigits>MAX_DIGITS&&(digits=digits.splice(0,MAX_DIGITS-1),exponent=numberOfIntegerDigits-1,numberOfIntegerDigits=1),{d:digits,e:exponent,i:numberOfIntegerDigits}}function roundNumber(parsedNumber,fractionSize,minFrac,maxFrac){var digits=parsedNumber.d,fractionLen=digits.length-parsedNumber.i;fractionSize=isUndefined(fractionSize)?Math.min(Math.max(minFrac,fractionLen),maxFrac):+fractionSize;var roundAt=fractionSize+parsedNumber.i,digit=digits[roundAt];if(roundAt>0){digits.splice(Math.max(parsedNumber.i,roundAt));for(var j=roundAt;j<digits.length;j++)digits[j]=0}else{fractionLen=Math.max(0,fractionLen),parsedNumber.i=1,digits.length=Math.max(1,roundAt=fractionSize+1),digits[0]=0;for(var i=1;i<roundAt;i++)digits[i]=0}if(digit>=5)if(roundAt-1<0){for(var k=0;k>roundAt;k--)digits.unshift(0),parsedNumber.i++;digits.unshift(1),parsedNumber.i++}else digits[roundAt-1]++;for(;fractionLen<Math.max(0,fractionSize);fractionLen++)digits.push(0);var carry=digits.reduceRight(function(carry,d,i,digits){return d+=carry,digits[i]=d%10,Math.floor(d/10)},0);carry&&(digits.unshift(carry),parsedNumber.i++)}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isString(number)&&!isNumber(number)||isNaN(number))return"";var parsedNumber,isInfinity=!isFinite(number),isZero=!1,numStr=Math.abs(number)+"",formattedText="";if(isInfinity)formattedText="";else{parsedNumber=parse(numStr),roundNumber(parsedNumber,fractionSize,pattern.minFrac,pattern.maxFrac);var digits=parsedNumber.d,integerLen=parsedNumber.i,exponent=parsedNumber.e,decimals=[];for(isZero=digits.reduce(function(isZero,d){return isZero&&!d},!0);integerLen<0;)digits.unshift(0),integerLen++;integerLen>0?decimals=digits.splice(integerLen,digits.length):(decimals=digits,digits=[0]);var groups=[];for(digits.length>=pattern.lgSize&&groups.unshift(digits.splice(-pattern.lgSize,digits.length).join(""));digits.length>pattern.gSize;)groups.unshift(digits.splice(-pattern.gSize,digits.length).join(""));digits.length&&groups.unshift(digits.join("")),formattedText=groups.join(groupSep),decimals.length&&(formattedText+=decimalSep+decimals.join("")),exponent&&(formattedText+="e+"+exponent)}return number<0&&!isZero?pattern.negPre+formattedText+pattern.negSuf:pattern.posPre+formattedText+pattern.posSuf}function padNumber(num,digits,trim,negWrap){var neg="";for((num<0||negWrap&&num<=0)&&(negWrap?num=-num+1:(num=-num,neg="-")),num=""+num;num.length<digits;)num=ZERO_CHAR+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim,negWrap){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&offset==-12&&(value=12),padNumber(value,size,trim,negWrap)}}function dateStrGetter(name,shortForm,standAlone){return function(date,formats){var value=date["get"+name](),propPrefix=(standAlone?"STANDALONE":"")+(shortForm?"SHORT":""),get=uppercase(propPrefix+name);return formats[get][value]}}function timeZoneGetter(date,formats,offset){var zone=-1*offset,paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(dayOfWeekOnFirst<=4?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()))}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1]}function longEraGetter(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?toInt(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date)||!isFinite(date.getTime()))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);var dateTimezoneOffset=date.getTimezoneOffset();return timezone&&(dateTimezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset),date=convertTimezoneToLocal(date,timezone,!0)),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS,dateTimezoneOffset):"''"===value?"'":value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}function limitToFilter(){return function(input,limit,begin){return limit=Math.abs(Number(limit))===1/0?Number(limit):toInt(limit),isNaN(limit)?input:(isNumber(input)&&(input=input.toString()),isArrayLike(input)?(begin=!begin||isNaN(begin)?0:toInt(begin),begin=begin<0?Math.max(0,input.length+begin):begin,limit>=0?sliceFn(input,begin,begin+limit):0===begin?sliceFn(input,limit,input.length):sliceFn(input,Math.max(0,begin+limit),begin)):input)}}function sliceFn(input,begin,end){return isString(input)?input.slice(begin,end):slice.call(input,begin,end)}function orderByFilter($parse){function processPredicates(sortPredicates){return sortPredicates.map(function(predicate){var descending=1,get=identity;if(isFunction(predicate))get=predicate;else if(isString(predicate)&&("+"!=predicate.charAt(0)&&"-"!=predicate.charAt(0)||(descending="-"==predicate.charAt(0)?-1:1,predicate=predicate.substring(1)),""!==predicate&&(get=$parse(predicate),get.constant))){var key=get();get=function(value){return value[key]}}return{get:get,descending:descending}})}function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function objectValue(value){return isFunction(value.valueOf)&&(value=value.valueOf(),isPrimitive(value))?value:hasCustomToString(value)&&(value=value.toString(),isPrimitive(value))?value:value}function getPredicateValue(value,index){var type=typeof value;return null===value?(type="string",value="null"):"object"===type&&(value=objectValue(value)),{value:value,type:type,index:index}}function defaultCompare(v1,v2){var result=0,type1=v1.type,type2=v2.type;if(type1===type2){var value1=v1.value,value2=v2.value;"string"===type1?(value1=value1.toLowerCase(),value2=value2.toLowerCase()):"object"===type1&&(isObject(value1)&&(value1=v1.index),isObject(value2)&&(value2=v2.index)),value1!==value2&&(result=value1<value2?-1:1)}else result=type1<type2?-1:1;return result}return function(array,sortPredicate,reverseOrder,compareFn){function getComparisonObject(value,index){return{value:value,tieBreaker:{value:index,type:"number",index:index},predicateValues:predicates.map(function(predicate){return getPredicateValue(predicate.get(value),index)})}}function doComparison(v1,v2){for(var i=0,ii=predicates.length;i<ii;i++){var result=compare(v1.predicateValues[i],v2.predicateValues[i]);if(result)return result*predicates[i].descending*descending}return compare(v1.tieBreaker,v2.tieBreaker)*descending}if(null==array)return array;if(!isArrayLike(array))throw minErr("orderBy")("notarray","Expected array but received: {0}",array);isArray(sortPredicate)||(sortPredicate=[sortPredicate]),0===sortPredicate.length&&(sortPredicate=["+"]);var predicates=processPredicates(sortPredicate),descending=reverseOrder?-1:1,compare=isFunction(compareFn)?compareFn:defaultCompare,compareValues=Array.prototype.map.call(array,getComparisonObject);return compareValues.sort(doComparison),array=compareValues.map(function(item){return item.value})}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[];form.$error={},form.$$success={},form.$pending=void 0,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,form.$$parentForm=nullFormCtrl,form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control),control.$$parentForm=form},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$$success,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control),control.$$parentForm=nullFormCtrl},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,controller){var list=object[property];if(list){var index=list.indexOf(controller);index===-1&&list.push(controller)}else object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])},$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,form.$$parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,form.$$parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var timeout,listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||15<key&&key<19||37<=key&&key<=40||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),PARTIAL_VALIDATION_TYPES[type]&&ctrl.$$hasNativeValidators&&type===attr.type&&element.on(PARTIAL_VALIDATION_EVENTS,function(ev){if(!timeout){var validity=this[VALIDITY_STATE_PROPERTY],origBadInput=validity.badInput,origTypeMismatch=validity.typeMismatch;timeout=$browser.defer(function(){timeout=null,validity.badInput===origBadInput&&validity.typeMismatch===origTypeMismatch||listener(ev)})}}),ctrl.$render=function(){var value=ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue;element.val()!==value&&element.val(value)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return NaN}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'==iso.charAt(0)&&'"'==iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return NaN}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)&&!isDate(val)?parseDate(val)||void 0:val}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return timezone&&(parsedDate=convertTimezoneToLocal(parsedDate,timezone)),parsedDate}}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw ngModelMinErr("datefmt","Expected `{0}` to be a date",value);return isValidDate(value)?(previousDate=value,previousDate&&timezone&&(previousDate=convertTimezoneToLocal(previousDate,timezone,!0)),$filter("date")(value,format,timezone)):(previousDate=null,"")}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput||validity.typeMismatch?void 0:value})}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):void 0}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),minVal=isNumber(val)&&!isNaN(val)?val:void 0,ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||value<=maxVal},attr.$observe("max",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),maxVal=isNumber(val)&&!isNaN(val)?val:void 0,ctrl.$validate()})}}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw ngModelMinErr("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){var classes=[];return isArray(classVal)?(forEach(classVal,function(v){classes=classes.concat(arrayClasses(v))}),classes):isString(classVal)?classVal.split(" "):isObject(classVal)?(forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes):classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||createMap(),classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),
toRemove&&toRemove.length&&$animate.removeClass(element,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||(1&scope.$index)===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=isArray(newVal)?newVal.map(function(v){return shallowCopy(v)}):shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(value){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,controller){isUndefined(state)?createAndSet("$pending",validationErrorKey,controller):unsetAndCleanup("$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,controller),set(ctrl.$$success,validationErrorKey,controller)):(set(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)):(unset(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=void 0,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?void 0:!ctrl.$error[validationErrorKey]&&(!!ctrl.$$success[validationErrorKey]||null),toggleValidationCss(validationErrorKey,combinedState),ctrl.$$parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,controller){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,controller)}function unsetAndCleanup(name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller),isObjectEmpty(ctrl[name])&&(ctrl[name]=void 0)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}function chromeHack(optionElement){optionElement[0].hasAttribute("selected")&&(optionElement[0].selected=!0)}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",hasOwnProperty=Object.prototype.hasOwnProperty,lowercase=function(string){return isString(string)?string.toLowerCase():string},uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(ch.charCodeAt(0)&-33)}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,getPrototypeOf=Object.getPrototypeOf,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=window.document.documentMode,noop.$inject=[],identity.$inject=[];var isArray=Array.isArray,TYPED_ARRAY_REGEXP=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){function noUnsafeEval(){try{return new Function(""),!1}catch(e){return!0}}if(!isDefined(csp.rules)){var ngCspElement=window.document.querySelector("[ng-csp]")||window.document.querySelector("[data-ng-csp]");if(ngCspElement){var ngCspAttribute=ngCspElement.getAttribute("ng-csp")||ngCspElement.getAttribute("data-ng-csp");csp.rules={noUnsafeEval:!ngCspAttribute||ngCspAttribute.indexOf("no-unsafe-eval")!==-1,noInlineStyle:!ngCspAttribute||ngCspAttribute.indexOf("no-inline-style")!==-1}}else csp.rules={noUnsafeEval:noUnsafeEval(),noInlineStyle:!1}}return csp.rules},jq=function(){if(isDefined(jq.name_))return jq.name_;var el,i,prefix,name,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(prefix=ngAttrPrefixes[i],el=window.document.querySelector("["+prefix.replace(":","\\:")+"jq]")){name=el.getAttribute(prefix+"jq");break}return jq.name_=name},ALL_COLONS=/:/g,ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_ATTRIBUTE=2,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.5.8",major:1,minor:5,dot:8,codeName:"arbitrary-fallbacks"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:-]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var jqLiteContains=window.Node.prototype.contains||function(arg){return!!(16&this.compareDocumentPosition(arg))},JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===window.document.readyState?window.setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData,hasData:jqLiteHasData,cleanData:jqLiteCleanData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?void(element.style[name]=value):element.style[name]},attr:function(element,name,value){var nodeType=element.nodeType;if(nodeType!==NODE_TYPE_TEXT&&nodeType!==NODE_TYPE_ATTRIBUTE&&nodeType!==NODE_TYPE_COMMENT){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:void 0;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?void 0:ret}}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),void(element.innerHTML=value))},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&isUndefined(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)){if(isObject(arg1)){for(i=0;i<nodeCount;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=isUndefined(value)?Math.min(nodeCount,1):nodeCount,j=0;j<jj;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;i<nodeCount;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length,addHandler=function(type,specialHandlerWrapper,noEventListener){var eventFns=events[type];eventFns||(eventFns=events[type]=[],eventFns.specialHandlerWrapper=specialHandlerWrapper,"$destroy"===type||noEventListener||addEventListenerFn(element,type,handle)),eventFns.push(fn)};i--;)type=types[i],MOUSE_EVENT_MAP[type]?(addHandler(MOUSE_EVENT_MAP[type],specialMouseHandlerWrapper),addHandler(type,void 0,!0)):addHandler(type)}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;i<ii;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){jqLiteWrapNode(element,jqLite(wrapNode).eq(0).clone()[0])},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;i<ii;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;i<ii;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var $$HashMapProvider=[function(){this.$get=[function(){return HashMap}]}],ARROW_ARG=/^([^\(]+?)=>/,FN_ARGS=/^[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),ELEMENT_NODE=1,NG_ANIMATE_CLASSNAME="ng-animate",$$CoreAnimateJsProvider=function(){this.$get=noop},$$CoreAnimateQueueProvider=function(){var postDigestQueue=new HashMap,postDigestElements=[];this.$get=["$$AnimateRunner","$rootScope",function($$AnimateRunner,$rootScope){function updateData(data,classes,value){var changed=!1;return classes&&(classes=isString(classes)?classes.split(" "):isArray(classes)?classes:[],forEach(classes,function(className){className&&(changed=!0,data[className]=value)})),changed}function handleCSSClassChanges(){forEach(postDigestElements,function(element){var data=postDigestQueue.get(element);if(data){var existing=splitClasses(element.attr("class")),toAdd="",toRemove="";forEach(data,function(status,className){var hasClass=!!existing[className];status!==hasClass&&(status?toAdd+=(toAdd.length?" ":"")+className:toRemove+=(toRemove.length?" ":"")+className)}),forEach(element,function(elm){toAdd&&jqLiteAddClass(elm,toAdd),toRemove&&jqLiteRemoveClass(elm,toRemove)}),postDigestQueue.remove(element)}}),postDigestElements.length=0}function addRemoveClassesPostDigest(element,add,remove){var data=postDigestQueue.get(element)||{},classesAdded=updateData(data,add,!0),classesRemoved=updateData(data,remove,!1);(classesAdded||classesRemoved)&&(postDigestQueue.put(element,data),postDigestElements.push(element),1===postDigestElements.length&&$rootScope.$$postDigest(handleCSSClassChanges))}return{enabled:noop,on:noop,off:noop,pin:noop,push:function(element,event,options,domOperation){domOperation&&domOperation(),options=options||{},options.from&&element.css(options.from),options.to&&element.css(options.to),(options.addClass||options.removeClass)&&addRemoveClassesPostDigest(element,options.addClass,options.removeClass);var runner=new $$AnimateRunner;return runner.complete(),runner}}}]},$AnimateProvider=["$provide",function($provide){var provider=this;this.$$registeredAnimations=Object.create(null),this.register=function(name,factory){if(name&&"."!==name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);var key=name+"-animation";provider.$$registeredAnimations[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){if(1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null,this.$$classNameFilter)){var reservedRegex=new RegExp("(\\s+|\\/)"+NG_ANIMATE_CLASSNAME+"(\\s+|\\/)");if(reservedRegex.test(this.$$classNameFilter.toString()))throw $animateMinErr("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',NG_ANIMATE_CLASSNAME)}return this.$$classNameFilter},this.$get=["$$animateQueue",function($$animateQueue){function domInsert(element,parentElement,afterElement){if(afterElement){var afterNode=extractElementNode(afterElement);!afterNode||afterNode.parentNode||afterNode.previousElementSibling||(afterElement=null)}afterElement?afterElement.after(element):parentElement.prepend(element)}return{on:$$animateQueue.on,off:$$animateQueue.off,pin:$$animateQueue.pin,enabled:$$animateQueue.enabled,cancel:function(runner){runner.end&&runner.end()},enter:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"enter",prepareAnimateOptions(options))},move:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"move",prepareAnimateOptions(options))},leave:function(element,options){return $$animateQueue.push(element,"leave",prepareAnimateOptions(options),function(){element.remove()})},addClass:function(element,className,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addclass,className),$$animateQueue.push(element,"addClass",options)},removeClass:function(element,className,options){return options=prepareAnimateOptions(options),options.removeClass=mergeClasses(options.removeClass,className),$$animateQueue.push(element,"removeClass",options)},setClass:function(element,add,remove,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addClass,add),options.removeClass=mergeClasses(options.removeClass,remove),$$animateQueue.push(element,"setClass",options)},animate:function(element,from,to,className,options){return options=prepareAnimateOptions(options),options.from=options.from?extend(options.from,from):from,options.to=options.to?extend(options.to,to):to,className=className||"ng-inline-animate",options.tempClasses=mergeClasses(options.tempClasses,className),$$animateQueue.push(element,"animate",options)}}}]}],$$AnimateAsyncRunFactoryProvider=function(){this.$get=["$$rAF",function($$rAF){function waitForTick(fn){waitQueue.push(fn),waitQueue.length>1||$$rAF(function(){for(var i=0;i<waitQueue.length;i++)waitQueue[i]();waitQueue=[]})}var waitQueue=[];return function(){var passed=!1;return waitForTick(function(){passed=!0}),function(callback){passed?callback():waitForTick(callback)}}}]},$$AnimateRunnerFactoryProvider=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function($q,$sniffer,$$animateAsyncRun,$document,$timeout){function AnimateRunner(host){this.setHost(host);var rafTick=$$animateAsyncRun(),timeoutTick=function(fn){$timeout(fn,0,!1)};this._doneCallbacks=[],this._tick=function(fn){var doc=$document[0];doc&&doc.hidden?timeoutTick(fn):rafTick(fn)},this._state=0}var INITIAL_STATE=0,DONE_PENDING_STATE=1,DONE_COMPLETE_STATE=2;return AnimateRunner.chain=function(chain,callback){function next(){return index===chain.length?void callback(!0):void chain[index](function(response){return response===!1?void callback(!1):(index++,void next())})}var index=0;next()},AnimateRunner.all=function(runners,callback){function onProgress(response){status=status&&response,++count===runners.length&&callback(status)}var count=0,status=!0;forEach(runners,function(runner){runner.done(onProgress)})},AnimateRunner.prototype={setHost:function(host){this.host=host||{}},done:function(fn){this._state===DONE_COMPLETE_STATE?fn():this._doneCallbacks.push(fn)},progress:noop,getPromise:function(){if(!this.promise){var self=this;this.promise=$q(function(resolve,reject){self.done(function(status){status===!1?reject():resolve()})})}return this.promise},then:function(resolveHandler,rejectHandler){return this.getPromise().then(resolveHandler,rejectHandler)},"catch":function(handler){return this.getPromise()["catch"](handler)},"finally":function(handler){return this.getPromise()["finally"](handler)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(response){var self=this;self._state===INITIAL_STATE&&(self._state=DONE_PENDING_STATE,self._tick(function(){self._resolve(response)}))},_resolve:function(response){this._state!==DONE_COMPLETE_STATE&&(forEach(this._doneCallbacks,function(fn){fn(response)}),this._doneCallbacks.length=0,this._state=DONE_COMPLETE_STATE)}},AnimateRunner}]},$CoreAnimateCssProvider=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function($$rAF,$q,$$AnimateRunner){return function(element,initialOptions){function run(){return $$rAF(function(){applyAnimationContents(),closed||runner.complete(),closed=!0}),runner}function applyAnimationContents(){options.addClass&&(element.addClass(options.addClass),options.addClass=null),options.removeClass&&(element.removeClass(options.removeClass),options.removeClass=null),options.to&&(element.css(options.to),options.to=null)}var options=initialOptions||{};options.$$prepared||(options=copy(options)),options.cleanupStyles&&(options.from=options.to=null),options.from&&(element.css(options.from),options.from=null);var closed,runner=new $$AnimateRunner;return{start:run,end:run}}}]},$compileMinErr=minErr("$compile"),_UNINITIALIZED_VALUE=new UNINITIALIZED_VALUE;$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"],SimpleChange.prototype.isFirstChange=function(){return this.previousValue===_UNINITIALIZED_VALUE};var PREFIX_REGEXP=/^((?:x|data)[\:\-_])/i,$controllerMinErr=minErr("$controller"),CNTRL_REG=/^(\S+)(\s+as\s+([\w$]+))?$/,$$ForceReflowProvider=function(){this.$get=["$document",function($document){return function(domNode){return domNode?!domNode.nodeType&&domNode instanceof jqLite&&(domNode=domNode[0]):domNode=$document[0].body,domNode.offsetWidth+1}}]},APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$httpMinErr=minErr("$http"),$httpMinErrLegacyFn=function(method){return function(){throw $httpMinErr("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",method)}},$interpolateMinErr=angular.$interpolateMinErr=minErr("$interpolate");$interpolateMinErr.throwNoconcat=function(text){throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text)},$interpolateMinErr.interr=function(text,err){return $interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString())};var $jsonpCallbacksProvider=function(){this.$get=["$window",function($window){function createCallback(callbackId){var callback=function(data){callback.data=data,callback.called=!0};return callback.id=callbackId,callback}var callbacks=$window.angular.callbacks,callbackMap={};return{createCallback:function(url){var callbackId="_"+(callbacks.$$counter++).toString(36),callbackPath="angular.callbacks."+callbackId,callback=createCallback(callbackId);return callbackMap[callbackPath]=callbacks[callbackId]=callback,callbackPath},wasCalled:function(callbackPath){return callbackMap[callbackPath].called},getResponse:function(callbackPath){return callbackMap[callbackPath].data},removeCallback:function(callbackPath){var callback=callbackMap[callbackPath];delete callbacks[callback.id],delete callbackMap[callbackPath]}}}]},PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS=createMap();forEach("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(operator){OPERATORS[operator]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"\t",v:"\x0B","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return chars.indexOf(ch)!==-1},peek:function(i){var num=i||1;return this.index+num<this.text.length&&this.text.charAt(this.index+num)},isNumber:function(ch){return"0"<=ch&&ch<="9"&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"\t"===ch||"\n"===ch||"\x0B"===ch||""===ch},isIdentifierStart:function(ch){return this.options.isIdentifierStart?this.options.isIdentifierStart(ch,this.codePointAt(ch)):this.isValidIdentifierStart(ch)},isValidIdentifierStart:function(ch){return"a"<=ch&&ch<="z"||"A"<=ch&&ch<="Z"||"_"===ch||"$"===ch},isIdentifierContinue:function(ch){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(ch,this.codePointAt(ch)):this.isValidIdentifierContinue(ch)},isValidIdentifierContinue:function(ch,cp){return this.isValidIdentifierStart(ch,cp)||this.isNumber(ch)},codePointAt:function(ch){return 1===ch.length?ch.charCodeAt(0):(ch.charCodeAt(0)<<10)+ch.charCodeAt(1)-56613888},peekMultichar:function(){var ch=this.text.charAt(this.index),peek=this.peek();if(!peek)return ch;var cp1=ch.charCodeAt(0),cp2=peek.charCodeAt(0);return cp1>=55296&&cp1<=56319&&cp2>=56320&&cp2<=57343?ch+peek:ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){var start=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var ch=this.peekMultichar();if(!this.isIdentifierContinue(ch))break;this.index+=ch.length}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var AST=function(lexer,options){this.lexer=lexer,this.options=options};AST.Program="Program",AST.ExpressionStatement="ExpressionStatement",AST.AssignmentExpression="AssignmentExpression",AST.ConditionalExpression="ConditionalExpression",
AST.LogicalExpression="LogicalExpression",AST.BinaryExpression="BinaryExpression",AST.UnaryExpression="UnaryExpression",AST.CallExpression="CallExpression",AST.MemberExpression="MemberExpression",AST.Identifier="Identifier",AST.Literal="Literal",AST.ArrayExpression="ArrayExpression",AST.Property="Property",AST.ObjectExpression="ObjectExpression",AST.ThisExpression="ThisExpression",AST.LocalsExpression="LocalsExpression",AST.NGValueParameter="NGValueParameter",AST.prototype={ast:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value},program:function(){for(var body=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&body.push(this.expressionStatement()),!this.expect(";"))return{type:AST.Program,body:body}},expressionStatement:function(){return{type:AST.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},expression:function(){return this.assignment()},assignment:function(){var result=this.ternary();return this.expect("=")&&(result={type:AST.AssignmentExpression,left:result,right:this.assignment(),operator:"="}),result},ternary:function(){var alternate,consequent,test=this.logicalOR();return this.expect("?")&&(alternate=this.expression(),this.consume(":"))?(consequent=this.expression(),{type:AST.ConditionalExpression,test:test,alternate:alternate,consequent:consequent}):test},logicalOR:function(){for(var left=this.logicalAND();this.expect("||");)left={type:AST.LogicalExpression,operator:"||",left:left,right:this.logicalAND()};return left},logicalAND:function(){for(var left=this.equality();this.expect("&&");)left={type:AST.LogicalExpression,operator:"&&",left:left,right:this.equality()};return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.relational()};return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.additive()};return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.multiplicative()};return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.unary()};return left},unary:function(){var token;return(token=this.expect("+","-","!"))?{type:AST.UnaryExpression,operator:token.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?primary=copy(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?primary={type:AST.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next;next=this.expect("(","[",".");)"("===next.text?(primary={type:AST.CallExpression,callee:primary,arguments:this.parseArguments()},this.consume(")")):"["===next.text?(primary={type:AST.MemberExpression,object:primary,property:this.expression(),computed:!0},this.consume("]")):"."===next.text?primary={type:AST.MemberExpression,object:primary,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return primary},filter:function(baseExpression){for(var args=[baseExpression],result={type:AST.CallExpression,callee:this.identifier(),arguments:args,filter:!0};this.expect(":");)args.push(this.expression());return result},parseArguments:function(){var args=[];if(")"!==this.peekToken().text)do args.push(this.filterChain());while(this.expect(","));return args},identifier:function(){var token=this.consume();return token.identifier||this.throwError("is not a valid identifier",token),{type:AST.Identifier,name:token.text}},constant:function(){return{type:AST.Literal,value:this.consume().value}},arrayDeclaration:function(){var elements=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elements.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:AST.ArrayExpression,elements:elements}},object:function(){var property,properties=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;property={type:AST.Property,kind:"init"},this.peek().constant?(property.key=this.constant(),property.computed=!1,this.consume(":"),property.value=this.expression()):this.peek().identifier?(property.key=this.identifier(),property.computed=!1,this.peek(":")?(this.consume(":"),property.value=this.expression()):property.value=property.key):this.peek("[")?(this.consume("["),property.key=this.expression(),this.consume("]"),property.computed=!0,this.consume(":"),property.value=this.expression()):this.throwError("invalid key",this.peek()),properties.push(property)}while(this.expect(","));return this.consume("}"),{type:AST.ObjectExpression,properties:properties}},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return!!token&&(this.tokens.shift(),token)},selfReferential:{"this":{type:AST.ThisExpression},$locals:{type:AST.LocalsExpression}}},ASTCompiler.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.state={nextId:0,filters:{},expensiveChecks:expensiveChecks,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},findConstantAndWatchExpressions(ast,self.$filter);var assignable,extra="";if(this.stage="assign",assignable=assignableAST(ast)){this.state.computing="assign";var result=this.nextId();this.recurse(assignable,result),this.return_(result),extra="fn.assign="+this.generateFunction("assign","s,v,l")}var toWatch=getInputs(ast.body);self.stage="inputs",forEach(toWatch,function(watch,key){var fnKey="fn"+key;self.state[fnKey]={vars:[],body:[],own:{}},self.state.computing=fnKey;var intoId=self.nextId();self.recurse(watch,intoId),self.return_(intoId),self.state.inputs.push(fnKey),watch.watchId=key}),this.state.computing="fn",this.stage="main",this.recurse(ast);var fnString='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+extra+this.watchFns()+"return fn;",fn=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",fnString)(this.$filter,ensureSafeMemberName,ensureSafeObject,ensureSafeFunction,getStringValue,ensureSafeAssignContext,ifDefined,plusFn,expression);return this.state=this.stage=void 0,fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},USE:"use",STRICT:"strict",watchFns:function(){var result=[],fns=this.state.inputs,self=this;return forEach(fns,function(name){result.push("var "+name+"="+self.generateFunction(name,"s"))}),fns.length&&result.push("fn.inputs=["+fns.join(",")+"];"),result.join("")},generateFunction:function(name,params){return"function("+params+"){"+this.varsPrefix(name)+this.body(name)+"};"},filterPrefix:function(){var parts=[],self=this;return forEach(this.state.filters,function(id,filter){parts.push(id+"=$filter("+self.escape(filter)+")")}),parts.length?"var "+parts.join(",")+";":""},varsPrefix:function(section){return this.state[section].vars.length?"var "+this.state[section].vars.join(",")+";":""},body:function(section){return this.state[section].body.join("")},recurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var left,right,args,expression,computed,self=this;if(recursionFn=recursionFn||noop,!skipWatchIdCheck&&isDefined(ast.watchId))return intoId=intoId||this.nextId(),void this.if_("i",this.lazyAssign(intoId,this.computedMember("i",ast.watchId)),this.lazyRecurse(ast,intoId,nameId,recursionFn,create,!0));switch(ast.type){case AST.Program:forEach(ast.body,function(expression,pos){self.recurse(expression.expression,void 0,void 0,function(expr){right=expr}),pos!==ast.body.length-1?self.current().body.push(right,";"):self.return_(right)});break;case AST.Literal:expression=this.escape(ast.value),this.assign(intoId,expression),recursionFn(expression);break;case AST.UnaryExpression:this.recurse(ast.argument,void 0,void 0,function(expr){right=expr}),expression=ast.operator+"("+this.ifDefined(right,0)+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.BinaryExpression:this.recurse(ast.left,void 0,void 0,function(expr){left=expr}),this.recurse(ast.right,void 0,void 0,function(expr){right=expr}),expression="+"===ast.operator?this.plus(left,right):"-"===ast.operator?this.ifDefined(left,0)+ast.operator+this.ifDefined(right,0):"("+left+")"+ast.operator+"("+right+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.LogicalExpression:intoId=intoId||this.nextId(),self.recurse(ast.left,intoId),self.if_("&&"===ast.operator?intoId:self.not(intoId),self.lazyRecurse(ast.right,intoId)),recursionFn(intoId);break;case AST.ConditionalExpression:intoId=intoId||this.nextId(),self.recurse(ast.test,intoId),self.if_(intoId,self.lazyRecurse(ast.alternate,intoId),self.lazyRecurse(ast.consequent,intoId)),recursionFn(intoId);break;case AST.Identifier:intoId=intoId||this.nextId(),nameId&&(nameId.context="inputs"===self.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",ast.name)+"?l:s"),nameId.computed=!1,nameId.name=ast.name),ensureSafeMemberName(ast.name),self.if_("inputs"===self.stage||self.not(self.getHasOwnProperty("l",ast.name)),function(){self.if_("inputs"===self.stage||"s",function(){create&&1!==create&&self.if_(self.not(self.nonComputedMember("s",ast.name)),self.lazyAssign(self.nonComputedMember("s",ast.name),"{}")),self.assign(intoId,self.nonComputedMember("s",ast.name))})},intoId&&self.lazyAssign(intoId,self.nonComputedMember("l",ast.name))),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.name))&&self.addEnsureSafeObject(intoId),recursionFn(intoId);break;case AST.MemberExpression:left=nameId&&(nameId.context=this.nextId())||this.nextId(),intoId=intoId||this.nextId(),self.recurse(ast.object,left,void 0,function(){self.if_(self.notNull(left),function(){create&&1!==create&&self.addEnsureSafeAssignContext(left),ast.computed?(right=self.nextId(),self.recurse(ast.property,right),self.getStringValue(right),self.addEnsureSafeMemberName(right),create&&1!==create&&self.if_(self.not(self.computedMember(left,right)),self.lazyAssign(self.computedMember(left,right),"{}")),expression=self.ensureSafeObject(self.computedMember(left,right)),self.assign(intoId,expression),nameId&&(nameId.computed=!0,nameId.name=right)):(ensureSafeMemberName(ast.property.name),create&&1!==create&&self.if_(self.not(self.nonComputedMember(left,ast.property.name)),self.lazyAssign(self.nonComputedMember(left,ast.property.name),"{}")),expression=self.nonComputedMember(left,ast.property.name),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.property.name))&&(expression=self.ensureSafeObject(expression)),self.assign(intoId,expression),nameId&&(nameId.computed=!1,nameId.name=ast.property.name))},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)},!!create);break;case AST.CallExpression:intoId=intoId||this.nextId(),ast.filter?(right=self.filter(ast.callee.name),args=[],forEach(ast.arguments,function(expr){var argument=self.nextId();self.recurse(expr,argument),args.push(argument)}),expression=right+"("+args.join(",")+")",self.assign(intoId,expression),recursionFn(intoId)):(right=self.nextId(),left={},args=[],self.recurse(ast.callee,right,left,function(){self.if_(self.notNull(right),function(){self.addEnsureSafeFunction(right),forEach(ast.arguments,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(self.ensureSafeObject(argument))})}),left.name?(self.state.expensiveChecks||self.addEnsureSafeObject(left.context),expression=self.member(left.context,left.name,left.computed)+"("+args.join(",")+")"):expression=right+"("+args.join(",")+")",expression=self.ensureSafeObject(expression),self.assign(intoId,expression)},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)}));break;case AST.AssignmentExpression:if(right=this.nextId(),left={},!isAssignable(ast.left))throw $parseMinErr("lval","Trying to assign a value to a non l-value");this.recurse(ast.left,void 0,left,function(){self.if_(self.notNull(left.context),function(){self.recurse(ast.right,right),self.addEnsureSafeObject(self.member(left.context,left.name,left.computed)),self.addEnsureSafeAssignContext(left.context),expression=self.member(left.context,left.name,left.computed)+ast.operator+right,self.assign(intoId,expression),recursionFn(intoId||expression)})},1);break;case AST.ArrayExpression:args=[],forEach(ast.elements,function(expr){self.recurse(expr,self.nextId(),void 0,function(argument){args.push(argument)})}),expression="["+args.join(",")+"]",this.assign(intoId,expression),recursionFn(expression);break;case AST.ObjectExpression:args=[],computed=!1,forEach(ast.properties,function(property){property.computed&&(computed=!0)}),computed?(intoId=intoId||this.nextId(),this.assign(intoId,"{}"),forEach(ast.properties,function(property){property.computed?(left=self.nextId(),self.recurse(property.key,left)):left=property.key.type===AST.Identifier?property.key.name:""+property.key.value,right=self.nextId(),self.recurse(property.value,right),self.assign(self.member(intoId,left,property.computed),right)})):(forEach(ast.properties,function(property){self.recurse(property.value,ast.constant?void 0:self.nextId(),void 0,function(expr){args.push(self.escape(property.key.type===AST.Identifier?property.key.name:""+property.key.value)+":"+expr)})}),expression="{"+args.join(",")+"}",this.assign(intoId,expression)),recursionFn(intoId||expression);break;case AST.ThisExpression:this.assign(intoId,"s"),recursionFn("s");break;case AST.LocalsExpression:this.assign(intoId,"l"),recursionFn("l");break;case AST.NGValueParameter:this.assign(intoId,"v"),recursionFn("v")}},getHasOwnProperty:function(element,property){var key=element+"."+property,own=this.current().own;return own.hasOwnProperty(key)||(own[key]=this.nextId(!1,element+"&&("+this.escape(property)+" in "+element+")")),own[key]},assign:function(id,value){if(id)return this.current().body.push(id,"=",value,";"),id},filter:function(filterName){return this.state.filters.hasOwnProperty(filterName)||(this.state.filters[filterName]=this.nextId(!0)),this.state.filters[filterName]},ifDefined:function(id,defaultValue){return"ifDefined("+id+","+this.escape(defaultValue)+")"},plus:function(left,right){return"plus("+left+","+right+")"},return_:function(id){this.current().body.push("return ",id,";")},if_:function(test,alternate,consequent){if(test===!0)alternate();else{var body=this.current().body;body.push("if(",test,"){"),alternate(),body.push("}"),consequent&&(body.push("else{"),consequent(),body.push("}"))}},not:function(expression){return"!("+expression+")"},notNull:function(expression){return expression+"!=null"},nonComputedMember:function(left,right){var SAFE_IDENTIFIER=/[$_a-zA-Z][$_a-zA-Z0-9]*/,UNSAFE_CHARACTERS=/[^$_a-zA-Z0-9]/g;return SAFE_IDENTIFIER.test(right)?left+"."+right:left+'["'+right.replace(UNSAFE_CHARACTERS,this.stringEscapeFn)+'"]'},computedMember:function(left,right){return left+"["+right+"]"},member:function(left,right,computed){return computed?this.computedMember(left,right):this.nonComputedMember(left,right)},addEnsureSafeObject:function(item){this.current().body.push(this.ensureSafeObject(item),";")},addEnsureSafeMemberName:function(item){this.current().body.push(this.ensureSafeMemberName(item),";")},addEnsureSafeFunction:function(item){this.current().body.push(this.ensureSafeFunction(item),";")},addEnsureSafeAssignContext:function(item){this.current().body.push(this.ensureSafeAssignContext(item),";")},ensureSafeObject:function(item){return"ensureSafeObject("+item+",text)"},ensureSafeMemberName:function(item){return"ensureSafeMemberName("+item+",text)"},ensureSafeFunction:function(item){return"ensureSafeFunction("+item+",text)"},getStringValue:function(item){this.assign(item,"getStringValue("+item+")")},ensureSafeAssignContext:function(item){return"ensureSafeAssignContext("+item+",text)"},lazyRecurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var self=this;return function(){self.recurse(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck)}},lazyAssign:function(id,value){var self=this;return function(){self.assign(id,value)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)},escape:function(value){if(isString(value))return"'"+value.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(isNumber(value))return value.toString();if(value===!0)return"true";if(value===!1)return"false";if(null===value)return"null";if("undefined"==typeof value)return"undefined";throw $parseMinErr("esc","IMPOSSIBLE")},nextId:function(skip,init){var id="v"+this.state.nextId++;return skip||this.current().vars.push(id+(init?"="+init:"")),id},current:function(){return this.state[this.state.computing]}},ASTInterpreter.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.expression=expression,this.expensiveChecks=expensiveChecks,findConstantAndWatchExpressions(ast,self.$filter);var assignable,assign;(assignable=assignableAST(ast))&&(assign=this.recurse(assignable));var inputs,toWatch=getInputs(ast.body);toWatch&&(inputs=[],forEach(toWatch,function(watch,key){var input=self.recurse(watch);watch.input=input,inputs.push(input),watch.watchId=key}));var expressions=[];forEach(ast.body,function(expression){expressions.push(self.recurse(expression.expression))});var fn=0===ast.body.length?noop:1===ast.body.length?expressions[0]:function(scope,locals){var lastValue;return forEach(expressions,function(exp){lastValue=exp(scope,locals)}),lastValue};return assign&&(fn.assign=function(scope,value,locals){return assign(scope,locals,value)}),inputs&&(fn.inputs=inputs),fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},recurse:function(ast,context,create){var left,right,args,self=this;if(ast.input)return this.inputs(ast.input,ast.watchId);switch(ast.type){case AST.Literal:return this.value(ast.value,context);case AST.UnaryExpression:return right=this.recurse(ast.argument),this["unary"+ast.operator](right,context);case AST.BinaryExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.LogicalExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.ConditionalExpression:return this["ternary?:"](this.recurse(ast.test),this.recurse(ast.alternate),this.recurse(ast.consequent),context);case AST.Identifier:return ensureSafeMemberName(ast.name,self.expression),self.identifier(ast.name,self.expensiveChecks||isPossiblyDangerousMemberName(ast.name),context,create,self.expression);case AST.MemberExpression:return left=this.recurse(ast.object,!1,!!create),ast.computed||(ensureSafeMemberName(ast.property.name,self.expression),right=ast.property.name),ast.computed&&(right=this.recurse(ast.property)),ast.computed?this.computedMember(left,right,context,create,self.expression):this.nonComputedMember(left,right,self.expensiveChecks,context,create,self.expression);case AST.CallExpression:return args=[],forEach(ast.arguments,function(expr){args.push(self.recurse(expr))}),ast.filter&&(right=this.$filter(ast.callee.name)),ast.filter||(right=this.recurse(ast.callee,!0)),ast.filter?function(scope,locals,assign,inputs){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));var value=right.apply(void 0,values,inputs);return context?{context:void 0,name:void 0,value:value}:value}:function(scope,locals,assign,inputs){var value,rhs=right(scope,locals,assign,inputs);if(null!=rhs.value){ensureSafeObject(rhs.context,self.expression),ensureSafeFunction(rhs.value,self.expression);for(var values=[],i=0;i<args.length;++i)values.push(ensureSafeObject(args[i](scope,locals,assign,inputs),self.expression));value=ensureSafeObject(rhs.value.apply(rhs.context,values),self.expression)}return context?{value:value}:value};case AST.AssignmentExpression:return left=this.recurse(ast.left,!0,1),right=this.recurse(ast.right),function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs);return ensureSafeObject(lhs.value,self.expression),ensureSafeAssignContext(lhs.context),lhs.context[lhs.name]=rhs,context?{value:rhs}:rhs};case AST.ArrayExpression:return args=[],forEach(ast.elements,function(expr){args.push(self.recurse(expr))}),function(scope,locals,assign,inputs){for(var value=[],i=0;i<args.length;++i)value.push(args[i](scope,locals,assign,inputs));return context?{value:value}:value};case AST.ObjectExpression:return args=[],forEach(ast.properties,function(property){property.computed?args.push({key:self.recurse(property.key),computed:!0,value:self.recurse(property.value)}):args.push({key:property.key.type===AST.Identifier?property.key.name:""+property.key.value,computed:!1,value:self.recurse(property.value)})}),function(scope,locals,assign,inputs){for(var value={},i=0;i<args.length;++i)args[i].computed?value[args[i].key(scope,locals,assign,inputs)]=args[i].value(scope,locals,assign,inputs):value[args[i].key]=args[i].value(scope,locals,assign,inputs);return context?{value:value}:value};case AST.ThisExpression:return function(scope){return context?{value:scope}:scope};case AST.LocalsExpression:return function(scope,locals){return context?{value:locals}:locals};case AST.NGValueParameter:return function(scope,locals,assign){return context?{value:assign}:assign}}},"unary+":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?+arg:0,context?{value:arg}:arg}},"unary-":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?-arg:0,context?{value:arg}:arg}},"unary!":function(argument,context){return function(scope,locals,assign,inputs){var arg=!argument(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary+":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=plusFn(lhs,rhs);return context?{value:arg}:arg}},"binary-":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=(isDefined(lhs)?lhs:0)-(isDefined(rhs)?rhs:0);return context?{value:arg}:arg}},"binary*":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)*right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary/":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)/right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary%":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)%right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary===":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)===right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary&&":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)&&right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary||":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)||right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"ternary?:":function(test,alternate,consequent,context){return function(scope,locals,assign,inputs){var arg=test(scope,locals,assign,inputs)?alternate(scope,locals,assign,inputs):consequent(scope,locals,assign,inputs);return context?{value:arg}:arg}},value:function(value,context){return function(){return context?{context:void 0,name:void 0,value:value}:value}},identifier:function(name,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var base=locals&&name in locals?locals:scope;create&&1!==create&&base&&!base[name]&&(base[name]={});var value=base?base[name]:void 0;return expensiveChecks&&ensureSafeObject(value,expression),context?{context:base,name:name,value:value}:value}},computedMember:function(left,right,context,create,expression){return function(scope,locals,assign,inputs){var rhs,value,lhs=left(scope,locals,assign,inputs);return null!=lhs&&(rhs=right(scope,locals,assign,inputs),rhs=getStringValue(rhs),ensureSafeMemberName(rhs,expression),create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[rhs]&&(lhs[rhs]={})),value=lhs[rhs],ensureSafeObject(value,expression)),context?{context:lhs,name:rhs,value:value}:value}},nonComputedMember:function(left,right,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs);create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[right]&&(lhs[right]={}));var value=null!=lhs?lhs[right]:void 0;return(expensiveChecks||isPossiblyDangerousMemberName(right))&&ensureSafeObject(value,expression),context?{context:lhs,name:right,value:value}:value}},inputs:function(input,watchId){return function(scope,value,locals,inputs){return inputs?inputs[watchId]:input(scope,value,locals)}}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options,this.ast=new AST(lexer,options),this.astCompiler=options.csp?new ASTInterpreter(this.ast,$filter):new ASTCompiler(this.ast,$filter)};Parser.prototype={constructor:Parser,parse:function(text){return this.astCompiler.compile(text,this.options.expensiveChecks)}};var objectValueOf=Object.prototype.valueOf,$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$templateRequestMinErr=minErr("$compile"),urlParsingNode=window.document.createElement("a"),originUrl=urlResolve(window.location.href);$$CookieReader.$inject=["$document"],$FilterProvider.$inject=["$provide"];var MAX_DIGITS=22,DECIMAL_SEP=".",ZERO_CHAR="0";currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DATE_FORMATS={yyyy:dateGetter("FullYear",4,0,!1,!0),yy:dateGetter("FullYear",2,0,!0,!0),y:dateGetter("FullYear",1,0,!1,!0),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),LLLL:dateStrGetter("Month",!1,!0),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:longEraGetter},DATE_FORMATS_SPLIT=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){if(!attr.href&&!attr.xlinkHref)return function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){function defaultLinkFn(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName),linkFn=defaultLinkFn;"checked"===propName&&(linkFn=function(scope,element,attr){attr.ngModel!==attr[normalized]&&defaultLinkFn(scope,element,attr)}),ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:linkFn}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"==attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,
$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout","$parse",function($timeout,$parse){function getSetter(expression){return""===expression?$parse('this[""]').assign:$parse(expression).assign||noop}var formDirective={name:"form",restrict:isNgForm?"EAC":"E",require:["form","^^?form"],controller:FormController,compile:function(formElement,attr){formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS);var nameAttr=attr.name?"name":!(!isNgForm||!attr.ngForm)&&"ngForm";return{pre:function(scope,formElement,attr,ctrls){var controller=ctrls[0];if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=ctrls[1]||controller.$$parentForm;parentFormCtrl.$addControl(controller);var setter=nameAttr?getSetter(controller.$name):noop;nameAttr&&(setter(scope,controller),attr.$observe(nameAttr,function(newValue){controller.$name!==newValue&&(setter(scope,void 0),controller.$$parentForm.$$renameControl(controller,newValue),(setter=getSetter(controller.$name))(scope,controller))})),formElement.on("$destroy",function(){controller.$$parentForm.$removeControl(controller),setter(scope,void 0),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,URL_REGEXP=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:\/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,DATE_REGEXP=/^(\d{4,})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4,})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4,})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,PARTIAL_VALIDATION_EVENTS="keydown wheel mousedown",PARTIAL_VALIDATION_TYPES=createMap();forEach("date,datetime-local,month,time,week".split(","),function(type){PARTIAL_VALIDATION_TYPES[type]=!0});var inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(val){return $sce.valueOf(val)});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){var value=ngBindHtmlGetter(scope);element.html($sce.getTrustedHtml(value)||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",void 0),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate","$compile",function($animate,$compile){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=$compile.$$createComment("end ngIf",$attr.ngIf),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate",function($templateRequest,$anchorScroll,$animate){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch(srcExp,function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(!scope.$$destroyed&&thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){scope.$$destroyed||thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return toString.call($element[0]).match(/SVG/)?($element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,window.document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element})):($element.html(ctrl.template),void $compile($element.contents())(scope))}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){if(isArray(value))return value.join(ngList)}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",EMPTY_CLASS="ng-empty",NOT_EMPTY_CLASS="ng-not-empty",ngModelMinErr=minErr("ngModel"),NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=$interpolate($attr.name||"",!1)($scope),this.$$parentForm=nullFormCtrl;var parserValid,parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope,newValue){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:newValue}):parsedNgModelAssign($scope,newValue)}}else if(!parsedNgModel.assign)throw ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value},this.$$updateEmptyClasses=function(value){ctrl.$isEmpty(value)?($animate.removeClass($element,NOT_EMPTY_CLASS),$animate.addClass($element,EMPTY_CLASS)):($animate.removeClass($element,EMPTY_CLASS),$animate.addClass($element,NOT_EMPTY_CLASS))};var currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),ctrl.$$parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumber(ctrl.$modelValue)||!isNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:void 0,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(modelValue,viewValue,doneCallback){function processParseErrors(){var errorKey=ctrl.$$parserName||"parse";return isUndefined(parserValid)?(setValidity(errorKey,null),!0):(parserValid||(forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)})),setValidity(errorKey,parserValid),parserValid)}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),!!syncValidatorsValid||(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw ngModelMinErr("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,void 0),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors()&&processSyncValidators()?void processAsyncValidators():void validationDone(!1)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue;if(parserValid=!isUndefined(modelValue)||void 0)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumber(ctrl.$modelValue)&&isNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(modelValue,ctrl.$$lastCommittedViewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:void 0,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,ctrl.$options&&!ctrl.$options.updateOnDefault||ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce["default"])&&(debounceDelay=debounce["default"])),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue&&(ctrl.$modelValue===ctrl.$modelValue||modelValue===modelValue)){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue,parserValid=void 0;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$$updateEmptyClasses(viewValue),ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(modelValue,viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||modelCtrl.$$parentForm;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&modelCtrl.$$parentForm.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){modelCtrl.$$parentForm.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;this.$options=copy($scope.$eval($attrs.ngModelOptions)),isDefined(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngOptionsMinErr=minErr("ngOptions"),NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ngOptionsDirective=["$compile","$document","$parse",function($compile,$document,$parse){function parseOptionsExpression(optionsExp,selectElement,scope){function Option(selectValue,viewValue,label,group,disabled){this.selectValue=selectValue,this.viewValue=viewValue,this.label=label,this.group=group,this.disabled=disabled}function getOptionValuesKeys(optionValues){var optionValuesKeys;if(!keyName&&isArrayLike(optionValues))optionValuesKeys=optionValues;else{optionValuesKeys=[];for(var itemKey in optionValues)optionValues.hasOwnProperty(itemKey)&&"$"!==itemKey.charAt(0)&&optionValuesKeys.push(itemKey)}return optionValuesKeys}var match=optionsExp.match(NG_OPTIONS_REGEXP);if(!match)throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var valueName=match[5]||match[7],keyName=match[6],selectAs=/ as /.test(match[0])&&match[1],trackBy=match[9],valueFn=$parse(match[2]?match[1]:valueName),selectAsFn=selectAs&&$parse(selectAs),viewValueFn=selectAsFn||valueFn,trackByFn=trackBy&&$parse(trackBy),getTrackByValueFn=trackBy?function(value,locals){return trackByFn(scope,locals)}:function(value){return hashKey(value)},getTrackByValue=function(value,key){return getTrackByValueFn(value,getLocals(value,key))},displayFn=$parse(match[2]||match[1]),groupByFn=$parse(match[3]||""),disableWhenFn=$parse(match[4]||""),valuesFn=$parse(match[8]),locals={},getLocals=keyName?function(value,key){return locals[keyName]=key,locals[valueName]=value,locals}:function(value){return locals[valueName]=value,locals};return{trackBy:trackBy,getTrackByValue:getTrackByValue,getWatchables:$parse(valuesFn,function(optionValues){var watchedArray=[];optionValues=optionValues||[];for(var optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),selectValue=getTrackByValueFn(value,locals);if(watchedArray.push(selectValue),match[2]||match[1]){var label=displayFn(scope,locals);watchedArray.push(label)}if(match[4]){var disableWhen=disableWhenFn(scope,locals);watchedArray.push(disableWhen)}}return watchedArray}),getOptions:function(){for(var optionItems=[],selectValueMap={},optionValues=valuesFn(scope)||[],optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),viewValue=viewValueFn(scope,locals),selectValue=getTrackByValueFn(viewValue,locals),label=displayFn(scope,locals),group=groupByFn(scope,locals),disabled=disableWhenFn(scope,locals),optionItem=new Option(selectValue,viewValue,label,group,disabled);optionItems.push(optionItem),selectValueMap[selectValue]=optionItem}return{items:optionItems,selectValueMap:selectValueMap,getOptionFromViewValue:function(value){return selectValueMap[getTrackByValue(value)]},getViewValueFromOption:function(option){return trackBy?angular.copy(option.viewValue):option.viewValue}}}}}function ngOptionsPostLink(scope,selectElement,attr,ctrls){function addOptionElement(option,parent){var optionElement=optionTemplate.cloneNode(!1);parent.appendChild(optionElement),updateOptionElement(option,optionElement)}function updateOptionElement(option,element){option.element=element,element.disabled=option.disabled,option.label!==element.label&&(element.label=option.label,element.textContent=option.label),option.value!==element.value&&(element.value=option.selectValue)}function updateOptions(){var previousValue=options&&selectCtrl.readValue();if(options)for(var i=options.items.length-1;i>=0;i--){var option=options.items[i];jqLiteRemove(isDefined(option.group)?option.element.parentNode:option.element)}options=ngOptions.getOptions();var groupElementMap={};if(providedEmptyOption&&selectElement.prepend(emptyOption),options.items.forEach(function(option){var groupElement;isDefined(option.group)?(groupElement=groupElementMap[option.group],groupElement||(groupElement=optGroupTemplate.cloneNode(!1),listFragment.appendChild(groupElement),groupElement.label=null===option.group?"null":option.group,groupElementMap[option.group]=groupElement),addOptionElement(option,groupElement)):addOptionElement(option,listFragment)}),selectElement[0].appendChild(listFragment),ngModelCtrl.$render(),!ngModelCtrl.$isEmpty(previousValue)){var nextValue=selectCtrl.readValue(),isNotPrimitive=ngOptions.trackBy||multiple;(isNotPrimitive?equals(previousValue,nextValue):previousValue===nextValue)||(ngModelCtrl.$setViewValue(nextValue),ngModelCtrl.$render())}}for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,i=0,children=selectElement.children(),ii=children.length;i<ii;i++)if(""===children[i].value){emptyOption=children.eq(i);break}var providedEmptyOption=!!emptyOption,unknownOption=jqLite(optionTemplate.cloneNode(!1));unknownOption.val("?");var options,ngOptions=parseOptionsExpression(attr.ngOptions,selectElement,scope),listFragment=$document[0].createDocumentFragment(),renderEmptyOption=function(){providedEmptyOption||selectElement.prepend(emptyOption),selectElement.val(""),emptyOption.prop("selected",!0),emptyOption.attr("selected",!0)},removeEmptyOption=function(){providedEmptyOption||emptyOption.remove()},renderUnknownOption=function(){selectElement.prepend(unknownOption),selectElement.val("?"),unknownOption.prop("selected",!0),unknownOption.attr("selected",!0)},removeUnknownOption=function(){unknownOption.remove()};multiple?(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length},selectCtrl.writeValue=function(value){options.items.forEach(function(option){option.element.selected=!1}),value&&value.forEach(function(item){var option=options.getOptionFromViewValue(item);option&&(option.element.selected=!0)})},selectCtrl.readValue=function(){var selectedValues=selectElement.val()||[],selections=[];return forEach(selectedValues,function(value){var option=options.selectValueMap[value];option&&!option.disabled&&selections.push(options.getViewValueFromOption(option))}),selections},ngOptions.trackBy&&scope.$watchCollection(function(){if(isArray(ngModelCtrl.$viewValue))return ngModelCtrl.$viewValue.map(function(value){return ngOptions.getTrackByValue(value)})},function(){ngModelCtrl.$render()})):(selectCtrl.writeValue=function(value){var option=options.getOptionFromViewValue(value);option?(selectElement[0].value!==option.selectValue&&(removeUnknownOption(),removeEmptyOption(),selectElement[0].value=option.selectValue,option.element.selected=!0),option.element.setAttribute("selected","selected")):null===value||providedEmptyOption?(removeUnknownOption(),renderEmptyOption()):(removeEmptyOption(),renderUnknownOption())},selectCtrl.readValue=function(){var selectedOption=options.selectValueMap[selectElement.val()];return selectedOption&&!selectedOption.disabled?(removeEmptyOption(),removeUnknownOption(),options.getViewValueFromOption(selectedOption)):null},ngOptions.trackBy&&scope.$watch(function(){return ngOptions.getTrackByValue(ngModelCtrl.$viewValue)},function(){ngModelCtrl.$render()})),providedEmptyOption?(emptyOption.remove(),$compile(emptyOption)(scope),emptyOption.removeClass("ng-scope")):emptyOption=jqLite(optionTemplate.cloneNode(!1)),selectElement.empty(),updateOptions(),scope.$watchCollection(ngOptions.getWatchables,updateOptions)}var optionTemplate=window.document.createElement("option"),optGroupTemplate=window.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(scope,selectElement,attr,ctrls){ctrls[0].registerOption=noop},post:ngOptionsPostLink}}}],ngPluralizeDirective=["$locale","$interpolate","$log",function($locale,$interpolate,$log){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNaN(count);if(countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),count!==lastCount&&!(countIsNaN&&isNumber(lastCount)&&isNaN(lastCount))){watchRemover();var whenExpFn=whensExpFns[count];isUndefined(whenExpFn)?(null!=newVal&&$log.debug("ngPluralize: no rule defined for '"+count+"' in "+whenExp),watchRemover=noop,updateElementText()):watchRemover=scope.$watch(whenExpFn,updateElementText),lastCount=count}})}}}],ngRepeatDirective=["$parse","$animate","$compile",function($parse,$animate,$compile){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=$compile.$$createComment("end ngRepeat",expression),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)hasOwnProperty.call(collection,itemKey)&&"$"!==itemKey.charAt(0)&&collectionKeys.push(itemKey)}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),
index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:void 0,clone:void 0},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;index<length;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockNodes(block.clone),null,previousNode),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,previousNode),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate","$compile",function($animate,$compile){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;i<ii;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;i<ii;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=$compile.$$createComment("end ngSwitchWhen");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeMinErr=minErr("ngTransclude"),ngTranscludeDirective=["$compile",function($compile){return{restrict:"EAC",terminal:!0,compile:function(tElement){var fallbackLinkFn=$compile(tElement.contents());return tElement.empty(),function($scope,$element,$attrs,controller,$transclude){function ngTranscludeCloneAttachFn(clone,transcludedScope){clone.length?$element.append(clone):(useFallbackContent(),transcludedScope.$destroy())}function useFallbackContent(){fallbackLinkFn($scope,function(clone){$element.append(clone)})}if(!$transclude)throw ngTranscludeMinErr("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$attrs.ngTransclude===$attrs.$attr.ngTransclude&&($attrs.ngTransclude="");var slotName=$attrs.ngTransclude||$attrs.ngTranscludeSlot;$transclude(ngTranscludeCloneAttachFn,null,slotName),slotName&&!$transclude.isSlotFilled(slotName)&&useFallbackContent()}}}}],scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],noopNgModelController={$setViewValue:noop,$render:noop},SelectController=["$element","$scope",function($element,$scope){var self=this,optionsMap=new HashMap;self.ngModelCtrl=noopNgModelController,self.unknownOption=jqLite(window.document.createElement("option")),self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";self.unknownOption.val(unknownVal),$element.prepend(self.unknownOption),$element.val(unknownVal)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop}),self.removeUnknownOption=function(){self.unknownOption.parent()&&self.unknownOption.remove()},self.readValue=function(){return self.removeUnknownOption(),$element.val()},self.writeValue=function(value){self.hasOption(value)?(self.removeUnknownOption(),$element.val(value),""===value&&self.emptyOption.prop("selected",!0)):null==value&&self.emptyOption?(self.removeUnknownOption(),$element.val("")):self.renderUnknownOption(value)},self.addOption=function(value,element){if(element[0].nodeType!==NODE_TYPE_COMMENT){assertNotHasOwnProperty(value,'"option value"'),""===value&&(self.emptyOption=element);var count=optionsMap.get(value)||0;optionsMap.put(value,count+1),self.ngModelCtrl.$render(),chromeHack(element)}},self.removeOption=function(value){var count=optionsMap.get(value);count&&(1===count?(optionsMap.remove(value),""===value&&(self.emptyOption=void 0)):optionsMap.put(value,count-1))},self.hasOption=function(value){return!!optionsMap.get(value)},self.registerOption=function(optionScope,optionElement,optionAttrs,interpolateValueFn,interpolateTextFn){if(interpolateValueFn){var oldVal;optionAttrs.$observe("value",function(newVal){isDefined(oldVal)&&self.removeOption(oldVal),oldVal=newVal,self.addOption(newVal,optionElement)})}else interpolateTextFn?optionScope.$watch(interpolateTextFn,function(newVal,oldVal){optionAttrs.$set("value",newVal),oldVal!==newVal&&self.removeOption(oldVal),self.addOption(newVal,optionElement)}):self.addOption(optionAttrs.value,optionElement);optionElement.on("$destroy",function(){self.removeOption(optionAttrs.value),self.ngModelCtrl.$render()})}}],selectDirective=function(){function selectPreLink(scope,element,attr,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];if(selectCtrl.ngModelCtrl=ngModelCtrl,element.on("change",function(){scope.$apply(function(){ngModelCtrl.$setViewValue(selectCtrl.readValue())})}),attr.multiple){selectCtrl.readValue=function(){var array=[];return forEach(element.find("option"),function(option){option.selected&&array.push(option.value)}),array},selectCtrl.writeValue=function(value){var items=new HashMap(value);forEach(element.find("option"),function(option){option.selected=isDefined(items.get(option.value))})};var lastView,lastViewRef=NaN;scope.$watch(function(){lastViewRef!==ngModelCtrl.$viewValue||equals(lastView,ngModelCtrl.$viewValue)||(lastView=shallowCopy(ngModelCtrl.$viewValue),ngModelCtrl.$render()),lastViewRef=ngModelCtrl.$viewValue}),ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}}}}function selectPostLink(scope,element,attrs,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];ngModelCtrl.$render=function(){selectCtrl.writeValue(ngModelCtrl.$viewValue)}}}return{restrict:"E",require:["select","?ngModel"],controller:SelectController,priority:1,link:{pre:selectPreLink,post:selectPostLink}}},optionDirective=["$interpolate",function($interpolate){return{restrict:"E",priority:100,compile:function(element,attr){if(isDefined(attr.value))var interpolateValueFn=$interpolate(attr.value,!0);else{var interpolateTextFn=$interpolate(element.text(),!0);interpolateTextFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.registerOption(scope,element,attr,interpolateValueFn,interpolateTextFn)}}}}],styleDirective=valueFn({restrict:"E",terminal:!1}),requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||void 0,ctrl.$validate()}),ctrl.$validators.pattern=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(regexp)||regexp.test(viewValue)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=toInt(value);maxlength=isNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return maxlength<0||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=toInt(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}};return window.angular.bootstrap?void(window.console&&console.log("WARNING: Tried to load angular more than once.")):(bindJQuery(),publishExternalAPI(angular),angular.module("ngLocale",[],["$provide",function($provide){function getDecimals(n){n+="";var i=n.indexOf(".");return i==-1?0:n.length-i-1}function getVF(n,opt_precision){var v=opt_precision;void 0===v&&(v=Math.min(getDecimals(n),3));var base=Math.pow(10,v),f=(n*base|0)%base;return{v:v,f:f}}var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(n,opt_precision){var i=0|n,vf=getVF(n,opt_precision);return 1==i&&0==vf.v?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),void jqLite(window.document).ready(function(){angularInit(window.document,bootstrap)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),function(window,angular,undefined){"use strict";function jsonStringToDate(string){var match;if(match=string.match(R_ISO8061_STR)){var date=new Date(0),tzHour=0,tzMin=0;return match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),date.setUTCFullYear(int(match[1]),int(match[2])-1,int(match[3])),date.setUTCHours(int(match[4]||0)-tzHour,int(match[5]||0)-tzMin,int(match[6]||0),int(match[7]||0)),date}return string}function int(str){return parseInt(str,10)}function padNumber(num,digits,trim){var neg="";for(num<0&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function createHttpBackendMock($rootScope,$delegate,$browser){function createResponse(status,data,headers,statusText){return angular.isFunction(status)?status:function(){return angular.isNumber(status)?[status,data,headers,statusText]:[200,status,data]}}function $httpBackend(method,url,data,callback,headers,timeout,withCredentials){function prettyPrint(data){return angular.isString(data)||angular.isFunction(data)||data instanceof RegExp?data:angular.toJson(data)}function wrapResponse(wrapped){function handleResponse(){var response=wrapped.response(method,url,data,headers);xhr.$$respHeaders=response[2],callback(copy(response[0]),copy(response[1]),xhr.getAllResponseHeaders(),copy(response[3]||""))}function handleTimeout(){for(var i=0,ii=responses.length;i<ii;i++)if(responses[i]===handleResponse){responses.splice(i,1),callback(-1,undefined,"");break}}return!$browser&&timeout&&timeout.then&&timeout.then(handleTimeout),handleResponse}var xhr=new MockXhr,expectation=expectations[0],wasExpected=!1;if(expectation&&expectation.match(method,url)){if(!expectation.matchData(data))throw new Error("Expected "+expectation+" with different data\nEXPECTED: "+prettyPrint(expectation.data)+"\nGOT:      "+data);if(!expectation.matchHeaders(headers))throw new Error("Expected "+expectation+" with different headers\nEXPECTED: "+prettyPrint(expectation.headers)+"\nGOT:      "+prettyPrint(headers));if(expectations.shift(),expectation.response)return void responses.push(wrapResponse(expectation));wasExpected=!0}for(var definition,i=-1;definition=definitions[++i];)if(definition.match(method,url,data,headers||{})){if(definition.response)($browser?$browser.defer:responsesPush)(wrapResponse(definition));else{if(!definition.passThrough)throw new Error("No response defined !");$delegate(method,url,data,callback,headers,timeout,withCredentials)}return}throw wasExpected?new Error("No response defined !"):new Error("Unexpected request: "+method+" "+url+"\n"+(expectation?"Expected "+expectation:"No more request expected"))}function createShortMethods(prefix){angular.forEach(["GET","DELETE","JSONP","HEAD"],function(method){$httpBackend[prefix+method]=function(url,headers){return $httpBackend[prefix](method,url,undefined,headers)}}),angular.forEach(["PUT","POST","PATCH"],function(method){$httpBackend[prefix+method]=function(url,data,headers){return $httpBackend[prefix](method,url,data,headers)}})}var definitions=[],expectations=[],responses=[],responsesPush=angular.bind(responses,responses.push),copy=angular.copy;return $httpBackend.when=function(method,url,data,headers){var definition=new MockHttpExpectation(method,url,data,headers),chain={respond:function(status,data,headers,statusText){definition.response=createResponse(status,data,headers,statusText)}};return $browser&&(chain.passThrough=function(){definition.passThrough=!0}),definitions.push(definition),chain},createShortMethods("when"),$httpBackend.expect=function(method,url,data,headers){var expectation=new MockHttpExpectation(method,url,data,headers);return expectations.push(expectation),{respond:function(status,data,headers,statusText){expectation.response=createResponse(status,data,headers,statusText)}}},createShortMethods("expect"),$httpBackend.flush=function(count){if($rootScope.$digest(),!responses.length)throw new Error("No pending request to flush !");if(angular.isDefined(count))for(;count--;){if(!responses.length)throw new Error("No more pending request to flush !");responses.shift()()}else for(;responses.length;)responses.shift()();$httpBackend.verifyNoOutstandingExpectation()},$httpBackend.verifyNoOutstandingExpectation=function(){if($rootScope.$digest(),expectations.length)throw new Error("Unsatisfied requests: "+expectations.join(", "))},$httpBackend.verifyNoOutstandingRequest=function(){if(responses.length)throw new Error("Unflushed requests: "+responses.length)},$httpBackend.resetExpectations=function(){expectations.length=0,responses.length=0},$httpBackend}function MockHttpExpectation(method,url,data,headers){this.data=data,this.headers=headers,this.match=function(m,u,d,h){return method==m&&(!!this.matchUrl(u)&&(!(angular.isDefined(d)&&!this.matchData(d))&&!(angular.isDefined(h)&&!this.matchHeaders(h))))},this.matchUrl=function(u){return!url||(angular.isFunction(url.test)?url.test(u):url==u)},this.matchHeaders=function(h){return!!angular.isUndefined(headers)||(angular.isFunction(headers)?headers(h):angular.equals(headers,h))},this.matchData=function(d){return!!angular.isUndefined(data)||(data&&angular.isFunction(data.test)?data.test(d):data&&angular.isFunction(data)?data(d):data&&!angular.isString(data)?angular.equals(angular.fromJson(angular.toJson(data)),angular.fromJson(d)):data==d)},this.toString=function(){return method+" "+url}}function MockXhr(){MockXhr.$$lastInstance=this,this.open=function(method,url,async){this.$$method=method,this.$$url=url,this.$$async=async,this.$$reqHeaders={},this.$$respHeaders={}},this.send=function(data){this.$$data=data},this.setRequestHeader=function(key,value){this.$$reqHeaders[key]=value},this.getResponseHeader=function(name){var header=this.$$respHeaders[name];return header?header:(name=angular.lowercase(name),(header=this.$$respHeaders[name])?header:(header=undefined,angular.forEach(this.$$respHeaders,function(headerVal,headerName){header||angular.lowercase(headerName)!=name||(header=headerVal)}),header))},this.getAllResponseHeaders=function(){var lines=[];return angular.forEach(this.$$respHeaders,function(value,key){lines.push(key+": "+value)}),lines.join("\n")},this.abort=angular.noop}angular.mock={},angular.mock.$BrowserProvider=function(){this.$get=function(){return new angular.mock.$Browser}},angular.mock.$Browser=function(){var self=this;this.isMock=!0,self.$$url="http://server/",self.$$lastUrl=self.$$url,self.pollFns=[],self.$$completeOutstandingRequest=angular.noop,self.$$incOutstandingRequestCount=angular.noop,self.onUrlChange=function(listener){return self.pollFns.push(function(){self.$$lastUrl!=self.$$url&&(self.$$lastUrl=self.$$url,listener(self.$$url))}),listener},self.$$checkUrlChange=angular.noop,self.cookieHash={},self.lastCookieHash={},self.deferredFns=[],self.deferredNextId=0,self.defer=function(fn,delay){return delay=delay||0,self.deferredFns.push({time:self.defer.now+delay,fn:fn,id:self.deferredNextId}),self.deferredFns.sort(function(a,b){return a.time-b.time}),self.deferredNextId++},self.defer.now=0,self.defer.cancel=function(deferId){var fnIndex;return angular.forEach(self.deferredFns,function(fn,index){fn.id===deferId&&(fnIndex=index)}),fnIndex!==undefined&&(self.deferredFns.splice(fnIndex,1),!0)},self.defer.flush=function(delay){if(angular.isDefined(delay))self.defer.now+=delay;else{if(!self.deferredFns.length)throw new Error("No deferred tasks to be flushed");self.defer.now=self.deferredFns[self.deferredFns.length-1].time}for(;self.deferredFns.length&&self.deferredFns[0].time<=self.defer.now;)self.deferredFns.shift().fn()},self.$$baseHref="",self.baseHref=function(){return this.$$baseHref}},angular.mock.$Browser.prototype={poll:function(){angular.forEach(this.pollFns,function(pollFn){pollFn()})},addPollFn:function(pollFn){return this.pollFns.push(pollFn),pollFn},url:function(url,replace){return url?(this.$$url=url,this):this.$$url},cookies:function(name,value){return name?void(angular.isUndefined(value)?delete this.cookieHash[name]:angular.isString(value)&&value.length<=4096&&(this.cookieHash[name]=value)):(angular.equals(this.cookieHash,this.lastCookieHash)||(this.lastCookieHash=angular.copy(this.cookieHash),this.cookieHash=angular.copy(this.cookieHash)),this.cookieHash)},notifyWhenNoOutstandingRequests:function(fn){fn()}},angular.mock.$ExceptionHandlerProvider=function(){var handler;this.mode=function(mode){switch(mode){case"rethrow":handler=function(e){throw e};break;case"log":var errors=[];handler=function(e){1==arguments.length?errors.push(e):errors.push([].slice.call(arguments,0))},handler.errors=errors;break;default:throw new Error("Unknown mode '"+mode+"', only 'log'/'rethrow' modes are allowed!")}},this.$get=function(){return handler},this.mode("rethrow")},angular.mock.$LogProvider=function(){function concat(array1,array2,index){return array1.concat(Array.prototype.slice.call(array2,index))}var debug=!0;this.debugEnabled=function(flag){return angular.isDefined(flag)?(debug=flag,this):debug},this.$get=function(){var $log={log:function(){$log.log.logs.push(concat([],arguments,0))},warn:function(){$log.warn.logs.push(concat([],arguments,0))},info:function(){$log.info.logs.push(concat([],arguments,0))},error:function(){$log.error.logs.push(concat([],arguments,0))},debug:function(){debug&&$log.debug.logs.push(concat([],arguments,0))}};return $log.reset=function(){$log.log.logs=[],$log.info.logs=[],$log.warn.logs=[],$log.error.logs=[],$log.debug.logs=[]},$log.assertEmpty=function(){var errors=[];if(angular.forEach(["error","warn","info","log","debug"],function(logLevel){angular.forEach($log[logLevel].logs,function(log){angular.forEach(log,function(logItem){errors.push("MOCK $log ("+logLevel+"): "+String(logItem)+"\n"+(logItem.stack||""))})})}),errors.length)throw errors.unshift("Expected $log to be empty! Either a message was logged unexpectedly, or an expected log message was not checked and removed:"),errors.push(""),new Error(errors.join("\n---------\n"))},$log.reset(),$log}},angular.mock.$IntervalProvider=function(){this.$get=["$rootScope","$q",function($rootScope,$q){var repeatFns=[],nextRepeatId=0,now=0,$interval=function(fn,delay,count,invokeApply){function tick(){if(deferred.notify(iteration++),count>0&&iteration>=count){var fnIndex;deferred.resolve(iteration),angular.forEach(repeatFns,function(fn,index){fn.id===promise.$$intervalId&&(fnIndex=index)}),fnIndex!==undefined&&repeatFns.splice(fnIndex,1)}skipApply||$rootScope.$apply()}var deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=angular.isDefined(invokeApply)&&!invokeApply;return count=angular.isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=nextRepeatId,repeatFns.push({nextTime:now+delay,delay:delay,fn:tick,id:nextRepeatId,deferred:deferred}),repeatFns.sort(function(a,b){return a.nextTime-b.nextTime}),nextRepeatId++,promise};return $interval.cancel=function(promise){if(!promise)return!1;var fnIndex;return angular.forEach(repeatFns,function(fn,index){fn.id===promise.$$intervalId&&(fnIndex=index)}),fnIndex!==undefined&&(repeatFns[fnIndex].deferred.reject("canceled"),repeatFns.splice(fnIndex,1),!0)},$interval.flush=function(millis){for(now+=millis;repeatFns.length&&repeatFns[0].nextTime<=now;){var task=repeatFns[0];task.fn(),task.nextTime+=task.delay,repeatFns.sort(function(a,b){return a.nextTime-b.nextTime})}return millis},$interval}]};var R_ISO8061_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?:\:?(\d\d)(?:\:?(\d\d)(?:\.(\d{3}))?)?)?(Z|([+-])(\d\d):?(\d\d)))?$/;if(angular.mock.TzDate=function(offset,timestamp){var self=new Date(0);if(angular.isString(timestamp)){var tsStr=timestamp;if(self.origDate=jsonStringToDate(timestamp),timestamp=self.origDate.getTime(),isNaN(timestamp))throw{name:"Illegal Argument",message:"Arg '"+tsStr+"' passed into TzDate constructor is not a valid date string"}}else self.origDate=new Date(timestamp);var localOffset=new Date(timestamp).getTimezoneOffset();self.offsetDiff=60*localOffset*1e3-1e3*offset*60*60,self.date=new Date(timestamp+self.offsetDiff),self.getTime=function(){return self.date.getTime()-self.offsetDiff},self.toLocaleDateString=function(){return self.date.toLocaleDateString()},self.getFullYear=function(){return self.date.getFullYear()},self.getMonth=function(){return self.date.getMonth()},self.getDate=function(){return self.date.getDate()},self.getHours=function(){return self.date.getHours()},self.getMinutes=function(){return self.date.getMinutes()},self.getSeconds=function(){return self.date.getSeconds()},self.getMilliseconds=function(){return self.date.getMilliseconds()},self.getTimezoneOffset=function(){return 60*offset},self.getUTCFullYear=function(){return self.origDate.getUTCFullYear()},self.getUTCMonth=function(){return self.origDate.getUTCMonth()},self.getUTCDate=function(){return self.origDate.getUTCDate()},self.getUTCHours=function(){return self.origDate.getUTCHours()},self.getUTCMinutes=function(){return self.origDate.getUTCMinutes()},self.getUTCSeconds=function(){return self.origDate.getUTCSeconds()},self.getUTCMilliseconds=function(){return self.origDate.getUTCMilliseconds()},self.getDay=function(){return self.date.getDay()},self.toISOString&&(self.toISOString=function(){return padNumber(self.origDate.getUTCFullYear(),4)+"-"+padNumber(self.origDate.getUTCMonth()+1,2)+"-"+padNumber(self.origDate.getUTCDate(),2)+"T"+padNumber(self.origDate.getUTCHours(),2)+":"+padNumber(self.origDate.getUTCMinutes(),2)+":"+padNumber(self.origDate.getUTCSeconds(),2)+"."+padNumber(self.origDate.getUTCMilliseconds(),3)+"Z"});var unimplementedMethods=["getUTCDay","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toGMTString","toJSON","toLocaleFormat","toLocaleString","toLocaleTimeString","toSource","toString","toTimeString","toUTCString","valueOf"];return angular.forEach(unimplementedMethods,function(methodName){self[methodName]=function(){throw new Error("Method '"+methodName+"' is not implemented in the TzDate mock")}}),self},angular.mock.TzDate.prototype=Date.prototype,angular.mock.animate=angular.module("ngAnimateMock",["ng"]).config(["$provide",function($provide){var reflowQueue=[];$provide.value("$$animateReflow",function(fn){var index=reflowQueue.length;return reflowQueue.push(fn),function(){reflowQueue.splice(index,1)}}),$provide.decorator("$animate",function($delegate,$$asyncCallback){var animate={queue:[],enabled:$delegate.enabled,triggerCallbacks:function(){$$asyncCallback.flush()},triggerReflow:function(){angular.forEach(reflowQueue,function(fn){fn()}),reflowQueue=[]}};return angular.forEach(["enter","leave","move","addClass","removeClass","setClass"],function(method){animate[method]=function(){animate.queue.push({event:method,element:arguments[0],args:arguments}),$delegate[method].apply($delegate,arguments)}}),animate})}]),angular.mock.dump=function(object){function serialize(object){var out;return angular.isElement(object)?(object=angular.element(object),out=angular.element("<div></div>"),angular.forEach(object,function(element){out.append(angular.element(element).clone())}),out=out.html()):angular.isArray(object)?(out=[],angular.forEach(object,function(o){out.push(serialize(o))}),out="[ "+out.join(", ")+" ]"):out=angular.isObject(object)?angular.isFunction(object.$eval)&&angular.isFunction(object.$apply)?serializeScope(object):object instanceof Error?object.stack||""+object.name+": "+object.message:angular.toJson(object,!0):String(object),out}function serializeScope(scope,offset){offset=offset||"  ";var log=[offset+"Scope("+scope.$id+"): {"];for(var key in scope)Object.prototype.hasOwnProperty.call(scope,key)&&!key.match(/^(\$|this)/)&&log.push("  "+key+": "+angular.toJson(scope[key]));for(var child=scope.$$childHead;child;)log.push(serializeScope(child,offset+"  ")),child=child.$$nextSibling;return log.push("}"),log.join("\n"+offset)}return serialize(object)},angular.mock.$HttpBackendProvider=function(){this.$get=["$rootScope",createHttpBackendMock]},angular.mock.$TimeoutDecorator=function($delegate,$browser){function formatPendingTasksAsString(tasks){var result=[];return angular.forEach(tasks,function(task){result.push("{id: "+task.id+", time: "+task.time+"}")}),result.join(", ")}return $delegate.flush=function(delay){$browser.defer.flush(delay)},$delegate.verifyNoPendingTasks=function(){if($browser.deferredFns.length)throw new Error("Deferred tasks to flush ("+$browser.deferredFns.length+"): "+formatPendingTasksAsString($browser.deferredFns))},$delegate},angular.mock.$RAFDecorator=function($delegate){var queue=[],rafFn=function(fn){var index=queue.length;return queue.push(fn),function(){queue.splice(index,1)}};return rafFn.supported=$delegate.supported,rafFn.flush=function(){if(0===queue.length)throw new Error("No rAF callbacks present");for(var length=queue.length,i=0;i<length;i++)queue[i]();queue=[]},rafFn},angular.mock.$AsyncCallbackDecorator=function($delegate){var callbacks=[],addFn=function(fn){callbacks.push(fn)};return addFn.flush=function(){angular.forEach(callbacks,function(fn){fn()}),callbacks=[]},addFn},angular.mock.$RootElementProvider=function(){this.$get=function(){return angular.element("<div ng-app></div>")}},angular.module("ngMock",["ng"]).provider({$browser:angular.mock.$BrowserProvider,$exceptionHandler:angular.mock.$ExceptionHandlerProvider,$log:angular.mock.$LogProvider,$interval:angular.mock.$IntervalProvider,$httpBackend:angular.mock.$HttpBackendProvider,$rootElement:angular.mock.$RootElementProvider}).config(["$provide",function($provide){$provide.decorator("$timeout",angular.mock.$TimeoutDecorator),$provide.decorator("$$rAF",angular.mock.$RAFDecorator),$provide.decorator("$$asyncCallback",angular.mock.$AsyncCallbackDecorator)}]),angular.module("ngMockE2E",["ng"]).config(["$provide",function($provide){$provide.decorator("$httpBackend",angular.mock.e2e.$httpBackendDecorator)}]),angular.mock.e2e={},angular.mock.e2e.$httpBackendDecorator=["$rootScope","$delegate","$browser",createHttpBackendMock],angular.mock.clearDataCache=function(){var key,cache=angular.element.cache;for(key in cache)if(Object.prototype.hasOwnProperty.call(cache,key)){var handle=cache[key].handle;
handle&&angular.element(handle.elem).off(),delete cache[key]}},window.jasmine||window.mocha){var currentSpec=null,isSpecRunning=function(){return!!currentSpec};(window.beforeEach||window.setup)(function(){currentSpec=this}),(window.afterEach||window.teardown)(function(){var injector=currentSpec.$injector;angular.forEach(currentSpec.$modules,function(module){module&&module.$$hashKey&&(module.$$hashKey=undefined)}),currentSpec.$injector=null,currentSpec.$modules=null,currentSpec=null,injector&&(injector.get("$rootElement").off(),injector.get("$browser").pollFns.length=0),angular.mock.clearDataCache(),angular.forEach(angular.element.fragments,function(val,key){delete angular.element.fragments[key]}),MockXhr.$$lastInstance=null,angular.forEach(angular.callbacks,function(val,key){delete angular.callbacks[key]}),angular.callbacks.counter=0}),window.module=angular.mock.module=function(){function workFn(){if(currentSpec.$injector)throw new Error("Injector already created, can not register a module!");var modules=currentSpec.$modules||(currentSpec.$modules=[]);angular.forEach(moduleFns,function(module){angular.isObject(module)&&!angular.isArray(module)?modules.push(function($provide){angular.forEach(module,function(value,key){$provide.value(key,value)})}):modules.push(module)})}var moduleFns=Array.prototype.slice.call(arguments,0);return isSpecRunning()?workFn():workFn};var ErrorAddingDeclarationLocationStack=function(e,errorForStack){this.message=e.message,this.name=e.name,e.line&&(this.line=e.line),e.sourceId&&(this.sourceId=e.sourceId),e.stack&&errorForStack&&(this.stack=e.stack+"\n"+errorForStack.stack),e.stackArray&&(this.stackArray=e.stackArray)};ErrorAddingDeclarationLocationStack.prototype.toString=Error.prototype.toString,window.inject=angular.mock.inject=function(){function workFn(){var modules=currentSpec.$modules||[];modules.unshift("ngMock"),modules.unshift("ng");var injector=currentSpec.$injector;injector||(injector=currentSpec.$injector=angular.injector(modules));for(var i=0,ii=blockFns.length;i<ii;i++)try{injector.invoke(blockFns[i]||angular.noop,this)}catch(e){if(e.stack&&errorForStack)throw new ErrorAddingDeclarationLocationStack(e,errorForStack);throw e}finally{errorForStack=null}}var blockFns=Array.prototype.slice.call(arguments,0),errorForStack=new Error("Declaration Location");return isSpecRunning()?workFn.call(currentSpec):workFn}}}(window,window.angular);var TrNgGrid;!function(n){function ot(t){t.get(n.cellHeaderTemplateId)||t.put(n.cellHeaderTemplateId,'<div class="'+n.headerCellCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <div class="'+n.columnTitleCssClass+'">      {{columnTitle |'+n.translateFilter+":gridOptions.locale}}       <div "+n.columnSortDirectiveAttribute+'=""></div>    </div>    <div '+n.columnFilterDirectiveAttribute+'=""></div>  </div></div>'),t.get(n.cellBodyTemplateId)||t.put(n.cellBodyTemplateId,'<div ng-attr-class="'+n.bodyCellCssClass+' text-{{columnOptions.displayAlign}}" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>{{gridDisplayItem[columnOptions.displayFieldName]}}</div></div>'),t.get(n.columnFilterTemplateId)||t.put(n.columnFilterTemplateId,'<div ng-show="(gridOptions.enableFiltering&&columnOptions.enableFiltering!==false)||columnOptions.enableFiltering" class="'+n.columnFilterCssClass+'"> <div class="'+n.columnFilterInputWrapperCssClass+'">   <input class="form-control input-sm" type="text" ng-model="columnOptions.filter" ng-keypress="speedUpAsyncDataRetrieval($event)"></input> </div></div>'),t.get(n.columnSortTemplateId)||t.put(n.columnSortTemplateId,"<div ng-attr-title=\"{{'Sort'|"+n.translateFilter+':gridOptions.locale}}" ng-show="(gridOptions.enableSorting&&columnOptions.enableSorting!==false)||columnOptions.enableSorting" ng-click="toggleSorting(columnOptions.fieldName)" class="'+n.columnSortCssClass+'" >   <div ng-class="{\''+n.columnSortActiveCssClass+"':gridOptions.orderBy==columnOptions.fieldName,'"+n.columnSortInactiveCssClass+"':gridOptions.orderBy!=columnOptions.fieldName,'"+n.columnSortNormalOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&!gridOptions.orderByReverse,'"+n.columnSortReverseOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&gridOptions.orderByReverse}\" >  </div></div>"),t.put(n.cellFooterTemplateId)||t.put(n.cellFooterTemplateId,'<div class="'+n.footerCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <span '+n.globalFilterDirectiveAttribute+'=""></span>    <span '+n.pagerDirectiveAttribute+'=""></span>  </div></div>'),t.get(n.footerGlobalFilterTemplateId)||t.put(n.footerGlobalFilterTemplateId,'<span ng-show="gridOptions.enableFiltering" class="pull-left form-group">  <input class="form-control" type="text" ng-model="gridOptions.filterBy" ng-keypress="speedUpAsyncDataRetrieval($event)" ng-attr-placeholder="{{\'Search\'|'+n.translateFilter+':gridOptions.locale}}"></input></span>'),t.get(n.footerPagerTemplateId)||t.put(n.footerPagerTemplateId,'<span class="pull-right form-group"> <ul class="pagination">   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(0)" ng-attr-title="{{\'First Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&laquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(gridOptions.currentPage - 1)" ng-attr-title="{{\'Previous Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&lsaquo;</span>     </a>   </li>   <li ng-if="pageSelectionActive" ng-repeat="pageIndex in pageIndexes track by $index" ng-class="{disabled:pageIndex===null, active:pageIndex===gridOptions.currentPage}">      <span ng-if="pageIndex===null">...</span>      <a href="" ng-click="navigateToPage(pageIndex)" ng-if="pageIndex!==null" ng-attr-title="{{\'Page\'|'+n.translateFilter+':gridOptions.locale}}">{{pageIndex+1}}</a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(gridOptions.currentPage + 1)" ng-attr-title="{{\'Next Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&rsaquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(lastPageIndex)" ng-attr-title="{{\'Last Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&raquo;</span>     </a>   </li>   <li class="disabled" style="white-space: nowrap;">     <span ng-hide="totalItemsCount">{{\'No items to display\'|'+n.translateFilter+":gridOptions.locale}}</span>     <span ng-show=\"totalItemsCount\">       {{startItemIndex+1}} - {{endItemIndex+1}} {{'displayed'|"+n.translateFilter+":gridOptions.locale}}       <span>, {{totalItemsCount}} {{'in total'|"+n.translateFilter+":gridOptions.locale}}</span>     </span >    </li> </ul></span>")}var i,u,t,f,e,o,s;!function(n){n[n.None=0]="None",n[n.SingleRow=1]="SingleRow",n[n.MultiRow=2]="MultiRow",n[n.MultiRowWithKeyModifiers=3]="MultiRowWithKeyModifiers"}(n.SelectionMode||(n.SelectionMode={})),i=n.SelectionMode,n.defaultColumnOptions={cellWidth:null,cellHeight:null,displayAlign:null,displayFormat:null,displayName:null,filter:null,enableFiltering:null,enableSorting:null},n.translations={},n.debugMode=!1,u=!1,t="trNgGrid",n.sortFilter=t+"SortFilter",n.dataPagingFilter=t+"DataPagingFilter",n.translateFilter=t+"TranslateFilter",n.translationDateFormat=t+"DateFormat",n.dataFormattingFilter=t+"DataFormatFilter";var l="tr-ng-grid-body",a="field-name",d="is-customized",g="tr-ng-grid-footer-cell",v="trNgGridFooterCellTemplate",nt="tr-ng-grid-footer-cell-template";n.cellFooterTemplateId=v+".html",f="trNgGridGlobalFilter",n.globalFilterDirectiveAttribute="tr-ng-grid-global-filter",n.footerGlobalFilterTemplateId=f+".html",e="trNgGridPager",n.pagerDirectiveAttribute="tr-ng-grid-pager",n.footerPagerTemplateId=e+".html";var y="trNgGridHeaderCell",tt="tr-ng-grid-header-cell",p="trNgGridHeaderCellTemplate",it="tr-ng-grid-header-cell-template";n.cellHeaderTemplateId=p+".html";var w="trNgGridBodyCell",rt="tr-ng-grid-body-cell",b="trNgGridBodyCellTemplate",ut="tr-ng-grid-body-cell-template";n.cellBodyTemplateId=b+".html",o="trNgGridColumnSort",n.columnSortDirectiveAttribute="tr-ng-grid-column-sort",n.columnSortTemplateId=o+".html",s="trNgGridColumnFilter",n.columnFilterDirectiveAttribute="tr-ng-grid-column-filter",n.columnFilterTemplateId=s+".html";var k=function(n,t){var r,i,u;for(t=t.toUpperCase(),r=n.children(),i=0;i<r.length;i++)if(u=r[i],u.tagName==t)return angular.element(u);return null},r=function(n,t,i,r){var u=[],f=t.slice(0);return angular.forEach(n,function(n){for(var t=null,i=0;!t&&i<f.length;i++)t=f[i],t.fieldName===n.fieldName?f.splice(i,1):t=null;t?u.push(t):u.push(n)}),(i||r)&&angular.forEach(f,function(n){(i&&n.fieldName||r&&!n.fieldName)&&u.push(n)}),u},h=function(n,t,i,r){var u,e,f;i?(u=n.children(),e=angular.element(u[0]),1===u.length&&e.attr(r)||(n.empty(),f=angular.element("<div></div>").attr(r,""),n.append(f),angular.forEach(u,function(n){f.append(angular.element(n))}))):(n.empty(),n.append(angular.element("<div></div>").attr(r,"")))},ft=function(){function n(n,t){this.parent=n,this.cellElement=t,this.fieldName=t.attr(a);var i=t.children();this.isStandardColumn=0===i.length}return n}(),c=function(){function n(n,t,i,r,u){this.sectionTagName=n,this.sectionDirectiveAttribute=t,this.rowDirectiveAttribute=i,this.cellTagName=r,this.cellDirectiveAttribute=u,this.cellTagName=this.cellTagName.toUpperCase(),this.cells=null}return n.prototype.configureSection=function(n,t){var f,e,i=this,u=this.getSectionElement(n,!0);return u.empty(),u.removeAttr("ng-non-bindable"),f=r(t,this.cells,!1,!1),e=this.getTemplatedRowElement(u,!0),angular.forEach(f,function(n,t){var r,u=n;r=u.parent===i&&u.cellElement?u.cellElement.clone(!0):angular.element("<table><"+i.cellTagName+"></"+i.cellTagName+"></table>").find(i.cellTagName),i.cellDirectiveAttribute&&r.attr(i.cellDirectiveAttribute,t),n.isStandardColumn||r.attr(d,"true"),n.fieldName&&r.attr(a,n.fieldName),r.attr("ng-style","{'width':columnOptions.cellWidth,'height':columnOptions.cellHeight}"),e.append(r)}),u},n.prototype.extractPartialColumnDefinitions=function(){return this.cells},n.prototype.discoverCells=function(n){var i,t=this;this.cells=[],i=this.getTemplatedRowElement(this.getSectionElement(n,!1),!1),i&&angular.forEach(i.children(),function(n){if(n=angular.element(n),n[0].tagName===t.cellTagName.toUpperCase()){var i=n.clone(!0);t.cells.push(new ft(t,i))}})},n.prototype.getSectionElement=function(n,t){var i=null;return n&&(i=k(n,this.sectionTagName)),!i&&t&&(i=angular.element("<table><"+this.sectionTagName+"></"+this.sectionTagName+"></table>").find(this.sectionTagName),n&&n.append(i)),t&&this.sectionDirectiveAttribute&&i.attr(this.sectionDirectiveAttribute,""),i},n.prototype.getTemplatedRowElement=function(n,t){var i=null;return n&&(i=k(n,"tr")),!i&&t&&(i=angular.element("<table><tr></tr></table>").find("tr"),n&&n.append(i)),t&&this.rowDirectiveAttribute&&i.attr(this.rowDirectiveAttribute,""),i},n}(),et=function(){function f(n,t,i,r){this.$compile=n,this.$parse=t,this.$timeout=i,u||(ot(r),u=!0)}return f.prototype.setupScope=function(t,r,u){var o,s,f=this,e=angular.element(r).scope().$new();return this.gridOptions={immediateDataRetrieval:!0,items:[],fields:null,locale:"en",selectedItems:[],filterBy:null,filterByFields:{},orderBy:null,orderByReverse:!1,pageItems:null,currentPage:0,totalItems:null,enableFiltering:!0,enableSorting:!0,selectionMode:i[2],onDataRequiredDelay:1e3,onDataRequired:u.onDataRequired?t.onDataRequired:null,gridColumnDefs:[]},e.gridOptions=this.gridOptions,e.TrNgGrid=n,this.linkScope(e,t,"gridOptions",u),this.gridOptions.onDataRequired&&(o=function(){f.dataRequestPromise=null,f.gridOptions.immediateDataRetrieval=!1,f.gridOptions.onDataRequired(f.gridOptions)},s=function(){f.dataRequestPromise&&(f.$timeout.cancel(f.dataRequestPromise),f.dataRequestPromise=null),f.gridOptions.immediateDataRetrieval?o():f.dataRequestPromise=f.$timeout(function(){o()},f.gridOptions.onDataRequiredDelay,!0)},e.$watch("gridOptions.currentPage",function(n,t){n!==t&&s()}),e.$watchCollection("[gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.pageItems, ]",function(){return 0!==f.gridOptions.currentPage?void(f.gridOptions.currentPage=0):void s()}),e.$watch("gridOptions.immediateDataRetrieval",function(n){n&&f.dataRequestPromise&&(f.$timeout.cancel(f.dataRequestPromise),o())})),e.$watch("gridOptions.selectionMode",function(n,t){if(n!==t)switch(n){case i[0]:f.gridOptions.selectedItems.splice(0);break;case i[1]:f.gridOptions.selectedItems.length>1&&f.gridOptions.selectedItems.splice(1)}}),e},f.prototype.speedUpAsyncDataRetrieval=function(n){n&&13!=n.keyCode||(this.gridOptions.immediateDataRetrieval=!0)},f.prototype.setColumnOptions=function(n,t){var i=this.gridOptions.gridColumnDefs[n];if(!i)throw"Invalid grid column options found for column index "+n+". Please report this error.";t=angular.extend(t,i),this.gridOptions.gridColumnDefs[n]=t},f.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse,this.speedUpAsyncDataRetrieval()},f.prototype.getFormattedFieldName=function(n){return n.replace(/[\.\[\]]/g,"_")},f.prototype.setFilter=function(n,t){t?this.gridOptions.filterByFields[n]=t:delete this.gridOptions.filterByFields[n],this.gridOptions.filterByFields=angular.extend({},this.gridOptions.filterByFields)},f.prototype.toggleItemSelection=function(n,t,r){var h,f,c,e,l,o,s,u;if(this.gridOptions.selectionMode!==i[0])switch(this.gridOptions.selectionMode){case i[3]:if(r.ctrlKey||r.shiftKey||r.metaKey){if(r.ctrlKey||r.metaKey)u=this.gridOptions.selectedItems.indexOf(t),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(t);else if(r.shiftKey){for(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(h=window.getSelection(),h.removeAllRanges()),c=this.gridOptions.selectedItems[this.gridOptions.selectedItems.length-1],f=0;f<n.length&&n[f].$$_gridItem!==c;f++);for(f>=n.length&&(f=0),e=0;e<n.length&&n[e].$$_gridItem!==t;e++);if(e>=n.length)throw"Invalid selection on a key modifier selection mode";for(e<f&&(l=f,f=e,e=l),o=f;o<=e;o++)s=n[o].$$_gridItem,this.gridOptions.selectedItems.indexOf(s)<0&&this.gridOptions.selectedItems.push(s)}}else u=this.gridOptions.selectedItems.indexOf(t),this.gridOptions.selectedItems.splice(0),u<0&&this.gridOptions.selectedItems.push(t);break;case i[1]:u=this.gridOptions.selectedItems.indexOf(t),this.gridOptions.selectedItems.splice(0),u<0&&this.gridOptions.selectedItems.push(t);break;case i[2]:u=this.gridOptions.selectedItems.indexOf(t),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(t)}},f.prototype.discoverTemplates=function(n){this.templatedHeader=new c("thead",null,null,"th",tt),this.templatedBody=new c("tbody",l,null,"td",rt),this.templatedFooter=new c("tfoot",null,null,"td",g),this.templatedHeader.discoverCells(n),this.templatedFooter.discoverCells(n),this.templatedBody.discoverCells(n)},f.prototype.configureTableStructure=function(t,i,u){var y,h=this,e=t.$new();i.empty(),this.columnDefsItemsWatcherDeregistration&&(this.columnDefsItemsWatcherDeregistration(),this.columnDefsItemsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration&&(this.columnDefsFieldsWatcherDeregistration(),this.columnDefsFieldsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration=e.$watch("gridOptions.fields",function(n,r){angular.equals(n,r)||h.configureTableStructure(t,i,e)},!0);var c=this.templatedHeader.extractPartialColumnDefinitions(),a=this.templatedBody.extractPartialColumnDefinitions(),v=this.templatedFooter.extractPartialColumnDefinitions(),f=[],b=this.gridOptions.fields;if(b)angular.forEach(this.gridOptions.fields,function(n){n&&f.push({isStandardColumn:!0,fieldName:n})}),f=r(f,c,!1,!0),f=r(f,a,!1,!0);else if(c.length>0)f=r(c,a,!0,!0);else{if(!this.gridOptions.items||0==this.gridOptions.items.length)return void(this.columnDefsItemsWatcherDeregistration=e.$watch("gridOptions.items.length",function(n){n&&h.configureTableStructure(t,i,e)}));for(y in this.gridOptions.items[0])y.match(/^[_\$]/g)||f.push({isStandardColumn:!0,fieldName:y});f=r(f,a,!0,!0)}0==v.length&&v.push({isStandardColumn:!0}),angular.forEach(f,function(n){n.fieldName&&(n.displayFieldName=h.getFormattedFieldName(n.fieldName))}),this.gridOptions.gridColumnDefs=f;var p=this.templatedHeader.configureSection(i,f),w=this.templatedFooter.configureSection(i,v),o=this.templatedBody.configureSection(i,f),s=this.templatedBody.getTemplatedRowElement(o);this.templatedHeader.getTemplatedRowElement(p);o.attr(l,""),s.attr("ng-click","toggleItemSelection(gridItem, $event)"),s.attr("ng-repeat","gridDisplayItem in filteredItems"),s.attr("ng-init","gridItem=gridDisplayItem.$$_gridItem"),s.attr("ng-class","{'"+n.rowSelectedCssClass+"':gridOptions.selectedItems.indexOf(gridItem)>=0}"),p.replaceWith(this.$compile(p)(e)),w.replaceWith(this.$compile(w)(e)),o.replaceWith(this.$compile(o)(e)),u&&this.$timeout(function(){return u.$destroy()})},f.prototype.computeFormattedItems=function(t){var i,l,r,o,u,a,c,s,h,e,f=t.gridOptions.items||[];for(n.debugMode&&this.log("formatting items of length "+f.length),i=t.formattedItems=t.formattedItems||[],t.gridOptions.onDataRequired?t.filteredItems=i:t.requiresReFilteringTrigger=!t.requiresReFilteringTrigger,l=t.gridOptions.gridColumnDefs,r=0;r<f.length;r++){for(o=f[r],a={gridItem:o};i.length>f.length&&(u=i[r]).$$_gridItem!==o;)i.splice(r,1);for(r<i.length?(u=i[r],u.$$_gridItem!==o&&(u={$$_gridItem:o},i[r]=u)):(u={$$_gridItem:o},i.push(u)),c=0;c<l.length;c++)try{s=l[c],h=s.fieldName,h&&(e=s.displayFormat,e?("."!=e[0]&&"|"!=e[0]&&(e=" | "+e),u[s.displayFieldName]=t.$eval("gridItem."+h+e,a)):u[s.displayFieldName]=t.$eval("gridItem."+h,a))}catch(v){n.debugMode&&this.log("Field evaluation failed for <"+h+"> with error "+v)}}i.length>f.length&&i.splice(f.length,i.length-f.length)},f.prototype.computeFilteredItems=function(t){if(t.filterByDisplayFields={},t.gridOptions.filterByFields)for(var i in t.gridOptions.filterByFields)t.filterByDisplayFields[this.getFormattedFieldName(i)]=t.gridOptions.filterByFields[i];n.debugMode&&this.log("filtering items of length "+(t.formattedItems?t.formattedItems.length:0)),t.filteredItems=t.$eval("formattedItems | filter:gridOptions.filterBy | filter:filterByDisplayFields | "+n.sortFilter+":gridOptions | "+n.dataPagingFilter+":gridOptions")},f.prototype.setupDisplayItemsArray=function(t){var r=this,i="[gridOptions.items,gridOptions.gridColumnDefs.length";angular.forEach(t.gridOptions.gridColumnDefs,function(n){if(n.displayFormat&&"."!=n.displayFormat[0]){var t=n.displayFormat.split("|");angular.forEach(t,function(n){var t=n.split(":");t.length>1&&angular.forEach(t.slice(1),function(n){n=n.trim(),n&&"gridItem"!==n&&"gridDisplayItem"!==n&&(i+=","+n)})})}}),i+="]",n.debugMode&&this.log("re-formatting is set to watch for changes in "+i),t.$watch(i,function(){return r.computeFormattedItems(t)},!0),t.gridOptions.onDataRequired||(i="[requiresReFilteringTrigger, gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.currentPage, gridOptions.pageItems]",t.$watch(i,function(){r.computeFilteredItems(t)},!0))},f.prototype.linkAttrs=function(n,t){var r=function(n,i){if("undefined"!=typeof i){switch(i){case"true":i=!0;break;case"false":i=!1}t[n]=i}};for(var i in t)r(i,n[i]),function(t){n.$observe(t,function(n){return r(t,n)})}(i)},f.prototype.linkScope=function(t,i,r,u){var f,s,h,o,c=this,e=t[r];for(f in e)if(s="undefined"!=typeof u[f]&&null!=u[f]){h=!1,"undefined"!=typeof i[f]&&null!=i[f]&&(e[f]=i[f],h=e[f]instanceof Array),o=null;try{o=this.$parse(u[f])}catch(l){}!function(u,f){f&&f.constant||i.$watch(u,function(n){e[u]=n});var o=f&&f.assign?f.assign:null;o&&t.$watch(r+"."+u,function(t){try{i[u]=t}catch(r){if(n.debugMode)throw c.log("Mirroring the property on the external scope failed with "+r),r}})}(f,o)}},f.prototype.log=function(n){console.log(t+"("+(new Date).getTime()+"): "+n)},f}();angular.module("trNgGrid",[]).directive(t,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",enableSelections:"=?",enableMultiRowSelections:"=?",selectionMode:"@",locale:"@",onDataRequired:"&",onDataRequiredDelay:"=?",fields:"=?"},template:function(t){t.addClass(n.tableCssClass),angular.forEach(t.children(),function(n){n=angular.element(n),n.attr("ng-non-bindable","")})},controller:["$compile","$parse","$timeout","$templateCache",et],compile:function(){return{pre:function(n,t,i,r){r.discoverTemplates(t)},post:function(n,t,i,r){var u=r.setupScope(n,t,i);u.speedUpAsyncDataRetrieval=function(n){return r.speedUpAsyncDataRetrieval(n)},r.configureTableStructure(u,t),r.setupDisplayItemsArray(u)}}}}}]).directive(y,[function(){var i=function(n){if(n.columnOptions.displayName)n.columnTitle=n.columnOptions.displayName;else if(n.columnOptions.fieldName){var t=n.columnOptions.fieldName.match(/^[^\.\[\]]*/);t=t[0].split(/(?=[A-Z])/),t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1)),n.columnTitle=t.join(" ")}else n.columnTitle="[Invalid Field Name]"};return{restrict:"A",require:"^"+t,scope:!0,compile:function(t,r){var u="true"==r.isCustomized;return h(t,r,u,it),{pre:function(t,r,f,e){var s=parseInt(f[y]),o=angular.extend(t.gridOptions.gridColumnDefs[s],n.defaultColumnOptions);e.linkAttrs(f,o),t.columnOptions=o,t.isCustomized=u,t.toggleSorting=function(n){e.toggleSorting(n)},i(t),t.$watch("columnOptions.filter",function(n,t){n!==t&&e.setFilter(o.fieldName,n)})}}}}}]).directive(p,[function(){return{restrict:"A",templateUrl:n.cellHeaderTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridBody",[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(){return{pre:function(n,t,i,r){n.toggleItemSelection=function(t,i){r.toggleItemSelection(n.filteredItems,t,i)}}}}}}]).directive(w,[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(n,t){var i="true"==t.isCustomized;return h(n,t,i,ut),{pre:function(n,t,r){n.columnOptions=n.gridOptions.gridColumnDefs[parseInt(r[w])],n.gridItem=n.gridDisplayItem.$$_gridItem,n.isCustomized=i}}}}}]).directive(b,[function(){return{restrict:"A",templateUrl:n.cellBodyTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridFooterCell",[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(n,t){var i="true"==t.isCustomized;return h(n,t,i,nt),{pre:function(n,t){n.isCustomized=i,t.attr("colspan",n.gridOptions.gridColumnDefs.length)}}}}}]).directive(v,[function(){return{restrict:"A",templateUrl:n.cellFooterTemplateId,transclude:!0,replace:!0}}]).directive(o,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnSortTemplateId}}]).directive(s,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnFilterTemplateId}}]).directive(f,[function(){return{restrict:"A",scope:!1,templateUrl:n.footerGlobalFilterTemplateId}}]).directive(e,[function(){var i=function(t){var f,i;if(t.totalItemsCount="undefined"!=typeof t.gridOptions.totalItems&&null!=t.gridOptions.totalItems?t.gridOptions.totalItems:t.gridOptions.items?t.gridOptions.items.length:0,t.isPaged=!!t.gridOptions.pageItems&&t.gridOptions.pageItems<t.totalItemsCount,t.extendedControlsActive=!1,t.lastPageIndex=t.totalItemsCount&&t.isPaged?Math.floor(t.totalItemsCount/t.gridOptions.pageItems)+(t.totalItemsCount%t.gridOptions.pageItems?0:-1):0,t.gridOptions.currentPage>t.lastPageIndex&&(t.gridOptions.currentPage=t.lastPageIndex),t.startItemIndex=t.isPaged?t.gridOptions.pageItems*t.gridOptions.currentPage:0,t.endItemIndex=t.isPaged?t.startItemIndex+t.gridOptions.pageItems-1:t.totalItemsCount-1,t.endItemIndex>=t.totalItemsCount&&(t.endItemIndex=t.totalItemsCount-1),t.endItemIndex<t.startItemIndex&&(t.endItemIndex=t.startItemIndex),t.pageCanGoBack=t.isPaged&&t.gridOptions.currentPage>0,t.pageCanGoForward=t.isPaged&&t.gridOptions.currentPage<t.lastPageIndex,t.pageIndexes=t.pageIndexes||[],t.pageIndexes.splice(0),t.isPaged)if(t.lastPageIndex+1>n.defaultPagerMinifiedPageCountThreshold){t.extendedControlsActive=!0;var e=Math.floor(n.defaultPagerMinifiedPageCountThreshold/2),r=t.gridOptions.currentPage-e,u=t.gridOptions.currentPage+e;for(r<0?(u+=-r,r=0):u>t.lastPageIndex&&(r-=u-t.lastPageIndex,u=t.lastPageIndex),r>0&&(t.pageIndexes.push(null),r++),f=!1,u<t.lastPageIndex&&(f=!0,u--),i=r;i<=u;i++)t.pageIndexes.push(i);f&&t.pageIndexes.push(null)}else for(t.extendedControlsActive=!1,i=0;i<=t.lastPageIndex;i++)t.pageIndexes.push(i);t.pageSelectionActive=t.pageIndexes.length>1,t.navigateToPage=function(n){t.gridOptions.currentPage=n,t.speedUpAsyncDataRetrieval()},t.switchPageSelection=function(n,i){t.pageSelectionActive=i,n&&(n.preventDefault(),n.stopPropagation())}};return{restrict:"A",scope:!0,require:"^"+t,templateUrl:n.footerPagerTemplateId,replace:!0,compile:function(){return{pre:function(n,t,r,u){i(n,u)},post:function(n,t,r,u){n.$watchCollection("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(){i(n,u)})}}}}}]).filter(n.sortFilter,["$filter","$parse",function(n,t){return function(i,r){var u,f;if(!r.orderBy||!r.gridColumnDefs)return i;for(u=null,f=0;f<r.gridColumnDefs.length&&(u=r.gridColumnDefs[f]).fieldName!==r.orderBy;u=null,f++);return u?n("orderBy")(i,function(n){var i=void 0;try{i=t("item.$$_gridItem."+u.fieldName)({item:n})}catch(r){}if(void 0===i)try{i=t("item."+u.displayFieldName)({item:n})}catch(r){}return i},r.orderByReverse):i}}]).filter(n.dataPagingFilter,function(){return function(n,t){var i,r;return n&&(t.totalItems=n.length),t.pageItems&&n&&0!=n.length?(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r)):n}}).filter(n.translateFilter,["$filter",function(t){return function(i,r){var u,f,o,e,c,s,h;if(i instanceof Date)return f=t(n.translateFilter)(n.translationDateFormat,r),f&&f!==n.translationDateFormat?t("date")(i,f):i;if(!u)for(o=r.split(/[-_]/),e=o.length;e>0&&!u;e--)c=o.slice(0,e).join("-"),s=n.translations[c],s&&(u=s[i]);if(!u)try{h=t("translate"),h&&(u=h(i))}catch(l){}return u||(u=i),u}}]).run(function(){n.tableCssClass="tr-ng-grid table table-bordered table-hover",n.cellCssClass="tr-ng-cell",n.headerCellCssClass="tr-ng-column-header "+n.cellCssClass,n.bodyCellCssClass=n.cellCssClass,n.columnTitleCssClass="tr-ng-title",n.columnSortCssClass="tr-ng-sort",n.columnFilterCssClass="tr-ng-column-filter",n.columnFilterInputWrapperCssClass="",n.columnSortActiveCssClass="tr-ng-sort-active text-info",n.columnSortInactiveCssClass="tr-ng-sort-inactive text-muted glyphicon glyphicon-chevron-down",n.columnSortReverseOrderCssClass="tr-ng-sort-order-reverse glyphicon glyphicon-chevron-down",n.columnSortNormalOrderCssClass="tr-ng-sort-order-normal glyphicon glyphicon-chevron-up",n.rowSelectedCssClass="active",n.footerCssClass="tr-ng-grid-footer form-inline"}).run(function(){n.defaultColumnOptions.displayAlign="left",n.defaultPagerMinifiedPageCountThreshold=3})}(TrNgGrid||(TrNgGrid={})),function(window,angular,undefined){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=index<0?html:html.substring(0,index),html=index<0?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){return value?(hiddenPre.innerHTML=value.replace(/</g,"&lt;"),hiddenPre.textContent):""}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=makeMap("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use"),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"),svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan"),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs),hiddenPre=document.createElement("pre");
angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/i,MAILTO_REGEXP=/^mailto:/i;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),angular.module("ui.alias",[]).config(["$compileProvider","uiAliasConfig",function($compileProvider,uiAliasConfig){uiAliasConfig=uiAliasConfig||{},angular.forEach(uiAliasConfig,function(config,alias){angular.isString(config)&&(config={replace:!0,template:config}),$compileProvider.directive(alias,function(){return config})})}]),angular.module("ui.event",[]).directive("uiEvent",["$parse",function($parse){return function($scope,elm,attrs){var events=$scope.$eval(attrs.uiEvent);angular.forEach(events,function(uiEvent,eventName){var fn=$parse(uiEvent);elm.bind(eventName,function(evt){var params=Array.prototype.slice.call(arguments);params=params.splice(1),fn($scope,{$event:evt,$params:params}),$scope.$$phase||$scope.$apply()})})}}]),angular.module("ui.format",[]).filter("format",function(){return function(value,replace){var target=value;if(angular.isString(target)&&void 0!==replace)if(angular.isArray(replace)||angular.isObject(replace)||(replace=[replace]),angular.isArray(replace)){var rlen=replace.length,rfx=function(str,i){return i=parseInt(i,10),i>=0&&i<rlen?replace[i]:str};target=target.replace(/\$([0-9]+)/g,rfx)}else angular.forEach(replace,function(value,key){target=target.split(":"+key).join(value)});return target}}),angular.module("ui.highlight",[]).filter("highlight",function(){return function(text,search,caseSensitive){return search||angular.isNumber(search)?(text=text.toString(),search=search.toString(),caseSensitive?text.split(search).join('<span class="ui-match">'+search+"</span>"):text.replace(new RegExp(search,"gi"),'<span class="ui-match">$&</span>')):text}}),angular.module("ui.include",[]).directive("uiInclude",["$http","$templateCache","$anchorScroll","$compile",function($http,$templateCache,$anchorScroll,$compile){return{restrict:"ECA",terminal:!0,compile:function(element,attr){var srcExp=attr.uiInclude||attr.src,fragExp=attr.fragment||"",onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,element){function ngIncludeWatchAction(){var thisChangeId=++changeCounter,src=scope.$eval(srcExp),fragment=scope.$eval(fragExp);src?$http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){childScope&&childScope.$destroy(),childScope=scope.$new();var contents;contents=fragment?angular.element("<div/>").html(response).find(fragment):angular.element("<div/>").html(response).contents(),element.html(contents),$compile(contents)(childScope),!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll(),childScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&clearContent()}):clearContent()}var childScope,changeCounter=0,clearContent=function(){childScope&&(childScope.$destroy(),childScope=null),element.html("")};scope.$watch(fragExp,ngIncludeWatchAction),scope.$watch(srcExp,ngIncludeWatchAction)}}}}]),angular.module("ui.indeterminate",[]).directive("uiIndeterminate",[function(){return{compile:function(tElm,tAttrs){return tAttrs.type&&"checkbox"===tAttrs.type.toLowerCase()?function($scope,elm,attrs){$scope.$watch(attrs.uiIndeterminate,function(newVal){elm[0].indeterminate=!!newVal})}:angular.noop}}}]),angular.module("ui.inflector",[]).filter("inflector",function(){function ucwords(text){return text.replace(/^([a-z])|\s+([a-z])/g,function($1){return $1.toUpperCase()})}function breakup(text,separator){return text.replace(/[A-Z]/g,function(match){return separator+match})}var inflectors={humanize:function(value){return ucwords(breakup(value," ").split("_").join(" "))},underscore:function(value){return value.substr(0,1).toLowerCase()+breakup(value.substr(1),"_").toLowerCase().split(" ").join("_")},variable:function(value){return value=value.substr(0,1).toLowerCase()+ucwords(value.split("_").join(" ")).substr(1).split(" ").join("")}};return function(text,inflector){return inflector!==!1&&angular.isString(text)?(inflector=inflector||"humanize",inflectors[inflector](text)):text}}),angular.module("ui.jq",[]).value("uiJqConfig",{}).directive("uiJq",["uiJqConfig","$timeout",function(uiJqConfig,$timeout){return{restrict:"A",compile:function(tElm,tAttrs){if(!angular.isFunction(tElm[tAttrs.uiJq]))throw new Error('ui-jq: The "'+tAttrs.uiJq+'" function does not exist');var options=uiJqConfig&&uiJqConfig[tAttrs.uiJq];return function(scope,elm,attrs){function callPlugin(){$timeout(function(){elm[attrs.uiJq].apply(elm,linkOptions)},0,!1)}var linkOptions=[];attrs.uiOptions?(linkOptions=scope.$eval("["+attrs.uiOptions+"]"),angular.isObject(options)&&angular.isObject(linkOptions[0])&&(linkOptions[0]=angular.extend({},options,linkOptions[0]))):options&&(linkOptions=[options]),attrs.ngModel&&elm.is("select,input,textarea")&&elm.bind("change",function(){elm.trigger("input")}),attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(){callPlugin()}),callPlugin()}}}}]),angular.module("ui.keypress",[]).factory("keypressHelper",["$parse",function($parse){var keysByCode={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},capitaliseFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.slice(1)};return function(mode,scope,elm,attrs){var params,combinations=[];params=scope.$eval(attrs["ui"+capitaliseFirstLetter(mode)]),angular.forEach(params,function(v,k){var combination,expression;expression=$parse(v),angular.forEach(k.split(" "),function(variation){combination={expression:expression,keys:{}},angular.forEach(variation.split("-"),function(value){combination.keys[value]=!0}),combinations.push(combination)})}),elm.bind(mode,function(event){var metaPressed=!(!event.metaKey||event.ctrlKey),altPressed=!!event.altKey,ctrlPressed=!!event.ctrlKey,shiftPressed=!!event.shiftKey,keyCode=event.keyCode;"keypress"===mode&&!shiftPressed&&keyCode>=97&&keyCode<=122&&(keyCode-=32),angular.forEach(combinations,function(combination){var mainKeyPressed=combination.keys[keysByCode[keyCode]]||combination.keys[keyCode.toString()],metaRequired=!!combination.keys.meta,altRequired=!!combination.keys.alt,ctrlRequired=!!combination.keys.ctrl,shiftRequired=!!combination.keys.shift;mainKeyPressed&&metaRequired===metaPressed&&altRequired===altPressed&&ctrlRequired===ctrlPressed&&shiftRequired===shiftPressed&&scope.$apply(function(){combination.expression(scope,{$event:event})})})})}}]),angular.module("ui.keypress").directive("uiKeydown",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keydown",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeypress",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keypress",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeyup",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keyup",scope,elm,attrs)}}}]),angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/}}).directive("uiMask",["uiMaskConfig",function(maskConfig){return{priority:100,require:"ngModel",restrict:"A",compile:function(){var options=maskConfig;return function(scope,iElement,iAttrs,controller){function initialize(maskAttr){return angular.isDefined(maskAttr)?(processRawMask(maskAttr),maskProcessed?(initializeElement(),bindEventListeners(),!0):uninitialize()):uninitialize()}function initPlaceholder(placeholderAttr){angular.isDefined(placeholderAttr)&&(maskPlaceholder=placeholderAttr,maskProcessed&&eventHandler())}function formatter(fromModelValue){return maskProcessed?(value=unmaskValue(fromModelValue||""),isValid=validateValue(value),controller.$setValidity("mask",isValid),isValid&&value.length?maskValue(value):void 0):fromModelValue}function parser(fromViewValue){return maskProcessed?(value=unmaskValue(fromViewValue||""),isValid=validateValue(value),controller.$viewValue=value.length?maskValue(value):"",controller.$setValidity("mask",isValid),""===value&&void 0!==controller.$error.required&&controller.$setValidity("required",!1),isValid?value:void 0):fromViewValue}function uninitialize(){return maskProcessed=!1,unbindEventListeners(),angular.isDefined(originalPlaceholder)?iElement.attr("placeholder",originalPlaceholder):iElement.removeAttr("placeholder"),angular.isDefined(originalMaxlength)?iElement.attr("maxlength",originalMaxlength):iElement.removeAttr("maxlength"),iElement.val(controller.$modelValue),controller.$viewValue=controller.$modelValue,!1}function initializeElement(){value=oldValueUnmasked=unmaskValue(controller.$modelValue||""),valueMasked=oldValue=maskValue(value),isValid=validateValue(value);var viewValue=isValid&&value.length?valueMasked:"";iAttrs.maxlength&&iElement.attr("maxlength",2*maskCaretMap[maskCaretMap.length-1]),iElement.attr("placeholder",maskPlaceholder),iElement.val(viewValue),controller.$viewValue=viewValue}function bindEventListeners(){eventsBound||(iElement.bind("blur",blurHandler),iElement.bind("mousedown mouseup",mouseDownUpHandler),iElement.bind("input keyup click focus",eventHandler),eventsBound=!0)}function unbindEventListeners(){eventsBound&&(iElement.unbind("blur",blurHandler),iElement.unbind("mousedown",mouseDownUpHandler),iElement.unbind("mouseup",mouseDownUpHandler),iElement.unbind("input",eventHandler),iElement.unbind("keyup",eventHandler),iElement.unbind("click",eventHandler),iElement.unbind("focus",eventHandler),eventsBound=!1)}function validateValue(value){return!value.length||value.length>=minRequiredLength}function unmaskValue(value){var valueUnmasked="",maskPatternsCopy=maskPatterns.slice();return value=value.toString(),angular.forEach(maskComponents,function(component){value=value.replace(component,"")}),angular.forEach(value.split(""),function(chr){maskPatternsCopy.length&&maskPatternsCopy[0].test(chr)&&(valueUnmasked+=chr,maskPatternsCopy.shift())}),valueUnmasked}function maskValue(unmaskedValue){var valueMasked="",maskCaretMapCopy=maskCaretMap.slice();return angular.forEach(maskPlaceholder.split(""),function(chr,i){unmaskedValue.length&&i===maskCaretMapCopy[0]?(valueMasked+=unmaskedValue.charAt(0)||"_",unmaskedValue=unmaskedValue.substr(1),maskCaretMapCopy.shift()):valueMasked+=chr}),valueMasked}function getPlaceholderChar(i){var placeholder=iAttrs.placeholder;return"undefined"!=typeof placeholder&&placeholder[i]?placeholder[i]:"_"}function getMaskComponents(){return maskPlaceholder.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_")}function processRawMask(mask){var characterCount=0;if(maskCaretMap=[],maskPatterns=[],maskPlaceholder="","string"==typeof mask){minRequiredLength=0;var isOptional=!1,splitMask=mask.split("");angular.forEach(splitMask,function(chr,i){linkOptions.maskDefinitions[chr]?(maskCaretMap.push(characterCount),maskPlaceholder+=getPlaceholderChar(i),maskPatterns.push(linkOptions.maskDefinitions[chr]),characterCount++,isOptional||minRequiredLength++):"?"===chr?isOptional=!0:(maskPlaceholder+=chr,characterCount++)})}maskCaretMap.push(maskCaretMap.slice().pop()+1),maskComponents=getMaskComponents(),maskProcessed=maskCaretMap.length>1}function blurHandler(){oldCaretPosition=0,oldSelectionLength=0,isValid&&0!==value.length||(valueMasked="",iElement.val(""),scope.$apply(function(){controller.$setViewValue("")}))}function mouseDownUpHandler(e){"mousedown"===e.type?iElement.bind("mouseout",mouseoutHandler):iElement.unbind("mouseout",mouseoutHandler)}function mouseoutHandler(){oldSelectionLength=getSelectionLength(this),iElement.unbind("mouseout",mouseoutHandler)}function eventHandler(e){e=e||{};var eventWhich=e.which,eventType=e.type;if(16!==eventWhich&&91!==eventWhich){var valMasked,val=iElement.val(),valOld=oldValue,valUnmasked=unmaskValue(val),valUnmaskedOld=oldValueUnmasked,valAltered=!1,caretPos=getCaretPosition(this)||0,caretPosOld=oldCaretPosition||0,caretPosDelta=caretPos-caretPosOld,caretPosMin=maskCaretMap[0],caretPosMax=maskCaretMap[valUnmasked.length]||maskCaretMap.slice().shift(),selectionLenOld=oldSelectionLength||0,isSelected=getSelectionLength(this)>0,wasSelected=selectionLenOld>0,isAddition=val.length>valOld.length||selectionLenOld&&val.length>valOld.length-selectionLenOld,isDeletion=val.length<valOld.length||selectionLenOld&&val.length===valOld.length-selectionLenOld,isSelection=eventWhich>=37&&eventWhich<=40&&e.shiftKey,isKeyLeftArrow=37===eventWhich,isKeyBackspace=8===eventWhich||"keyup"!==eventType&&isDeletion&&caretPosDelta===-1,isKeyDelete=46===eventWhich||"keyup"!==eventType&&isDeletion&&0===caretPosDelta&&!wasSelected,caretBumpBack=(isKeyLeftArrow||isKeyBackspace||"click"===eventType)&&caretPos>caretPosMin;if(oldSelectionLength=getSelectionLength(this),!isSelection&&(!isSelected||"click"!==eventType&&"keyup"!==eventType)){if("input"===eventType&&isDeletion&&!wasSelected&&valUnmasked===valUnmaskedOld){for(;isKeyBackspace&&caretPos>caretPosMin&&!isValidCaretPosition(caretPos);)caretPos--;for(;isKeyDelete&&caretPos<caretPosMax&&maskCaretMap.indexOf(caretPos)===-1;)caretPos++;var charIndex=maskCaretMap.indexOf(caretPos);valUnmasked=valUnmasked.substring(0,charIndex)+valUnmasked.substring(charIndex+1),valAltered=!0}for(valMasked=maskValue(valUnmasked),oldValue=valMasked,oldValueUnmasked=valUnmasked,iElement.val(valMasked),valAltered&&scope.$apply(function(){controller.$setViewValue(valUnmasked)}),isAddition&&caretPos<=caretPosMin&&(caretPos=caretPosMin+1),caretBumpBack&&caretPos--,caretPos=caretPos>caretPosMax?caretPosMax:caretPos<caretPosMin?caretPosMin:caretPos;!isValidCaretPosition(caretPos)&&caretPos>caretPosMin&&caretPos<caretPosMax;)caretPos+=caretBumpBack?-1:1;(caretBumpBack&&caretPos<caretPosMax||isAddition&&!isValidCaretPosition(caretPosOld))&&caretPos++,oldCaretPosition=caretPos,setCaretPosition(this,caretPos)}}}function isValidCaretPosition(pos){return maskCaretMap.indexOf(pos)>-1}function getCaretPosition(input){if(!input)return 0;if(void 0!==input.selectionStart)return input.selectionStart;if(document.selection){input.focus();var selection=document.selection.createRange();return selection.moveStart("character",-input.value.length),selection.text.length}return 0}function setCaretPosition(input,pos){if(!input)return 0;if(0!==input.offsetWidth&&0!==input.offsetHeight)if(input.setSelectionRange)input.focus(),input.setSelectionRange(pos,pos);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getSelectionLength(input){return input?void 0!==input.selectionStart?input.selectionEnd-input.selectionStart:document.selection?document.selection.createRange().text.length:0:0}var maskCaretMap,maskPatterns,maskPlaceholder,maskComponents,minRequiredLength,value,valueMasked,isValid,oldValue,oldValueUnmasked,oldCaretPosition,oldSelectionLength,maskProcessed=!1,eventsBound=!1,originalPlaceholder=iAttrs.placeholder,originalMaxlength=iAttrs.maxlength,linkOptions={};iAttrs.uiOptions?(linkOptions=scope.$eval("["+iAttrs.uiOptions+"]"),angular.isObject(linkOptions[0])&&(linkOptions=function(original,current){for(var i in original)Object.prototype.hasOwnProperty.call(original,i)&&(current[i]?angular.extend(current[i],original[i]):current[i]=angular.copy(original[i]));return current}(options,linkOptions[0]))):linkOptions=options,iAttrs.$observe("uiMask",initialize),iAttrs.$observe("placeholder",initPlaceholder),controller.$formatters.push(formatter),controller.$parsers.push(parser),iElement.bind("mousedown mouseup",mouseDownUpHandler),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1})}}}}]),angular.module("ui.reset",[]).value("uiResetConfig",null).directive("uiReset",["uiResetConfig",function(uiResetConfig){var resetValue=null;return void 0!==uiResetConfig&&(resetValue=uiResetConfig),{require:"ngModel",link:function(scope,elm,attrs,ctrl){var aElement;aElement=angular.element('<a class="ui-reset" />'),elm.wrap('<span class="ui-resetwrap" />').after(aElement),aElement.bind("click",function(e){e.preventDefault(),scope.$apply(function(){attrs.uiReset?ctrl.$setViewValue(scope.$eval(attrs.uiReset)):ctrl.$setViewValue(resetValue),ctrl.$render()})})}}}]),angular.module("ui.route",[]).directive("uiRoute",["$location","$parse",function($location,$parse){return{restrict:"AC",scope:!0,compile:function(tElement,tAttrs){var useProperty;if(tAttrs.uiRoute)useProperty="uiRoute";else if(tAttrs.ngHref)useProperty="ngHref";else{if(!tAttrs.href)throw new Error("uiRoute missing a route or href property on "+tElement[0]);useProperty="href"}return function($scope,elm,attrs){function staticWatcher(newVal){var hash=newVal.indexOf("#");hash>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){modelSetter($scope,$location.path().indexOf(newVal)>-1)})()}function regexWatcher(newVal){var hash=newVal.indexOf("#");hash>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){var regexp=new RegExp("^"+newVal+"$",["i"]);modelSetter($scope,regexp.test($location.path()))})()}var modelSetter=$parse(attrs.ngModel||attrs.routeModel||"$uiRoute").assign,watcher=angular.noop;switch(useProperty){case"uiRoute":attrs.uiRoute?regexWatcher(attrs.uiRoute):attrs.$observe("uiRoute",regexWatcher);break;case"ngHref":attrs.ngHref?staticWatcher(attrs.ngHref):attrs.$observe("ngHref",staticWatcher);break;case"href":staticWatcher(attrs.href)}$scope.$on("$routeChangeSuccess",function(){watcher()}),$scope.$on("$stateChangeSuccess",function(){watcher()})}}}}]),angular.module("ui.scroll.jqlite",["ui.scroll"]).service("jqLiteExtras",["$log","$window",function(console,window){return{registerFor:function(element){var convertToPx,css,getMeasurements,getStyle,getWidthHeight,isWindow,scrollTo;return css=angular.element.prototype.css,element.prototype.css=function(name,value){var elem,self;if(self=this,elem=self[0],elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style)return css.call(self,name,value)},isWindow=function(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval},scrollTo=function(self,direction,value){var elem,method,preserve,prop,_ref;return elem=self[0],_ref={top:["scrollTop","pageYOffset","scrollLeft"],left:["scrollLeft","pageXOffset","scrollTop"]}[direction],method=_ref[0],prop=_ref[1],preserve=_ref[2],isWindow(elem)?angular.isDefined(value)?elem.scrollTo(self[preserve].call(self),value):prop in elem?elem[prop]:elem.document.documentElement[method]:angular.isDefined(value)?elem[method]=value:elem[method]},window.getComputedStyle?(getStyle=function(elem){return window.getComputedStyle(elem,null)},convertToPx=function(elem,value){return parseFloat(value)}):(getStyle=function(elem){return elem.currentStyle},convertToPx=function(elem,value){var core_pnum,left,result,rnumnonpx,rs,rsLeft,style;return core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rnumnonpx.test(value)?(style=elem.style,left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rs&&(rs.left=style.left),style.left=value,result=style.pixelLeft,style.left=left,rsLeft&&(rs.left=rsLeft),result):parseFloat(value)}),getMeasurements=function(elem,measure){var base,borderA,borderB,computedMarginA,computedMarginB,computedStyle,dirA,dirB,marginA,marginB,paddingA,paddingB,_ref;return isWindow(elem)?(base=document.documentElement[{height:"clientHeight",width:"clientWidth"}[measure]],{base:base,padding:0,border:0,margin:0}):(_ref={width:[elem.offsetWidth,"Left","Right"],height:[elem.offsetHeight,"Top","Bottom"]}[measure],base=_ref[0],dirA=_ref[1],dirB=_ref[2],computedStyle=getStyle(elem),paddingA=convertToPx(elem,computedStyle["padding"+dirA])||0,paddingB=convertToPx(elem,computedStyle["padding"+dirB])||0,borderA=convertToPx(elem,computedStyle["border"+dirA+"Width"])||0,borderB=convertToPx(elem,computedStyle["border"+dirB+"Width"])||0,computedMarginA=computedStyle["margin"+dirA],computedMarginB=computedStyle["margin"+dirB],marginA=convertToPx(elem,computedMarginA)||0,marginB=convertToPx(elem,computedMarginB)||0,{base:base,padding:paddingA+paddingB,border:borderA+borderB,margin:marginA+marginB})},getWidthHeight=function(elem,direction,measure){var computedStyle,measurements,result;return measurements=getMeasurements(elem,direction),measurements.base>0?{base:measurements.base-measurements.padding-measurements.border,outer:measurements.base,outerfull:measurements.base+measurements.margin}[measure]:(computedStyle=getStyle(elem),result=computedStyle[direction],(result<0||null===result)&&(result=elem.style[direction]||0),result=parseFloat(result)||0,{base:result-measurements.padding-measurements.border,outer:result,outerfull:result+measurements.padding+measurements.border+measurements.margin}[measure])},angular.forEach({before:function(newElem){var children,elem,i,parent,self,_i,_ref;if(self=this,elem=self[0],parent=self.parent(),children=parent.contents(),children[0]===elem)return parent.prepend(newElem);for(i=_i=1,_ref=children.length-1;1<=_ref?_i<=_ref:_i>=_ref;i=1<=_ref?++_i:--_i)if(children[i]===elem)return void angular.element(children[i-1]).after(newElem);throw new Error("invalid DOM structure "+elem.outerHTML)},height:function(value){var self;return self=this,angular.isDefined(value)?(angular.isNumber(value)&&(value+="px"),css.call(self,"height",value)):getWidthHeight(this[0],"height","base")},outerHeight:function(option){return getWidthHeight(this[0],"height",option?"outerfull":"outer")},offset:function(value){var box,doc,docElem,elem,self,win;return self=this,arguments.length?void 0===value?self:value:(box={top:0,left:0},elem=self[0],(doc=elem&&elem.ownerDocument)?(docElem=doc.documentElement,elem.getBoundingClientRect&&(box=elem.getBoundingClientRect()),win=doc.defaultView||doc.parentWindow,{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):void 0)},scrollTop:function(value){return scrollTo(this,"top",value)},scrollLeft:function(value){return scrollTo(this,"left",value)}},function(value,key){if(!element.prototype[key])return element.prototype[key]=value})}}}]).run(["$log","$window","jqLiteExtras",function(console,window,jqLiteExtras){if(!window.jQuery)return jqLiteExtras.registerFor(angular.element)}]),angular.module("ui.scroll",[]).directive("ngScrollViewport",["$log",function(){return{controller:["$scope","$element",function(scope,element){return element}]}}]).directive("ngScroll",["$log","$injector","$rootScope","$timeout",function(console,$injector,$rootScope,$timeout){return{require:["?^ngScrollViewport"],transclude:"element",priority:1e3,terminal:!0,compile:function(element,attr,linker){return function($scope,$element,$attr,controllers){var adapter,adjustBuffer,adjustRowHeight,bof,bottomVisiblePos,buffer,bufferPadding,bufferSize,clipBottom,clipTop,datasource,datasourceName,enqueueFetch,eof,eventListener,fetch,finalize,first,insert,isDatasource,isLoading,itemName,loading,match,next,pending,reload,removeFromBuffer,resizeHandler,scrollHandler,scrollHeight,shouldLoadBottom,shouldLoadTop,tempScope,topVisiblePos,viewport;if(match=$attr.ngScroll.match(/^\s*(\w+)\s+in\s+(\w+)\s*$/),!match)throw new Error('Expected ngScroll in form of "item_ in _datasource_" but got "'+$attr.ngScroll+'"');if(itemName=match[1],datasourceName=match[2],isDatasource=function(datasource){return angular.isObject(datasource)&&datasource.get&&angular.isFunction(datasource.get)},datasource=$scope[datasourceName],!isDatasource(datasource)&&(datasource=$injector.get(datasourceName),!isDatasource(datasource)))throw new Error(datasourceName+" is not a valid datasource");return bufferSize=Math.max(3,+$attr.bufferSize||10),bufferPadding=function(){return viewport.height()*Math.max(.1,+$attr.padding||.1)},scrollHeight=function(elem){return elem[0].scrollHeight||elem[0].document.documentElement.scrollHeight},adapter=null,linker(tempScope=$scope.$new(),function(template){var bottomPadding,createPadding,padding,repeaterType,topPadding,viewport;if(repeaterType=template[0].localName,"dl"===repeaterType)throw new Error("ng-scroll directive does not support <"+template[0].localName+"> as a repeating tag: "+template[0].outerHTML);return"li"!==repeaterType&&"tr"!==repeaterType&&(repeaterType="div"),viewport=controllers[0]||angular.element(window),viewport.css({"overflow-y":"auto",display:"block"}),padding=function(repeaterType){var div,result,table;switch(repeaterType){case"tr":return table=angular.element("<table><tr><td><div></div></td></tr></table>"),div=table.find("div"),result=table.find("tr"),result.paddingHeight=function(){return div.height.apply(div,arguments)},result;default:return result=angular.element("<"+repeaterType+"></"+repeaterType+">"),result.paddingHeight=result.height,result}},createPadding=function(padding,element,direction){return element[{top:"before",bottom:"after"}[direction]](padding),{paddingHeight:function(){return padding.paddingHeight.apply(padding,arguments)},insert:function(element){return padding[{top:"after",bottom:"before"}[direction]](element)}}},topPadding=createPadding(padding(repeaterType),element,"top"),bottomPadding=createPadding(padding(repeaterType),element,"bottom"),tempScope.$destroy(),adapter={viewport:viewport,topPadding:topPadding.paddingHeight,bottomPadding:bottomPadding.paddingHeight,append:bottomPadding.insert,prepend:topPadding.insert,bottomDataPos:function(){return scrollHeight(viewport)-bottomPadding.paddingHeight()},topDataPos:function(){return topPadding.paddingHeight()}}}),viewport=adapter.viewport,first=1,next=1,buffer=[],pending=[],eof=!1,bof=!1,loading=datasource.loading||function(){},isLoading=!1,removeFromBuffer=function(start,stop){var i,_i;for(i=_i=start;start<=stop?_i<stop:_i>stop;i=start<=stop?++_i:--_i)buffer[i].scope.$destroy(),buffer[i].element.remove();return buffer.splice(start,stop-start)},reload=function(){return first=1,next=1,removeFromBuffer(0,buffer.length),adapter.topPadding(0),adapter.bottomPadding(0),pending=[],eof=!1,bof=!1,adjustBuffer(!1)},bottomVisiblePos=function(){return viewport.scrollTop()+viewport.height()},topVisiblePos=function(){return viewport.scrollTop()},shouldLoadBottom=function(){return!eof&&adapter.bottomDataPos()<bottomVisiblePos()+bufferPadding()},clipBottom=function(){var bottomHeight,i,itemHeight,overage,_i,_ref;for(bottomHeight=0,overage=0,i=_i=_ref=buffer.length-1;(_ref<=0?_i<=0:_i>=0)&&(itemHeight=buffer[i].element.outerHeight(!0),adapter.bottomDataPos()-bottomHeight-itemHeight>bottomVisiblePos()+bufferPadding());i=_ref<=0?++_i:--_i)bottomHeight+=itemHeight,overage++,eof=!1;if(overage>0)return adapter.bottomPadding(adapter.bottomPadding()+bottomHeight),removeFromBuffer(buffer.length-overage,buffer.length),next-=overage,console.log("clipped off bottom "+overage+" bottom padding "+adapter.bottomPadding())},shouldLoadTop=function(){return!bof&&adapter.topDataPos()>topVisiblePos()-bufferPadding()},clipTop=function(){var item,itemHeight,overage,topHeight,_i,_len;for(topHeight=0,overage=0,_i=0,_len=buffer.length;_i<_len&&(item=buffer[_i],itemHeight=item.element.outerHeight(!0),adapter.topDataPos()+topHeight+itemHeight<topVisiblePos()-bufferPadding());_i++)topHeight+=itemHeight,overage++,bof=!1;if(overage>0)return adapter.topPadding(adapter.topPadding()+topHeight),removeFromBuffer(0,overage),first+=overage,console.log("clipped off top "+overage+" top padding "+adapter.topPadding())},enqueueFetch=function(direction,scrolling){if(isLoading||(isLoading=!0,loading(!0)),1===pending.push(direction))return fetch(scrolling)},insert=function(index,item){var itemScope,toBeAppended,wrapper;return itemScope=$scope.$new(),itemScope[itemName]=item,toBeAppended=index>first,itemScope.$index=index,toBeAppended&&itemScope.$index--,wrapper={scope:itemScope},linker(itemScope,function(clone){return wrapper.element=clone,toBeAppended?index===next?(adapter.append(clone),buffer.push(wrapper)):(buffer[index-first].element.after(clone),buffer.splice(index-first+1,0,wrapper)):(adapter.prepend(clone),buffer.unshift(wrapper))}),{appended:toBeAppended,wrapper:wrapper}},adjustRowHeight=function(appended,wrapper){var newHeight;return appended?adapter.bottomPadding(Math.max(0,adapter.bottomPadding()-wrapper.element.outerHeight(!0))):(newHeight=adapter.topPadding()-wrapper.element.outerHeight(!0),newHeight>=0?adapter.topPadding(newHeight):viewport.scrollTop(viewport.scrollTop()+wrapper.element.outerHeight(!0)))},adjustBuffer=function(scrolling,newItems,finalize){var doAdjustment;return doAdjustment=function(){if(console.log("top {actual="+adapter.topDataPos()+" visible from="+topVisiblePos()+" bottom {visible through="+bottomVisiblePos()+" actual="+adapter.bottomDataPos()+"}"),shouldLoadBottom()?enqueueFetch(!0,scrolling):shouldLoadTop()&&enqueueFetch(!1,scrolling),finalize)return finalize()},newItems?$timeout(function(){var row,_i,_len;for(_i=0,_len=newItems.length;_i<_len;_i++)row=newItems[_i],adjustRowHeight(row.appended,row.wrapper);return doAdjustment()}):doAdjustment()},finalize=function(scrolling,newItems){return adjustBuffer(scrolling,newItems,function(){return pending.shift(),0===pending.length?(isLoading=!1,loading(!1)):fetch(scrolling)})},fetch=function(scrolling){var direction;return direction=pending[0],direction?buffer.length&&!shouldLoadBottom()?finalize(scrolling):datasource.get(next,bufferSize,function(result){var item,newItems,_i,_len;if(newItems=[],0===result.length)eof=!0,adapter.bottomPadding(0),console.log("appended: requested "+bufferSize+" records starting from "+next+" recieved: eof");else{for(clipTop(),_i=0,_len=result.length;_i<_len;_i++)item=result[_i],newItems.push(insert(++next,item));console.log("appended: requested "+bufferSize+" received "+result.length+" buffer size "+buffer.length+" first "+first+" next "+next)}return finalize(scrolling,newItems)}):buffer.length&&!shouldLoadTop()?finalize(scrolling):datasource.get(first-bufferSize,bufferSize,function(result){var i,newItems,_i,_ref;if(newItems=[],0===result.length)bof=!0,adapter.topPadding(0),console.log("prepended: requested "+bufferSize+" records starting from "+(first-bufferSize)+" recieved: bof");else{for(clipBottom(),i=_i=_ref=result.length-1;_ref<=0?_i<=0:_i>=0;i=_ref<=0?++_i:--_i)newItems.unshift(insert(--first,result[i]));console.log("prepended: requested "+bufferSize+" received "+result.length+" buffer size "+buffer.length+" first "+first+" next "+next)}return finalize(scrolling,newItems)})},resizeHandler=function(){if(!$rootScope.$$phase&&!isLoading)return adjustBuffer(!1),$scope.$apply()},viewport.bind("resize",resizeHandler),scrollHandler=function(){if(!$rootScope.$$phase&&!isLoading)return adjustBuffer(!0),$scope.$apply()},viewport.bind("scroll",scrollHandler),$scope.$watch(datasource.revision,function(){
return reload()}),eventListener=datasource.scope?datasource.scope.$new():$scope.$new(),$scope.$on("$destroy",function(){return eventListener.$destroy(),viewport.unbind("resize",resizeHandler),viewport.unbind("scroll",scrollHandler)}),eventListener.$on("update.items",function(event,locator,newItem){var wrapper,_fn,_i,_len,_ref;if(angular.isFunction(locator))for(_fn=function(wrapper){return locator(wrapper.scope)},_i=0,_len=buffer.length;_i<_len;_i++)wrapper=buffer[_i],_fn(wrapper);else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(buffer[locator-first-1].scope[itemName]=newItem);return null}),eventListener.$on("delete.items",function(event,locator){var i,item,temp,wrapper,_fn,_i,_j,_k,_len,_len1,_len2,_ref;if(angular.isFunction(locator)){for(temp=[],_i=0,_len=buffer.length;_i<_len;_i++)item=buffer[_i],temp.unshift(item);for(_fn=function(wrapper){if(locator(wrapper.scope))return removeFromBuffer(temp.length-1-i,temp.length-i),next--},i=_j=0,_len1=temp.length;_j<_len1;i=++_j)wrapper=temp[i],_fn(wrapper)}else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(removeFromBuffer(locator-first-1,locator-first),next--);for(i=_k=0,_len2=buffer.length;_k<_len2;i=++_k)item=buffer[i],item.scope.$index=first+i;return adjustBuffer(!1)}),eventListener.$on("insert.item",function(event,locator,item){var i,inserted,temp,wrapper,_fn,_i,_j,_k,_len,_len1,_len2,_ref;if(inserted=[],angular.isFunction(locator)){for(temp=[],_i=0,_len=buffer.length;_i<_len;_i++)item=buffer[_i],temp.unshift(item);for(_fn=function(wrapper){var j,newItems,_k,_len2,_results;if(newItems=locator(wrapper.scope)){if(insert=function(index,newItem){return insert(index,newItem),next++},angular.isArray(newItems)){for(_results=[],j=_k=0,_len2=newItems.length;_k<_len2;j=++_k)item=newItems[j],_results.push(inserted.push(insert(i+j,item)));return _results}return inserted.push(insert(i,newItems))}},i=_j=0,_len1=temp.length;_j<_len1;i=++_j)wrapper=temp[i],_fn(wrapper)}else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(inserted.push(insert(locator,item)),next++);for(i=_k=0,_len2=buffer.length;_k<_len2;i=++_k)item=buffer[i],item.scope.$index=first+i;return adjustBuffer(!1,inserted)})}}}}]),angular.module("ui.scrollfix",[]).directive("uiScrollfix",["$window",function($window){return{require:"^?uiScrollfixTarget",link:function(scope,elm,attrs,uiScrollfixTarget){function onScroll(){var offset;if(angular.isDefined($window.pageYOffset))offset=$window.pageYOffset;else{var iebody=document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body;offset=iebody.scrollTop}!elm.hasClass("ui-scrollfix")&&offset>attrs.uiScrollfix?elm.addClass("ui-scrollfix"):elm.hasClass("ui-scrollfix")&&offset<attrs.uiScrollfix&&elm.removeClass("ui-scrollfix")}var top=elm[0].offsetTop,$target=uiScrollfixTarget&&uiScrollfixTarget.$element||angular.element($window);attrs.uiScrollfix?"string"==typeof attrs.uiScrollfix&&("-"===attrs.uiScrollfix.charAt(0)?attrs.uiScrollfix=top-parseFloat(attrs.uiScrollfix.substr(1)):"+"===attrs.uiScrollfix.charAt(0)&&(attrs.uiScrollfix=top+parseFloat(attrs.uiScrollfix.substr(1)))):attrs.uiScrollfix=top,$target.on("scroll",onScroll),scope.$on("$destroy",function(){$target.off("scroll",onScroll)})}}}]).directive("uiScrollfixTarget",[function(){return{controller:["$element",function($element){this.$element=$element}]}}]),angular.module("ui.showhide",[]).directive("uiShow",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiShow,function(newVal){newVal?elm.addClass("ui-show"):elm.removeClass("ui-show")})}}]).directive("uiHide",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiHide,function(newVal){newVal?elm.addClass("ui-hide"):elm.removeClass("ui-hide")})}}]).directive("uiToggle",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiToggle,function(newVal){newVal?elm.removeClass("ui-hide").addClass("ui-show"):elm.removeClass("ui-show").addClass("ui-hide")})}}]),angular.module("ui.unique",[]).filter("unique",["$parse",function($parse){return function(items,filterOn){if(filterOn===!1)return items;if((filterOn||angular.isUndefined(filterOn))&&angular.isArray(items)){var newItems=[],get=angular.isString(filterOn)?$parse(filterOn):function(item){return item},extractValueToCompare=function(item){return angular.isObject(item)?get(item):item};angular.forEach(items,function(item){for(var isDuplicate=!1,i=0;i<newItems.length;i++)if(angular.equals(extractValueToCompare(newItems[i]),extractValueToCompare(item))){isDuplicate=!0;break}isDuplicate||newItems.push(item)}),items=newItems}return items}}]),angular.module("ui.validate",[]).directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){function apply_watch(watch){return angular.isString(watch)?void scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})}):angular.isArray(watch)?void angular.forEach(watch,function(expression){scope.$watch(expression,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})})}):void(angular.isObject(watch)&&angular.forEach(watch,function(expression,validatorKey){angular.isString(expression)&&scope.$watch(expression,function(){validators[validatorKey](ctrl.$modelValue)}),angular.isArray(expression)&&angular.forEach(expression,function(intExpression){scope.$watch(intExpression,function(){validators[validatorKey](ctrl.$modelValue)})})}))}var validateFn,validators={},validateExpr=scope.$eval(attrs.uiValidate);validateExpr&&(angular.isString(validateExpr)&&(validateExpr={validator:validateExpr}),angular.forEach(validateExpr,function(exprssn,key){validateFn=function(valueToValidate){var expression=scope.$eval(exprssn,{$value:valueToValidate});return angular.isObject(expression)&&angular.isFunction(expression.then)?(expression.then(function(){ctrl.$setValidity(key,!0)},function(){ctrl.$setValidity(key,!1)}),valueToValidate):expression?(ctrl.$setValidity(key,!0),valueToValidate):(ctrl.$setValidity(key,!1),valueToValidate)},validators[key]=validateFn,ctrl.$formatters.push(validateFn),ctrl.$parsers.push(validateFn)}),attrs.uiValidateWatch&&apply_watch(scope.$eval(attrs.uiValidateWatch)))}}}),angular.module("ui.utils",["ui.event","ui.format","ui.highlight","ui.include","ui.indeterminate","ui.inflector","ui.jq","ui.keypress","ui.mask","ui.reset","ui.route","ui.scrollfix","ui.scroll","ui.scroll.jqlite","ui.showhide","ui.unique","ui.validate"]),function(window,angular,undefined){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;i<ii&&obj!==undefined;i++){var key=keys[i];obj=null!==obj?obj[key]:undefined}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;angular.module("ngResource",["ng"]).provider("$resource",function(){var provider=this;this.defaults={stripTrailingSlashes:!0,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}},this.$get=["$http","$q",function($http,$q){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=extend({},provider.defaults,defaults),this.urlParams={}}function resourceFactory(url,paramDefaults,actions,options){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url,options);return actions=extend({},provider.defaults.actions,actions),Resource.prototype.toJSON=function(){var data=extend({},this);return delete data.$promise,delete data.$resolved,data},forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){"params"!=key&&"isArray"!=key&&"interceptor"!=key&&(httpConfig[key]=copy(value))}),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2}",name,action.isArray?"array":"object",angular.isArray(data)?"array":"object");action.isArray?(value.length=0,forEach(data,function(item){"object"==typeof item?value.push(new Resource(item)):value.push(item)})):(shallowClearAndCopy(data,value),value.$promise=promise)}return value.$resolved=!0,response.resource=value,response},function(response){return value.$resolved=!0,(error||noop)(response),$q.reject(response)});return promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),self.defaults.stripTrailingSlashes&&(url=url.replace(/\/+$/,"")||"/"),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}]})}(window,window.angular),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function objectKeys(object){if(Object.keys)return Object.keys(object);var result=[];return forEach(object,function(val,key){result.push(key)}),result}function indexOf(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=from<0?Math.ceil(from):Math.floor(from),from<0&&(from+=len);from<len;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i]&&parents[i].params&&(parentParams=objectKeys(parents[i].params),parentParams.length))for(var j in parentParams)indexOf(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]]);return extend({},inherited,newParams)}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function pick(obj){var copy={},keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));return forEach(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy}function omit(obj){var copy={},keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var key in obj)indexOf(keys,key)==-1&&(copy[key]=obj[key]);return copy}function filter(collection,callback){var array=isArray(collection),result=array?[]:{};return forEach(collection,function(val,i){callback(val,i)&&(result[array?result.length:i]=val)}),result}function map(collection,callback){var result=isArray(collection)?[]:{};return forEach(collection,function(val,i){result[i]=callback(val,i)}),result}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,indexOf(cycle,key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var invocableKeys=objectKeys(invocables||{}),plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=result.$$promises||!0,delete result.$$inheritedValues,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$inheritedValues&&merge(values,omit(parent.$$inheritedValues,invocableKeys)),extend(promises,parent.$$promises),parent.$$values?(merged=merge(values,omit(parent.$$values,invocableKeys)),result.$$inheritedValues=omit(parent.$$values,invocableKeys),done()):(parent.$$inheritedValues&&(result.$$inheritedValues=omit(parent.$$inheritedValues,invocableKeys)),parent.then(done,fail));for(var i=0,ii=plan.length;i<ii;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache,headers:{Accept:"text/html"}}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern,config,parentMatcher){function addParameter(id,type,config,location){if(paramNames.push(id),parentParams[id])return parentParams[id];if(!/^\w+([-.]+\w+)*(?:\[\])?$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(params[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");return params[id]=new $$UMFP.Param(id,type,config,location),params[id]}function quoteRegExp(string,pattern,squash,optional){var surroundPattern=["",""],result=string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!pattern)return result;switch(squash){case!1:surroundPattern=["(",")"+(optional?"?":"")];break;case!0:result=result.replace(/\/$/,""),surroundPattern=["(?:/(",")|/)?"];break;default:surroundPattern=["("+squash+"|",")?"]}return result+surroundPattern[0]+pattern+surroundPattern[1]}function matchDetails(m,isSearch){var id,regexp,segment,type,cfg;return id=m[2]||m[3],cfg=config.params[id],segment=pattern.substring(last,m.index),regexp=isSearch?m[4]:m[4]||("*"==m[1]?".*":null),regexp&&(type=$$UMFP.type(regexp)||inherit($$UMFP.type("string"),{pattern:new RegExp(regexp,config.caseInsensitive?"i":undefined)})),{id:id,regexp:regexp,segment:segment,type:type,cfg:cfg}}config=extend({params:{}},isObject(config)?config:{});var m,placeholder=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,searchPlaceholder=/([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,compiled="^",last=0,segments=this.segments=[],parentParams=parentMatcher?parentMatcher.params:{},params=this.params=parentMatcher?parentMatcher.params.$$new():new $$UMFP.ParamSet,paramNames=[];this.source=pattern;for(var p,param,segment;(m=placeholder.exec(pattern))&&(p=matchDetails(m,!1),!(p.segment.indexOf("?")>=0));)param=addParameter(p.id,p.type,p.cfg,"path"),compiled+=quoteRegExp(p.segment,param.type.pattern.source,param.squash,param.isOptional),segments.push(p.segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);if(segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),search.length>0)for(last=0;m=searchPlaceholder.exec(search);)p=matchDetails(m,!0),param=addParameter(p.id,p.type,p.cfg,"search"),last=placeholder.lastIndex}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+(config.strict===!1?"/?":"")+"$",segments.push(segment),this.regexp=new RegExp(compiled,config.caseInsensitive?"i":undefined),this.prefix=segments[0],this.$$paramNames=paramNames}function Type(config){extend(this,config)}function $UrlMatcherFactory(){function valToString(val){return null!=val?val.toString().replace(/~/g,"~~").replace(/\//g,"~2F"):val}function valFromString(val){return null!=val?val.toString().replace(/~2F/g,"/").replace(/~~/g,"~"):val}function getDefaultConfig(){return{strict:isStrictMode,caseInsensitive:isCaseInsensitive}}function isInjectable(value){return isFunction(value)||isArray(value)&&isFunction(value[value.length-1])}function flushTypeQueue(){for(;typeQueue.length;){var type=typeQueue.shift();if(type.pattern)throw new Error("You cannot override a type's .pattern at runtime.");angular.extend($types[type.name],injector.invoke(type.def))}}function ParamSet(params){extend(this,params||{})}$$UMFP=this;var injector,isCaseInsensitive=!1,isStrictMode=!0,defaultSquashPolicy=!1,$types={},enqueue=!0,typeQueue=[],defaultTypes={string:{encode:valToString,decode:valFromString,is:function(val){return null==val||!isDefined(val)||"string"==typeof val},pattern:/[^\/]*/},"int":{encode:valToString,decode:function(val){return parseInt(val,10)},is:function(val){return isDefined(val)&&this.decode(val.toString())===val},pattern:/\d+/},bool:{encode:function(val){return val?1:0},decode:function(val){return 0!==parseInt(val,10)},is:function(val){return val===!0||val===!1},pattern:/0|1/},date:{encode:function(val){return this.is(val)?[val.getFullYear(),("0"+(val.getMonth()+1)).slice(-2),("0"+val.getDate()).slice(-2)].join("-"):undefined},decode:function(val){if(this.is(val))return val;var match=this.capture.exec(val);return match?new Date(match[1],match[2]-1,match[3]):undefined},is:function(val){return val instanceof Date&&!isNaN(val.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^\/]*/},any:{encode:angular.identity,decode:angular.identity,equals:angular.equals,pattern:/.*/}};$UrlMatcherFactory.$$getDefaultValue=function(config){if(!isInjectable(config.value))return config.value;if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.value)},this.caseInsensitive=function(value){return isDefined(value)&&(isCaseInsensitive=value),isCaseInsensitive},this.strictMode=function(value){return isDefined(value)&&(isStrictMode=value),isStrictMode},this.defaultSquashPolicy=function(value){if(!isDefined(value))return defaultSquashPolicy;if(value!==!0&&value!==!1&&!isString(value))throw new Error("Invalid squash policy: "+value+". Valid policies: false, true, arbitrary-string");return defaultSquashPolicy=value,value},this.compile=function(pattern,config){return new UrlMatcher(pattern,extend(getDefaultConfig(),config))},this.isMatcher=function(o){if(!isObject(o))return!1;var result=!0;return forEach(UrlMatcher.prototype,function(val,name){isFunction(val)&&(result=result&&isDefined(o[name])&&isFunction(o[name]))}),result},this.type=function(name,definition,definitionFn){if(!isDefined(definition))return $types[name];if($types.hasOwnProperty(name))throw new Error("A type named '"+name+"' has already been defined.");return $types[name]=new Type(extend({name:name},definition)),definitionFn&&(typeQueue.push({name:name,def:definitionFn}),enqueue||flushTypeQueue()),this},forEach(defaultTypes,function(type,name){$types[name]=new Type(extend({name:name},type))}),$types=inherit($types,{}),this.$get=["$injector",function($injector){return injector=$injector,enqueue=!1,flushTypeQueue(),forEach(defaultTypes,function(type,name){$types[name]||($types[name]=new Type(type))}),this}],this.Param=function(id,type,config,location){function unwrapShorthand(config){var keys=isObject(config)?objectKeys(config):[],isShorthand=indexOf(keys,"value")===-1&&indexOf(keys,"type")===-1&&indexOf(keys,"squash")===-1&&indexOf(keys,"array")===-1;return isShorthand&&(config={value:config}),config.$$fn=isInjectable(config.value)?config.value:function(){return config.value},config}function getType(config,urlType,location){if(config.type&&urlType)throw new Error("Param '"+id+"' has two type configurations.");return urlType?urlType:config.type?angular.isString(config.type)?$types[config.type]:config.type instanceof Type?config.type:new Type(config.type):"config"===location?$types.any:$types.string}function getArrayMode(){var arrayDefaults={array:"search"===location&&"auto"},arrayParamNomenclature=id.match(/\[\]$/)?{array:!0}:{};return extend(arrayDefaults,arrayParamNomenclature,config).array}function getSquashPolicy(config,isOptional){var squash=config.squash;if(!isOptional||squash===!1)return!1;if(!isDefined(squash)||null==squash)return defaultSquashPolicy;if(squash===!0||isString(squash))return squash;throw new Error("Invalid squash policy: '"+squash+"'. Valid policies: false, true, or arbitrary string")}function getReplace(config,arrayMode,isOptional,squash){var replace,configuredKeys,defaultPolicy=[{from:"",to:isOptional||arrayMode?undefined:""},{from:null,to:isOptional||arrayMode?undefined:""}];return replace=isArray(config.replace)?config.replace:[],isString(squash)&&replace.push({from:squash,to:undefined}),configuredKeys=map(replace,function(item){return item.from}),filter(defaultPolicy,function(item){return indexOf(configuredKeys,item.from)===-1}).concat(replace)}function $$getDefaultValue(){if(!injector)throw new Error("Injectable functions cannot be called at configuration time");var defaultValue=injector.invoke(config.$$fn);if(null!==defaultValue&&defaultValue!==undefined&&!self.type.is(defaultValue))throw new Error("Default value ("+defaultValue+") for parameter '"+self.id+"' is not an instance of Type ("+self.type.name+")");return defaultValue}function $value(value){function hasReplaceVal(val){return function(obj){return obj.from===val}}function $replace(value){var replacement=map(filter(self.replace,hasReplaceVal(value)),function(obj){return obj.to});return replacement.length?replacement[0]:value}return value=$replace(value),isDefined(value)?self.type.$normalize(value):$$getDefaultValue()}function toString(){return"{Param:"+id+" "+type+" squash: '"+squash+"' optional: "+isOptional+"}"}var self=this;config=unwrapShorthand(config),type=getType(config,type,location);var arrayMode=getArrayMode();type=arrayMode?type.$asArray(arrayMode,"search"===location):type,"string"!==type.name||arrayMode||"path"!==location||config.value!==undefined||(config.value="");var isOptional=config.value!==undefined,squash=getSquashPolicy(config,isOptional),replace=getReplace(config,arrayMode,isOptional,squash);extend(this,{id:id,type:type,location:location,array:arrayMode,squash:squash,replace:replace,isOptional:isOptional,value:$value,dynamic:undefined,config:config,toString:toString})},ParamSet.prototype={$$new:function(){return inherit(this,extend(new ParamSet,{$$parent:this}))},$$keys:function(){for(var keys=[],chain=[],parent=this,ignore=objectKeys(ParamSet.prototype);parent;)chain.push(parent),parent=parent.$$parent;return chain.reverse(),forEach(chain,function(paramset){forEach(objectKeys(paramset),function(key){indexOf(keys,key)===-1&&indexOf(ignore,key)===-1&&keys.push(key)})}),keys},$$values:function(paramValues){var values={},self=this;return forEach(self.$$keys(),function(key){values[key]=self[key].value(paramValues&&paramValues[key])}),values},$$equals:function(paramValues1,paramValues2){var equal=!0,self=this;return forEach(self.$$keys(),function(key){var left=paramValues1&&paramValues1[key],right=paramValues2&&paramValues2[key];self[key].type.equals(left,right)||(equal=!1)}),equal},$$validates:function(paramValues){var i,param,rawVal,normalized,encoded,keys=this.$$keys();for(i=0;i<keys.length&&(param=this[keys[i]],rawVal=paramValues[keys[i]],rawVal!==undefined&&null!==rawVal||!param.isOptional);i++){if(normalized=param.type.$normalize(rawVal),!param.type.is(normalized))return!1;if(encoded=param.type.encode(normalized),angular.isString(encoded)&&!param.type.pattern.exec(encoded))return!1}return!0},$$parent:undefined},this.ParamSet=ParamSet}function $UrlRouterProvider($locationProvider,$urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return!isDefined(result)||result}function $get($location,$rootScope,$injector,$browser,$sniffer){function appendBasePath(url,isHtml5,absolute){return"/"===baseHref?url:isHtml5?baseHref.slice(0,-1)+url:absolute?baseHref.slice(1)+url:url}function update(evt){function check(rule){var handled=rule($injector,$location);return!!handled&&(isString(handled)&&$location.replace().url(handled),!0)}if(!evt||!evt.defaultPrevented){lastPushedUrl&&$location.url()===lastPushedUrl;lastPushedUrl=undefined;var i,n=rules.length;for(i=0;i<n;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}function listen(){return listener=listener||$rootScope.$on("$locationChangeSuccess",update)}var lastPushedUrl,baseHref=$browser.baseHref(),location=$location.url();return interceptDeferred||listen(),{sync:function(){update()},listen:function(){return listen()},update:function(read){return read?void(location=$location.url()):void($location.url()!==location&&($location.url(location),$location.replace()))},push:function(urlMatcher,params,options){var url=urlMatcher.format(params||{});null!==url&&params&&params["#"]&&(url+="#"+params["#"]),$location.url(url),lastPushedUrl=options&&options.$$avoidResync?$location.url():undefined,options&&options.replace&&$location.replace()},href:function(urlMatcher,params,options){if(!urlMatcher.validates(params))return null;var isHtml5=$locationProvider.html5Mode();angular.isObject(isHtml5)&&(isHtml5=isHtml5.enabled),isHtml5=isHtml5&&$sniffer.history;var url=urlMatcher.format(params);if(options=options||{},isHtml5||null===url||(url="#"+$locationProvider.hashPrefix()+url),null!==url&&params&&params["#"]&&(url+="#"+params["#"]),url=appendBasePath(url,isHtml5,options.absolute),!options.absolute||!url)return url;var slash=!isHtml5&&url?"/":"",port=$location.port();return port=80===port||443===port?"":":"+port,[$location.protocol(),"://",$location.host(),port,slash,url].join("");
}}}var listener,rules=[],otherwise=null,interceptDeferred=!1;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(defer){defer===undefined&&(defer=!0),interceptDeferred=defer},this.$get=$get,$get.$inject=["$location","$rootScope","$injector","$browser","$sniffer"]}function $StateProvider($urlRouterProvider,$urlMatcherFactory){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){if(!stateOrName)return undefined;var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");base=findState(base);for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;i<pathLength;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function flushQueuedChildren(parentName){for(var queued=queue[parentName]||[];queued.length;)registerState(queued.shift())}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"' is already defined");var parentName=name.indexOf(".")!==-1?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:isObject(state.parent)&&isString(state.parent.name)?state.parent.name:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));return states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{inherit:!0,location:!1})}]),flushQueuedChildren(name),state}function isGlob(text){return text.indexOf("*")>-1}function doesStateMatchGlob(glob){for(var globSegments=glob.split("."),segments=$state.$current.name.split("."),i=0,l=globSegments.length;i<l;i++)"*"===globSegments[i]&&(segments[i]="*");return"**"===globSegments[0]&&(segments=segments.slice(indexOf(segments,globSegments[1])),segments.unshift("**")),"**"===globSegments[globSegments.length-1]&&(segments.splice(indexOf(segments,globSegments[globSegments.length-2])+1,Number.MAX_VALUE),segments.push("**")),globSegments.length==segments.length&&segments.join("")===globSegments.join("")}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$urlRouter,$location,$urlMatcherFactory){function handleRedirect(redirect,state,params,options){var evt=$rootScope.$broadcast("$stateNotFound",redirect,state,params);if(evt.defaultPrevented)return $urlRouter.update(),TransitionAborted;if(!evt.retry)return null;if(options.$retry)return $urlRouter.update(),TransitionFailed;var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),$urlRouter.update(),retryTransition}function resolveState(state,params,paramsAreFiltered,inherited,dst,options){function resolveViews(){var viewsPromises=[];return forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:dst.globals,params:$stateParams,notify:options.notify})||""}],viewsPromises.push($resolve.resolve(injectables,dst.globals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,dst.globals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,result.$$controllerAs=view.controllerAs,dst[name]=result}))}),$q.all(viewsPromises).then(function(){return dst.globals})}var $stateParams=paramsAreFiltered?params:filterByKeys(state.params.$$keys(),params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),$q.all(promises).then(resolveViews).then(function(values){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed"));return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(state){return $state.transitionTo($state.current,$stateParams,{reload:state||!0,inherit:!1,notify:!0})},$state.go=function(to,params,options){return $state.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative),hash=toParams["#"];if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options},redirectResult=handleRedirect(redirect,from.self,fromParams,options);if(redirectResult)return redirectResult;if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(!options.relative)throw new Error("No such state '"+to+"'");throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");if(options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),!toState.params.$$validates(toParams))return TransitionFailed;toParams=toState.params.$$values(toParams),to=toState;var toPath=to.path,keep=0,state=toPath[keep],locals=root.locals,toLocals=[];if(options.reload){if(isString(options.reload)||isObject(options.reload)){if(isObject(options.reload)&&!options.reload.name)throw new Error("Invalid reload state object");var reloadState=options.reload===!0?fromPath[0]:findState(options.reload);if(options.reload&&!reloadState)throw new Error("No such reload state '"+(isString(options.reload)?options.reload:options.reload.name)+"'");for(;state&&state===fromPath[keep]&&state!==reloadState;)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep]}}else for(;state&&state===fromPath[keep]&&state.ownParams.$$equals(toParams,fromParams);)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep];if(shouldSkipReload(to,toParams,from,fromParams,locals,options))return hash&&(toParams["#"]=hash),$state.params=toParams,copy($state.params,$stateParams),copy(filterByKeys(to.params.$$keys(),$stateParams),to.locals.globals.$stateParams),options.location&&to.navigable&&to.navigable.url&&($urlRouter.push(to.navigable.url,toParams,{$$avoidResync:!0,replace:"replace"===options.location}),$urlRouter.update(!0)),$state.transition=null,$q.when($state.current);if(toParams=filterByKeys(to.params.$$keys(),toParams||{}),hash&&(toParams["#"]=hash),options.notify&&$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams,options).defaultPrevented)return $rootScope.$broadcast("$stateChangeCancel",to.self,toParams,from.self,fromParams),null==$state.transition&&$urlRouter.update(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals,options);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);return $state.transition!==transition?TransitionSuperseded:($state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null,options.location&&to.navigable&&$urlRouter.push(to.navigable.url,to.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===options.location}),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),$urlRouter.update(!0),$state.current)},function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,evt=$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),evt.defaultPrevented||$urlRouter.update(),$q.reject(error))});return transition},$state.is=function(stateOrName,params,options){options=extend({relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);return isDefined(state)?$state.$current===state&&(!params||equalForKeys(state.params.$$values(params),$stateParams)):undefined},$state.includes=function(stateOrName,params,options){if(options=extend({relative:$state.$current},options||{}),isString(stateOrName)&&isGlob(stateOrName)){if(!doesStateMatchGlob(stateOrName))return!1;stateOrName=$state.$current.name}var state=findState(stateOrName,options.relative);return isDefined(state)?!!isDefined($state.$current.includes[state.name])&&(!params||equalForKeys(state.params.$$values(params),$stateParams,objectKeys(params))):undefined},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!0,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;options.inherit&&(params=inheritParams($stateParams,params||{},$state.$current,state));var nav=state&&options.lossy?state.navigable:state;return nav&&nav.url!==undefined&&null!==nav.url?$urlRouter.href(nav.url,filterByKeys(state.params.$$keys().concat("#"),params||{}),{absolute:options.absolute}):null},$state.get=function(stateOrName,context){if(0===arguments.length)return map(objectKeys(states),function(name){return states[name].self});var state=findState(stateOrName,context||$state.$current);return state&&state.self?state.self:null},$state}function shouldSkipReload(to,toParams,from,fromParams,locals,options){function nonSearchParamsEqual(fromAndToState,fromParams,toParams){function notSearchParam(key){return"search"!=fromAndToState.params[key].location}var nonQueryParamKeys=fromAndToState.params.$$keys().filter(notSearchParam),nonQueryParams=pick.apply({},[fromAndToState.params].concat(nonQueryParamKeys)),nonQueryParamSet=new $$UMFP.ParamSet(nonQueryParams);return nonQueryParamSet.$$equals(fromParams,toParams)}if(!options.reload&&to===from&&(locals===from.locals||to.self.reloadOnSearch===!1&&nonSearchParamsEqual(from,fromParams,toParams)))return!0}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=inherit(state.parent.data,state.data)),state.data},url:function(state){var url=state.url,config={params:state.params||{}};if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1),config):(state.parent.navigable||root).url.concat(url,config);if(!url||$urlMatcherFactory.isMatcher(url))return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},ownParams:function(state){var params=state.url&&state.url.params||new $$UMFP.ParamSet;return forEach(state.params||{},function(config,id){params[id]||(params[id]=new $$UMFP.Param(id,null,config,"config"))}),params},params:function(state){var ownParams=pick(state.ownParams,state.ownParams.$$keys());return state.parent&&state.parent.params?extend(state.parent.params.$$new(),ownParams):new $$UMFP.ParamSet},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),views[name]=view}),views},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,"abstract":!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewScrollProvider(){var useAnchorScroll=!1;this.useAnchorScroll=function(){useAnchorScroll=!0},this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){return useAnchorScroll?$anchorScroll:function($element){return $timeout(function(){$element[0].scrollIntoView()},0,!1)}}]}function $ViewDirective($state,$injector,$uiViewScroll,$interpolate){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}function getRenderer(attrs,scope){function animEnabled(element){return 1===ngMajorVer&&ngMinorVer>=4?!!$animate.enabled(element):1===ngMajorVer&&ngMinorVer>=2?!!$animate.enabled():!!$animator}var statics={enter:function(element,target,cb){target.after(element),cb()},leave:function(element,cb){element.remove(),cb()}};if(attrs.noanimation)return statics;if($animate)return{enter:function(element,target,cb){animEnabled(element)?angular.version.minor>2?$animate.enter(element,null,target).then(cb):$animate.enter(element,null,target,cb):statics.enter(element,target,cb)},leave:function(element,cb){animEnabled(element)?angular.version.minor>2?$animate.leave(element).then(cb):$animate.leave(element,cb):statics.leave(element,cb)}};if($animator){var animate=$animator&&$animator(scope,attrs);return{enter:function(element,target,cb){animate.enter(element,null,target),cb()},leave:function(element,cb){animate.leave(element),cb()}}}return statics}var service=getService(),$animator=service("$animator"),$animate=service("$animate"),directive={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(tElement,tAttrs,$transclude){return function(scope,$element,attrs){function cleanupLastView(){function cleanOld(){_previousEl&&_previousEl.remove(),_currentScope&&_currentScope.$destroy()}var _previousEl=previousEl,_currentScope=currentScope;_currentScope&&(_currentScope._willBeDestroyed=!0),currentEl?(renderer.leave(currentEl,function(){cleanOld(),previousEl=null}),previousEl=currentEl):(cleanOld(),previousEl=null),currentEl=null,currentScope=null}function updateView(firstTime){var newScope,name=getUiViewName(scope,attrs,$element,$interpolate),previousLocals=name&&$state.$current&&$state.$current.locals[name];if((firstTime||previousLocals!==latestLocals)&&!scope._willBeDestroyed){newScope=scope.$new(),latestLocals=$state.$current.locals[name],newScope.$emit("$viewContentLoading",name);var clone=$transclude(newScope,function(clone){renderer.enter(clone,$element,function(){currentScope&&currentScope.$emit("$viewContentAnimationEnded"),(angular.isDefined(autoScrollExp)&&!autoScrollExp||scope.$eval(autoScrollExp))&&$uiViewScroll(clone)}),cleanupLastView()});currentEl=clone,currentScope=newScope,currentScope.$emit("$viewContentLoaded",name),currentScope.$eval(onloadExp)}}var previousEl,currentEl,currentScope,latestLocals,onloadExp=attrs.onload||"",autoScrollExp=attrs.autoscroll,renderer=getRenderer(attrs,scope);scope.$on("$stateChangeSuccess",function(){updateView(!1)}),updateView(!0)}}};return directive}function $ViewDirectiveFill($compile,$controller,$state,$interpolate){return{restrict:"ECA",priority:-400,compile:function(tElement){var initial=tElement.html();return function(scope,$element,attrs){var current=$state.$current,name=getUiViewName(scope,attrs,$element,$interpolate),locals=current&&current.locals[name];if(locals){$element.data("$uiView",{name:name,state:locals.$$state}),$element.html(locals.$template?locals.$template:initial);var link=$compile($element.contents());if(locals.$$controller){locals.$scope=scope,locals.$element=$element;var controller=$controller(locals.$$controller,locals);locals.$$controllerAs&&(scope[locals.$$controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}link(scope)}}}}}function getUiViewName(scope,attrs,element,$interpolate){var name=$interpolate(attrs.uiView||attrs.name||"")(scope),inherited=element.inheritedData("$uiView");return name.indexOf("@")>=0?name:name+"@"+(inherited?inherited.state.name:"")}function parseStateRef(ref,current){var parsed,preparsed=ref.match(/^\s*({[^}]*})\s*$/);if(preparsed&&(ref=current+"("+preparsed[1]+")"),parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");if(stateData&&stateData.state&&stateData.state.name)return stateData.state}function getTypeInfo(el){var isSvg="[object SVGAnimatedString]"===Object.prototype.toString.call(el.prop("href")),isForm="FORM"===el[0].nodeName;return{attr:isForm?"action":isSvg?"xlink:href":"href",isAnchor:"A"===el.prop("tagName").toUpperCase(),clickable:!isForm}}function clickHook(el,$state,$timeout,type,current){return function(e){var button=e.which||e.button,target=current();if(!(button>1||e.ctrlKey||e.metaKey||e.shiftKey||el.attr("target"))){var transition=$timeout(function(){$state.go(target.state,target.params,target.options)});e.preventDefault();var ignorePreventDefaultCount=type.isAnchor&&!target.href?1:0;e.preventDefault=function(){ignorePreventDefaultCount--<=0&&$timeout.cancel(transition)}}}}function defaultOpts(el,$state){return{relative:stateContext(el)||$state.$current,inherit:!0}}function $StateRefDirective($state,$timeout){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref,$state.current.name),def={state:ref.state,href:null,params:null},type=getTypeInfo(element),active=uiSrefActive[1]||uiSrefActive[0];def.options=extend(defaultOpts(element,$state),attrs.uiSrefOpts?scope.$eval(attrs.uiSrefOpts):{});var update=function(val){val&&(def.params=angular.copy(val)),def.href=$state.href(ref.state,def.params,def.options),active&&active.$$addStateInfo(ref.state,def.params),null!==def.href&&attrs.$set(type.attr,def.href)};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(val){val!==def.params&&update(val)},!0),def.params=angular.copy(scope.$eval(ref.paramExpr))),update(),type.clickable&&element.bind("click",clickHook(element,$state,$timeout,type,function(){return def}))}}}function $StateRefDynamicDirective($state,$timeout){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){function runStateRefLink(group){def.state=group[0],def.params=group[1],def.options=group[2],def.href=$state.href(def.state,def.params,def.options),active&&active.$$addStateInfo(def.state,def.params),def.href&&attrs.$set(type.attr,def.href)}var type=getTypeInfo(element),active=uiSrefActive[1]||uiSrefActive[0],group=[attrs.uiState,attrs.uiStateParams||null,attrs.uiStateOpts||null],watch="["+group.map(function(val){return val||"null"}).join(", ")+"]",def={state:null,params:null,options:null,href:null};scope.$watch(watch,runStateRefLink,!0),runStateRefLink(scope.$eval(watch)),type.clickable&&element.bind("click",clickHook(element,$state,$timeout,type,function(){return def}))}}}function $StateRefActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs","$timeout",function($scope,$element,$attrs,$timeout){function addState(stateName,stateParams,activeClass){var state=$state.get(stateName,stateContext($element)),stateHash=createStateHash(stateName,stateParams);states.push({state:state||{name:stateName},params:stateParams,hash:stateHash}),activeClasses[stateHash]=activeClass}function createStateHash(state,params){if(!isString(state))throw new Error("state should be a string");return isObject(params)?state+toJson(params):(params=$scope.$eval(params),isObject(params)?state+toJson(params):state)}function update(){for(var i=0;i<states.length;i++)anyMatch(states[i].state,states[i].params)?addClass($element,activeClasses[states[i].hash]):removeClass($element,activeClasses[states[i].hash]),exactMatch(states[i].state,states[i].params)?addClass($element,activeEqClass):removeClass($element,activeEqClass)}function addClass(el,className){$timeout(function(){el.addClass(className)})}function removeClass(el,className){el.removeClass(className)}function anyMatch(state,params){return $state.includes(state.name,params)}function exactMatch(state,params){return $state.is(state.name,params)}var activeEqClass,uiSrefActive,states=[],activeClasses={};activeEqClass=$interpolate($attrs.uiSrefActiveEq||"",!1)($scope);try{uiSrefActive=$scope.$eval($attrs.uiSrefActive)}catch(e){}uiSrefActive=uiSrefActive||$interpolate($attrs.uiSrefActive||"",!1)($scope),isObject(uiSrefActive)&&forEach(uiSrefActive,function(stateOrName,activeClass){if(isString(stateOrName)){var ref=parseStateRef(stateOrName,$state.current.name);addState(ref.state,$scope.$eval(ref.paramExpr),activeClass)}}),this.$$addStateInfo=function(newState,newParams){isObject(uiSrefActive)&&states.length>0||(addState(newState,newParams,uiSrefActive),update())},$scope.$on("$stateChangeSuccess",update),update()}]}}function $IsStateFilter($state){var isFilter=function(state,params){return $state.is(state,params)};return isFilter.$stateful=!0,isFilter}function $IncludedByStateFilter($state){var includesFilter=function(state,params,options){return $state.includes(state,params,options)};return includesFilter.$stateful=!0,includesFilter}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,toJson=angular.toJson;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory);var $$UMFP;UrlMatcher.prototype.concat=function(pattern,config){var defaultConfig={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch,extend(defaultConfig,config),this)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){function decodePathArray(string){function reverseString(str){return str.split("").reverse().join("")}function unquoteDashes(str){return str.replace(/\\-/g,"-")}var split=reverseString(string).split(/-(?!\\)/),allReversed=map(split,reverseString);return map(allReversed,unquoteDashes).reverse()}var m=this.regexp.exec(path);if(!m)return null;searchParams=searchParams||{};var i,j,paramName,paramNames=this.parameters(),nTotal=paramNames.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");var param,paramVal;for(i=0;i<nPath;i++){for(paramName=paramNames[i],param=this.params[paramName],paramVal=m[i+1],j=0;j<param.replace.length;j++)param.replace[j].from===paramVal&&(paramVal=param.replace[j].to);paramVal&&param.array===!0&&(paramVal=decodePathArray(paramVal)),isDefined(paramVal)&&(paramVal=param.type.decode(paramVal)),values[paramName]=param.value(paramVal)}for(;i<nTotal;i++){for(paramName=paramNames[i],values[paramName]=this.params[paramName].value(searchParams[paramName]),param=this.params[paramName],paramVal=searchParams[paramName],j=0;j<param.replace.length;j++)param.replace[j].from===paramVal&&(paramVal=param.replace[j].to);isDefined(paramVal)&&(paramVal=param.type.decode(paramVal)),values[paramName]=param.value(paramVal)}return values},UrlMatcher.prototype.parameters=function(param){return isDefined(param)?this.params[param]||null:this.$$paramNames},UrlMatcher.prototype.validates=function(params){return this.params.$$validates(params)},UrlMatcher.prototype.format=function(values){function encodeDashes(str){return encodeURIComponent(str).replace(/-/g,function(c){return"%5C%"+c.charCodeAt(0).toString(16).toUpperCase()})}values=values||{};var segments=this.segments,params=this.parameters(),paramset=this.params;if(!this.validates(values))return null;var i,search=!1,nPath=segments.length-1,nTotal=params.length,result=segments[0];for(i=0;i<nTotal;i++){var isPathParam=i<nPath,name=params[i],param=paramset[name],value=param.value(values[name]),isDefaultValue=param.isOptional&&param.type.equals(param.value(),value),squash=!!isDefaultValue&&param.squash,encoded=param.type.encode(value);if(isPathParam){var nextSegment=segments[i+1],isFinalPathParam=i+1===nPath;if(squash===!1)null!=encoded&&(result+=isArray(encoded)?map(encoded,encodeDashes).join("-"):encodeURIComponent(encoded)),result+=nextSegment;else if(squash===!0){var capture=result.match(/\/$/)?/\/?(.*)/:/(.*)/;result+=nextSegment.match(capture)[1]}else isString(squash)&&(result+=squash+nextSegment);isFinalPathParam&&param.squash===!0&&"/"===result.slice(-1)&&(result=result.slice(0,-1))}else{if(null==encoded||isDefaultValue&&squash!==!1)continue;if(isArray(encoded)||(encoded=[encoded]),0===encoded.length)continue;encoded=map(encoded,encodeURIComponent).join("&"+name+"="),result+=(search?"&":"?")+(name+"="+encoded),search=!0}}return result},Type.prototype.is=function(val,key){return!0},Type.prototype.encode=function(val,key){return val},Type.prototype.decode=function(val,key){return val},Type.prototype.equals=function(a,b){return a==b},Type.prototype.$subPattern=function(){var sub=this.pattern.toString();return sub.substr(1,sub.length-2)},Type.prototype.pattern=/.*/,Type.prototype.toString=function(){return"{Type:"+this.name+"}"},Type.prototype.$normalize=function(val){return this.is(val)?val:this.decode(val)},Type.prototype.$asArray=function(mode,isSearch){function ArrayType(type,mode){function bindTo(type,callbackName){return function(){return type[callbackName].apply(type,arguments)}}function arrayWrap(val){return isArray(val)?val:isDefined(val)?[val]:[]}function arrayUnwrap(val){switch(val.length){case 0:return undefined;case 1:return"auto"===mode?val[0]:val;default:return val}}function falsey(val){return!val}function arrayHandler(callback,allTruthyMode){return function(val){if(isArray(val)&&0===val.length)return val;val=arrayWrap(val);var result=map(val,callback);return allTruthyMode===!0?0===filter(result,falsey).length:arrayUnwrap(result)}}function arrayEqualsHandler(callback){return function(val1,val2){var left=arrayWrap(val1),right=arrayWrap(val2);if(left.length!==right.length)return!1;for(var i=0;i<left.length;i++)if(!callback(left[i],right[i]))return!1;return!0}}this.encode=arrayHandler(bindTo(type,"encode")),this.decode=arrayHandler(bindTo(type,"decode")),this.is=arrayHandler(bindTo(type,"is"),!0),this.equals=arrayEqualsHandler(bindTo(type,"equals")),this.pattern=type.pattern,this.$normalize=arrayHandler(bindTo(type,"$normalize")),this.name=type.name,this.$arrayMode=mode}if(!mode)return this;if("auto"===mode&&!isSearch)throw new Error("'auto' array mode is for query parameters only");return new ArrayType(this,mode)},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),angular.module("ui.router.util").run(["$urlMatcherFactory",function($urlMatcherFactory){}]),$UrlRouterProvider.$inject=["$locationProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.state").factory("$stateParams",function(){return{}}).provider("$state",$StateProvider),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider);var ngMajorVer=angular.version.major,ngMinorVer=angular.version.minor;
$ViewDirective.$inject=["$state","$injector","$uiViewScroll","$interpolate"],$ViewDirectiveFill.$inject=["$compile","$controller","$state","$interpolate"],angular.module("ui.router.state").directive("uiView",$ViewDirective),angular.module("ui.router.state").directive("uiView",$ViewDirectiveFill),$StateRefDirective.$inject=["$state","$timeout"],$StateRefDynamicDirective.$inject=["$state","$timeout"],$StateRefActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateRefActiveDirective).directive("uiSrefActiveEq",$StateRefActiveDirective).directive("uiState",$StateRefDynamicDirective),$IsStateFilter.$inject=["$state"],$IncludedByStateFilter.$inject=["$state"],angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter)}(window,window.angular),function(ng){"use strict";ng.module("vcRecaptcha",[])}(angular),function(ng){"use strict";var app=ng.module("vcRecaptcha");app.service("vcRecaptchaService",["$window","$q",function($window,$q){function getRecaptcha(){return recaptcha?$q.when(recaptcha):promise}function validateRecaptchaInstance(){if(!recaptcha)throw new Error("reCaptcha has not been loaded yet.")}var recaptcha,deferred=$q.defer(),promise=deferred.promise;return $window.vcRecaptchaApiLoaded=function(){recaptcha=$window.grecaptcha,deferred.resolve(recaptcha)},ng.isDefined($window.grecaptcha)&&$window.vcRecaptchaApiLoaded(),{create:function(elm,key,fn,conf){return conf.callback=fn,conf.sitekey=key,getRecaptcha().then(function(recaptcha){return recaptcha.render(elm,conf)})},reload:function(widgetId){validateRecaptchaInstance(),recaptcha.reset(widgetId)},getResponse:function(widgetId){return validateRecaptchaInstance(),recaptcha.getResponse(widgetId)}}}])}(angular),function(ng){"use strict";function throwNoKeyException(){throw new Error('You need to set the "key" attribute to your public reCaptcha key. If you don\'t have a key, please get one from https://www.google.com/recaptcha/admin/create')}var app=ng.module("vcRecaptcha");app.directive("vcRecaptcha",["$document","$timeout","vcRecaptchaService",function($document,$timeout,vcRecaptcha){return{restrict:"A",require:"?^^form",scope:{response:"=?ngModel",key:"=",theme:"=?",size:"=?",tabindex:"=?",onCreate:"&",onSuccess:"&",onExpire:"&"},link:function(scope,elm,attrs,ctrl){function destroy(){ctrl&&ctrl.$setValidity("recaptcha",null),sessionTimeout&&($timeout.cancel(sessionTimeout),sessionTimeout=null),cleanup()}function cleanup(){angular.element($document[0].querySelectorAll(".pls-container")).parent().remove()}attrs.hasOwnProperty("key")||throwNoKeyException(),scope.widgetId=null;var sessionTimeout,removeCreationListener=scope.$watch("key",function(key){if(key){40!==key.length&&throwNoKeyException();var callback=function(gRecaptchaResponse){$timeout(function(){ctrl&&ctrl.$setValidity("recaptcha",!0),scope.response=gRecaptchaResponse,scope.onSuccess({response:gRecaptchaResponse,widgetId:scope.widgetId})}),sessionTimeout=$timeout(function(){ctrl&&ctrl.$setValidity("recaptcha",!1),scope.response="",scope.onExpire({widgetId:scope.widgetId})},12e4)};vcRecaptcha.create(elm[0],key,callback,{theme:scope.theme||attrs.theme||null,tabindex:scope.tabindex||attrs.tabindex||null,size:scope.size||attrs.size||null}).then(function(widgetId){ctrl&&ctrl.$setValidity("recaptcha",!1),scope.widgetId=widgetId,scope.onCreate({widgetId:widgetId}),scope.$on("$destroy",destroy)}),removeCreationListener()}})}}}])}(angular),function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){function runTranslate($translate){"use strict";var key=$translate.storageKey(),storage=$translate.storage(),fallbackFromIncorrectStorageValue=function(){var preferred=$translate.preferredLanguage();angular.isString(preferred)?$translate.use(preferred):storage.put(key,$translate.use())};fallbackFromIncorrectStorageValue.displayName="fallbackFromIncorrectStorageValue",storage?storage.get(key)?$translate.use(storage.get(key))["catch"](fallbackFromIncorrectStorageValue):fallbackFromIncorrectStorageValue():angular.isString($translate.preferredLanguage())&&$translate.use($translate.preferredLanguage())}function $translateSanitizationProvider(){"use strict";var $sanitize,strategies,currentStrategy=null,hasConfiguredStrategy=!1,hasShownNoStrategyConfiguredWarning=!1;strategies={sanitize:function(value,mode){return"text"===mode&&(value=htmlSanitizeValue(value)),value},escape:function(value,mode){return"text"===mode&&(value=htmlEscapeValue(value)),value},sanitizeParameters:function(value,mode){return"params"===mode&&(value=mapInterpolationParameters(value,htmlSanitizeValue)),value},escapeParameters:function(value,mode){return"params"===mode&&(value=mapInterpolationParameters(value,htmlEscapeValue)),value}},strategies.escaped=strategies.escapeParameters,this.addStrategy=function(strategyName,strategyFunction){return strategies[strategyName]=strategyFunction,this},this.removeStrategy=function(strategyName){return delete strategies[strategyName],this},this.useStrategy=function(strategy){return hasConfiguredStrategy=!0,currentStrategy=strategy,this},this.$get=["$injector","$log",function($injector,$log){var cachedStrategyMap={},applyStrategies=function(value,mode,selectedStrategies){return angular.forEach(selectedStrategies,function(selectedStrategy){if(angular.isFunction(selectedStrategy))value=selectedStrategy(value,mode);else if(angular.isFunction(strategies[selectedStrategy]))value=strategies[selectedStrategy](value,mode);else{if(!angular.isString(strategies[selectedStrategy]))throw new Error("pascalprecht.translate.$translateSanitization: Unknown sanitization strategy: '"+selectedStrategy+"'");if(!cachedStrategyMap[strategies[selectedStrategy]])try{cachedStrategyMap[strategies[selectedStrategy]]=$injector.get(strategies[selectedStrategy])}catch(e){throw cachedStrategyMap[strategies[selectedStrategy]]=function(){},new Error("pascalprecht.translate.$translateSanitization: Unknown sanitization strategy: '"+selectedStrategy+"'")}value=cachedStrategyMap[strategies[selectedStrategy]](value,mode)}}),value},showNoStrategyConfiguredWarning=function(){hasConfiguredStrategy||hasShownNoStrategyConfiguredWarning||($log.warn("pascalprecht.translate.$translateSanitization: No sanitization strategy has been configured. This can have serious security implications. See http://angular-translate.github.io/docs/#/guide/19_security for details."),hasShownNoStrategyConfiguredWarning=!0)};return $injector.has("$sanitize")&&($sanitize=$injector.get("$sanitize")),{useStrategy:function(self){return function(strategy){self.useStrategy(strategy)}}(this),sanitize:function(value,mode,strategy){if(currentStrategy||showNoStrategyConfiguredWarning(),arguments.length<3&&(strategy=currentStrategy),!strategy)return value;var selectedStrategies=angular.isArray(strategy)?strategy:[strategy];return applyStrategies(value,mode,selectedStrategies)}}}];var htmlEscapeValue=function(value){var element=angular.element("<div></div>");return element.text(value),element.html()},htmlSanitizeValue=function(value){if(!$sanitize)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot find $sanitize service. Either include the ngSanitize module (https://docs.angularjs.org/api/ngSanitize) or use a sanitization strategy which does not depend on $sanitize, such as 'escape'.");return $sanitize(value)},mapInterpolationParameters=function(value,iteratee,stack){if(angular.isObject(value)){var result=angular.isArray(value)?[]:{};if(stack){if(stack.indexOf(value)>-1)throw new Error("pascalprecht.translate.$translateSanitization: Error cannot interpolate parameter due recursive object")}else stack=[];return stack.push(value),angular.forEach(value,function(propertyValue,propertyKey){angular.isFunction(propertyValue)||(result[propertyKey]=mapInterpolationParameters(propertyValue,iteratee,stack))}),stack.splice(-1,1),result}return angular.isNumber(value)?value:iteratee(value)}}function $translate($STORAGE_KEY,$windowProvider,$translateSanitizationProvider,pascalprechtTranslateOverrider){"use strict";var $preferredLanguage,$languageKeyAliases,$fallbackLanguage,$fallbackWasString,$uses,$nextLang,$storageFactory,$storagePrefix,$missingTranslationHandlerFactory,$interpolationFactory,$loaderFactory,$loaderOptions,$notFoundIndicatorLeft,$notFoundIndicatorRight,loaderCache,postProcessFn,$translationTable={},$availableLanguageKeys=[],$storageKey=$STORAGE_KEY,$interpolatorFactories=[],$cloakClassName="translate-cloak",$postCompilingEnabled=!1,$forceAsyncReloadEnabled=!1,$nestedObjectDelimeter=".",$isReady=!1,$keepContent=!1,directivePriority=0,statefulFilter=!0,uniformLanguageTagResolver="default",languageTagResolver={"default":function(tag){return(tag||"").split("-").join("_")},java:function(tag){var temp=(tag||"").split("-").join("_"),parts=temp.split("_");return parts.length>1?parts[0].toLowerCase()+"_"+parts[1].toUpperCase():temp},bcp47:function(tag){var temp=(tag||"").split("_").join("-"),parts=temp.split("-");return parts.length>1?parts[0].toLowerCase()+"-"+parts[1].toUpperCase():temp},"iso639-1":function(tag){var temp=(tag||"").split("_").join("-"),parts=temp.split("-");return parts[0].toLowerCase()}},version="2.11.1",getFirstBrowserLanguage=function(){if(angular.isFunction(pascalprechtTranslateOverrider.getLocale))return pascalprechtTranslateOverrider.getLocale();var i,language,nav=$windowProvider.$get().navigator,browserLanguagePropertyKeys=["language","browserLanguage","systemLanguage","userLanguage"];if(angular.isArray(nav.languages))for(i=0;i<nav.languages.length;i++)if(language=nav.languages[i],language&&language.length)return language;for(i=0;i<browserLanguagePropertyKeys.length;i++)if(language=nav[browserLanguagePropertyKeys[i]],language&&language.length)return language;return null};getFirstBrowserLanguage.displayName="angular-translate/service: getFirstBrowserLanguage";var getLocale=function(){var locale=getFirstBrowserLanguage()||"";return languageTagResolver[uniformLanguageTagResolver]&&(locale=languageTagResolver[uniformLanguageTagResolver](locale)),locale};getLocale.displayName="angular-translate/service: getLocale";var indexOf=function(array,searchElement){for(var i=0,len=array.length;i<len;i++)if(array[i]===searchElement)return i;return-1},trim=function(){return this.toString().replace(/^\s+|\s+$/g,"")},negotiateLocale=function(preferred){if(preferred){for(var avail=[],locale=angular.lowercase(preferred),i=0,n=$availableLanguageKeys.length;i<n;i++)avail.push(angular.lowercase($availableLanguageKeys[i]));if(indexOf(avail,locale)>-1)return preferred;if($languageKeyAliases){var alias;for(var langKeyAlias in $languageKeyAliases)if($languageKeyAliases.hasOwnProperty(langKeyAlias)){var hasWildcardKey=!1,hasExactKey=Object.prototype.hasOwnProperty.call($languageKeyAliases,langKeyAlias)&&angular.lowercase(langKeyAlias)===angular.lowercase(preferred);if("*"===langKeyAlias.slice(-1)&&(hasWildcardKey=langKeyAlias.slice(0,-1)===preferred.slice(0,langKeyAlias.length-1)),(hasExactKey||hasWildcardKey)&&(alias=$languageKeyAliases[langKeyAlias],indexOf(avail,angular.lowercase(alias))>-1))return alias}}var parts=preferred.split("_");return parts.length>1&&indexOf(avail,angular.lowercase(parts[0]))>-1?parts[0]:void 0}},translations=function(langKey,translationTable){if(!langKey&&!translationTable)return $translationTable;if(langKey&&!translationTable){if(angular.isString(langKey))return $translationTable[langKey]}else angular.isObject($translationTable[langKey])||($translationTable[langKey]={}),angular.extend($translationTable[langKey],flatObject(translationTable));return this};this.translations=translations,this.cloakClassName=function(name){return name?($cloakClassName=name,this):$cloakClassName},this.nestedObjectDelimeter=function(delimiter){return delimiter?($nestedObjectDelimeter=delimiter,this):$nestedObjectDelimeter};var flatObject=function(data,path,result,prevKey){var key,keyWithPath,keyWithShortPath,val;path||(path=[]),result||(result={});for(key in data)Object.prototype.hasOwnProperty.call(data,key)&&(val=data[key],angular.isObject(val)?flatObject(val,path.concat(key),result,key):(keyWithPath=path.length?""+path.join($nestedObjectDelimeter)+$nestedObjectDelimeter+key:key,path.length&&key===prevKey&&(keyWithShortPath=""+path.join($nestedObjectDelimeter),result[keyWithShortPath]="@:"+keyWithPath),result[keyWithPath]=val));return result};flatObject.displayName="flatObject",this.addInterpolation=function(factory){return $interpolatorFactories.push(factory),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(factory){return $interpolationFactory=factory,this},this.useSanitizeValueStrategy=function(value){return $translateSanitizationProvider.useStrategy(value),this},this.preferredLanguage=function(langKey){return langKey?(setupPreferredLanguage(langKey),this):$preferredLanguage};var setupPreferredLanguage=function(langKey){return langKey&&($preferredLanguage=langKey),$preferredLanguage};this.translationNotFoundIndicator=function(indicator){return this.translationNotFoundIndicatorLeft(indicator),this.translationNotFoundIndicatorRight(indicator),this},this.translationNotFoundIndicatorLeft=function(indicator){return indicator?($notFoundIndicatorLeft=indicator,this):$notFoundIndicatorLeft},this.translationNotFoundIndicatorRight=function(indicator){return indicator?($notFoundIndicatorRight=indicator,this):$notFoundIndicatorRight},this.fallbackLanguage=function(langKey){return fallbackStack(langKey),this};var fallbackStack=function(langKey){return langKey?(angular.isString(langKey)?($fallbackWasString=!0,$fallbackLanguage=[langKey]):angular.isArray(langKey)&&($fallbackWasString=!1,$fallbackLanguage=langKey),angular.isString($preferredLanguage)&&indexOf($fallbackLanguage,$preferredLanguage)<0&&$fallbackLanguage.push($preferredLanguage),this):$fallbackWasString?$fallbackLanguage[0]:$fallbackLanguage};this.use=function(langKey){if(langKey){if(!$translationTable[langKey]&&!$loaderFactory)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+langKey+"'");return $uses=langKey,this}return $uses},this.resolveClientLocale=function(){return getLocale()};var storageKey=function(key){return key?($storageKey=key,this):$storagePrefix?$storagePrefix+$storageKey:$storageKey};this.storageKey=storageKey,this.useUrlLoader=function(url,options){return this.useLoader("$translateUrlLoader",angular.extend({url:url},options))},this.useStaticFilesLoader=function(options){return this.useLoader("$translateStaticFilesLoader",options)},this.useLoader=function(loaderFactory,options){return $loaderFactory=loaderFactory,$loaderOptions=options||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(storageFactory){return $storageFactory=storageFactory,this},this.storagePrefix=function(prefix){return prefix?($storagePrefix=prefix,this):prefix},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(factory){return $missingTranslationHandlerFactory=factory,this},this.usePostCompiling=function(value){return $postCompilingEnabled=!!value,this},this.forceAsyncReload=function(value){return $forceAsyncReloadEnabled=!!value,this},this.uniformLanguageTag=function(options){return options?angular.isString(options)&&(options={standard:options}):options={},uniformLanguageTagResolver=options.standard,this},this.determinePreferredLanguage=function(fn){var locale=fn&&angular.isFunction(fn)?fn():getLocale();return $preferredLanguage=$availableLanguageKeys.length?negotiateLocale(locale)||locale:locale,this},this.registerAvailableLanguageKeys=function(languageKeys,aliases){return languageKeys?($availableLanguageKeys=languageKeys,aliases&&($languageKeyAliases=aliases),this):$availableLanguageKeys},this.useLoaderCache=function(cache){return cache===!1?loaderCache=void 0:cache===!0?loaderCache=!0:"undefined"==typeof cache?loaderCache="$translationCache":cache&&(loaderCache=cache),this},this.directivePriority=function(priority){return void 0===priority?directivePriority:(directivePriority=priority,this)},this.statefulFilter=function(state){return void 0===state?statefulFilter:(statefulFilter=state,this)},this.postProcess=function(fn){return postProcessFn=fn?fn:void 0,this},this.keepContent=function(value){return $keepContent=!!value,this},this.$get=["$log","$injector","$rootScope","$q",function($log,$injector,$rootScope,$q){var Storage,fallbackIndex,startFallbackIteration,defaultInterpolator=$injector.get($interpolationFactory||"$translateDefaultInterpolation"),pendingLoader=!1,interpolatorHashMap={},langPromises={},$translate=function(translationId,interpolateParams,interpolationId,defaultTranslationText,forceLanguage){!$uses&&$preferredLanguage&&($uses=$preferredLanguage);var uses=forceLanguage&&forceLanguage!==$uses?negotiateLocale(forceLanguage)||forceLanguage:$uses;if(forceLanguage&&loadTranslationsIfMissing(forceLanguage),angular.isArray(translationId)){var translateAll=function(translationIds){for(var results={},promises=[],translate=function(translationId){var deferred=$q.defer(),regardless=function(value){results[translationId]=value,deferred.resolve([translationId,value])};return $translate(translationId,interpolateParams,interpolationId,defaultTranslationText,forceLanguage).then(regardless,regardless),deferred.promise},i=0,c=translationIds.length;i<c;i++)promises.push(translate(translationIds[i]));return $q.all(promises).then(function(){return results})};return translateAll(translationId)}var deferred=$q.defer();translationId&&(translationId=trim.apply(translationId));var promiseToWaitFor=function(){var promise=$preferredLanguage?langPromises[$preferredLanguage]:langPromises[uses];if(fallbackIndex=0,$storageFactory&&!promise){var langKey=Storage.get($storageKey);if(promise=langPromises[langKey],$fallbackLanguage&&$fallbackLanguage.length){var index=indexOf($fallbackLanguage,langKey);fallbackIndex=0===index?1:0,indexOf($fallbackLanguage,$preferredLanguage)<0&&$fallbackLanguage.push($preferredLanguage)}}return promise}();if(promiseToWaitFor){var promiseResolved=function(){forceLanguage||(uses=$uses),determineTranslation(translationId,interpolateParams,interpolationId,defaultTranslationText,uses).then(deferred.resolve,deferred.reject)};promiseResolved.displayName="promiseResolved",promiseToWaitFor["finally"](promiseResolved)}else determineTranslation(translationId,interpolateParams,interpolationId,defaultTranslationText,uses).then(deferred.resolve,deferred.reject);return deferred.promise},applyNotFoundIndicators=function(translationId){return $notFoundIndicatorLeft&&(translationId=[$notFoundIndicatorLeft,translationId].join(" ")),$notFoundIndicatorRight&&(translationId=[translationId,$notFoundIndicatorRight].join(" ")),translationId},useLanguage=function(key){$uses=key,$storageFactory&&Storage.put($translate.storageKey(),$uses),$rootScope.$emit("$translateChangeSuccess",{language:key}),defaultInterpolator.setLocale($uses);var eachInterpolator=function(interpolator,id){interpolatorHashMap[id].setLocale($uses)};eachInterpolator.displayName="eachInterpolatorLocaleSetter",angular.forEach(interpolatorHashMap,eachInterpolator),$rootScope.$emit("$translateChangeEnd",{language:key})},loadAsync=function(key){if(!key)throw"No language key specified for loading.";var deferred=$q.defer();$rootScope.$emit("$translateLoadingStart",{language:key}),pendingLoader=!0;var cache=loaderCache;"string"==typeof cache&&(cache=$injector.get(cache));var loaderOptions=angular.extend({},$loaderOptions,{key:key,$http:angular.extend({},{cache:cache},$loaderOptions.$http)}),onLoaderSuccess=function(data){var translationTable={};$rootScope.$emit("$translateLoadingSuccess",{language:key}),angular.isArray(data)?angular.forEach(data,function(table){angular.extend(translationTable,flatObject(table))}):angular.extend(translationTable,flatObject(data)),pendingLoader=!1,deferred.resolve({key:key,table:translationTable}),$rootScope.$emit("$translateLoadingEnd",{language:key})};onLoaderSuccess.displayName="onLoaderSuccess";var onLoaderError=function(key){$rootScope.$emit("$translateLoadingError",{language:key}),deferred.reject(key),$rootScope.$emit("$translateLoadingEnd",{language:key})};return onLoaderError.displayName="onLoaderError",$injector.get($loaderFactory)(loaderOptions).then(onLoaderSuccess,onLoaderError),deferred.promise};if($storageFactory&&(Storage=$injector.get($storageFactory),!Storage.get||!Storage.put))throw new Error("Couldn't use storage '"+$storageFactory+"', missing get() or put() method!");if($interpolatorFactories.length){var eachInterpolationFactory=function(interpolatorFactory){var interpolator=$injector.get(interpolatorFactory);interpolator.setLocale($preferredLanguage||$uses),interpolatorHashMap[interpolator.getInterpolationIdentifier()]=interpolator};eachInterpolationFactory.displayName="interpolationFactoryAdder",angular.forEach($interpolatorFactories,eachInterpolationFactory)}var getTranslationTable=function(langKey){var deferred=$q.defer();if(Object.prototype.hasOwnProperty.call($translationTable,langKey))deferred.resolve($translationTable[langKey]);else if(langPromises[langKey]){var onResolve=function(data){translations(data.key,data.table),deferred.resolve(data.table)};onResolve.displayName="translationTableResolver",langPromises[langKey].then(onResolve,deferred.reject)}else deferred.reject();return deferred.promise},getFallbackTranslation=function(langKey,translationId,interpolateParams,Interpolator){var deferred=$q.defer(),onResolve=function(translationTable){if(Object.prototype.hasOwnProperty.call(translationTable,translationId)){Interpolator.setLocale(langKey);var translation=translationTable[translationId];if("@:"===translation.substr(0,2))getFallbackTranslation(langKey,translation.substr(2),interpolateParams,Interpolator).then(deferred.resolve,deferred.reject);else{var interpolatedValue=Interpolator.interpolate(translationTable[translationId],interpolateParams);interpolatedValue=applyPostProcessing(translationId,translationTable[translationId],interpolatedValue,interpolateParams,langKey),deferred.resolve(interpolatedValue)}Interpolator.setLocale($uses)}else deferred.reject()};return onResolve.displayName="fallbackTranslationResolver",getTranslationTable(langKey).then(onResolve,deferred.reject),deferred.promise},getFallbackTranslationInstant=function(langKey,translationId,interpolateParams,Interpolator){var result,translationTable=$translationTable[langKey];if(translationTable&&Object.prototype.hasOwnProperty.call(translationTable,translationId)){if(Interpolator.setLocale(langKey),result=Interpolator.interpolate(translationTable[translationId],interpolateParams),result=applyPostProcessing(translationId,translationTable[translationId],result,interpolateParams,langKey),"@:"===result.substr(0,2))return getFallbackTranslationInstant(langKey,result.substr(2),interpolateParams,Interpolator);Interpolator.setLocale($uses)}return result},translateByHandler=function(translationId,interpolateParams,defaultTranslationText){if($missingTranslationHandlerFactory){var resultString=$injector.get($missingTranslationHandlerFactory)(translationId,$uses,interpolateParams,defaultTranslationText);return void 0!==resultString?resultString:translationId}return translationId},resolveForFallbackLanguage=function(fallbackLanguageIndex,translationId,interpolateParams,Interpolator,defaultTranslationText){var deferred=$q.defer();if(fallbackLanguageIndex<$fallbackLanguage.length){var langKey=$fallbackLanguage[fallbackLanguageIndex];getFallbackTranslation(langKey,translationId,interpolateParams,Interpolator).then(function(data){deferred.resolve(data)},function(){return resolveForFallbackLanguage(fallbackLanguageIndex+1,translationId,interpolateParams,Interpolator,defaultTranslationText).then(deferred.resolve,deferred.reject)})}else defaultTranslationText?deferred.resolve(defaultTranslationText):$missingTranslationHandlerFactory?deferred.resolve(translateByHandler(translationId,interpolateParams)):deferred.reject(translateByHandler(translationId,interpolateParams));return deferred.promise},resolveForFallbackLanguageInstant=function(fallbackLanguageIndex,translationId,interpolateParams,Interpolator){var result;if(fallbackLanguageIndex<$fallbackLanguage.length){var langKey=$fallbackLanguage[fallbackLanguageIndex];result=getFallbackTranslationInstant(langKey,translationId,interpolateParams,Interpolator),result||(result=resolveForFallbackLanguageInstant(fallbackLanguageIndex+1,translationId,interpolateParams,Interpolator))}return result},fallbackTranslation=function(translationId,interpolateParams,Interpolator,defaultTranslationText){return resolveForFallbackLanguage(startFallbackIteration>0?startFallbackIteration:fallbackIndex,translationId,interpolateParams,Interpolator,defaultTranslationText)},fallbackTranslationInstant=function(translationId,interpolateParams,Interpolator){return resolveForFallbackLanguageInstant(startFallbackIteration>0?startFallbackIteration:fallbackIndex,translationId,interpolateParams,Interpolator)},determineTranslation=function(translationId,interpolateParams,interpolationId,defaultTranslationText,uses){var deferred=$q.defer(),table=uses?$translationTable[uses]:$translationTable,Interpolator=interpolationId?interpolatorHashMap[interpolationId]:defaultInterpolator;if(table&&Object.prototype.hasOwnProperty.call(table,translationId)){var translation=table[translationId];if("@:"===translation.substr(0,2))$translate(translation.substr(2),interpolateParams,interpolationId,defaultTranslationText,uses).then(deferred.resolve,deferred.reject);else{var resolvedTranslation=Interpolator.interpolate(translation,interpolateParams);resolvedTranslation=applyPostProcessing(translationId,translation,resolvedTranslation,interpolateParams,uses),deferred.resolve(resolvedTranslation)}}else{var missingTranslationHandlerTranslation;$missingTranslationHandlerFactory&&!pendingLoader&&(missingTranslationHandlerTranslation=translateByHandler(translationId,interpolateParams,defaultTranslationText)),uses&&$fallbackLanguage&&$fallbackLanguage.length?fallbackTranslation(translationId,interpolateParams,Interpolator,defaultTranslationText).then(function(translation){deferred.resolve(translation)},function(_translationId){deferred.reject(applyNotFoundIndicators(_translationId))}):$missingTranslationHandlerFactory&&!pendingLoader&&missingTranslationHandlerTranslation?defaultTranslationText?deferred.resolve(defaultTranslationText):deferred.resolve(missingTranslationHandlerTranslation):defaultTranslationText?deferred.resolve(defaultTranslationText):deferred.reject(applyNotFoundIndicators(translationId))}return deferred.promise},determineTranslationInstant=function(translationId,interpolateParams,interpolationId,uses){var result,table=uses?$translationTable[uses]:$translationTable,Interpolator=defaultInterpolator;if(interpolatorHashMap&&Object.prototype.hasOwnProperty.call(interpolatorHashMap,interpolationId)&&(Interpolator=interpolatorHashMap[interpolationId]),table&&Object.prototype.hasOwnProperty.call(table,translationId)){var translation=table[translationId];"@:"===translation.substr(0,2)?result=determineTranslationInstant(translation.substr(2),interpolateParams,interpolationId,uses):(result=Interpolator.interpolate(translation,interpolateParams),result=applyPostProcessing(translationId,translation,result,interpolateParams,uses))}else{var missingTranslationHandlerTranslation;$missingTranslationHandlerFactory&&!pendingLoader&&(missingTranslationHandlerTranslation=translateByHandler(translationId,interpolateParams)),uses&&$fallbackLanguage&&$fallbackLanguage.length?(fallbackIndex=0,result=fallbackTranslationInstant(translationId,interpolateParams,Interpolator)):result=$missingTranslationHandlerFactory&&!pendingLoader&&missingTranslationHandlerTranslation?missingTranslationHandlerTranslation:applyNotFoundIndicators(translationId)}return result},clearNextLangAndPromise=function(key){$nextLang===key&&($nextLang=void 0),langPromises[key]=void 0},applyPostProcessing=function(translationId,translation,resolvedTranslation,interpolateParams,uses){var fn=postProcessFn;return fn&&("string"==typeof fn&&(fn=$injector.get(fn)),fn)?fn(translationId,translation,resolvedTranslation,interpolateParams,uses):resolvedTranslation},loadTranslationsIfMissing=function(key){$translationTable[key]||!$loaderFactory||langPromises[key]||(langPromises[key]=loadAsync(key).then(function(translation){return translations(translation.key,translation.table),translation}))};$translate.preferredLanguage=function(langKey){return langKey&&setupPreferredLanguage(langKey),$preferredLanguage},$translate.cloakClassName=function(){return $cloakClassName},$translate.nestedObjectDelimeter=function(){return $nestedObjectDelimeter},$translate.fallbackLanguage=function(langKey){if(void 0!==langKey&&null!==langKey){if(fallbackStack(langKey),$loaderFactory&&$fallbackLanguage&&$fallbackLanguage.length)for(var i=0,len=$fallbackLanguage.length;i<len;i++)langPromises[$fallbackLanguage[i]]||(langPromises[$fallbackLanguage[i]]=loadAsync($fallbackLanguage[i]));$translate.use($translate.use())}return $fallbackWasString?$fallbackLanguage[0]:$fallbackLanguage},$translate.useFallbackLanguage=function(langKey){if(void 0!==langKey&&null!==langKey)if(langKey){var langKeyPosition=indexOf($fallbackLanguage,langKey);langKeyPosition>-1&&(startFallbackIteration=langKeyPosition)}else startFallbackIteration=0},$translate.proposedLanguage=function(){return $nextLang},$translate.storage=function(){return Storage},$translate.negotiateLocale=negotiateLocale,$translate.use=function(key){if(!key)return $uses;var deferred=$q.defer();$rootScope.$emit("$translateChangeStart",{language:key});var aliasedKey=negotiateLocale(key);return $availableLanguageKeys.length>0&&!aliasedKey?$q.reject(key):(aliasedKey&&(key=aliasedKey),$nextLang=key,!$forceAsyncReloadEnabled&&$translationTable[key]||!$loaderFactory||langPromises[key]?langPromises[key]?langPromises[key].then(function(translation){return $nextLang===translation.key&&useLanguage(translation.key),deferred.resolve(translation.key),translation},function(key){return!$uses&&$fallbackLanguage&&$fallbackLanguage.length>0?$translate.use($fallbackLanguage[0]).then(deferred.resolve,deferred.reject):deferred.reject(key)}):(deferred.resolve(key),useLanguage(key)):(langPromises[key]=loadAsync(key).then(function(translation){return translations(translation.key,translation.table),deferred.resolve(translation.key),$nextLang===key&&useLanguage(translation.key),translation},function(key){return $rootScope.$emit("$translateChangeError",{language:key}),deferred.reject(key),$rootScope.$emit("$translateChangeEnd",{language:key}),$q.reject(key)}),langPromises[key]["finally"](function(){clearNextLangAndPromise(key)})),deferred.promise)},$translate.resolveClientLocale=function(){return getLocale()},$translate.storageKey=function(){return storageKey()},$translate.isPostCompilingEnabled=function(){return $postCompilingEnabled},$translate.isForceAsyncReloadEnabled=function(){return $forceAsyncReloadEnabled},$translate.isKeepContent=function(){return $keepContent},$translate.refresh=function(langKey){function resolve(){deferred.resolve(),$rootScope.$emit("$translateRefreshEnd",{language:langKey})}function reject(){deferred.reject(),$rootScope.$emit("$translateRefreshEnd",{language:langKey})}if(!$loaderFactory)throw new Error("Couldn't refresh translation table, no loader registered!");var deferred=$q.defer();if($rootScope.$emit("$translateRefreshStart",{
language:langKey}),langKey)if($translationTable[langKey]){var oneTranslationsLoaded=function(data){return translations(data.key,data.table),langKey===$uses&&useLanguage($uses),resolve(),data};oneTranslationsLoaded.displayName="refreshPostProcessor",loadAsync(langKey).then(oneTranslationsLoaded,reject)}else reject();else{var tables=[],loadingKeys={};if($fallbackLanguage&&$fallbackLanguage.length)for(var i=0,len=$fallbackLanguage.length;i<len;i++)tables.push(loadAsync($fallbackLanguage[i])),loadingKeys[$fallbackLanguage[i]]=!0;$uses&&!loadingKeys[$uses]&&tables.push(loadAsync($uses));var allTranslationsLoaded=function(tableData){$translationTable={},angular.forEach(tableData,function(data){translations(data.key,data.table)}),$uses&&useLanguage($uses),resolve()};allTranslationsLoaded.displayName="refreshPostProcessor",$q.all(tables).then(allTranslationsLoaded,reject)}return deferred.promise},$translate.instant=function(translationId,interpolateParams,interpolationId,forceLanguage){var uses=forceLanguage&&forceLanguage!==$uses?negotiateLocale(forceLanguage)||forceLanguage:$uses;if(null===translationId||angular.isUndefined(translationId))return translationId;if(forceLanguage&&loadTranslationsIfMissing(forceLanguage),angular.isArray(translationId)){for(var results={},i=0,c=translationId.length;i<c;i++)results[translationId[i]]=$translate.instant(translationId[i],interpolateParams,interpolationId,forceLanguage);return results}if(angular.isString(translationId)&&translationId.length<1)return translationId;translationId&&(translationId=trim.apply(translationId));var result,possibleLangKeys=[];$preferredLanguage&&possibleLangKeys.push($preferredLanguage),uses&&possibleLangKeys.push(uses),$fallbackLanguage&&$fallbackLanguage.length&&(possibleLangKeys=possibleLangKeys.concat($fallbackLanguage));for(var j=0,d=possibleLangKeys.length;j<d;j++){var possibleLangKey=possibleLangKeys[j];if($translationTable[possibleLangKey]&&"undefined"!=typeof $translationTable[possibleLangKey][translationId]&&(result=determineTranslationInstant(translationId,interpolateParams,interpolationId,uses)),"undefined"!=typeof result)break}return result||""===result||($notFoundIndicatorLeft||$notFoundIndicatorRight?result=applyNotFoundIndicators(translationId):(result=defaultInterpolator.interpolate(translationId,interpolateParams),$missingTranslationHandlerFactory&&!pendingLoader&&(result=translateByHandler(translationId,interpolateParams)))),result},$translate.versionInfo=function(){return version},$translate.loaderCache=function(){return loaderCache},$translate.directivePriority=function(){return directivePriority},$translate.statefulFilter=function(){return statefulFilter},$translate.isReady=function(){return $isReady};var $onReadyDeferred=$q.defer();$onReadyDeferred.promise.then(function(){$isReady=!0}),$translate.onReady=function(fn){var deferred=$q.defer();return angular.isFunction(fn)&&deferred.promise.then(fn),$isReady?deferred.resolve():$onReadyDeferred.promise.then(deferred.resolve),deferred.promise},$translate.getAvailableLanguageKeys=function(){return $availableLanguageKeys.length>0?$availableLanguageKeys:null};var globalOnReadyListener=$rootScope.$on("$translateReady",function(){$onReadyDeferred.resolve(),globalOnReadyListener(),globalOnReadyListener=null}),globalOnChangeListener=$rootScope.$on("$translateChangeEnd",function(){$onReadyDeferred.resolve(),globalOnChangeListener(),globalOnChangeListener=null});if($loaderFactory){if(angular.equals($translationTable,{})&&$translate.use()&&$translate.use($translate.use()),$fallbackLanguage&&$fallbackLanguage.length)for(var processAsyncResult=function(translation){return translations(translation.key,translation.table),$rootScope.$emit("$translateChangeEnd",{language:translation.key}),translation},i=0,len=$fallbackLanguage.length;i<len;i++){var fallbackLanguageId=$fallbackLanguage[i];!$forceAsyncReloadEnabled&&$translationTable[fallbackLanguageId]||(langPromises[fallbackLanguageId]=loadAsync(fallbackLanguageId).then(processAsyncResult))}}else $rootScope.$emit("$translateReady",{language:$translate.use()});return $translate}]}function $translateDefaultInterpolation($interpolate,$translateSanitization){"use strict";var $locale,$translateInterpolator={},$identifier="default";return $translateInterpolator.setLocale=function(locale){$locale=locale},$translateInterpolator.getInterpolationIdentifier=function(){return $identifier},$translateInterpolator.useSanitizeValueStrategy=function(value){return $translateSanitization.useStrategy(value),this},$translateInterpolator.interpolate=function(value,interpolationParams){interpolationParams=interpolationParams||{},interpolationParams=$translateSanitization.sanitize(interpolationParams,"params");var interpolatedText;return angular.isNumber(value)?interpolatedText=""+value:angular.isString(value)?(interpolatedText=$interpolate(value)(interpolationParams),interpolatedText=$translateSanitization.sanitize(interpolatedText,"text")):interpolatedText="",interpolatedText},$translateInterpolator}function translateDirective($translate,$q,$interpolate,$compile,$parse,$rootScope){"use strict";var trim=function(){return this.toString().replace(/^\s+|\s+$/g,"")};return{restrict:"AE",scope:!0,priority:$translate.directivePriority(),compile:function(tElement,tAttr){var translateValuesExist=tAttr.translateValues?tAttr.translateValues:void 0,translateInterpolation=tAttr.translateInterpolation?tAttr.translateInterpolation:void 0,translateValueExist=tElement[0].outerHTML.match(/translate-value-+/i),interpolateRegExp="^(.*)("+$interpolate.startSymbol()+".*"+$interpolate.endSymbol()+")(.*)",watcherRegExp="^(.*)"+$interpolate.startSymbol()+"(.*)"+$interpolate.endSymbol()+"(.*)";return function(scope,iElement,iAttr){scope.interpolateParams={},scope.preText="",scope.postText="",scope.translateNamespace=getTranslateNamespace(scope);var translationIds={},initInterpolationParams=function(interpolateParams,iAttr,tAttr){if(iAttr.translateValues&&angular.extend(interpolateParams,$parse(iAttr.translateValues)(scope.$parent)),translateValueExist)for(var attr in tAttr)if(Object.prototype.hasOwnProperty.call(iAttr,attr)&&"translateValue"===attr.substr(0,14)&&"translateValues"!==attr){var attributeName=angular.lowercase(attr.substr(14,1))+attr.substr(15);interpolateParams[attributeName]=tAttr[attr]}},observeElementTranslation=function(translationId){if(angular.isFunction(observeElementTranslation._unwatchOld)&&(observeElementTranslation._unwatchOld(),observeElementTranslation._unwatchOld=void 0),angular.equals(translationId,"")||!angular.isDefined(translationId)){var iElementText=trim.apply(iElement.text()),interpolateMatches=iElementText.match(interpolateRegExp);if(angular.isArray(interpolateMatches)){scope.preText=interpolateMatches[1],scope.postText=interpolateMatches[3],translationIds.translate=$interpolate(interpolateMatches[2])(scope.$parent);var watcherMatches=iElementText.match(watcherRegExp);angular.isArray(watcherMatches)&&watcherMatches[2]&&watcherMatches[2].length&&(observeElementTranslation._unwatchOld=scope.$watch(watcherMatches[2],function(newValue){translationIds.translate=newValue,updateTranslations()}))}else translationIds.translate=iElementText?iElementText:void 0}else translationIds.translate=translationId;updateTranslations()},observeAttributeTranslation=function(translateAttr){iAttr.$observe(translateAttr,function(translationId){translationIds[translateAttr]=translationId,updateTranslations()})};initInterpolationParams(scope.interpolateParams,iAttr,tAttr);var firstAttributeChangedEvent=!0;iAttr.$observe("translate",function(translationId){"undefined"==typeof translationId?observeElementTranslation(""):""===translationId&&firstAttributeChangedEvent||(translationIds.translate=translationId,updateTranslations()),firstAttributeChangedEvent=!1});for(var translateAttr in iAttr)iAttr.hasOwnProperty(translateAttr)&&"translateAttr"===translateAttr.substr(0,13)&&observeAttributeTranslation(translateAttr);if(iAttr.$observe("translateDefault",function(value){scope.defaultText=value,updateTranslations()}),translateValuesExist&&iAttr.$observe("translateValues",function(interpolateParams){interpolateParams&&scope.$parent.$watch(function(){angular.extend(scope.interpolateParams,$parse(interpolateParams)(scope.$parent))})}),translateValueExist){var observeValueAttribute=function(attrName){iAttr.$observe(attrName,function(value){var attributeName=angular.lowercase(attrName.substr(14,1))+attrName.substr(15);scope.interpolateParams[attributeName]=value})};for(var attr in iAttr)Object.prototype.hasOwnProperty.call(iAttr,attr)&&"translateValue"===attr.substr(0,14)&&"translateValues"!==attr&&observeValueAttribute(attr)}var updateTranslations=function(){for(var key in translationIds)translationIds.hasOwnProperty(key)&&void 0!==translationIds[key]&&updateTranslation(key,translationIds[key],scope,scope.interpolateParams,scope.defaultText,scope.translateNamespace)},updateTranslation=function(translateAttr,translationId,scope,interpolateParams,defaultTranslationText,translateNamespace){translationId?(translateNamespace&&"."===translationId.charAt(0)&&(translationId=translateNamespace+translationId),$translate(translationId,interpolateParams,translateInterpolation,defaultTranslationText,scope.translateLanguage).then(function(translation){applyTranslation(translation,scope,!0,translateAttr)},function(translationId){applyTranslation(translationId,scope,!1,translateAttr)})):applyTranslation(translationId,scope,!1,translateAttr)},applyTranslation=function(value,scope,successful,translateAttr){if(successful||"undefined"!=typeof scope.defaultText&&(value=scope.defaultText),"translate"===translateAttr){(successful||!successful&&!$translate.isKeepContent()&&"undefined"==typeof iAttr.translateKeepContent)&&iElement.empty().append(scope.preText+value+scope.postText);var globallyEnabled=$translate.isPostCompilingEnabled(),locallyDefined="undefined"!=typeof tAttr.translateCompile,locallyEnabled=locallyDefined&&"false"!==tAttr.translateCompile;(globallyEnabled&&!locallyDefined||locallyEnabled)&&$compile(iElement.contents())(scope)}else{var attributeName=iAttr.$attr[translateAttr];"data-"===attributeName.substr(0,5)&&(attributeName=attributeName.substr(5)),attributeName=attributeName.substr(15),iElement.attr(attributeName,value)}};(translateValuesExist||translateValueExist||iAttr.translateDefault)&&scope.$watch("interpolateParams",updateTranslations,!0);var unbindTranslateLanguage=scope.$on("translateLanguageChanged",updateTranslations),unbind=$rootScope.$on("$translateChangeSuccess",updateTranslations);iElement.text().length?observeElementTranslation(iAttr.translate?iAttr.translate:""):iAttr.translate&&observeElementTranslation(iAttr.translate),updateTranslations(),scope.$on("$destroy",function(){unbindTranslateLanguage(),unbind()})}}}}function getTranslateNamespace(scope){"use strict";return scope.translateNamespace?scope.translateNamespace:scope.$parent?getTranslateNamespace(scope.$parent):void 0}function translateCloakDirective($translate,$rootScope){"use strict";return{compile:function(tElement){var applyCloak=function(){tElement.addClass($translate.cloakClassName())},removeCloak=function(){tElement.removeClass($translate.cloakClassName())};return $translate.onReady(function(){removeCloak()}),applyCloak(),function(scope,iElement,iAttr){iAttr.translateCloak&&iAttr.translateCloak.length&&(iAttr.$observe("translateCloak",function(translationId){$translate(translationId).then(removeCloak,applyCloak)}),$rootScope.$on("$translateChangeSuccess",function(){$translate(iAttr.translateCloak).then(removeCloak,applyCloak)}))}}}}function translateNamespaceDirective(){"use strict";return{restrict:"A",scope:!0,compile:function(){return{pre:function(scope,iElement,iAttrs){scope.translateNamespace=getTranslateNamespace(scope),scope.translateNamespace&&"."===iAttrs.translateNamespace.charAt(0)?scope.translateNamespace+=iAttrs.translateNamespace:scope.translateNamespace=iAttrs.translateNamespace}}}}}function getTranslateNamespace(scope){"use strict";return scope.translateNamespace?scope.translateNamespace:scope.$parent?getTranslateNamespace(scope.$parent):void 0}function translateLanguageDirective(){"use strict";return{restrict:"A",scope:!0,compile:function(){return function(scope,iElement,iAttrs){iAttrs.$observe("translateLanguage",function(newTranslateLanguage){scope.translateLanguage=newTranslateLanguage}),scope.$watch("translateLanguage",function(){scope.$broadcast("translateLanguageChanged")})}}}}function translateFilterFactory($parse,$translate){"use strict";var translateFilter=function(translationId,interpolateParams,interpolation,forceLanguage){return angular.isObject(interpolateParams)||(interpolateParams=$parse(interpolateParams)(this)),$translate.instant(translationId,interpolateParams,interpolation,forceLanguage)};return $translate.statefulFilter()&&(translateFilter.$stateful=!0),translateFilter}function $translationCache($cacheFactory){"use strict";return $cacheFactory("translations")}return runTranslate.$inject=["$translate"],$translate.$inject=["$STORAGE_KEY","$windowProvider","$translateSanitizationProvider","pascalprechtTranslateOverrider"],$translateDefaultInterpolation.$inject=["$interpolate","$translateSanitization"],translateDirective.$inject=["$translate","$q","$interpolate","$compile","$parse","$rootScope"],translateCloakDirective.$inject=["$translate","$rootScope"],translateFilterFactory.$inject=["$parse","$translate"],$translationCache.$inject=["$cacheFactory"],angular.module("pascalprecht.translate",["ng"]).run(runTranslate),runTranslate.displayName="runTranslate",angular.module("pascalprecht.translate").provider("$translateSanitization",$translateSanitizationProvider),angular.module("pascalprecht.translate").constant("pascalprechtTranslateOverrider",{}).provider("$translate",$translate),$translate.displayName="displayName",angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",$translateDefaultInterpolation),$translateDefaultInterpolation.displayName="$translateDefaultInterpolation",angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",translateDirective),translateDirective.displayName="translateDirective",angular.module("pascalprecht.translate").directive("translateCloak",translateCloakDirective),translateCloakDirective.displayName="translateCloakDirective",angular.module("pascalprecht.translate").directive("translateNamespace",translateNamespaceDirective),translateNamespaceDirective.displayName="translateNamespaceDirective",angular.module("pascalprecht.translate").directive("translateLanguage",translateLanguageDirective),translateLanguageDirective.displayName="translateLanguageDirective",angular.module("pascalprecht.translate").filter("translate",translateFilterFactory),translateFilterFactory.displayName="translateFilterFactory",angular.module("pascalprecht.translate").factory("$translationCache",$translationCache),$translationCache.displayName="$translationCache","pascalprecht.translate"}),function(window,angular,undefined){"use strict";angular.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function($rootScope,$browser){function push(){var name,value,browserCookies,updated;for(name in lastCookies)isUndefined(cookies[name])&&($browser.cookies(name,undefined),delete lastCookies[name]);for(name in cookies)value=cookies[name],angular.isString(value)||(value=""+value,cookies[name]=value),value!==lastCookies[name]&&($browser.cookies(name,value),lastCookies[name]=value,updated=!0);if(updated){browserCookies=$browser.cookies();for(name in cookies)cookies[name]!==browserCookies[name]&&(isUndefined(browserCookies[name])?(delete cookies[name],delete lastCookies[name]):cookies[name]=lastCookies[name]=browserCookies[name])}}var lastBrowserCookies,cookies={},lastCookies={},runEval=!1,copy=angular.copy,isUndefined=angular.isUndefined;return $browser.addPollFn(function(){var currentCookies=$browser.cookies();lastBrowserCookies!=currentCookies&&(lastBrowserCookies=currentCookies,copy(currentCookies,lastCookies),copy(currentCookies,cookies),runEval&&$rootScope.$apply())})(),runEval=!0,$rootScope.$watch(push),cookies}]).factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){var value=$cookies[key];return value?angular.fromJson(value):value},put:function(key,value){$cookies[key]=angular.toJson(value)},remove:function(key){delete $cookies[key]}}}])}(window,window.angular),function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){function $translatePartialLoader(){"use strict";function Part(name,priority){this.name=name,this.isActive=!0,this.tables={},this.priority=priority||0}function hasPart(name){return Object.prototype.hasOwnProperty.call(parts,name)}function isStringValid(str){return angular.isString(str)&&""!==str}function isPartAvailable(name){if(!isStringValid(name))throw new TypeError("Invalid type of a first argument, a non-empty string expected.");return hasPart(name)&&parts[name].isActive}function deepExtend(dst,src){for(var property in src)src[property]&&src[property].constructor&&src[property].constructor===Object?(dst[property]=dst[property]||{},deepExtend(dst[property],src[property])):dst[property]=src[property];return dst}function getPrioritizedParts(){var prioritizedParts=[];for(var part in parts)parts[part].isActive&&prioritizedParts.push(parts[part]);return prioritizedParts.sort(function(a,b){return a.priority-b.priority}),prioritizedParts}Part.prototype.parseUrl=function(urlTemplate,targetLang){return angular.isFunction(urlTemplate)?urlTemplate(this.name,targetLang):urlTemplate.replace(/\{part\}/g,this.name).replace(/\{lang\}/g,targetLang)},Part.prototype.getTable=function(lang,$q,$http,$httpOptions,urlTemplate,errorHandler){if(this.tables[lang])return $q.when(this.tables[lang]);var self=this;return $http(angular.extend({method:"GET",url:this.parseUrl(urlTemplate,lang)},$httpOptions)).then(function(result){return self.tables[lang]=result.data,result.data},function(){return errorHandler?errorHandler(self.name,lang).then(function(data){return self.tables[lang]=data,data},function(){return $q.reject(self.name)}):$q.reject(self.name)})};var parts={};this.addPart=function(name,priority){if(!isStringValid(name))throw new TypeError("Couldn't add part, part name has to be a string!");return hasPart(name)||(parts[name]=new Part(name,priority)),parts[name].isActive=!0,this},this.setPart=function(lang,part,table){if(!isStringValid(lang))throw new TypeError("Couldn't set part.`lang` parameter has to be a string!");if(!isStringValid(part))throw new TypeError("Couldn't set part.`part` parameter has to be a string!");if("object"!=typeof table||null===table)throw new TypeError("Couldn't set part. `table` parameter has to be an object!");return hasPart(part)||(parts[part]=new Part(part),parts[part].isActive=!1),parts[part].tables[lang]=table,this},this.deletePart=function(name){if(!isStringValid(name))throw new TypeError("Couldn't delete part, first arg has to be string.");return hasPart(name)&&(parts[name].isActive=!1),this},this.isPartAvailable=isPartAvailable,this.$get=["$rootScope","$injector","$q","$http",function($rootScope,$injector,$q,$http){var service=function(options){if(!isStringValid(options.key))throw new TypeError("Unable to load data, a key is not a non-empty string.");if(!isStringValid(options.urlTemplate)&&!angular.isFunction(options.urlTemplate))throw new TypeError("Unable to load data, a urlTemplate is not a non-empty string or not a function.");var errorHandler=options.loadFailureHandler;if(void 0!==errorHandler){if(!angular.isString(errorHandler))throw new Error("Unable to load data, a loadFailureHandler is not a string.");errorHandler=$injector.get(errorHandler)}var loaders=[],prioritizedParts=getPrioritizedParts();return angular.forEach(prioritizedParts,function(part){loaders.push(part.getTable(options.key,$q,$http,options.$http,options.urlTemplate,errorHandler)),part.urlTemplate=options.urlTemplate}),$q.all(loaders).then(function(){var table={};return prioritizedParts=getPrioritizedParts(),angular.forEach(prioritizedParts,function(part){deepExtend(table,part.tables[options.key])}),table},function(){return $q.reject(options.key)})};return service.addPart=function(name,priority){if(!isStringValid(name))throw new TypeError("Couldn't add part, first arg has to be a string");return hasPart(name)?parts[name].isActive||(parts[name].isActive=!0,$rootScope.$emit("$translatePartialLoaderStructureChanged",name)):(parts[name]=new Part(name,priority),$rootScope.$emit("$translatePartialLoaderStructureChanged",name)),service},service.deletePart=function(name,removeData){if(!isStringValid(name))throw new TypeError("Couldn't delete part, first arg has to be string");if(void 0===removeData)removeData=!1;else if("boolean"!=typeof removeData)throw new TypeError("Invalid type of a second argument, a boolean expected.");if(hasPart(name)){var wasActive=parts[name].isActive;if(removeData){var $translate=$injector.get("$translate"),cache=$translate.loaderCache();"string"==typeof cache&&(cache=$injector.get(cache)),"object"==typeof cache&&angular.forEach(parts[name].tables,function(value,key){cache.remove(parts[name].parseUrl(parts[name].urlTemplate,key))}),delete parts[name]}else parts[name].isActive=!1;wasActive&&$rootScope.$emit("$translatePartialLoaderStructureChanged",name)}return service},service.isPartLoaded=function(name,lang){return angular.isDefined(parts[name])&&angular.isDefined(parts[name].tables[lang])},service.getRegisteredParts=function(){var registeredParts=[];return angular.forEach(parts,function(p){p.isActive&&registeredParts.push(p.name)}),registeredParts},service.isPartAvailable=isPartAvailable,service}]}return angular.module("pascalprecht.translate").provider("$translatePartialLoader",$translatePartialLoader),$translatePartialLoader.displayName="$translatePartialLoader","pascalprecht.translate"}),function(global,factory){"function"==typeof define&&define.amd?define([],factory):"undefined"!=typeof module&&module.exports?module.exports=factory():global.tv4=factory()}(this,function(){function recursiveCompare(A,B){if(A===B)return!0;if("object"==typeof A&&"object"==typeof B){if(Array.isArray(A)!==Array.isArray(B))return!1;if(Array.isArray(A)){if(A.length!==B.length)return!1;for(var i=0;i<A.length;i++)if(!recursiveCompare(A[i],B[i]))return!1}else{var key;for(key in A)if(void 0===B[key]&&void 0!==A[key])return!1;for(key in B)if(void 0===A[key]&&void 0!==B[key])return!1;for(key in A)if(!recursiveCompare(A[key],B[key]))return!1}return!0}return!1}function parseURI(url){var m=String(url).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return m?{href:m[0]||"",protocol:m[1]||"",authority:m[2]||"",host:m[3]||"",hostname:m[4]||"",port:m[5]||"",pathname:m[6]||"",search:m[7]||"",hash:m[8]||""}:null}function resolveUrl(base,href){function removeDotSegments(input){var output=[];return input.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(p){"/.."===p?output.pop():output.push(p)}),output.join("").replace(/^\//,"/"===input.charAt(0)?"/":"")}return href=parseURI(href||""),base=parseURI(base||""),href&&base?(href.protocol||base.protocol)+(href.protocol||href.authority?href.authority:base.authority)+removeDotSegments(href.protocol||href.authority||"/"===href.pathname.charAt(0)?href.pathname:href.pathname?(base.authority&&!base.pathname?"/":"")+base.pathname.slice(0,base.pathname.lastIndexOf("/")+1)+href.pathname:base.pathname)+(href.protocol||href.authority||href.pathname?href.search:href.search||base.search)+href.hash:null}function getDocumentUri(uri){return uri.split("#")[0]}function normSchema(schema,baseUri){if(schema&&"object"==typeof schema)if(void 0===baseUri?baseUri=schema.id:"string"==typeof schema.id&&(baseUri=resolveUrl(baseUri,schema.id),schema.id=baseUri),Array.isArray(schema))for(var i=0;i<schema.length;i++)normSchema(schema[i],baseUri);else{"string"==typeof schema.$ref&&(schema.$ref=resolveUrl(baseUri,schema.$ref));for(var key in schema)"enum"!==key&&normSchema(schema[key],baseUri)}}function ValidationError(code,message,dataPath,schemaPath,subErrors){if(Error.call(this),void 0===code)throw new Error("No code supplied for error: "+message);this.message=message,this.code=code,this.dataPath=dataPath||"",this.schemaPath=schemaPath||"",this.subErrors=subErrors||null;var err=new Error(this.message);if(this.stack=err.stack||err.stacktrace,!this.stack)try{throw err}catch(err){this.stack=err.stack||err.stacktrace}}function isTrustedUrl(baseUrl,testUrl){if(testUrl.substring(0,baseUrl.length)===baseUrl){var remainder=testUrl.substring(baseUrl.length);if(testUrl.length>0&&"/"===testUrl.charAt(baseUrl.length-1)||"#"===remainder.charAt(0)||"?"===remainder.charAt(0))return!0}return!1}function createApi(language){var globalContext=new ValidatorContext,currentLanguage=language||"en",api={addFormat:function(){globalContext.addFormat.apply(globalContext,arguments)},language:function(code){return code?(languages[code]||(code=code.split("-")[0]),!!languages[code]&&(currentLanguage=code,code)):currentLanguage},addLanguage:function(code,messageMap){var key;for(key in ErrorCodes)messageMap[key]&&!messageMap[ErrorCodes[key]]&&(messageMap[ErrorCodes[key]]=messageMap[key]);var rootCode=code.split("-")[0];if(languages[rootCode]){languages[code]=Object.create(languages[rootCode]);for(key in messageMap)"undefined"==typeof languages[rootCode][key]&&(languages[rootCode][key]=messageMap[key]),languages[code][key]=messageMap[key]}else languages[code]=messageMap,languages[rootCode]=messageMap;return this},freshApi:function(language){var result=createApi();return language&&result.language(language),result},validate:function(data,schema,checkRecursive,banUnknownProperties){var context=new ValidatorContext(globalContext,(!1),languages[currentLanguage],checkRecursive,banUnknownProperties);"string"==typeof schema&&(schema={$ref:schema}),context.addSchema("",schema);var error=context.validateAll(data,schema,null,null,"");return!error&&banUnknownProperties&&(error=context.banUnknownProperties()),this.error=error,this.missing=context.missing,this.valid=null===error,this.valid},validateResult:function(){var result={};return this.validate.apply(result,arguments),result},validateMultiple:function(data,schema,checkRecursive,banUnknownProperties){var context=new ValidatorContext(globalContext,(!0),languages[currentLanguage],checkRecursive,banUnknownProperties);"string"==typeof schema&&(schema={$ref:schema}),context.addSchema("",schema),context.validateAll(data,schema,null,null,""),banUnknownProperties&&context.banUnknownProperties();var result={};return result.errors=context.errors,result.missing=context.missing,result.valid=0===result.errors.length,result},addSchema:function(){return globalContext.addSchema.apply(globalContext,arguments)},getSchema:function(){return globalContext.getSchema.apply(globalContext,arguments)},getSchemaMap:function(){return globalContext.getSchemaMap.apply(globalContext,arguments)},getSchemaUris:function(){return globalContext.getSchemaUris.apply(globalContext,arguments)},getMissingUris:function(){return globalContext.getMissingUris.apply(globalContext,arguments)},dropSchemas:function(){globalContext.dropSchemas.apply(globalContext,arguments)},defineKeyword:function(){globalContext.defineKeyword.apply(globalContext,arguments)},defineError:function(codeName,codeNumber,defaultMessage){if("string"!=typeof codeName||!/^[A-Z]+(_[A-Z]+)*$/.test(codeName))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof codeNumber||codeNumber%1!==0||codeNumber<1e4)throw new Error("Code number must be an integer > 10000");if("undefined"!=typeof ErrorCodes[codeName])throw new Error("Error already defined: "+codeName+" as "+ErrorCodes[codeName]);if("undefined"!=typeof ErrorCodeLookup[codeNumber])throw new Error("Error code already used: "+ErrorCodeLookup[codeNumber]+" as "+codeNumber);ErrorCodes[codeName]=codeNumber,ErrorCodeLookup[codeNumber]=codeName,ErrorMessagesDefault[codeName]=ErrorMessagesDefault[codeNumber]=defaultMessage;for(var langCode in languages){var language=languages[langCode];language[codeName]&&(language[codeNumber]=language[codeNumber]||language[codeName])}},reset:function(){globalContext.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:normSchema,resolveUrl:resolveUrl,getDocumentUri:getDocumentUri,errorCodes:ErrorCodes};return api}Object.keys||(Object.keys=function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if("object"!=typeof obj&&"function"!=typeof obj||null===obj)throw new TypeError("Object.keys called on non-object");var result=[];for(var prop in obj)hasOwnProperty.call(obj,prop)&&result.push(prop);if(hasDontEnumBug)for(var i=0;i<dontEnumsLength;i++)hasOwnProperty.call(obj,dontEnums[i])&&result.push(dontEnums[i]);return result}}()),Object.create||(Object.create=function(){function F(){}return function(o){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return F.prototype=o,new F}}()),Array.isArray||(Array.isArray=function(vArg){return"[object Array]"===Object.prototype.toString.call(vArg)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1}),Object.isFrozen||(Object.isFrozen=function(obj){for(var key="tv4_test_frozen_key";obj.hasOwnProperty(key);)key+=Math.random();try{return obj[key]=!0,delete obj[key],!1}catch(e){return!0}});var ValidatorContext=function(parent,collectMultiple,errorMessages,checkRecursive,trackUnknownProperties){if(this.missing=[],this.missingMap={},this.formatValidators=parent?Object.create(parent.formatValidators):{},this.schemas=parent?Object.create(parent.schemas):{},this.collectMultiple=collectMultiple,this.errors=[],this.handleError=collectMultiple?this.collectError:this.returnError,checkRecursive&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),trackUnknownProperties&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=errorMessages,this.definedKeywords={},parent)for(var key in parent.definedKeywords)this.definedKeywords[key]=parent.definedKeywords[key].slice(0)};ValidatorContext.prototype.defineKeyword=function(keyword,keywordFunction){this.definedKeywords[keyword]=this.definedKeywords[keyword]||[],this.definedKeywords[keyword].push(keywordFunction)},ValidatorContext.prototype.createError=function(code,messageParams,dataPath,schemaPath,subErrors){var messageTemplate=this.errorMessages[code]||ErrorMessagesDefault[code];if("string"!=typeof messageTemplate)return new ValidationError(code,"Unknown error code "+code+": "+JSON.stringify(messageParams),dataPath,schemaPath,subErrors);var message=messageTemplate.replace(/\{([^{}]*)\}/g,function(whole,varName){var subValue=messageParams[varName];return"string"==typeof subValue||"number"==typeof subValue?subValue:whole;
});return new ValidationError(code,message,dataPath,schemaPath,subErrors)},ValidatorContext.prototype.returnError=function(error){return error},ValidatorContext.prototype.collectError=function(error){return error&&this.errors.push(error),null},ValidatorContext.prototype.prefixErrors=function(startIndex,dataPath,schemaPath){for(var i=startIndex;i<this.errors.length;i++)this.errors[i]=this.errors[i].prefixWith(dataPath,schemaPath);return this},ValidatorContext.prototype.banUnknownProperties=function(){for(var unknownPath in this.unknownPropertyPaths){var error=this.createError(ErrorCodes.UNKNOWN_PROPERTY,{path:unknownPath},unknownPath,""),result=this.handleError(error);if(result)return result}return null},ValidatorContext.prototype.addFormat=function(format,validator){if("object"==typeof format){for(var key in format)this.addFormat(key,format[key]);return this}this.formatValidators[format]=validator},ValidatorContext.prototype.resolveRefs=function(schema,urlHistory){if(void 0!==schema.$ref){if(urlHistory=urlHistory||{},urlHistory[schema.$ref])return this.createError(ErrorCodes.CIRCULAR_REFERENCE,{urls:Object.keys(urlHistory).join(", ")},"","");urlHistory[schema.$ref]=!0,schema=this.getSchema(schema.$ref,urlHistory)}return schema},ValidatorContext.prototype.getSchema=function(url,urlHistory){var schema;if(void 0!==this.schemas[url])return schema=this.schemas[url],this.resolveRefs(schema,urlHistory);var baseUrl=url,fragment="";if(url.indexOf("#")!==-1&&(fragment=url.substring(url.indexOf("#")+1),baseUrl=url.substring(0,url.indexOf("#"))),"object"==typeof this.schemas[baseUrl]){schema=this.schemas[baseUrl];var pointerPath=decodeURIComponent(fragment);if(""===pointerPath)return this.resolveRefs(schema,urlHistory);if("/"!==pointerPath.charAt(0))return;for(var parts=pointerPath.split("/").slice(1),i=0;i<parts.length;i++){var component=parts[i].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===schema[component]){schema=void 0;break}schema=schema[component]}if(void 0!==schema)return this.resolveRefs(schema,urlHistory)}void 0===this.missing[baseUrl]&&(this.missing.push(baseUrl),this.missing[baseUrl]=baseUrl,this.missingMap[baseUrl]=baseUrl)},ValidatorContext.prototype.searchSchemas=function(schema,url){if(schema&&"object"==typeof schema){"string"==typeof schema.id&&isTrustedUrl(url,schema.id)&&void 0===this.schemas[schema.id]&&(this.schemas[schema.id]=schema);for(var key in schema)if("enum"!==key)if("object"==typeof schema[key])this.searchSchemas(schema[key],url);else if("$ref"===key){var uri=getDocumentUri(schema[key]);uri&&void 0===this.schemas[uri]&&void 0===this.missingMap[uri]&&(this.missingMap[uri]=uri)}}},ValidatorContext.prototype.addSchema=function(url,schema){if("string"!=typeof url||"undefined"==typeof schema){if("object"!=typeof url||"string"!=typeof url.id)return;schema=url,url=schema.id}(url=getDocumentUri(url)+"#")&&(url=getDocumentUri(url)),this.schemas[url]=schema,delete this.missingMap[url],normSchema(schema,url),this.searchSchemas(schema,url)},ValidatorContext.prototype.getSchemaMap=function(){var map={};for(var key in this.schemas)map[key]=this.schemas[key];return map},ValidatorContext.prototype.getSchemaUris=function(filterRegExp){var list=[];for(var key in this.schemas)filterRegExp&&!filterRegExp.test(key)||list.push(key);return list},ValidatorContext.prototype.getMissingUris=function(filterRegExp){var list=[];for(var key in this.missingMap)filterRegExp&&!filterRegExp.test(key)||list.push(key);return list},ValidatorContext.prototype.dropSchemas=function(){this.schemas={},this.reset()},ValidatorContext.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},ValidatorContext.prototype.validateAll=function(data,schema,dataPathParts,schemaPathParts,dataPointerPath){var topLevel;if(schema=this.resolveRefs(schema),!schema)return null;if(schema instanceof ValidationError)return this.errors.push(schema),schema;var frozenIndex,startErrorCount=this.errors.length,scannedFrozenSchemaIndex=null,scannedSchemasIndex=null;if(this.checkRecursive&&data&&"object"==typeof data){if(topLevel=!this.scanned.length,data[this.validatedSchemasKey]){var schemaIndex=data[this.validatedSchemasKey].indexOf(schema);if(schemaIndex!==-1)return this.errors=this.errors.concat(data[this.validationErrorsKey][schemaIndex]),null}if(Object.isFrozen(data)&&(frozenIndex=this.scannedFrozen.indexOf(data),frozenIndex!==-1)){var frozenSchemaIndex=this.scannedFrozenSchemas[frozenIndex].indexOf(schema);if(frozenSchemaIndex!==-1)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[frozenIndex][frozenSchemaIndex]),null}if(this.scanned.push(data),Object.isFrozen(data))frozenIndex===-1&&(frozenIndex=this.scannedFrozen.length,this.scannedFrozen.push(data),this.scannedFrozenSchemas.push([])),scannedFrozenSchemaIndex=this.scannedFrozenSchemas[frozenIndex].length,this.scannedFrozenSchemas[frozenIndex][scannedFrozenSchemaIndex]=schema,this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex]=[];else{if(!data[this.validatedSchemasKey])try{Object.defineProperty(data,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(data,this.validationErrorsKey,{value:[],configurable:!0})}catch(e){data[this.validatedSchemasKey]=[],data[this.validationErrorsKey]=[]}scannedSchemasIndex=data[this.validatedSchemasKey].length,data[this.validatedSchemasKey][scannedSchemasIndex]=schema,data[this.validationErrorsKey][scannedSchemasIndex]=[]}}var errorCount=this.errors.length,error=this.validateBasic(data,schema,dataPointerPath)||this.validateNumeric(data,schema,dataPointerPath)||this.validateString(data,schema,dataPointerPath)||this.validateArray(data,schema,dataPointerPath)||this.validateObject(data,schema,dataPointerPath)||this.validateCombinations(data,schema,dataPointerPath)||this.validateFormat(data,schema,dataPointerPath)||this.validateDefinedKeywords(data,schema,dataPointerPath)||null;if(topLevel){for(;this.scanned.length;){var item=this.scanned.pop();delete item[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(error||errorCount!==this.errors.length)for(;dataPathParts&&dataPathParts.length||schemaPathParts&&schemaPathParts.length;){var dataPart=dataPathParts&&dataPathParts.length?""+dataPathParts.pop():null,schemaPart=schemaPathParts&&schemaPathParts.length?""+schemaPathParts.pop():null;error&&(error=error.prefixWith(dataPart,schemaPart)),this.prefixErrors(errorCount,dataPart,schemaPart)}return null!==scannedFrozenSchemaIndex?this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex]=this.errors.slice(startErrorCount):null!==scannedSchemasIndex&&(data[this.validationErrorsKey][scannedSchemasIndex]=this.errors.slice(startErrorCount)),this.handleError(error)},ValidatorContext.prototype.validateFormat=function(data,schema){if("string"!=typeof schema.format||!this.formatValidators[schema.format])return null;var errorMessage=this.formatValidators[schema.format].call(null,data,schema);return"string"==typeof errorMessage||"number"==typeof errorMessage?this.createError(ErrorCodes.FORMAT_CUSTOM,{message:errorMessage}).prefixWith(null,"format"):errorMessage&&"object"==typeof errorMessage?this.createError(ErrorCodes.FORMAT_CUSTOM,{message:errorMessage.message||"?"},errorMessage.dataPath||null,errorMessage.schemaPath||"/format"):null},ValidatorContext.prototype.validateDefinedKeywords=function(data,schema){for(var key in this.definedKeywords)for(var validationFunctions=this.definedKeywords[key],i=0;i<validationFunctions.length;i++){var func=validationFunctions[i],result=func(data,schema[key],schema);if("string"==typeof result||"number"==typeof result)return this.createError(ErrorCodes.KEYWORD_CUSTOM,{key:key,message:result}).prefixWith(null,"format");if(result&&"object"==typeof result){var code=result.code||ErrorCodes.KEYWORD_CUSTOM;if("string"==typeof code){if(!ErrorCodes[code])throw new Error("Undefined error code (use defineError): "+code);code=ErrorCodes[code]}var messageParams="object"==typeof result.message?result.message:{key:key,message:result.message||"?"},schemaPath=result.schemaPath||"/"+key.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(code,messageParams,result.dataPath||null,schemaPath)}}return null},ValidatorContext.prototype.validateBasic=function(data,schema,dataPointerPath){var error;return(error=this.validateType(data,schema,dataPointerPath))?error.prefixWith(null,"type"):(error=this.validateEnum(data,schema,dataPointerPath))?error.prefixWith(null,"type"):null},ValidatorContext.prototype.validateType=function(data,schema){if(void 0===schema.type)return null;var dataType=typeof data;null===data?dataType="null":Array.isArray(data)&&(dataType="array");var allowedTypes=schema.type;"object"!=typeof allowedTypes&&(allowedTypes=[allowedTypes]);for(var i=0;i<allowedTypes.length;i++){var type=allowedTypes[i];if(type===dataType||"integer"===type&&"number"===dataType&&data%1===0)return null}return this.createError(ErrorCodes.INVALID_TYPE,{type:dataType,expected:allowedTypes.join("/")})},ValidatorContext.prototype.validateEnum=function(data,schema){if(void 0===schema["enum"])return null;for(var i=0;i<schema["enum"].length;i++){var enumVal=schema["enum"][i];if(recursiveCompare(data,enumVal))return null}return this.createError(ErrorCodes.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(data):data})},ValidatorContext.prototype.validateNumeric=function(data,schema,dataPointerPath){return this.validateMultipleOf(data,schema,dataPointerPath)||this.validateMinMax(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateMultipleOf=function(data,schema){var multipleOf=schema.multipleOf||schema.divisibleBy;return void 0===multipleOf?null:"number"==typeof data&&data%multipleOf!==0?this.createError(ErrorCodes.NUMBER_MULTIPLE_OF,{value:data,multipleOf:multipleOf}):null},ValidatorContext.prototype.validateMinMax=function(data,schema){if("number"!=typeof data)return null;if(void 0!==schema.minimum){if(data<schema.minimum)return this.createError(ErrorCodes.NUMBER_MINIMUM,{value:data,minimum:schema.minimum}).prefixWith(null,"minimum");if(schema.exclusiveMinimum&&data===schema.minimum)return this.createError(ErrorCodes.NUMBER_MINIMUM_EXCLUSIVE,{value:data,minimum:schema.minimum}).prefixWith(null,"exclusiveMinimum")}if(void 0!==schema.maximum){if(data>schema.maximum)return this.createError(ErrorCodes.NUMBER_MAXIMUM,{value:data,maximum:schema.maximum}).prefixWith(null,"maximum");if(schema.exclusiveMaximum&&data===schema.maximum)return this.createError(ErrorCodes.NUMBER_MAXIMUM_EXCLUSIVE,{value:data,maximum:schema.maximum}).prefixWith(null,"exclusiveMaximum")}return null},ValidatorContext.prototype.validateString=function(data,schema,dataPointerPath){return this.validateStringLength(data,schema,dataPointerPath)||this.validateStringPattern(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateStringLength=function(data,schema){return"string"!=typeof data?null:void 0!==schema.minLength&&data.length<schema.minLength?this.createError(ErrorCodes.STRING_LENGTH_SHORT,{length:data.length,minimum:schema.minLength}).prefixWith(null,"minLength"):void 0!==schema.maxLength&&data.length>schema.maxLength?this.createError(ErrorCodes.STRING_LENGTH_LONG,{length:data.length,maximum:schema.maxLength}).prefixWith(null,"maxLength"):null},ValidatorContext.prototype.validateStringPattern=function(data,schema){if("string"!=typeof data||void 0===schema.pattern)return null;var regexp=new RegExp(schema.pattern);return regexp.test(data)?null:this.createError(ErrorCodes.STRING_PATTERN,{pattern:schema.pattern}).prefixWith(null,"pattern")},ValidatorContext.prototype.validateArray=function(data,schema,dataPointerPath){return Array.isArray(data)?this.validateArrayLength(data,schema,dataPointerPath)||this.validateArrayUniqueItems(data,schema,dataPointerPath)||this.validateArrayItems(data,schema,dataPointerPath)||null:null},ValidatorContext.prototype.validateArrayLength=function(data,schema){var error;return void 0!==schema.minItems&&data.length<schema.minItems&&(error=this.createError(ErrorCodes.ARRAY_LENGTH_SHORT,{length:data.length,minimum:schema.minItems}).prefixWith(null,"minItems"),this.handleError(error))?error:void 0!==schema.maxItems&&data.length>schema.maxItems&&(error=this.createError(ErrorCodes.ARRAY_LENGTH_LONG,{length:data.length,maximum:schema.maxItems}).prefixWith(null,"maxItems"),this.handleError(error))?error:null},ValidatorContext.prototype.validateArrayUniqueItems=function(data,schema){if(schema.uniqueItems)for(var i=0;i<data.length;i++)for(var j=i+1;j<data.length;j++)if(recursiveCompare(data[i],data[j])){var error=this.createError(ErrorCodes.ARRAY_UNIQUE,{match1:i,match2:j}).prefixWith(null,"uniqueItems");if(this.handleError(error))return error}return null},ValidatorContext.prototype.validateArrayItems=function(data,schema,dataPointerPath){if(void 0===schema.items)return null;var error,i;if(Array.isArray(schema.items)){for(i=0;i<data.length;i++)if(i<schema.items.length){if(error=this.validateAll(data[i],schema.items[i],[i],["items",i],dataPointerPath+"/"+i))return error}else if(void 0!==schema.additionalItems)if("boolean"==typeof schema.additionalItems){if(!schema.additionalItems&&(error=this.createError(ErrorCodes.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+i,"additionalItems"),this.handleError(error)))return error}else if(error=this.validateAll(data[i],schema.additionalItems,[i],["additionalItems"],dataPointerPath+"/"+i))return error}else for(i=0;i<data.length;i++)if(error=this.validateAll(data[i],schema.items,[i],["items"],dataPointerPath+"/"+i))return error;return null},ValidatorContext.prototype.validateObject=function(data,schema,dataPointerPath){return"object"!=typeof data||null===data||Array.isArray(data)?null:this.validateObjectMinMaxProperties(data,schema,dataPointerPath)||this.validateObjectRequiredProperties(data,schema,dataPointerPath)||this.validateObjectProperties(data,schema,dataPointerPath)||this.validateObjectDependencies(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateObjectMinMaxProperties=function(data,schema){var error,keys=Object.keys(data);return void 0!==schema.minProperties&&keys.length<schema.minProperties&&(error=this.createError(ErrorCodes.OBJECT_PROPERTIES_MINIMUM,{propertyCount:keys.length,minimum:schema.minProperties}).prefixWith(null,"minProperties"),this.handleError(error))?error:void 0!==schema.maxProperties&&keys.length>schema.maxProperties&&(error=this.createError(ErrorCodes.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:keys.length,maximum:schema.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(error))?error:null},ValidatorContext.prototype.validateObjectRequiredProperties=function(data,schema){if(void 0!==schema.required)for(var i=0;i<schema.required.length;i++){var key=schema.required[i];if(void 0===data[key]){var error=this.createError(ErrorCodes.OBJECT_REQUIRED,{key:key}).prefixWith(null,""+i).prefixWith(null,"required");if(this.handleError(error))return error}}return null},ValidatorContext.prototype.validateObjectProperties=function(data,schema,dataPointerPath){var error;for(var key in data){var keyPointerPath=dataPointerPath+"/"+key.replace(/~/g,"~0").replace(/\//g,"~1"),foundMatch=!1;if(void 0!==schema.properties&&void 0!==schema.properties[key]&&(foundMatch=!0,error=this.validateAll(data[key],schema.properties[key],[key],["properties",key],keyPointerPath)))return error;if(void 0!==schema.patternProperties)for(var patternKey in schema.patternProperties){var regexp=new RegExp(patternKey);if(regexp.test(key)&&(foundMatch=!0,error=this.validateAll(data[key],schema.patternProperties[patternKey],[key],["patternProperties",patternKey],keyPointerPath)))return error}if(foundMatch)this.trackUnknownProperties&&(this.knownPropertyPaths[keyPointerPath]=!0,delete this.unknownPropertyPaths[keyPointerPath]);else if(void 0!==schema.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[keyPointerPath]=!0,delete this.unknownPropertyPaths[keyPointerPath]),"boolean"==typeof schema.additionalProperties){if(!schema.additionalProperties&&(error=this.createError(ErrorCodes.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(key,"additionalProperties"),this.handleError(error)))return error}else if(error=this.validateAll(data[key],schema.additionalProperties,[key],["additionalProperties"],keyPointerPath))return error}else this.trackUnknownProperties&&!this.knownPropertyPaths[keyPointerPath]&&(this.unknownPropertyPaths[keyPointerPath]=!0)}return null},ValidatorContext.prototype.validateObjectDependencies=function(data,schema,dataPointerPath){var error;if(void 0!==schema.dependencies)for(var depKey in schema.dependencies)if(void 0!==data[depKey]){var dep=schema.dependencies[depKey];if("string"==typeof dep){if(void 0===data[dep]&&(error=this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY,{key:depKey,missing:dep}).prefixWith(null,depKey).prefixWith(null,"dependencies"),this.handleError(error)))return error}else if(Array.isArray(dep))for(var i=0;i<dep.length;i++){var requiredKey=dep[i];if(void 0===data[requiredKey]&&(error=this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY,{key:depKey,missing:requiredKey}).prefixWith(null,""+i).prefixWith(null,depKey).prefixWith(null,"dependencies"),this.handleError(error)))return error}else if(error=this.validateAll(data,dep,[],["dependencies",depKey],dataPointerPath))return error}return null},ValidatorContext.prototype.validateCombinations=function(data,schema,dataPointerPath){return this.validateAllOf(data,schema,dataPointerPath)||this.validateAnyOf(data,schema,dataPointerPath)||this.validateOneOf(data,schema,dataPointerPath)||this.validateNot(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateAllOf=function(data,schema,dataPointerPath){if(void 0===schema.allOf)return null;for(var error,i=0;i<schema.allOf.length;i++){var subSchema=schema.allOf[i];if(error=this.validateAll(data,subSchema,[],["allOf",i],dataPointerPath))return error}return null},ValidatorContext.prototype.validateAnyOf=function(data,schema,dataPointerPath){if(void 0===schema.anyOf)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,errors=[],startErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths);for(var errorAtEnd=!0,i=0;i<schema.anyOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var subSchema=schema.anyOf[i],errorCount=this.errors.length,error=this.validateAll(data,subSchema,[],["anyOf",i],dataPointerPath);if(null===error&&errorCount===this.errors.length){if(this.errors=this.errors.slice(0,startErrorCount),this.trackUnknownProperties){for(var knownKey in this.knownPropertyPaths)oldKnownPropertyPaths[knownKey]=!0,delete oldUnknownPropertyPaths[knownKey];for(var unknownKey in this.unknownPropertyPaths)oldKnownPropertyPaths[unknownKey]||(oldUnknownPropertyPaths[unknownKey]=!0);errorAtEnd=!1;continue}return null}error&&errors.push(error.prefixWith(null,""+i).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),errorAtEnd?(errors=errors.concat(this.errors.slice(startErrorCount)),this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ANY_OF_MISSING,{},"","/anyOf",errors)):void 0},ValidatorContext.prototype.validateOneOf=function(data,schema,dataPointerPath){if(void 0===schema.oneOf)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,validIndex=null,errors=[],startErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths);for(var i=0;i<schema.oneOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var subSchema=schema.oneOf[i],errorCount=this.errors.length,error=this.validateAll(data,subSchema,[],["oneOf",i],dataPointerPath);if(null===error&&errorCount===this.errors.length){if(null!==validIndex)return this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ONE_OF_MULTIPLE,{index1:validIndex,index2:i},"","/oneOf");if(validIndex=i,this.trackUnknownProperties){for(var knownKey in this.knownPropertyPaths)oldKnownPropertyPaths[knownKey]=!0,delete oldUnknownPropertyPaths[knownKey];for(var unknownKey in this.unknownPropertyPaths)oldKnownPropertyPaths[unknownKey]||(oldUnknownPropertyPaths[unknownKey]=!0)}}else error&&errors.push(error.prefixWith(null,""+i).prefixWith(null,"oneOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),null===validIndex?(errors=errors.concat(this.errors.slice(startErrorCount)),this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ONE_OF_MISSING,{},"","/oneOf",errors)):(this.errors=this.errors.slice(0,startErrorCount),null)},ValidatorContext.prototype.validateNot=function(data,schema,dataPointerPath){if(void 0===schema.not)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,oldErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var error=this.validateAll(data,schema.not,null,null,dataPointerPath),notErrors=this.errors.slice(oldErrorCount);return this.errors=this.errors.slice(0,oldErrorCount),this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),null===error&&0===notErrors.length?this.createError(ErrorCodes.NOT_PASSED,{},"","/not"):null};var ErrorCodes={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},ErrorCodeLookup={};for(var key in ErrorCodes)ErrorCodeLookup[ErrorCodes[key]]=key;var ErrorMessagesDefault={INVALID_TYPE:"invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};ValidationError.prototype=Object.create(Error.prototype),ValidationError.prototype.constructor=ValidationError,ValidationError.prototype.name="ValidationError",ValidationError.prototype.prefixWith=function(dataPrefix,schemaPrefix){if(null!==dataPrefix&&(dataPrefix=dataPrefix.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+dataPrefix+this.dataPath),null!==schemaPrefix&&(schemaPrefix=schemaPrefix.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+schemaPrefix+this.schemaPath),null!==this.subErrors)for(var i=0;i<this.subErrors.length;i++)this.subErrors[i].prefixWith(dataPrefix,schemaPrefix);return this};var languages={},tv4=createApi();return tv4.addLanguage("en-gb",ErrorMessagesDefault),tv4.tv4=tv4,tv4}),!function(undefined){var ObjectPath={parse:function(str){if("string"!=typeof str)throw new TypeError("ObjectPath.parse must be passed a string");for(var d,b,q,c,i=0,parts=[];i<str.length;)if(d=str.indexOf(".",i),b=str.indexOf("[",i),d===-1&&b===-1)parts.push(str.slice(i,str.length)),i=str.length;else if(b===-1||d!==-1&&d<b)parts.push(str.slice(i,d)),i=d+1;else if(b>i&&(parts.push(str.slice(i,b)),i=b),q=str.slice(b+1,b+2),'"'!==q&&"'"!==q)c=str.indexOf("]",b),c===-1&&(c=str.length),parts.push(str.slice(i+1,c)),i="."===str.slice(c+1,c+2)?c+2:c+1;else{for(c=str.indexOf(q+"]",b),c===-1&&(c=str.length);"\\"===str.slice(c-1,c)&&b<str.length;)b++,c=str.indexOf(q+"]",b);parts.push(str.slice(i+2,c).replace(new RegExp("\\"+q,"g"),q)),i="."===str.slice(c+2,c+3)?c+3:c+2}return parts},stringify:function(arr,quote){return Array.isArray(arr)||(arr=[arr.toString()]),quote='"'===quote?'"':"'",arr.map(function(n){return"["+quote+n.toString().replace(new RegExp(quote,"g"),"\\"+quote)+quote+"]"}).join("")},normalize:function(data,quote){return ObjectPath.stringify(Array.isArray(data)?data:ObjectPath.parse(data),quote)},registerModule:function(angular){angular.module("ObjectPath",[]).provider("ObjectPath",function(){this.parse=ObjectPath.parse,this.stringify=ObjectPath.stringify,this.normalize=ObjectPath.normalize,this.$get=function(){return ObjectPath}})}};"function"==typeof define&&define.amd?define(function(){return ObjectPath}):"object"==typeof exports?exports.ObjectPath=ObjectPath:window.ObjectPath=ObjectPath}(),function(window,angular,undefined){"use strict";angular.module("ngAnimate",["ng"]).directive("ngAnimateChildren",function(){var NG_ANIMATE_CHILDREN="$$ngAnimateChildren";return function(scope,element,attrs){var val=attrs.ngAnimateChildren;angular.isString(val)&&0===val.length?element.data(NG_ANIMATE_CHILDREN,!0):scope.$watch(val,function(value){element.data(NG_ANIMATE_CHILDREN,!!value)})}}).factory("$$animateReflow",["$$rAF","$document",function($$rAF,$document){var bod=$document[0].body;return function(fn){return $$rAF(function(){fn(bod.offsetWidth)})}}]).config(["$provide","$animateProvider",function($provide,$animateProvider){function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType==ELEMENT_NODE)return elm}}function prepareElement(element){return element&&angular.element(element)}function stripCommentsFromElement(element){return angular.element(extractElementNode(element))}function isMatchingElement(elm1,elm2){return extractElementNode(elm1)==extractElementNode(elm2)}var noop=angular.noop,forEach=angular.forEach,selectors=$animateProvider.$$selectors,ELEMENT_NODE=1,NG_ANIMATE_STATE="$$ngAnimateState",NG_ANIMATE_CHILDREN="$$ngAnimateChildren",NG_ANIMATE_CLASS_NAME="ng-animate",rootAnimateState={running:!0};$provide.decorator("$animate",["$delegate","$injector","$sniffer","$rootElement","$$asyncCallback","$rootScope","$document",function($delegate,$injector,$sniffer,$rootElement,$$asyncCallback,$rootScope,$document){function blockElementAnimations(element){var data=element.data(NG_ANIMATE_STATE)||{};data.running=!0,element.data(NG_ANIMATE_STATE,data)}function lookup(name){if(name){var matches=[],flagMap={},classes=name.substr(1).split(".");($sniffer.transitions||$sniffer.animations)&&matches.push($injector.get(selectors[""]));for(var i=0;i<classes.length;i++){var klass=classes[i],selectorFactoryName=selectors[klass];selectorFactoryName&&!flagMap[klass]&&(matches.push($injector.get(selectorFactoryName)),flagMap[klass]=!0)}return matches}}function animationRunner(element,animationEvent,className){function registerAnimation(animationFactory,event){var afterFn=animationFactory[event],beforeFn=animationFactory["before"+event.charAt(0).toUpperCase()+event.substr(1)];if(afterFn||beforeFn)return"leave"==event&&(beforeFn=afterFn,afterFn=null),after.push({event:event,fn:afterFn}),before.push({event:event,fn:beforeFn}),!0}function run(fns,cancellations,allCompleteFn){function afterAnimationComplete(index){if(cancellations){if((cancellations[index]||noop)(),++count<animations.length)return;cancellations=null}allCompleteFn()}var animations=[];forEach(fns,function(animation){animation.fn&&animations.push(animation)});var count=0;forEach(animations,function(animation,index){var progress=function(){afterAnimationComplete(index)};switch(animation.event){case"setClass":cancellations.push(animation.fn(element,classNameAdd,classNameRemove,progress));break;case"addClass":cancellations.push(animation.fn(element,classNameAdd||className,progress));break;case"removeClass":cancellations.push(animation.fn(element,classNameRemove||className,progress));break;default:cancellations.push(animation.fn(element,progress))}}),cancellations&&0===cancellations.length&&allCompleteFn()}var node=element[0];if(node){var classNameAdd,classNameRemove,isSetClassOperation="setClass"==animationEvent,isClassBased=isSetClassOperation||"addClass"==animationEvent||"removeClass"==animationEvent;angular.isArray(className)&&(classNameAdd=className[0],classNameRemove=className[1],className=classNameAdd+" "+classNameRemove);var currentClassName=element.attr("class"),classes=currentClassName+" "+className;if(isAnimatableClassName(classes)){var beforeComplete=noop,beforeCancel=[],before=[],afterComplete=noop,afterCancel=[],after=[],animationLookup=(" "+classes).replace(/\s+/g,".");return forEach(lookup(animationLookup),function(animationFactory){var created=registerAnimation(animationFactory,animationEvent);!created&&isSetClassOperation&&(registerAnimation(animationFactory,"addClass"),registerAnimation(animationFactory,"removeClass"))}),{node:node,event:animationEvent,className:className,isClassBased:isClassBased,isSetClassOperation:isSetClassOperation,before:function(allCompleteFn){beforeComplete=allCompleteFn,run(before,beforeCancel,function(){beforeComplete=noop,allCompleteFn()})},after:function(allCompleteFn){afterComplete=allCompleteFn,run(after,afterCancel,function(){afterComplete=noop,allCompleteFn()})},cancel:function(){beforeCancel&&(forEach(beforeCancel,function(cancelFn){(cancelFn||noop)(!0)}),beforeComplete(!0)),afterCancel&&(forEach(afterCancel,function(cancelFn){(cancelFn||noop)(!0)}),afterComplete(!0))}}}}}function performAnimation(animationEvent,className,element,parentElement,afterElement,domOperation,doneCallback){function fireDOMCallback(animationPhase){var eventName="$animate:"+animationPhase;elementEvents&&elementEvents[eventName]&&elementEvents[eventName].length>0&&$$asyncCallback(function(){element.triggerHandler(eventName,{event:animationEvent,className:className})})}function fireBeforeCallbackAsync(){fireDOMCallback("before")}function fireAfterCallbackAsync(){fireDOMCallback("after")}function fireDoneCallbackAsync(){fireDOMCallback("close"),doneCallback&&$$asyncCallback(function(){doneCallback()})}function fireDOMOperation(){fireDOMOperation.hasBeenRun||(fireDOMOperation.hasBeenRun=!0,domOperation())}function closeAnimation(){if(!closeAnimation.hasBeenRun){closeAnimation.hasBeenRun=!0;
var data=element.data(NG_ANIMATE_STATE);data&&(runner&&runner.isClassBased?cleanup(element,className):($$asyncCallback(function(){var data=element.data(NG_ANIMATE_STATE)||{};localAnimationCount==data.index&&cleanup(element,className,animationEvent)}),element.data(NG_ANIMATE_STATE,data))),fireDoneCallbackAsync()}}var runner=animationRunner(element,animationEvent,className);if(!runner)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void closeAnimation();className=runner.className;var elementEvents=angular.element._data(runner.node);elementEvents=elementEvents&&elementEvents.events,parentElement||(parentElement=afterElement?afterElement.parent():element.parent());var skipAnimations,ngAnimateState=element.data(NG_ANIMATE_STATE)||{},runningAnimations=ngAnimateState.active||{},totalActiveAnimations=ngAnimateState.totalActive||0,lastAnimation=ngAnimateState.last;if(runner.isClassBased&&(skipAnimations=ngAnimateState.running||ngAnimateState.disabled||lastAnimation&&!lastAnimation.isClassBased),skipAnimations||animationsDisabled(element,parentElement))return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void closeAnimation();var skipAnimation=!1;if(totalActiveAnimations>0){var animationsToCancel=[];if(runner.isClassBased){if("setClass"==lastAnimation.event)animationsToCancel.push(lastAnimation),cleanup(element,className);else if(runningAnimations[className]){var current=runningAnimations[className];current.event==animationEvent?skipAnimation=!0:(animationsToCancel.push(current),cleanup(element,className))}}else if("leave"==animationEvent&&runningAnimations["ng-leave"])skipAnimation=!0;else{for(var klass in runningAnimations)animationsToCancel.push(runningAnimations[klass]),cleanup(element,klass);runningAnimations={},totalActiveAnimations=0}animationsToCancel.length>0&&forEach(animationsToCancel,function(operation){operation.cancel()})}if(!runner.isClassBased||runner.isSetClassOperation||skipAnimation||(skipAnimation="addClass"==animationEvent==element.hasClass(className)),skipAnimation)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void fireDoneCallbackAsync();"leave"==animationEvent&&element.one("$destroy",function(e){var element=angular.element(this),state=element.data(NG_ANIMATE_STATE);if(state){var activeLeaveAnimation=state.active["ng-leave"];activeLeaveAnimation&&(activeLeaveAnimation.cancel(),cleanup(element,"ng-leave"))}}),element.addClass(NG_ANIMATE_CLASS_NAME);var localAnimationCount=globalAnimationCounter++;totalActiveAnimations++,runningAnimations[className]=runner,element.data(NG_ANIMATE_STATE,{last:runner,active:runningAnimations,index:localAnimationCount,totalActive:totalActiveAnimations}),fireBeforeCallbackAsync(),runner.before(function(cancelled){var data=element.data(NG_ANIMATE_STATE);cancelled=cancelled||!data||!data.active[className]||runner.isClassBased&&data.active[className].event!=animationEvent,fireDOMOperation(),cancelled===!0?closeAnimation():(fireAfterCallbackAsync(),runner.after(closeAnimation))})}function cancelChildAnimations(element){var node=extractElementNode(element);if(node){var nodes=angular.isFunction(node.getElementsByClassName)?node.getElementsByClassName(NG_ANIMATE_CLASS_NAME):node.querySelectorAll("."+NG_ANIMATE_CLASS_NAME);forEach(nodes,function(element){element=angular.element(element);var data=element.data(NG_ANIMATE_STATE);data&&data.active&&forEach(data.active,function(runner){runner.cancel()})})}}function cleanup(element,className){if(isMatchingElement(element,$rootElement))rootAnimateState.disabled||(rootAnimateState.running=!1,rootAnimateState.structural=!1);else if(className){var data=element.data(NG_ANIMATE_STATE)||{},removeAnimations=className===!0;!removeAnimations&&data.active&&data.active[className]&&(data.totalActive--,delete data.active[className]),!removeAnimations&&data.totalActive||(element.removeClass(NG_ANIMATE_CLASS_NAME),element.removeData(NG_ANIMATE_STATE))}}function animationsDisabled(element,parentElement){if(rootAnimateState.disabled)return!0;if(isMatchingElement(element,$rootElement))return rootAnimateState.running;var allowChildAnimations,parentRunningAnimation,hasParent;do{if(0===parentElement.length)break;var isRoot=isMatchingElement(parentElement,$rootElement),state=isRoot?rootAnimateState:parentElement.data(NG_ANIMATE_STATE)||{};if(state.disabled)return!0;if(isRoot&&(hasParent=!0),allowChildAnimations!==!1){var animateChildrenFlag=parentElement.data(NG_ANIMATE_CHILDREN);angular.isDefined(animateChildrenFlag)&&(allowChildAnimations=animateChildrenFlag)}parentRunningAnimation=parentRunningAnimation||state.running||state.last&&!state.last.isClassBased}while(parentElement=parentElement.parent());return!hasParent||!allowChildAnimations&&parentRunningAnimation}var globalAnimationCounter=0;$rootElement.data(NG_ANIMATE_STATE,rootAnimateState),$rootScope.$$postDigest(function(){$rootScope.$$postDigest(function(){rootAnimateState.running=!1})});var classNameFilter=$animateProvider.classNameFilter(),isAnimatableClassName=classNameFilter?function(className){return classNameFilter.test(className)}:function(){return!0};return{enter:function(element,parentElement,afterElement,doneCallback){element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),blockElementAnimations(element),$delegate.enter(element,parentElement,afterElement),$rootScope.$$postDigest(function(){element=stripCommentsFromElement(element),performAnimation("enter","ng-enter",element,parentElement,afterElement,noop,doneCallback)})},leave:function(element,doneCallback){element=angular.element(element),cancelChildAnimations(element),blockElementAnimations(element),$rootScope.$$postDigest(function(){performAnimation("leave","ng-leave",stripCommentsFromElement(element),null,null,function(){$delegate.leave(element)},doneCallback)})},move:function(element,parentElement,afterElement,doneCallback){element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),cancelChildAnimations(element),blockElementAnimations(element),$delegate.move(element,parentElement,afterElement),$rootScope.$$postDigest(function(){element=stripCommentsFromElement(element),performAnimation("move","ng-move",element,parentElement,afterElement,noop,doneCallback)})},addClass:function(element,className,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("addClass",className,element,null,null,function(){$delegate.addClass(element,className)},doneCallback)},removeClass:function(element,className,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("removeClass",className,element,null,null,function(){$delegate.removeClass(element,className)},doneCallback)},setClass:function(element,add,remove,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("setClass",[add,remove],element,null,null,function(){$delegate.setClass(element,add,remove)},doneCallback)},enabled:function(value,element){switch(arguments.length){case 2:if(value)cleanup(element);else{var data=element.data(NG_ANIMATE_STATE)||{};data.disabled=!0,element.data(NG_ANIMATE_STATE,data)}break;case 1:rootAnimateState.disabled=!value;break;default:value=!rootAnimateState.disabled}return!!value}}}]),$animateProvider.register("",["$window","$sniffer","$timeout","$$animateReflow",function($window,$sniffer,$timeout,$$animateReflow){function clearCacheAfterReflow(){cancelAnimationReflow||(cancelAnimationReflow=$$animateReflow(function(){animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}}))}function afterReflow(element,callback){cancelAnimationReflow&&cancelAnimationReflow(),animationReflowQueue.push(callback),cancelAnimationReflow=$$animateReflow(function(){forEach(animationReflowQueue,function(fn){fn()}),animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}})}function animationCloseHandler(element,totalTime){var node=extractElementNode(element);element=angular.element(node),animationElementQueue.push(element);var futureTimestamp=Date.now()+totalTime;futureTimestamp<=closingTimestamp||($timeout.cancel(closingTimer),closingTimestamp=futureTimestamp,closingTimer=$timeout(function(){closeAllAnimations(animationElementQueue),animationElementQueue=[]},totalTime,!1))}function closeAllAnimations(elements){forEach(elements,function(element){var elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);elementData&&(elementData.closeAnimationFn||noop)()})}function getElementAnimationDetails(element,cacheKey){var data=cacheKey?lookupCache[cacheKey]:null;if(!data){var transitionDelayStyle,animationDelayStyle,transitionDurationStyle,transitionPropertyStyle,transitionDuration=0,transitionDelay=0,animationDuration=0,animationDelay=0;forEach(element,function(element){if(element.nodeType==ELEMENT_NODE){var elementStyles=$window.getComputedStyle(element)||{};transitionDurationStyle=elementStyles[TRANSITION_PROP+DURATION_KEY],transitionDuration=Math.max(parseMaxTime(transitionDurationStyle),transitionDuration),transitionPropertyStyle=elementStyles[TRANSITION_PROP+PROPERTY_KEY],transitionDelayStyle=elementStyles[TRANSITION_PROP+DELAY_KEY],transitionDelay=Math.max(parseMaxTime(transitionDelayStyle),transitionDelay),animationDelayStyle=elementStyles[ANIMATION_PROP+DELAY_KEY],animationDelay=Math.max(parseMaxTime(animationDelayStyle),animationDelay);var aDuration=parseMaxTime(elementStyles[ANIMATION_PROP+DURATION_KEY]);aDuration>0&&(aDuration*=parseInt(elementStyles[ANIMATION_PROP+ANIMATION_ITERATION_COUNT_KEY],10)||1),animationDuration=Math.max(aDuration,animationDuration)}}),data={total:0,transitionPropertyStyle:transitionPropertyStyle,transitionDurationStyle:transitionDurationStyle,transitionDelayStyle:transitionDelayStyle,transitionDelay:transitionDelay,transitionDuration:transitionDuration,animationDelayStyle:animationDelayStyle,animationDelay:animationDelay,animationDuration:animationDuration},cacheKey&&(lookupCache[cacheKey]=data)}return data}function parseMaxTime(str){var maxValue=0,values=angular.isString(str)?str.split(/\s*,\s*/):[];return forEach(values,function(value){maxValue=Math.max(parseFloat(value)||0,maxValue)}),maxValue}function getCacheKey(element){var parentElement=element.parent(),parentID=parentElement.data(NG_ANIMATE_PARENT_KEY);return parentID||(parentElement.data(NG_ANIMATE_PARENT_KEY,++parentCounter),parentID=parentCounter),parentID+"-"+extractElementNode(element).getAttribute("class")}function animateSetup(animationEvent,element,className,calculationDecorator){var cacheKey=getCacheKey(element),eventCacheKey=cacheKey+" "+className,itemIndex=lookupCache[eventCacheKey]?++lookupCache[eventCacheKey].total:0,stagger={};if(itemIndex>0){var staggerClassName=className+"-stagger",staggerCacheKey=cacheKey+" "+staggerClassName,applyClasses=!lookupCache[staggerCacheKey];applyClasses&&element.addClass(staggerClassName),stagger=getElementAnimationDetails(element,staggerCacheKey),applyClasses&&element.removeClass(staggerClassName)}calculationDecorator=calculationDecorator||function(fn){return fn()},element.addClass(className);var formerData=element.data(NG_ANIMATE_CSS_DATA_KEY)||{},timings=calculationDecorator(function(){return getElementAnimationDetails(element,eventCacheKey)}),transitionDuration=timings.transitionDuration,animationDuration=timings.animationDuration;if(0===transitionDuration&&0===animationDuration)return element.removeClass(className),!1;element.data(NG_ANIMATE_CSS_DATA_KEY,{running:formerData.running||0,itemIndex:itemIndex,stagger:stagger,timings:timings,closeAnimationFn:noop});var isCurrentlyAnimating=formerData.running>0||"setClass"==animationEvent;return transitionDuration>0&&blockTransitions(element,className,isCurrentlyAnimating),animationDuration>0&&stagger.animationDelay>0&&0===stagger.animationDuration&&blockKeyframeAnimations(element),!0}function isStructuralAnimation(className){return"ng-enter"==className||"ng-move"==className||"ng-leave"==className}function blockTransitions(element,className,isAnimating){isStructuralAnimation(className)||!isAnimating?extractElementNode(element).style[TRANSITION_PROP+PROPERTY_KEY]="none":element.addClass(NG_ANIMATE_BLOCK_CLASS_NAME)}function blockKeyframeAnimations(element){extractElementNode(element).style[ANIMATION_PROP]="none 0s"}function unblockTransitions(element,className){var prop=TRANSITION_PROP+PROPERTY_KEY,node=extractElementNode(element);node.style[prop]&&node.style[prop].length>0&&(node.style[prop]=""),element.removeClass(NG_ANIMATE_BLOCK_CLASS_NAME)}function unblockKeyframeAnimations(element){var prop=ANIMATION_PROP,node=extractElementNode(element);node.style[prop]&&node.style[prop].length>0&&(node.style[prop]="")}function animateRun(animationEvent,element,className,activeAnimationComplete){function onEnd(cancelled){element.off(css3AnimationEvents,onAnimationProgress),element.removeClass(activeClassName),animateClose(element,className);var node=extractElementNode(element);for(var i in appliedStyles)node.style.removeProperty(appliedStyles[i])}function onAnimationProgress(event){event.stopPropagation();var ev=event.originalEvent||event,timeStamp=ev.$manualTimeStamp||Date.now(),elapsedTime=parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));Math.max(timeStamp-startTime,0)>=maxDelayTime&&elapsedTime>=maxDuration&&activeAnimationComplete()}var node=extractElementNode(element),elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);if(node.getAttribute("class").indexOf(className)==-1||!elementData)return void activeAnimationComplete();var activeClassName="";forEach(className.split(" "),function(klass,i){activeClassName+=(i>0?" ":"")+klass+"-active"});var stagger=elementData.stagger,timings=elementData.timings,itemIndex=elementData.itemIndex,maxDuration=Math.max(timings.transitionDuration,timings.animationDuration),maxDelay=Math.max(timings.transitionDelay,timings.animationDelay),maxDelayTime=maxDelay*ONE_SECOND,startTime=Date.now(),css3AnimationEvents=ANIMATIONEND_EVENT+" "+TRANSITIONEND_EVENT,style="",appliedStyles=[];if(timings.transitionDuration>0){var propertyStyle=timings.transitionPropertyStyle;propertyStyle.indexOf("all")==-1&&(style+=CSS_PREFIX+"transition-property: "+propertyStyle+";",style+=CSS_PREFIX+"transition-duration: "+timings.transitionDurationStyle+";",appliedStyles.push(CSS_PREFIX+"transition-property"),appliedStyles.push(CSS_PREFIX+"transition-duration"))}if(itemIndex>0){if(stagger.transitionDelay>0&&0===stagger.transitionDuration){var delayStyle=timings.transitionDelayStyle;style+=CSS_PREFIX+"transition-delay: "+prepareStaggerDelay(delayStyle,stagger.transitionDelay,itemIndex)+"; ",appliedStyles.push(CSS_PREFIX+"transition-delay")}stagger.animationDelay>0&&0===stagger.animationDuration&&(style+=CSS_PREFIX+"animation-delay: "+prepareStaggerDelay(timings.animationDelayStyle,stagger.animationDelay,itemIndex)+"; ",appliedStyles.push(CSS_PREFIX+"animation-delay"))}if(appliedStyles.length>0){var oldStyle=node.getAttribute("style")||"";node.setAttribute("style",oldStyle+"; "+style)}element.on(css3AnimationEvents,onAnimationProgress),element.addClass(activeClassName),elementData.closeAnimationFn=function(){onEnd(),activeAnimationComplete()};var staggerTime=itemIndex*(Math.max(stagger.animationDelay,stagger.transitionDelay)||0),animationTime=(maxDelay+maxDuration)*CLOSING_TIME_BUFFER,totalTime=(staggerTime+animationTime)*ONE_SECOND;return elementData.running++,animationCloseHandler(element,totalTime),onEnd}function prepareStaggerDelay(delayStyle,staggerDelay,index){var style="";return forEach(delayStyle.split(","),function(val,i){style+=(i>0?",":"")+(index*staggerDelay+parseInt(val,10))+"s"}),style}function animateBefore(animationEvent,element,className,calculationDecorator){if(animateSetup(animationEvent,element,className,calculationDecorator))return function(cancelled){cancelled&&animateClose(element,className)}}function animateAfter(animationEvent,element,className,afterAnimationComplete){return element.data(NG_ANIMATE_CSS_DATA_KEY)?animateRun(animationEvent,element,className,afterAnimationComplete):(animateClose(element,className),void afterAnimationComplete())}function animate(animationEvent,element,className,animationComplete){var preReflowCancellation=animateBefore(animationEvent,element,className);if(!preReflowCancellation)return clearCacheAfterReflow(),void animationComplete();var cancel=preReflowCancellation;return afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),cancel=animateAfter(animationEvent,element,className,animationComplete)}),function(cancelled){(cancel||noop)(cancelled)}}function animateClose(element,className){element.removeClass(className);var data=element.data(NG_ANIMATE_CSS_DATA_KEY);data&&(data.running&&data.running--,data.running&&0!==data.running||element.removeData(NG_ANIMATE_CSS_DATA_KEY))}function suffixClasses(classes,suffix){var className="";return classes=angular.isArray(classes)?classes:classes.split(/\s+/),forEach(classes,function(klass,i){klass&&klass.length>0&&(className+=(i>0?" ":"")+klass+suffix)}),className}var TRANSITION_PROP,TRANSITIONEND_EVENT,ANIMATION_PROP,ANIMATIONEND_EVENT,CSS_PREFIX="";window.ontransitionend===undefined&&window.onwebkittransitionend!==undefined?(CSS_PREFIX="-webkit-",TRANSITION_PROP="WebkitTransition",TRANSITIONEND_EVENT="webkitTransitionEnd transitionend"):(TRANSITION_PROP="transition",TRANSITIONEND_EVENT="transitionend"),window.onanimationend===undefined&&window.onwebkitanimationend!==undefined?(CSS_PREFIX="-webkit-",ANIMATION_PROP="WebkitAnimation",ANIMATIONEND_EVENT="webkitAnimationEnd animationend"):(ANIMATION_PROP="animation",ANIMATIONEND_EVENT="animationend");var cancelAnimationReflow,DURATION_KEY="Duration",PROPERTY_KEY="Property",DELAY_KEY="Delay",ANIMATION_ITERATION_COUNT_KEY="IterationCount",NG_ANIMATE_PARENT_KEY="$$ngAnimateKey",NG_ANIMATE_CSS_DATA_KEY="$$ngAnimateCSS3Data",NG_ANIMATE_BLOCK_CLASS_NAME="ng-animate-block-transitions",ELAPSED_TIME_MAX_DECIMAL_PLACES=3,CLOSING_TIME_BUFFER=1.5,ONE_SECOND=1e3,lookupCache={},parentCounter=0,animationReflowQueue=[],closingTimer=null,closingTimestamp=0,animationElementQueue=[];return{enter:function(element,animationCompleted){return animate("enter",element,"ng-enter",animationCompleted)},leave:function(element,animationCompleted){return animate("leave",element,"ng-leave",animationCompleted)},move:function(element,animationCompleted){return animate("move",element,"ng-move",animationCompleted)},beforeSetClass:function(element,add,remove,animationCompleted){var className=suffixClasses(remove,"-remove")+" "+suffixClasses(add,"-add"),cancellationMethod=animateBefore("setClass",element,className,function(fn){var klass=element.attr("class");element.removeClass(remove),element.addClass(add);var timings=fn();return element.attr("class",klass),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},beforeAddClass:function(element,className,animationCompleted){var cancellationMethod=animateBefore("addClass",element,suffixClasses(className,"-add"),function(fn){element.addClass(className);var timings=fn();return element.removeClass(className),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},setClass:function(element,add,remove,animationCompleted){remove=suffixClasses(remove,"-remove"),add=suffixClasses(add,"-add");var className=remove+" "+add;return animateAfter("setClass",element,className,animationCompleted)},addClass:function(element,className,animationCompleted){return animateAfter("addClass",element,suffixClasses(className,"-add"),animationCompleted)},beforeRemoveClass:function(element,className,animationCompleted){var cancellationMethod=animateBefore("removeClass",element,suffixClasses(className,"-remove"),function(fn){var klass=element.attr("class");element.removeClass(className);var timings=fn();return element.attr("class",klass),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):void animationCompleted()},removeClass:function(element,className,animationCompleted){return animateAfter("removeClass",element,suffixClasses(className,"-remove"),animationCompleted)}}}])}])}(window,window.angular),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function bubbleUp(heap,weightFunc,n){for(var element=heap[n],weight=weightFunc(element);n>0;){var parentN=Math.floor((n+1)/2)-1,parent=heap[parentN];if(weight>=weightFunc(parent))break;heap[parentN]=element,heap[n]=parent,n=parentN}}function bubbleDown(heap,weightFunc,n){for(var length=heap.length,node=heap[n],nodeWeight=weightFunc(node);;){var child2N=2*(n+1),child1N=child2N-1,swap=null;if(child1N<length){var child1=heap[child1N],child1Weight=weightFunc(child1);child1Weight<nodeWeight&&(swap=child1N)}if(child2N<length){var child2=heap[child2N],child2Weight=weightFunc(child2);child2Weight<(null===swap?nodeWeight:weightFunc(heap[child1N]))&&(swap=child2N)}if(null===swap)break;heap[n]=heap[swap],heap[swap]=node,n=swap}}function DSBinaryHeap(weightFunc){if(weightFunc&&!angular.isFunction(weightFunc))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");weightFunc=weightFunc||function(x){return x},this.weightFunc=weightFunc,this.heap=[]}function DSBinaryHeapProvider(){this.$get=function(){return DSBinaryHeap}}DSBinaryHeap.prototype.push=function(node){this.heap.push(node),bubbleUp(this.heap,this.weightFunc,this.heap.length-1)},DSBinaryHeap.prototype.peek=function(){return this.heap[0]},DSBinaryHeap.prototype.pop=function(){var front=this.heap[0],end=this.heap.pop();return this.heap.length>0&&(this.heap[0]=end,bubbleDown(this.heap,this.weightFunc,0)),front},DSBinaryHeap.prototype.remove=function(node){for(var length=this.heap.length,i=0;i<length;i++)if(angular.equals(this.heap[i],node)){var removed=this.heap[i],end=this.heap.pop();return i!==length-1&&(this.heap[i]=end,bubbleUp(this.heap,this.weightFunc,i),bubbleDown(this.heap,this.weightFunc,i)),removed}return null},DSBinaryHeap.prototype.removeAll=function(){this.heap=[]},DSBinaryHeap.prototype.size=function(){return this.heap.length},module.exports={DSBinaryHeapProvider:DSBinaryHeapProvider,DSBinaryHeap:DSBinaryHeap}},{}],2:[function(require,module,exports){module.exports=function(){var _this=this;clearInterval(_this.$$cacheFlushIntervalId),clearInterval(_this.$$recycleFreqId),_this.removeAll(),_this.$$storage&&(_this.$$storage().removeItem(_this.$$prefix+".keys"),_this.$$storage().removeItem(_this.$$prefix)),_this.$$storage=null,_this.$$data=null,_this.$$lruHeap=null,_this.$$expiresHeap=null,_this.$$prefix=null}},{}],3:[function(require,module,exports){var utils=require("../utils");module.exports=function(key,options){var _this=this;if(angular.isArray(key)){var keys=key,values=[];return angular.forEach(keys,function(key){var value=_this.get(key,options);null!==value&&void 0!==value&&values.push(value)}),values}if(key=utils.stringifyNumber(key),!_this.$$disabled){if(options=options||{},!angular.isString(key))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof key);if(options&&!angular.isObject(options))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof options);if(options.onExpire&&!angular.isFunction(options.onExpire))throw angular.$$minErr("ng")("areq","Expected options.onExpire to be a function! Found: {0}.",typeof options.onExpire);var item;if(_this.$$storage){if(_this.$$promises[key])return _this.$$promises[key];var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(!itemJson)return;item=angular.fromJson(itemJson)}else{if(!(key in _this.$$data))return;item=_this.$$data[key]}var value=item.value,now=(new Date).getTime();return _this.$$storage?(_this.$$lruHeap.remove({key:key,accessed:item.accessed}),item.accessed=now,_this.$$lruHeap.push({key:key,accessed:now})):(_this.$$lruHeap.remove(item),item.accessed=now,_this.$$lruHeap.push(item)),"passive"===_this.$$deleteOnExpire&&"expires"in item&&item.expires<now?(_this.remove(key),_this.$$onExpire?_this.$$onExpire(key,item.value,options.onExpire):options.onExpire&&options.onExpire(key,item.value),value=void 0):_this.$$storage&&_this.$$storage().setItem(_this.$$prefix+".data."+key,JSON.stringify(item)),value}}},{"../utils":21}],4:[function(require,module,exports){function _setStorageMode(storageMode,storageImpl){var _this=this;if(!angular.isString(storageMode))throw angular.$$minErr("ng")("areq","Expected storageMode to be a string! Found: {0}.",typeof storageMode);if("memory"!==storageMode&&"localStorage"!==storageMode&&"sessionStorage"!==storageMode)throw angular.$$minErr("ng")("areq",'Expected storageMode to be "memory", "localStorage" or "sessionStorage"! Found: {0}.',storageMode);if(_this.$$storageMode=storageMode,storageImpl){if(!angular.isObject(storageImpl))throw angular.$$minErr("ng")("areq","Expected storageImpl to be an object! Found: {0}.",typeof storageImpl);if(!("setItem"in storageImpl&&"function"==typeof storageImpl.setItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "setItem(key, value)"! Found: {0}.',typeof storageImpl.setItem);if(!("getItem"in storageImpl&&"function"==typeof storageImpl.getItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "getItem(key)"! Found: {0}.',typeof storageImpl.getItem);if(!("removeItem"in storageImpl)||"function"!=typeof storageImpl.removeItem)throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "removeItem(key)"! Found: {0}.',typeof storageImpl.removeItem);_this.$$storage=function(){return storageImpl}}else if("localStorage"===_this.$$storageMode)try{localStorage.setItem("angular-cache","angular-cache"),localStorage.removeItem("angular-cache"),_this.$$storage=function(){return localStorage}}catch(e){delete _this.$$storage,_this.$$storageMode="memory"}else if("sessionStorage"===_this.$$storageMode)try{sessionStorage.setItem("angular-cache","angular-cache"),sessionStorage.removeItem("angular-cache"),_this.$$storage=function(){return sessionStorage}}catch(e){delete _this.$$storage,_this.$$storageMode="memory"}}function _setOptions(cacheOptions,strict){var _this=this;if(cacheOptions=cacheOptions||{},strict=!!strict,!angular.isObject(cacheOptions))throw angular.$$minErr("ng")("areq","Expected cacheOptions to be an object! Found: {0}.",typeof cacheOptions);"disabled"in cacheOptions?_this.$$disabled=!!cacheOptions.disabled:strict&&delete _this.$$disabled,"storeOnResolve"in cacheOptions?_this.$$storeOnResolve=!!cacheOptions.storeOnResolve:strict&&(_this.$$storeOnResolve=!1),"storeOnReject"in cacheOptions?_this.$$storeOnReject=!!cacheOptions.storeOnReject:strict&&(_this.$$storeOnReject=!1),"capacity"in cacheOptions?_this.setCapacity(cacheOptions.capacity):strict&&_this.setCapacity(null),"deleteOnExpire"in cacheOptions?_this.setDeleteOnExpire(cacheOptions.deleteOnExpire):strict&&_this.setDeleteOnExpire(null),"maxAge"in cacheOptions?_this.setMaxAge(cacheOptions.maxAge):strict&&_this.setMaxAge(null),"recycleFreq"in cacheOptions?_this.setRecycleFreq(cacheOptions.recycleFreq):strict&&_this.setRecycleFreq(null),"cacheFlushInterval"in cacheOptions?_this.setCacheFlushInterval(cacheOptions.cacheFlushInterval):strict&&_this.setCacheFlushInterval(null),"onExpire"in cacheOptions?_this.setOnExpire(cacheOptions.onExpire):strict&&_this.setOnExpire(null)}function DSCache(cacheId,options){var _this=this;_this.$$data={},_this.$$promises={},_this.$$id=cacheId,_this.$$storage=null,_this.$$expiresHeap=new DSBinaryHeap(function(x){return x.expires}),_this.$$lruHeap=new DSBinaryHeap(function(x){return x.accessed}),options=options||{},"storageMode"in options&&_setStorageMode.apply(_this,[options.storageMode,options.storageImpl]),"storagePrefix"in options&&(_this.$$storagePrefix=options.storagePrefix),_this.$$prefix=_this.$$storagePrefix+cacheId,_setOptions.apply(_this,[options,!0])}var defaults=require("../defaults"),DSBinaryHeap=require("../DSBinaryHeap").DSBinaryHeap;for(var key in defaults.defaults)DSCache.prototype["$$"+key]=defaults.defaults[key];DSCache.prototype.setOptions=_setOptions,DSCache.prototype.setCapacity=require("./setCapacity"),DSCache.prototype.setDeleteOnExpire=require("./setDeleteOnExpire"),DSCache.prototype.setMaxAge=require("./setMaxAge"),DSCache.prototype.setRecycleFreq=require("./setRecycleFreq"),DSCache.prototype.setCacheFlushInterval=require("./setCacheFlushInterval"),DSCache.prototype.setOnExpire=require("./setOnExpire"),DSCache.prototype.put=require("./put"),DSCache.prototype.get=require("./get"),DSCache.prototype.remove=require("./remove"),DSCache.prototype.removeAll=require("./removeAll"),DSCache.prototype.removeExpired=require("./removeExpired"),DSCache.prototype.destroy=require("./destroy"),DSCache.prototype.info=require("./info"),DSCache.prototype.keySet=require("./keySet"),DSCache.prototype.keys=require("./keys"),DSCache.prototype.disable=function(){this.$$disabled=!0},DSCache.prototype.enable=function(){delete this.$$disabled},DSCache.prototype.touch=function(key){var _this=this;if(key){var val=_this.get(key,{onExpire:function(k,v){_this.put(k,v)}});val&&_this.put(key,val)}else for(var keys=_this.keys(),i=0;i<keys.length;i++)_this.touch(keys[i])},module.exports=DSCache},{"../DSBinaryHeap":1,"../defaults":19,"./destroy":2,"./get":3,"./info":5,"./keySet":6,"./keys":7,"./put":8,"./remove":9,"./removeAll":10,"./removeExpired":11,"./setCacheFlushInterval":12,"./setCapacity":13,"./setDeleteOnExpire":14,"./setMaxAge":15,"./setOnExpire":16,"./setRecycleFreq":17}],5:[function(require,module,exports){module.exports=function(key){var _this=this;if(key){var item;if(_this.$$storage){var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);return itemJson?(item=angular.fromJson(itemJson),{created:item.created,accessed:item.accessed,expires:item.expires,isExpired:(new Date).getTime()-item.created>_this.$$maxAge}):void 0}return key in _this.$$data?(item=_this.$$data[key],{created:item.created,accessed:item.accessed,expires:item.expires,isExpired:(new Date).getTime()-item.created>_this.$$maxAge}):void 0}return{id:_this.$$id,capacity:_this.$$capacity,maxAge:_this.$$maxAge,deleteOnExpire:_this.$$deleteOnExpire,onExpire:_this.$$onExpire,cacheFlushInterval:_this.$$cacheFlushInterval,recycleFreq:_this.$$recycleFreq,storageMode:_this.$$storageMode,storageImpl:_this.$$storage?_this.$$storage():void 0,disabled:_this.$$disabled,size:_this.$$lruHeap&&_this.$$lruHeap.size()||0}}},{}],6:[function(require,module,exports){var utils=require("../utils");module.exports=function(){var _this=this;if(_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),kSet={};if(keysJson)for(var keys=angular.fromJson(keysJson),i=0;i<keys.length;i++)kSet[keys[i]]=keys[i];return kSet}return utils.keySet(_this.$$data)}},{"../utils":21}],7:[function(require,module,exports){var utils=require("../utils");module.exports=function(){var _this=this;if(_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");return keysJson?angular.fromJson(keysJson):[]}return utils.keys(_this.$$data);
}},{"../utils":21}],8:[function(require,module,exports){function isPromiseLike(v){return v&&"function"==typeof v.then}var utils=require("../utils");module.exports=function(key,value,options){function getHandler(store,isError){return function(v){return store&&(delete _this.$$promises[key],angular.isObject(v)&&"status"in v&&"data"in v?(v=[v.status,v.data,v.headers(),v.statusText],_this.put(key,v)):_this.put(key,v)),isError?_this.$q.reject(v):v}}options=options||{};var _this=this,storeOnResolve="storeOnResolve"in options?!!options.storeOnResolve:_this.$$storeOnResolve,storeOnReject="storeOnReject"in options?!!options.storeOnReject:_this.$$storeOnReject;if(!_this.$$disabled&&null!==value&&void 0!==value){if(key=utils.stringifyNumber(key),!angular.isString(key))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof key);var now=(new Date).getTime(),item={key:key,value:isPromiseLike(value)?value.then(getHandler(storeOnResolve,!1),getHandler(storeOnReject,!0)):value,created:now,accessed:now};if(item.expires=item.created+_this.$$maxAge,_this.$$storage){if(isPromiseLike(item.value))return _this.$$promises[key]=item.value,_this.$$promises[key];var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),keys=keysJson?angular.fromJson(keysJson):[],itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);itemJson&&_this.remove(key),_this.$$expiresHeap.push({key:key,expires:item.expires}),_this.$$lruHeap.push({key:key,accessed:item.accessed}),_this.$$storage().setItem(_this.$$prefix+".data."+key,JSON.stringify(item));for(var exists=!1,i=0;i<keys.length;i++)if(keys[i]===key){exists=!0;break}exists||keys.push(key),_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify(keys))}else _this.$$data[key]&&_this.remove(key),_this.$$expiresHeap.push(item),_this.$$lruHeap.push(item),_this.$$data[key]=item,delete _this.$$promises[key];return _this.$$lruHeap.size()>_this.$$capacity&&_this.remove(_this.$$lruHeap.peek().key),value}}},{"../utils":21}],9:[function(require,module,exports){module.exports=function(key){var _this=this;if(key+="",delete _this.$$promises[key],!_this.$$storage){var value=_this.$$data[key]?_this.$$data[key].value:void 0;return _this.$$lruHeap.remove(_this.$$data[key]),_this.$$expiresHeap.remove(_this.$$data[key]),_this.$$data[key]=null,delete _this.$$data[key],value}var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(itemJson){var item=angular.fromJson(itemJson);_this.$$lruHeap.remove({key:key,accessed:item.accessed}),_this.$$expiresHeap.remove({key:key,expires:item.expires}),_this.$$storage().removeItem(_this.$$prefix+".data."+key);var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),keys=keysJson?angular.fromJson(keysJson):[],index=keys.indexOf(key);return index>=0&&keys.splice(index,1),_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify(keys)),item.value}}},{}],10:[function(require,module,exports){module.exports=function(){var _this=this;if(_this.$$storage){_this.$$lruHeap.removeAll(),_this.$$expiresHeap.removeAll();var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");if(keysJson)for(var keys=angular.fromJson(keysJson),i=0;i<keys.length;i++)_this.remove(keys[i]);_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify([]))}else{_this.$$lruHeap.removeAll(),_this.$$expiresHeap.removeAll();for(var key in _this.$$data)_this.$$data[key]=null;_this.$$data={}}}},{}],11:[function(require,module,exports){module.exports=function(){for(var key,expiredItem,_this=this,now=(new Date).getTime(),expired={};(expiredItem=_this.$$expiresHeap.peek())&&expiredItem.expires<=now;)expired[expiredItem.key]=expiredItem.value?expiredItem.value:null,_this.$$expiresHeap.pop();if(_this.$$storage)for(key in expired){var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);itemJson&&(expired[key]=angular.fromJson(itemJson).value,_this.remove(key))}else for(key in expired)_this.remove(key);if(_this.$$onExpire)for(key in expired)_this.$$onExpire(key,expired[key]);return expired}},{}],12:[function(require,module,exports){module.exports=function(cacheFlushInterval){var _this=this;if(null===cacheFlushInterval)delete _this.$$cacheFlushInterval;else{if(!angular.isNumber(cacheFlushInterval))throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be a number! Found: {0}.",typeof cacheFlushInterval);if(cacheFlushInterval<0)throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be greater than zero! Found: {0}.",cacheFlushInterval);cacheFlushInterval!==_this.$$cacheFlushInterval&&(_this.$$cacheFlushInterval=cacheFlushInterval,clearInterval(_this.$$cacheFlushIntervalId),function(self){self.$$cacheFlushIntervalId=setInterval(function(){self.removeAll()},self.$$cacheFlushInterval)}(_this))}}},{}],13:[function(require,module,exports){module.exports=function(capacity){var _this=this;if(null===capacity)delete _this.$$capacity;else{if(!angular.isNumber(capacity))throw angular.$$minErr("ng")("areq","Expected capacity to be a number! Found: {0}.",typeof capacity);if(capacity<0)throw angular.$$minErr("ng")("areq","Expected capacity to be greater than zero! Found: {0}.",capacity);_this.$$capacity=capacity}for(var removed={};_this.$$lruHeap.size()>_this.$$capacity;)removed[_this.$$lruHeap.peek().key]=_this.remove(_this.$$lruHeap.peek().key);return removed}},{}],14:[function(require,module,exports){module.exports=function(deleteOnExpire){var _this=this;if(null===deleteOnExpire)delete _this.$$deleteOnExpire;else{if(!angular.isString(deleteOnExpire))throw angular.$$minErr("ng")("areq","Expected deleteOnExpire to be a string! Found: {0}.",typeof deleteOnExpire);if("none"!==deleteOnExpire&&"passive"!==deleteOnExpire&&"aggressive"!==deleteOnExpire)throw angular.$$minErr("ng")("areq",'Expected deleteOnExpire to be "none", "passive" or "aggressive"! Found: {0}.',deleteOnExpire);_this.$$deleteOnExpire=deleteOnExpire}_this.setRecycleFreq(_this.$$recycleFreq)}},{}],15:[function(require,module,exports){var utils=require("../utils");module.exports=function(maxAge){var _this=this;if(null===maxAge)delete _this.$$maxAge;else{if(!angular.isNumber(maxAge))throw angular.$$minErr("ng")("areq","Expected maxAge to be a number! Found: {0}.",typeof maxAge);if(maxAge<0)throw angular.$$minErr("ng")("areq","Expected maxAge to be greater than zero! Found: {0}.",maxAge);_this.$$maxAge=maxAge}var i,keys,key;if(_this.$$expiresHeap.removeAll(),_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");for(keys=keysJson?angular.fromJson(keysJson):[],i=0;i<keys.length;i++){key=keys[i];var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(itemJson){var item=angular.fromJson(itemJson);_this.$$maxAge===Number.MAX_VALUE?item.expires=Number.MAX_VALUE:item.expires=item.created+_this.$$maxAge,_this.$$expiresHeap.push({key:key,expires:item.expires})}}}else for(keys=utils.keys(_this.$$data),i=0;i<keys.length;i++)key=keys[i],_this.$$maxAge===Number.MAX_VALUE?_this.$$data[key].expires=Number.MAX_VALUE:_this.$$data[key].expires=_this.$$data[key].created+_this.$$maxAge,_this.$$expiresHeap.push(_this.$$data[key]);return"aggressive"===_this.$$deleteOnExpire?_this.removeExpired():{}}},{"../utils":21}],16:[function(require,module,exports){module.exports=function(onExpire){if(null===onExpire)delete this.$$onExpire;else{if(!angular.isFunction(onExpire))throw angular.$$minErr("ng")("areq","Expected onExpire to be a function! Found: {0}.",typeof onExpire);this.$$onExpire=onExpire}}},{}],17:[function(require,module,exports){module.exports=function(recycleFreq){var _this=this;if(null===recycleFreq)delete _this.$$recycleFreq;else{if(!angular.isNumber(recycleFreq))throw angular.$$minErr("ng")("areq","Expected recycleFreq to be a number! Found: {0}.",typeof recycleFreq);if(recycleFreq<0)throw angular.$$minErr("ng")("areq","Expected recycleFreq to be greater than zero! Found: {0}.",recycleFreq);_this.$$recycleFreq=recycleFreq}clearInterval(_this.$$recycleFreqId),"aggressive"===_this.$$deleteOnExpire?!function(self){self.$$recycleFreqId=setInterval(function(){self.removeExpired()},self.$$recycleFreq)}(_this):delete _this.$$recycleFreqId}},{}],18:[function(require,module,exports){function DSCacheFactoryProvider(){var _this=this,config=new defaults.Config;_this.version=version,_this.setCacheDefaults=function(options){if(options=options||{},!angular.isObject(options))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof options);for(var key in defaults.defaults)key in options&&(config[key]=options[key]);"disabled"in options&&(config.$$disabled=!!options.disabled)},_this.$get=["$q",function($q){function _keys(collection){var key,keys=[];for(key in collection)collection.hasOwnProperty(key)&&keys.push(key);return keys}function createCache(cacheId,options){if(cacheId in caches)throw angular.$$minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);if(!angular.isString(cacheId))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof cacheId);return caches[cacheId]=new DSCache(cacheId,angular.extend({},config,options)),caches[cacheId].destroy=function(){this.constructor.prototype.destroy.call(this),delete caches[this.$$id]},caches[cacheId].$q=$q,caches[cacheId]}function DSCacheFactory(cacheId,options){return createCache(cacheId,options)}var caches={};return DSCacheFactory.createCache=createCache,DSCacheFactory.version=version,DSCacheFactory.info=function(){for(var keys=_keys(caches),info={size:keys.length,caches:{}},i=0;i<keys.length;i++){var key=keys[i];info.caches[key]=caches[key].info()}var c=info.cacheDefaults=angular.extend({},config);for(var option in defaults.defaults)option in c||(c[option]=config["$$"+option]);return info},DSCacheFactory.get=function(cacheId){if(!angular.isString(cacheId))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof cacheId);return caches[cacheId]},DSCacheFactory.keySet=function(){var cacheId,cacheIds={};for(cacheId in caches)caches.hasOwnProperty(cacheId)&&(cacheIds[cacheId]=cacheId);return cacheIds},DSCacheFactory.keys=function(){return _keys(caches)},DSCacheFactory.destroyAll=function(){for(var cacheId in caches)caches[cacheId].destroy();caches={}},DSCacheFactory.clearAll=function(){for(var cacheId in caches)caches[cacheId].removeAll()},DSCacheFactory.enableAll=function(){for(var cacheId in caches)caches[cacheId].$$disabled=!1},DSCacheFactory.disableAll=function(){for(var cacheId in caches)caches[cacheId].$$disabled=!0},DSCacheFactory}]}var defaults=require("../defaults"),DSCache=require("../DSCache"),version="3.2.5";module.exports=DSCacheFactoryProvider},{"../DSCache":4,"../defaults":19}],19:[function(require,module,exports){function Config(){}var defaults={capacity:Number.MAX_VALUE,maxAge:Number.MAX_VALUE,deleteOnExpire:"none",onExpire:null,cacheFlushInterval:null,recycleFreq:1e3,storageMode:"memory",storageImpl:null,disabled:!1,storagePrefix:"angular-cache.caches.",storeOnResolve:!1,storeOnReject:!1};for(var option in defaults)Config.prototype["$$"+option]=defaults[option];module.exports={Config:Config,defaults:defaults}},{}],20:[function(require,module,exports){!function(window,angular,undefined){"use strict";angular.$$minErr=angular.$$minErr||function(module){return function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj};for(message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?angular.toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/"+angular.version.full+"/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return new Error(message)}},angular.module("angular-data.DSBinaryHeap",[]).provider("DSBinaryHeap",require("./DSBinaryHeap").DSBinaryHeapProvider),angular.module("angular-data.DSCacheFactory",["ng","angular-data.DSBinaryHeap"]).provider("DSCacheFactory",require("./DSCacheFactory"))}(window,window.angular)},{"./DSBinaryHeap":1,"./DSCacheFactory":18}],21:[function(require,module,exports){module.exports={stringifyNumber:function(number){return angular.isNumber(number)?number.toString():number},keySet:function(collection){var key,keySet={};for(key in collection)collection.hasOwnProperty(key)&&(keySet[key]=key);return keySet},keys:function(collection){var key,keys=[];for(key in collection)collection.hasOwnProperty(key)&&keys.push(key);return keys}}},{}]},{},[20]),function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports&&"object"==typeof module?module.exports=factory:factory(jQuery)}(function($,undefined){"use strict";function paletteTemplate(p,color,className,opts){for(var html=[],i=0;i<p.length;i++){var current=p[i];if(current){var tiny=tinycolor(current),c=tiny.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(color,current)?" sp-thumb-active":"";var formattedString=tiny.toString(opts.preferredFormat||"rgb"),swatchStyle=rgbaSupport?"background-color:"+tiny.toRgbString():"filter:"+tiny.toFilter();html.push('<span title="'+formattedString+'" data-color="'+tiny.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+swatchStyle+';" /></span>')}else{var cls="sp-clear-display";html.push($("<div />").append($('<span data-color="" style="background-color:transparent;" class="'+cls+'"></span>').attr("title",opts.noColorSelectedText)).html())}}return"<div class='sp-cf "+className+"'>"+html.join("")+"</div>"}function hideAll(){for(var i=0;i<spectrums.length;i++)spectrums[i]&&spectrums[i].hide()}function instanceOptions(o,callbackContext){var opts=$.extend({},defaultOpts,o);return opts.callbacks={move:bind(opts.move,callbackContext),change:bind(opts.change,callbackContext),show:bind(opts.show,callbackContext),hide:bind(opts.hide,callbackContext),beforeShow:bind(opts.beforeShow,callbackContext)},opts}function spectrum(element,o){function applyOptions(){if(opts.showPaletteOnly&&(opts.showPalette=!0),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),opts.palette){palette=opts.palette.slice(0),paletteArray=$.isArray(palette[0])?palette:[palette],paletteLookup={};for(var i=0;i<paletteArray.length;i++)for(var j=0;j<paletteArray[i].length;j++){var rgb=tinycolor(paletteArray[i][j]).toRgbString();paletteLookup[rgb]=!0}}container.toggleClass("sp-flat",flat),container.toggleClass("sp-input-disabled",!opts.showInput),container.toggleClass("sp-alpha-enabled",opts.showAlpha),container.toggleClass("sp-clear-enabled",allowEmpty),container.toggleClass("sp-buttons-disabled",!opts.showButtons),container.toggleClass("sp-palette-buttons-disabled",!opts.togglePaletteOnly),container.toggleClass("sp-palette-disabled",!opts.showPalette),container.toggleClass("sp-palette-only",opts.showPaletteOnly),container.toggleClass("sp-initial-disabled",!opts.showInitial),container.addClass(opts.className).addClass(opts.containerClassName),reflow()}function initialize(){function paletteElementClick(e){return e.data&&e.data.ignore?(set($(e.target).closest(".sp-thumb-el").data("color")),move()):(set($(e.target).closest(".sp-thumb-el").data("color")),move(),updateOriginalInput(!0),opts.hideAfterPaletteSelect&&hide()),!1}if(IE&&container.find("*:not(input)").attr("unselectable","on"),applyOptions(),shouldReplace&&boundElement.after(replacer).hide(),allowEmpty||clearButton.hide(),flat)boundElement.after(container).hide();else{var appendTo="parent"===opts.appendTo?boundElement.parent():$(opts.appendTo);1!==appendTo.length&&(appendTo=$("body")),appendTo.append(container)}updateSelectionPaletteFromStorage(),offsetElement.bind("click.spectrum touchstart.spectrum",function(e){disabled||toggle(),e.stopPropagation(),$(e.target).is("input")||e.preventDefault()}),(boundElement.is(":disabled")||opts.disabled===!0)&&disable(),container.click(stopPropagation),textInput.change(setFromTextInput),textInput.bind("paste",function(){setTimeout(setFromTextInput,1)}),textInput.keydown(function(e){13==e.keyCode&&setFromTextInput()}),cancelButton.text(opts.cancelText),cancelButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),revert(),hide()}),clearButton.attr("title",opts.clearText),clearButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isEmpty=!0,move(),flat&&updateOriginalInput(!0)}),chooseButton.text(opts.chooseText),chooseButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),IE&&textInput.is(":focus")&&textInput.trigger("change"),isValid()&&(updateOriginalInput(!0),hide())}),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),toggleButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),opts.showPaletteOnly=!opts.showPaletteOnly,opts.showPaletteOnly||flat||container.css("left","-="+(pickerContainer.outerWidth(!0)+5)),applyOptions()}),draggable(alphaSlider,function(dragX,dragY,e){currentAlpha=dragX/alphaWidth,isEmpty=!1,e.shiftKey&&(currentAlpha=Math.round(10*currentAlpha)/10),move()},dragStart,dragStop),draggable(slider,function(dragX,dragY){currentHue=parseFloat(dragY/slideHeight),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),draggable(dragger,function(dragX,dragY,e){if(e.shiftKey){if(!shiftMovementDirection){var oldDragX=currentSaturation*dragWidth,oldDragY=dragHeight-currentValue*dragHeight,furtherFromX=Math.abs(dragX-oldDragX)>Math.abs(dragY-oldDragY);shiftMovementDirection=furtherFromX?"x":"y"}}else shiftMovementDirection=null;var setSaturation=!shiftMovementDirection||"x"===shiftMovementDirection,setValue=!shiftMovementDirection||"y"===shiftMovementDirection;setSaturation&&(currentSaturation=parseFloat(dragX/dragWidth)),setValue&&(currentValue=parseFloat((dragHeight-dragY)/dragHeight)),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),initialColor?(set(initialColor),updateUI(),currentPreferredFormat=preferredFormat||tinycolor(initialColor).format,addColorToSelectionPalette(initialColor)):updateUI(),flat&&show();var paletteEvent=IE?"mousedown.spectrum":"click.spectrum touchstart.spectrum";paletteContainer.delegate(".sp-thumb-el",paletteEvent,paletteElementClick),initialColorContainer.delegate(".sp-thumb-el:nth-child(1)",paletteEvent,{ignore:!0},paletteElementClick)}function updateSelectionPaletteFromStorage(){if(localStorageKey&&window.localStorage){try{var oldPalette=window.localStorage[localStorageKey].split(",#");oldPalette.length>1&&(delete window.localStorage[localStorageKey],$.each(oldPalette,function(i,c){addColorToSelectionPalette(c)}))}catch(e){}try{selectionPalette=window.localStorage[localStorageKey].split(";")}catch(e){}}}function addColorToSelectionPalette(color){if(showSelectionPalette){var rgb=tinycolor(color).toRgbString();if(!paletteLookup[rgb]&&$.inArray(rgb,selectionPalette)===-1)for(selectionPalette.push(rgb);selectionPalette.length>maxSelectionSize;)selectionPalette.shift();if(localStorageKey&&window.localStorage)try{window.localStorage[localStorageKey]=selectionPalette.join(";")}catch(e){}}}function getUniqueSelectionPalette(){var unique=[];if(opts.showPalette)for(var i=0;i<selectionPalette.length;i++){var rgb=tinycolor(selectionPalette[i]).toRgbString();paletteLookup[rgb]||unique.push(selectionPalette[i])}return unique.reverse().slice(0,opts.maxSelectionSize)}function drawPalette(){var currentColor=get(),html=$.map(paletteArray,function(palette,i){return paletteTemplate(palette,currentColor,"sp-palette-row sp-palette-row-"+i,opts)});updateSelectionPaletteFromStorage(),selectionPalette&&html.push(paletteTemplate(getUniqueSelectionPalette(),currentColor,"sp-palette-row sp-palette-row-selection",opts)),paletteContainer.html(html.join(""))}function drawInitial(){if(opts.showInitial){var initial=colorOnShow,current=get();initialColorContainer.html(paletteTemplate([initial,current],current,"sp-palette-row-initial",opts))}}function dragStart(){(dragHeight<=0||dragWidth<=0||slideHeight<=0)&&reflow(),isDragging=!0,container.addClass(draggingClass),shiftMovementDirection=null,boundElement.trigger("dragstart.spectrum",[get()])}function dragStop(){isDragging=!1,container.removeClass(draggingClass),boundElement.trigger("dragstop.spectrum",[get()])}function setFromTextInput(){var value=textInput.val();if(null!==value&&""!==value||!allowEmpty){var tiny=tinycolor(value);tiny.isValid()?(set(tiny),updateOriginalInput(!0)):textInput.addClass("sp-validation-error")}else set(null),updateOriginalInput(!0)}function toggle(){visible?hide():show()}function show(){var event=$.Event("beforeShow.spectrum");return visible?void reflow():(boundElement.trigger(event,[get()]),void(callbacks.beforeShow(get())===!1||event.isDefaultPrevented()||(hideAll(),visible=!0,$(doc).bind("keydown.spectrum",onkeydown),$(doc).bind("click.spectrum",clickout),$(window).bind("resize.spectrum",resize),replacer.addClass("sp-active"),container.removeClass("sp-hidden"),reflow(),updateUI(),colorOnShow=get(),drawInitial(),callbacks.show(colorOnShow),boundElement.trigger("show.spectrum",[colorOnShow]))))}function onkeydown(e){27===e.keyCode&&hide()}function clickout(e){2!=e.button&&(isDragging||(clickoutFiresChange?updateOriginalInput(!0):revert(),hide()))}function hide(){visible&&!flat&&(visible=!1,$(doc).unbind("keydown.spectrum",onkeydown),$(doc).unbind("click.spectrum",clickout),$(window).unbind("resize.spectrum",resize),replacer.removeClass("sp-active"),container.addClass("sp-hidden"),callbacks.hide(get()),boundElement.trigger("hide.spectrum",[get()]))}function revert(){set(colorOnShow,!0)}function set(color,ignoreFormatChange){if(tinycolor.equals(color,get()))return void updateUI();var newColor,newHsv;!color&&allowEmpty?isEmpty=!0:(isEmpty=!1,newColor=tinycolor(color),newHsv=newColor.toHsv(),currentHue=newHsv.h%360/360,currentSaturation=newHsv.s,currentValue=newHsv.v,currentAlpha=newHsv.a),updateUI(),newColor&&newColor.isValid()&&!ignoreFormatChange&&(currentPreferredFormat=preferredFormat||newColor.getFormat())}function get(opts){return opts=opts||{},allowEmpty&&isEmpty?null:tinycolor.fromRatio({h:currentHue,s:currentSaturation,v:currentValue,a:Math.round(100*currentAlpha)/100},{format:opts.format||currentPreferredFormat})}function isValid(){return!textInput.hasClass("sp-validation-error")}function move(){updateUI(),callbacks.move(get()),boundElement.trigger("move.spectrum",[get()])}function updateUI(){textInput.removeClass("sp-validation-error"),updateHelperLocations();var flatColor=tinycolor.fromRatio({h:currentHue,s:1,v:1});dragger.css("background-color",flatColor.toHexString());var format=currentPreferredFormat;currentAlpha<1&&(0!==currentAlpha||"name"!==format)&&("hex"!==format&&"hex3"!==format&&"hex6"!==format&&"name"!==format||(format="rgb"));var realColor=get({format:format}),displayColor="";if(previewElement.removeClass("sp-clear-display"),previewElement.css("background-color","transparent"),!realColor&&allowEmpty)previewElement.addClass("sp-clear-display");else{var realHex=realColor.toHexString(),realRgb=realColor.toRgbString();if(rgbaSupport||1===realColor.alpha?previewElement.css("background-color",realRgb):(previewElement.css("background-color","transparent"),previewElement.css("filter",realColor.toFilter())),opts.showAlpha){var rgb=realColor.toRgb();rgb.a=0;var realAlpha=tinycolor(rgb).toRgbString(),gradient="linear-gradient(left, "+realAlpha+", "+realHex+")";IE?alphaSliderInner.css("filter",tinycolor(realAlpha).toFilter({gradientType:1},realHex)):(alphaSliderInner.css("background","-webkit-"+gradient),alphaSliderInner.css("background","-moz-"+gradient),alphaSliderInner.css("background","-ms-"+gradient),alphaSliderInner.css("background","linear-gradient(to right, "+realAlpha+", "+realHex+")"))}displayColor=realColor.toString(format)}opts.showInput&&textInput.val(displayColor),opts.showPalette&&drawPalette(),drawInitial()}function updateHelperLocations(){var s=currentSaturation,v=currentValue;if(allowEmpty&&isEmpty)alphaSlideHelper.hide(),slideHelper.hide(),dragHelper.hide();else{alphaSlideHelper.show(),slideHelper.show(),dragHelper.show();var dragX=s*dragWidth,dragY=dragHeight-v*dragHeight;dragX=Math.max(-dragHelperHeight,Math.min(dragWidth-dragHelperHeight,dragX-dragHelperHeight)),dragY=Math.max(-dragHelperHeight,Math.min(dragHeight-dragHelperHeight,dragY-dragHelperHeight)),dragHelper.css({top:dragY+"px",left:dragX+"px"});var alphaX=currentAlpha*alphaWidth;alphaSlideHelper.css({left:alphaX-alphaSlideHelperWidth/2+"px"});var slideY=currentHue*slideHeight;slideHelper.css({top:slideY-slideHelperHeight+"px"})}}function updateOriginalInput(fireCallback){var color=get(),displayColor="",hasChanged=!tinycolor.equals(color,colorOnShow);color&&(displayColor=color.toString(currentPreferredFormat),addColorToSelectionPalette(color)),isInput&&boundElement.val(displayColor),fireCallback&&hasChanged&&(callbacks.change(color),boundElement.trigger("change",[color]))}function reflow(){dragWidth=dragger.width(),dragHeight=dragger.height(),dragHelperHeight=dragHelper.height(),slideWidth=slider.width(),slideHeight=slider.height(),slideHelperHeight=slideHelper.height(),alphaWidth=alphaSlider.width(),alphaSlideHelperWidth=alphaSlideHelper.width(),flat||(container.css("position","absolute"),opts.offset?container.offset(opts.offset):container.offset(getOffset(container,offsetElement))),updateHelperLocations(),opts.showPalette&&drawPalette(),boundElement.trigger("reflow.spectrum")}function destroy(){boundElement.show(),offsetElement.unbind("click.spectrum touchstart.spectrum"),container.remove(),replacer.remove(),spectrums[spect.id]=null}function option(optionName,optionValue){return optionName===undefined?$.extend({},opts):optionValue===undefined?opts[optionName]:(opts[optionName]=optionValue,void applyOptions())}function enable(){disabled=!1,boundElement.attr("disabled",!1),offsetElement.removeClass("sp-disabled")}function disable(){hide(),disabled=!0,boundElement.attr("disabled",!0),offsetElement.addClass("sp-disabled")}function setOffset(coord){opts.offset=coord,reflow()}var opts=instanceOptions(o,element),flat=opts.flat,showSelectionPalette=opts.showSelectionPalette,localStorageKey=opts.localStorageKey,theme=opts.theme,callbacks=opts.callbacks,resize=throttle(reflow,10),visible=!1,isDragging=!1,dragWidth=0,dragHeight=0,dragHelperHeight=0,slideHeight=0,slideWidth=0,alphaWidth=0,alphaSlideHelperWidth=0,slideHelperHeight=0,currentHue=0,currentSaturation=0,currentValue=0,currentAlpha=1,palette=[],paletteArray=[],paletteLookup={},selectionPalette=opts.selectionPalette.slice(0),maxSelectionSize=opts.maxSelectionSize,draggingClass="sp-dragging",shiftMovementDirection=null,doc=element.ownerDocument,boundElement=(doc.body,$(element)),disabled=!1,container=$(markup,doc).addClass(theme),pickerContainer=container.find(".sp-picker-container"),dragger=container.find(".sp-color"),dragHelper=container.find(".sp-dragger"),slider=container.find(".sp-hue"),slideHelper=container.find(".sp-slider"),alphaSliderInner=container.find(".sp-alpha-inner"),alphaSlider=container.find(".sp-alpha"),alphaSlideHelper=container.find(".sp-alpha-handle"),textInput=container.find(".sp-input"),paletteContainer=container.find(".sp-palette"),initialColorContainer=container.find(".sp-initial"),cancelButton=container.find(".sp-cancel"),clearButton=container.find(".sp-clear"),chooseButton=container.find(".sp-choose"),toggleButton=container.find(".sp-palette-toggle"),isInput=boundElement.is("input"),isInputTypeColor=isInput&&"color"===boundElement.attr("type")&&inputTypeColorSupport(),shouldReplace=isInput&&!flat,replacer=shouldReplace?$(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName):$([]),offsetElement=shouldReplace?replacer:boundElement,previewElement=replacer.find(".sp-preview-inner"),initialColor=opts.color||isInput&&boundElement.val(),colorOnShow=!1,preferredFormat=opts.preferredFormat,currentPreferredFormat=preferredFormat,clickoutFiresChange=!opts.showButtons||opts.clickoutFiresChange,isEmpty=!initialColor,allowEmpty=opts.allowEmpty&&!isInputTypeColor;initialize();var spect={show:show,hide:hide,toggle:toggle,reflow:reflow,option:option,enable:enable,disable:disable,offset:setOffset,set:function(c){set(c),updateOriginalInput()},get:get,destroy:destroy,container:container};return spect.id=spectrums.push(spect)-1,spect}function getOffset(picker,input){var extraY=0,dpWidth=picker.outerWidth(),dpHeight=picker.outerHeight(),inputHeight=input.outerHeight(),doc=picker[0].ownerDocument,docElem=doc.documentElement,viewWidth=docElem.clientWidth+$(doc).scrollLeft(),viewHeight=docElem.clientHeight+$(doc).scrollTop(),offset=input.offset();return offset.top+=inputHeight,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight-extraY):extraY),offset}function noop(){}function stopPropagation(e){e.stopPropagation()}function bind(func,obj){var slice=Array.prototype.slice,args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}}function draggable(element,onmove,onstart,onstop){function prevent(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function move(e){if(dragging){if(IE&&doc.documentMode<9&&!e.button)return stop();var t0=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0],pageX=t0&&t0.pageX||e.pageX,pageY=t0&&t0.pageY||e.pageY,dragX=Math.max(0,Math.min(pageX-offset.left,maxWidth)),dragY=Math.max(0,Math.min(pageY-offset.top,maxHeight));hasTouch&&prevent(e),onmove.apply(element,[dragX,dragY,e])}}function start(e){var rightclick=e.which?3==e.which:2==e.button;rightclick||dragging||onstart.apply(element,arguments)!==!1&&(dragging=!0,maxHeight=$(element).height(),maxWidth=$(element).width(),offset=$(element).offset(),$(doc).bind(duringDragEvents),$(doc.body).addClass("sp-dragging"),move(e),prevent(e))}function stop(){dragging&&($(doc).unbind(duringDragEvents),$(doc.body).removeClass("sp-dragging"),setTimeout(function(){onstop.apply(element,arguments)},0)),dragging=!1}onmove=onmove||function(){},onstart=onstart||function(){},onstop=onstop||function(){};var doc=document,dragging=!1,offset={},maxHeight=0,maxWidth=0,hasTouch="ontouchstart"in window,duringDragEvents={};duringDragEvents.selectstart=prevent,duringDragEvents.dragstart=prevent,duringDragEvents["touchmove mousemove"]=move,duringDragEvents["touchend mouseup"]=stop,$(element).bind("touchstart mousedown",start)}function throttle(func,wait,debounce){var timeout;return function(){var context=this,args=arguments,throttler=function(){timeout=null,func.apply(context,args)};debounce&&clearTimeout(timeout),!debounce&&timeout||(timeout=setTimeout(throttler,wait))}}function inputTypeColorSupport(){return $.fn.spectrum.inputTypeColorSupport()}var defaultOpts={beforeShow:noop,move:noop,change:noop,show:noop,hide:noop,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",
showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},spectrums=[],IE=!!/msie/i.exec(window.navigator.userAgent),rgbaSupport=function(){function contains(str,substr){return!!~(""+str).indexOf(substr)}var elem=document.createElement("div"),style=elem.style;return style.cssText="background-color:rgba(0,0,0,.5)",contains(style.backgroundColor,"rgba")||contains(style.backgroundColor,"hsla")}(),replaceInput=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),markup=function(){var gradientFix="";if(IE)for(var i=1;i<=6;i++)gradientFix+="<div class='sp-"+i+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",gradientFix,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),dataID="spectrum.id";$.fn.spectrum=function(opts,extra){if("string"==typeof opts){var returnValue=this,args=Array.prototype.slice.call(arguments,1);return this.each(function(){var spect=spectrums[$(this).data(dataID)];if(spect){var method=spect[opts];if(!method)throw new Error("Spectrum: no such method: '"+opts+"'");"get"==opts?returnValue=spect.get():"container"==opts?returnValue=spect.container:"option"==opts?returnValue=spect.option.apply(spect,args):"destroy"==opts?(spect.destroy(),$(this).removeData(dataID)):method.apply(spect,args)}}),returnValue}return this.spectrum("destroy").each(function(){var options=$.extend({},opts,$(this).data()),spect=spectrum(this,options);$(this).data(dataID,spect.id)})},$.fn.spectrum.load=!0,$.fn.spectrum.loadOpts={},$.fn.spectrum.draggable=draggable,$.fn.spectrum.defaults=defaultOpts,$.fn.spectrum.inputTypeColorSupport=function inputTypeColorSupport(){if("undefined"==typeof inputTypeColorSupport._cachedResult){var colorInput=$("<input type='color' value='!' />")[0];inputTypeColorSupport._cachedResult="color"===colorInput.type&&"!"!==colorInput.value}return inputTypeColorSupport._cachedResult},$.spectrum={},$.spectrum.localization={},$.spectrum.palettes={},$.fn.spectrum.processNativeColorInputs=function(){var colorInputs=$("input[type=color]");colorInputs.length&&!inputTypeColorSupport()&&colorInputs.spectrum({preferredFormat:"hex6"})},function(){function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")?(color.s=convertToPercentage(color.s),color.v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,color.s,color.v),ok=!0,format="hsv"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")&&(color.s=convertToPercentage(color.s),color.l=convertToPercentage(color.l),rgb=hslToRgb(color.h,color.s,color.l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:255*r,g:255*g,b:255*b}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a){var hex=[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return hex.join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(255*-(amount/100)))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(255*-(amount/100)))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(255*-(amount/100)))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(mathRound(hsl.h)+amount)%360;return hsl.h=hue<0?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function flip(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&n.indexOf(".")!=-1&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&n.indexOf("%")!=-1}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return n<=1&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hsva.exec(color))?{h:match[1],s:match[2],v:match[3],a:match[4]}:(match=matchers.hex8.exec(color))?{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:!!(match=matchers.hex3.exec(color))&&{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}}var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random,tinycolor=function(color,opts){if(color=color?color:"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++};tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(){return rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(secondColor){var hex8String="#"+rgbaToHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String=s.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0,needsAlphaFormat=!formatSet&&hasAlpha&&("hex"===format||"hex6"===format||"hex3"===format||"name"===format);return needsAlphaFormat?"name"===format&&0===this._a?this.toName():this.toRgbString():("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),"hex"!==format&&"hex6"!==format||(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString())},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&("a"===i?newColor[i]=color[i]:newColor[i]=convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return!(!color1||!color2)&&tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var w1,rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100,w=2*p-1,a=rgb2.a-rgb1.a;w1=w*a==-1?w:(w+a)/(1+w*a),w1=(w1+1)/2;var w2=1-w1,rgba={r:rgb2.r*w1+rgb1.r*w2,g:rgb2.g*w1+rgb1.g*w2,b:rgb2.b*w1+rgb1.b*w2,a:rgb2.a*p+rgb1.a*(1-p)};return tinycolor(rgba)},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2),rgb1=c1.toRgb(),rgb2=c2.toRgb(),brightnessA=c1.getBrightness(),brightnessB=c2.getBrightness(),colorDiff=Math.max(rgb1.r,rgb2.r)-Math.min(rgb1.r,rgb2.r)+Math.max(rgb1.g,rgb2.g)-Math.min(rgb1.g,rgb2.g)+Math.max(rgb1.b,rgb2.b)-Math.min(rgb1.b,rgb2.b);return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff}},tinycolor.isReadable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500},tinycolor.mostReadable=function(baseColor,colorList){for(var bestColor=null,bestScore=0,bestIsReadable=!1,i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]),readable=readability.brightness>125&&readability.color>500,score=3*(readability.brightness/125)+readability.color/500;(readable&&!bestIsReadable||readable&&bestIsReadable&&score>bestScore||!readable&&!bestIsReadable&&score>bestScore)&&(bestIsReadable=readable,bestScore=score,bestColor=tinycolor(colorList[i]))}return bestColor};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names),matchers=function(){var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=tinycolor}(),$(function(){$.fn.spectrum.load&&$.fn.spectrum.processNativeColorInputs()})}),function(factory){"function"==typeof define&&define.amd?define(["jquery","moment"],factory):"object"==typeof exports?module.exports=factory(require("jquery"),require("moment")):factory(jQuery,moment)}(function($,moment){function mergeOptions(optionObjs){return mergeProps(optionObjs,complexOptions)}function massageOverrides(input){var subObj,overrides={views:input.views||{}};return $.each(input,function(name,val){"views"!=name&&($.isPlainObject(val)&&!/(time|duration|interval)$/i.test(name)&&$.inArray(name,complexOptions)==-1?(subObj=null,$.each(val,function(subName,subVal){/^(month|week|day|default|basic(Week|Day)?|agenda(Week|Day)?)$/.test(subName)?(overrides.views[subName]||(overrides.views[subName]={}),overrides.views[subName][name]=subVal):(subObj||(subObj={}),subObj[subName]=subVal)}),subObj&&(overrides[name]=subObj)):overrides[name]=val)}),overrides}function compensateScroll(rowEls,scrollbarWidths){scrollbarWidths.left&&rowEls.css({"border-left-width":1,"margin-left":scrollbarWidths.left-1}),scrollbarWidths.right&&rowEls.css({"border-right-width":1,"margin-right":scrollbarWidths.right-1})}function uncompensateScroll(rowEls){rowEls.css({"margin-left":"","margin-right":"","border-left-width":"","border-right-width":""})}function disableCursor(){$("body").addClass("fc-not-allowed")}function enableCursor(){$("body").removeClass("fc-not-allowed")}function distributeHeight(els,availableHeight,shouldRedistribute){var minOffset1=Math.floor(availableHeight/els.length),minOffset2=Math.floor(availableHeight-minOffset1*(els.length-1)),flexEls=[],flexOffsets=[],flexHeights=[],usedHeight=0;undistributeHeight(els),els.each(function(i,el){var minOffset=i===els.length-1?minOffset2:minOffset1,naturalOffset=$(el).outerHeight(!0);naturalOffset<minOffset?(flexEls.push(el),flexOffsets.push(naturalOffset),flexHeights.push($(el).height())):usedHeight+=naturalOffset}),shouldRedistribute&&(availableHeight-=usedHeight,minOffset1=Math.floor(availableHeight/flexEls.length),minOffset2=Math.floor(availableHeight-minOffset1*(flexEls.length-1))),$(flexEls).each(function(i,el){var minOffset=i===flexEls.length-1?minOffset2:minOffset1,naturalOffset=flexOffsets[i],naturalHeight=flexHeights[i],newHeight=minOffset-(naturalOffset-naturalHeight);naturalOffset<minOffset&&$(el).height(newHeight)})}function undistributeHeight(els){els.height("")}function matchCellWidths(els){var maxInnerWidth=0;return els.find("> *").each(function(i,innerEl){var innerWidth=$(innerEl).outerWidth();innerWidth>maxInnerWidth&&(maxInnerWidth=innerWidth)}),maxInnerWidth++,els.width(maxInnerWidth),maxInnerWidth}function setPotentialScroller(containerEl,height){return containerEl.height(height).addClass("fc-scroller"),containerEl[0].scrollHeight-1>containerEl[0].clientHeight||(unsetScroller(containerEl),!1)}function unsetScroller(containerEl){containerEl.height("").removeClass("fc-scroller")}function getScrollParent(el){var position=el.css("position"),scrollParent=el.parents().filter(function(){var parent=$(this);return/(auto|scroll)/.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(el[0].ownerDocument||document)}function getOuterRect(el){var offset=el.offset();return{left:offset.left,right:offset.left+el.outerWidth(),top:offset.top,bottom:offset.top+el.outerHeight()}}function getClientRect(el){var offset=el.offset(),scrollbarWidths=getScrollbarWidths(el),left=offset.left+getCssFloat(el,"border-left-width")+scrollbarWidths.left,top=offset.top+getCssFloat(el,"border-top-width")+scrollbarWidths.top;return{left:left,right:left+el[0].clientWidth,top:top,bottom:top+el[0].clientHeight}}function getContentRect(el){var offset=el.offset(),left=offset.left+getCssFloat(el,"border-left-width")+getCssFloat(el,"padding-left"),top=offset.top+getCssFloat(el,"border-top-width")+getCssFloat(el,"padding-top");return{left:left,right:left+el.width(),top:top,bottom:top+el.height()}}function getScrollbarWidths(el){var leftRightWidth=el.innerWidth()-el[0].clientWidth,widths={left:0,right:0,top:0,bottom:el.innerHeight()-el[0].clientHeight};return getIsLeftRtlScrollbars()&&"rtl"==el.css("direction")?widths.left=leftRightWidth:widths.right=leftRightWidth,widths}function getIsLeftRtlScrollbars(){return null===_isLeftRtlScrollbars&&(_isLeftRtlScrollbars=computeIsLeftRtlScrollbars()),_isLeftRtlScrollbars}function computeIsLeftRtlScrollbars(){var el=$("<div><div/></div>").css({position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}).appendTo("body"),innerEl=el.children(),res=innerEl.offset().left>el.offset().left;return el.remove(),res}function getCssFloat(el,prop){return parseFloat(el.css(prop))||0}function isPrimaryMouseButton(ev){return 1==ev.which&&!ev.ctrlKey}function intersectRects(rect1,rect2){var res={left:Math.max(rect1.left,rect2.left),right:Math.min(rect1.right,rect2.right),top:Math.max(rect1.top,rect2.top),bottom:Math.min(rect1.bottom,rect2.bottom)};return res.left<res.right&&res.top<res.bottom&&res}function constrainPoint(point,rect){return{left:Math.min(Math.max(point.left,rect.left),rect.right),top:Math.min(Math.max(point.top,rect.top),rect.bottom)}}function getRectCenter(rect){return{left:(rect.left+rect.right)/2,top:(rect.top+rect.bottom)/2}}function diffPoints(point1,point2){return{left:point1.left-point2.left,top:point1.top-point2.top}}function parseFieldSpecs(input){var i,token,specs=[],tokens=[];for("string"==typeof input?tokens=input.split(/\s*,\s*/):"function"==typeof input?tokens=[input]:$.isArray(input)&&(tokens=input),i=0;i<tokens.length;i++)token=tokens[i],"string"==typeof token?specs.push("-"==token.charAt(0)?{field:token.substring(1),order:-1}:{field:token,order:1}):"function"==typeof token&&specs.push({func:token});return specs}function compareByFieldSpecs(obj1,obj2,fieldSpecs){var i,cmp;for(i=0;i<fieldSpecs.length;i++)if(cmp=compareByFieldSpec(obj1,obj2,fieldSpecs[i]))return cmp;return 0}function compareByFieldSpec(obj1,obj2,fieldSpec){return fieldSpec.func?fieldSpec.func(obj1,obj2):flexibleCompare(obj1[fieldSpec.field],obj2[fieldSpec.field])*(fieldSpec.order||1)}function flexibleCompare(a,b){return a||b?null==b?-1:null==a?1:"string"===$.type(a)||"string"===$.type(b)?String(a).localeCompare(String(b)):a-b:0}function intersectionToSeg(subjectRange,constraintRange){var segStart,segEnd,isStart,isEnd,subjectStart=subjectRange.start,subjectEnd=subjectRange.end,constraintStart=constraintRange.start,constraintEnd=constraintRange.end;if(subjectEnd>constraintStart&&subjectStart<constraintEnd)return subjectStart>=constraintStart?(segStart=subjectStart.clone(),isStart=!0):(segStart=constraintStart.clone(),isStart=!1),subjectEnd<=constraintEnd?(segEnd=subjectEnd.clone(),isEnd=!0):(segEnd=constraintEnd.clone(),isEnd=!1),{start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd}}function diffDayTime(a,b){return moment.duration({days:a.clone().stripTime().diff(b.clone().stripTime(),"days"),ms:a.time()-b.time()})}function diffDay(a,b){return moment.duration({days:a.clone().stripTime().diff(b.clone().stripTime(),"days")})}function diffByUnit(a,b,unit){return moment.duration(Math.round(a.diff(b,unit,!0)),unit)}function computeIntervalUnit(start,end){var i,unit,val;for(i=0;i<intervalUnits.length&&(unit=intervalUnits[i],val=computeRangeAs(unit,start,end),!(val>=1&&isInt(val)));i++);return unit}function computeRangeAs(unit,start,end){return null!=end?end.diff(start,unit,!0):moment.isDuration(start)?start.as(unit):start.end.diff(start.start,unit,!0)}function divideRangeByDuration(start,end,dur){var months;return durationHasTime(dur)?(end-start)/dur:(months=dur.asMonths(),Math.abs(months)>=1&&isInt(months)?end.diff(start,"months",!0)/months:end.diff(start,"days",!0)/dur.asDays())}function divideDurationByDuration(dur1,dur2){var months1,months2;return durationHasTime(dur1)||durationHasTime(dur2)?dur1/dur2:(months1=dur1.asMonths(),months2=dur2.asMonths(),Math.abs(months1)>=1&&isInt(months1)&&Math.abs(months2)>=1&&isInt(months2)?months1/months2:dur1.asDays()/dur2.asDays())}function multiplyDuration(dur,n){var months;return durationHasTime(dur)?moment.duration(dur*n):(months=dur.asMonths(),Math.abs(months)>=1&&isInt(months)?moment.duration({months:months*n}):moment.duration({days:dur.asDays()*n}))}function durationHasTime(dur){return Boolean(dur.hours()||dur.minutes()||dur.seconds()||dur.milliseconds())}function isNativeDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function isTimeString(str){return/^\d+\:\d+(?:\:\d+\.?(?:\d{3})?)?$/.test(str)}function mergeProps(propObjs,complexProps){var i,name,complexObjs,j,val,props,dest={};if(complexProps)for(i=0;i<complexProps.length;i++){for(name=complexProps[i],complexObjs=[],j=propObjs.length-1;j>=0;j--)if(val=propObjs[j][name],"object"==typeof val)complexObjs.unshift(val);else if(void 0!==val){dest[name]=val;break}complexObjs.length&&(dest[name]=mergeProps(complexObjs))}for(i=propObjs.length-1;i>=0;i--){props=propObjs[i];for(name in props)name in dest||(dest[name]=props[name])}return dest}function createObject(proto){var f=function(){};return f.prototype=proto,new f}function copyOwnProps(src,dest){for(var name in src)hasOwnProp(src,name)&&(dest[name]=src[name])}function copyNativeMethods(src,dest){var i,name,names=["constructor","toString","valueOf"];for(i=0;i<names.length;i++)name=names[i],src[name]!==Object.prototype[name]&&(dest[name]=src[name])}function hasOwnProp(obj,name){return hasOwnPropMethod.call(obj,name)}function isAtomic(val){return/undefined|null|boolean|number|string/.test($.type(val))}function applyAll(functions,thisObj,args){if($.isFunction(functions)&&(functions=[functions]),functions){var i,ret;for(i=0;i<functions.length;i++)ret=functions[i].apply(thisObj,args)||ret;return ret}}function firstDefined(){for(var i=0;i<arguments.length;i++)if(void 0!==arguments[i])return arguments[i]}function htmlEscape(s){return(s+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function stripHtmlEntities(text){return text.replace(/&.*?;/g,"")}function cssToStr(cssProps){var statements=[];return $.each(cssProps,function(name,val){null!=val&&statements.push(name+":"+val)}),statements.join(";")}function capitaliseFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1);
}function compareNumbers(a,b){return a-b}function isInt(n){return n%1===0}function proxy(obj,methodName){var method=obj[methodName];return function(){return method.apply(obj,arguments)}}function debounce(func,wait){var timeoutId,args,context,timestamp,later=function(){var last=+new Date-timestamp;last<wait&&last>0?timeoutId=setTimeout(later,wait-last):(timeoutId=null,func.apply(context,args),timeoutId||(context=args=null))};return function(){context=this,args=arguments,timestamp=+new Date,timeoutId||(timeoutId=setTimeout(later,wait))}}function makeMoment(args,parseAsUTC,parseZone){var isAmbigTime,isAmbigZone,ambigMatch,mom,input=args[0],isSingleString=1==args.length&&"string"==typeof input;return moment.isMoment(input)?(mom=moment.apply(null,args),transferAmbigs(input,mom)):isNativeDate(input)||void 0===input?mom=moment.apply(null,args):(isAmbigTime=!1,isAmbigZone=!1,isSingleString?ambigDateOfMonthRegex.test(input)?(input+="-01",args=[input],isAmbigTime=!0,isAmbigZone=!0):(ambigMatch=ambigTimeOrZoneRegex.exec(input))&&(isAmbigTime=!ambigMatch[5],isAmbigZone=!0):$.isArray(input)&&(isAmbigZone=!0),mom=parseAsUTC||isAmbigTime?moment.utc.apply(moment,args):moment.apply(null,args),isAmbigTime?(mom._ambigTime=!0,mom._ambigZone=!0):parseZone&&(isAmbigZone?mom._ambigZone=!0:isSingleString&&(mom.utcOffset?mom.utcOffset(input):mom.zone(input)))),mom._fullCalendar=!0,mom}function commonlyAmbiguate(inputs,preserveTime){var i,mom,anyAmbigTime=!1,anyAmbigZone=!1,len=inputs.length,moms=[];for(i=0;i<len;i++)mom=inputs[i],moment.isMoment(mom)||(mom=fc.moment.parseZone(mom)),anyAmbigTime=anyAmbigTime||mom._ambigTime,anyAmbigZone=anyAmbigZone||mom._ambigZone,moms.push(mom);for(i=0;i<len;i++)mom=moms[i],preserveTime||!anyAmbigTime||mom._ambigTime?anyAmbigZone&&!mom._ambigZone&&(moms[i]=mom.clone().stripZone()):moms[i]=mom.clone().stripTime();return moms}function transferAmbigs(src,dest){src._ambigTime?dest._ambigTime=!0:dest._ambigTime&&(dest._ambigTime=!1),src._ambigZone?dest._ambigZone=!0:dest._ambigZone&&(dest._ambigZone=!1)}function setMomentValues(mom,a){mom.year(a[0]||0).month(a[1]||0).date(a[2]||0).hours(a[3]||0).minutes(a[4]||0).seconds(a[5]||0).milliseconds(a[6]||0)}function oldMomentFormat(mom,formatStr){return oldMomentProto.format.call(mom,formatStr)}function formatDate(date,formatStr){return formatDateWithChunks(date,getFormatStringChunks(formatStr))}function formatDateWithChunks(date,chunks){var i,s="";for(i=0;i<chunks.length;i++)s+=formatDateWithChunk(date,chunks[i]);return s}function formatDateWithChunk(date,chunk){var token,maybeStr;return"string"==typeof chunk?chunk:(token=chunk.token)?tokenOverrides[token]?tokenOverrides[token](date):oldMomentFormat(date,token):chunk.maybe&&(maybeStr=formatDateWithChunks(date,chunk.maybe),maybeStr.match(/[1-9]/))?maybeStr:""}function formatRange(date1,date2,formatStr,separator,isRTL){var localeData;return date1=fc.moment.parseZone(date1),date2=fc.moment.parseZone(date2),localeData=(date1.localeData||date1.lang).call(date1),formatStr=localeData.longDateFormat(formatStr)||formatStr,separator=separator||" - ",formatRangeWithChunks(date1,date2,getFormatStringChunks(formatStr),separator,isRTL)}function formatRangeWithChunks(date1,date2,chunks,separator,isRTL){var chunkStr,leftI,rightI,middleI,leftStr="",rightStr="",middleStr1="",middleStr2="",middleStr="";for(leftI=0;leftI<chunks.length&&(chunkStr=formatSimilarChunk(date1,date2,chunks[leftI]),chunkStr!==!1);leftI++)leftStr+=chunkStr;for(rightI=chunks.length-1;rightI>leftI&&(chunkStr=formatSimilarChunk(date1,date2,chunks[rightI]),chunkStr!==!1);rightI--)rightStr=chunkStr+rightStr;for(middleI=leftI;middleI<=rightI;middleI++)middleStr1+=formatDateWithChunk(date1,chunks[middleI]),middleStr2+=formatDateWithChunk(date2,chunks[middleI]);return(middleStr1||middleStr2)&&(middleStr=isRTL?middleStr2+separator+middleStr1:middleStr1+separator+middleStr2),leftStr+middleStr+rightStr}function formatSimilarChunk(date1,date2,chunk){var token,unit;return"string"==typeof chunk?chunk:!!((token=chunk.token)&&(unit=similarUnitMap[token.charAt(0)],unit&&date1.isSame(date2,unit)))&&oldMomentFormat(date1,token)}function getFormatStringChunks(formatStr){return formatStr in formatStringChunkCache?formatStringChunkCache[formatStr]:formatStringChunkCache[formatStr]=chunkFormatString(formatStr)}function chunkFormatString(formatStr){for(var match,chunks=[],chunker=/\[([^\]]*)\]|\(([^\)]*)\)|(LTS|LT|(\w)\4*o?)|([^\w\[\(]+)/g;match=chunker.exec(formatStr);)match[1]?chunks.push(match[1]):match[2]?chunks.push({maybe:chunkFormatString(match[2])}):match[3]?chunks.push({token:match[3]}):match[5]&&chunks.push(match[5]);return chunks}function Class(){}function isCellsEqual(cell1,cell2){return!cell1&&!cell2||!(!cell1||!cell2)&&(cell1.grid===cell2.grid&&cell1.row===cell2.row&&cell1.col===cell2.col)}function isBgEvent(event){var rendering=getEventRendering(event);return"background"===rendering||"inverse-background"===rendering}function isInverseBgEvent(event){return"inverse-background"===getEventRendering(event)}function getEventRendering(event){return firstDefined((event.source||{}).rendering,event.rendering)}function groupEventsById(events){var i,event,eventsById={};for(i=0;i<events.length;i++)event=events[i],(eventsById[event._id]||(eventsById[event._id]=[])).push(event);return eventsById}function compareNormalRanges(range1,range2){return range1.eventStartMS-range2.eventStartMS}function getDraggedElMeta(el){var eventProps,startTime,duration,stick,prefix=fc.dataAttrPrefix;return prefix&&(prefix+="-"),eventProps=el.data(prefix+"event")||null,eventProps&&(eventProps="object"==typeof eventProps?$.extend({},eventProps):{},startTime=eventProps.start,null==startTime&&(startTime=eventProps.time),duration=eventProps.duration,stick=eventProps.stick,delete eventProps.start,delete eventProps.time,delete eventProps.duration,delete eventProps.stick),null==startTime&&(startTime=el.data(prefix+"start")),null==startTime&&(startTime=el.data(prefix+"time")),null==duration&&(duration=el.data(prefix+"duration")),null==stick&&(stick=el.data(prefix+"stick")),startTime=null!=startTime?moment.duration(startTime):null,duration=null!=duration?moment.duration(duration):null,stick=Boolean(stick),{eventProps:eventProps,startTime:startTime,duration:duration,stick:stick}}function isDaySegCollision(seg,otherSegs){var i,otherSeg;for(i=0;i<otherSegs.length;i++)if(otherSeg=otherSegs[i],otherSeg.leftCol<=seg.rightCol&&otherSeg.rightCol>=seg.leftCol)return!0;return!1}function compareDaySegCols(a,b){return a.leftCol-b.leftCol}function buildSlotSegLevels(segs){var i,seg,j,levels=[];for(i=0;i<segs.length;i++){for(seg=segs[i],j=0;j<levels.length&&computeSlotSegCollisions(seg,levels[j]).length;j++);seg.level=j,(levels[j]||(levels[j]=[])).push(seg)}return levels}function computeForwardSlotSegs(levels){var i,level,j,seg,k;for(i=0;i<levels.length;i++)for(level=levels[i],j=0;j<level.length;j++)for(seg=level[j],seg.forwardSegs=[],k=i+1;k<levels.length;k++)computeSlotSegCollisions(seg,levels[k],seg.forwardSegs)}function computeSlotSegPressures(seg){var i,forwardSeg,forwardSegs=seg.forwardSegs,forwardPressure=0;if(void 0===seg.forwardPressure){for(i=0;i<forwardSegs.length;i++)forwardSeg=forwardSegs[i],computeSlotSegPressures(forwardSeg),forwardPressure=Math.max(forwardPressure,1+forwardSeg.forwardPressure);seg.forwardPressure=forwardPressure}}function computeSlotSegCollisions(seg,otherSegs,results){results=results||[];for(var i=0;i<otherSegs.length;i++)isSlotSegCollision(seg,otherSegs[i])&&results.push(otherSegs[i]);return results}function isSlotSegCollision(seg1,seg2){return seg1.bottom>seg2.top&&seg1.top<seg2.bottom}function Calendar_constructor(element,overrides){function render(){content?elementVisible()&&(calcSize(),renderView()):initialRender()}function initialRender(){tm=options.theme?"ui":"fc",element.addClass("fc"),options.isRTL?element.addClass("fc-rtl"):element.addClass("fc-ltr"),options.theme?element.addClass("ui-widget"):element.addClass("fc-unthemed"),content=$("<div class='fc-view-container'/>").prependTo(element),header=t.header=new Header(t,options),headerElement=header.render(),headerElement&&element.prepend(headerElement),renderView(options.defaultView),options.handleWindowResize&&(windowResizeProxy=debounce(windowResize,options.windowResizeDelay),$(window).resize(windowResizeProxy))}function destroy(){currentView&&currentView.removeElement(),header.removeElement(),content.remove(),element.removeClass("fc fc-ltr fc-rtl fc-unthemed ui-widget"),windowResizeProxy&&$(window).unbind("resize",windowResizeProxy)}function elementVisible(){return element.is(":visible")}function renderView(viewType){ignoreWindowResize++,currentView&&viewType&&currentView.type!==viewType&&(header.deactivateButton(currentView.type),freezeContentHeight(),currentView.removeElement(),currentView=t.view=null),!currentView&&viewType&&(currentView=t.view=viewsByType[viewType]||(viewsByType[viewType]=t.instantiateView(viewType)),currentView.setElement($("<div class='fc-view fc-"+viewType+"-view' />").appendTo(content)),header.activateButton(viewType)),currentView&&(date=currentView.massageCurrentDate(date),currentView.displaying&&date.isWithin(currentView.intervalStart,currentView.intervalEnd)||elementVisible()&&(freezeContentHeight(),currentView.display(date),unfreezeContentHeight(),updateHeaderTitle(),updateTodayButton(),getAndRenderEvents())),unfreezeContentHeight(),ignoreWindowResize--}function updateSize(shouldRecalc){if(elementVisible())return shouldRecalc&&_calcSize(),ignoreWindowResize++,currentView.updateSize(!0),ignoreWindowResize--,!0}function calcSize(){elementVisible()&&_calcSize()}function _calcSize(){suggestedViewHeight="number"==typeof options.contentHeight?options.contentHeight:"number"==typeof options.height?options.height-(headerElement?headerElement.outerHeight(!0):0):Math.round(content.width()/Math.max(options.aspectRatio,.5))}function windowResize(ev){!ignoreWindowResize&&ev.target===window&&currentView.start&&updateSize(!0)&&currentView.trigger("windowResize",_element)}function refetchEvents(){destroyEvents(),fetchAndRenderEvents()}function renderEvents(){elementVisible()&&(freezeContentHeight(),currentView.displayEvents(events),unfreezeContentHeight())}function destroyEvents(){freezeContentHeight(),currentView.clearEvents(),unfreezeContentHeight()}function getAndRenderEvents(){!options.lazyFetching||isFetchNeeded(currentView.start,currentView.end)?fetchAndRenderEvents():renderEvents()}function fetchAndRenderEvents(){fetchEvents(currentView.start,currentView.end)}function reportEvents(_events){events=_events,renderEvents()}function reportEventChange(){renderEvents()}function updateHeaderTitle(){header.updateTitle(currentView.title)}function updateTodayButton(){var now=t.getNow();now.isWithin(currentView.intervalStart,currentView.intervalEnd)?header.disableButton("today"):header.enableButton("today")}function select(start,end){currentView.select(t.buildSelectRange.apply(t,arguments))}function unselect(){currentView&&currentView.unselect()}function prev(){date=currentView.computePrevDate(date),renderView()}function next(){date=currentView.computeNextDate(date),renderView()}function prevYear(){date.add(-1,"years"),renderView()}function nextYear(){date.add(1,"years"),renderView()}function today(){date=t.getNow(),renderView()}function gotoDate(dateInput){date=t.moment(dateInput),renderView()}function incrementDate(delta){date.add(moment.duration(delta)),renderView()}function zoomTo(newDate,viewType){var spec;viewType=viewType||"day",spec=t.getViewSpec(viewType)||t.getUnitViewSpec(viewType),date=newDate,renderView(spec?spec.type:null)}function getDate(){return date.clone()}function freezeContentHeight(){content.css({width:"100%",height:content.height(),overflow:"hidden"})}function unfreezeContentHeight(){content.css({width:"",height:"",overflow:""})}function getCalendar(){return t}function getView(){return currentView}function option(name,value){return void 0===value?options[name]:void("height"!=name&&"contentHeight"!=name&&"aspectRatio"!=name||(options[name]=value,updateSize(!0)))}function trigger(name,thisObj){var args=Array.prototype.slice.call(arguments,2);if(thisObj=thisObj||_element,this.triggerWith(name,thisObj,args),options[name])return options[name].apply(thisObj,args)}var t=this;t.initOptions(overrides||{});var options=this.options;t.render=render,t.destroy=destroy,t.refetchEvents=refetchEvents,t.reportEvents=reportEvents,t.reportEventChange=reportEventChange,t.rerenderEvents=renderEvents,t.changeView=renderView,t.select=select,t.unselect=unselect,t.prev=prev,t.next=next,t.prevYear=prevYear,t.nextYear=nextYear,t.today=today,t.gotoDate=gotoDate,t.incrementDate=incrementDate,t.zoomTo=zoomTo,t.getDate=getDate,t.getCalendar=getCalendar,t.getView=getView,t.option=option,t.trigger=trigger;var localeData=createObject(getMomentLocaleData(options.lang));if(options.monthNames&&(localeData._months=options.monthNames),options.monthNamesShort&&(localeData._monthsShort=options.monthNamesShort),options.dayNames&&(localeData._weekdays=options.dayNames),options.dayNamesShort&&(localeData._weekdaysShort=options.dayNamesShort),null!=options.firstDay){var _week=createObject(localeData._week);_week.dow=options.firstDay,localeData._week=_week}localeData._fullCalendar_weekCalc=function(weekCalc){return"function"==typeof weekCalc?weekCalc:"local"===weekCalc?weekCalc:"iso"===weekCalc||"ISO"===weekCalc?"ISO":void 0}(options.weekNumberCalculation),t.defaultAllDayEventDuration=moment.duration(options.defaultAllDayEventDuration),t.defaultTimedEventDuration=moment.duration(options.defaultTimedEventDuration),t.moment=function(){var mom;return"local"===options.timezone?(mom=fc.moment.apply(null,arguments),mom.hasTime()&&mom.local()):mom="UTC"===options.timezone?fc.moment.utc.apply(null,arguments):fc.moment.parseZone.apply(null,arguments),"_locale"in mom?mom._locale=localeData:mom._lang=localeData,mom},t.getIsAmbigTimezone=function(){return"local"!==options.timezone&&"UTC"!==options.timezone},t.rezoneDate=function(date){return t.moment(date.toArray())},t.getNow=function(){var now=options.now;return"function"==typeof now&&(now=now()),t.moment(now)},t.getEventEnd=function(event){return event.end?event.end.clone():t.getDefaultEventEnd(event.allDay,event.start)},t.getDefaultEventEnd=function(allDay,start){var end=start.clone();return allDay?end.stripTime().add(t.defaultAllDayEventDuration):end.add(t.defaultTimedEventDuration),t.getIsAmbigTimezone()&&end.stripZone(),end},t.humanizeDuration=function(duration){return(duration.locale||duration.lang).call(duration,options.lang).humanize()},EventManager.call(t,options);var header,headerElement,content,tm,currentView,suggestedViewHeight,windowResizeProxy,date,isFetchNeeded=t.isFetchNeeded,fetchEvents=t.fetchEvents,_element=element[0],viewsByType={},ignoreWindowResize=0,events=[];date=null!=options.defaultDate?t.moment(options.defaultDate):t.getNow(),t.getSuggestedViewHeight=function(){return void 0===suggestedViewHeight&&calcSize(),suggestedViewHeight},t.isHeightAuto=function(){return"auto"===options.contentHeight||"auto"===options.height},t.initialize()}function populateInstanceComputableOptions(options){$.each(instanceComputableOptions,function(name,func){null==options[name]&&(options[name]=func(options))})}function getMomentLocaleData(langCode){var func=moment.localeData||moment.langData;return func.call(moment,langCode)||func.call(moment,"en")}function Header(calendar,options){function render(){var sections=options.header;if(tm=options.theme?"ui":"fc",sections)return el=$("<div class='fc-toolbar'/>").append(renderSection("left")).append(renderSection("right")).append(renderSection("center")).append('<div class="fc-clear"/>')}function removeElement(){el.remove(),el=$()}function renderSection(position){var sectionEl=$('<div class="fc-'+position+'"/>'),buttonStr=options.header[position];return buttonStr&&$.each(buttonStr.split(" "),function(i){var groupEl,groupChildren=$(),isOnlyButtons=!0;$.each(this.split(","),function(j,buttonName){var customButtonProps,viewSpec,buttonClick,overrideText,defaultText,themeIcon,normalIcon,innerHtml,classes,button;"title"==buttonName?(groupChildren=groupChildren.add($("<h2>&nbsp;</h2>")),isOnlyButtons=!1):((customButtonProps=(calendar.options.customButtons||{})[buttonName])?(buttonClick=function(ev){customButtonProps.click&&customButtonProps.click.call(button[0],ev)},overrideText="",defaultText=customButtonProps.text):(viewSpec=calendar.getViewSpec(buttonName))?(buttonClick=function(){calendar.changeView(buttonName)},viewsWithButtons.push(buttonName),overrideText=viewSpec.buttonTextOverride,defaultText=viewSpec.buttonTextDefault):calendar[buttonName]&&(buttonClick=function(){calendar[buttonName]()},overrideText=(calendar.overrides.buttonText||{})[buttonName],defaultText=options.buttonText[buttonName]),buttonClick&&(themeIcon=customButtonProps?customButtonProps.themeIcon:options.themeButtonIcons[buttonName],normalIcon=customButtonProps?customButtonProps.icon:options.buttonIcons[buttonName],innerHtml=overrideText?htmlEscape(overrideText):themeIcon&&options.theme?"<span class='ui-icon ui-icon-"+themeIcon+"'></span>":normalIcon&&!options.theme?"<span class='fc-icon fc-icon-"+normalIcon+"'></span>":htmlEscape(defaultText),classes=["fc-"+buttonName+"-button",tm+"-button",tm+"-state-default"],button=$('<button type="button" class="'+classes.join(" ")+'">'+innerHtml+"</button>").click(function(ev){button.hasClass(tm+"-state-disabled")||(buttonClick(ev),(button.hasClass(tm+"-state-active")||button.hasClass(tm+"-state-disabled"))&&button.removeClass(tm+"-state-hover"))}).mousedown(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-down")}).mouseup(function(){button.removeClass(tm+"-state-down")}).hover(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-hover")},function(){button.removeClass(tm+"-state-hover").removeClass(tm+"-state-down")}),groupChildren=groupChildren.add(button)))}),isOnlyButtons&&groupChildren.first().addClass(tm+"-corner-left").end().last().addClass(tm+"-corner-right").end(),groupChildren.length>1?(groupEl=$("<div/>"),isOnlyButtons&&groupEl.addClass("fc-button-group"),groupEl.append(groupChildren),sectionEl.append(groupEl)):sectionEl.append(groupChildren)}),sectionEl}function updateTitle(text){el.find("h2").text(text)}function activateButton(buttonName){el.find(".fc-"+buttonName+"-button").addClass(tm+"-state-active")}function deactivateButton(buttonName){el.find(".fc-"+buttonName+"-button").removeClass(tm+"-state-active")}function disableButton(buttonName){el.find(".fc-"+buttonName+"-button").attr("disabled","disabled").addClass(tm+"-state-disabled")}function enableButton(buttonName){el.find(".fc-"+buttonName+"-button").removeAttr("disabled").removeClass(tm+"-state-disabled")}function getViewsWithButtons(){return viewsWithButtons}var t=this;t.render=render,t.removeElement=removeElement,t.updateTitle=updateTitle,t.activateButton=activateButton,t.deactivateButton=deactivateButton,t.disableButton=disableButton,t.enableButton=enableButton,t.getViewsWithButtons=getViewsWithButtons;var tm,el=$(),viewsWithButtons=[]}function EventManager(options){function isFetchNeeded(start,end){return!rangeStart||start.clone().stripZone()<rangeStart.clone().stripZone()||end.clone().stripZone()>rangeEnd.clone().stripZone()}function fetchEvents(start,end){rangeStart=start,rangeEnd=end,cache=[];var fetchID=++currentFetchID,len=sources.length;pendingSourceCnt=len;for(var i=0;i<len;i++)fetchEventSource(sources[i],fetchID)}function fetchEventSource(source,fetchID){_fetchEventSource(source,function(eventInputs){var i,eventInput,abstractEvent,isArraySource=$.isArray(source.events);if(fetchID==currentFetchID){if(eventInputs)for(i=0;i<eventInputs.length;i++)eventInput=eventInputs[i],abstractEvent=isArraySource?eventInput:buildEventFromInput(eventInput,source),abstractEvent&&cache.push.apply(cache,expandEvent(abstractEvent));pendingSourceCnt--,pendingSourceCnt||reportEvents(cache)}})}function _fetchEventSource(source,callback){var i,res,fetchers=fc.sourceFetchers;for(i=0;i<fetchers.length;i++){if(res=fetchers[i].call(t,source,rangeStart.clone(),rangeEnd.clone(),options.timezone,callback),res===!0)return;if("object"==typeof res)return void _fetchEventSource(res,callback)}var events=source.events;if(events)$.isFunction(events)?(t.pushLoading(),events.call(t,rangeStart.clone(),rangeEnd.clone(),options.timezone,function(events){callback(events),t.popLoading()})):$.isArray(events)?callback(events):callback();else{var url=source.url;if(url){var customData,success=source.success,error=source.error,complete=source.complete;customData=$.isFunction(source.data)?source.data():source.data;var data=$.extend({},customData||{}),startParam=firstDefined(source.startParam,options.startParam),endParam=firstDefined(source.endParam,options.endParam),timezoneParam=firstDefined(source.timezoneParam,options.timezoneParam);startParam&&(data[startParam]=rangeStart.format()),endParam&&(data[endParam]=rangeEnd.format()),options.timezone&&"local"!=options.timezone&&(data[timezoneParam]=options.timezone),t.pushLoading(),$.ajax($.extend({},ajaxDefaults,source,{data:data,success:function(events){events=events||[];var res=applyAll(success,this,arguments);$.isArray(res)&&(events=res),callback(events)},error:function(){applyAll(error,this,arguments),callback()},complete:function(){applyAll(complete,this,arguments),t.popLoading()}}))}else callback()}}function addEventSource(sourceInput){var source=buildEventSource(sourceInput);source&&(sources.push(source),pendingSourceCnt++,fetchEventSource(source,currentFetchID))}function buildEventSource(sourceInput){var source,i,normalizers=fc.sourceNormalizers;if($.isFunction(sourceInput)||$.isArray(sourceInput)?source={events:sourceInput}:"string"==typeof sourceInput?source={url:sourceInput}:"object"==typeof sourceInput&&(source=$.extend({},sourceInput)),source){for(source.className?"string"==typeof source.className&&(source.className=source.className.split(/\s+/)):source.className=[],$.isArray(source.events)&&(source.origArray=source.events,source.events=$.map(source.events,function(eventInput){return buildEventFromInput(eventInput,source)})),i=0;i<normalizers.length;i++)normalizers[i].call(t,source);return source}}function removeEventSource(source){sources=$.grep(sources,function(src){return!isSourcesEqual(src,source)}),cache=$.grep(cache,function(e){return!isSourcesEqual(e.source,source)}),reportEvents(cache)}function isSourcesEqual(source1,source2){return source1&&source2&&getSourcePrimitive(source1)==getSourcePrimitive(source2)}function getSourcePrimitive(source){return("object"==typeof source?source.origArray||source.googleCalendarId||source.url||source.events:null)||source}function updateEvent(event){event.start=t.moment(event.start),event.end?event.end=t.moment(event.end):event.end=null,mutateEvent(event,getMiscEventProps(event)),reportEvents(cache)}function getMiscEventProps(event){var props={};return $.each(event,function(name,val){isMiscEventPropName(name)&&void 0!==val&&isAtomic(val)&&(props[name]=val)}),props}function isMiscEventPropName(name){return!/^_|^(id|allDay|start|end)$/.test(name)}function renderEvent(eventInput,stick){var events,i,event,abstractEvent=buildEventFromInput(eventInput);if(abstractEvent){for(events=expandEvent(abstractEvent),i=0;i<events.length;i++)event=events[i],event.source||(stick&&(stickySource.events.push(event),event.source=stickySource),cache.push(event));return reportEvents(cache),events}return[]}function removeEvents(filter){var eventID,i;for(null==filter?filter=function(){return!0}:$.isFunction(filter)||(eventID=filter+"",filter=function(event){return event._id==eventID}),cache=$.grep(cache,filter,!0),i=0;i<sources.length;i++)$.isArray(sources[i].events)&&(sources[i].events=$.grep(sources[i].events,filter,!0));reportEvents(cache)}function clientEvents(filter){return $.isFunction(filter)?$.grep(cache,filter):null!=filter?(filter+="",$.grep(cache,function(e){return e._id==filter})):cache}function buildEventFromInput(input,source){var start,end,allDay,out={};if(options.eventDataTransform&&(input=options.eventDataTransform(input)),source&&source.eventDataTransform&&(input=source.eventDataTransform(input)),$.extend(out,input),source&&(out.source=source),out._id=input._id||(void 0===input.id?"_fc"+eventGUID++:input.id+""),input.className?"string"==typeof input.className?out.className=input.className.split(/\s+/):out.className=input.className:out.className=[],start=input.start||input.date,end=input.end,isTimeString(start)&&(start=moment.duration(start)),isTimeString(end)&&(end=moment.duration(end)),input.dow||moment.isDuration(start)||moment.isDuration(end))out.start=start?moment.duration(start):null,out.end=end?moment.duration(end):null,out._recurring=!0;else{if(start&&(start=t.moment(start),!start.isValid()))return!1;end&&(end=t.moment(end),end.isValid()||(end=null)),allDay=input.allDay,void 0===allDay&&(allDay=firstDefined(source?source.allDayDefault:void 0,options.allDayDefault)),assignDatesToEvent(start,end,allDay,out)}return out}function assignDatesToEvent(start,end,allDay,event){event.start=start,event.end=end,event.allDay=allDay,normalizeEventRange(event),backupEventDates(event)}function normalizeEventRange(props){normalizeEventRangeTimes(props),props.end&&!props.end.isAfter(props.start)&&(props.end=null),props.end||(options.forceEventDuration?props.end=t.getDefaultEventEnd(props.allDay,props.start):props.end=null)}function normalizeEventRangeTimes(range){null==range.allDay&&(range.allDay=!(range.start.hasTime()||range.end&&range.end.hasTime())),range.allDay?(range.start.stripTime(),range.end&&range.end.stripTime()):(range.start.hasTime()||(range.start=t.rezoneDate(range.start)),range.end&&!range.end.hasTime()&&(range.end=t.rezoneDate(range.end)))}function ensureVisibleEventRange(range){var allDay;return range.end||(allDay=range.allDay,null==allDay&&(allDay=!range.start.hasTime()),range=$.extend({},range),range.end=t.getDefaultEventEnd(allDay,range.start)),range}function expandEvent(abstractEvent,_rangeStart,_rangeEnd){var dowHash,dow,i,date,startTime,endTime,start,end,event,events=[];if(_rangeStart=_rangeStart||rangeStart,_rangeEnd=_rangeEnd||rangeEnd,abstractEvent)if(abstractEvent._recurring){if(dow=abstractEvent.dow)for(dowHash={},i=0;i<dow.length;i++)dowHash[dow[i]]=!0;for(date=_rangeStart.clone().stripTime();date.isBefore(_rangeEnd);)dowHash&&!dowHash[date.day()]||(startTime=abstractEvent.start,endTime=abstractEvent.end,start=date.clone(),end=null,startTime&&(start=start.time(startTime)),endTime&&(end=date.clone().time(endTime)),event=$.extend({},abstractEvent),assignDatesToEvent(start,end,!startTime&&!endTime,event),events.push(event)),date.add(1,"days")}else events.push(abstractEvent);return events}function mutateEvent(event,newProps,largeUnit){function diffDates(date1,date0){return largeUnit?diffByUnit(date1,date0,largeUnit):newProps.allDay?diffDay(date1,date0):diffDayTime(date1,date0)}var oldProps,clearEnd,startDelta,endDelta,durationDelta,undoFunc,miscProps={};return newProps=newProps||{},newProps.start||(newProps.start=event.start.clone()),void 0===newProps.end&&(newProps.end=event.end?event.end.clone():null),null==newProps.allDay&&(newProps.allDay=event.allDay),normalizeEventRange(newProps),oldProps={start:event._start.clone(),end:event._end?event._end.clone():t.getDefaultEventEnd(event._allDay,event._start),allDay:newProps.allDay},normalizeEventRange(oldProps),clearEnd=null!==event._end&&null===newProps.end,startDelta=diffDates(newProps.start,oldProps.start),newProps.end?(endDelta=diffDates(newProps.end,oldProps.end),durationDelta=endDelta.subtract(startDelta)):durationDelta=null,$.each(newProps,function(name,val){isMiscEventPropName(name)&&void 0!==val&&(miscProps[name]=val)}),undoFunc=mutateEvents(clientEvents(event._id),clearEnd,newProps.allDay,startDelta,durationDelta,miscProps),{dateDelta:startDelta,durationDelta:durationDelta,undo:undoFunc}}function mutateEvents(events,clearEnd,allDay,dateDelta,durationDelta,miscProps){var isAmbigTimezone=t.getIsAmbigTimezone(),undoFunctions=[];return dateDelta&&!dateDelta.valueOf()&&(dateDelta=null),durationDelta&&!durationDelta.valueOf()&&(durationDelta=null),$.each(events,function(i,event){var oldProps,newProps;oldProps={start:event.start.clone(),end:event.end?event.end.clone():null,allDay:event.allDay},$.each(miscProps,function(name){oldProps[name]=event[name]}),newProps={start:event._start,end:event._end,allDay:allDay},normalizeEventRange(newProps),clearEnd?newProps.end=null:durationDelta&&!newProps.end&&(newProps.end=t.getDefaultEventEnd(newProps.allDay,newProps.start)),dateDelta&&(newProps.start.add(dateDelta),newProps.end&&newProps.end.add(dateDelta)),durationDelta&&newProps.end.add(durationDelta),isAmbigTimezone&&!newProps.allDay&&(dateDelta||durationDelta)&&(newProps.start.stripZone(),newProps.end&&newProps.end.stripZone()),$.extend(event,miscProps,newProps),backupEventDates(event),undoFunctions.push(function(){$.extend(event,oldProps),backupEventDates(event)})}),function(){for(var i=0;i<undoFunctions.length;i++)undoFunctions[i]()}}function getBusinessHoursEvents(wholeDay){var eventInput,optionVal=options.businessHours,defaultVal={className:"fc-nonbusiness",start:"09:00",end:"17:00",dow:[1,2,3,4,5],rendering:"inverse-background"},view=t.getView();return optionVal&&(eventInput=$.extend({},defaultVal,"object"==typeof optionVal?optionVal:{})),eventInput?(wholeDay&&(eventInput.start=null,eventInput.end=null),expandEvent(buildEventFromInput(eventInput),view.start,view.end)):[]}function isEventRangeAllowed(range,event){var source=event.source||{},constraint=firstDefined(event.constraint,source.constraint,options.eventConstraint),overlap=firstDefined(event.overlap,source.overlap,options.eventOverlap);return range=ensureVisibleEventRange(range),isRangeAllowed(range,constraint,overlap,event)}function isSelectionRangeAllowed(range){return isRangeAllowed(range,options.selectConstraint,options.selectOverlap)}function isExternalDropRangeAllowed(range,eventProps){var eventInput,event;return eventProps&&(eventInput=$.extend({},eventProps,range),event=expandEvent(buildEventFromInput(eventInput))[0]),event?isEventRangeAllowed(range,event):(range=ensureVisibleEventRange(range),isSelectionRangeAllowed(range))}function isRangeAllowed(range,constraint,overlap,event){var constraintEvents,anyContainment,peerEvents,i,peerEvent,peerOverlap;if(range=$.extend({},range),range.start=range.start.clone().stripZone(),range.end=range.end.clone().stripZone(),null!=constraint){for(constraintEvents=constraintToEvents(constraint),anyContainment=!1,i=0;i<constraintEvents.length;i++)if(eventContainsRange(constraintEvents[i],range)){anyContainment=!0;break}if(!anyContainment)return!1}for(peerEvents=t.getPeerEvents(event,range),i=0;i<peerEvents.length;i++)if(peerEvent=peerEvents[i],eventIntersectsRange(peerEvent,range)){if(overlap===!1)return!1;if("function"==typeof overlap&&!overlap(peerEvent,event))return!1;if(event){if(peerOverlap=firstDefined(peerEvent.overlap,(peerEvent.source||{}).overlap),peerOverlap===!1)return!1;if("function"==typeof peerOverlap&&!peerOverlap(event,peerEvent))return!1}}return!0}function constraintToEvents(constraintInput){return"businessHours"===constraintInput?getBusinessHoursEvents():"object"==typeof constraintInput?expandEvent(buildEventFromInput(constraintInput)):clientEvents(constraintInput)}function eventContainsRange(event,range){var eventStart=event.start.clone().stripZone(),eventEnd=t.getEventEnd(event).stripZone();return range.start>=eventStart&&range.end<=eventEnd}function eventIntersectsRange(event,range){var eventStart=event.start.clone().stripZone(),eventEnd=t.getEventEnd(event).stripZone();return range.start<eventEnd&&range.end>eventStart}var t=this;t.isFetchNeeded=isFetchNeeded,t.fetchEvents=fetchEvents,t.addEventSource=addEventSource,t.removeEventSource=removeEventSource,
t.updateEvent=updateEvent,t.renderEvent=renderEvent,t.removeEvents=removeEvents,t.clientEvents=clientEvents,t.mutateEvent=mutateEvent,t.normalizeEventRange=normalizeEventRange,t.normalizeEventRangeTimes=normalizeEventRangeTimes,t.ensureVisibleEventRange=ensureVisibleEventRange;var rangeStart,rangeEnd,reportEvents=t.reportEvents,stickySource={events:[]},sources=[stickySource],currentFetchID=0,pendingSourceCnt=0,cache=[];$.each((options.events?[options.events]:[]).concat(options.eventSources||[]),function(i,sourceInput){var source=buildEventSource(sourceInput);source&&sources.push(source)}),t.getBusinessHoursEvents=getBusinessHoursEvents,t.isEventRangeAllowed=isEventRangeAllowed,t.isSelectionRangeAllowed=isSelectionRangeAllowed,t.isExternalDropRangeAllowed=isExternalDropRangeAllowed,t.getEventCache=function(){return cache}}function backupEventDates(event){event._allDay=event.allDay,event._start=event.start.clone(),event._end=event.end?event.end.clone():null}var fc=$.fullCalendar={version:"2.4.0"},fcViews=fc.views={};$.fn.fullCalendar=function(options){var args=Array.prototype.slice.call(arguments,1),res=this;return this.each(function(i,_element){var singleRes,element=$(_element),calendar=element.data("fullCalendar");"string"==typeof options?calendar&&$.isFunction(calendar[options])&&(singleRes=calendar[options].apply(calendar,args),i||(res=singleRes),"destroy"===options&&element.removeData("fullCalendar")):calendar||(calendar=new Calendar(element,options),element.data("fullCalendar",calendar),calendar.render())}),res};var complexOptions=["header","buttonText","buttonIcons","themeButtonIcons"];fc.intersectionToSeg=intersectionToSeg,fc.applyAll=applyAll,fc.debounce=debounce,fc.isInt=isInt,fc.htmlEscape=htmlEscape,fc.cssToStr=cssToStr,fc.proxy=proxy,fc.capitaliseFirstLetter=capitaliseFirstLetter,fc.getClientRect=getClientRect,fc.getContentRect=getContentRect,fc.getScrollbarWidths=getScrollbarWidths;var _isLeftRtlScrollbars=null;fc.intersectRects=intersectRects,fc.parseFieldSpecs=parseFieldSpecs,fc.compareByFieldSpecs=compareByFieldSpecs,fc.compareByFieldSpec=compareByFieldSpec,fc.flexibleCompare=flexibleCompare,fc.computeIntervalUnit=computeIntervalUnit,fc.divideRangeByDuration=divideRangeByDuration,fc.divideDurationByDuration=divideDurationByDuration,fc.multiplyDuration=multiplyDuration,fc.durationHasTime=durationHasTime;var dayIDs=["sun","mon","tue","wed","thu","fri","sat"],intervalUnits=["year","month","week","day","hour","minute","second","millisecond"];fc.log=function(){var console=window.console;if(console&&console.log)return console.log.apply(console,arguments)},fc.warn=function(){var console=window.console;return console&&console.warn?console.warn.apply(console,arguments):fc.log.apply(fc,arguments)};var allowValueOptimization,setUTCValues,setLocalValues,hasOwnPropMethod={}.hasOwnProperty,ambigDateOfMonthRegex=/^\s*\d{4}-\d\d$/,ambigTimeOrZoneRegex=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/,newMomentProto=moment.fn,oldMomentProto=$.extend({},newMomentProto);fc.moment=function(){return makeMoment(arguments)},fc.moment.utc=function(){var mom=makeMoment(arguments,!0);return mom.hasTime()&&mom.utc(),mom},fc.moment.parseZone=function(){return makeMoment(arguments,!0,!0)},newMomentProto.clone=function(){var mom=oldMomentProto.clone.apply(this,arguments);return transferAmbigs(this,mom),this._fullCalendar&&(mom._fullCalendar=!0),mom},newMomentProto.week=newMomentProto.weeks=function(input){var weekCalc=(this._locale||this._lang)._fullCalendar_weekCalc;return null==input&&"function"==typeof weekCalc?weekCalc(this):"ISO"===weekCalc?oldMomentProto.isoWeek.apply(this,arguments):oldMomentProto.week.apply(this,arguments)},newMomentProto.time=function(time){if(!this._fullCalendar)return oldMomentProto.time.apply(this,arguments);if(null==time)return moment.duration({hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()});this._ambigTime=!1,moment.isDuration(time)||moment.isMoment(time)||(time=moment.duration(time));var dayHours=0;return moment.isDuration(time)&&(dayHours=24*Math.floor(time.asDays())),this.hours(dayHours+time.hours()).minutes(time.minutes()).seconds(time.seconds()).milliseconds(time.milliseconds())},newMomentProto.stripTime=function(){var a;return this._ambigTime||(a=this.toArray(),this.utc(),setUTCValues(this,a.slice(0,3)),this._ambigTime=!0,this._ambigZone=!0),this},newMomentProto.hasTime=function(){return!this._ambigTime},newMomentProto.stripZone=function(){var a,wasAmbigTime;return this._ambigZone||(a=this.toArray(),wasAmbigTime=this._ambigTime,this.utc(),setUTCValues(this,a),this._ambigTime=wasAmbigTime||!1,this._ambigZone=!0),this},newMomentProto.hasZone=function(){return!this._ambigZone},newMomentProto.local=function(){var a=this.toArray(),wasAmbigZone=this._ambigZone;return oldMomentProto.local.apply(this,arguments),this._ambigTime=!1,this._ambigZone=!1,wasAmbigZone&&setLocalValues(this,a),this},newMomentProto.utc=function(){return oldMomentProto.utc.apply(this,arguments),this._ambigTime=!1,this._ambigZone=!1,this},$.each(["zone","utcOffset"],function(i,name){oldMomentProto[name]&&(newMomentProto[name]=function(tzo){return null!=tzo&&(this._ambigTime=!1,this._ambigZone=!1),oldMomentProto[name].apply(this,arguments)})}),newMomentProto.format=function(){return this._fullCalendar&&arguments[0]?formatDate(this,arguments[0]):this._ambigTime?oldMomentFormat(this,"YYYY-MM-DD"):this._ambigZone?oldMomentFormat(this,"YYYY-MM-DD[T]HH:mm:ss"):oldMomentProto.format.apply(this,arguments)},newMomentProto.toISOString=function(){return this._ambigTime?oldMomentFormat(this,"YYYY-MM-DD"):this._ambigZone?oldMomentFormat(this,"YYYY-MM-DD[T]HH:mm:ss"):oldMomentProto.toISOString.apply(this,arguments)},newMomentProto.isWithin=function(start,end){var a=commonlyAmbiguate([this,start,end]);return a[0]>=a[1]&&a[0]<a[2]},newMomentProto.isSame=function(input,units){var a;return this._fullCalendar?units?(a=commonlyAmbiguate([this,input],!0),oldMomentProto.isSame.call(a[0],a[1],units)):(input=fc.moment.parseZone(input),oldMomentProto.isSame.call(this,input)&&Boolean(this._ambigTime)===Boolean(input._ambigTime)&&Boolean(this._ambigZone)===Boolean(input._ambigZone)):oldMomentProto.isSame.apply(this,arguments)},$.each(["isBefore","isAfter"],function(i,methodName){newMomentProto[methodName]=function(input,units){var a;return this._fullCalendar?(a=commonlyAmbiguate([this,input]),oldMomentProto[methodName].call(a[0],a[1],units)):oldMomentProto[methodName].apply(this,arguments)}}),allowValueOptimization="_d"in moment()&&"updateOffset"in moment,setUTCValues=allowValueOptimization?function(mom,a){mom._d.setTime(Date.UTC.apply(Date,a)),moment.updateOffset(mom,!1)}:setMomentValues,setLocalValues=allowValueOptimization?function(mom,a){mom._d.setTime(+new Date(a[0]||0,a[1]||0,a[2]||0,a[3]||0,a[4]||0,a[5]||0,a[6]||0)),moment.updateOffset(mom,!1)}:setMomentValues;var tokenOverrides={t:function(date){return oldMomentFormat(date,"a").charAt(0)},T:function(date){return oldMomentFormat(date,"A").charAt(0)}};fc.formatRange=formatRange;var similarUnitMap={Y:"year",M:"month",D:"day",d:"day",A:"second",a:"second",T:"second",t:"second",H:"second",h:"second",m:"second",s:"second"},formatStringChunkCache={};fc.Class=Class,Class.extend=function(members){var subClass,superClass=this;return members=members||{},hasOwnProp(members,"constructor")&&(subClass=members.constructor),"function"!=typeof subClass&&(subClass=members.constructor=function(){superClass.apply(this,arguments)}),subClass.prototype=createObject(superClass.prototype),copyOwnProps(members,subClass.prototype),copyNativeMethods(members,subClass.prototype),copyOwnProps(superClass,subClass),subClass},Class.mixin=function(members){copyOwnProps(members.prototype||members,this.prototype)};var Emitter=fc.Emitter=Class.extend({callbackHash:null,on:function(name,callback){return this.getCallbacks(name).add(callback),this},off:function(name,callback){return this.getCallbacks(name).remove(callback),this},trigger:function(name){var args=Array.prototype.slice.call(arguments,1);return this.triggerWith(name,this,args),this},triggerWith:function(name,context,args){var callbacks=this.getCallbacks(name);return callbacks.fireWith(context,args),this},getCallbacks:function(name){var callbacks;return this.callbackHash||(this.callbackHash={}),callbacks=this.callbackHash[name],callbacks||(callbacks=this.callbackHash[name]=$.Callbacks()),callbacks}}),Popover=Class.extend({isHidden:!0,options:null,el:null,documentMousedownProxy:null,margin:10,constructor:function(options){this.options=options||{}},show:function(){this.isHidden&&(this.el||this.render(),this.el.show(),this.position(),this.isHidden=!1,this.trigger("show"))},hide:function(){this.isHidden||(this.el.hide(),this.isHidden=!0,this.trigger("hide"))},render:function(){var _this=this,options=this.options;this.el=$('<div class="fc-popover"/>').addClass(options.className||"").css({top:0,left:0}).append(options.content).appendTo(options.parentEl),this.el.on("click",".fc-close",function(){_this.hide()}),options.autoHide&&$(document).on("mousedown",this.documentMousedownProxy=proxy(this,"documentMousedown"))},documentMousedown:function(ev){this.el&&!$(ev.target).closest(this.el).length&&this.hide()},removeElement:function(){this.hide(),this.el&&(this.el.remove(),this.el=null),$(document).off("mousedown",this.documentMousedownProxy)},position:function(){var viewportTop,viewportLeft,viewportOffset,top,left,options=this.options,origin=this.el.offsetParent().offset(),width=this.el.outerWidth(),height=this.el.outerHeight(),windowEl=$(window),viewportEl=getScrollParent(this.el);top=options.top||0,left=void 0!==options.left?options.left:void 0!==options.right?options.right-width:0,viewportEl.is(window)||viewportEl.is(document)?(viewportEl=windowEl,viewportTop=0,viewportLeft=0):(viewportOffset=viewportEl.offset(),viewportTop=viewportOffset.top,viewportLeft=viewportOffset.left),viewportTop+=windowEl.scrollTop(),viewportLeft+=windowEl.scrollLeft(),options.viewportConstrain!==!1&&(top=Math.min(top,viewportTop+viewportEl.outerHeight()-height-this.margin),top=Math.max(top,viewportTop+this.margin),left=Math.min(left,viewportLeft+viewportEl.outerWidth()-width-this.margin),left=Math.max(left,viewportLeft+this.margin)),this.el.css({top:top-origin.top,left:left-origin.left})},trigger:function(name){this.options[name]&&this.options[name].apply(this,Array.prototype.slice.call(arguments,1))}}),GridCoordMap=Class.extend({grid:null,rowCoords:null,colCoords:null,containerEl:null,bounds:null,constructor:function(grid){this.grid=grid},build:function(){this.grid.build(),this.rowCoords=this.grid.computeRowCoords(),this.colCoords=this.grid.computeColCoords(),this.computeBounds()},clear:function(){this.grid.clear(),this.rowCoords=null,this.colCoords=null},getCell:function(x,y){var i,coords,cell,rowCoords=this.rowCoords,rowCnt=rowCoords.length,colCoords=this.colCoords,colCnt=colCoords.length,hitRow=null,hitCol=null;if(this.inBounds(x,y)){for(i=0;i<rowCnt;i++)if(coords=rowCoords[i],y>=coords.top&&y<coords.bottom){hitRow=i;break}for(i=0;i<colCnt;i++)if(coords=colCoords[i],x>=coords.left&&x<coords.right){hitCol=i;break}if(null!==hitRow&&null!==hitCol)return cell=this.grid.getCell(hitRow,hitCol),cell.grid=this.grid,$.extend(cell,rowCoords[hitRow],colCoords[hitCol]),cell}return null},computeBounds:function(){this.bounds=this.containerEl?getClientRect(this.containerEl):null},inBounds:function(x,y){var bounds=this.bounds;return!bounds||x>=bounds.left&&x<bounds.right&&y>=bounds.top&&y<bounds.bottom}}),ComboCoordMap=Class.extend({coordMaps:null,constructor:function(coordMaps){this.coordMaps=coordMaps},build:function(){var i,coordMaps=this.coordMaps;for(i=0;i<coordMaps.length;i++)coordMaps[i].build()},getCell:function(x,y){var i,coordMaps=this.coordMaps,cell=null;for(i=0;i<coordMaps.length&&!cell;i++)cell=coordMaps[i].getCell(x,y);return cell},clear:function(){var i,coordMaps=this.coordMaps;for(i=0;i<coordMaps.length;i++)coordMaps[i].clear()}}),DragListener=fc.DragListener=Class.extend({options:null,isListening:!1,isDragging:!1,originX:null,originY:null,mousemoveProxy:null,mouseupProxy:null,subjectEl:null,subjectHref:null,scrollEl:null,scrollBounds:null,scrollTopVel:null,scrollLeftVel:null,scrollIntervalId:null,scrollHandlerProxy:null,scrollSensitivity:30,scrollSpeed:200,scrollIntervalMs:50,constructor:function(options){options=options||{},this.options=options,this.subjectEl=options.subjectEl},mousedown:function(ev){isPrimaryMouseButton(ev)&&(ev.preventDefault(),this.startListening(ev),this.options.distance||this.startDrag(ev))},startListening:function(ev){var scrollParent;this.isListening||(ev&&this.options.scroll&&(scrollParent=getScrollParent($(ev.target)),scrollParent.is(window)||scrollParent.is(document)||(this.scrollEl=scrollParent,this.scrollHandlerProxy=debounce(proxy(this,"scrollHandler"),100),this.scrollEl.on("scroll",this.scrollHandlerProxy))),$(document).on("mousemove",this.mousemoveProxy=proxy(this,"mousemove")).on("mouseup",this.mouseupProxy=proxy(this,"mouseup")).on("selectstart",this.preventDefault),ev?(this.originX=ev.pageX,this.originY=ev.pageY):(this.originX=0,this.originY=0),this.isListening=!0,this.listenStart(ev))},listenStart:function(ev){this.trigger("listenStart",ev)},mousemove:function(ev){var minDistance,distanceSq,dx=ev.pageX-this.originX,dy=ev.pageY-this.originY;this.isDragging||(minDistance=this.options.distance||1,distanceSq=dx*dx+dy*dy,distanceSq>=minDistance*minDistance&&this.startDrag(ev)),this.isDragging&&this.drag(dx,dy,ev)},startDrag:function(ev){this.isListening||this.startListening(),this.isDragging||(this.isDragging=!0,this.dragStart(ev))},dragStart:function(ev){var subjectEl=this.subjectEl;this.trigger("dragStart",ev),(this.subjectHref=subjectEl?subjectEl.attr("href"):null)&&subjectEl.removeAttr("href")},drag:function(dx,dy,ev){this.trigger("drag",dx,dy,ev),this.updateScroll(ev)},mouseup:function(ev){this.stopListening(ev)},stopDrag:function(ev){this.isDragging&&(this.stopScrolling(),this.dragStop(ev),this.isDragging=!1)},dragStop:function(ev){var _this=this;this.trigger("dragStop",ev),setTimeout(function(){_this.subjectHref&&_this.subjectEl.attr("href",_this.subjectHref)},0)},stopListening:function(ev){this.stopDrag(ev),this.isListening&&(this.scrollEl&&(this.scrollEl.off("scroll",this.scrollHandlerProxy),this.scrollHandlerProxy=null),$(document).off("mousemove",this.mousemoveProxy).off("mouseup",this.mouseupProxy).off("selectstart",this.preventDefault),this.mousemoveProxy=null,this.mouseupProxy=null,this.isListening=!1,this.listenStop(ev))},listenStop:function(ev){this.trigger("listenStop",ev)},trigger:function(name){this.options[name]&&this.options[name].apply(this,Array.prototype.slice.call(arguments,1))},preventDefault:function(ev){ev.preventDefault()},computeScrollBounds:function(){var el=this.scrollEl;this.scrollBounds=el?getOuterRect(el):null},updateScroll:function(ev){var topCloseness,bottomCloseness,leftCloseness,rightCloseness,sensitivity=this.scrollSensitivity,bounds=this.scrollBounds,topVel=0,leftVel=0;bounds&&(topCloseness=(sensitivity-(ev.pageY-bounds.top))/sensitivity,bottomCloseness=(sensitivity-(bounds.bottom-ev.pageY))/sensitivity,leftCloseness=(sensitivity-(ev.pageX-bounds.left))/sensitivity,rightCloseness=(sensitivity-(bounds.right-ev.pageX))/sensitivity,topCloseness>=0&&topCloseness<=1?topVel=topCloseness*this.scrollSpeed*-1:bottomCloseness>=0&&bottomCloseness<=1&&(topVel=bottomCloseness*this.scrollSpeed),leftCloseness>=0&&leftCloseness<=1?leftVel=leftCloseness*this.scrollSpeed*-1:rightCloseness>=0&&rightCloseness<=1&&(leftVel=rightCloseness*this.scrollSpeed)),this.setScrollVel(topVel,leftVel)},setScrollVel:function(topVel,leftVel){this.scrollTopVel=topVel,this.scrollLeftVel=leftVel,this.constrainScrollVel(),!this.scrollTopVel&&!this.scrollLeftVel||this.scrollIntervalId||(this.scrollIntervalId=setInterval(proxy(this,"scrollIntervalFunc"),this.scrollIntervalMs))},constrainScrollVel:function(){var el=this.scrollEl;this.scrollTopVel<0?el.scrollTop()<=0&&(this.scrollTopVel=0):this.scrollTopVel>0&&el.scrollTop()+el[0].clientHeight>=el[0].scrollHeight&&(this.scrollTopVel=0),this.scrollLeftVel<0?el.scrollLeft()<=0&&(this.scrollLeftVel=0):this.scrollLeftVel>0&&el.scrollLeft()+el[0].clientWidth>=el[0].scrollWidth&&(this.scrollLeftVel=0)},scrollIntervalFunc:function(){var el=this.scrollEl,frac=this.scrollIntervalMs/1e3;this.scrollTopVel&&el.scrollTop(el.scrollTop()+this.scrollTopVel*frac),this.scrollLeftVel&&el.scrollLeft(el.scrollLeft()+this.scrollLeftVel*frac),this.constrainScrollVel(),this.scrollTopVel||this.scrollLeftVel||this.stopScrolling()},stopScrolling:function(){this.scrollIntervalId&&(clearInterval(this.scrollIntervalId),this.scrollIntervalId=null,this.scrollStop())},scrollHandler:function(){this.scrollIntervalId||this.scrollStop()},scrollStop:function(){}}),CellDragListener=DragListener.extend({coordMap:null,origCell:null,cell:null,coordAdjust:null,constructor:function(coordMap,options){DragListener.prototype.constructor.call(this,options),this.coordMap=coordMap},listenStart:function(ev){var subjectRect,origPoint,point,subjectEl=this.subjectEl;DragListener.prototype.listenStart.apply(this,arguments),this.computeCoords(),ev?(origPoint={left:ev.pageX,top:ev.pageY},point=origPoint,subjectEl&&(subjectRect=getOuterRect(subjectEl),point=constrainPoint(point,subjectRect)),this.origCell=this.getCell(point.left,point.top),subjectEl&&this.options.subjectCenter&&(this.origCell&&(subjectRect=intersectRects(this.origCell,subjectRect)||subjectRect),point=getRectCenter(subjectRect)),this.coordAdjust=diffPoints(point,origPoint)):(this.origCell=null,this.coordAdjust=null)},computeCoords:function(){this.coordMap.build(),this.computeScrollBounds()},dragStart:function(ev){var cell;DragListener.prototype.dragStart.apply(this,arguments),cell=this.getCell(ev.pageX,ev.pageY),cell&&this.cellOver(cell)},drag:function(dx,dy,ev){var cell;DragListener.prototype.drag.apply(this,arguments),cell=this.getCell(ev.pageX,ev.pageY),isCellsEqual(cell,this.cell)||(this.cell&&this.cellOut(),cell&&this.cellOver(cell))},dragStop:function(){this.cellDone(),DragListener.prototype.dragStop.apply(this,arguments)},cellOver:function(cell){this.cell=cell,this.trigger("cellOver",cell,isCellsEqual(cell,this.origCell),this.origCell)},cellOut:function(){this.cell&&(this.trigger("cellOut",this.cell),this.cellDone(),this.cell=null)},cellDone:function(){this.cell&&this.trigger("cellDone",this.cell)},listenStop:function(){DragListener.prototype.listenStop.apply(this,arguments),this.origCell=this.cell=null,this.coordMap.clear()},scrollStop:function(){DragListener.prototype.scrollStop.apply(this,arguments),this.computeCoords()},getCell:function(left,top){return this.coordAdjust&&(left+=this.coordAdjust.left,top+=this.coordAdjust.top),this.coordMap.getCell(left,top)}}),MouseFollower=Class.extend({options:null,sourceEl:null,el:null,parentEl:null,top0:null,left0:null,mouseY0:null,mouseX0:null,topDelta:null,leftDelta:null,mousemoveProxy:null,isFollowing:!1,isHidden:!1,isAnimating:!1,constructor:function(sourceEl,options){this.options=options=options||{},this.sourceEl=sourceEl,this.parentEl=options.parentEl?$(options.parentEl):sourceEl.parent()},start:function(ev){this.isFollowing||(this.isFollowing=!0,this.mouseY0=ev.pageY,this.mouseX0=ev.pageX,this.topDelta=0,this.leftDelta=0,this.isHidden||this.updatePosition(),$(document).on("mousemove",this.mousemoveProxy=proxy(this,"mousemove")))},stop:function(shouldRevert,callback){function complete(){this.isAnimating=!1,_this.removeElement(),this.top0=this.left0=null,callback&&callback()}var _this=this,revertDuration=this.options.revertDuration;this.isFollowing&&!this.isAnimating&&(this.isFollowing=!1,$(document).off("mousemove",this.mousemoveProxy),shouldRevert&&revertDuration&&!this.isHidden?(this.isAnimating=!0,this.el.animate({top:this.top0,left:this.left0},{duration:revertDuration,complete:complete})):complete())},getEl:function(){var el=this.el;return el||(this.sourceEl.width(),el=this.el=this.sourceEl.clone().css({position:"absolute",visibility:"",display:this.isHidden?"none":"",margin:0,right:"auto",bottom:"auto",width:this.sourceEl.width(),height:this.sourceEl.height(),opacity:this.options.opacity||"",zIndex:this.options.zIndex}).appendTo(this.parentEl)),el},removeElement:function(){this.el&&(this.el.remove(),this.el=null)},updatePosition:function(){var sourceOffset,origin;this.getEl(),null===this.top0&&(this.sourceEl.width(),sourceOffset=this.sourceEl.offset(),origin=this.el.offsetParent().offset(),this.top0=sourceOffset.top-origin.top,this.left0=sourceOffset.left-origin.left),this.el.css({top:this.top0+this.topDelta,left:this.left0+this.leftDelta})},mousemove:function(ev){this.topDelta=ev.pageY-this.mouseY0,this.leftDelta=ev.pageX-this.mouseX0,this.isHidden||this.updatePosition()},hide:function(){this.isHidden||(this.isHidden=!0,this.el&&this.el.hide())},show:function(){this.isHidden&&(this.isHidden=!1,this.updatePosition(),this.getEl().show())}}),RowRenderer=Class.extend({view:null,isRTL:null,cellHtml:"<td/>",constructor:function(view){this.view=view,this.isRTL=view.opt("isRTL")},rowHtml:function(rowType,row){var col,cell,renderCell=this.getHtmlRenderer("cell",rowType),rowCellHtml="";for(row=row||0,col=0;col<this.colCnt;col++)cell=this.getCell(row,col),rowCellHtml+=renderCell(cell);return rowCellHtml=this.bookendCells(rowCellHtml,rowType,row),"<tr>"+rowCellHtml+"</tr>"},bookendCells:function(cells,rowType,row){var intro=this.getHtmlRenderer("intro",rowType)(row||0),outro=this.getHtmlRenderer("outro",rowType)(row||0),prependHtml=this.isRTL?outro:intro,appendHtml=this.isRTL?intro:outro;return"string"==typeof cells?prependHtml+cells+appendHtml:cells.prepend(prependHtml).append(appendHtml)},getHtmlRenderer:function(rendererName,rowType){var generalName,specificName,provider,renderer,view=this.view;return generalName=rendererName+"Html",rowType&&(specificName=rowType+capitaliseFirstLetter(rendererName)+"Html"),specificName&&(renderer=view[specificName])?provider=view:specificName&&(renderer=this[specificName])?provider=this:(renderer=view[generalName])?provider=view:(renderer=this[generalName])&&(provider=this),"function"==typeof renderer?function(){return renderer.apply(provider,arguments)||""}:function(){return renderer||""}}}),Grid=fc.Grid=RowRenderer.extend({start:null,end:null,rowCnt:0,colCnt:0,el:null,coordMap:null,elsByFill:null,externalDragStartProxy:null,colHeadFormat:null,eventTimeFormat:null,displayEventTime:null,displayEventEnd:null,cellDuration:null,largeUnit:null,constructor:function(){RowRenderer.apply(this,arguments),this.coordMap=new GridCoordMap(this),this.elsByFill={},this.externalDragStartProxy=proxy(this,"externalDragStart")},computeColHeadFormat:function(){},computeEventTimeFormat:function(){return this.view.opt("smallTimeFormat")},computeDisplayEventTime:function(){return!0},computeDisplayEventEnd:function(){return!0},setRange:function(range){this.start=range.start.clone(),this.end=range.end.clone(),this.rangeUpdated(),this.processRangeOptions()},rangeUpdated:function(){},processRangeOptions:function(){var displayEventTime,displayEventEnd,view=this.view;this.colHeadFormat=view.opt("columnFormat")||this.computeColHeadFormat(),this.eventTimeFormat=view.opt("eventTimeFormat")||view.opt("timeFormat")||this.computeEventTimeFormat(),displayEventTime=view.opt("displayEventTime"),null==displayEventTime&&(displayEventTime=this.computeDisplayEventTime()),displayEventEnd=view.opt("displayEventEnd"),null==displayEventEnd&&(displayEventEnd=this.computeDisplayEventEnd()),this.displayEventTime=displayEventTime,this.displayEventEnd=displayEventEnd},build:function(){},clear:function(){},rangeToSegs:function(range){},diffDates:function(a,b){return this.largeUnit?diffByUnit(a,b,this.largeUnit):diffDayTime(a,b)},getCell:function(row,col){var cell;return null==col&&("number"==typeof row?(col=row%this.colCnt,row=Math.floor(row/this.colCnt)):(col=row.col,row=row.row)),cell={row:row,col:col},$.extend(cell,this.getRowData(row),this.getColData(col)),$.extend(cell,this.computeCellRange(cell)),cell},computeCellRange:function(cell){var date=this.computeCellDate(cell);return{start:date,end:date.clone().add(this.cellDuration)}},computeCellDate:function(cell){},getRowData:function(row){return{}},getColData:function(col){return{}},getRowEl:function(row){},getColEl:function(col){},getCellDayEl:function(cell){return this.getColEl(cell.col)||this.getRowEl(cell.row)},computeRowCoords:function(){var i,el,top,items=[];for(i=0;i<this.rowCnt;i++)el=this.getRowEl(i),top=el.offset().top,items.push({top:top,bottom:top+el.outerHeight()});return items},computeColCoords:function(){var i,el,left,items=[];for(i=0;i<this.colCnt;i++)el=this.getColEl(i),left=el.offset().left,items.push({left:left,right:left+el.outerWidth()});return items},setElement:function(el){var _this=this;this.el=el,el.on("mousedown",function(ev){$(ev.target).is(".fc-event-container *, .fc-more")||$(ev.target).closest(".fc-popover").length||_this.dayMousedown(ev)}),this.bindSegHandlers(),this.bindGlobalHandlers()},removeElement:function(){this.unbindGlobalHandlers(),this.el.remove()},renderSkeleton:function(){},renderDates:function(){},unrenderDates:function(){},bindGlobalHandlers:function(){$(document).on("dragstart sortstart",this.externalDragStartProxy)},unbindGlobalHandlers:function(){$(document).off("dragstart sortstart",this.externalDragStartProxy)},dayMousedown:function(ev){var dayClickCell,selectionRange,_this=this,view=this.view,isSelectable=view.opt("selectable"),dragListener=new CellDragListener(this.coordMap,{scroll:view.opt("dragScroll"),dragStart:function(){view.unselect()},cellOver:function(cell,isOrig,origCell){origCell&&(dayClickCell=isOrig?cell:null,isSelectable&&(selectionRange=_this.computeSelection(origCell,cell),selectionRange?_this.renderSelection(selectionRange):disableCursor()))},cellOut:function(cell){dayClickCell=null,selectionRange=null,_this.unrenderSelection(),enableCursor()},listenStop:function(ev){dayClickCell&&view.triggerDayClick(dayClickCell,_this.getCellDayEl(dayClickCell),ev),selectionRange&&view.reportSelection(selectionRange,ev),enableCursor()}});dragListener.mousedown(ev)},renderRangeHelper:function(range,sourceSeg){var fakeEvent=this.fabricateHelperEvent(range,sourceSeg);this.renderHelper(fakeEvent,sourceSeg)},fabricateHelperEvent:function(range,sourceSeg){var fakeEvent=sourceSeg?createObject(sourceSeg.event):{};return fakeEvent.start=range.start.clone(),fakeEvent.end=range.end?range.end.clone():null,fakeEvent.allDay=null,this.view.calendar.normalizeEventRange(fakeEvent),fakeEvent.className=(fakeEvent.className||[]).concat("fc-helper"),sourceSeg||(fakeEvent.editable=!1),fakeEvent},renderHelper:function(event,sourceSeg){},unrenderHelper:function(){},renderSelection:function(range){this.renderHighlight(this.selectionRangeToSegs(range))},unrenderSelection:function(){this.unrenderHighlight()},computeSelection:function(firstCell,lastCell){var range,dates=[firstCell.start,firstCell.end,lastCell.start,lastCell.end];return dates.sort(compareNumbers),range={start:dates[0].clone(),end:dates[3].clone()},this.view.calendar.isSelectionRangeAllowed(range)?range:null},selectionRangeToSegs:function(range){return this.rangeToSegs(range)},renderHighlight:function(segs){this.renderFill("highlight",segs)},unrenderHighlight:function(){this.unrenderFill("highlight")},highlightSegClasses:function(){return["fc-highlight"]},renderFill:function(type,segs){},unrenderFill:function(type){var el=this.elsByFill[type];el&&(el.remove(),delete this.elsByFill[type])},renderFillSegEls:function(type,segs){var i,_this=this,segElMethod=this[type+"SegEl"],html="",renderedSegs=[];if(segs.length){for(i=0;i<segs.length;i++)html+=this.fillSegHtml(type,segs[i]);$(html).each(function(i,node){var seg=segs[i],el=$(node);segElMethod&&(el=segElMethod.call(_this,seg,el)),el&&(el=$(el),el.is(_this.fillSegTag)&&(seg.el=el,renderedSegs.push(seg)))})}return renderedSegs},fillSegTag:"div",fillSegHtml:function(type,seg){var classesMethod=this[type+"SegClasses"],cssMethod=this[type+"SegCss"],classes=classesMethod?classesMethod.call(this,seg):[],css=cssToStr(cssMethod?cssMethod.call(this,seg):{});return"<"+this.fillSegTag+(classes.length?' class="'+classes.join(" ")+'"':"")+(css?' style="'+css+'"':"")+" />"},headHtml:function(){return'<div class="fc-row '+this.view.widgetHeaderClass+'"><table><thead>'+this.rowHtml("head")+"</thead></table></div>"},headCellHtml:function(cell){var view=this.view,date=cell.start;return'<th class="fc-day-header '+view.widgetHeaderClass+" fc-"+dayIDs[date.day()]+'">'+htmlEscape(date.format(this.colHeadFormat))+"</th>"},bgCellHtml:function(cell){var view=this.view,date=cell.start,classes=this.getDayClasses(date);return classes.unshift("fc-day",view.widgetContentClass),'<td class="'+classes.join(" ")+'" data-date="'+date.format("YYYY-MM-DD")+'"></td>'},getDayClasses:function(date){var view=this.view,today=view.calendar.getNow().stripTime(),classes=["fc-"+dayIDs[date.day()]];return 1==view.intervalDuration.as("months")&&date.month()!=view.intervalStart.month()&&classes.push("fc-other-month"),date.isSame(today,"day")?classes.push("fc-today",view.highlightStateClass):date<today?classes.push("fc-past"):classes.push("fc-future"),classes}});Grid.mixin({mousedOverSeg:null,isDraggingSeg:!1,isResizingSeg:!1,isDraggingExternal:!1,segs:null,renderEvents:function(events){var i,seg,segs=this.eventsToSegs(events),bgSegs=[],fgSegs=[];for(i=0;i<segs.length;i++)seg=segs[i],isBgEvent(seg.event)?bgSegs.push(seg):fgSegs.push(seg);bgSegs=this.renderBgSegs(bgSegs)||bgSegs,fgSegs=this.renderFgSegs(fgSegs)||fgSegs,this.segs=bgSegs.concat(fgSegs)},unrenderEvents:function(){this.triggerSegMouseout(),this.unrenderFgSegs(),this.unrenderBgSegs(),this.segs=null},getEventSegs:function(){return this.segs||[]},renderFgSegs:function(segs){},unrenderFgSegs:function(){},renderFgSegEls:function(segs,disableResizing){var i,view=this.view,html="",renderedSegs=[];if(segs.length){for(i=0;i<segs.length;i++)html+=this.fgSegHtml(segs[i],disableResizing);$(html).each(function(i,node){var seg=segs[i],el=view.resolveEventEl(seg.event,$(node));el&&(el.data("fc-seg",seg),seg.el=el,renderedSegs.push(seg))})}return renderedSegs},fgSegHtml:function(seg,disableResizing){},renderBgSegs:function(segs){return this.renderFill("bgEvent",segs)},unrenderBgSegs:function(){this.unrenderFill("bgEvent")},bgEventSegEl:function(seg,el){return this.view.resolveEventEl(seg.event,el)},bgEventSegClasses:function(seg){var event=seg.event,source=event.source||{};return["fc-bgevent"].concat(event.className,source.className||[])},bgEventSegCss:function(seg){var view=this.view,event=seg.event,source=event.source||{};return{"background-color":event.backgroundColor||event.color||source.backgroundColor||source.color||view.opt("eventBackgroundColor")||view.opt("eventColor")}},businessHoursSegClasses:function(seg){return["fc-nonbusiness","fc-bgevent"]},bindSegHandlers:function(){var _this=this,view=this.view;$.each({mouseenter:function(seg,ev){_this.triggerSegMouseover(seg,ev)},mouseleave:function(seg,ev){_this.triggerSegMouseout(seg,ev)},click:function(seg,ev){return view.trigger("eventClick",this,seg.event,ev)},mousedown:function(seg,ev){$(ev.target).is(".fc-resizer")&&view.isEventResizable(seg.event)?_this.segResizeMousedown(seg,ev,$(ev.target).is(".fc-start-resizer")):view.isEventDraggable(seg.event)&&_this.segDragMousedown(seg,ev)}},function(name,func){_this.el.on(name,".fc-event-container > *",function(ev){var seg=$(this).data("fc-seg");if(seg&&!_this.isDraggingSeg&&!_this.isResizingSeg)return func.call(this,seg,ev)})})},triggerSegMouseover:function(seg,ev){this.mousedOverSeg||(this.mousedOverSeg=seg,this.view.trigger("eventMouseover",seg.el[0],seg.event,ev))},triggerSegMouseout:function(seg,ev){ev=ev||{},this.mousedOverSeg&&(seg=seg||this.mousedOverSeg,this.mousedOverSeg=null,
this.view.trigger("eventMouseout",seg.el[0],seg.event,ev))},segDragMousedown:function(seg,ev){var dropLocation,_this=this,view=this.view,calendar=view.calendar,el=seg.el,event=seg.event,mouseFollower=new MouseFollower(seg.el,{parentEl:view.el,opacity:view.opt("dragOpacity"),revertDuration:view.opt("dragRevertDuration"),zIndex:2}),dragListener=new CellDragListener(view.coordMap,{distance:5,scroll:view.opt("dragScroll"),subjectEl:el,subjectCenter:!0,listenStart:function(ev){mouseFollower.hide(),mouseFollower.start(ev)},dragStart:function(ev){_this.triggerSegMouseout(seg,ev),_this.segDragStart(seg,ev),view.hideEvent(event)},cellOver:function(cell,isOrig,origCell){seg.cell&&(origCell=seg.cell),dropLocation=_this.computeEventDrop(origCell,cell,event),dropLocation&&!calendar.isEventRangeAllowed(dropLocation,event)&&(disableCursor(),dropLocation=null),dropLocation&&view.renderDrag(dropLocation,seg)?mouseFollower.hide():mouseFollower.show(),isOrig&&(dropLocation=null)},cellOut:function(){view.unrenderDrag(),mouseFollower.show(),dropLocation=null},cellDone:function(){enableCursor()},dragStop:function(ev){mouseFollower.stop(!dropLocation,function(){view.unrenderDrag(),view.showEvent(event),_this.segDragStop(seg,ev),dropLocation&&view.reportEventDrop(event,dropLocation,this.largeUnit,el,ev)})},listenStop:function(){mouseFollower.stop()}});dragListener.mousedown(ev)},segDragStart:function(seg,ev){this.isDraggingSeg=!0,this.view.trigger("eventDragStart",seg.el[0],seg.event,ev,{})},segDragStop:function(seg,ev){this.isDraggingSeg=!1,this.view.trigger("eventDragStop",seg.el[0],seg.event,ev,{})},computeEventDrop:function(startCell,endCell,event){var delta,dropLocation,calendar=this.view.calendar,dragStart=startCell.start,dragEnd=endCell.start;return dragStart.hasTime()===dragEnd.hasTime()?(delta=this.diffDates(dragEnd,dragStart),event.allDay&&durationHasTime(delta)?(dropLocation={start:event.start.clone(),end:calendar.getEventEnd(event),allDay:!1},calendar.normalizeEventRangeTimes(dropLocation)):dropLocation={start:event.start.clone(),end:event.end?event.end.clone():null,allDay:event.allDay},dropLocation.start.add(delta),dropLocation.end&&dropLocation.end.add(delta)):dropLocation={start:dragEnd.clone(),end:null,allDay:!dragEnd.hasTime()},dropLocation},applyDragOpacity:function(els){var opacity=this.view.opt("dragOpacity");null!=opacity&&els.each(function(i,node){node.style.opacity=opacity})},externalDragStart:function(ev,ui){var el,accept,view=this.view;view.opt("droppable")&&(el=$((ui?ui.item:null)||ev.target),accept=view.opt("dropAccept"),($.isFunction(accept)?accept.call(el[0],el):el.is(accept))&&(this.isDraggingExternal||this.listenToExternalDrag(el,ev,ui)))},listenToExternalDrag:function(el,ev,ui){var dragListener,dropLocation,_this=this,meta=getDraggedElMeta(el);dragListener=new CellDragListener(this.coordMap,{listenStart:function(){_this.isDraggingExternal=!0},cellOver:function(cell){dropLocation=_this.computeExternalDrop(cell,meta),dropLocation?_this.renderDrag(dropLocation):disableCursor()},cellOut:function(){dropLocation=null,_this.unrenderDrag(),enableCursor()},dragStop:function(){_this.unrenderDrag(),enableCursor(),dropLocation&&_this.view.reportExternalDrop(meta,dropLocation,el,ev,ui)},listenStop:function(){_this.isDraggingExternal=!1}}),dragListener.startDrag(ev)},computeExternalDrop:function(cell,meta){var dropLocation={start:cell.start.clone(),end:null};return meta.startTime&&!dropLocation.start.hasTime()&&dropLocation.start.time(meta.startTime),meta.duration&&(dropLocation.end=dropLocation.start.clone().add(meta.duration)),this.view.calendar.isExternalDropRangeAllowed(dropLocation,meta.eventProps)?dropLocation:null},renderDrag:function(dropLocation,seg){},unrenderDrag:function(){},segResizeMousedown:function(seg,ev,isStart){var dragListener,resizeLocation,_this=this,view=this.view,calendar=view.calendar,el=seg.el,event=seg.event,eventEnd=calendar.getEventEnd(event);dragListener=new CellDragListener(this.coordMap,{distance:5,scroll:view.opt("dragScroll"),subjectEl:el,dragStart:function(ev){_this.triggerSegMouseout(seg,ev),_this.segResizeStart(seg,ev)},cellOver:function(cell,isOrig,origCell){resizeLocation=isStart?_this.computeEventStartResize(origCell,cell,event):_this.computeEventEndResize(origCell,cell,event),resizeLocation&&(calendar.isEventRangeAllowed(resizeLocation,event)?resizeLocation.start.isSame(event.start)&&resizeLocation.end.isSame(eventEnd)&&(resizeLocation=null):(disableCursor(),resizeLocation=null)),resizeLocation&&(view.hideEvent(event),_this.renderEventResize(resizeLocation,seg))},cellOut:function(){resizeLocation=null},cellDone:function(){_this.unrenderEventResize(),view.showEvent(event),enableCursor()},dragStop:function(ev){_this.segResizeStop(seg,ev),resizeLocation&&view.reportEventResize(event,resizeLocation,this.largeUnit,el,ev)}}),dragListener.mousedown(ev)},segResizeStart:function(seg,ev){this.isResizingSeg=!0,this.view.trigger("eventResizeStart",seg.el[0],seg.event,ev,{})},segResizeStop:function(seg,ev){this.isResizingSeg=!1,this.view.trigger("eventResizeStop",seg.el[0],seg.event,ev,{})},computeEventStartResize:function(startCell,endCell,event){return this.computeEventResize("start",startCell,endCell,event)},computeEventEndResize:function(startCell,endCell,event){return this.computeEventResize("end",startCell,endCell,event)},computeEventResize:function(type,startCell,endCell,event){var range,defaultDuration,calendar=this.view.calendar,delta=this.diffDates(endCell[type],startCell[type]);return range={start:event.start.clone(),end:calendar.getEventEnd(event),allDay:event.allDay},range.allDay&&durationHasTime(delta)&&(range.allDay=!1,calendar.normalizeEventRangeTimes(range)),range[type].add(delta),range.start.isBefore(range.end)||(defaultDuration=event.allDay?calendar.defaultAllDayEventDuration:calendar.defaultTimedEventDuration,this.cellDuration&&this.cellDuration<defaultDuration&&(defaultDuration=this.cellDuration),"start"==type?range.start=range.end.clone().subtract(defaultDuration):range.end=range.start.clone().add(defaultDuration)),range},renderEventResize:function(range,seg){},unrenderEventResize:function(){},getEventTimeText:function(range,formatStr,displayEnd){return null==formatStr&&(formatStr=this.eventTimeFormat),null==displayEnd&&(displayEnd=this.displayEventEnd),this.displayEventTime&&range.start.hasTime()?displayEnd&&range.end?this.view.formatRange(range,formatStr):range.start.format(formatStr):""},getSegClasses:function(seg,isDraggable,isResizable){var event=seg.event,classes=["fc-event",seg.isStart?"fc-start":"fc-not-start",seg.isEnd?"fc-end":"fc-not-end"].concat(event.className,event.source?event.source.className:[]);return isDraggable&&classes.push("fc-draggable"),isResizable&&classes.push("fc-resizable"),classes},getEventSkinCss:function(event){var view=this.view,source=event.source||{},eventColor=event.color,sourceColor=source.color,optionColor=view.opt("eventColor");return{"background-color":event.backgroundColor||eventColor||source.backgroundColor||sourceColor||view.opt("eventBackgroundColor")||optionColor,"border-color":event.borderColor||eventColor||source.borderColor||sourceColor||view.opt("eventBorderColor")||optionColor,color:event.textColor||source.textColor||view.opt("eventTextColor")}},eventsToSegs:function(events,rangeToSegsFunc){var i,eventRanges=this.eventsToRanges(events),segs=[];for(i=0;i<eventRanges.length;i++)segs.push.apply(segs,this.eventRangeToSegs(eventRanges[i],rangeToSegsFunc));return segs},eventsToRanges:function(events){var _this=this,eventsById=groupEventsById(events),ranges=[];return $.each(eventsById,function(id,eventGroup){eventGroup.length&&ranges.push.apply(ranges,isInverseBgEvent(eventGroup[0])?_this.eventsToInverseRanges(eventGroup):_this.eventsToNormalRanges(eventGroup))}),ranges},eventsToNormalRanges:function(events){var i,event,eventStart,eventEnd,calendar=this.view.calendar,ranges=[];for(i=0;i<events.length;i++)event=events[i],eventStart=event.start.clone().stripZone(),eventEnd=calendar.getEventEnd(event).stripZone(),ranges.push({event:event,start:eventStart,end:eventEnd,eventStartMS:+eventStart,eventDurationMS:eventEnd-eventStart});return ranges},eventsToInverseRanges:function(events){var i,normalRange,view=this.view,viewStart=view.start.clone().stripZone(),viewEnd=view.end.clone().stripZone(),normalRanges=this.eventsToNormalRanges(events),inverseRanges=[],event0=events[0],start=viewStart;for(normalRanges.sort(compareNormalRanges),i=0;i<normalRanges.length;i++)normalRange=normalRanges[i],normalRange.start>start&&inverseRanges.push({event:event0,start:start,end:normalRange.start}),start=normalRange.end;return start<viewEnd&&inverseRanges.push({event:event0,start:start,end:viewEnd}),inverseRanges},eventRangeToSegs:function(eventRange,rangeToSegsFunc){var segs,i,seg;for(eventRange=this.view.calendar.ensureVisibleEventRange(eventRange),segs=rangeToSegsFunc?rangeToSegsFunc(eventRange):this.rangeToSegs(eventRange),i=0;i<segs.length;i++)seg=segs[i],seg.event=eventRange.event,seg.eventStartMS=eventRange.eventStartMS,seg.eventDurationMS=eventRange.eventDurationMS;return segs},sortSegs:function(segs){segs.sort(proxy(this,"compareSegs"))},compareSegs:function(seg1,seg2){return seg1.eventStartMS-seg2.eventStartMS||seg2.eventDurationMS-seg1.eventDurationMS||seg2.event.allDay-seg1.event.allDay||compareByFieldSpecs(seg1.event,seg2.event,this.view.eventOrderSpecs)}}),fc.dataAttrPrefix="";var DayGrid=Grid.extend({numbersVisible:!1,bottomCoordPadding:0,breakOnWeeks:null,cellDates:null,dayToCellOffsets:null,rowEls:null,dayEls:null,helperEls:null,constructor:function(){Grid.apply(this,arguments),this.cellDuration=moment.duration(1,"day")},renderDates:function(isRigid){var row,i,cell,view=this.view,rowCnt=this.rowCnt,colCnt=this.colCnt,cellCnt=rowCnt*colCnt,html="";for(row=0;row<rowCnt;row++)html+=this.dayRowHtml(row,isRigid);for(this.el.html(html),this.rowEls=this.el.find(".fc-row"),this.dayEls=this.el.find(".fc-day"),i=0;i<cellCnt;i++)cell=this.getCell(i),view.trigger("dayRender",null,cell.start,this.dayEls.eq(i))},unrenderDates:function(){this.removeSegPopover()},renderBusinessHours:function(){var events=this.view.calendar.getBusinessHoursEvents(!0),segs=this.eventsToSegs(events);this.renderFill("businessHours",segs,"bgevent")},dayRowHtml:function(row,isRigid){var view=this.view,classes=["fc-row","fc-week",view.widgetContentClass];return isRigid&&classes.push("fc-rigid"),'<div class="'+classes.join(" ")+'"><div class="fc-bg"><table>'+this.rowHtml("day",row)+'</table></div><div class="fc-content-skeleton"><table>'+(this.numbersVisible?"<thead>"+this.rowHtml("number",row)+"</thead>":"")+"</table></div></div>"},dayCellHtml:function(cell){return this.bgCellHtml(cell)},computeColHeadFormat:function(){return this.rowCnt>1?"ddd":this.colCnt>1?this.view.opt("dayOfMonthFormat"):"dddd"},computeEventTimeFormat:function(){return this.view.opt("extraSmallTimeFormat")},computeDisplayEventEnd:function(){return 1==this.colCnt},rangeUpdated:function(){var cellDates,firstDay,rowCnt,colCnt;if(this.updateCellDates(),cellDates=this.cellDates,this.breakOnWeeks){for(firstDay=cellDates[0].day(),colCnt=1;colCnt<cellDates.length&&cellDates[colCnt].day()!=firstDay;colCnt++);rowCnt=Math.ceil(cellDates.length/colCnt)}else rowCnt=1,colCnt=cellDates.length;this.rowCnt=rowCnt,this.colCnt=colCnt},updateCellDates:function(){for(var view=this.view,date=this.start.clone(),dates=[],offset=-1,offsets=[];date.isBefore(this.end);)view.isHiddenDay(date)?offsets.push(offset+.5):(offset++,offsets.push(offset),dates.push(date.clone())),date.add(1,"days");this.cellDates=dates,this.dayToCellOffsets=offsets},computeCellDate:function(cell){var colCnt=this.colCnt,index=cell.row*colCnt+(this.isRTL?colCnt-cell.col-1:cell.col);return this.cellDates[index].clone()},getRowEl:function(row){return this.rowEls.eq(row)},getColEl:function(col){return this.dayEls.eq(col)},getCellDayEl:function(cell){return this.dayEls.eq(cell.row*this.colCnt+cell.col)},computeRowCoords:function(){var rowCoords=Grid.prototype.computeRowCoords.call(this);return rowCoords[rowCoords.length-1].bottom+=this.bottomCoordPadding,rowCoords},rangeToSegs:function(range){var first,last,row,rowFirst,rowLast,isStart,isEnd,segFirst,segLast,seg,isRTL=this.isRTL,rowCnt=this.rowCnt,colCnt=this.colCnt,segs=[];for(range=this.view.computeDayRange(range),first=this.dateToCellOffset(range.start),last=this.dateToCellOffset(range.end.subtract(1,"days")),row=0;row<rowCnt;row++)rowFirst=row*colCnt,rowLast=rowFirst+colCnt-1,segFirst=Math.max(rowFirst,first),segLast=Math.min(rowLast,last),segFirst=Math.ceil(segFirst),segLast=Math.floor(segLast),segFirst<=segLast&&(isStart=segFirst===first,isEnd=segLast===last,segFirst-=rowFirst,segLast-=rowFirst,seg={row:row,isStart:isStart,isEnd:isEnd},isRTL?(seg.leftCol=colCnt-segLast-1,seg.rightCol=colCnt-segFirst-1):(seg.leftCol=segFirst,seg.rightCol=segLast),segs.push(seg));return segs},dateToCellOffset:function(date){var offsets=this.dayToCellOffsets,day=date.diff(this.start,"days");return day<0?offsets[0]-1:day>=offsets.length?offsets[offsets.length-1]+1:offsets[day]},renderDrag:function(dropLocation,seg){if(this.renderHighlight(this.eventRangeToSegs(dropLocation)),seg&&!seg.el.closest(this.el).length)return this.renderRangeHelper(dropLocation,seg),this.applyDragOpacity(this.helperEls),!0},unrenderDrag:function(){this.unrenderHighlight(),this.unrenderHelper()},renderEventResize:function(range,seg){this.renderHighlight(this.eventRangeToSegs(range)),this.renderRangeHelper(range,seg)},unrenderEventResize:function(){this.unrenderHighlight(),this.unrenderHelper()},renderHelper:function(event,sourceSeg){var rowStructs,helperNodes=[],segs=this.eventsToSegs([event]);segs=this.renderFgSegEls(segs),rowStructs=this.renderSegRows(segs),this.rowEls.each(function(row,rowNode){var skeletonTop,rowEl=$(rowNode),skeletonEl=$('<div class="fc-helper-skeleton"><table/></div>');skeletonTop=sourceSeg&&sourceSeg.row===row?sourceSeg.el.position().top:rowEl.find(".fc-content-skeleton tbody").position().top,skeletonEl.css("top",skeletonTop).find("table").append(rowStructs[row].tbodyEl),rowEl.append(skeletonEl),helperNodes.push(skeletonEl[0])}),this.helperEls=$(helperNodes)},unrenderHelper:function(){this.helperEls&&(this.helperEls.remove(),this.helperEls=null)},fillSegTag:"td",renderFill:function(type,segs,className){var i,seg,skeletonEl,nodes=[];for(segs=this.renderFillSegEls(type,segs),i=0;i<segs.length;i++)seg=segs[i],skeletonEl=this.renderFillRow(type,seg,className),this.rowEls.eq(seg.row).append(skeletonEl),nodes.push(skeletonEl[0]);return this.elsByFill[type]=$(nodes),segs},renderFillRow:function(type,seg,className){var skeletonEl,trEl,colCnt=this.colCnt,startCol=seg.leftCol,endCol=seg.rightCol+1;return className=className||type.toLowerCase(),skeletonEl=$('<div class="fc-'+className+'-skeleton"><table><tr/></table></div>'),trEl=skeletonEl.find("tr"),startCol>0&&trEl.append('<td colspan="'+startCol+'"/>'),trEl.append(seg.el.attr("colspan",endCol-startCol)),endCol<colCnt&&trEl.append('<td colspan="'+(colCnt-endCol)+'"/>'),this.bookendCells(trEl,type),skeletonEl}});DayGrid.mixin({rowStructs:null,unrenderEvents:function(){this.removeSegPopover(),Grid.prototype.unrenderEvents.apply(this,arguments)},getEventSegs:function(){return Grid.prototype.getEventSegs.call(this).concat(this.popoverSegs||[])},renderBgSegs:function(segs){var allDaySegs=$.grep(segs,function(seg){return seg.event.allDay});return Grid.prototype.renderBgSegs.call(this,allDaySegs)},renderFgSegs:function(segs){var rowStructs;return segs=this.renderFgSegEls(segs),rowStructs=this.rowStructs=this.renderSegRows(segs),this.rowEls.each(function(i,rowNode){$(rowNode).find(".fc-content-skeleton > table").append(rowStructs[i].tbodyEl)}),segs},unrenderFgSegs:function(){for(var rowStruct,rowStructs=this.rowStructs||[];rowStruct=rowStructs.pop();)rowStruct.tbodyEl.remove();this.rowStructs=null},renderSegRows:function(segs){var segRows,row,rowStructs=[];for(segRows=this.groupSegRows(segs),row=0;row<segRows.length;row++)rowStructs.push(this.renderSegRow(row,segRows[row]));return rowStructs},fgSegHtml:function(seg,disableResizing){var timeText,titleHtml,view=this.view,event=seg.event,isDraggable=view.isEventDraggable(event),isResizableFromStart=!disableResizing&&event.allDay&&seg.isStart&&view.isEventResizableFromStart(event),isResizableFromEnd=!disableResizing&&event.allDay&&seg.isEnd&&view.isEventResizableFromEnd(event),classes=this.getSegClasses(seg,isDraggable,isResizableFromStart||isResizableFromEnd),skinCss=cssToStr(this.getEventSkinCss(event)),timeHtml="";return classes.unshift("fc-day-grid-event","fc-h-event"),seg.isStart&&(timeText=this.getEventTimeText(event),timeText&&(timeHtml='<span class="fc-time">'+htmlEscape(timeText)+"</span>")),titleHtml='<span class="fc-title">'+(htmlEscape(event.title||"")||"&nbsp;")+"</span>",'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+'><div class="fc-content">'+(this.isRTL?titleHtml+" "+timeHtml:timeHtml+" "+titleHtml)+"</div>"+(isResizableFromStart?'<div class="fc-resizer fc-start-resizer" />':"")+(isResizableFromEnd?'<div class="fc-resizer fc-end-resizer" />':"")+"</a>"},renderSegRow:function(row,rowSegs){function emptyCellsUntil(endCol){for(;col<endCol;)td=(loneCellMatrix[i-1]||[])[col],td?td.attr("rowspan",parseInt(td.attr("rowspan")||1,10)+1):(td=$("<td/>"),tr.append(td)),cellMatrix[i][col]=td,loneCellMatrix[i][col]=td,col++}var i,levelSegs,col,tr,j,seg,td,colCnt=this.colCnt,segLevels=this.buildSegLevels(rowSegs),levelCnt=Math.max(1,segLevels.length),tbody=$("<tbody/>"),segMatrix=[],cellMatrix=[],loneCellMatrix=[];for(i=0;i<levelCnt;i++){if(levelSegs=segLevels[i],col=0,tr=$("<tr/>"),segMatrix.push([]),cellMatrix.push([]),loneCellMatrix.push([]),levelSegs)for(j=0;j<levelSegs.length;j++){for(seg=levelSegs[j],emptyCellsUntil(seg.leftCol),td=$('<td class="fc-event-container"/>').append(seg.el),seg.leftCol!=seg.rightCol?td.attr("colspan",seg.rightCol-seg.leftCol+1):loneCellMatrix[i][col]=td;col<=seg.rightCol;)cellMatrix[i][col]=td,segMatrix[i][col]=seg,col++;tr.append(td)}emptyCellsUntil(colCnt),this.bookendCells(tr,"eventSkeleton"),tbody.append(tr)}return{row:row,tbodyEl:tbody,cellMatrix:cellMatrix,segMatrix:segMatrix,segLevels:segLevels,segs:rowSegs}},buildSegLevels:function(segs){var i,seg,j,levels=[];for(this.sortSegs(segs),i=0;i<segs.length;i++){for(seg=segs[i],j=0;j<levels.length&&isDaySegCollision(seg,levels[j]);j++);seg.level=j,(levels[j]||(levels[j]=[])).push(seg)}for(j=0;j<levels.length;j++)levels[j].sort(compareDaySegCols);return levels},groupSegRows:function(segs){var i,segRows=[];for(i=0;i<this.rowCnt;i++)segRows.push([]);for(i=0;i<segs.length;i++)segRows[segs[i].row].push(segs[i]);return segRows}}),DayGrid.mixin({segPopover:null,popoverSegs:null,removeSegPopover:function(){this.segPopover&&this.segPopover.hide()},limitRows:function(levelLimit){var row,rowLevelLimit,rowStructs=this.rowStructs||[];for(row=0;row<rowStructs.length;row++)this.unlimitRow(row),rowLevelLimit=!!levelLimit&&("number"==typeof levelLimit?levelLimit:this.computeRowLevelLimit(row)),rowLevelLimit!==!1&&this.limitRow(row,rowLevelLimit)},computeRowLevelLimit:function(row){function iterInnerHeights(i,childNode){trHeight=Math.max(trHeight,$(childNode).outerHeight())}var i,trEl,trHeight,rowEl=this.rowEls.eq(row),rowHeight=rowEl.height(),trEls=this.rowStructs[row].tbodyEl.children();for(i=0;i<trEls.length;i++)if(trEl=trEls.eq(i).removeClass("fc-limited"),trHeight=0,trEl.find("> td > :first-child").each(iterInnerHeights),trEl.position().top+trHeight>rowHeight)return i;return!1},limitRow:function(row,levelLimit){function emptyCellsUntil(endCol){for(;col<endCol;)cell=_this.getCell(row,col),segsBelow=_this.getCellSegs(cell,levelLimit),segsBelow.length&&(td=cellMatrix[levelLimit-1][col],moreLink=_this.renderMoreLink(cell,segsBelow),moreWrap=$("<div/>").append(moreLink),td.append(moreWrap),moreNodes.push(moreWrap[0])),col++}var cell,levelSegs,cellMatrix,limitedNodes,i,seg,segsBelow,totalSegsBelow,colSegsBelow,td,rowspan,segMoreNodes,j,moreTd,moreWrap,moreLink,_this=this,rowStruct=this.rowStructs[row],moreNodes=[],col=0;if(levelLimit&&levelLimit<rowStruct.segLevels.length){for(levelSegs=rowStruct.segLevels[levelLimit-1],cellMatrix=rowStruct.cellMatrix,limitedNodes=rowStruct.tbodyEl.children().slice(levelLimit).addClass("fc-limited").get(),i=0;i<levelSegs.length;i++){for(seg=levelSegs[i],emptyCellsUntil(seg.leftCol),colSegsBelow=[],totalSegsBelow=0;col<=seg.rightCol;)cell=this.getCell(row,col),segsBelow=this.getCellSegs(cell,levelLimit),colSegsBelow.push(segsBelow),totalSegsBelow+=segsBelow.length,col++;if(totalSegsBelow){for(td=cellMatrix[levelLimit-1][seg.leftCol],rowspan=td.attr("rowspan")||1,segMoreNodes=[],j=0;j<colSegsBelow.length;j++)moreTd=$('<td class="fc-more-cell"/>').attr("rowspan",rowspan),segsBelow=colSegsBelow[j],cell=this.getCell(row,seg.leftCol+j),moreLink=this.renderMoreLink(cell,[seg].concat(segsBelow)),moreWrap=$("<div/>").append(moreLink),moreTd.append(moreWrap),segMoreNodes.push(moreTd[0]),moreNodes.push(moreTd[0]);td.addClass("fc-limited").after($(segMoreNodes)),limitedNodes.push(td[0])}}emptyCellsUntil(this.colCnt),rowStruct.moreEls=$(moreNodes),rowStruct.limitedEls=$(limitedNodes)}},unlimitRow:function(row){var rowStruct=this.rowStructs[row];rowStruct.moreEls&&(rowStruct.moreEls.remove(),rowStruct.moreEls=null),rowStruct.limitedEls&&(rowStruct.limitedEls.removeClass("fc-limited"),rowStruct.limitedEls=null)},renderMoreLink:function(cell,hiddenSegs){var _this=this,view=this.view;return $('<a class="fc-more"/>').text(this.getMoreLinkText(hiddenSegs.length)).on("click",function(ev){var clickOption=view.opt("eventLimitClick"),date=cell.start,moreEl=$(this),dayEl=_this.getCellDayEl(cell),allSegs=_this.getCellSegs(cell),reslicedAllSegs=_this.resliceDaySegs(allSegs,date),reslicedHiddenSegs=_this.resliceDaySegs(hiddenSegs,date);"function"==typeof clickOption&&(clickOption=view.trigger("eventLimitClick",null,{date:date,dayEl:dayEl,moreEl:moreEl,segs:reslicedAllSegs,hiddenSegs:reslicedHiddenSegs},ev)),"popover"===clickOption?_this.showSegPopover(cell,moreEl,reslicedAllSegs):"string"==typeof clickOption&&view.calendar.zoomTo(date,clickOption)})},showSegPopover:function(cell,moreLink,segs){var topEl,options,_this=this,view=this.view,moreWrap=moreLink.parent();topEl=1==this.rowCnt?view.el:this.rowEls.eq(cell.row),options={className:"fc-more-popover",content:this.renderSegPopoverContent(cell,segs),parentEl:this.el,top:topEl.offset().top,autoHide:!0,viewportConstrain:view.opt("popoverViewportConstrain"),hide:function(){_this.segPopover.removeElement(),_this.segPopover=null,_this.popoverSegs=null}},this.isRTL?options.right=moreWrap.offset().left+moreWrap.outerWidth()+1:options.left=moreWrap.offset().left-1,this.segPopover=new Popover(options),this.segPopover.show()},renderSegPopoverContent:function(cell,segs){var i,view=this.view,isTheme=view.opt("theme"),title=cell.start.format(view.opt("dayPopoverFormat")),content=$('<div class="fc-header '+view.widgetHeaderClass+'"><span class="fc-close '+(isTheme?"ui-icon ui-icon-closethick":"fc-icon fc-icon-x")+'"></span><span class="fc-title">'+htmlEscape(title)+'</span><div class="fc-clear"/></div><div class="fc-body '+view.widgetContentClass+'"><div class="fc-event-container"></div></div>'),segContainer=content.find(".fc-event-container");for(segs=this.renderFgSegEls(segs,!0),this.popoverSegs=segs,i=0;i<segs.length;i++)segs[i].cell=cell,segContainer.append(segs[i].el);return content},resliceDaySegs:function(segs,dayDate){var events=$.map(segs,function(seg){return seg.event}),dayStart=dayDate.clone().stripTime(),dayEnd=dayStart.clone().add(1,"days"),dayRange={start:dayStart,end:dayEnd};return segs=this.eventsToSegs(events,function(range){var seg=intersectionToSeg(range,dayRange);return seg?[seg]:[]}),this.sortSegs(segs),segs},getMoreLinkText:function(num){var opt=this.view.opt("eventLimitText");return"function"==typeof opt?opt(num):"+"+num+" "+opt},getCellSegs:function(cell,startLevel){for(var seg,segMatrix=this.rowStructs[cell.row].segMatrix,level=startLevel||0,segs=[];level<segMatrix.length;)seg=segMatrix[level][cell.col],seg&&segs.push(seg),level++;return segs}});var TimeGrid=Grid.extend({slotDuration:null,snapDuration:null,minTime:null,maxTime:null,colDates:null,labelFormat:null,labelInterval:null,dayEls:null,slatEls:null,slatTops:null,helperEl:null,businessHourSegs:null,constructor:function(){Grid.apply(this,arguments),this.processOptions()},renderDates:function(){this.el.html(this.renderHtml()),this.dayEls=this.el.find(".fc-day"),this.slatEls=this.el.find(".fc-slats tr")},renderBusinessHours:function(){var events=this.view.calendar.getBusinessHoursEvents();this.businessHourSegs=this.renderFill("businessHours",this.eventsToSegs(events),"bgevent")},renderHtml:function(){return'<div class="fc-bg"><table>'+this.rowHtml("slotBg")+'</table></div><div class="fc-slats"><table>'+this.slatRowHtml()+"</table></div>"},slotBgCellHtml:function(cell){return this.bgCellHtml(cell)},slatRowHtml:function(){for(var slotDate,isLabeled,axisHtml,view=this.view,isRTL=this.isRTL,html="",slotTime=moment.duration(+this.minTime);slotTime<this.maxTime;)slotDate=this.start.clone().time(slotTime),isLabeled=isInt(divideDurationByDuration(slotTime,this.labelInterval)),axisHtml='<td class="fc-axis fc-time '+view.widgetContentClass+'" '+view.axisStyleAttr()+">"+(isLabeled?"<span>"+htmlEscape(slotDate.format(this.labelFormat))+"</span>":"")+"</td>",html+="<tr "+(isLabeled?"":'class="fc-minor"')+">"+(isRTL?"":axisHtml)+'<td class="'+view.widgetContentClass+'"/>'+(isRTL?axisHtml:"")+"</tr>",slotTime.add(this.slotDuration);return html},processOptions:function(){var input,view=this.view,slotDuration=view.opt("slotDuration"),snapDuration=view.opt("snapDuration");slotDuration=moment.duration(slotDuration),snapDuration=snapDuration?moment.duration(snapDuration):slotDuration,this.slotDuration=slotDuration,this.snapDuration=snapDuration,this.cellDuration=snapDuration,this.minTime=moment.duration(view.opt("minTime")),this.maxTime=moment.duration(view.opt("maxTime")),input=view.opt("slotLabelFormat"),$.isArray(input)&&(input=input[input.length-1]),this.labelFormat=input||view.opt("axisFormat")||view.opt("smallTimeFormat"),input=view.opt("slotLabelInterval"),this.labelInterval=input?moment.duration(input):this.computeLabelInterval(slotDuration)},computeLabelInterval:function(slotDuration){var i,labelInterval,slotsPerLabel;for(i=AGENDA_STOCK_SUB_DURATIONS.length-1;i>=0;i--)if(labelInterval=moment.duration(AGENDA_STOCK_SUB_DURATIONS[i]),slotsPerLabel=divideDurationByDuration(labelInterval,slotDuration),isInt(slotsPerLabel)&&slotsPerLabel>1)return labelInterval;return moment.duration(slotDuration)},computeColHeadFormat:function(){return this.colCnt>1?this.view.opt("dayOfMonthFormat"):"dddd"},computeEventTimeFormat:function(){return this.view.opt("noMeridiemTimeFormat")},computeDisplayEventEnd:function(){return!0},rangeUpdated:function(){var date,view=this.view,colDates=[];for(date=this.start.clone();date.isBefore(this.end);)colDates.push(date.clone()),date.add(1,"day"),date=view.skipHiddenDays(date);this.isRTL&&colDates.reverse(),this.colDates=colDates,this.colCnt=colDates.length,this.rowCnt=Math.ceil((this.maxTime-this.minTime)/this.snapDuration)},computeCellDate:function(cell){var date=this.colDates[cell.col],time=this.computeSnapTime(cell.row);return date=this.view.calendar.rezoneDate(date),date.time(time),date},getColEl:function(col){return this.dayEls.eq(col)},computeSnapTime:function(row){return moment.duration(this.minTime+this.snapDuration*row)},rangeToSegs:function(range){var seg,col,colDate,colRange,colCnt=this.colCnt,segs=[];for(range={start:range.start.clone().stripZone(),end:range.end.clone().stripZone()},col=0;col<colCnt;col++)colDate=this.colDates[col],colRange={start:colDate.clone().time(this.minTime),end:colDate.clone().time(this.maxTime)},seg=intersectionToSeg(range,colRange),seg&&(seg.col=col,segs.push(seg));return segs},updateSize:function(isResize){this.computeSlatTops(),isResize&&this.updateSegVerticals()},computeRowCoords:function(){var i,item,originTop=this.el.offset().top,items=[];for(i=0;i<this.rowCnt;i++)item={top:originTop+this.computeTimeTop(this.computeSnapTime(i))},i>0&&(items[i-1].bottom=item.top),items.push(item);return item.bottom=item.top+this.computeTimeTop(this.computeSnapTime(i)),items},computeDateTop:function(date,startOfDayDate){return this.computeTimeTop(moment.duration(date.clone().stripZone()-startOfDayDate.clone().stripTime()))},computeTimeTop:function(time){var slatIndex,slatRemainder,slatTop,slatBottom,slatCoverage=(time-this.minTime)/this.slotDuration;return slatCoverage=Math.max(0,slatCoverage),slatCoverage=Math.min(this.slatEls.length,slatCoverage),slatIndex=Math.floor(slatCoverage),slatRemainder=slatCoverage-slatIndex,slatTop=this.slatTops[slatIndex],slatRemainder?(slatBottom=this.slatTops[slatIndex+1],slatTop+(slatBottom-slatTop)*slatRemainder):slatTop},computeSlatTops:function(){var top,tops=[];this.slatEls.each(function(i,node){top=$(node).position().top,tops.push(top)}),tops.push(top+this.slatEls.last().outerHeight()),this.slatTops=tops},renderDrag:function(dropLocation,seg){return seg?(this.renderRangeHelper(dropLocation,seg),this.applyDragOpacity(this.helperEl),!0):void this.renderHighlight(this.eventRangeToSegs(dropLocation))},unrenderDrag:function(){this.unrenderHelper(),this.unrenderHighlight()},renderEventResize:function(range,seg){this.renderRangeHelper(range,seg)},unrenderEventResize:function(){this.unrenderHelper()},renderHelper:function(event,sourceSeg){var tableEl,i,seg,sourceEl,segs=this.eventsToSegs([event]);for(segs=this.renderFgSegEls(segs),tableEl=this.renderSegTable(segs),i=0;i<segs.length;i++)seg=segs[i],sourceSeg&&sourceSeg.col===seg.col&&(sourceEl=sourceSeg.el,seg.el.css({left:sourceEl.css("left"),right:sourceEl.css("right"),"margin-left":sourceEl.css("margin-left"),"margin-right":sourceEl.css("margin-right")}));this.helperEl=$('<div class="fc-helper-skeleton"/>').append(tableEl).appendTo(this.el)},unrenderHelper:function(){this.helperEl&&(this.helperEl.remove(),this.helperEl=null)},renderSelection:function(range){this.view.opt("selectHelper")?this.renderRangeHelper(range):this.renderHighlight(this.selectionRangeToSegs(range))},unrenderSelection:function(){this.unrenderHelper(),this.unrenderHighlight()},renderFill:function(type,segs,className){var segCols,skeletonEl,trEl,col,colSegs,tdEl,containerEl,dayDate,i,seg;if(segs.length){for(segs=this.renderFillSegEls(type,segs),segCols=this.groupSegCols(segs),className=className||type.toLowerCase(),skeletonEl=$('<div class="fc-'+className+'-skeleton"><table><tr/></table></div>'),trEl=skeletonEl.find("tr"),col=0;col<segCols.length;col++)if(colSegs=segCols[col],tdEl=$("<td/>").appendTo(trEl),colSegs.length)for(containerEl=$('<div class="fc-'+className+'-container"/>').appendTo(tdEl),dayDate=this.colDates[col],i=0;i<colSegs.length;i++)seg=colSegs[i],containerEl.append(seg.el.css({top:this.computeDateTop(seg.start,dayDate),bottom:-this.computeDateTop(seg.end,dayDate)}));this.bookendCells(trEl,type),this.el.append(skeletonEl),this.elsByFill[type]=skeletonEl}return segs}});TimeGrid.mixin({eventSkeletonEl:null,renderFgSegs:function(segs){return segs=this.renderFgSegEls(segs),this.el.append(this.eventSkeletonEl=$('<div class="fc-content-skeleton"/>').append(this.renderSegTable(segs))),segs},unrenderFgSegs:function(segs){this.eventSkeletonEl&&(this.eventSkeletonEl.remove(),this.eventSkeletonEl=null)},renderSegTable:function(segs){var segCols,i,seg,col,colSegs,containerEl,tableEl=$("<table><tr/></table>"),trEl=tableEl.find("tr");for(segCols=this.groupSegCols(segs),this.computeSegVerticals(segs),col=0;col<segCols.length;col++){for(colSegs=segCols[col],this.placeSlotSegs(colSegs),containerEl=$('<div class="fc-event-container"/>'),i=0;i<colSegs.length;i++)seg=colSegs[i],
seg.el.css(this.generateSegPositionCss(seg)),seg.bottom-seg.top<30&&seg.el.addClass("fc-short"),containerEl.append(seg.el);trEl.append($("<td/>").append(containerEl))}return this.bookendCells(trEl,"eventSkeleton"),tableEl},placeSlotSegs:function(segs){var levels,level0,i;if(this.sortSegs(segs),levels=buildSlotSegLevels(segs),computeForwardSlotSegs(levels),level0=levels[0]){for(i=0;i<level0.length;i++)computeSlotSegPressures(level0[i]);for(i=0;i<level0.length;i++)this.computeSlotSegCoords(level0[i],0,0)}},computeSlotSegCoords:function(seg,seriesBackwardPressure,seriesBackwardCoord){var i,forwardSegs=seg.forwardSegs;if(void 0===seg.forwardCoord)for(forwardSegs.length?(this.sortForwardSlotSegs(forwardSegs),this.computeSlotSegCoords(forwardSegs[0],seriesBackwardPressure+1,seriesBackwardCoord),seg.forwardCoord=forwardSegs[0].backwardCoord):seg.forwardCoord=1,seg.backwardCoord=seg.forwardCoord-(seg.forwardCoord-seriesBackwardCoord)/(seriesBackwardPressure+1),i=0;i<forwardSegs.length;i++)this.computeSlotSegCoords(forwardSegs[i],0,seg.forwardCoord)},updateSegVerticals:function(){var i,allSegs=(this.segs||[]).concat(this.businessHourSegs||[]);for(this.computeSegVerticals(allSegs),i=0;i<allSegs.length;i++)allSegs[i].el.css(this.generateSegVerticalCss(allSegs[i]))},computeSegVerticals:function(segs){var i,seg;for(i=0;i<segs.length;i++)seg=segs[i],seg.top=this.computeDateTop(seg.start,seg.start),seg.bottom=this.computeDateTop(seg.end,seg.start)},fgSegHtml:function(seg,disableResizing){var timeText,fullTimeText,startTimeText,view=this.view,event=seg.event,isDraggable=view.isEventDraggable(event),isResizableFromStart=!disableResizing&&seg.isStart&&view.isEventResizableFromStart(event),isResizableFromEnd=!disableResizing&&seg.isEnd&&view.isEventResizableFromEnd(event),classes=this.getSegClasses(seg,isDraggable,isResizableFromStart||isResizableFromEnd),skinCss=cssToStr(this.getEventSkinCss(event));return classes.unshift("fc-time-grid-event","fc-v-event"),view.isMultiDayEvent(event)?(seg.isStart||seg.isEnd)&&(timeText=this.getEventTimeText(seg),fullTimeText=this.getEventTimeText(seg,"LT"),startTimeText=this.getEventTimeText(seg,null,!1)):(timeText=this.getEventTimeText(event),fullTimeText=this.getEventTimeText(event,"LT"),startTimeText=this.getEventTimeText(event,null,!1)),'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+'><div class="fc-content">'+(timeText?'<div class="fc-time" data-start="'+htmlEscape(startTimeText)+'" data-full="'+htmlEscape(fullTimeText)+'"><span>'+htmlEscape(timeText)+"</span></div>":"")+(event.title?'<div class="fc-title">'+htmlEscape(event.title)+"</div>":"")+'</div><div class="fc-bg"/>'+(isResizableFromEnd?'<div class="fc-resizer fc-end-resizer" />':"")+"</a>"},generateSegPositionCss:function(seg){var left,right,shouldOverlap=this.view.opt("slotEventOverlap"),backwardCoord=seg.backwardCoord,forwardCoord=seg.forwardCoord,props=this.generateSegVerticalCss(seg);return shouldOverlap&&(forwardCoord=Math.min(1,backwardCoord+2*(forwardCoord-backwardCoord))),this.isRTL?(left=1-forwardCoord,right=backwardCoord):(left=backwardCoord,right=1-forwardCoord),props.zIndex=seg.level+1,props.left=100*left+"%",props.right=100*right+"%",shouldOverlap&&seg.forwardPressure&&(props[this.isRTL?"marginLeft":"marginRight"]=20),props},generateSegVerticalCss:function(seg){return{top:seg.top,bottom:-seg.bottom}},groupSegCols:function(segs){var i,segCols=[];for(i=0;i<this.colCnt;i++)segCols.push([]);for(i=0;i<segs.length;i++)segCols[segs[i].col].push(segs[i]);return segCols},sortForwardSlotSegs:function(forwardSegs){forwardSegs.sort(proxy(this,"compareForwardSlotSegs"))},compareForwardSlotSegs:function(seg1,seg2){return seg2.forwardPressure-seg1.forwardPressure||(seg1.backwardCoord||0)-(seg2.backwardCoord||0)||this.compareSegs(seg1,seg2)}});var View=fc.View=Class.extend({type:null,name:null,title:null,calendar:null,options:null,coordMap:null,el:null,displaying:null,isSkeletonRendered:!1,isEventsRendered:!1,start:null,end:null,intervalStart:null,intervalEnd:null,intervalDuration:null,intervalUnit:null,isRTL:!1,isSelected:!1,eventOrderSpecs:null,scrollerEl:null,scrollTop:null,widgetHeaderClass:null,widgetContentClass:null,highlightStateClass:null,nextDayThreshold:null,isHiddenDayHash:null,documentMousedownProxy:null,constructor:function(calendar,type,options,intervalDuration){this.calendar=calendar,this.type=this.name=type,this.options=options,this.intervalDuration=intervalDuration||moment.duration(1,"day"),this.nextDayThreshold=moment.duration(this.opt("nextDayThreshold")),this.initThemingProps(),this.initHiddenDays(),this.isRTL=this.opt("isRTL"),this.eventOrderSpecs=parseFieldSpecs(this.opt("eventOrder")),this.documentMousedownProxy=proxy(this,"documentMousedown"),this.initialize()},initialize:function(){},opt:function(name){return this.options[name]},trigger:function(name,thisObj){var calendar=this.calendar;return calendar.trigger.apply(calendar,[name,thisObj||this].concat(Array.prototype.slice.call(arguments,2),[this]))},setDate:function(date){this.setRange(this.computeRange(date))},setRange:function(range){$.extend(this,range),this.updateTitle()},computeRange:function(date){var start,end,intervalUnit=computeIntervalUnit(this.intervalDuration),intervalStart=date.clone().startOf(intervalUnit),intervalEnd=intervalStart.clone().add(this.intervalDuration);return/year|month|week|day/.test(intervalUnit)?(intervalStart.stripTime(),intervalEnd.stripTime()):(intervalStart.hasTime()||(intervalStart=this.calendar.rezoneDate(intervalStart)),intervalEnd.hasTime()||(intervalEnd=this.calendar.rezoneDate(intervalEnd))),start=intervalStart.clone(),start=this.skipHiddenDays(start),end=intervalEnd.clone(),end=this.skipHiddenDays(end,-1,!0),{intervalUnit:intervalUnit,intervalStart:intervalStart,intervalEnd:intervalEnd,start:start,end:end}},computePrevDate:function(date){return this.massageCurrentDate(date.clone().startOf(this.intervalUnit).subtract(this.intervalDuration),-1)},computeNextDate:function(date){return this.massageCurrentDate(date.clone().startOf(this.intervalUnit).add(this.intervalDuration))},massageCurrentDate:function(date,direction){return this.intervalDuration.as("days")<=1&&this.isHiddenDay(date)&&(date=this.skipHiddenDays(date,direction),date.startOf("day")),date},updateTitle:function(){this.title=this.computeTitle()},computeTitle:function(){return this.formatRange({start:this.intervalStart,end:this.intervalEnd},this.opt("titleFormat")||this.computeTitleFormat(),this.opt("titleRangeSeparator"))},computeTitleFormat:function(){return"year"==this.intervalUnit?"YYYY":"month"==this.intervalUnit?this.opt("monthYearFormat"):this.intervalDuration.as("days")>1?"ll":"LL"},formatRange:function(range,formatStr,separator){var end=range.end;return end.hasTime()||(end=end.clone().subtract(1)),formatRange(range.start,end,formatStr,separator,this.opt("isRTL"))},setElement:function(el){this.el=el,this.bindGlobalHandlers()},removeElement:function(){this.clear(),this.isSkeletonRendered&&(this.unrenderSkeleton(),this.isSkeletonRendered=!1),this.unbindGlobalHandlers(),this.el.remove()},display:function(date){var _this=this,scrollState=null;return this.displaying&&(scrollState=this.queryScroll()),this.clear().then(function(){return _this.displaying=$.when(_this.displayView(date)).then(function(){_this.forceScroll(_this.computeInitialScroll(scrollState)),_this.triggerRender()})})},clear:function(){var _this=this,displaying=this.displaying;return displaying?displaying.then(function(){return _this.displaying=null,_this.clearEvents(),_this.clearView()}):$.when()},displayView:function(date){this.isSkeletonRendered||(this.renderSkeleton(),this.isSkeletonRendered=!0),this.setDate(date),this.render&&this.render(),this.renderDates(),this.updateSize(),this.renderBusinessHours()},clearView:function(){this.unselect(),this.triggerUnrender(),this.unrenderBusinessHours(),this.unrenderDates(),this.destroy&&this.destroy()},renderSkeleton:function(){},unrenderSkeleton:function(){},renderDates:function(){},unrenderDates:function(){},renderBusinessHours:function(){},unrenderBusinessHours:function(){},triggerRender:function(){this.trigger("viewRender",this,this,this.el)},triggerUnrender:function(){this.trigger("viewDestroy",this,this,this.el)},bindGlobalHandlers:function(){$(document).on("mousedown",this.documentMousedownProxy)},unbindGlobalHandlers:function(){$(document).off("mousedown",this.documentMousedownProxy)},initThemingProps:function(){var tm=this.opt("theme")?"ui":"fc";this.widgetHeaderClass=tm+"-widget-header",this.widgetContentClass=tm+"-widget-content",this.highlightStateClass=tm+"-state-highlight"},updateSize:function(isResize){var scrollState;isResize&&(scrollState=this.queryScroll()),this.updateHeight(isResize),this.updateWidth(isResize),isResize&&this.setScroll(scrollState)},updateWidth:function(isResize){},updateHeight:function(isResize){var calendar=this.calendar;this.setHeight(calendar.getSuggestedViewHeight(),calendar.isHeightAuto())},setHeight:function(height,isAuto){},computeScrollerHeight:function(totalHeight){var both,otherHeight,scrollerEl=this.scrollerEl;return both=this.el.add(scrollerEl),both.css({position:"relative",left:-1}),otherHeight=this.el.outerHeight()-scrollerEl.height(),both.css({position:"",left:""}),totalHeight-otherHeight},computeInitialScroll:function(previousScrollState){return 0},queryScroll:function(){if(this.scrollerEl)return this.scrollerEl.scrollTop()},setScroll:function(scrollState){if(this.scrollerEl)return this.scrollerEl.scrollTop(scrollState)},forceScroll:function(scrollState){var _this=this;this.setScroll(scrollState),setTimeout(function(){_this.setScroll(scrollState)},0)},displayEvents:function(events){var scrollState=this.queryScroll();this.clearEvents(),this.renderEvents(events),this.isEventsRendered=!0,this.setScroll(scrollState),this.triggerEventRender()},clearEvents:function(){this.isEventsRendered&&(this.triggerEventUnrender(),this.destroyEvents&&this.destroyEvents(),this.unrenderEvents(),this.isEventsRendered=!1)},renderEvents:function(events){},unrenderEvents:function(){},triggerEventRender:function(){this.renderedEventSegEach(function(seg){this.trigger("eventAfterRender",seg.event,seg.event,seg.el)}),this.trigger("eventAfterAllRender")},triggerEventUnrender:function(){this.renderedEventSegEach(function(seg){this.trigger("eventDestroy",seg.event,seg.event,seg.el)})},resolveEventEl:function(event,el){var custom=this.trigger("eventRender",event,event,el);return custom===!1?el=null:custom&&custom!==!0&&(el=$(custom)),el},showEvent:function(event){this.renderedEventSegEach(function(seg){seg.el.css("visibility","")},event)},hideEvent:function(event){this.renderedEventSegEach(function(seg){seg.el.css("visibility","hidden")},event)},renderedEventSegEach:function(func,event){var i,segs=this.getEventSegs();for(i=0;i<segs.length;i++)event&&segs[i].event._id!==event._id||segs[i].el&&func.call(this,segs[i])},getEventSegs:function(){return[]},isEventDraggable:function(event){var source=event.source||{};return firstDefined(event.startEditable,source.startEditable,this.opt("eventStartEditable"),event.editable,source.editable,this.opt("editable"))},reportEventDrop:function(event,dropLocation,largeUnit,el,ev){var calendar=this.calendar,mutateResult=calendar.mutateEvent(event,dropLocation,largeUnit),undoFunc=function(){mutateResult.undo(),calendar.reportEventChange()};this.triggerEventDrop(event,mutateResult.dateDelta,undoFunc,el,ev),calendar.reportEventChange()},triggerEventDrop:function(event,dateDelta,undoFunc,el,ev){this.trigger("eventDrop",el[0],event,dateDelta,undoFunc,ev,{})},reportExternalDrop:function(meta,dropLocation,el,ev,ui){var eventInput,event,eventProps=meta.eventProps;eventProps&&(eventInput=$.extend({},eventProps,dropLocation),event=this.calendar.renderEvent(eventInput,meta.stick)[0]),this.triggerExternalDrop(event,dropLocation,el,ev,ui)},triggerExternalDrop:function(event,dropLocation,el,ev,ui){this.trigger("drop",el[0],dropLocation.start,ev,ui),event&&this.trigger("eventReceive",null,event)},renderDrag:function(dropLocation,seg){},unrenderDrag:function(){},isEventResizableFromStart:function(event){return this.opt("eventResizableFromStart")&&this.isEventResizable(event)},isEventResizableFromEnd:function(event){return this.isEventResizable(event)},isEventResizable:function(event){var source=event.source||{};return firstDefined(event.durationEditable,source.durationEditable,this.opt("eventDurationEditable"),event.editable,source.editable,this.opt("editable"))},reportEventResize:function(event,resizeLocation,largeUnit,el,ev){var calendar=this.calendar,mutateResult=calendar.mutateEvent(event,resizeLocation,largeUnit),undoFunc=function(){mutateResult.undo(),calendar.reportEventChange()};this.triggerEventResize(event,mutateResult.durationDelta,undoFunc,el,ev),calendar.reportEventChange()},triggerEventResize:function(event,durationDelta,undoFunc,el,ev){this.trigger("eventResize",el[0],event,durationDelta,undoFunc,ev,{})},select:function(range,ev){this.unselect(ev),this.renderSelection(range),this.reportSelection(range,ev)},renderSelection:function(range){},reportSelection:function(range,ev){this.isSelected=!0,this.triggerSelect(range,ev)},triggerSelect:function(range,ev){this.trigger("select",null,range.start,range.end,ev)},unselect:function(ev){this.isSelected&&(this.isSelected=!1,this.destroySelection&&this.destroySelection(),this.unrenderSelection(),this.trigger("unselect",null,ev))},unrenderSelection:function(){},documentMousedown:function(ev){var ignore;this.isSelected&&this.opt("unselectAuto")&&isPrimaryMouseButton(ev)&&(ignore=this.opt("unselectCancel"),ignore&&$(ev.target).closest(ignore).length||this.unselect(ev))},triggerDayClick:function(cell,dayEl,ev){this.trigger("dayClick",dayEl,cell.start,ev)},initHiddenDays:function(){var i,hiddenDays=this.opt("hiddenDays")||[],isHiddenDayHash=[],dayCnt=0;for(this.opt("weekends")===!1&&hiddenDays.push(0,6),i=0;i<7;i++)(isHiddenDayHash[i]=$.inArray(i,hiddenDays)!==-1)||dayCnt++;if(!dayCnt)throw"invalid hiddenDays";this.isHiddenDayHash=isHiddenDayHash},isHiddenDay:function(day){return moment.isMoment(day)&&(day=day.day()),this.isHiddenDayHash[day]},skipHiddenDays:function(date,inc,isExclusive){var out=date.clone();for(inc=inc||1;this.isHiddenDayHash[(out.day()+(isExclusive?inc:0)+7)%7];)out.add(inc,"days");return out},computeDayRange:function(range){var endTimeMS,startDay=range.start.clone().stripTime(),end=range.end,endDay=null;return end&&(endDay=end.clone().stripTime(),endTimeMS=+end.time(),endTimeMS&&endTimeMS>=this.nextDayThreshold&&endDay.add(1,"days")),(!end||endDay<=startDay)&&(endDay=startDay.clone().add(1,"days")),{start:startDay,end:endDay}},isMultiDayEvent:function(event){var range=this.computeDayRange(event);return range.end.diff(range.start,"days")>1}}),Calendar=fc.Calendar=Class.extend({dirDefaults:null,langDefaults:null,overrides:null,options:null,viewSpecCache:null,view:null,header:null,loadingLevel:0,constructor:Calendar_constructor,initialize:function(){},initOptions:function(overrides){var lang,langDefaults,isRTL,dirDefaults;overrides=massageOverrides(overrides),lang=overrides.lang,langDefaults=langOptionHash[lang],langDefaults||(lang=Calendar.defaults.lang,langDefaults=langOptionHash[lang]||{}),isRTL=firstDefined(overrides.isRTL,langDefaults.isRTL,Calendar.defaults.isRTL),dirDefaults=isRTL?Calendar.rtlDefaults:{},this.dirDefaults=dirDefaults,this.langDefaults=langDefaults,this.overrides=overrides,this.options=mergeOptions([Calendar.defaults,dirDefaults,langDefaults,overrides]),populateInstanceComputableOptions(this.options),this.viewSpecCache={}},getViewSpec:function(viewType){var cache=this.viewSpecCache;return cache[viewType]||(cache[viewType]=this.buildViewSpec(viewType))},getUnitViewSpec:function(unit){var viewTypes,i,spec;if($.inArray(unit,intervalUnits)!=-1)for(viewTypes=this.header.getViewsWithButtons(),$.each(fc.views,function(viewType){viewTypes.push(viewType)}),i=0;i<viewTypes.length;i++)if(spec=this.getViewSpec(viewTypes[i]),spec&&spec.singleUnit==unit)return spec},buildViewSpec:function(requestedViewType){for(var spec,overrides,duration,unit,viewOverrides=this.overrides.views||{},specChain=[],defaultsChain=[],overridesChain=[],viewType=requestedViewType;viewType;)spec=fcViews[viewType],overrides=viewOverrides[viewType],viewType=null,"function"==typeof spec&&(spec={"class":spec}),spec&&(specChain.unshift(spec),defaultsChain.unshift(spec.defaults||{}),duration=duration||spec.duration,viewType=viewType||spec.type),overrides&&(overridesChain.unshift(overrides),duration=duration||overrides.duration,viewType=viewType||overrides.type);return spec=mergeProps(specChain),spec.type=requestedViewType,!!spec["class"]&&(duration&&(duration=moment.duration(duration),duration.valueOf()&&(spec.duration=duration,unit=computeIntervalUnit(duration),1===duration.as(unit)&&(spec.singleUnit=unit,overridesChain.unshift(viewOverrides[unit]||{})))),spec.defaults=mergeOptions(defaultsChain),spec.overrides=mergeOptions(overridesChain),this.buildViewSpecOptions(spec),this.buildViewSpecButtonText(spec,requestedViewType),spec)},buildViewSpecOptions:function(spec){spec.options=mergeOptions([Calendar.defaults,spec.defaults,this.dirDefaults,this.langDefaults,this.overrides,spec.overrides]),populateInstanceComputableOptions(spec.options)},buildViewSpecButtonText:function(spec,requestedViewType){function queryButtonText(options){var buttonText=options.buttonText||{};return buttonText[requestedViewType]||(spec.singleUnit?buttonText[spec.singleUnit]:null)}spec.buttonTextOverride=queryButtonText(this.overrides)||spec.overrides.buttonText,spec.buttonTextDefault=queryButtonText(this.langDefaults)||queryButtonText(this.dirDefaults)||spec.defaults.buttonText||queryButtonText(Calendar.defaults)||(spec.duration?this.humanizeDuration(spec.duration):null)||requestedViewType},instantiateView:function(viewType){var spec=this.getViewSpec(viewType);return new spec["class"](this,viewType,spec.options,spec.duration)},isValidViewType:function(viewType){return Boolean(this.getViewSpec(viewType))},pushLoading:function(){this.loadingLevel++||this.trigger("loading",null,!0,this.view)},popLoading:function(){--this.loadingLevel||this.trigger("loading",null,!1,this.view)},buildSelectRange:function(start,end){return start=this.moment(start),end=end?this.moment(end):start.hasTime()?start.clone().add(this.defaultTimedEventDuration):start.clone().add(this.defaultAllDayEventDuration),{start:start,end:end}}});Calendar.mixin(Emitter),Calendar.defaults={titleRangeSeparator:"  ",monthYearFormat:"MMMM YYYY",defaultTimedEventDuration:"02:00:00",defaultAllDayEventDuration:{days:1},forceEventDuration:!1,nextDayThreshold:"09:00:00",defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberTitle:"W",weekNumberCalculation:"local",scrollTime:"06:00:00",lazyFetching:!0,startParam:"start",endParam:"end",timezoneParam:"timezone",timezone:!1,isRTL:!1,buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day"},buttonIcons:{prev:"left-single-arrow",next:"right-single-arrow",prevYear:"left-double-arrow",nextYear:"right-double-arrow"},theme:!1,themeButtonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e",prevYear:"seek-prev",nextYear:"seek-next"},dragOpacity:.75,dragRevertDuration:500,dragScroll:!0,unselectAuto:!0,dropAccept:"*",eventOrder:"title",eventLimit:!1,eventLimitText:"more",eventLimitClick:"popover",dayPopoverFormat:"LL",handleWindowResize:!0,windowResizeDelay:200},Calendar.englishDefaults={dayPopoverFormat:"dddd, MMMM D"},Calendar.rtlDefaults={header:{left:"next,prev today",center:"",right:"title"},buttonIcons:{prev:"right-single-arrow",next:"left-single-arrow",prevYear:"right-double-arrow",nextYear:"left-double-arrow"},themeButtonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w",nextYear:"seek-prev",prevYear:"seek-next"}};var langOptionHash=fc.langs={};fc.datepickerLang=function(langCode,dpLangCode,dpOptions){var fcOptions=langOptionHash[langCode]||(langOptionHash[langCode]={});fcOptions.isRTL=dpOptions.isRTL,fcOptions.weekNumberTitle=dpOptions.weekHeader,$.each(dpComputableOptions,function(name,func){fcOptions[name]=func(dpOptions)}),$.datepicker&&($.datepicker.regional[dpLangCode]=$.datepicker.regional[langCode]=dpOptions,$.datepicker.regional.en=$.datepicker.regional[""],$.datepicker.setDefaults(dpOptions))},fc.lang=function(langCode,newFcOptions){var fcOptions,momOptions;fcOptions=langOptionHash[langCode]||(langOptionHash[langCode]={}),newFcOptions&&(fcOptions=langOptionHash[langCode]=mergeOptions([fcOptions,newFcOptions])),momOptions=getMomentLocaleData(langCode),$.each(momComputableOptions,function(name,func){null==fcOptions[name]&&(fcOptions[name]=func(momOptions,fcOptions))}),Calendar.defaults.lang=langCode};var dpComputableOptions={buttonText:function(dpOptions){return{prev:stripHtmlEntities(dpOptions.prevText),next:stripHtmlEntities(dpOptions.nextText),today:stripHtmlEntities(dpOptions.currentText)}},monthYearFormat:function(dpOptions){return dpOptions.showMonthAfterYear?"YYYY["+dpOptions.yearSuffix+"] MMMM":"MMMM YYYY["+dpOptions.yearSuffix+"]"}},momComputableOptions={dayOfMonthFormat:function(momOptions,fcOptions){var format=momOptions.longDateFormat("l");return format=format.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g,""),fcOptions.isRTL?format+=" ddd":format="ddd "+format,format},mediumTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(/\s*a$/i,"a")},smallTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"a")},extraSmallTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"t")},hourFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","").replace(/(\Wmm)$/,"").replace(/\s*a$/i,"a")},noMeridiemTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(/\s*a$/i,"")}},instanceComputableOptions={smallDayDateFormat:function(options){return options.isRTL?"D dd":"dd D"},weekFormat:function(options){return options.isRTL?"w[ "+options.weekNumberTitle+"]":"["+options.weekNumberTitle+" ]w"},smallWeekFormat:function(options){return options.isRTL?"w["+options.weekNumberTitle+"]":"["+options.weekNumberTitle+"]w"}};fc.lang("en",Calendar.englishDefaults),fc.sourceNormalizers=[],fc.sourceFetchers=[];var ajaxDefaults={dataType:"json",cache:!1},eventGUID=1;Calendar.prototype.getPeerEvents=function(event,range){var i,otherEvent,cache=this.getEventCache(),peerEvents=[];for(i=0;i<cache.length;i++)otherEvent=cache[i],event&&event._id===otherEvent._id||peerEvents.push(otherEvent);return peerEvents};var BasicView=View.extend({dayGrid:null,dayNumbersVisible:!1,weekNumbersVisible:!1,weekNumberWidth:null,headRowEl:null,initialize:function(){this.dayGrid=new DayGrid(this),this.coordMap=this.dayGrid.coordMap},setRange:function(range){View.prototype.setRange.call(this,range),this.dayGrid.breakOnWeeks=/year|month|week/.test(this.intervalUnit),this.dayGrid.setRange(range)},computeRange:function(date){var range=View.prototype.computeRange.call(this,date);return/year|month/.test(range.intervalUnit)&&(range.start.startOf("week"),range.start=this.skipHiddenDays(range.start),range.end.weekday()&&(range.end.add(1,"week").startOf("week"),range.end=this.skipHiddenDays(range.end,-1,!0))),range},renderDates:function(){this.dayNumbersVisible=this.dayGrid.rowCnt>1,this.weekNumbersVisible=this.opt("weekNumbers"),this.dayGrid.numbersVisible=this.dayNumbersVisible||this.weekNumbersVisible,this.el.addClass("fc-basic-view").html(this.renderHtml()),this.headRowEl=this.el.find("thead .fc-row"),this.scrollerEl=this.el.find(".fc-day-grid-container"),this.dayGrid.coordMap.containerEl=this.scrollerEl,this.dayGrid.setElement(this.el.find(".fc-day-grid")),this.dayGrid.renderDates(this.hasRigidRows())},unrenderDates:function(){this.dayGrid.unrenderDates(),this.dayGrid.removeElement()},renderBusinessHours:function(){this.dayGrid.renderBusinessHours()},renderHtml:function(){return'<table><thead class="fc-head"><tr><td class="'+this.widgetHeaderClass+'">'+this.dayGrid.headHtml()+'</td></tr></thead><tbody class="fc-body"><tr><td class="'+this.widgetContentClass+'"><div class="fc-day-grid-container"><div class="fc-day-grid"/></div></td></tr></tbody></table>'},headIntroHtml:function(){if(this.weekNumbersVisible)return'<th class="fc-week-number '+this.widgetHeaderClass+'" '+this.weekNumberStyleAttr()+"><span>"+htmlEscape(this.opt("weekNumberTitle"))+"</span></th>"},numberIntroHtml:function(row){if(this.weekNumbersVisible)return'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"><span>"+this.dayGrid.getCell(row,0).start.format("w")+"</span></td>"},dayIntroHtml:function(){if(this.weekNumbersVisible)return'<td class="fc-week-number '+this.widgetContentClass+'" '+this.weekNumberStyleAttr()+"></td>"},introHtml:function(){if(this.weekNumbersVisible)return'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"></td>"},numberCellHtml:function(cell){var classes,date=cell.start;return this.dayNumbersVisible?(classes=this.dayGrid.getDayClasses(date),classes.unshift("fc-day-number"),'<td class="'+classes.join(" ")+'" data-date="'+date.format()+'">'+date.date()+"</td>"):"<td/>"},weekNumberStyleAttr:function(){return null!==this.weekNumberWidth?'style="width:'+this.weekNumberWidth+'px"':""},hasRigidRows:function(){var eventLimit=this.opt("eventLimit");return eventLimit&&"number"!=typeof eventLimit},updateWidth:function(){this.weekNumbersVisible&&(this.weekNumberWidth=matchCellWidths(this.el.find(".fc-week-number")))},setHeight:function(totalHeight,isAuto){var scrollerHeight,eventLimit=this.opt("eventLimit");unsetScroller(this.scrollerEl),uncompensateScroll(this.headRowEl),this.dayGrid.removeSegPopover(),eventLimit&&"number"==typeof eventLimit&&this.dayGrid.limitRows(eventLimit),scrollerHeight=this.computeScrollerHeight(totalHeight),this.setGridHeight(scrollerHeight,isAuto),eventLimit&&"number"!=typeof eventLimit&&this.dayGrid.limitRows(eventLimit),!isAuto&&setPotentialScroller(this.scrollerEl,scrollerHeight)&&(compensateScroll(this.headRowEl,getScrollbarWidths(this.scrollerEl)),scrollerHeight=this.computeScrollerHeight(totalHeight),this.scrollerEl.height(scrollerHeight))},setGridHeight:function(height,isAuto){isAuto?undistributeHeight(this.dayGrid.rowEls):distributeHeight(this.dayGrid.rowEls,height,!0)},renderEvents:function(events){this.dayGrid.renderEvents(events),this.updateHeight()},getEventSegs:function(){return this.dayGrid.getEventSegs()},unrenderEvents:function(){this.dayGrid.unrenderEvents()},renderDrag:function(dropLocation,seg){return this.dayGrid.renderDrag(dropLocation,seg)},unrenderDrag:function(){this.dayGrid.unrenderDrag()},renderSelection:function(range){this.dayGrid.renderSelection(range)},unrenderSelection:function(){this.dayGrid.unrenderSelection()}}),MonthView=BasicView.extend({computeRange:function(date){var rowCnt,range=BasicView.prototype.computeRange.call(this,date);return this.isFixedWeeks()&&(rowCnt=Math.ceil(range.end.diff(range.start,"weeks",!0)),range.end.add(6-rowCnt,"weeks")),range},setGridHeight:function(height,isAuto){isAuto=isAuto||"variable"===this.opt("weekMode"),isAuto&&(height*=this.rowCnt/6),distributeHeight(this.dayGrid.rowEls,height,!isAuto)},isFixedWeeks:function(){var weekMode=this.opt("weekMode");return weekMode?"fixed"===weekMode:this.opt("fixedWeekCount")}});fcViews.basic={"class":BasicView},fcViews.basicDay={type:"basic",duration:{days:1}},fcViews.basicWeek={type:"basic",duration:{weeks:1}},fcViews.month={"class":MonthView,duration:{months:1},defaults:{fixedWeekCount:!0}};var AgendaView=View.extend({timeGrid:null,dayGrid:null,axisWidth:null,noScrollRowEls:null,bottomRuleEl:null,bottomRuleHeight:null,initialize:function(){this.timeGrid=new TimeGrid(this),this.opt("allDaySlot")?(this.dayGrid=new DayGrid(this),this.coordMap=new ComboCoordMap([this.dayGrid.coordMap,this.timeGrid.coordMap])):this.coordMap=this.timeGrid.coordMap},setRange:function(range){View.prototype.setRange.call(this,range),this.timeGrid.setRange(range),this.dayGrid&&this.dayGrid.setRange(range)},renderDates:function(){this.el.addClass("fc-agenda-view").html(this.renderHtml()),this.scrollerEl=this.el.find(".fc-time-grid-container"),this.timeGrid.coordMap.containerEl=this.scrollerEl,this.timeGrid.setElement(this.el.find(".fc-time-grid")),this.timeGrid.renderDates(),this.bottomRuleEl=$('<hr class="fc-divider '+this.widgetHeaderClass+'"/>').appendTo(this.timeGrid.el),this.dayGrid&&(this.dayGrid.setElement(this.el.find(".fc-day-grid")),this.dayGrid.renderDates(),this.dayGrid.bottomCoordPadding=this.dayGrid.el.next("hr").outerHeight()),this.noScrollRowEls=this.el.find(".fc-row:not(.fc-scroller *)")},unrenderDates:function(){this.timeGrid.unrenderDates(),this.timeGrid.removeElement(),this.dayGrid&&(this.dayGrid.unrenderDates(),this.dayGrid.removeElement())},renderBusinessHours:function(){this.timeGrid.renderBusinessHours(),this.dayGrid&&this.dayGrid.renderBusinessHours()},renderHtml:function(){return'<table><thead class="fc-head"><tr><td class="'+this.widgetHeaderClass+'">'+this.timeGrid.headHtml()+'</td></tr></thead><tbody class="fc-body"><tr><td class="'+this.widgetContentClass+'">'+(this.dayGrid?'<div class="fc-day-grid"/><hr class="fc-divider '+this.widgetHeaderClass+'"/>':"")+'<div class="fc-time-grid-container"><div class="fc-time-grid"/></div></td></tr></tbody></table>'},headIntroHtml:function(){var date,weekText;return this.opt("weekNumbers")?(date=this.timeGrid.getCell(0).start,weekText=date.format(this.opt("smallWeekFormat")),'<th class="fc-axis fc-week-number '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"><span>"+htmlEscape(weekText)+"</span></th>"):'<th class="fc-axis '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"></th>"},dayIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"><span>"+(this.opt("allDayHtml")||htmlEscape(this.opt("allDayText")))+"</span></td>"},slotBgIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"></td>"},introHtml:function(){return'<td class="fc-axis" '+this.axisStyleAttr()+"></td>"},axisStyleAttr:function(){return null!==this.axisWidth?'style="width:'+this.axisWidth+'px"':""},updateSize:function(isResize){this.timeGrid.updateSize(isResize),View.prototype.updateSize.call(this,isResize)},updateWidth:function(){this.axisWidth=matchCellWidths(this.el.find(".fc-axis"))},setHeight:function(totalHeight,isAuto){var eventLimit,scrollerHeight;null===this.bottomRuleHeight&&(this.bottomRuleHeight=this.bottomRuleEl.outerHeight()),this.bottomRuleEl.hide(),this.scrollerEl.css("overflow",""),unsetScroller(this.scrollerEl),uncompensateScroll(this.noScrollRowEls),this.dayGrid&&(this.dayGrid.removeSegPopover(),eventLimit=this.opt("eventLimit"),eventLimit&&"number"!=typeof eventLimit&&(eventLimit=AGENDA_ALL_DAY_EVENT_LIMIT),eventLimit&&this.dayGrid.limitRows(eventLimit)),isAuto||(scrollerHeight=this.computeScrollerHeight(totalHeight),setPotentialScroller(this.scrollerEl,scrollerHeight)?(compensateScroll(this.noScrollRowEls,getScrollbarWidths(this.scrollerEl)),scrollerHeight=this.computeScrollerHeight(totalHeight),this.scrollerEl.height(scrollerHeight)):(this.scrollerEl.height(scrollerHeight).css("overflow","hidden"),this.bottomRuleEl.show()))},computeInitialScroll:function(){var scrollTime=moment.duration(this.opt("scrollTime")),top=this.timeGrid.computeTimeTop(scrollTime);return top=Math.ceil(top),top&&top++,top},renderEvents:function(events){var timedSegs,i,dayEvents=[],timedEvents=[],daySegs=[];for(i=0;i<events.length;i++)events[i].allDay?dayEvents.push(events[i]):timedEvents.push(events[i]);timedSegs=this.timeGrid.renderEvents(timedEvents),
this.dayGrid&&(daySegs=this.dayGrid.renderEvents(dayEvents)),this.updateHeight()},getEventSegs:function(){return this.timeGrid.getEventSegs().concat(this.dayGrid?this.dayGrid.getEventSegs():[])},unrenderEvents:function(){this.timeGrid.unrenderEvents(),this.dayGrid&&this.dayGrid.unrenderEvents()},renderDrag:function(dropLocation,seg){return dropLocation.start.hasTime()?this.timeGrid.renderDrag(dropLocation,seg):this.dayGrid?this.dayGrid.renderDrag(dropLocation,seg):void 0},unrenderDrag:function(){this.timeGrid.unrenderDrag(),this.dayGrid&&this.dayGrid.unrenderDrag()},renderSelection:function(range){range.start.hasTime()||range.end.hasTime()?this.timeGrid.renderSelection(range):this.dayGrid&&this.dayGrid.renderSelection(range)},unrenderSelection:function(){this.timeGrid.unrenderSelection(),this.dayGrid&&this.dayGrid.unrenderSelection()}}),AGENDA_ALL_DAY_EVENT_LIMIT=5,AGENDA_STOCK_SUB_DURATIONS=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];return fcViews.agenda={"class":AgendaView,defaults:{allDaySlot:!0,allDayText:"all-day",slotDuration:"00:30:00",minTime:"00:00:00",maxTime:"24:00:00",slotEventOverlap:!0}},fcViews.agendaDay={type:"agenda",duration:{days:1}},fcViews.agendaWeek={type:"agenda",duration:{weeks:1}},fc}),function(window,angular,undefined){"use strict";function $KeepaliveProvider(){var options={http:null,interval:600};this.http=function(value){if(!value)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");angular.isString(value)&&(value={url:value,method:"GET"}),value.cache=!1,options.http=value},this.interval=function(seconds){if(seconds=parseInt(seconds),isNaN(seconds)||seconds<=0)throw new Error("Interval must be expressed in seconds and be greater than 0.");options.interval=seconds},this.$get=function($rootScope,$log,$interval,$http){function handleResponse(data,status){$rootScope.$broadcast("$keepaliveResponse",data,status)}function ping(){$rootScope.$broadcast("$keepalive"),angular.isObject(options.http)&&$http(options.http).success(handleResponse).error(handleResponse)}var state={ping:null};return{_options:function(){return options},start:function(){$interval.cancel(state.ping),state.ping=$interval(ping,1e3*options.interval)},stop:function(){$interval.cancel(state.ping)},ping:function(){ping()}}},this.$get.$inject=["$rootScope","$log","$interval","$http"]}function $IdleProvider(){var options={idleDuration:1200,warningDuration:30,autoResume:!0,events:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart",keepalive:!0};this.activeOn=function(events){options.events=events},this.idleDuration=function(seconds){if(seconds<=0)throw new Error("idleDuration must be a value in seconds, greater than 0.");options.idleDuration=seconds},this.warningDuration=function(seconds){if(seconds<0)throw new Error("warning must be a value in seconds, greater than 0.");options.warningDuration=seconds},this.autoResume=function(value){options.autoResume=value===!0},this.keepalive=function(enabled){options.keepalive=enabled===!0},this.$get=function($interval,$log,$rootScope,$document,$keepalive){function startKeepalive(){options.keepalive&&(state.running&&$keepalive.ping(),$keepalive.start())}function stopKeepalive(){options.keepalive&&$keepalive.stop()}function toggleState(){state.idling=!state.idling;var name=state.idling?"Start":"End";$rootScope.$broadcast("$idle"+name),state.idling?(stopKeepalive(),state.countdown=options.warningDuration,countdown(),state.warning=$interval(countdown,1e3,options.warningDuration)):startKeepalive(),$interval.cancel(state.idle)}function countdown(){state.countdown<=0?$rootScope.$broadcast("$idleTimeout"):$rootScope.$broadcast("$idleWarn",state.countdown),state.countdown--}var state={idle:null,warning:null,idling:!1,running:!1,countdown:null},svc={_options:function(){return options},running:function(){return state.running},idling:function(){return state.idling},watch:function(){$interval.cancel(state.idle),$interval.cancel(state.warning),state.idling?toggleState():state.running||startKeepalive(),state.running=!0,state.idle=$interval(toggleState,1e3*options.idleDuration)},unwatch:function(){$interval.cancel(state.idle),$interval.cancel(state.warning),state.idling=!1,state.running=!1}},interrupt=function(){state.running&&options.autoResume&&svc.watch()};return $document.find("body").on(options.events,interrupt),svc},this.$get.$inject=["$interval","$log","$rootScope","$document","$keepalive"]}angular.module("ngIdle.keepalive",[]).provider("$keepalive",$KeepaliveProvider),angular.module("ngIdle.idle",[]).provider("$idle",$IdleProvider),angular.module("ngIdle.ngIdleCountdown",[]).directive("ngIdleCountdown",function(){return{restrict:"A",scope:{value:"=ngIdleCountdown"},link:function($scope){$scope.$on("$idleWarn",function(e,countdown){$scope.value=countdown}),$scope.$on("$idleTimeout",function(){$scope.value=0})}}}),angular.module("ngIdle",["ngIdle.keepalive","ngIdle.idle","ngIdle.ngIdleCountdown"])}(window,window.angular),function(){var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?createCallback(value,context,argCount):_.isObject(value)?_.matches(value):_.property(value)},_.each=_.forEach=function(obj,iteratee,context){if(null==obj)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===+length)for(i=0;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){if(null==obj)return[];iteratee=_.iteratee(iteratee,context);for(var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;index<length;index++)currentKey=keys?keys[index]:index,results[index]=iteratee(obj[currentKey],currentKey,obj);return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;index<length;index++)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.reduceRight=_.foldr=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}for(;index--;)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.find=_.detect=function(obj,predicate,context){var result;return predicate=_.iteratee(predicate,context),_.some(obj,function(value,index,list){if(predicate(value,index,list))return result=value,!0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:(predicate=_.iteratee(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)},_.every=_.all=function(obj,predicate,context){if(null==obj)return!0;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;index<length;index++)if(currentKey=keys?keys[index]:index,!predicate(obj[currentKey],currentKey,obj))return!1;return!0},_.some=_.any=function(obj,predicate,context){if(null==obj)return!1;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;index<length;index++)if(currentKey=keys?keys[index]:index,predicate(obj[currentKey],currentKey,obj))return!0;return!1},_.contains=_.include=function(obj,target){return null!=obj&&(obj.length!==+obj.length&&(obj=_.values(obj)),_.indexOf(obj,target)>=0)},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-(1/0),lastComputed=-(1/0);if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)value=obj[i],value>result&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-(1/0)&&result===-(1/0))&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++)value=obj[i],value<result&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed<lastComputed||computed===1/0&&result===1/0)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=obj&&obj.length===+obj.length?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;index<length;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=_.iteratee(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iteratee,context){iteratee=_.iteratee(iteratee,context,1);for(var value=iteratee(obj),low=0,high=array.length;low<high;){var mid=low+high>>>1;iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){if(null!=array)return null==n||guard?array[0]:n<0?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){if(null!=array)return null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;i<length;i++){var value=input[i];_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,strict,output):strict||output.push(value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){if(null==array)return[];_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=_.iteratee(iteratee,context));for(var result=[],seen=[],i=0,length=array.length;i<length;i++){var value=array[i];if(isSorted)i&&seen===value||result.push(value),seen=value;else if(iteratee){var computed=iteratee(value,i,array);_.indexOf(seen,computed)<0&&(seen.push(computed),result.push(value))}else _.indexOf(result,value)<0&&result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0,[]))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;i<length;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;j<argsLength&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(slice.call(arguments,1),!0,!0,[]);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(array){if(null==array)return[];for(var length=_.max(arguments,"length").length,results=Array(length),i=0;i<length;i++)results[i]=_.pluck(arguments,i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;i<length;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=isSorted<0?Math.max(0,length+isSorted):isSorted}for(;i<length;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var idx=array.length;for("number"==typeof from&&(idx=from<0?idx+from+1:Math.min(idx,from+1));--idx>=0;)if(array[idx]===item)return idx;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;idx<length;idx++,start+=step)range[idx]=start;return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return _.isObject(result)?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;i<length;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var i,key,length=arguments.length;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=hasher?hasher.apply(this,arguments):key;return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0||remaining>wait?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;last<wait&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}},_.before=function(times,func){var memo;return function(){return--times>0?memo=func.apply(this,arguments):func=null,memo}},_.once=_.partial(_.before,2),_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;i<length;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){if(!_.isObject(obj))return obj;for(var source,prop,i=1,length=arguments.length;i<length;i++){source=arguments[i];for(prop in source)hasOwnProperty.call(source,prop)&&(obj[prop]=source[prop])}return obj},_.pick=function(obj,iteratee,context){var key,result={};if(null==obj)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;i<length;i++)key=keys[i],key in obj&&(result[key]=obj[key])}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;i<length;i++){var source=arguments[i];for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}return obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&"constructor"in a&&"constructor"in b&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size,result;if("[object Array]"===className){if(size=a.length,result=size===b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{var key,keys=_.keys(a);if(size=keys.length,result=_.keys(b).length===size)for(;size--&&(key=keys[size],result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)););}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(null==obj)return!length;obj=new Object(obj);for(var i=0;i<length;i++){var pair=pairs[i],key=pair[0];if(pair[1]!==obj[key]||!(key in obj))return!1}return!0}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property){if(null!=object){var value=object[property];return _.isFunction(value)?object[property]():value}};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result.call(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(window){function sprintf(){var key=arguments[0],cache=sprintf.cache;return cache[key]&&cache.hasOwnProperty(key)||(cache[key]=sprintf.parse(key)),sprintf.format.call(null,cache[key],arguments)}function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}function str_repeat(input,multiplier){return Array(multiplier+1).join(input)}var re={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};sprintf.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,cursor=1,tree_length=parse_tree.length,node_type="",output=[],is_positive=!0,sign="";for(i=0;i<tree_length;i++)if(node_type=get_type(parse_tree[i]),"string"===node_type)output[output.length]=parse_tree[i];else if("array"===node_type){if(match=parse_tree[i],match[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf("[sprintf] property '%s' does not exist",match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if("function"==get_type(arg)&&(arg=arg()),re.not_string.test(match[8])&&re.not_json.test(match[8])&&"number"!=get_type(arg)&&isNaN(arg))throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)));switch(re.number.test(match[8])&&(is_positive=arg>=0),match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":case"i":arg=parseInt(arg,10);break;case"j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"g":arg=match[7]?parseFloat(arg).toPrecision(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg>>>=0;break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}re.json.test(match[8])?output[output.length]=arg:(!re.number.test(match[8])||is_positive&&!match[3]?sign="":(sign=is_positive?"+":"-",arg=arg.toString().replace(re.sign,"")),pad_character=match[4]?"0"===match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-(sign+arg).length,pad=match[6]&&pad_length>0?str_repeat(pad_character,pad_length):"",output[output.length]=match[5]?sign+arg+pad:"0"===pad_character?sign+pad+arg:pad+sign+arg)}return output.join("")},sprintf.cache={},sprintf.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=re.text.exec(_fmt)))parse_tree[parse_tree.length]=match[0];else if(null!==(match=re.modulo.exec(_fmt)))parse_tree[parse_tree.length]="%";else{if(null===(match=re.placeholder.exec(_fmt)))throw new SyntaxError("[sprintf] unexpected placeholder");if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=re.key.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(field_list[field_list.length]=field_match[1];""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=re.key_access.exec(replacement_field)))field_list[field_list.length]=field_match[1];else{if(null===(field_match=re.index_access.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");field_list[field_list.length]=field_match[1]}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree[parse_tree.length]=match}_fmt=_fmt.substring(match[0].length)}return parse_tree};var vsprintf=function(fmt,argv,_argv){return _argv=(argv||[]).slice(0),_argv.splice(0,0,fmt),sprintf.apply(null,_argv)};"undefined"!=typeof exports?(exports.sprintf=sprintf,exports.vsprintf=vsprintf):(window.sprintf=sprintf,window.vsprintf=vsprintf,"function"==typeof define&&define.amd&&define(function(){return{sprintf:sprintf,vsprintf:vsprintf}}))}("undefined"==typeof window?this:window),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),
angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function($q,$timeout,$rootScope){function findEndEventName(endEventNames){for(var name in endEventNames)if(void 0!==transElement.style[name])return endEventNames[name]}var $transition=function(element,trigger,options){options=options||{};var deferred=$q.defer(),endEventName=$transition[options.animation?"animationEndEventName":"transitionEndEventName"],transitionEndHandler=function(event){$rootScope.$apply(function(){element.unbind(endEventName,transitionEndHandler),deferred.resolve(element)})};return endEventName&&element.bind(endEventName,transitionEndHandler),$timeout(function(){angular.isString(trigger)?element.addClass(trigger):angular.isFunction(trigger)?trigger(element):angular.isObject(trigger)&&element.css(trigger),endEventName||deferred.resolve(element)}),deferred.promise.cancel=function(){endEventName&&element.unbind(endEventName,transitionEndHandler),deferred.reject("Transition cancelled")},deferred.promise},transElement=document.createElement("trans"),transitionEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},animationEndEventNames={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return $transition.transitionEndEventName=findEndEventName(transitionEndEventNames),$transition.animationEndEventName=findEndEventName(animationEndEventNames),$transition}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function($transition){return{link:function(scope,element,attrs){function doTransition(change){function newTransitionDone(){currentTransition===newTransition&&(currentTransition=void 0)}var newTransition=$transition(element,change);return currentTransition&&currentTransition.cancel(),currentTransition=newTransition,newTransition.then(newTransitionDone,newTransitionDone),newTransition}function expand(){initialAnimSkip?(initialAnimSkip=!1,expandDone()):(element.removeClass("collapse").addClass("collapsing"),doTransition({height:element[0].scrollHeight+"px"}).then(expandDone))}function expandDone(){element.removeClass("collapsing"),element.addClass("collapse in"),element.css({height:"auto"})}function collapse(){if(initialAnimSkip)initialAnimSkip=!1,collapseDone(),element.css({height:0});else{element.css({height:element[0].scrollHeight+"px"});element[0].offsetWidth;element.removeClass("collapse in").addClass("collapsing"),doTransition({height:0}).then(collapseDone)}}function collapseDone(){element.removeClass("collapsing"),element.addClass("collapse")}var currentTransition,initialAnimSkip=!0;scope.$watch(attrs.collapse,function(shouldCollapse){shouldCollapse?collapse():expand()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function($scope,$attrs,accordionConfig){this.groups=[],this.closeOthers=function(openGroup){var closeOthers=angular.isDefined($attrs.closeOthers)?$scope.$eval($attrs.closeOthers):accordionConfig.closeOthers;closeOthers&&angular.forEach(this.groups,function(group){group!==openGroup&&(group.isOpen=!1)})},this.addGroup=function(groupScope){var that=this;this.groups.push(groupScope),groupScope.$on("$destroy",function(event){that.removeGroup(groupScope)})},this.removeGroup=function(group){var index=this.groups.indexOf(group);index!==-1&&this.groups.splice(index,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(element){this.heading=element}},link:function(scope,element,attrs,accordionCtrl){accordionCtrl.addGroup(scope),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope)}),scope.toggleOpen=function(){scope.isDisabled||(scope.isOpen=!scope.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(scope,element,attr,accordionGroupCtrl,transclude){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.accordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function($scope,$attrs){$scope.closeable="close"in $attrs,this.close=$scope.close}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}).directive("dismissOnTimeout",["$timeout",function($timeout){return{require:"alert",link:function(scope,element,attrs,alertCtrl){$timeout(function(){alertCtrl.close()},parseInt(attrs.dismissOnTimeout,10))}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.bindHtmlUnsafe),scope.$watch(attr.bindHtmlUnsafe,function(value){element.html(value||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(buttonConfig){this.activeClass=buttonConfig.activeClass||"active",this.toggleEvent=buttonConfig.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,scope.$eval(attrs.btnRadio)))},element.bind(buttonsCtrl.toggleEvent,function(){var isActive=element.hasClass(buttonsCtrl.activeClass);isActive&&!angular.isDefined(attrs.uncheckable)||scope.$apply(function(){ngModelCtrl.$setViewValue(isActive?null:scope.$eval(attrs.btnRadio)),ngModelCtrl.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){function getTrueValue(){return getCheckboxValue(attrs.btnCheckboxTrue,!0)}function getFalseValue(){return getCheckboxValue(attrs.btnCheckboxFalse,!1)}function getCheckboxValue(attributeValue,defaultValue){var val=scope.$eval(attributeValue);return angular.isDefined(val)?val:defaultValue}var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,getTrueValue()))},element.bind(buttonsCtrl.toggleEvent,function(){scope.$apply(function(){ngModelCtrl.$setViewValue(element.hasClass(buttonsCtrl.activeClass)?getFalseValue():getTrueValue()),ngModelCtrl.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$interval","$transition",function($scope,$timeout,$interval,$transition){function restartTimer(){resetTimer();var interval=+$scope.interval;!isNaN(interval)&&interval>0&&(currentInterval=$interval(timerFn,interval))}function resetTimer(){currentInterval&&($interval.cancel(currentInterval),currentInterval=null)}function timerFn(){var interval=+$scope.interval;isPlaying&&!isNaN(interval)&&interval>0?$scope.next():$scope.pause()}var currentInterval,isPlaying,self=this,slides=self.slides=$scope.slides=[],currentIndex=-1;self.currentSlide=null;var destroyed=!1;self.select=$scope.select=function(nextSlide,direction){function goNext(){if(!destroyed){if(self.currentSlide&&angular.isString(direction)&&!$scope.noTransition&&nextSlide.$element){nextSlide.$element.addClass(direction);nextSlide.$element[0].offsetWidth;angular.forEach(slides,function(slide){angular.extend(slide,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(nextSlide,{direction:direction,active:!0,entering:!0}),angular.extend(self.currentSlide||{},{direction:direction,leaving:!0}),$scope.$currentTransition=$transition(nextSlide.$element,{}),function(next,current){$scope.$currentTransition.then(function(){transitionDone(next,current)},function(){transitionDone(next,current)})}(nextSlide,self.currentSlide)}else transitionDone(nextSlide,self.currentSlide);self.currentSlide=nextSlide,currentIndex=nextIndex,restartTimer()}}function transitionDone(next,current){angular.extend(next,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(current||{},{direction:"",active:!1,leaving:!1,entering:!1}),$scope.$currentTransition=null}var nextIndex=slides.indexOf(nextSlide);void 0===direction&&(direction=nextIndex>currentIndex?"next":"prev"),nextSlide&&nextSlide!==self.currentSlide&&($scope.$currentTransition?($scope.$currentTransition.cancel(),$timeout(goNext)):goNext())},$scope.$on("$destroy",function(){destroyed=!0}),self.indexOfSlide=function(slide){return slides.indexOf(slide)},$scope.next=function(){var newIndex=(currentIndex+1)%slides.length;if(!$scope.$currentTransition)return self.select(slides[newIndex],"next")},$scope.prev=function(){var newIndex=currentIndex-1<0?slides.length-1:currentIndex-1;if(!$scope.$currentTransition)return self.select(slides[newIndex],"prev")},$scope.isActive=function(slide){return self.currentSlide===slide},$scope.$watch("interval",restartTimer),$scope.$on("$destroy",resetTimer),$scope.play=function(){isPlaying||(isPlaying=!0,restartTimer())},$scope.pause=function(){$scope.noPause||(isPlaying=!1,resetTimer())},self.addSlide=function(slide,element){slide.$element=element,slides.push(slide),1===slides.length||slide.active?(self.select(slides[slides.length-1]),1==slides.length&&$scope.play()):slide.active=!1},self.removeSlide=function(slide){var index=slides.indexOf(slide);slides.splice(index,1),slides.length>0&&slide.active?index>=slides.length?self.select(slides[index-1]):self.select(slides[index]):currentIndex>index&&currentIndex--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(scope,element,attrs,carouselCtrl){carouselCtrl.addSlide(scope,element),scope.$on("$destroy",function(){carouselCtrl.removeSlide(scope)}),scope.$watch("active",function(active){active&&carouselCtrl.select(scope)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function($locale,orderByFilter){function createParser(format){var map=[],regex=format.split("");return angular.forEach(formatCodeToRegex,function(data,code){var index=format.indexOf(code);if(index>-1){format=format.split(""),regex[index]="("+data.regex+")",format[index]="$";for(var i=index+1,n=index+code.length;i<n;i++)regex[i]="",format[i]="$";format=format.join(""),map.push({index:index,apply:data.apply})}}),{regex:new RegExp("^"+regex.join("")+"$"),map:orderByFilter(map,"index")}}function isValid(year,month,date){return 1===month&&date>28?29===date&&(year%4===0&&year%100!==0||year%400===0):3!==month&&5!==month&&8!==month&&10!==month||date<31}this.parsers={};var formatCodeToRegex={yyyy:{regex:"\\d{4}",apply:function(value){this.year=+value}},yy:{regex:"\\d{2}",apply:function(value){this.year=+value+2e3}},y:{regex:"\\d{1,4}",apply:function(value){this.year=+value}},MMMM:{regex:$locale.DATETIME_FORMATS.MONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.MONTH.indexOf(value)}},MMM:{regex:$locale.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.SHORTMONTH.indexOf(value)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(value){this.month=value-1}},M:{regex:"[1-9]|1[0-2]",apply:function(value){this.month=value-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},EEEE:{regex:$locale.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:$locale.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(input,format){if(!angular.isString(input)||!format)return input;format=$locale.DATETIME_FORMATS[format]||format,this.parsers[format]||(this.parsers[format]=createParser(format));var parser=this.parsers[format],regex=parser.regex,map=parser.map,results=input.match(regex);if(results&&results.length){for(var dt,fields={year:1900,month:0,date:1,hours:0},i=1,n=results.length;i<n;i++){var mapper=map[i-1];mapper.apply&&mapper.apply.call(fields,results[i])}return isValid(fields.year,fields.month,fields.date)&&(dt=new Date(fields.year,fields.month,fields.date,fields.hours)),dt}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);offsetParentEl!=$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft);var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody){var hostElPos,targetElWidth,targetElHeight,targetElPos,positionStrParts=positionStr.split("-"),pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";hostElPos=appendToBody?this.offset(hostEl):this.position(hostEl),targetElWidth=targetEl.prop("offsetWidth"),targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}},shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()}}return targetElPos}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!1,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function($scope,$attrs,$parse,$interpolate,$timeout,$log,dateFilter,datepickerConfig){var self=this,ngModelCtrl={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(key,index){self[key]=angular.isDefined($attrs[key])?index<8?$interpolate($attrs[key])($scope.$parent):$scope.$parent.$eval($attrs[key]):datepickerConfig[key]}),angular.forEach(["minDate","maxDate"],function(key){$attrs[key]?$scope.$parent.$watch($parse($attrs[key]),function(value){self[key]=value?new Date(value):null,self.refreshView()}):self[key]=datepickerConfig[key]?new Date(datepickerConfig[key]):null}),$scope.datepickerMode=$scope.datepickerMode||datepickerConfig.datepickerMode,$scope.uniqueId="datepicker-"+$scope.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined($attrs.initDate)?$scope.$parent.$eval($attrs.initDate):new Date,$scope.isActive=function(dateObject){return 0===self.compare(dateObject.date,self.activeDate)&&($scope.activeDateId=dateObject.uid,!0)},this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=function(){self.render()}},this.render=function(){if(ngModelCtrl.$modelValue){var date=new Date(ngModelCtrl.$modelValue),isValid=!isNaN(date);isValid?this.activeDate=date:$log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),ngModelCtrl.$setValidity("date",isValid)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;ngModelCtrl.$setValidity("date-disabled",!date||this.element&&!this.isDisabled(date))}},this.createDateObject=function(date,format){var model=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;return{date:date,label:dateFilter(date,format),selected:model&&0===this.compare(date,model),disabled:this.isDisabled(date),current:0===this.compare(date,new Date)}},this.isDisabled=function(date){return this.minDate&&this.compare(date,this.minDate)<0||this.maxDate&&this.compare(date,this.maxDate)>0||$attrs.dateDisabled&&$scope.dateDisabled({date:date,mode:$scope.datepickerMode})},this.split=function(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays},$scope.select=function(date){if($scope.datepickerMode===self.minMode){var dt=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):new Date(0,0,0,0,0,0,0);dt.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),ngModelCtrl.$setViewValue(dt),ngModelCtrl.$render()}else self.activeDate=date,$scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)-1]},$scope.move=function(direction){var year=self.activeDate.getFullYear()+direction*(self.step.years||0),month=self.activeDate.getMonth()+direction*(self.step.months||0);self.activeDate.setFullYear(year,month,1),self.refreshView()},$scope.toggleMode=function(direction){direction=direction||1,$scope.datepickerMode===self.maxMode&&1===direction||$scope.datepickerMode===self.minMode&&direction===-1||($scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)+direction])},$scope.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var focusElement=function(){$timeout(function(){self.element[0].focus()},0,!1)};$scope.$on("datepicker.focus",focusElement),$scope.keydown=function(evt){var key=$scope.keys[evt.which];if(key&&!evt.shiftKey&&!evt.altKey)if(evt.preventDefault(),evt.stopPropagation(),"enter"===key||"space"===key){if(self.isDisabled(self.activeDate))return;$scope.select(self.activeDate),focusElement()}else!evt.ctrlKey||"up"!==key&&"down"!==key?(self.handleKeyDown(key,evt),self.refreshView()):($scope.toggleMode("up"===key?1:-1),focusElement())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(scope,element,attrs,ctrls){var datepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&datepickerCtrl.init(ngModelCtrl)}}}).directive("daypicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getDaysInMonth(year,month){return 1!==month||year%4!==0||year%100===0&&year%400!==0?DAYS_IN_MONTH[month]:29}function getDates(startDate,n){var dates=new Array(n),current=new Date(startDate),i=0;for(current.setHours(12);i<n;)dates[i++]=new Date(current),current.setDate(current.getDate()+1);return dates}function getISO8601WeekNumber(date){var checkDate=new Date(date);checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();return checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1}scope.showWeeks=ctrl.showWeeks,ctrl.step={months:1},ctrl.element=element;var DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ctrl._refreshView=function(){var year=ctrl.activeDate.getFullYear(),month=ctrl.activeDate.getMonth(),firstDayOfMonth=new Date(year,month,1),difference=ctrl.startingDay-firstDayOfMonth.getDay(),numDisplayedFromPreviousMonth=difference>0?7-difference:-difference,firstDate=new Date(firstDayOfMonth);numDisplayedFromPreviousMonth>0&&firstDate.setDate(-numDisplayedFromPreviousMonth+1);for(var days=getDates(firstDate,42),i=0;i<42;i++)days[i]=angular.extend(ctrl.createDateObject(days[i],ctrl.formatDay),{secondary:days[i].getMonth()!==month,uid:scope.uniqueId+"-"+i});scope.labels=new Array(7);for(var j=0;j<7;j++)scope.labels[j]={abbr:dateFilter(days[j].date,ctrl.formatDayHeader),full:dateFilter(days[j].date,"EEEE")};if(scope.title=dateFilter(ctrl.activeDate,ctrl.formatDayTitle),scope.rows=ctrl.split(days,7),scope.showWeeks){scope.weekNumbers=[];for(var weekNumber=getISO8601WeekNumber(scope.rows[0][0].date),numWeeks=scope.rows.length;scope.weekNumbers.push(weekNumber++)<numWeeks;);}},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth(),date1.getDate())-new Date(date2.getFullYear(),date2.getMonth(),date2.getDate())},ctrl.handleKeyDown=function(key,evt){var date=ctrl.activeDate.getDate();if("left"===key)date-=1;else if("up"===key)date-=7;else if("right"===key)date+=1;else if("down"===key)date+=7;else if("pageup"===key||"pagedown"===key){var month=ctrl.activeDate.getMonth()+("pageup"===key?-1:1);ctrl.activeDate.setMonth(month,1),date=Math.min(getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()),date)}else"home"===key?date=1:"end"===key&&(date=getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()));ctrl.activeDate.setDate(date)},ctrl.refreshView()}}}]).directive("monthpicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){ctrl.step={years:1},ctrl.element=element,ctrl._refreshView=function(){for(var months=new Array(12),year=ctrl.activeDate.getFullYear(),i=0;i<12;i++)months[i]=angular.extend(ctrl.createDateObject(new Date(year,i,1),ctrl.formatMonth),{uid:scope.uniqueId+"-"+i});scope.title=dateFilter(ctrl.activeDate,ctrl.formatMonthTitle),scope.rows=ctrl.split(months,3)},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth())-new Date(date2.getFullYear(),date2.getMonth())},ctrl.handleKeyDown=function(key,evt){var date=ctrl.activeDate.getMonth();if("left"===key)date-=1;else if("up"===key)date-=3;else if("right"===key)date+=1;else if("down"===key)date+=3;else if("pageup"===key||"pagedown"===key){var year=ctrl.activeDate.getFullYear()+("pageup"===key?-1:1);ctrl.activeDate.setFullYear(year)}else"home"===key?date=0:"end"===key&&(date=11);ctrl.activeDate.setMonth(date)},ctrl.refreshView()}}}]).directive("yearpicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getStartingYear(year){return parseInt((year-1)/range,10)*range+1}var range=ctrl.yearRange;ctrl.step={years:range},ctrl.element=element,ctrl._refreshView=function(){for(var years=new Array(range),i=0,start=getStartingYear(ctrl.activeDate.getFullYear());i<range;i++)years[i]=angular.extend(ctrl.createDateObject(new Date(start+i,0,1),ctrl.formatYear),{uid:scope.uniqueId+"-"+i});scope.title=[years[0].label,years[range-1].label].join(" - "),scope.rows=ctrl.split(years,5)},ctrl.compare=function(date1,date2){return date1.getFullYear()-date2.getFullYear()},ctrl.handleKeyDown=function(key,evt){var date=ctrl.activeDate.getFullYear();"left"===key?date-=1:"up"===key?date-=5:"right"===key?date+=1:"down"===key?date+=5:"pageup"===key||"pagedown"===key?date+=("pageup"===key?-1:1)*ctrl.step.years:"home"===key?date=getStartingYear(ctrl.activeDate.getFullYear()):"end"===key&&(date=getStartingYear(ctrl.activeDate.getFullYear())+range-1),ctrl.activeDate.setFullYear(date)},ctrl.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function($compile,$parse,$document,$position,dateFilter,dateParser,datepickerPopupConfig){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(scope,element,attrs,ngModel){function cameltoDash(string){return string.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function parseDate(viewValue){if(viewValue){if(angular.isDate(viewValue)&&!isNaN(viewValue))return ngModel.$setValidity("date",!0),viewValue;if(angular.isString(viewValue)){var date=dateParser.parse(viewValue,dateFormat)||new Date(viewValue);return isNaN(date)?void ngModel.$setValidity("date",!1):(ngModel.$setValidity("date",!0),date)}return void ngModel.$setValidity("date",!1)}return ngModel.$setValidity("date",!0),null}var dateFormat,closeOnDateSelection=angular.isDefined(attrs.closeOnDateSelection)?scope.$parent.$eval(attrs.closeOnDateSelection):datepickerPopupConfig.closeOnDateSelection,appendToBody=angular.isDefined(attrs.datepickerAppendToBody)?scope.$parent.$eval(attrs.datepickerAppendToBody):datepickerPopupConfig.appendToBody;scope.showButtonBar=angular.isDefined(attrs.showButtonBar)?scope.$parent.$eval(attrs.showButtonBar):datepickerPopupConfig.showButtonBar,scope.getText=function(key){return scope[key+"Text"]||datepickerPopupConfig[key+"Text"]},attrs.$observe("datepickerPopup",function(value){dateFormat=value||datepickerPopupConfig.datepickerPopup,ngModel.$render()});var popupEl=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");popupEl.attr({"ng-model":"date","ng-change":"dateSelection()"});var datepickerEl=angular.element(popupEl.children()[0]);attrs.datepickerOptions&&angular.forEach(scope.$parent.$eval(attrs.datepickerOptions),function(value,option){datepickerEl.attr(cameltoDash(option),value)}),scope.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(key){if(attrs[key]){var getAttribute=$parse(attrs[key]);if(scope.$parent.$watch(getAttribute,function(value){scope.watchData[key]=value}),datepickerEl.attr(cameltoDash(key),"watchData."+key),"datepickerMode"===key){var setAttribute=getAttribute.assign;scope.$watch("watchData."+key,function(value,oldvalue){value!==oldvalue&&setAttribute(scope.$parent,value)})}}}),attrs.dateDisabled&&datepickerEl.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),ngModel.$parsers.unshift(parseDate),scope.dateSelection=function(dt){angular.isDefined(dt)&&(scope.date=dt),ngModel.$setViewValue(scope.date),ngModel.$render(),closeOnDateSelection&&(scope.isOpen=!1,element[0].focus())},element.bind("input change keyup",function(){scope.$apply(function(){scope.date=ngModel.$modelValue})}),ngModel.$render=function(){var date=ngModel.$viewValue?dateFilter(ngModel.$viewValue,dateFormat):"";element.val(date),scope.date=parseDate(ngModel.$modelValue)};var documentClickBind=function(event){scope.isOpen&&event.target!==element[0]&&scope.$apply(function(){scope.isOpen=!1})},keydown=function(evt,noApply){scope.keydown(evt)};element.bind("keydown",keydown),scope.keydown=function(evt){27===evt.which?(evt.preventDefault(),evt.stopPropagation(),scope.close()):40!==evt.which||scope.isOpen||(scope.isOpen=!0)},scope.$watch("isOpen",function(value){value?(scope.$broadcast("datepicker.focus"),scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),$document.bind("click",documentClickBind)):$document.unbind("click",documentClickBind)}),scope.select=function(date){if("today"===date){var today=new Date;angular.isDate(ngModel.$modelValue)?(date=new Date(ngModel.$modelValue),date.setFullYear(today.getFullYear(),today.getMonth(),today.getDate())):date=new Date(today.setHours(0,0,0,0))}scope.dateSelection(date)},scope.close=function(){scope.isOpen=!1,element[0].focus()};var $popup=$compile(popupEl)(scope);popupEl.remove(),appendToBody?$document.find("body").append($popup):element.after($popup),scope.$on("$destroy",function(){$popup.remove(),element.unbind("keydown",keydown),$document.unbind("click",documentClickBind)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(scope,element,attrs){element.bind("click",function(event){event.preventDefault(),event.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function($document){var openScope=null;this.open=function(dropdownScope){openScope||($document.bind("click",closeDropdown),$document.bind("keydown",escapeKeyBind)),openScope&&openScope!==dropdownScope&&(openScope.isOpen=!1),openScope=dropdownScope},this.close=function(dropdownScope){openScope===dropdownScope&&(openScope=null,$document.unbind("click",closeDropdown),$document.unbind("keydown",escapeKeyBind));
};var closeDropdown=function(evt){if(openScope){var toggleElement=openScope.getToggleElement();evt&&toggleElement&&toggleElement[0].contains(evt.target)||openScope.$apply(function(){openScope.isOpen=!1})}},escapeKeyBind=function(evt){27===evt.which&&(openScope.focusToggleElement(),closeDropdown())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function($scope,$attrs,$parse,dropdownConfig,dropdownService,$animate){var getIsOpen,self=this,scope=$scope.$new(),openClass=dropdownConfig.openClass,setIsOpen=angular.noop,toggleInvoker=$attrs.onToggle?$parse($attrs.onToggle):angular.noop;this.init=function(element){self.$element=element,$attrs.isOpen&&(getIsOpen=$parse($attrs.isOpen),setIsOpen=getIsOpen.assign,$scope.$watch(getIsOpen,function(value){scope.isOpen=!!value}))},this.toggle=function(open){return scope.isOpen=arguments.length?!!open:!scope.isOpen},this.isOpen=function(){return scope.isOpen},scope.getToggleElement=function(){return self.toggleElement},scope.focusToggleElement=function(){self.toggleElement&&self.toggleElement[0].focus()},scope.$watch("isOpen",function(isOpen,wasOpen){$animate[isOpen?"addClass":"removeClass"](self.$element,openClass),isOpen?(scope.focusToggleElement(),dropdownService.open(scope)):dropdownService.close(scope),setIsOpen($scope,isOpen),angular.isDefined(isOpen)&&isOpen!==wasOpen&&toggleInvoker($scope,{open:!!isOpen})}),$scope.$on("$locationChangeSuccess",function(){scope.isOpen=!1}),$scope.$on("$destroy",function(){scope.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(scope,element,attrs,dropdownCtrl){dropdownCtrl.init(element)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(scope,element,attrs,dropdownCtrl){if(dropdownCtrl){dropdownCtrl.toggleElement=element;var toggleDropdown=function(event){event.preventDefault(),element.hasClass("disabled")||attrs.disabled||scope.$apply(function(){dropdownCtrl.toggle()})};element.bind("click",toggleDropdown),element.attr({"aria-haspopup":!0,"aria-expanded":!1}),scope.$watch(dropdownCtrl.isOpen,function(isOpen){element.attr("aria-expanded",!!isOpen)}),scope.$on("$destroy",function(){element.unbind("click",toggleDropdown)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var stack=[];return{add:function(key,value){stack.push({key:key,value:value})},get:function(key){for(var i=0;i<stack.length;i++)if(key==stack[i].key)return stack[i]},keys:function(){for(var keys=[],i=0;i<stack.length;i++)keys.push(stack[i].key);return keys},top:function(){return stack[stack.length-1]},remove:function(key){for(var idx=-1,i=0;i<stack.length;i++)if(key==stack[i].key){idx=i;break}return stack.splice(idx,1)[0]},removeTop:function(){return stack.splice(stack.length-1,1)[0]},length:function(){return stack.length}}}}}).directive("modalBackdrop",["$timeout",function($timeout){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(scope,element,attrs){scope.backdropClass=attrs.backdropClass||"",scope.animate=!1,$timeout(function(){scope.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function($modalStack,$timeout){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(tElement,tAttrs){return tAttrs.templateUrl||"template/modal/window.html"},link:function(scope,element,attrs){element.addClass(attrs.windowClass||""),scope.size=attrs.size,$timeout(function(){scope.animate=!0,element[0].querySelectorAll("[autofocus]").length||element[0].focus()}),scope.close=function(evt){var modal=$modalStack.getTop();modal&&modal.value.backdrop&&"static"!=modal.value.backdrop&&evt.target===evt.currentTarget&&(evt.preventDefault(),evt.stopPropagation(),$modalStack.dismiss(modal.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function($scope,$element,$attrs,controller,$transclude){$transclude($scope.$parent,function(clone){$element.empty(),$element.append(clone)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function($transition,$timeout,$document,$compile,$rootScope,$$stackedMap){function backdropIndex(){for(var topBackdropIndex=-1,opened=openedWindows.keys(),i=0;i<opened.length;i++)openedWindows.get(opened[i]).value.backdrop&&(topBackdropIndex=i);return topBackdropIndex}function removeModalWindow(modalInstance){var body=$document.find("body").eq(0),modalWindow=openedWindows.get(modalInstance).value;openedWindows.remove(modalInstance),removeAfterAnimate(modalWindow.modalDomEl,modalWindow.modalScope,300,function(){modalWindow.modalScope.$destroy(),body.toggleClass(OPENED_MODAL_CLASS,openedWindows.length()>0),checkRemoveBackdrop()})}function checkRemoveBackdrop(){if(backdropDomEl&&backdropIndex()==-1){var backdropScopeRef=backdropScope;removeAfterAnimate(backdropDomEl,backdropScope,150,function(){backdropScopeRef.$destroy(),backdropScopeRef=null}),backdropDomEl=void 0,backdropScope=void 0}}function removeAfterAnimate(domEl,scope,emulateTime,done){function afterAnimating(){afterAnimating.done||(afterAnimating.done=!0,domEl.remove(),done&&done())}scope.animate=!1;var transitionEndEventName=$transition.transitionEndEventName;if(transitionEndEventName){var timeout=$timeout(afterAnimating,emulateTime);domEl.bind(transitionEndEventName,function(){$timeout.cancel(timeout),afterAnimating(),scope.$apply()})}else $timeout(afterAnimating)}var backdropDomEl,backdropScope,OPENED_MODAL_CLASS="modal-open",openedWindows=$$stackedMap.createNew(),$modalStack={};return $rootScope.$watch(backdropIndex,function(newBackdropIndex){backdropScope&&(backdropScope.index=newBackdropIndex)}),$document.bind("keydown",function(evt){var modal;27===evt.which&&(modal=openedWindows.top(),modal&&modal.value.keyboard&&(evt.preventDefault(),$rootScope.$apply(function(){$modalStack.dismiss(modal.key,"escape key press")})))}),$modalStack.open=function(modalInstance,modal){openedWindows.add(modalInstance,{deferred:modal.deferred,modalScope:modal.scope,backdrop:modal.backdrop,keyboard:modal.keyboard});var body=$document.find("body").eq(0),currBackdropIndex=backdropIndex();if(currBackdropIndex>=0&&!backdropDomEl){backdropScope=$rootScope.$new(!0),backdropScope.index=currBackdropIndex;var angularBackgroundDomEl=angular.element("<div modal-backdrop></div>");angularBackgroundDomEl.attr("backdrop-class",modal.backdropClass),backdropDomEl=$compile(angularBackgroundDomEl)(backdropScope),body.append(backdropDomEl)}var angularDomEl=angular.element("<div modal-window></div>");angularDomEl.attr({"template-url":modal.windowTemplateUrl,"window-class":modal.windowClass,size:modal.size,index:openedWindows.length()-1,animate:"animate"}).html(modal.content);var modalDomEl=$compile(angularDomEl)(modal.scope);openedWindows.top().value.modalDomEl=modalDomEl,body.append(modalDomEl),body.addClass(OPENED_MODAL_CLASS)},$modalStack.close=function(modalInstance,result){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.resolve(result),removeModalWindow(modalInstance))},$modalStack.dismiss=function(modalInstance,reason){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.reject(reason),removeModalWindow(modalInstance))},$modalStack.dismissAll=function(reason){for(var topModal=this.getTop();topModal;)this.dismiss(topModal.key,reason),topModal=this.getTop()},$modalStack.getTop=function(){return openedWindows.top()},$modalStack}]).provider("$modal",function(){var $modalProvider={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function($injector,$rootScope,$q,$http,$templateCache,$controller,$modalStack){function getTemplatePromise(options){return options.template?$q.when(options.template):$http.get(angular.isFunction(options.templateUrl)?options.templateUrl():options.templateUrl,{cache:$templateCache}).then(function(result){return result.data})}function getResolvePromises(resolves){var promisesArr=[];return angular.forEach(resolves,function(value){(angular.isFunction(value)||angular.isArray(value))&&promisesArr.push($q.when($injector.invoke(value)))}),promisesArr}var $modal={};return $modal.open=function(modalOptions){var modalResultDeferred=$q.defer(),modalOpenedDeferred=$q.defer(),modalInstance={result:modalResultDeferred.promise,opened:modalOpenedDeferred.promise,close:function(result){$modalStack.close(modalInstance,result)},dismiss:function(reason){$modalStack.dismiss(modalInstance,reason)}};if(modalOptions=angular.extend({},$modalProvider.options,modalOptions),modalOptions.resolve=modalOptions.resolve||{},!modalOptions.template&&!modalOptions.templateUrl)throw new Error("One of template or templateUrl options is required.");var templateAndResolvePromise=$q.all([getTemplatePromise(modalOptions)].concat(getResolvePromises(modalOptions.resolve)));return templateAndResolvePromise.then(function(tplAndVars){var modalScope=(modalOptions.scope||$rootScope).$new();modalScope.$close=modalInstance.close,modalScope.$dismiss=modalInstance.dismiss;var ctrlInstance,ctrlLocals={},resolveIter=1;modalOptions.controller&&(ctrlLocals.$scope=modalScope,ctrlLocals.$modalInstance=modalInstance,angular.forEach(modalOptions.resolve,function(value,key){ctrlLocals[key]=tplAndVars[resolveIter++]}),ctrlInstance=$controller(modalOptions.controller,ctrlLocals),modalOptions.controllerAs&&(modalScope[modalOptions.controllerAs]=ctrlInstance)),$modalStack.open(modalInstance,{scope:modalScope,deferred:modalResultDeferred,content:tplAndVars[0],backdrop:modalOptions.backdrop,keyboard:modalOptions.keyboard,backdropClass:modalOptions.backdropClass,windowClass:modalOptions.windowClass,windowTemplateUrl:modalOptions.windowTemplateUrl,size:modalOptions.size})},function(reason){modalResultDeferred.reject(reason)}),templateAndResolvePromise.then(function(){modalOpenedDeferred.resolve(!0)},function(){modalOpenedDeferred.reject(!1)}),modalInstance},$modal}]};return $modalProvider}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function($scope,$attrs,$parse){var self=this,ngModelCtrl={$setViewValue:angular.noop},setNumPages=$attrs.numPages?$parse($attrs.numPages).assign:angular.noop;this.init=function(ngModelCtrl_,config){ngModelCtrl=ngModelCtrl_,this.config=config,ngModelCtrl.$render=function(){self.render()},$attrs.itemsPerPage?$scope.$parent.$watch($parse($attrs.itemsPerPage),function(value){self.itemsPerPage=parseInt(value,10),$scope.totalPages=self.calculateTotalPages()}):this.itemsPerPage=config.itemsPerPage},this.calculateTotalPages=function(){var totalPages=this.itemsPerPage<1?1:Math.ceil($scope.totalItems/this.itemsPerPage);return Math.max(totalPages||0,1)},this.render=function(){$scope.page=parseInt(ngModelCtrl.$viewValue,10)||1},$scope.selectPage=function(page){$scope.page!==page&&page>0&&page<=$scope.totalPages&&(ngModelCtrl.$setViewValue(page),ngModelCtrl.$render())},$scope.getText=function(key){return $scope[key+"Text"]||self.config[key+"Text"]},$scope.noPrevious=function(){return 1===$scope.page},$scope.noNext=function(){return $scope.page===$scope.totalPages},$scope.$watch("totalItems",function(){$scope.totalPages=self.calculateTotalPages()}),$scope.$watch("totalPages",function(value){setNumPages($scope.$parent,value),$scope.page>value?$scope.selectPage(value):ngModelCtrl.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function($parse,paginationConfig){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(scope,element,attrs,ctrls){function makePage(number,text,isActive){return{number:number,text:text,active:isActive}}function getPages(currentPage,totalPages){var pages=[],startPage=1,endPage=totalPages,isMaxSized=angular.isDefined(maxSize)&&maxSize<totalPages;isMaxSized&&(rotate?(startPage=Math.max(currentPage-Math.floor(maxSize/2),1),endPage=startPage+maxSize-1,endPage>totalPages&&(endPage=totalPages,startPage=endPage-maxSize+1)):(startPage=(Math.ceil(currentPage/maxSize)-1)*maxSize+1,endPage=Math.min(startPage+maxSize-1,totalPages)));for(var number=startPage;number<=endPage;number++){var page=makePage(number,number,number===currentPage);pages.push(page)}if(isMaxSized&&!rotate){if(startPage>1){var previousPageSet=makePage(startPage-1,"...",!1);pages.unshift(previousPageSet)}if(endPage<totalPages){var nextPageSet=makePage(endPage+1,"...",!1);pages.push(nextPageSet)}}return pages}var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];if(ngModelCtrl){var maxSize=angular.isDefined(attrs.maxSize)?scope.$parent.$eval(attrs.maxSize):paginationConfig.maxSize,rotate=angular.isDefined(attrs.rotate)?scope.$parent.$eval(attrs.rotate):paginationConfig.rotate;scope.boundaryLinks=angular.isDefined(attrs.boundaryLinks)?scope.$parent.$eval(attrs.boundaryLinks):paginationConfig.boundaryLinks,scope.directionLinks=angular.isDefined(attrs.directionLinks)?scope.$parent.$eval(attrs.directionLinks):paginationConfig.directionLinks,paginationCtrl.init(ngModelCtrl,paginationConfig),attrs.maxSize&&scope.$parent.$watch($parse(attrs.maxSize),function(value){maxSize=parseInt(value,10),paginationCtrl.render()});var originalRender=paginationCtrl.render;paginationCtrl.render=function(){originalRender(),scope.page>0&&scope.page<=scope.totalPages&&(scope.pages=getPages(scope.page,scope.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("pager",["pagerConfig",function(pagerConfig){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(scope,element,attrs,ctrls){var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&(scope.align=angular.isDefined(attrs.align)?scope.$parent.$eval(attrs.align):pagerConfig.align,paginationCtrl.init(ngModelCtrl,pagerConfig))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function snake_case(name){var regexp=/[A-Z]/g,separator="-";return name.replace(regexp,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}var defaultOptions={placement:"top",animation:!0,popupDelay:0},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={};this.options=function(value){angular.extend(globalOptions,value)},this.setTriggers=function(triggers){angular.extend(triggerMap,triggers)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function($window,$compile,$timeout,$document,$position,$interpolate){return function(type,prefix,defaultTriggerShow){function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow,hide=triggerMap[show]||show;return{show:show,hide:hide}}var options=angular.extend({},defaultOptions,globalOptions),directiveName=snake_case(type),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),template="<div "+directiveName+'-popup title="'+startSym+"title"+endSym+'" content="'+startSym+"content"+endSym+'" placement="'+startSym+"placement"+endSym+'" animation="animation" is-open="isOpen"></div>';return{restrict:"EA",compile:function(tElem,tAttrs){var tooltipLinker=$compile(template);return function(scope,element,attrs){function toggleTooltipBind(){ttScope.isOpen?hideTooltipBind():showTooltipBind()}function showTooltipBind(){hasEnableExp&&!scope.$eval(attrs[prefix+"Enable"])||(prepareTooltip(),ttScope.popupDelay?popupTimeout||(popupTimeout=$timeout(show,ttScope.popupDelay,!1),popupTimeout.then(function(reposition){reposition()})):show()())}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){return popupTimeout=null,transitionTimeout&&($timeout.cancel(transitionTimeout),transitionTimeout=null),ttScope.content?(createTooltip(),tooltip.css({top:0,left:0,display:"block"}),appendToBody?$document.find("body").append(tooltip):element.after(tooltip),positionTooltip(),ttScope.isOpen=!0,ttScope.$digest(),positionTooltip):angular.noop}function hide(){ttScope.isOpen=!1,$timeout.cancel(popupTimeout),popupTimeout=null,ttScope.animation?transitionTimeout||(transitionTimeout=$timeout(removeTooltip,500)):removeTooltip()}function createTooltip(){tooltip&&removeTooltip(),tooltipLinkedScope=ttScope.$new(),tooltip=tooltipLinker(tooltipLinkedScope,angular.noop)}function removeTooltip(){transitionTimeout=null,tooltip&&(tooltip.remove(),tooltip=null),tooltipLinkedScope&&(tooltipLinkedScope.$destroy(),tooltipLinkedScope=null)}function prepareTooltip(){prepPlacement(),prepPopupDelay()}function prepPlacement(){var val=attrs[prefix+"Placement"];ttScope.placement=angular.isDefined(val)?val:options.placement}function prepPopupDelay(){var val=attrs[prefix+"PopupDelay"],delay=parseInt(val,10);ttScope.popupDelay=isNaN(delay)?options.popupDelay:delay}function prepTriggers(){var val=attrs[prefix+"Trigger"];unregisterTriggers(),triggers=getTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,toggleTooltipBind):(element.bind(triggers.show,showTooltipBind),element.bind(triggers.hide,hideTooltipBind))}var tooltip,tooltipLinkedScope,transitionTimeout,popupTimeout,appendToBody=!!angular.isDefined(options.appendToBody)&&options.appendToBody,triggers=getTriggers(void 0),hasEnableExp=angular.isDefined(attrs[prefix+"Enable"]),ttScope=scope.$new(!0),positionTooltip=function(){var ttPosition=$position.positionElements(element,tooltip,ttScope.placement,appendToBody);ttPosition.top+="px",ttPosition.left+="px",tooltip.css(ttPosition)};ttScope.isOpen=!1,attrs.$observe(type,function(val){ttScope.content=val,!val&&ttScope.isOpen&&hide()}),attrs.$observe(prefix+"Title",function(val){ttScope.title=val});var unregisterTriggers=function(){element.unbind(triggers.show,showTooltipBind),element.unbind(triggers.hide,hideTooltipBind)};prepTriggers();var animation=scope.$eval(attrs[prefix+"Animation"]);ttScope.animation=angular.isDefined(animation)?!!animation:options.animation;var appendToBodyVal=scope.$eval(attrs[prefix+"AppendToBody"]);appendToBody=angular.isDefined(appendToBodyVal)?appendToBodyVal:appendToBody,appendToBody&&scope.$on("$locationChangeSuccess",function(){ttScope.isOpen&&hide()}),scope.$on("$destroy",function(){$timeout.cancel(transitionTimeout),$timeout.cancel(popupTimeout),unregisterTriggers(),removeTooltip(),ttScope=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function($tooltip){return $tooltip("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function($scope,$attrs,progressConfig){var self=this,animate=angular.isDefined($attrs.animate)?$scope.$parent.$eval($attrs.animate):progressConfig.animate;this.bars=[],$scope.max=angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):progressConfig.max,this.addBar=function(bar,element){animate||element.css({transition:"none"}),this.bars.push(bar),bar.$watch("value",function(value){bar.percent=+(100*value/$scope.max).toFixed(2)}),bar.$on("$destroy",function(){element=null,self.removeBar(bar)})},this.removeBar=function(bar){this.bars.splice(this.bars.indexOf(bar),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,element)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,angular.element(element.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function($scope,$attrs,ratingConfig){var ngModelCtrl={$setViewValue:angular.noop};this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render,this.stateOn=angular.isDefined($attrs.stateOn)?$scope.$parent.$eval($attrs.stateOn):ratingConfig.stateOn,this.stateOff=angular.isDefined($attrs.stateOff)?$scope.$parent.$eval($attrs.stateOff):ratingConfig.stateOff;var ratingStates=angular.isDefined($attrs.ratingStates)?$scope.$parent.$eval($attrs.ratingStates):new Array(angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):ratingConfig.max);$scope.range=this.buildTemplateObjects(ratingStates)},this.buildTemplateObjects=function(states){for(var i=0,n=states.length;i<n;i++)states[i]=angular.extend({index:i},{stateOn:this.stateOn,stateOff:this.stateOff},states[i]);return states},$scope.rate=function(value){!$scope.readonly&&value>=0&&value<=$scope.range.length&&(ngModelCtrl.$setViewValue(value),ngModelCtrl.$render())},$scope.enter=function(value){$scope.readonly||($scope.value=value),$scope.onHover({value:value})},$scope.reset=function(){$scope.value=ngModelCtrl.$viewValue,$scope.onLeave()},$scope.onKeydown=function(evt){/(37|38|39|40)/.test(evt.which)&&(evt.preventDefault(),evt.stopPropagation(),$scope.rate($scope.value+(38===evt.which||39===evt.which?1:-1)))},this.render=function(){$scope.value=ngModelCtrl.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(scope,element,attrs,ctrls){var ratingCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&ratingCtrl.init(ngModelCtrl)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function($scope){var ctrl=this,tabs=ctrl.tabs=$scope.tabs=[];ctrl.select=function(selectedTab){angular.forEach(tabs,function(tab){tab.active&&tab!==selectedTab&&(tab.active=!1,tab.onDeselect())}),selectedTab.active=!0,selectedTab.onSelect()},ctrl.addTab=function(tab){tabs.push(tab),1===tabs.length?tab.active=!0:tab.active&&ctrl.select(tab)},ctrl.removeTab=function(tab){var index=tabs.indexOf(tab);if(tab.active&&tabs.length>1&&!destroyed){var newActiveIndex=index==tabs.length-1?index-1:index+1;ctrl.select(tabs[newActiveIndex])}tabs.splice(index,1)};var destroyed;$scope.$on("$destroy",function(){destroyed=!0})}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(scope,element,attrs){scope.vertical=!!angular.isDefined(attrs.vertical)&&scope.$parent.$eval(attrs.vertical),scope.justified=!!angular.isDefined(attrs.justified)&&scope.$parent.$eval(attrs.justified)}}}).directive("tab",["$parse",function($parse){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(elm,attrs,transclude){return function(scope,elm,attrs,tabsetCtrl){scope.$watch("active",function(active){active&&tabsetCtrl.select(scope)}),scope.disabled=!1,attrs.disabled&&scope.$parent.$watch($parse(attrs.disabled),function(value){scope.disabled=!!value}),scope.select=function(){scope.disabled||(scope.active=!0)},tabsetCtrl.addTab(scope),scope.$on("$destroy",function(){tabsetCtrl.removeTab(scope)}),scope.$transcludeFn=transclude}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(scope,elm,attrs,tabCtrl){scope.$watch("headingElement",function(heading){heading&&(elm.html(""),elm.append(heading))})}}}]).directive("tabContentTransclude",function(){function isTabHeading(node){return node.tagName&&(node.hasAttribute("tab-heading")||node.hasAttribute("data-tab-heading")||"tab-heading"===node.tagName.toLowerCase()||"data-tab-heading"===node.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(scope,elm,attrs){var tab=scope.$eval(attrs.tabContentTransclude);tab.$transcludeFn(tab.$parent,function(contents){angular.forEach(contents,function(node){isTabHeading(node)?tab.headingElement=node:elm.append(node)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function($scope,$attrs,$parse,$log,$locale,timepickerConfig){function getHoursFromTemplate(){var hours=parseInt($scope.hours,10),valid=$scope.showMeridian?hours>0&&hours<13:hours>=0&&hours<24;if(valid)return $scope.showMeridian&&(12===hours&&(hours=0),$scope.meridian===meridians[1]&&(hours+=12)),hours}function getMinutesFromTemplate(){var minutes=parseInt($scope.minutes,10);return minutes>=0&&minutes<60?minutes:void 0}function pad(value){return angular.isDefined(value)&&value.toString().length<2?"0"+value:value}function refresh(keyboardChange){makeValid(),ngModelCtrl.$setViewValue(new Date(selected)),updateTemplate(keyboardChange)}function makeValid(){ngModelCtrl.$setValidity("time",!0),$scope.invalidHours=!1,$scope.invalidMinutes=!1}function updateTemplate(keyboardChange){var hours=selected.getHours(),minutes=selected.getMinutes();$scope.showMeridian&&(hours=0===hours||12===hours?12:hours%12),$scope.hours="h"===keyboardChange?hours:pad(hours),$scope.minutes="m"===keyboardChange?minutes:pad(minutes),$scope.meridian=selected.getHours()<12?meridians[0]:meridians[1]}function addMinutes(minutes){var dt=new Date(selected.getTime()+6e4*minutes);selected.setHours(dt.getHours(),dt.getMinutes()),refresh()}var selected=new Date,ngModelCtrl={$setViewValue:angular.noop},meridians=angular.isDefined($attrs.meridians)?$scope.$parent.$eval($attrs.meridians):timepickerConfig.meridians||$locale.DATETIME_FORMATS.AMPMS;this.init=function(ngModelCtrl_,inputs){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render;var hoursInputEl=inputs.eq(0),minutesInputEl=inputs.eq(1),mousewheel=angular.isDefined($attrs.mousewheel)?$scope.$parent.$eval($attrs.mousewheel):timepickerConfig.mousewheel;mousewheel&&this.setupMousewheelEvents(hoursInputEl,minutesInputEl),$scope.readonlyInput=angular.isDefined($attrs.readonlyInput)?$scope.$parent.$eval($attrs.readonlyInput):timepickerConfig.readonlyInput,this.setupInputEvents(hoursInputEl,minutesInputEl)};var hourStep=timepickerConfig.hourStep;$attrs.hourStep&&$scope.$parent.$watch($parse($attrs.hourStep),function(value){hourStep=parseInt(value,10)});var minuteStep=timepickerConfig.minuteStep;$attrs.minuteStep&&$scope.$parent.$watch($parse($attrs.minuteStep),function(value){minuteStep=parseInt(value,10)}),$scope.showMeridian=timepickerConfig.showMeridian,$attrs.showMeridian&&$scope.$parent.$watch($parse($attrs.showMeridian),function(value){if($scope.showMeridian=!!value,ngModelCtrl.$error.time){var hours=getHoursFromTemplate(),minutes=getMinutesFromTemplate();angular.isDefined(hours)&&angular.isDefined(minutes)&&(selected.setHours(hours),refresh())}else updateTemplate()}),this.setupMousewheelEvents=function(hoursInputEl,minutesInputEl){var isScrollingUp=function(e){e.originalEvent&&(e=e.originalEvent);var delta=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||delta>0};hoursInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementHours():$scope.decrementHours()),e.preventDefault()}),minutesInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementMinutes():$scope.decrementMinutes()),e.preventDefault()})},this.setupInputEvents=function(hoursInputEl,minutesInputEl){if($scope.readonlyInput)return $scope.updateHours=angular.noop,void($scope.updateMinutes=angular.noop);var invalidate=function(invalidHours,invalidMinutes){ngModelCtrl.$setViewValue(null),ngModelCtrl.$setValidity("time",!1),angular.isDefined(invalidHours)&&($scope.invalidHours=invalidHours),angular.isDefined(invalidMinutes)&&($scope.invalidMinutes=invalidMinutes)};$scope.updateHours=function(){var hours=getHoursFromTemplate();angular.isDefined(hours)?(selected.setHours(hours),refresh("h")):invalidate(!0)},hoursInputEl.bind("blur",function(e){!$scope.invalidHours&&$scope.hours<10&&$scope.$apply(function(){$scope.hours=pad($scope.hours)})}),$scope.updateMinutes=function(){var minutes=getMinutesFromTemplate();angular.isDefined(minutes)?(selected.setMinutes(minutes),refresh("m")):invalidate(void 0,!0)},minutesInputEl.bind("blur",function(e){!$scope.invalidMinutes&&$scope.minutes<10&&$scope.$apply(function(){$scope.minutes=pad($scope.minutes)})})},this.render=function(){var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;isNaN(date)?(ngModelCtrl.$setValidity("time",!1),$log.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(date&&(selected=date),makeValid(),updateTemplate())},$scope.incrementHours=function(){addMinutes(60*hourStep)},$scope.decrementHours=function(){addMinutes(60*-hourStep)},$scope.incrementMinutes=function(){addMinutes(minuteStep)},$scope.decrementMinutes=function(){addMinutes(-minuteStep)},$scope.toggleMeridian=function(){addMinutes(720*(selected.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(scope,element,attrs,ctrls){var timepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&timepickerCtrl.init(ngModelCtrl,element.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function($parse){var TYPEAHEAD_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(input){var match=input.match(TYPEAHEAD_REGEXP);if(!match)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+input+'".');return{itemName:match[3],source:$parse(match[4]),viewMapper:$parse(match[2]||match[1]),modelMapper:$parse(match[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function($compile,$parse,$q,$timeout,$document,$position,typeaheadParser){var HOT_KEYS=[9,13,27,38,40];
return{require:"ngModel",link:function(originalScope,element,attrs,modelCtrl){var minSearch=originalScope.$eval(attrs.typeaheadMinLength);minSearch||0===minSearch||(minSearch=1),originalScope.$watch(attrs.typeaheadMinLength,function(newVal){minSearch=newVal||0===newVal?newVal:1}),element.bind("focus",function(evt){hasFocus=!0,0!==minSearch||modelCtrl.$viewValue||$timeout(function(){getMatchesAsync(modelCtrl.$viewValue,evt)},0)});var hasFocus,waitTime=originalScope.$eval(attrs.typeaheadWaitMs)||0,isEditable=originalScope.$eval(attrs.typeaheadEditable)!==!1,isLoadingSetter=$parse(attrs.typeaheadLoading).assign||angular.noop,onSelectCallback=$parse(attrs.typeaheadOnSelect),inputFormatter=attrs.typeaheadInputFormatter?$parse(attrs.typeaheadInputFormatter):void 0,appendToBody=!!attrs.typeaheadAppendToBody&&originalScope.$eval(attrs.typeaheadAppendToBody),focusFirst=originalScope.$eval(attrs.typeaheadFocusFirst)!==!1,$setModelValue=$parse(attrs.ngModel).assign,parserResult=typeaheadParser.parse(attrs.typeahead),scope=originalScope.$new();originalScope.$on("$destroy",function(){scope.$destroy()});var popupId="typeahead-"+scope.$id+"-"+Math.floor(1e4*Math.random());element.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":popupId});var popUpEl=angular.element("<div typeahead-popup></div>");popUpEl.attr({id:popupId,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(attrs.typeaheadTemplateUrl)&&popUpEl.attr("template-url",attrs.typeaheadTemplateUrl);var resetMatches=function(){scope.matches=[],scope.activeIdx=-1,element.attr("aria-expanded",!1)},getMatchId=function(index){return popupId+"-option-"+index};scope.$watch("activeIdx",function(index){index<0?element.removeAttr("aria-activedescendant"):element.attr("aria-activedescendant",getMatchId(index))});var getMatchesAsync=function(inputValue){var locals={$viewValue:inputValue};isLoadingSetter(originalScope,!0),$q.when(parserResult.source(originalScope,locals)).then(function(matches){var onCurrentRequest=inputValue===modelCtrl.$viewValue;if(onCurrentRequest&&hasFocus)if(matches.length>0){scope.activeIdx=focusFirst?0:-1,scope.matches.length=0;for(var i=0;i<matches.length;i++)locals[parserResult.itemName]=matches[i],scope.matches.push({id:getMatchId(i),label:parserResult.viewMapper(scope,locals),model:matches[i]});scope.query=inputValue,scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),element.attr("aria-expanded",!0)}else resetMatches();onCurrentRequest&&isLoadingSetter(originalScope,!1)},function(){resetMatches(),isLoadingSetter(originalScope,!1)})};resetMatches(),scope.query=void 0;var timeoutPromise,scheduleSearchWithTimeout=function(inputValue){timeoutPromise=$timeout(function(){getMatchesAsync(inputValue)},waitTime)},cancelPreviousTimeout=function(){timeoutPromise&&$timeout.cancel(timeoutPromise)};modelCtrl.$parsers.unshift(function(inputValue){return hasFocus=!0,inputValue&&inputValue.length>=minSearch?waitTime>0?(cancelPreviousTimeout(),scheduleSearchWithTimeout(inputValue)):getMatchesAsync(inputValue):(isLoadingSetter(originalScope,!1),cancelPreviousTimeout(),resetMatches()),isEditable?inputValue:inputValue?void modelCtrl.$setValidity("editable",!1):(modelCtrl.$setValidity("editable",!0),inputValue)}),modelCtrl.$formatters.push(function(modelValue){var candidateViewValue,emptyViewValue,locals={};return inputFormatter?(locals.$model=modelValue,inputFormatter(originalScope,locals)):(locals[parserResult.itemName]=modelValue,candidateViewValue=parserResult.viewMapper(originalScope,locals),locals[parserResult.itemName]=void 0,emptyViewValue=parserResult.viewMapper(originalScope,locals),candidateViewValue!==emptyViewValue?candidateViewValue:modelValue)}),scope.select=function(activeIdx){var model,item,locals={};locals[parserResult.itemName]=item=scope.matches[activeIdx].model,model=parserResult.modelMapper(originalScope,locals),$setModelValue(originalScope,model),modelCtrl.$setValidity("editable",!0),onSelectCallback(originalScope,{$item:item,$model:model,$label:parserResult.viewMapper(originalScope,locals)}),resetMatches(),$timeout(function(){element[0].focus()},0,!1)},element.bind("keydown",function(evt){0!==scope.matches.length&&HOT_KEYS.indexOf(evt.which)!==-1&&(scope.activeIdx!=-1||13!==evt.which&&9!==evt.which)&&(evt.preventDefault(),40===evt.which?(scope.activeIdx=(scope.activeIdx+1)%scope.matches.length,scope.$digest()):38===evt.which?(scope.activeIdx=(scope.activeIdx>0?scope.activeIdx:scope.matches.length)-1,scope.$digest()):13===evt.which||9===evt.which?scope.$apply(function(){scope.select(scope.activeIdx)}):27===evt.which&&(evt.stopPropagation(),resetMatches(),scope.$digest()))}),element.bind("blur",function(evt){hasFocus=!1});var dismissClickHandler=function(evt){element[0]!==evt.target&&(resetMatches(),scope.$digest())};$document.bind("click",dismissClickHandler),originalScope.$on("$destroy",function(){$document.unbind("click",dismissClickHandler),appendToBody&&$popup.remove()});var $popup=$compile(popUpEl)(scope);appendToBody?$document.find("body").append($popup):element.after($popup)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(scope,element,attrs){scope.templateUrl=attrs.templateUrl,scope.isOpen=function(){return scope.matches.length>0},scope.isActive=function(matchIdx){return scope.active==matchIdx},scope.selectActive=function(matchIdx){scope.active=matchIdx},scope.selectMatch=function(activeIdx){scope.select({activeIdx:activeIdx})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function($http,$templateCache,$compile,$parse){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(scope,element,attrs){var tplUrl=$parse(attrs.templateUrl)(scope.$parent)||"template/typeahead/typeahead-match.html";$http.get(tplUrl,{cache:$templateCache}).success(function(tplContent){element.replaceWith($compile(tplContent.trim())(scope))})}}}]).filter("typeaheadHighlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query?(""+matchItem).replace(new RegExp(escapeRegexp(query),"gi"),"<strong>$&</strong>"):matchItem}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading" ng-click="toggleOpen()">\n    <h4 class="panel-title">\n      <span class="accordion-toggle" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></span>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n\t  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n\t<li ng-transclude></li>\n\t<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n\t\t<span class="btn-group pull-left">\n\t\t\t<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n\t\t\t<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n\t\t</span>\n\t\t<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n\t</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind-html="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a href ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/timepicker/timepicker.html",'<table>\n\t<tbody>\n\t\t<tr class="text-center">\n\t\t\t<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n\t\t\t<td>&nbsp;</td>\n\t\t\t<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n\t\t\t<td ng-show="showMeridian"></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n\t\t\t\t<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n\t\t\t</td>\n\t\t\t<td>:</td>\n\t\t\t<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n\t\t\t\t<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n\t\t\t</td>\n\t\t\t<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n\t\t</tr>\n\t\t<tr class="text-center">\n\t\t\t<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n\t\t\t<td>&nbsp;</td>\n\t\t\t<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n\t\t\t<td ng-show="showMeridian"></td>\n\t\t</tr>\n\t</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),function(){"use strict";var legacySupport=1===angular.version.major&&0===angular.version.minor;angular.module("ui-rangeSlider",[]).directive("rangeSlider",["$document","$filter","$log",function($document,$filter,$log){var eventNamespace=".rangeSlider",defaults={disabled:!1,orientation:"horizontal",step:0,decimalPlaces:0,showValues:!0,preventEqualMinMax:!1,attachHandleValues:!1},actions=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup",over:"pointerdown",out:"mouseout"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp",over:"MSPointerDown",out:"mouseout"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend",over:"mouseover touchstart",out:"mouseout"},onEvent=actions.start+eventNamespace,moveEvent=actions.move+eventNamespace,offEvent=actions.end+eventNamespace,overEvent=actions.over+eventNamespace,outEvent=actions.out+eventNamespace,client=function(f){try{return[f.clientX||f.originalEvent.clientX||f.originalEvent.touches[0].clientX,f.clientY||f.originalEvent.clientY||f.originalEvent.touches[0].clientY]}catch(e){return["x","y"]}},restrict=function(value){return value<0?0:value>100?100:value},isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},scopeOptions={disabled:"=?",min:"=",max:"=",modelMin:"=?",modelMax:"=?",onHandleDown:"&",onHandleUp:"&",orientation:"@",step:"@",decimalPlaces:"@",filter:"@",filterOptions:"@",showValues:"@",pinHandle:"@",preventEqualMinMax:"@",attachHandleValues:"@",getterSetter:"@"};return legacySupport&&(scopeOptions.disabled="=",scopeOptions.modelMin="=",scopeOptions.modelMax="="),{restrict:"A",replace:!0,template:['<div class="ngrs-range-slider">','<div class="ngrs-runner">','<div class="ngrs-handle ngrs-handle-min"><i></i></div>','<div class="ngrs-handle ngrs-handle-max"><i></i></div>','<div class="ngrs-join"></div>',"</div>",'<div class="ngrs-value-runner">','<div class="ngrs-value ngrs-value-min" ng-show="showValues"><div>{{filteredModelMin}}</div></div>','<div class="ngrs-value ngrs-value-max" ng-show="showValues"><div>{{filteredModelMax}}</div></div>',"</div>","</div>"].join(""),scope:scopeOptions,link:function(scope,element,attrs,controller){function modelMin(newValue){return scope.getterSetter?arguments.length?scope.modelMin(newValue):scope.modelMin():arguments.length?scope.modelMin=newValue:scope.modelMin}function modelMax(newValue){return scope.getterSetter?arguments.length?scope.modelMax(newValue):scope.modelMax():arguments.length?scope.modelMax=newValue:scope.modelMax}function setPinHandle(status){"min"===status?(angular.element(handles[0]).css("display","none"),angular.element(handles[1]).css("display","block")):"max"===status?(angular.element(handles[0]).css("display","block"),angular.element(handles[1]).css("display","none")):(angular.element(handles[0]).css("display","block"),angular.element(handles[1]).css("display","block"))}function setDisabledStatus(status){status?$slider.addClass("ngrs-disabled"):$slider.removeClass("ngrs-disabled")}function setMinMax(){scope.min>scope.max&&throwError("min must be less than or equal to max"),angular.isDefined(scope.min)&&angular.isDefined(scope.max)&&(isNumber(scope.min)||throwError("min must be a number"),isNumber(scope.max)||throwError("max must be a number"),range=scope.max-scope.min,allowedRange=[scope.min,scope.max],setModelMinMax())}function setModelMinMax(){if(modelMin()>modelMax()&&(throwWarning("modelMin must be less than or equal to modelMax"),modelMin(modelMax())),(angular.isDefined(modelMin())||"min"===scope.pinHandle)&&(angular.isDefined(modelMax())||"max"===scope.pinHandle)){isNumber(modelMin())||("min"!==scope.pinHandle&&throwWarning("modelMin must be a number"),modelMin(scope.min)),isNumber(modelMax())||("max"!==scope.pinHandle&&throwWarning("modelMax must be a number"),modelMax(scope.max));var value1pos,value2pos,handle1pos=restrict((modelMin()-scope.min)/range*100),handle2pos=restrict((modelMax()-scope.min)/range*100);if(scope.attachHandleValues&&(value1pos=handle1pos,value2pos=handle2pos),modelMin(Math.max(scope.min,modelMin())),modelMax(Math.min(scope.max,modelMax())),scope.filter&&scope.filterOptions)scope.filteredModelMin=$filter(scope.filter)(modelMin(),scope.filterOptions),scope.filteredModelMax=$filter(scope.filter)(modelMax(),scope.filterOptions);else if(scope.filter){var modelMinOptions,modelMaxOptions,filterTokens=scope.filter.split(":"),filterName=scope.filter.split(":")[0],filterOptions=filterTokens.slice().slice(1);filterOptions=filterOptions.map(function(arg){return isNumber(arg)?+arg:'"'==arg[0]&&'"'==arg[arg.length-1]||"'"==arg[0]&&"'"==arg[arg.length-1]?arg.slice(1,-1):void 0}),modelMinOptions=filterOptions.slice(),modelMaxOptions=filterOptions.slice(),modelMinOptions.unshift(modelMin()),modelMaxOptions.unshift(modelMax()),scope.filteredModelMin=$filter(filterName).apply(null,modelMinOptions),scope.filteredModelMax=$filter(filterName).apply(null,modelMaxOptions)}else scope.filteredModelMin=modelMin(),scope.filteredModelMax=modelMax();scope.min===scope.max&&modelMin()==modelMax()?(angular.element(handles[0]).css(pos,"0%"),angular.element(handles[1]).css(pos,"100%"),scope.attachHandleValues&&(angular.element(values[0]).css(pos,"0%"),angular.element(values[1]).css(pos,"100%")),angular.element(join).css(pos,"0%").css(posOpp,"0%")):(angular.element(handles[0]).css(pos,handle1pos+"%"),angular.element(handles[1]).css(pos,handle2pos+"%"),scope.attachHandleValues&&(angular.element(values[0]).css(pos,value1pos+"%"),angular.element(values[1]).css(pos,value2pos+"%"),angular.element(values[1]).css(posOpp,"auto")),angular.element(join).css(pos,handle1pos+"%").css(posOpp,100-handle2pos+"%"),handle1pos>95&&angular.element(handles[0]).css("z-index",3))}}function handleMove(index){var $handle=handles[index];$handle.bind(onEvent+"X",function(event){var handleDownClass=(0===index?"ngrs-handle-min":"ngrs-handle-max")+"-down",modelValue=(0===index?modelMin():modelMax())-scope.min,originalPosition=modelValue/range*100,originalClick=client(event),previousClick=originalClick,previousProposal=!1;angular.isFunction(scope.onHandleDown)&&scope.onHandleDown(),angular.element("body").bind("selectstart"+eventNamespace,function(){return!1}),scope.disabled||(down=!0,$handle.addClass("ngrs-down"),$slider.addClass("ngrs-focus "+handleDownClass),angular.element("body").addClass("ngrs-touching"),$document.bind(moveEvent,function(e){e.preventDefault();var movement,proposal,currentClick=client(e),per=scope.step/range*100,otherModelPosition=((0===index?modelMax():modelMin())-scope.min)/range*100;"x"!==currentClick[0]&&(currentClick[0]-=originalClick[0],currentClick[1]-=originalClick[1],movement=[previousClick[0]!==currentClick[0],previousClick[1]!==currentClick[1]],proposal=originalPosition+100*currentClick[orientation]/(orientation?$slider.height():$slider.width()),proposal=restrict(proposal),scope.preventEqualMinMax&&(0===per&&(per=1/range*100),0===index?otherModelPosition-=per:1===index&&(otherModelPosition+=per)),0===index?proposal=proposal>otherModelPosition?otherModelPosition:proposal:1===index&&(proposal=proposal<otherModelPosition?otherModelPosition:proposal),scope.step>0&&proposal<100&&proposal>0&&(proposal=Math.round(proposal/per)*per),proposal>95&&0===index?$handle.css("z-index",3):$handle.css("z-index",""),movement[orientation]&&proposal!=previousProposal&&(0===index?modelMin(parseFloat(parseFloat(proposal*range/100+scope.min).toFixed(scope.decimalPlaces))):1===index&&modelMax(parseFloat(parseFloat(proposal*range/100+scope.min).toFixed(scope.decimalPlaces))),scope.$apply(),previousProposal=proposal),previousClick=currentClick)}).bind(offEvent,function(){angular.isFunction(scope.onHandleUp)&&scope.onHandleUp(),$document.off(moveEvent),$document.off(offEvent),angular.element("body").removeClass("ngrs-touching"),down=!1,$handle.removeClass("ngrs-down"),$handle.removeClass("ngrs-over"),$slider.removeClass("ngrs-focus "+handleDownClass)}))}).on(overEvent,function(){$handle.addClass("ngrs-over")}).on(outEvent,function(){down||$handle.removeClass("ngrs-over")})}function throwError(message){throw scope.disabled=!0,new Error("RangeSlider: "+message)}function throwWarning(message){$log.warn(message)}var $slider=angular.element(element),handles=[element.find(".ngrs-handle-min"),element.find(".ngrs-handle-max")],values=[element.find(".ngrs-value-min"),element.find(".ngrs-value-max")],join=element.find(".ngrs-join"),pos="left",posOpp="right",orientation=0,allowedRange=[0,0],range=0,down=!1;scope.filteredModelMin=modelMin(),scope.filteredModelMax=modelMax(),attrs.$observe("disabled",function(val){angular.isDefined(val)||(scope.disabled=defaults.disabled),
scope.$watch("disabled",setDisabledStatus)}),attrs.$observe("orientation",function(val){angular.isDefined(val)||(scope.orientation=defaults.orientation);for(var useClass,classNames=scope.orientation.split(" "),i=0,l=classNames.length;i<l;i++)classNames[i]="ngrs-"+classNames[i];useClass=classNames.join(" "),$slider.addClass(useClass),"vertical"!==scope.orientation&&"vertical left"!==scope.orientation&&"vertical right"!==scope.orientation||(pos="top",posOpp="bottom",orientation=1)}),attrs.$observe("step",function(val){angular.isDefined(val)||(scope.step=defaults.step)}),attrs.$observe("decimalPlaces",function(val){angular.isDefined(val)||(scope.decimalPlaces=defaults.decimalPlaces)}),attrs.$observe("showValues",function(val){angular.isDefined(val)?"false"===val?scope.showValues=!1:scope.showValues=!0:scope.showValues=defaults.showValues}),attrs.$observe("pinHandle",function(val){angular.isDefined(val)&&("min"===val||"max"===val)?scope.pinHandle=val:scope.pinHandle=null,scope.$watch("pinHandle",setPinHandle)}),attrs.$observe("preventEqualMinMax",function(val){angular.isDefined(val)?"false"===val?scope.preventEqualMinMax=!1:scope.preventEqualMinMax=!0:scope.preventEqualMinMax=defaults.preventEqualMinMax}),attrs.$observe("attachHandleValues",function(val){angular.isDefined(val)?"true"===val||""===val?(scope.attachHandleValues=!0,element.find(".ngrs-value-runner").addClass("ngrs-attached-handles")):scope.attachHandleValues=!1:scope.attachHandleValues=defaults.attachHandleValues}),scope.$watch("min",setMinMax),scope.$watch("max",setMinMax),scope.$watch(function(){return modelMin()},setModelMinMax),scope.$watch(function(){return modelMax()},setModelMinMax),scope.$on("$destroy",function(){$slider.off(eventNamespace),angular.element("body").off(eventNamespace),$document.off(eventNamespace);for(var i=0,l=handles.length;i<l;i++)handles[i].off(eventNamespace),handles[i].off(eventNamespace+"X")}),$slider.bind("selectstart"+eventNamespace,function(event){return!1}).bind("click",function(event){event.stopPropagation()}),handleMove(0),handleMove(1)}}}]),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}()}(),function(window,angular,undefined){"use strict";function toArray(object){return isArray(object)?object:Object.keys(object).map(function(key){return object[key]})}function isNull(value){return null===value}function objectContains(partial,object){var keys=Object.keys(partial);return keys.map(function(el){return object[el]!==undefined&&object[el]==partial[el]}).indexOf(!1)==-1}function hasApproxPattern(word,pattern){if(""===pattern)return word;var index=word.indexOf(pattern.charAt(0));return index!==-1&&hasApproxPattern(word.substr(index+1),pattern.substr(1))}function getFirstMatches(array,n,expression){var count=0;return array.filter(function(elm){var rest=isDefined(expression)?count<n&&expression(elm):count<n;return count=rest?count+1:count,rest})}function convertToDecimal(num,decimal,$math){return $math.round(num*$math.pow(10,decimal))/$math.pow(10,decimal)}function deepKeys(obj,stack,parent){stack=stack||[];var keys=Object.keys(obj);return keys.forEach(function(el){if(isObject(obj[el])&&!isArray(obj[el])){var p=parent?parent+"."+el:parent;deepKeys(obj[el],stack,p||el)}else{var key=parent?parent+"."+el:el;stack.push(key)}}),stack}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isGreaterThanFilter(){return function(input,check){return input>check}}function isGreaterThanOrEqualToFilter(){return function(input,check){return input>=check}}function isLessThanFilter(){return function(input,check){return input<check}}function isLessThanOrEqualToFilter(){return function(input,check){return input<=check}}function isEqualToFilter(){return function(input,check){return input==check}}function isNotEqualToFilter(){return function(input,check){return input!=check}}function isIdenticalToFilter(){return function(input,check){return input===check}}function isNotIdenticalToFilter(){return function(input,check){return input!==check}}function containsFilter($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!(!isArray(collection)||isUndefined(expression))&&collection.some(function(elm){return isString(expression)&&isObject(elm)||isFunction(expression)?$parse(expression)(elm):elm===expression})}}function flatten(array,i){return i=i||0,i>=array.length?array:isArray(array[i])?flatten(array.slice(0,i).concat(array[i],array.slice(i+1)),i):flatten(array,i+1)}function uniqFilter($parse){return function(collection,property){function some(array,member){return!isUndefined(member)&&array.some(function(el){return equals(el,member)})}if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection))return collection;var uniqueItems=[],get=$parse(property);return isUndefined(property)?collection.filter(function(elm,pos,self){return self.indexOf(elm)===pos}):collection.filter(function(elm){var prop=get(elm);return!some(uniqueItems,prop)&&(uniqueItems.push(prop),!0)})}}function strRepeat(str,n,sep){return n?str+sep+strRepeat(str,--n,sep):str}var isDefined=angular.isDefined,isUndefined=angular.isUndefined,isFunction=angular.isFunction,isString=angular.isString,isNumber=angular.isNumber,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,equals=angular.equals;String.prototype.contains||(String.prototype.contains=function(){return String.prototype.indexOf.apply(this,arguments)!==-1}),angular.module("a8m.angular",[]).filter("isUndefined",function(){return function(input){return angular.isUndefined(input)}}).filter("isDefined",function(){return function(input){return angular.isDefined(input)}}).filter("isFunction",function(){return function(input){return angular.isFunction(input)}}).filter("isString",function(){return function(input){return angular.isString(input)}}).filter("isNumber",function(){return function(input){return angular.isNumber(input)}}).filter("isArray",function(){return function(input){return angular.isArray(input)}}).filter("isObject",function(){return function(input){return angular.isObject(input)}}).filter("isEqual",function(){return function(o1,o2){return angular.equals(o1,o2)}}),angular.module("a8m.conditions",[]).filter({isGreaterThan:isGreaterThanFilter,">":isGreaterThanFilter,isGreaterThanOrEqualTo:isGreaterThanOrEqualToFilter,">=":isGreaterThanOrEqualToFilter,isLessThan:isLessThanFilter,"<":isLessThanFilter,isLessThanOrEqualTo:isLessThanOrEqualToFilter,"<=":isLessThanOrEqualToFilter,isEqualTo:isEqualToFilter,"==":isEqualToFilter,isNotEqualTo:isNotEqualToFilter,"!=":isNotEqualToFilter,isIdenticalTo:isIdenticalToFilter,"===":isIdenticalToFilter,isNotIdenticalTo:isNotIdenticalToFilter,"!==":isNotIdenticalToFilter}),angular.module("a8m.is-null",[]).filter("isNull",function(){return function(input){return isNull(input)}}),angular.module("a8m.after-where",[]).filter("afterWhere",function(){return function(collection,object){if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(object))return collection;var index=collection.map(function(elm){return objectContains(object,elm)}).indexOf(!0);return collection.slice(index===-1?0:index)}}),angular.module("a8m.after",[]).filter("after",function(){return function(collection,count){return collection=isObject(collection)?toArray(collection):collection,isArray(collection)?collection.slice(count):collection}}),angular.module("a8m.before-where",[]).filter("beforeWhere",function(){return function(collection,object){if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(object))return collection;var index=collection.map(function(elm){return objectContains(object,elm)}).indexOf(!0);return collection.slice(0,index===-1?collection.length:++index)}}),angular.module("a8m.before",[]).filter("before",function(){return function(collection,count){return collection=isObject(collection)?toArray(collection):collection,isArray(collection)?collection.slice(0,count?--count:count):collection}}),angular.module("a8m.chunk-by",["a8m.filter-watcher"]).filter("chunkBy",["filterWatcher",function(filterWatcher){return function(array,n,fillVal){function fill(n,val){for(var ret=[];n--;)ret[n]=val;return ret}function _chunkBy(array,n,fillVal){return isArray(array)?array.map(function(el,i,self){return i*=n,el=self.slice(i,i+n),!isUndefined(fillVal)&&el.length<n?el.concat(fill(n-el.length,fillVal)):el}).slice(0,Math.ceil(array.length/n)):array}return filterWatcher.isMemoized("chunkBy",arguments)||filterWatcher.memoize("chunkBy",arguments,this,_chunkBy(array,n,fillVal))}}]),angular.module("a8m.concat",[]).filter("concat",[function(){return function(collection,joined){if(isUndefined(joined))return collection;if(isArray(collection))return isObject(joined)?collection.concat(toArray(joined)):collection.concat(joined);if(isObject(collection)){var array=toArray(collection);return isObject(joined)?array.concat(toArray(joined)):array.concat(joined)}return collection}}]),angular.module("a8m.contains",[]).filter({contains:["$parse",containsFilter],some:["$parse",containsFilter]}),angular.module("a8m.count-by",[]).filter("countBy",["$parse",function($parse){return function(collection,property){var prop,result={},get=$parse(property);return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(property)?collection:(collection.forEach(function(elm){prop=get(elm),result[prop]||(result[prop]=0),result[prop]++}),result)}}]),angular.module("a8m.defaults",[]).filter("defaults",["$parse",function($parse){return function(collection,defaults){if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||!isObject(defaults))return collection;var keys=deepKeys(defaults);return collection.forEach(function(elm){keys.forEach(function(key){var getter=$parse(key),setter=getter.assign;isUndefined(getter(elm))&&setter(elm,getter(defaults))})}),collection}}]),angular.module("a8m.every",[]).filter("every",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!(isArray(collection)&&!isUndefined(expression))||collection.every(function(elm){return isObject(elm)||isFunction(expression)?$parse(expression)(elm):elm===expression})}}]),angular.module("a8m.filter-by",[]).filter("filterBy",["$parse",function($parse){return function(collection,properties,search,strict){var comparator;return search=isString(search)||isNumber(search)?String(search).toLowerCase():undefined,collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(search)?collection:collection.filter(function(elm){return properties.some(function(prop){if(~prop.indexOf("+")){var propList=prop.replace(/\s+/g,"").split("+");comparator=propList.map(function(prop){return $parse(prop)(elm)}).join(" ")}else comparator=$parse(prop)(elm);return!(!isString(comparator)&&!isNumber(comparator))&&(comparator=String(comparator).toLowerCase(),strict?comparator===search:comparator.contains(search))})})}}]),angular.module("a8m.first",[]).filter("first",["$parse",function($parse){return function(collection){var n,getter,args;return collection=isObject(collection)?toArray(collection):collection,isArray(collection)?(args=Array.prototype.slice.call(arguments,1),n=isNumber(args[0])?args[0]:1,getter=isNumber(args[0])?isNumber(args[1])?undefined:args[1]:args[0],args.length?getFirstMatches(collection,n,getter?$parse(getter):getter):collection[0]):collection}}]),angular.module("a8m.flatten",[]).filter("flatten",function(){return function(collection,shallow){return shallow=shallow||!1,collection=isObject(collection)?toArray(collection):collection,isArray(collection)?shallow?[].concat.apply([],collection):flatten(collection,0):collection}}),angular.module("a8m.fuzzy-by",[]).filter("fuzzyBy",["$parse",function($parse){return function(collection,property,search,csensitive){var prop,getter,sensitive=csensitive||!1;return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(property)||isUndefined(search)?collection:(getter=$parse(property),collection.filter(function(elm){return prop=getter(elm),!!isString(prop)&&(prop=sensitive?prop:prop.toLowerCase(),search=sensitive?search:search.toLowerCase(),hasApproxPattern(prop,search)!==!1)}))}}]),angular.module("a8m.fuzzy",[]).filter("fuzzy",function(){return function(collection,search,csensitive){function _hasApproximateKey(object,search){var prop,flag,properties=Object.keys(object);return 0<properties.filter(function(elm){return prop=object[elm],!!flag||!!isString(prop)&&(prop=sensitive?prop:prop.toLowerCase(),flag=hasApproxPattern(prop,search)!==!1)}).length}var sensitive=csensitive||!1;return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(search)?collection:(search=sensitive?search:search.toLowerCase(),collection.filter(function(elm){return isString(elm)?(elm=sensitive?elm:elm.toLowerCase(),hasApproxPattern(elm,search)!==!1):!!isObject(elm)&&_hasApproximateKey(elm,search)}))}}),angular.module("a8m.group-by",["a8m.filter-watcher"]).filter("groupBy",["$parse","filterWatcher",function($parse,filterWatcher){return function(collection,property){function _groupBy(collection,getter){var prop,result={};return forEach(collection,function(elm){prop=getter(elm),result[prop]||(result[prop]=[]),result[prop].push(elm)}),result}return!isObject(collection)||isUndefined(property)?collection:filterWatcher.isMemoized("groupBy",arguments)||filterWatcher.memoize("groupBy",arguments,this,_groupBy(collection,$parse(property)))}}]),angular.module("a8m.is-empty",[]).filter("isEmpty",function(){return function(collection){return isObject(collection)?!toArray(collection).length:!collection.length}}),angular.module("a8m.join",[]).filter("join",function(){return function(input,delimiter){return isUndefined(input)||!isArray(input)?input:(isUndefined(delimiter)&&(delimiter=" "),input.join(delimiter))}}),angular.module("a8m.last",[]).filter("last",["$parse",function($parse){return function(collection){var n,getter,args,reversed=copy(collection);return reversed=isObject(reversed)?toArray(reversed):reversed,isArray(reversed)?(args=Array.prototype.slice.call(arguments,1),n=isNumber(args[0])?args[0]:1,getter=isNumber(args[0])?isNumber(args[1])?undefined:args[1]:args[0],args.length?getFirstMatches(reversed.reverse(),n,getter?$parse(getter):getter).reverse():reversed[reversed.length-1]):reversed}}]),angular.module("a8m.map",[]).filter("map",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?collection:collection.map(function(elm){return $parse(expression)(elm)})}}]),angular.module("a8m.omit",[]).filter("omit",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?collection:collection.filter(function(elm){return!$parse(expression)(elm)})}}]),angular.module("a8m.pick",[]).filter("pick",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?collection:collection.filter(function(elm){return $parse(expression)(elm)})}}]),angular.module("a8m.range",[]).filter("range",function(){return function(input,total,start,increment,cb){start=start||0,increment=increment||1;for(var i=0;i<parseInt(total);i++){var j=start+i*increment;input.push(isFunction(cb)?cb(j):j)}return input}}),angular.module("a8m.remove-with",[]).filter("removeWith",function(){return function(collection,object){return isUndefined(object)?collection:(collection=isObject(collection)?toArray(collection):collection,collection.filter(function(elm){return!objectContains(object,elm)}))}}),angular.module("a8m.remove",[]).filter("remove",function(){return function(collection){collection=isObject(collection)?toArray(collection):collection;var args=Array.prototype.slice.call(arguments,1);return isArray(collection)?collection.filter(function(member){return!args.some(function(nest){return equals(nest,member)})}):collection}}),angular.module("a8m.reverse",[]).filter("reverse",[function(){return function(input){return input=isObject(input)?toArray(input):input,isString(input)?input.split("").reverse().join(""):isArray(input)?input.slice().reverse():input}}]),angular.module("a8m.search-field",[]).filter("searchField",["$parse",function($parse){return function(collection){var get,field;collection=isObject(collection)?toArray(collection):collection;var args=Array.prototype.slice.call(arguments,1);return isArray(collection)&&args.length?collection.map(function(member){return field=args.map(function(field){return(get=$parse(field))(member)}).join(" "),extend(member,{searchField:field})}):collection}}]),angular.module("a8m.to-array",[]).filter("toArray",function(){return function(collection,addKey){return isObject(collection)?addKey?Object.keys(collection).map(function(key){return extend(collection[key],{$key:key})}):toArray(collection):collection}}),angular.module("a8m.unique",[]).filter({unique:["$parse",uniqFilter],uniq:["$parse",uniqFilter]}),angular.module("a8m.where",[]).filter("where",function(){return function(collection,object){return isUndefined(object)?collection:(collection=isObject(collection)?toArray(collection):collection,collection.filter(function(elm){return objectContains(object,elm)}))}}),angular.module("a8m.xor",[]).filter("xor",["$parse",function($parse){return function(col1,col2,expression){function some(el,col){var getter=$parse(expression);return col.some(function(dElm){return expression?equals(getter(dElm),getter(el)):equals(dElm,el)})}return expression=expression||!1,col1=isObject(col1)?toArray(col1):col1,col2=isObject(col2)?toArray(col2):col2,isArray(col1)&&isArray(col2)?col1.concat(col2).filter(function(elm){return!(some(elm,col1)&&some(elm,col2))}):col1}}]),angular.module("a8m.math.byteFmt",["a8m.math"]).filter("byteFmt",["$math",function($math){return function(bytes,decimal){return isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(bytes)&&isFinite(bytes)?bytes<1024?convertToDecimal(bytes,decimal,$math)+" B":bytes<1048576?convertToDecimal(bytes/1024,decimal,$math)+" KB":bytes<1073741824?convertToDecimal(bytes/1048576,decimal,$math)+" MB":convertToDecimal(bytes/1073741824,decimal,$math)+" GB":"NaN"}}]),angular.module("a8m.math.degrees",["a8m.math"]).filter("degrees",["$math",function($math){return function(radians,decimal){if(isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(radians)&&isFinite(radians)){var degrees=180*radians/$math.PI;return $math.round(degrees*$math.pow(10,decimal))/$math.pow(10,decimal)}return"NaN"}}]),angular.module("a8m.math.kbFmt",["a8m.math"]).filter("kbFmt",["$math",function($math){return function(bytes,decimal){return isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(bytes)&&isFinite(bytes)?bytes<1024?convertToDecimal(bytes,decimal,$math)+" KB":bytes<1048576?convertToDecimal(bytes/1024,decimal,$math)+" MB":convertToDecimal(bytes/1048576,decimal,$math)+" GB":"NaN"}}]),angular.module("a8m.math",[]).factory("$math",["$window",function($window){return $window.Math}]),angular.module("a8m.math.max",["a8m.math"]).filter("max",["$math","$parse",function($math,$parse){function indexByMax(array,exp){var mappedArray=array.map(function(elm){return $parse(exp)(elm)});return mappedArray.indexOf($math.max.apply($math,mappedArray))}return function(input,expression){return isArray(input)?isUndefined(expression)?$math.max.apply($math,input):input[indexByMax(input,expression)]:input}}]),angular.module("a8m.math.min",["a8m.math"]).filter("min",["$math","$parse",function($math,$parse){function indexByMin(array,exp){var mappedArray=array.map(function(elm){return $parse(exp)(elm)});return mappedArray.indexOf($math.min.apply($math,mappedArray))}return function(input,expression){return isArray(input)?isUndefined(expression)?$math.min.apply($math,input):input[indexByMin(input,expression)]:input}}]),angular.module("a8m.math.percent",["a8m.math"]).filter("percent",["$math","$window",function($math,$window){return function(input,divided,round){var divider=isString(input)?$window.Number(input):input;return divided=divided||100,round=round||!1,!isNumber(divider)||$window.isNaN(divider)?input:round?$math.round(divider/divided*100):divider/divided*100}}]),angular.module("a8m.math.radians",["a8m.math"]).filter("radians",["$math",function($math){return function(degrees,decimal){if(isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(degrees)&&isFinite(degrees)){var radians=3.14159265359*degrees/180;return $math.round(radians*$math.pow(10,decimal))/$math.pow(10,decimal)}return"NaN"}}]),angular.module("a8m.math.radix",[]).filter("radix",function(){return function(input,radix){var RANGE=/^[2-9]$|^[1-2]\d$|^3[0-6]$/;return isNumber(input)&&RANGE.test(radix)?input.toString(radix).toUpperCase():input}}),angular.module("a8m.math.shortFmt",["a8m.math"]).filter("shortFmt",["$math",function($math){return function(number,decimal){return isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(number)&&isFinite(number)?number<1e3?number:number<1e6?convertToDecimal(number/1e3,decimal,$math)+" K":number<1e9?convertToDecimal(number/1e6,decimal,$math)+" M":convertToDecimal(number/1e9,decimal,$math)+" B":"NaN"}}]),angular.module("a8m.math.sum",[]).filter("sum",function(){return function(input,initial){return isArray(input)?input.reduce(function(prev,curr){return prev+curr},initial||0):input}}),angular.module("a8m.ends-with",[]).filter("endsWith",function(){return function(input,ends,csensitive){var position,sensitive=csensitive||!1;return!isString(input)||isUndefined(ends)?input:(input=sensitive?input:input.toLowerCase(),position=input.length-ends.length,input.indexOf(sensitive?ends:ends.toLowerCase(),position)!==-1)}}),angular.module("a8m.latinize",[]).filter("latinize",[function(){function removeDiacritics(str){return str.replace(/[^\u0000-\u007E]/g,function(a){return diacriticsMap[a]||a})}for(var defaultDiacriticsRemovalap=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"OE",letters:""},{base:"oe",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],diacriticsMap={},i=0;i<defaultDiacriticsRemovalap.length;i++)for(var letters=defaultDiacriticsRemovalap[i].letters.split(""),j=0;j<letters.length;j++)diacriticsMap[letters[j]]=defaultDiacriticsRemovalap[i].base;return function(input){return isString(input)?removeDiacritics(input):input}}]),angular.module("a8m.ltrim",[]).filter("ltrim",function(){return function(input,chars){var trim=chars||"\\s";return isString(input)?input.replace(new RegExp("^"+trim+"+"),""):input}}),angular.module("a8m.match",[]).filter("match",function(){return function(input,pattern,flag){var reg=new RegExp(pattern,flag);return isString(input)?input.match(reg):null}}),angular.module("a8m.repeat",[]).filter("repeat",[function(){return function(input,n,separator){var times=~~n;return isString(input)&&times?strRepeat(input,--n,separator||""):input}}]),angular.module("a8m.rtrim",[]).filter("rtrim",function(){return function(input,chars){var trim=chars||"\\s";return isString(input)?input.replace(new RegExp(trim+"+$"),""):input}}),angular.module("a8m.slugify",[]).filter("slugify",[function(){return function(input,sub){var replace=isUndefined(sub)?"-":sub;return isString(input)?input.toLowerCase().replace(/\s+/g,replace):input}}]),angular.module("a8m.starts-with",[]).filter("startsWith",function(){return function(input,start,csensitive){var sensitive=csensitive||!1;return!isString(input)||isUndefined(start)?input:(input=sensitive?input:input.toLowerCase(),!input.indexOf(sensitive?start:start.toLowerCase()))}}),angular.module("a8m.stringular",[]).filter("stringular",function(){return function(input){var args=Array.prototype.slice.call(arguments,1);return input.replace(/{(\d+)}/g,function(match,number){return isUndefined(args[number])?match:args[number]})}}),angular.module("a8m.strip-tags",[]).filter("stripTags",function(){return function(input){return isString(input)?input.replace(/<\S[^><]*>/g,""):input}}),angular.module("a8m.test",[]).filter("test",function(){return function(input,pattern,flag){var reg=new RegExp(pattern,flag);return isString(input)?reg.test(input):input}}),angular.module("a8m.trim",[]).filter("trim",function(){return function(input,chars){var trim=chars||"\\s";return isString(input)?input.replace(new RegExp("^"+trim+"+|"+trim+"+$","g"),""):input}}),angular.module("a8m.truncate",[]).filter("truncate",function(){return function(input,length,suffix,preserve){return length=isUndefined(length)?input.length:length,preserve=preserve||!1,suffix=suffix||"",!isString(input)||input.length<=length?input:input.substring(0,preserve?input.indexOf(" ",length)===-1?input.length:input.indexOf(" ",length):length)+suffix}}),angular.module("a8m.ucfirst",[]).filter("ucfirst",[function(){return function(input){return isString(input)?input.split(" ").map(function(ch){return ch.charAt(0).toUpperCase()+ch.substring(1)}).join(" "):input}}]),angular.module("a8m.uri-component-encode",[]).filter("uriComponentEncode",["$window",function($window){return function(input){return isString(input)?$window.encodeURIComponent(input):input}}]),angular.module("a8m.uri-encode",[]).filter("uriEncode",["$window",function($window){return function(input){return isString(input)?$window.encodeURI(input):input}}]),angular.module("a8m.wrap",[]).filter("wrap",function(){return function(input,wrap,ends){return isString(input)&&isDefined(wrap)?[wrap,input,ends||wrap].join(""):input}}),angular.module("a8m.filter-watcher",[]).provider("filterWatcher",function(){this.$get=["$window","$rootScope",function($window,$rootScope){function getHashKey(fName,args){function replacerFactory(){var cache=[];return function(key,val){if(isObject(val)&&!isNull(val)){if(~cache.indexOf(val))return"[Circular]";cache.push(val)}return $window==val?"$WINDOW":$window.document==val?"$DOCUMENT":isScope(val)?"$SCOPE":val}}return[fName,JSON.stringify(args,replacerFactory())].join("#").replace(/"/g,"")}function removeCache(event){var id=event.targetScope.$id;forEach($$listeners[id],function(key){delete $$cache[key]}),delete $$listeners[id]}function cleanStateless(){$$timeout(function(){$rootScope.$$phase||($$cache={})},2e3)}function addListener(scope,hashKey){var id=scope.$id;return isUndefined($$listeners[id])&&(scope.$on("$destroy",removeCache),$$listeners[id]=[]),$$listeners[id].push(hashKey)}function $$isMemoized(filterName,args){var hashKey=getHashKey(filterName,args);return $$cache[hashKey]}function $$memoize(filterName,args,scope,result){var hashKey=getHashKey(filterName,args);return $$cache[hashKey]=result,isScope(scope)?addListener(scope,hashKey):cleanStateless(),result}var $$cache={},$$listeners={},$$timeout=$window.setTimeout;return{isMemoized:$$isMemoized,memoize:$$memoize}}]}),angular.module("angular.filter",["a8m.ucfirst","a8m.uri-encode","a8m.uri-component-encode","a8m.slugify","a8m.latinize","a8m.strip-tags","a8m.stringular","a8m.truncate","a8m.starts-with","a8m.ends-with","a8m.wrap","a8m.trim","a8m.ltrim","a8m.rtrim","a8m.repeat","a8m.test","a8m.match","a8m.to-array","a8m.concat","a8m.contains","a8m.unique","a8m.is-empty","a8m.after","a8m.after-where","a8m.before","a8m.before-where","a8m.defaults","a8m.where","a8m.reverse","a8m.remove","a8m.remove-with","a8m.group-by","a8m.count-by","a8m.chunk-by","a8m.search-field","a8m.fuzzy-by","a8m.fuzzy","a8m.omit","a8m.pick","a8m.every","a8m.filter-by","a8m.xor","a8m.map","a8m.first","a8m.last","a8m.flatten","a8m.join","a8m.range","a8m.math","a8m.math.max","a8m.math.min","a8m.math.percent","a8m.math.radix","a8m.math.sum","a8m.math.degrees","a8m.math.radians","a8m.math.byteFmt","a8m.math.kbFmt","a8m.math.shortFmt","a8m.angular","a8m.conditions","a8m.is-null","a8m.filter-watcher"])}(window,window.angular),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory():root.returnExports=factory()}(this,function(){var isCallable,$Array=Array,ArrayPrototype=$Array.prototype,$Object=Object,ObjectPrototype=$Object.prototype,FunctionPrototype=Function.prototype,$String=String,StringPrototype=$String.prototype,$Number=Number,NumberPrototype=$Number.prototype,array_slice=ArrayPrototype.slice,array_splice=ArrayPrototype.splice,array_push=ArrayPrototype.push,array_unshift=ArrayPrototype.unshift,array_concat=ArrayPrototype.concat,call=FunctionPrototype.call,max=Math.max,min=Math.min,to_string=ObjectPrototype.toString,hasToStringTag="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,fnToStr=Function.prototype.toString,tryFunctionObject=function(value){try{return fnToStr.call(value),!0}catch(e){return!1}},fnClass="[object Function]",genClass="[object GeneratorFunction]";isCallable=function(value){if("function"!=typeof value)return!1;
if(hasToStringTag)return tryFunctionObject(value);var strClass=to_string.call(value);return strClass===fnClass||strClass===genClass};var isRegex,regexExec=RegExp.prototype.exec,tryRegexExec=function(value){try{return regexExec.call(value),!0}catch(e){return!1}},regexClass="[object RegExp]";isRegex=function(value){return"object"==typeof value&&(hasToStringTag?tryRegexExec(value):to_string.call(value)===regexClass)};var isString,strValue=String.prototype.valueOf,tryStringObject=function(value){try{return strValue.call(value),!0}catch(e){return!1}},stringClass="[object String]";isString=function(value){return"string"==typeof value||"object"==typeof value&&(hasToStringTag?tryStringObject(value):to_string.call(value)===stringClass)};var defineProperties=function(has){var defineProperty,supportsDescriptors=$Object.defineProperty&&function(){try{var obj={};$Object.defineProperty(obj,"x",{enumerable:!1,value:obj});for(var _ in obj)return!1;return obj.x===obj}catch(e){return!1}}();return defineProperty=supportsDescriptors?function(object,name,method,forceAssign){!forceAssign&&name in object||$Object.defineProperty(object,name,{configurable:!0,enumerable:!1,writable:!0,value:method})}:function(object,name,method,forceAssign){!forceAssign&&name in object||(object[name]=method)},function(object,map,forceAssign){for(var name in map)has.call(map,name)&&defineProperty(object,name,map[name],forceAssign)}}(ObjectPrototype.hasOwnProperty),isPrimitive=function(input){var type=typeof input;return null===input||"object"!==type&&"function"!==type},isActualNaN=$Number.isNaN||function(x){return x!==x},ES={ToInteger:function(num){var n=+num;return isActualNaN(n)?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n},ToPrimitive:function(input){var val,valueOf,toStr;if(isPrimitive(input))return input;if(valueOf=input.valueOf,isCallable(valueOf)&&(val=valueOf.call(input),isPrimitive(val)))return val;if(toStr=input.toString,isCallable(toStr)&&(val=toStr.call(input),isPrimitive(val)))return val;throw new TypeError},ToObject:function(o){if(null==o)throw new TypeError("can't convert "+o+" to object");return $Object(o)},ToUint32:function(x){return x>>>0}},Empty=function(){};defineProperties(FunctionPrototype,{bind:function(that){var target=this;if(!isCallable(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var bound,args=array_slice.call(arguments,1),binder=function(){if(this instanceof bound){var result=target.apply(this,array_concat.call(args,array_slice.call(arguments)));return $Object(result)===result?result:this}return target.apply(that,array_concat.call(args,array_slice.call(arguments)))},boundLength=max(0,target.length-args.length),boundArgs=[],i=0;i<boundLength;i++)array_push.call(boundArgs,"$"+i);return bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this, arguments); }")(binder),target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound}});var owns=call.bind(ObjectPrototype.hasOwnProperty),toStr=call.bind(ObjectPrototype.toString),strSlice=call.bind(StringPrototype.slice),strSplit=call.bind(StringPrototype.split),isArray=$Array.isArray||function(obj){return"[object Array]"===toStr(obj)},hasUnshiftReturnValueBug=1!==[].unshift(0);defineProperties(ArrayPrototype,{unshift:function(){return array_unshift.apply(this,arguments),this.length}},hasUnshiftReturnValueBug),defineProperties($Array,{isArray:isArray});var boxedString=$Object("a"),splitString="a"!==boxedString[0]||!(0 in boxedString),properlyBoxesContext=function(method){var properlyBoxesNonStrict=!0,properlyBoxesStrict=!0;return method&&(method.call("foo",function(_,__,context){"object"!=typeof context&&(properlyBoxesNonStrict=!1)}),method.call([1],function(){"use strict";properlyBoxesStrict="string"==typeof this},"x")),!!method&&properlyBoxesNonStrict&&properlyBoxesStrict};defineProperties(ArrayPrototype,{forEach:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,i=-1,length=ES.ToUint32(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++i<length;)i in self&&("undefined"==typeof T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object))}},!properlyBoxesContext(ArrayPrototype.forEach)),defineProperties(ArrayPrototype,{map:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length),result=$Array(length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.map callback must be a function");for(var i=0;i<length;i++)i in self&&("undefined"==typeof T?result[i]=callbackfn(self[i],i,object):result[i]=callbackfn.call(T,self[i],i,object));return result}},!properlyBoxesContext(ArrayPrototype.map)),defineProperties(ArrayPrototype,{filter:function(callbackfn){var value,T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length),result=[];if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.filter callback must be a function");for(var i=0;i<length;i++)i in self&&(value=self[i],("undefined"==typeof T?callbackfn(value,i,object):callbackfn.call(T,value,i,object))&&array_push.call(result,value));return result}},!properlyBoxesContext(ArrayPrototype.filter)),defineProperties(ArrayPrototype,{every:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.every callback must be a function");for(var i=0;i<length;i++)if(i in self&&!("undefined"==typeof T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object)))return!1;return!0}},!properlyBoxesContext(ArrayPrototype.every)),defineProperties(ArrayPrototype,{some:function(callbackfn){var T,object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.some callback must be a function");for(var i=0;i<length;i++)if(i in self&&("undefined"==typeof T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object)))return!0;return!1}},!properlyBoxesContext(ArrayPrototype.some));var reduceCoercesToObject=!1;ArrayPrototype.reduce&&(reduceCoercesToObject="object"==typeof ArrayPrototype.reduce.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduce:function(callbackfn){var object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(!isCallable(callbackfn))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===length&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;i<length;i++)i in self&&(result=callbackfn(result,self[i],i,object));return result}},!reduceCoercesToObject);var reduceRightCoercesToObject=!1;ArrayPrototype.reduceRight&&(reduceRightCoercesToObject="object"==typeof ArrayPrototype.reduceRight.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduceRight:function(callbackfn){var object=ES.ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES.ToUint32(self.length);if(!isCallable(callbackfn))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===length&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(--i<0)throw new TypeError("reduceRight of empty array with no initial value")}if(i<0)return result;do i in self&&(result=callbackfn(result,self[i],i,object));while(i--);return result}},!reduceRightCoercesToObject);var hasFirefox2IndexOfBug=ArrayPrototype.indexOf&&[0,1].indexOf(1,2)!==-1;defineProperties(ArrayPrototype,{indexOf:function(searchElement){var self=splitString&&isString(this)?strSplit(this,""):ES.ToObject(this),length=ES.ToUint32(self.length);if(0===length)return-1;var i=0;for(arguments.length>1&&(i=ES.ToInteger(arguments[1])),i=i>=0?i:max(0,length+i);i<length;i++)if(i in self&&self[i]===searchElement)return i;return-1}},hasFirefox2IndexOfBug);var hasFirefox2LastIndexOfBug=ArrayPrototype.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;defineProperties(ArrayPrototype,{lastIndexOf:function(searchElement){var self=splitString&&isString(this)?strSplit(this,""):ES.ToObject(this),length=ES.ToUint32(self.length);if(0===length)return-1;var i=length-1;for(arguments.length>1&&(i=min(i,ES.ToInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&searchElement===self[i])return i;return-1}},hasFirefox2LastIndexOfBug);var spliceNoopReturnsEmptyArray=function(){var a=[1,2],result=a.splice();return 2===a.length&&isArray(result)&&0===result.length}();defineProperties(ArrayPrototype,{splice:function(start,deleteCount){return 0===arguments.length?[]:array_splice.apply(this,arguments)}},!spliceNoopReturnsEmptyArray);var spliceWorksWithEmptyObject=function(){var obj={};return ArrayPrototype.splice.call(obj,0,0,1),1===obj.length}();defineProperties(ArrayPrototype,{splice:function(start,deleteCount){if(0===arguments.length)return[];var args=arguments;return this.length=max(ES.ToInteger(this.length),0),arguments.length>0&&"number"!=typeof deleteCount&&(args=array_slice.call(arguments),args.length<2?array_push.call(args,this.length-start):args[1]=ES.ToInteger(deleteCount)),array_splice.apply(this,args)}},!spliceWorksWithEmptyObject);var spliceWorksWithLargeSparseArrays=function(){var arr=new $Array(1e5);return arr[8]="x",arr.splice(1,1),7===arr.indexOf("x")}(),spliceWorksWithSmallSparseArrays=function(){var n=256,arr=[];return arr[n]="a",arr.splice(n+1,0,"b"),"a"===arr[n]}();defineProperties(ArrayPrototype,{splice:function(start,deleteCount){for(var from,O=ES.ToObject(this),A=[],len=ES.ToUint32(O.length),relativeStart=ES.ToInteger(start),actualStart=relativeStart<0?max(len+relativeStart,0):min(relativeStart,len),actualDeleteCount=min(max(ES.ToInteger(deleteCount),0),len-actualStart),k=0;k<actualDeleteCount;)from=$String(actualStart+k),owns(O,from)&&(A[k]=O[from]),k+=1;var to,items=array_slice.call(arguments,2),itemCount=items.length;if(itemCount<actualDeleteCount){for(k=actualStart;k<len-actualDeleteCount;)from=$String(k+actualDeleteCount),to=$String(k+itemCount),owns(O,from)?O[to]=O[from]:delete O[to],k+=1;for(k=len;k>len-actualDeleteCount+itemCount;)delete O[k-1],k-=1}else if(itemCount>actualDeleteCount)for(k=len-actualDeleteCount;k>actualStart;)from=$String(k+actualDeleteCount-1),to=$String(k+itemCount-1),owns(O,from)?O[to]=O[from]:delete O[to],k-=1;k=actualStart;for(var i=0;i<items.length;++i)O[k]=items[i],k+=1;return O.length=len-actualDeleteCount+itemCount,A}},!spliceWorksWithLargeSparseArrays||!spliceWorksWithSmallSparseArrays);var hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),hasProtoEnumBug=function(){}.propertyIsEnumerable("prototype"),hasStringEnumBug=!owns("x","0"),equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},blacklistedKeys={$window:!0,$console:!0,$parent:!0,$self:!0,$frame:!0,$frames:!0,$frameElement:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0},hasAutomationEqualityBug=function(){if("undefined"==typeof window)return!1;for(var k in window)try{!blacklistedKeys["$"+k]&&owns(window,k)&&null!==window[k]&&"object"==typeof window[k]&&equalsConstructorPrototype(window[k])}catch(e){return!0}return!1}(),equalsConstructorPrototypeIfNotBuggy=function(object){if("undefined"==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(object);try{return equalsConstructorPrototype(object)}catch(e){return!1}},dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length,isStandardArguments=function(value){return"[object Arguments]"===toStr(value)},isLegacyArguments=function(value){return null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&!isArray(value)&&isCallable(value.callee)},isArguments=isStandardArguments(arguments)?isStandardArguments:isLegacyArguments;defineProperties($Object,{keys:function(object){var isFn=isCallable(object),isArgs=isArguments(object),isObject=null!==object&&"object"==typeof object,isStr=isObject&&isString(object);if(!isObject&&!isFn&&!isArgs)throw new TypeError("Object.keys called on a non-object");var theKeys=[],skipProto=hasProtoEnumBug&&isFn;if(isStr&&hasStringEnumBug||isArgs)for(var i=0;i<object.length;++i)array_push.call(theKeys,$String(i));if(!isArgs)for(var name in object)skipProto&&"prototype"===name||!owns(object,name)||array_push.call(theKeys,$String(name));if(hasDontEnumBug)for(var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object),j=0;j<dontEnumsLength;j++){var dontEnum=dontEnums[j];skipConstructor&&"constructor"===dontEnum||!owns(object,dontEnum)||array_push.call(theKeys,dontEnum)}return theKeys}});var keysWorksWithArguments=$Object.keys&&function(){return 2===$Object.keys(arguments).length}(1,2),keysHasArgumentsLengthBug=$Object.keys&&function(){var argKeys=$Object.keys(arguments);return 1!==arguments.length||1!==argKeys.length||1!==argKeys[0]}(1),originalKeys=$Object.keys;defineProperties($Object,{keys:function(object){return originalKeys(isArguments(object)?array_slice.call(object):object)}},!keysWorksWithArguments||keysHasArgumentsLengthBug);var negativeDate=-621987552e5,negativeYearString="-000001",hasNegativeDateBug=Date.prototype.toISOString&&new Date(negativeDate).toISOString().indexOf(negativeYearString)===-1,hasSafari51DateBug=Date.prototype.toISOString&&"1969-12-31T23:59:59.999Z"!==new Date((-1)).toISOString();defineProperties(Date.prototype,{toISOString:function(){var result,length,value,year,month;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(year=this.getUTCFullYear(),month=this.getUTCMonth(),year+=Math.floor(month/12),month=(month%12+12)%12,result=[month+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],year=(year<0?"-":year>9999?"+":"")+strSlice("00000"+Math.abs(year),0<=year&&year<=9999?-4:-6),length=result.length;length--;)value=result[length],value<10&&(result[length]="0"+value);return year+"-"+array_slice.call(result,0,2).join("-")+"T"+array_slice.call(result,2).join(":")+"."+strSlice("000"+this.getUTCMilliseconds(),-3)+"Z"}},hasNegativeDateBug||hasSafari51DateBug);var dateToJSONIsSupported=function(){try{return Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&new Date(negativeDate).toJSON().indexOf(negativeYearString)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(e){return!1}}();dateToJSONIsSupported||(Date.prototype.toJSON=function(key){var O=$Object(this),tv=ES.ToPrimitive(O);if("number"==typeof tv&&!isFinite(tv))return null;var toISO=O.toISOString;if(!isCallable(toISO))throw new TypeError("toISOString property is not callable");return toISO.call(O)});var supportsExtendedYears=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),acceptsInvalidDates=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z")),doesNotParseY2KNewYear=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(doesNotParseY2KNewYear||acceptsInvalidDates||!supportsExtendedYears){var maxSafeUnsigned32Bit=Math.pow(2,31)-1,hasSafariSignedIntBug=(Math.floor(maxSafeUnsigned32Bit/1e3),isActualNaN(new Date(1970,0,1,0,0,0,maxSafeUnsigned32Bit+1).getTime()));Date=function(NativeDate){var DateShim=function(Y,M,D,h,m,s,ms){var date,length=arguments.length;if(this instanceof NativeDate){var seconds=s,millis=ms;if(hasSafariSignedIntBug&&length>=7&&ms>maxSafeUnsigned32Bit){var msToShift=Math.floor(ms/maxSafeUnsigned32Bit)*maxSafeUnsigned32Bit,sToShift=Math.floor(msToShift/1e3);seconds+=sToShift,millis-=1e3*sToShift}date=1===length&&$String(Y)===Y?new NativeDate(DateShim.parse(Y)):length>=7?new NativeDate(Y,M,D,h,m,seconds,millis):length>=6?new NativeDate(Y,M,D,h,m,seconds):length>=5?new NativeDate(Y,M,D,h,m):length>=4?new NativeDate(Y,M,D,h):length>=3?new NativeDate(Y,M,D):length>=2?new NativeDate(Y,M):length>=1?new NativeDate(Y):new NativeDate}else date=NativeDate.apply(this,arguments);return isPrimitive(date)||defineProperties(date,{constructor:DateShim},!0),date},isoDateExpression=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),months=[0,31,59,90,120,151,181,212,243,273,304,334,365],dayFromMonth=function(year,month){var t=month>1?1:0;return months[month]+Math.floor((year-1969+t)/4)-Math.floor((year-1901+t)/100)+Math.floor((year-1601+t)/400)+365*(year-1970)},toUTC=function(t){var s=0,ms=t;if(hasSafariSignedIntBug&&ms>maxSafeUnsigned32Bit){var msToShift=Math.floor(ms/maxSafeUnsigned32Bit)*maxSafeUnsigned32Bit,sToShift=Math.floor(msToShift/1e3);s+=sToShift,ms-=1e3*sToShift}return $Number(new NativeDate(1970,0,1,0,0,s,ms))};for(var key in NativeDate)owns(NativeDate,key)&&(DateShim[key]=NativeDate[key]);defineProperties(DateShim,{now:NativeDate.now,UTC:NativeDate.UTC},!0),DateShim.prototype=NativeDate.prototype,defineProperties(DateShim.prototype,{constructor:DateShim},!0);var parseShim=function(string){var match=isoDateExpression.exec(string);if(match){var result,year=$Number(match[1]),month=$Number(match[2]||1)-1,day=$Number(match[3]||1)-1,hour=$Number(match[4]||0),minute=$Number(match[5]||0),second=$Number(match[6]||0),millisecond=Math.floor(1e3*$Number(match[7]||0)),isLocalTime=Boolean(match[4]&&!match[8]),signOffset="-"===match[9]?1:-1,hourOffset=$Number(match[10]||0),minuteOffset=$Number(match[11]||0),hasMinutesOrSecondsOrMilliseconds=minute>0||second>0||millisecond>0;return hour<(hasMinutesOrSecondsOrMilliseconds?24:25)&&minute<60&&second<60&&millisecond<1e3&&month>-1&&month<12&&hourOffset<24&&minuteOffset<60&&day>-1&&day<dayFromMonth(year,month+1)-dayFromMonth(year,month)&&(result=60*(24*(dayFromMonth(year,month)+day)+hour+hourOffset*signOffset),result=1e3*(60*(result+minute+minuteOffset*signOffset)+second)+millisecond,isLocalTime&&(result=toUTC(result)),-864e13<=result&&result<=864e13)?result:NaN}return NativeDate.parse.apply(this,arguments)};return defineProperties(DateShim,{parse:parseShim}),DateShim}(Date)}Date.now||(Date.now=function(){return(new Date).getTime()});var hasToFixedBugs=NumberPrototype.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0)),toFixedHelpers={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(n,c){for(var i=-1,c2=c;++i<toFixedHelpers.size;)c2+=n*toFixedHelpers.data[i],toFixedHelpers.data[i]=c2%toFixedHelpers.base,c2=Math.floor(c2/toFixedHelpers.base)},divide:function(n){for(var i=toFixedHelpers.size,c=0;--i>=0;)c+=toFixedHelpers.data[i],toFixedHelpers.data[i]=Math.floor(c/n),c=c%n*toFixedHelpers.base},numToString:function(){for(var i=toFixedHelpers.size,s="";--i>=0;)if(""!==s||0===i||0!==toFixedHelpers.data[i]){var t=$String(toFixedHelpers.data[i]);""===s?s=t:s+=strSlice("0000000",0,7-t.length)+t}return s},pow:function pow(x,n,acc){return 0===n?acc:n%2===1?pow(x,n-1,acc*x):pow(x*x,n/2,acc)},log:function(x){for(var n=0,x2=x;x2>=4096;)n+=12,x2/=4096;for(;x2>=2;)n+=1,x2/=2;return n}};defineProperties(NumberPrototype,{toFixed:function(fractionDigits){var f,x,s,m,e,z,j,k;if(f=$Number(fractionDigits),f=isActualNaN(f)?0:Math.floor(f),f<0||f>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(x=$Number(this),isActualNaN(x))return"NaN";if(x<=-1e21||x>=1e21)return $String(x);if(s="",x<0&&(s="-",x=-x),m="0",x>1e-21)if(e=toFixedHelpers.log(x*toFixedHelpers.pow(2,69,1))-69,z=e<0?x*toFixedHelpers.pow(2,-e,1):x/toFixedHelpers.pow(2,e,1),z*=4503599627370496,e=52-e,e>0){for(toFixedHelpers.multiply(0,z),j=f;j>=7;)toFixedHelpers.multiply(1e7,0),j-=7;for(toFixedHelpers.multiply(toFixedHelpers.pow(10,j,1),0),j=e-1;j>=23;)toFixedHelpers.divide(1<<23),j-=23;toFixedHelpers.divide(1<<j),toFixedHelpers.multiply(1,1),toFixedHelpers.divide(2),m=toFixedHelpers.numToString()}else toFixedHelpers.multiply(0,z),toFixedHelpers.multiply(1<<-e,0),m=toFixedHelpers.numToString()+strSlice("0.00000000000000000000",2,2+f);return f>0?(k=m.length,m=k<=f?s+strSlice("0.0000000000000000000",0,f-k+2)+m:s+strSlice(m,0,k-f)+"."+strSlice(m,k-f)):m=s+m,m}},hasToFixedBugs),2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var compliantExecNpcg="undefined"==typeof/()??/.exec("")[1],maxSafe32BitInt=Math.pow(2,32)-1;StringPrototype.split=function(separator,limit){var string=this;if("undefined"==typeof separator&&0===limit)return[];if(!isRegex(separator))return strSplit(this,separator,limit);var separator2,match,lastIndex,lastLength,output=[],flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.unicode?"u":"")+(separator.sticky?"y":""),lastLastIndex=0,separatorCopy=new RegExp(separator.source,flags+"g");string+="",compliantExecNpcg||(separator2=new RegExp("^"+separatorCopy.source+"$(?!\\s)",flags));var splitLimit="undefined"==typeof limit?maxSafe32BitInt:ES.ToUint32(limit);for(match=separatorCopy.exec(string);match&&(lastIndex=match.index+match[0].length,!(lastIndex>lastLastIndex&&(array_push.call(output,strSlice(string,lastLastIndex,match.index)),!compliantExecNpcg&&match.length>1&&match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++)"undefined"==typeof arguments[i]&&(match[i]=void 0)}),match.length>1&&match.index<string.length&&array_push.apply(output,array_slice.call(match,1)),lastLength=match[0].length,lastLastIndex=lastIndex,output.length>=splitLimit)));)separatorCopy.lastIndex===match.index&&separatorCopy.lastIndex++,match=separatorCopy.exec(string);return lastLastIndex===string.length?!lastLength&&separatorCopy.test("")||array_push.call(output,""):array_push.call(output,strSlice(string,lastLastIndex)),output.length>splitLimit?arraySlice(output,0,splitLimit):output}}():"0".split(void 0,0).length&&(StringPrototype.split=function(separator,limit){return"undefined"==typeof separator&&0===limit?[]:strSplit(this,separator,limit)});var str_replace=StringPrototype.replace,replaceReportsGroupsCorrectly=function(){var groups=[];return"x".replace(/x(.)?/g,function(match,group){array_push.call(groups,group)}),1===groups.length&&"undefined"==typeof groups[0]}();replaceReportsGroupsCorrectly||(StringPrototype.replace=function(searchValue,replaceValue){var isFn=isCallable(replaceValue),hasCapturingGroups=isRegex(searchValue)&&/\)[*?]/.test(searchValue.source);if(isFn&&hasCapturingGroups){var wrappedReplaceValue=function(match){var length=arguments.length,originalLastIndex=searchValue.lastIndex;searchValue.lastIndex=0;var args=searchValue.exec(match)||[];return searchValue.lastIndex=originalLastIndex,array_push.call(args,arguments[length-2],arguments[length-1]),replaceValue.apply(this,args)};return str_replace.call(this,searchValue,wrappedReplaceValue)}return str_replace.call(this,searchValue,replaceValue)});var string_substr=StringPrototype.substr,hasNegativeSubstrBug="".substr&&"b"!=="0b".substr(-1);defineProperties(StringPrototype,{substr:function(start,length){var normalizedStart=start;return start<0&&(normalizedStart=max(this.length+start,0)),string_substr.call(this,normalizedStart,length)}},hasNegativeSubstrBug);var ws="\t\n\x0B\f\r \u2028\u2029\ufeff",zeroWidth="",wsRegexChars="["+ws+"]",trimBeginRegexp=new RegExp("^"+wsRegexChars+wsRegexChars+"*"),trimEndRegexp=new RegExp(wsRegexChars+wsRegexChars+"*$"),hasTrimWhitespaceBug=StringPrototype.trim&&(ws.trim()||!zeroWidth.trim());defineProperties(StringPrototype,{trim:function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");return $String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}},hasTrimWhitespaceBug),8===parseInt(ws+"08")&&22===parseInt(ws+"0x16")||(parseInt=function(origParseInt){var hexRegex=/^0[xX]/;return function(str,radix){var string=$String(str).trim(),defaultedRadix=$Number(radix)||(hexRegex.test(string)?16:10);return origParseInt(string,defaultedRadix)}}(parseInt))}),function(factory){"undefined"==typeof WSDEBUG&&(window.WSDEBUG=!0);var addAsync=function(){window.asyncWebshims||(window.asyncWebshims={cfg:[],ready:[]})},start=function(){window.jQuery&&(factory(jQuery),factory=function(){return window.webshims})};window.webshims={setOptions:function(){addAsync(),window.asyncWebshims.cfg.push(arguments)},ready:function(){addAsync(),window.asyncWebshims.ready.push(arguments)},activeLang:function(lang){addAsync(),window.asyncWebshims.lang=lang},polyfill:function(features){addAsync(),window.asyncWebshims.polyfill=features},_curScript:function(){var scripts,i,scriptUrl,match,regUrl,currentScript=document.currentScript;if(WSDEBUG&&(currentScript=!1),!currentScript){try{throw new Error("")}catch(e){for(scriptUrl=(e.sourceURL||e.stack||"").split("\n"),regUrl=/(?:fil|htt|wid|abo|app|res)(.)+/i,i=0;i<scriptUrl.length;i++)if(match=scriptUrl[i].match(regUrl)){scriptUrl=match[0].replace(/[\:\s\(]+[\d\:\)\(\s]+$/,"");break}}for(scripts=document.scripts||document.getElementsByTagName("script"),i=0;i<scripts.length;i++)if(scripts[i].getAttribute("src")&&(currentScript=scripts[i],"interactive"==scripts[i].readyState||scriptUrl==scripts[i].src)){WSDEBUG&&(currentScript.wsFoundCurrent=!0);break}}return currentScript}()},window.webshim=window.webshims,window.webshims.timer=setInterval(start,0),start(),"function"==typeof define&&define.amd&&define("polyfiller",["jquery"],factory)}(function($){"use strict";function create(name){return document.createElement(name)}var firstRun,path,navigator=window.navigator,webshims=window.webshims,DOMSUPPORT="dom-support",special=$.event.special,emptyJ=$([]),asyncWebshims=window.asyncWebshims,support={},Object=window.Object,addSource=function(text){return text+"\n//# sourceURL="+this.url},getAutoEnhance=function(prop){return!(!webCFG.enhanceAuto&&"auto"==prop)&&prop},featureAlias={matchmedia:"matchMedia",xhr2:"filereader",promise:"es6",URL:"url"},supportCapture="capture"in create("input");clearInterval(webshims.timer),support.advancedObjectProperties=support.objectAccessor=support.ES5=!!("create"in Object&&"seal"in Object),!support.ES5||"toJSON"in Date.prototype||(support.ES5=!1),path=$.support.hrefNormalized===!1?webshims._curScript.getAttribute("src",4):webshims._curScript.src,path=path.split("?")[0].slice(0,path.lastIndexOf("/")+1)+"shims/",$.extend(webshims,{version:"1.15.10",cfg:{enhanceAuto:window.Audio&&(!window.matchMedia||matchMedia("(min-device-width: 721px)").matches),waitReady:!0,loadStyles:!0,wsdoc:document,wspopover:{appendTo:"auto",hideOnBlur:!0},ajax:{crossDomain:!0},loadScript:function(src,success){$.ajax($.extend({},webCFG.ajax,{url:src,success:success,dataType:"script",cache:!0,global:!1,dataFilter:addSource}))},basePath:path},support:support,bugs:{},modules:{},features:{},featureList:[],setOptions:function(name,opts){"string"==typeof name&&arguments.length>1?webCFG[name]=$.isPlainObject(opts)?$.extend(!0,webCFG[name]||{},opts):opts:"object"==typeof name&&$.extend(!0,webCFG,name)},_getAutoEnhance:getAutoEnhance,addPolyfill:function(name,cfg){cfg=cfg||{};var feature=cfg.f||name;webshimsFeatures[feature]||(webshimsFeatures[feature]=[],webshims.featureList.push(feature),webCFG[feature]={}),webshimsFeatures[feature].push(name),cfg.options=$.extend(webCFG[feature],cfg.options),addModule(name,cfg),cfg.methodNames&&$.each(cfg.methodNames,function(i,methodName){webshims.addMethodName(methodName)})},polyfill:function(){var loaded={};return function(features){if(features||(features=webshims.featureList,WSDEBUG&&webshims.warn("loading all features without specifing might be bad for performance")),"string"==typeof features&&(features=features.split(" ")),WSDEBUG)for(var i=0;i<features.length;i++)loaded[features[i]]&&webshims.error(features[i]+" already loaded, you might want to use updatePolyfill instead? see: afarkas.github.io/webshim/demos/#Shiv-dynamic-html5"),loaded[features[i]]=!0;return webshims._polyfill(features)}}(),_polyfill:function(features){var hasFormsExt,needExtStyles,toLoadFeatures=[];firstRun.run||(hasFormsExt=$.inArray("forms-ext",features)!==-1,firstRun(),needExtStyles=hasFormsExt&&!modules["form-number-date-ui"].test()||!supportCapture&&$.inArray("mediacapture",features)!==-1,hasFormsExt&&$.inArray("forms",features)==-1&&(features.push("forms"),WSDEBUG&&webshims.warn("need to load forms feature to use forms-ext feature.")),webCFG.loadStyles&&loader.loadCSS("styles/shim"+(needExtStyles?"-ext":"")+".css")),webCFG.waitReady&&($.readyWait++,onReady(features,function(){$.ready(!0)})),$.each(features,function(i,feature){return feature=featureAlias[feature]||feature,webshimsFeatures[feature]?(feature!==webshimsFeatures[feature][0]&&onReady(webshimsFeatures[feature],function(){isReady(feature,!0)}),void(toLoadFeatures=toLoadFeatures.concat(webshimsFeatures[feature]))):(WSDEBUG&&webshims.error("could not find webshims-feature (aborted): "+feature),void isReady(feature,!0))}),loadList(toLoadFeatures),$.each(features,function(i,feature){var o=webCFG[feature];o&&("mediaelement"==feature&&(o.replaceUI=getAutoEnhance(o.replaceUI))&&o.plugins.unshift("mediacontrols"),o.plugins&&o.plugins.length&&loadList(webCFG[feature].plugins))})},reTest:function(){var resList,reTest=function(i,name){var module=modules[name],readyName=name+"Ready";!module||module.loaded||(module.test&&$.isFunction(module.test)?module.test([]):module.test)||(special[readyName]&&delete special[readyName],webshimsFeatures[module.f],resList.push(name))};return function(moduleNames){"string"==typeof moduleNames&&(moduleNames=moduleNames.split(" ")),resList=[],$.each(moduleNames,reTest),loadList(resList)}}(),isReady:function(name,_set){if(name+="Ready",_set){if(special[name]&&special[name].add)return!0;special[name]=$.extend(special[name]||{},{add:function(details){details.handler.call(this,name)}}),$(document).triggerHandler(name)}return!(!special[name]||!special[name].add)||!1},ready:function(events,fn){var _created=arguments[2];if("string"==typeof events&&(events=events.split(" ")),_created||(events=$.map($.grep(events,function(evt){return!isReady(evt)}),function(evt){return evt+"Ready"})),!events.length)return void fn($,webshims,window,document);var readyEv=events.shift(),readyFn=function(){onReady(events,fn,!0)};$(document).one(readyEv,readyFn)},capturingEvents:function(names,_maybePrevented){document.addEventListener&&("string"==typeof names&&(names=[names]),$.each(names,function(i,name){var handler=function(e){return e=$.event.fix(e),_maybePrevented&&webshims.capturingEventPrevented&&webshims.capturingEventPrevented(e),$.event.dispatch.call(this,e)};special[name]=special[name]||{},special[name].setup||special[name].teardown||$.extend(special[name],{setup:function(){this.addEventListener(name,handler,!0)},teardown:function(){this.removeEventListener(name,handler,!0)}})}))},register:function(name,fn){var module=modules[name];if(!module)return void webshims.error("can't find module: "+name);module.loaded=!0;var ready=function(){fn($,webshims,window,document,void 0,module.options),isReady(name,!0)};module.d&&module.d.length?onReady(module.d,ready):ready();
},c:{},loader:{addModule:function(name,ext){modules[name]=ext,ext.name=ext.name||name,ext.c||(ext.c=[]),$.each(ext.c,function(i,comboname){webshims.c[comboname]||(webshims.c[comboname]=[]),webshims.c[comboname].push(name)})},loadList:function(){var loadedModules=[],loadScript=function(src,names){"string"==typeof names&&(names=[names]),$.merge(loadedModules,names),loader.loadScript(src,!1,names)},noNeedToLoad=function(name,list){if(isReady(name)||$.inArray(name,loadedModules)!=-1)return!0;var supported,module=modules[name];return!module||(supported=module.test&&$.isFunction(module.test)?module.test(list):module.test,!!supported&&(isReady(name,!0),!0))},setDependencies=function(module,list){if(module.d&&module.d.length){var addDependency=function(i,dependency){noNeedToLoad(dependency,list)||$.inArray(dependency,list)!=-1||list.push(dependency)};$.each(module.d,function(i,dependency){modules[dependency]?modules[dependency].loaded||addDependency(i,dependency):webshimsFeatures[dependency]&&($.each(webshimsFeatures[dependency],addDependency),onReady(webshimsFeatures[dependency],function(){isReady(dependency,!0)}))}),module.noAutoCallback||(module.noAutoCallback=!0)}};return function(list){var module,i,len,foundCombo,loadCombos=[],loadCombo=function(j,combo){if(foundCombo=combo,$.each(webshims.c[combo],function(i,moduleName){if($.inArray(moduleName,loadCombos)==-1||$.inArray(moduleName,loadedModules)!=-1)return foundCombo=!1,!1}),foundCombo)return loadScript("combos/"+foundCombo,webshims.c[foundCombo]),!1};for(i=0;i<list.length;i++)module=modules[list[i]],module&&!noNeedToLoad(module.name,list)?(module.css&&webCFG.loadStyles&&loader.loadCSS(module.css),module.loadInit&&module.loadInit(),setDependencies(module,list),module.loaded||loadCombos.push(module.name),module.loaded=!0):WSDEBUG&&!module&&webshims.warn("could not find: "+list[i]);for(i=0,len=loadCombos.length;i<len;i++)foundCombo=!1,module=loadCombos[i],$.inArray(module,loadedModules)==-1&&("noCombo"!=webCFG.debug&&$.each(modules[module].c,loadCombo),foundCombo||loadScript(modules[module].src||module,module))}}(),makePath:function(src){return src.indexOf("//")!=-1||0===src.indexOf("/")?src:(src.indexOf(".")==-1&&(src+=".js"),webCFG.addCacheBuster&&(src+=webCFG.addCacheBuster),webCFG.basePath+src)},loadCSS:function(){var parent,loadedSrcs={};return function(src){src=this.makePath(src),loadedSrcs[src]||(parent=parent||$("link, style")[0]||$("script")[0],loadedSrcs[src]=1,$('<link rel="stylesheet" />').insertBefore(parent).attr({href:src}))}}(),loadScript:function(){var loadedSrcs={};return function(src,callback,name,noShimPath){if(noShimPath||(src=loader.makePath(src)),!loadedSrcs[src]){var complete=function(){callback&&callback(),name&&("string"==typeof name&&(name=name.split(" ")),$.each(name,function(i,name){modules[name]&&(modules[name].afterLoad&&modules[name].afterLoad(),isReady(modules[name].noAutoCallback?name+"FileLoaded":name,!0))}))};loadedSrcs[src]=1,webCFG.loadScript(src,complete,$.noop)}}}()}});var webCFG=webshims.cfg,webshimsFeatures=webshims.features,isReady=webshims.isReady,onReady=webshims.ready,addPolyfill=webshims.addPolyfill,modules=webshims.modules,loader=webshims.loader,loadList=loader.loadList,addModule=loader.addModule,bugs=webshims.bugs,removeCombos=[],importantLogs={warn:1,error:1},$fn=$.fn,video=create("video");webshims.addMethodName=function(name){name=name.split(":");var prop=name[1];1==name.length?(prop=name[0],name=name[0]):name=name[0],$fn[name]=function(){return this.callProp(prop,arguments)}},$fn.callProp=function(prop,args){var ret;return args||(args=[]),this.each(function(){var fn=$.prop(this,prop);if(fn&&fn.apply){if(ret=fn.apply(this,args),void 0!==ret)return!1}else webshims.warn(prop+" is not a method of "+this)}),void 0!==ret?ret:this},webshims.activeLang=function(){"language"in navigator||(navigator.language=navigator.browserLanguage||"");var curLang=$.attr(document.documentElement,"lang")||navigator.language;return onReady("webshimLocalization",function(){webshims.activeLang(curLang)}),function(lang){if(lang)if("string"==typeof lang)curLang=lang;else if("object"==typeof lang){var args=arguments,that=this;onReady("webshimLocalization",function(){webshims.activeLang.apply(that,args)})}return curLang}}(),webshims.errorLog=[],$.each(["log","error","warn","info"],function(i,fn){webshims[fn]=function(message){(importantLogs[fn]&&webCFG.debug!==!1||webCFG.debug)&&(webshims.errorLog.push(message),window.console&&console.log&&console[console[fn]?fn:"log"](message))}}),WSDEBUG&&(webshims._curScript.wsFoundCurrent||webshims.error("Could not detect currentScript! Use basePath to set script path.")),function(){$.isDOMReady=$.isReady;var onReady=function(){$.isDOMReady=!0,isReady("DOM",!0),setTimeout(function(){isReady("WINDOWLOAD",!0)},9999)};firstRun=function(){if(!firstRun.run){if(WSDEBUG&&$.mobile&&($.mobile.textinput||$.mobile.rangeslider||$.mobile.button)&&(webshims.info('jQM textinput/rangeslider/button detected waitReady was set to false. Use webshims.ready("featurename") to script against polyfilled methods/properties'),webCFG.readyEvt||webshims.error('in a jQuery mobile enviroment: you should change the readyEvt to "pageinit".'),webCFG.waitReady&&webshims.error("in a jQuery mobile enviroment: you should change the waitReady to false.")),WSDEBUG&&webCFG.waitReady&&$.isReady&&webshims.warn("Call webshims.polyfill before DOM-Ready or set waitReady to false."),!$.isDOMReady&&webCFG.waitReady){var $Ready=$.ready;$.ready=function(unwait){return unwait!==!0&&document.body&&onReady(),$Ready.apply(this,arguments)},$.ready.promise=$Ready.promise}webCFG.readyEvt?$(document).one(webCFG.readyEvt,onReady):$(onReady)}firstRun.run=!0},$(window).on("load",function(){onReady(),setTimeout(function(){isReady("WINDOWLOAD",!0)},9)});var readyFns=[],eachTrigger=function(){1==this.nodeType&&webshims.triggerDomUpdate(this)};$.extend(webshims,{addReady:function(fn){var readyFn=function(context,elem){webshims.ready("DOM",function(){fn(context,elem)})};readyFns.push(readyFn),webCFG.wsdoc&&readyFn(webCFG.wsdoc,emptyJ)},triggerDomUpdate:function(context){if(!context||!context.nodeType)return void(context&&context.jquery&&context.each(function(){webshims.triggerDomUpdate(this)}));var type=context.nodeType;if(1==type||9==type){var elem=context!==document?$(context):emptyJ;$.each(readyFns,function(i,fn){fn(context,elem)})}}}),$fn.clonePolyfill=$fn.clone,$fn.htmlPolyfill=function(a){if(!arguments.length)return $(this.clonePolyfill()).html();var ret=$fn.html.call(this,a);return ret===this&&$.isDOMReady&&this.each(eachTrigger),ret},$fn.jProp=function(){return this.pushStack($($fn.prop.apply(this,arguments)||[]))},$.each(["after","before","append","prepend","replaceWith"],function(i,name){$fn[name+"Polyfill"]=function(a){return a=$(a),$fn[name].call(this,a),$.isDOMReady&&a.each(eachTrigger),this}}),$.each(["insertAfter","insertBefore","appendTo","prependTo","replaceAll"],function(i,name){$fn[name.replace(/[A-Z]/,function(c){return"Polyfill"+c})]=function(){return $fn[name].apply(this,arguments),$.isDOMReady&&webshims.triggerDomUpdate(this),this}}),$fn.updatePolyfill=function(){return $.isDOMReady&&webshims.triggerDomUpdate(this),this},$.each(["getNativeElement","getShadowElement","getShadowFocusElement"],function(i,name){$fn[name]=function(){return this.pushStack(this)}})}(),WSDEBUG&&(webCFG.debug=!0),Object.create&&(webshims.objectCreate=function(proto,props,opts){WSDEBUG&&props&&webshims.error("second argument for webshims.objectCreate is only available with DOM support");var o=Object.create(proto);return opts&&(o.options=$.extend(!0,{},o.options||{},opts),opts=o.options),o._create&&$.isFunction(o._create)&&o._create(opts),o}),addModule("swfmini",{test:function(){return window.swfobject&&!window.swfmini&&(window.swfmini=window.swfobject),"swfmini"in window},c:[16,7,2,8,1,12,23]}),modules.swfmini.test(),addModule("sizzle",{test:$.expr.filters}),addPolyfill("es5",{test:!(!support.ES5||!Function.prototype.bind),d:["sizzle"]}),addPolyfill("dom-extend",{f:DOMSUPPORT,noAutoCallback:!0,d:["es5"],c:[16,7,2,15,30,3,8,4,9,10,25,31,34]}),create("picture"),addPolyfill("picture",{test:"picturefill"in window||!!window.HTMLPictureElement||"respimage"in window,d:["matchMedia"],c:[18],loadInit:function(){isReady("picture",!0)}}),addPolyfill("matchMedia",{test:!(!window.matchMedia||!matchMedia("all").addListener),c:[18]}),addPolyfill("sticky",{test:($(create("b")).attr("style","position: -webkit-sticky; position: sticky").css("position")||"").indexOf("sticky")!=-1,d:["es5","matchMedia"]}),addPolyfill("es6",{test:!!(Math.imul&&Number.MIN_SAFE_INTEGER&&Object.is&&window.Promise&&Promise.all),d:["es5"]}),addPolyfill("geolocation",{test:"geolocation"in navigator,options:{destroyWrite:!0},c:[21]}),function(){addPolyfill("canvas",{src:"excanvas",test:"getContext"in create("canvas"),options:{type:"flash"},noAutoCallback:!0,loadInit:function(){var type=this.options.type;!type||type.indexOf("flash")===-1||modules.swfmini.test()&&!swfmini.hasFlashPlayerVersion("9.0.0")||(this.src="flash"==type?"FlashCanvas/flashcanvas":"FlashCanvasPro/flashcanvas")},methodNames:["getContext"],d:[DOMSUPPORT]})}();var userMediaTest="getUserMedia"in navigator;addPolyfill("usermedia-core",{f:"usermedia",test:userMediaTest&&window.URL,d:["url",DOMSUPPORT]}),addPolyfill("usermedia-shim",{f:"usermedia",test:!!(userMediaTest||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),d:["url","mediaelement",DOMSUPPORT]}),addPolyfill("mediacapture",{test:supportCapture,d:["swfmini","usermedia",DOMSUPPORT,"filereader","forms","canvas"]}),function(){var formExtend,formOptions,fShim="form-shim-extend",formvalidation="formvalidation",fNuAPI="form-number-date-api",bustedValidity=!1,bustedWidgetUi=!1,replaceBustedUI=!1,inputtypes={},progress=create("progress"),output=create("output"),initialFormTest=function(){var tmp,fieldset,testValue="1(",input=create("input");if(fieldset=$('<fieldset><textarea required="" /></fieldset>')[0],support.inputtypes=inputtypes,$.each(["range","date","datetime-local","month","color","number"],function(i,type){input.setAttribute("type",type),inputtypes[type]=input.type==type&&(input.value=testValue)&&input.value!=testValue}),support.datalist=!!("options"in create("datalist")&&window.HTMLDataListElement),support[formvalidation]="checkValidity"in input,support.fieldsetelements="elements"in fieldset,support.fieldsetdisabled="disabled"in fieldset){try{fieldset.querySelector(":invalid")&&(fieldset.disabled=!0,tmp=!fieldset.querySelector(":invalid")&&fieldset.querySelector(":disabled"))}catch(er){}support.fieldsetdisabled=!!tmp}if(support[formvalidation]&&(bustedWidgetUi=!(support.fieldsetdisabled&&support.fieldsetelements&&"value"in progress&&"value"in output),replaceBustedUI=bustedWidgetUi&&/Android/i.test(navigator.userAgent),bustedValidity=window.opera||bugs.bustedValidity||bustedWidgetUi||!support.datalist,!bustedValidity&&inputtypes.number)){bustedValidity=!0;try{input.type="number",input.value="",input.stepUp(),bustedValidity="1"!=input.value}catch(e){}}return bugs.bustedValidity=bustedValidity,formExtend=support[formvalidation]&&!bustedValidity?"form-native-extend":fShim,initialFormTest=$.noop,!1},typeTest=function(o){var ret=!0;return o._types||(o._types=o.types.split(" ")),$.each(o._types,function(i,name){if(name in inputtypes&&!inputtypes[name])return ret=!1,!1}),ret};webshims.validationMessages=webshims.validityMessages={langSrc:"i18n/formcfg-",availableLangs:"ar bg ca cs el es fa fi fr he hi hu it ja lt nl no pl pt pt-BR pt-PT ru sv zh-CN zh-TW".split(" ")},webshims.formcfg=$.extend({},webshims.validationMessages),webshims.inputTypes={},addPolyfill("form-core",{f:"forms",test:initialFormTest,d:["es5"],options:{placeholderType:"value",messagePopover:{},list:{popover:{constrainWidth:!0}},iVal:{sel:".ws-validate",handleBubble:"hide",recheckDelay:400}},methodNames:["setCustomValidity","checkValidity","setSelectionRange"],c:[16,7,2,8,1,15,30,3,31]}),formOptions=webCFG.forms,addPolyfill("form-native-extend",{f:"forms",test:function(toLoad){return initialFormTest(),!support[formvalidation]||bustedValidity||$.inArray(fNuAPI,toLoad||[])==-1||modules[fNuAPI].test()},d:["form-core",DOMSUPPORT,"form-message"],c:[6,5,14,29]}),addPolyfill(fShim,{f:"forms",test:function(){return initialFormTest(),support[formvalidation]&&!bustedValidity},d:["form-core",DOMSUPPORT,"sizzle"],c:[16,15,28]}),addPolyfill(fShim+"2",{f:"forms",test:function(){return initialFormTest(),support[formvalidation]&&!bustedWidgetUi},d:[fShim],c:[27]}),addPolyfill("form-message",{f:"forms",test:function(toLoad){return initialFormTest(),!(formOptions.customMessages||!support[formvalidation]||bustedValidity||!modules[formExtend].test(toLoad))},d:[DOMSUPPORT],c:[16,7,15,30,3,8,4,14,28]}),addPolyfill(fNuAPI,{f:"forms-ext",options:{types:"date time range number"},test:function(){initialFormTest();var ret=!bustedValidity;return ret&&(ret=typeTest(this.options)),ret},methodNames:["stepUp","stepDown"],d:["forms",DOMSUPPORT],c:[6,5,17,14,28,29,33]}),addModule("range-ui",{options:{},noAutoCallback:!0,test:function(){return!!$fn.rangeUI},d:["es5"],c:[6,5,9,10,17,11]}),addPolyfill("form-number-date-ui",{f:"forms-ext",test:function(){var o=this.options;return o.replaceUI=getAutoEnhance(o.replaceUI),initialFormTest(),!o.replaceUI&&replaceBustedUI&&(o.replaceUI=!0),!o.replaceUI&&typeTest(o)},d:["forms",DOMSUPPORT,fNuAPI,"range-ui"],options:{widgets:{calculateWidth:!0,animate:!0}},c:[6,5,9,10,17,11]}),addPolyfill("form-datalist",{f:"forms",test:function(){return initialFormTest(),replaceBustedUI&&(formOptions.customDatalist=!0),support.datalist&&!formOptions.fD},d:["form-core",DOMSUPPORT],c:[16,7,6,2,9,15,30,31,28,33]})}();var supportFileReader="FileReader"in window&&"FormData"in window;return addPolyfill("filereader-xhr",{f:"filereader",test:supportFileReader,d:[DOMSUPPORT,"swfmini"],c:[25,27]}),addPolyfill("canvas-blob",{f:"filereader",methodNames:["toBlob"],test:!(supportFileReader&&!create("canvas").toBlob)}),addPolyfill("details",{test:"open"in create("details"),d:[DOMSUPPORT],options:{text:"Details"},c:[21,22]}),addPolyfill("url",{test:function(){var support=!1;try{support=new URL("b","http://a"),support=!(!support.searchParams||"http://a/b"!=support.href)}catch(e){}return support},d:["es5"]}),function(){webshims.mediaelement={};var track=create("track");if(support.mediaelement="canPlayType"in video,support.texttrackapi="addTextTrack"in video,support.track="kind"in track,create("audio"),!(bugs.track=!support.texttrackapi))try{bugs.track=!("oncuechange"in video.addTextTrack("metadata"))}catch(e){}addPolyfill("mediaelement-core",{f:"mediaelement",noAutoCallback:!0,options:{jme:{},plugins:[],vars:{},params:{},attrs:{},changeSWF:$.noop},methodNames:["play","pause","canPlayType","mediaLoad:load"],d:["swfmini"],c:[16,7,2,8,1,12,13,23]}),addPolyfill("mediaelement-jaris",{f:"mediaelement",d:["mediaelement-core",DOMSUPPORT],test:function(){var options=this.options;return!(!support.mediaelement||webshims.mediaelement.loadSwf)&&(options.preferFlash&&!modules.swfmini.test()&&(options.preferFlash=!1),!(options.preferFlash&&swfmini.hasFlashPlayerVersion("11.3")))},c:[21,25]}),addPolyfill("track",{options:{positionDisplay:!0,override:bugs.track},test:function(){var o=this.options;return o.override=getAutoEnhance(o.override),!o.override&&!bugs.track},d:["mediaelement",DOMSUPPORT],methodNames:["addTextTrack"],c:[21,12,13,22,34]}),addModule("jmebase",{src:"jme/base",c:[98,99,97]}),$.each([["mediacontrols",{c:[98,99],css:"jme/controls.css"}],["playlist",{c:[98,97]}],["alternate-media"]],function(i,plugin){addModule(plugin[0],$.extend({src:"jme/"+plugin[0],d:["jmebase"]},plugin[1]))}),addModule("track-ui",{d:["track",DOMSUPPORT]})}(),addPolyfill("feature-dummy",{test:!0,loaded:!0,c:removeCombos}),webshims.$=$,$.webshims=webshims,$.webshim=webshim,webshims.callAsync=function(){webshims.callAsync=$.noop,asyncWebshims&&(asyncWebshims.cfg&&(asyncWebshims.cfg.length||(asyncWebshims.cfg=[[asyncWebshims.cfg]]),$.each(asyncWebshims.cfg,function(i,cfg){webshims.setOptions.apply(webshims,cfg)})),asyncWebshims.ready&&$.each(asyncWebshims.ready,function(i,ready){webshims.ready.apply(webshims,ready)}),asyncWebshims.lang&&webshims.activeLang(asyncWebshims.lang),"polyfill"in asyncWebshims&&webshims.polyfill(asyncWebshims.polyfill)),webshims.isReady("jquery",!0)},webshims.callAsync(),webshims}),!function(a){var b=function(){window.asyncWebshims||(window.asyncWebshims={cfg:[],ready:[]})},c=function(){window.jQuery&&(a(jQuery),a=function(){return window.webshims})};window.webshims={setOptions:function(){b(),window.asyncWebshims.cfg.push(arguments)},ready:function(){b(),window.asyncWebshims.ready.push(arguments)},activeLang:function(a){b(),window.asyncWebshims.lang=a},polyfill:function(a){b(),window.asyncWebshims.polyfill=a},_curScript:function(){var a,b,c,d,e,f=document.currentScript;if(!f){try{throw new Error("")}catch(g){for(c=(g.sourceURL||g.stack||"").split("\n"),e=/(?:fil|htt|wid|abo|app|res)(.)+/i,b=0;b<c.length;b++)if(d=c[b].match(e)){c=d[0].replace(/[\:\s\(]+[\d\:\)\(\s]+$/,"");break}}for(a=document.scripts||document.getElementsByTagName("script"),b=0;b<a.length&&(!a[b].getAttribute("src")||(f=a[b],"interactive"!=a[b].readyState&&c!=a[b].src));b++);}return f}()},window.webshim=window.webshims,window.webshims.timer=setInterval(c,0),c(),"function"==typeof define&&define.amd&&define("polyfiller",["jquery"],a)}(function(a){"use strict";function b(a){return document.createElement(a)}var c,d,e=window.navigator,f=window.webshims,g="dom-support",h=a.event.special,i=a([]),j=window.asyncWebshims,k={},l=window.Object,m=function(a){return a+"\n//# sourceURL="+this.url},n=function(a){return!(!q.enhanceAuto&&"auto"==a)&&a},o={matchmedia:"matchMedia",xhr2:"filereader",promise:"es6",URL:"url"},p="capture"in b("input");clearInterval(f.timer),k.advancedObjectProperties=k.objectAccessor=k.ES5=!!("create"in l&&"seal"in l),!k.ES5||"toJSON"in Date.prototype||(k.ES5=!1),d=a.support.hrefNormalized===!1?f._curScript.getAttribute("src",4):f._curScript.src,d=d.split("?")[0].slice(0,d.lastIndexOf("/")+1)+"shims/",a.extend(f,{version:"1.15.10",cfg:{enhanceAuto:window.Audio&&(!window.matchMedia||matchMedia("(min-device-width: 721px)").matches),waitReady:!0,loadStyles:!0,wsdoc:document,wspopover:{appendTo:"auto",hideOnBlur:!0},ajax:{crossDomain:!0},loadScript:function(b,c){a.ajax(a.extend({},q.ajax,{url:b,success:c,dataType:"script",cache:!0,global:!1,dataFilter:m}))},basePath:d},support:k,bugs:{},modules:{},features:{},featureList:[],setOptions:function(b,c){"string"==typeof b&&arguments.length>1?q[b]=a.isPlainObject(c)?a.extend(!0,q[b]||{},c):c:"object"==typeof b&&a.extend(!0,q,b)},_getAutoEnhance:n,addPolyfill:function(b,c){c=c||{};var d=c.f||b;r[d]||(r[d]=[],f.featureList.push(d),q[d]={}),r[d].push(b),c.options=a.extend(q[d],c.options),y(b,c),c.methodNames&&a.each(c.methodNames,function(a,b){f.addMethodName(b)})},polyfill:function(){return function(a){return a||(a=f.featureList),"string"==typeof a&&(a=a.split(" ")),f._polyfill(a)}}(),_polyfill:function(b){var d,e,f=[];c.run||(d=-1!==a.inArray("forms-ext",b),c(),e=d&&!v["form-number-date-ui"].test()||!p&&-1!==a.inArray("mediacapture",b),d&&-1==a.inArray("forms",b)&&b.push("forms"),q.loadStyles&&w.loadCSS("styles/shim"+(e?"-ext":"")+".css")),q.waitReady&&(a.readyWait++,t(b,function(){a.ready(!0)})),a.each(b,function(a,b){return b=o[b]||b,r[b]?(b!==r[b][0]&&t(r[b],function(){s(b,!0)}),void(f=f.concat(r[b]))):void s(b,!0)}),x(f),a.each(b,function(a,b){var c=q[b];c&&("mediaelement"==b&&(c.replaceUI=n(c.replaceUI))&&c.plugins.unshift("mediacontrols"),c.plugins&&c.plugins.length&&x(q[b].plugins))})},reTest:function(){var b,c=function(c,d){var e=v[d],f=d+"Ready";!e||e.loaded||(e.test&&a.isFunction(e.test)?e.test([]):e.test)||(h[f]&&delete h[f],r[e.f],b.push(d))};return function(d){"string"==typeof d&&(d=d.split(" ")),b=[],a.each(d,c),x(b)}}(),isReady:function(b,c){if(b+="Ready",c){if(h[b]&&h[b].add)return!0;h[b]=a.extend(h[b]||{},{add:function(a){a.handler.call(this,b)}}),a(document).triggerHandler(b)}return!(!h[b]||!h[b].add)||!1},ready:function(b,c){var d=arguments[2];if("string"==typeof b&&(b=b.split(" ")),d||(b=a.map(a.grep(b,function(a){return!s(a)}),function(a){return a+"Ready"})),!b.length)return void c(a,f,window,document);var e=b.shift(),g=function(){t(b,c,!0)};a(document).one(e,g)},capturingEvents:function(b,c){document.addEventListener&&("string"==typeof b&&(b=[b]),a.each(b,function(b,d){var e=function(b){return b=a.event.fix(b),c&&f.capturingEventPrevented&&f.capturingEventPrevented(b),a.event.dispatch.call(this,b)};h[d]=h[d]||{},h[d].setup||h[d].teardown||a.extend(h[d],{setup:function(){this.addEventListener(d,e,!0)},teardown:function(){this.removeEventListener(d,e,!0)}})}))},register:function(b,c){var d=v[b];if(!d)return void f.error("can't find module: "+b);d.loaded=!0;var e=function(){c(a,f,window,document,void 0,d.options),s(b,!0)};d.d&&d.d.length?t(d.d,e):e()},c:{},loader:{addModule:function(b,c){v[b]=c,c.name=c.name||b,c.c||(c.c=[]),a.each(c.c,function(a,c){f.c[c]||(f.c[c]=[]),f.c[c].push(b)})},loadList:function(){var b=[],c=function(c,d){"string"==typeof d&&(d=[d]),a.merge(b,d),w.loadScript(c,!1,d)},d=function(c,d){if(s(c)||-1!=a.inArray(c,b))return!0;var e,f=v[c];return!f||(e=f.test&&a.isFunction(f.test)?f.test(d):f.test,!!e&&(s(c,!0),!0))},e=function(b,c){if(b.d&&b.d.length){var e=function(b,e){d(e,c)||-1!=a.inArray(e,c)||c.push(e)};a.each(b.d,function(b,c){v[c]?v[c].loaded||e(b,c):r[c]&&(a.each(r[c],e),t(r[c],function(){s(c,!0)}))}),b.noAutoCallback||(b.noAutoCallback=!0)}};return function(g){var h,i,j,k,l=[],m=function(d,e){return k=e,a.each(f.c[e],function(c,d){return-1==a.inArray(d,l)||-1!=a.inArray(d,b)?(k=!1,!1):void 0}),k?(c("combos/"+k,f.c[k]),!1):void 0};for(i=0;i<g.length;i++)h=v[g[i]],h&&!d(h.name,g)&&(h.css&&q.loadStyles&&w.loadCSS(h.css),h.loadInit&&h.loadInit(),e(h,g),h.loaded||l.push(h.name),h.loaded=!0);for(i=0,j=l.length;j>i;i++)k=!1,h=l[i],-1==a.inArray(h,b)&&("noCombo"!=q.debug&&a.each(v[h].c,m),k||c(v[h].src||h,h))}}(),makePath:function(a){return-1!=a.indexOf("//")||0===a.indexOf("/")?a:(-1==a.indexOf(".")&&(a+=".js"),q.addCacheBuster&&(a+=q.addCacheBuster),q.basePath+a)},loadCSS:function(){var b,c={};return function(d){d=this.makePath(d),c[d]||(b=b||a("link, style")[0]||a("script")[0],c[d]=1,a('<link rel="stylesheet" />').insertBefore(b).attr({href:d}))}}(),loadScript:function(){var b={};return function(c,d,e,f){if(f||(c=w.makePath(c)),!b[c]){var g=function(){d&&d(),e&&("string"==typeof e&&(e=e.split(" ")),a.each(e,function(a,b){v[b]&&(v[b].afterLoad&&v[b].afterLoad(),s(v[b].noAutoCallback?b+"FileLoaded":b,!0))}))};b[c]=1,q.loadScript(c,g,a.noop)}}}()}});var q=f.cfg,r=f.features,s=f.isReady,t=f.ready,u=f.addPolyfill,v=f.modules,w=f.loader,x=w.loadList,y=w.addModule,z=f.bugs,A=[],B={warn:1,error:1},C=a.fn,D=b("video");f.addMethodName=function(a){a=a.split(":");var b=a[1];1==a.length?(b=a[0],a=a[0]):a=a[0],C[a]=function(){return this.callProp(b,arguments)}},C.callProp=function(b,c){var d;return c||(c=[]),this.each(function(){var e=a.prop(this,b);if(e&&e.apply){if(d=e.apply(this,c),void 0!==d)return!1}else f.warn(b+" is not a method of "+this)}),void 0!==d?d:this},f.activeLang=function(){"language"in e||(e.language=e.browserLanguage||"");var b=a.attr(document.documentElement,"lang")||e.language;return t("webshimLocalization",function(){f.activeLang(b)}),function(a){if(a)if("string"==typeof a)b=a;else if("object"==typeof a){var c=arguments,d=this;t("webshimLocalization",function(){f.activeLang.apply(d,c)})}return b}}(),f.errorLog=[],a.each(["log","error","warn","info"],function(a,b){f[b]=function(a){(B[b]&&q.debug!==!1||q.debug)&&(f.errorLog.push(a),window.console&&console.log&&console[console[b]?b:"log"](a))}}),function(){a.isDOMReady=a.isReady;var b=function(){a.isDOMReady=!0,s("DOM",!0),setTimeout(function(){s("WINDOWLOAD",!0)},9999)};c=function(){if(!c.run){if(!a.isDOMReady&&q.waitReady){var d=a.ready;a.ready=function(a){return a!==!0&&document.body&&b(),d.apply(this,arguments)},a.ready.promise=d.promise}q.readyEvt?a(document).one(q.readyEvt,b):a(b)}c.run=!0},a(window).on("load",function(){b(),setTimeout(function(){s("WINDOWLOAD",!0)},9)});var d=[],e=function(){1==this.nodeType&&f.triggerDomUpdate(this)};a.extend(f,{addReady:function(a){var b=function(b,c){f.ready("DOM",function(){a(b,c)})};d.push(b),q.wsdoc&&b(q.wsdoc,i)},triggerDomUpdate:function(b){if(!b||!b.nodeType)return void(b&&b.jquery&&b.each(function(){f.triggerDomUpdate(this)}));var c=b.nodeType;if(1==c||9==c){var e=b!==document?a(b):i;a.each(d,function(a,c){c(b,e)})}}}),C.clonePolyfill=C.clone,C.htmlPolyfill=function(b){if(!arguments.length)return a(this.clonePolyfill()).html();var c=C.html.call(this,b);return c===this&&a.isDOMReady&&this.each(e),c},C.jProp=function(){return this.pushStack(a(C.prop.apply(this,arguments)||[]))},a.each(["after","before","append","prepend","replaceWith"],function(b,c){C[c+"Polyfill"]=function(b){return b=a(b),C[c].call(this,b),a.isDOMReady&&b.each(e),this}}),a.each(["insertAfter","insertBefore","appendTo","prependTo","replaceAll"],function(b,c){C[c.replace(/[A-Z]/,function(a){return"Polyfill"+a})]=function(){return C[c].apply(this,arguments),a.isDOMReady&&f.triggerDomUpdate(this),this}}),C.updatePolyfill=function(){return a.isDOMReady&&f.triggerDomUpdate(this),this},a.each(["getNativeElement","getShadowElement","getShadowFocusElement"],function(a,b){C[b]=function(){return this.pushStack(this)}})}(),l.create&&(f.objectCreate=function(b,c,d){var e=l.create(b);return d&&(e.options=a.extend(!0,{},e.options||{},d),d=e.options),e._create&&a.isFunction(e._create)&&e._create(d),e}),y("swfmini",{test:function(){return window.swfobject&&!window.swfmini&&(window.swfmini=window.swfobject),"swfmini"in window},c:[16,7,2,8,1,12,23]}),v.swfmini.test(),y("sizzle",{test:a.expr.filters}),u("es5",{test:!(!k.ES5||!Function.prototype.bind),d:["sizzle"]}),u("dom-extend",{f:g,noAutoCallback:!0,d:["es5"],c:[16,7,2,15,30,3,8,4,9,10,25,31,34]}),b("picture"),u("picture",{test:"picturefill"in window||!!window.HTMLPictureElement||"respimage"in window,d:["matchMedia"],c:[18],loadInit:function(){s("picture",!0)}}),u("matchMedia",{test:!(!window.matchMedia||!matchMedia("all").addListener),c:[18]}),u("sticky",{test:-1!=(a(b("b")).attr("style","position: -webkit-sticky; position: sticky").css("position")||"").indexOf("sticky"),d:["es5","matchMedia"]}),u("es6",{test:!!(Math.imul&&Number.MIN_SAFE_INTEGER&&l.is&&window.Promise&&Promise.all),d:["es5"]}),u("geolocation",{test:"geolocation"in e,options:{destroyWrite:!0},c:[21]}),function(){u("canvas",{src:"excanvas",test:"getContext"in b("canvas"),options:{type:"flash"},noAutoCallback:!0,loadInit:function(){var a=this.options.type;!a||-1===a.indexOf("flash")||v.swfmini.test()&&!swfmini.hasFlashPlayerVersion("9.0.0")||(this.src="flash"==a?"FlashCanvas/flashcanvas":"FlashCanvasPro/flashcanvas")},methodNames:["getContext"],d:[g]})}();var E="getUserMedia"in e;u("usermedia-core",{f:"usermedia",test:E&&window.URL,d:["url",g]}),u("usermedia-shim",{f:"usermedia",test:!!(E||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia),d:["url","mediaelement",g]}),u("mediacapture",{test:p,d:["swfmini","usermedia",g,"filereader","forms","canvas"]}),function(){var c,d,h="form-shim-extend",i="formvalidation",j="form-number-date-api",l=!1,m=!1,o=!1,p={},r=b("progress"),s=b("output"),t=function(){var d,f,g="1(",j=b("input");if(f=a('<fieldset><textarea required="" /></fieldset>')[0],k.inputtypes=p,a.each(["range","date","datetime-local","month","color","number"],function(a,b){j.setAttribute("type",b),p[b]=j.type==b&&(j.value=g)&&j.value!=g}),k.datalist=!!("options"in b("datalist")&&window.HTMLDataListElement),k[i]="checkValidity"in j,k.fieldsetelements="elements"in f,k.fieldsetdisabled="disabled"in f){try{f.querySelector(":invalid")&&(f.disabled=!0,d=!f.querySelector(":invalid")&&f.querySelector(":disabled"))}catch(n){}k.fieldsetdisabled=!!d}if(k[i]&&(m=!(k.fieldsetdisabled&&k.fieldsetelements&&"value"in r&&"value"in s),o=m&&/Android/i.test(e.userAgent),l=window.opera||z.bustedValidity||m||!k.datalist,!l&&p.number)){l=!0;try{j.type="number",j.value="",j.stepUp(),l="1"!=j.value}catch(q){}}return z.bustedValidity=l,c=k[i]&&!l?"form-native-extend":h,t=a.noop,!1},w=function(b){var c=!0;return b._types||(b._types=b.types.split(" ")),a.each(b._types,function(a,b){return b in p&&!p[b]?(c=!1,!1):void 0}),c};f.validationMessages=f.validityMessages={langSrc:"i18n/formcfg-",availableLangs:"ar bg ca cs el es fa fi fr he hi hu it ja lt nl no pl pt pt-BR pt-PT ru sv zh-CN zh-TW".split(" ")},f.formcfg=a.extend({},f.validationMessages),f.inputTypes={},u("form-core",{f:"forms",test:t,d:["es5"],options:{placeholderType:"value",messagePopover:{},list:{popover:{constrainWidth:!0}},iVal:{sel:".ws-validate",handleBubble:"hide",recheckDelay:400}},methodNames:["setCustomValidity","checkValidity","setSelectionRange"],c:[16,7,2,8,1,15,30,3,31]}),d=q.forms,u("form-native-extend",{f:"forms",test:function(b){return t(),!k[i]||l||-1==a.inArray(j,b||[])||v[j].test()},d:["form-core",g,"form-message"],c:[6,5,14,29]}),u(h,{f:"forms",test:function(){return t(),k[i]&&!l},d:["form-core",g,"sizzle"],c:[16,15,28]}),u(h+"2",{f:"forms",test:function(){return t(),k[i]&&!m},d:[h],c:[27]}),u("form-message",{f:"forms",test:function(a){return t(),!(d.customMessages||!k[i]||l||!v[c].test(a))},d:[g],c:[16,7,15,30,3,8,4,14,28]}),u(j,{f:"forms-ext",options:{types:"date time range number"},test:function(){t();var a=!l;return a&&(a=w(this.options)),a},methodNames:["stepUp","stepDown"],d:["forms",g],c:[6,5,17,14,28,29,33]}),y("range-ui",{options:{},noAutoCallback:!0,test:function(){return!!C.rangeUI},d:["es5"],c:[6,5,9,10,17,11]}),u("form-number-date-ui",{f:"forms-ext",test:function(){var a=this.options;return a.replaceUI=n(a.replaceUI),t(),!a.replaceUI&&o&&(a.replaceUI=!0),!a.replaceUI&&w(a)},d:["forms",g,j,"range-ui"],options:{widgets:{calculateWidth:!0,animate:!0}},c:[6,5,9,10,17,11]}),u("form-datalist",{f:"forms",test:function(){return t(),o&&(d.customDatalist=!0),k.datalist&&!d.fD},d:["form-core",g],c:[16,7,6,2,9,15,30,31,28,33]})}();var F="FileReader"in window&&"FormData"in window;return u("filereader-xhr",{f:"filereader",test:F,d:[g,"swfmini"],c:[25,27]}),u("canvas-blob",{f:"filereader",methodNames:["toBlob"],test:!(F&&!b("canvas").toBlob)}),u("details",{test:"open"in b("details"),d:[g],options:{text:"Details"},c:[21,22]}),u("url",{test:function(){var a=!1;try{a=new URL("b","http://a"),a=!(!a.searchParams||"http://a/b"!=a.href)}catch(b){}return a},d:["es5"]}),function(){f.mediaelement={};var c=b("track");if(k.mediaelement="canPlayType"in D,k.texttrackapi="addTextTrack"in D,k.track="kind"in c,b("audio"),!(z.track=!k.texttrackapi))try{z.track=!("oncuechange"in D.addTextTrack("metadata"))}catch(d){}u("mediaelement-core",{f:"mediaelement",noAutoCallback:!0,options:{jme:{},plugins:[],vars:{},params:{},attrs:{},changeSWF:a.noop},methodNames:["play","pause","canPlayType","mediaLoad:load"],d:["swfmini"],c:[16,7,2,8,1,12,13,23]}),u("mediaelement-jaris",{f:"mediaelement",d:["mediaelement-core",g],test:function(){var a=this.options;return!(!k.mediaelement||f.mediaelement.loadSwf)&&(a.preferFlash&&!v.swfmini.test()&&(a.preferFlash=!1),!(a.preferFlash&&swfmini.hasFlashPlayerVersion("11.3")))},c:[21,25]}),u("track",{options:{positionDisplay:!0,override:z.track},test:function(){var a=this.options;return a.override=n(a.override),!a.override&&!z.track},d:["mediaelement",g],methodNames:["addTextTrack"],c:[21,12,13,22,34]}),y("jmebase",{src:"jme/base",c:[98,99,97]}),a.each([["mediacontrols",{c:[98,99],css:"jme/controls.css"}],["playlist",{c:[98,97]}],["alternate-media"]],function(b,c){y(c[0],a.extend({src:"jme/"+c[0],d:["jmebase"]},c[1]))}),y("track-ui",{d:["track",g]})}(),u("feature-dummy",{test:!0,loaded:!0,c:A}),f.$=a,a.webshims=f,a.webshim=webshim,
f.callAsync=function(){f.callAsync=a.noop,j&&(j.cfg&&(j.cfg.length||(j.cfg=[[j.cfg]]),a.each(j.cfg,function(a,b){f.setOptions.apply(f,b)})),j.ready&&a.each(j.ready,function(a,b){f.ready.apply(f,b)}),j.lang&&f.activeLang(j.lang),"polyfill"in j&&f.polyfill(j.polyfill)),f.isReady("jquery",!0)},f.callAsync(),f}),function(global,factory){"function"==typeof define&&define.amd?define([],factory):"undefined"!=typeof module&&module.exports?module.exports=factory():global.UriTemplate=factory()}(this,function(){function notReallyPercentEncode(string){return encodeURI(string).replace(/%25[0-9][0-9]/g,function(doubleEncoded){return"%"+doubleEncoded.substring(3)})}function uriTemplateSubstitution(spec){var modifier="";uriTemplateGlobalModifiers[spec.charAt(0)]&&(modifier=spec.charAt(0),spec=spec.substring(1));var separator="",prefix="",shouldEscape=!0,showVariables=!1,trimEmptyString=!1;"+"==modifier?shouldEscape=!1:"."==modifier?(prefix=".",separator="."):"/"==modifier?(prefix="/",separator="/"):"#"==modifier?(prefix="#",shouldEscape=!1):";"==modifier?(prefix=";",separator=";",showVariables=!0,trimEmptyString=!0):"?"==modifier?(prefix="?",separator="&",showVariables=!0):"&"==modifier&&(prefix="&",separator="&",showVariables=!0);for(var varNames=[],varList=spec.split(","),varSpecs=[],varSpecMap={},i=0;i<varList.length;i++){var varName=varList[i],truncate=null;if(varName.indexOf(":")!=-1){var parts=varName.split(":");varName=parts[0],truncate=parseInt(parts[1])}for(var suffices={};uriTemplateSuffices[varName.charAt(varName.length-1)];)suffices[varName.charAt(varName.length-1)]=!0,varName=varName.substring(0,varName.length-1);var varSpec={truncate:truncate,name:varName,suffices:suffices};varSpecs.push(varSpec),varSpecMap[varName]=varSpec,varNames.push(varName)}var subFunction=function(valueFunction){for(var result="",startIndex=0,i=0;i<varSpecs.length;i++){var varSpec=varSpecs[i],value=valueFunction(varSpec.name);if(null==value||Array.isArray(value)&&0==value.length||"object"==typeof value&&0==Object.keys(value).length)startIndex++;else if(result+=i==startIndex?prefix:separator||",",Array.isArray(value)){showVariables&&(result+=varSpec.name+"=");for(var j=0;j<value.length;j++)j>0&&(result+=varSpec.suffices["*"]?separator||",":",",varSpec.suffices["*"]&&showVariables&&(result+=varSpec.name+"=")),result+=shouldEscape?encodeURIComponent(value[j]).replace(/!/g,"%21"):notReallyPercentEncode(value[j])}else if("object"==typeof value){showVariables&&!varSpec.suffices["*"]&&(result+=varSpec.name+"=");var first=!0;for(var key in value)first||(result+=varSpec.suffices["*"]?separator||",":","),first=!1,result+=shouldEscape?encodeURIComponent(key).replace(/!/g,"%21"):notReallyPercentEncode(key),result+=varSpec.suffices["*"]?"=":",",result+=shouldEscape?encodeURIComponent(value[key]).replace(/!/g,"%21"):notReallyPercentEncode(value[key])}else showVariables&&(result+=varSpec.name,trimEmptyString&&""==value||(result+="=")),null!=varSpec.truncate&&(value=value.substring(0,varSpec.truncate)),result+=shouldEscape?encodeURIComponent(value).replace(/!/g,"%21"):notReallyPercentEncode(value)}return result},guessFunction=function(stringValue,resultObj){if(prefix){if(stringValue.substring(0,prefix.length)!=prefix)return null;stringValue=stringValue.substring(prefix.length)}if(1==varSpecs.length&&varSpecs[0].suffices["*"]){for(var varSpec=varSpecs[0],varName=varSpec.name,arrayValue=varSpec.suffices["*"]?stringValue.split(separator||","):[stringValue],hasEquals=shouldEscape&&stringValue.indexOf("=")!=-1,i=1;i<arrayValue.length;i++){var stringValue=arrayValue[i];hasEquals&&stringValue.indexOf("=")==-1&&(arrayValue[i-1]+=(separator||",")+stringValue,arrayValue.splice(i,1),i--)}for(var i=0;i<arrayValue.length;i++){var stringValue=arrayValue[i];shouldEscape&&stringValue.indexOf("=")!=-1&&(hasEquals=!0);for(var innerArrayValue=stringValue.split(","),j=0;j<innerArrayValue.length;j++)shouldEscape&&(innerArrayValue[j]=decodeURIComponent(innerArrayValue[j]));1==innerArrayValue.length?arrayValue[i]=innerArrayValue[0]:arrayValue[i]=innerArrayValue}if(showVariables||hasEquals){for(var objectValue=resultObj[varName]||{},j=0;j<arrayValue.length;j++){var innerValue=stringValue;if(!showVariables||innerValue){if("string"==typeof arrayValue[j]){var stringValue=arrayValue[j],innerVarName=stringValue.split("=",1)[0],stringValue=stringValue.substring(innerVarName.length+1);innerValue=stringValue}else{var stringValue=arrayValue[j][0],innerVarName=stringValue.split("=",1)[0],stringValue=stringValue.substring(innerVarName.length+1);arrayValue[j][0]=stringValue,innerValue=arrayValue[j]}void 0!==objectValue[innerVarName]?Array.isArray(objectValue[innerVarName])?objectValue[innerVarName].push(innerValue):objectValue[innerVarName]=[objectValue[innerVarName],innerValue]:objectValue[innerVarName]=innerValue}}1==Object.keys(objectValue).length&&void 0!==objectValue[varName]?resultObj[varName]=objectValue[varName]:resultObj[varName]=objectValue}else void 0!==resultObj[varName]?Array.isArray(resultObj[varName])?resultObj[varName]=resultObj[varName].concat(arrayValue):resultObj[varName]=[resultObj[varName]].concat(arrayValue):1!=arrayValue.length||varSpec.suffices["*"]?resultObj[varName]=arrayValue:resultObj[varName]=arrayValue[0]}else{for(var arrayValue=1==varSpecs.length?[stringValue]:stringValue.split(separator||","),specIndexMap={},i=0;i<arrayValue.length;i++){for(var firstStarred=0;firstStarred<varSpecs.length-1&&firstStarred<i&&!varSpecs[firstStarred].suffices["*"];firstStarred++);if(firstStarred!=i){for(var lastStarred=varSpecs.length-1;lastStarred>0&&varSpecs.length-lastStarred<arrayValue.length-i&&!varSpecs[lastStarred].suffices["*"];lastStarred--);varSpecs.length-lastStarred!=arrayValue.length-i?specIndexMap[i]=firstStarred:specIndexMap[i]=lastStarred}else specIndexMap[i]=i}for(var i=0;i<arrayValue.length;i++){var stringValue=arrayValue[i];if(stringValue||!showVariables){var innerArrayValue=stringValue.split(","),hasEquals=!1;if(showVariables){var stringValue=innerArrayValue[0],varName=stringValue.split("=",1)[0],stringValue=stringValue.substring(varName.length+1);innerArrayValue[0]=stringValue;var varSpec=varSpecMap[varName]||varSpecs[0]}else var varSpec=varSpecs[specIndexMap[i]],varName=varSpec.name;for(var j=0;j<innerArrayValue.length;j++)shouldEscape&&(innerArrayValue[j]=decodeURIComponent(innerArrayValue[j]));(showVariables||varSpec.suffices["*"])&&void 0!==resultObj[varName]?Array.isArray(resultObj[varName])?resultObj[varName]=resultObj[varName].concat(innerArrayValue):resultObj[varName]=[resultObj[varName]].concat(innerArrayValue):1!=innerArrayValue.length||varSpec.suffices["*"]?resultObj[varName]=innerArrayValue:resultObj[varName]=innerArrayValue[0]}}}};return subFunction.varNames=varNames,{prefix:prefix,substitution:subFunction,unSubstitution:guessFunction}}function UriTemplate(template){if(!(this instanceof UriTemplate))return new UriTemplate(template);for(var parts=template.split("{"),textParts=[parts.shift()],prefixes=[],substitutions=[],unSubstitutions=[],varNames=[];parts.length>0;){var part=parts.shift(),spec=part.split("}")[0],remainder=part.substring(spec.length+1),funcs=uriTemplateSubstitution(spec);substitutions.push(funcs.substitution),unSubstitutions.push(funcs.unSubstitution),prefixes.push(funcs.prefix),textParts.push(remainder),varNames=varNames.concat(funcs.substitution.varNames)}this.fill=function(valueFunction){if(valueFunction&&"function"!=typeof valueFunction){var value=valueFunction;valueFunction=function(varName){return value[varName]}}for(var result=textParts[0],i=0;i<substitutions.length;i++){var substitution=substitutions[i];result+=substitution(valueFunction),result+=textParts[i+1]}return result},this.fromUri=function(substituted){for(var result={},i=0;i<textParts.length;i++){var part=textParts[i];if(substituted.substring(0,part.length)!==part)return;if(substituted=substituted.substring(part.length),i>=textParts.length-1){if(""==substituted)break;return}for(var nextPart=textParts[i+1],offset=i;;){if(offset==textParts.length-2){var endPart=substituted.substring(substituted.length-nextPart.length);if(endPart!==nextPart)return;var stringValue=substituted.substring(0,substituted.length-nextPart.length);substituted=endPart}else if(nextPart){var nextPartPos=substituted.indexOf(nextPart),stringValue=substituted.substring(0,nextPartPos);substituted=substituted.substring(nextPartPos)}else if(prefixes[offset+1]){var nextPartPos=substituted.indexOf(prefixes[offset+1]);nextPartPos===-1&&(nextPartPos=substituted.length);var stringValue=substituted.substring(0,nextPartPos);substituted=substituted.substring(nextPartPos)}else{if(textParts.length>offset+2){offset++,nextPart=textParts[offset+1];continue}var stringValue=substituted;substituted=""}break}unSubstitutions[i](stringValue,result)}return result},this.varNames=varNames,this.template=template}var uriTemplateGlobalModifiers={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},uriTemplateSuffices={"*":!0};return UriTemplate.prototype={toString:function(){return this.template},fillFromObject:function(obj){return this.fill(obj)}},UriTemplate}),!function(){"use strict";function t(n){if(!n)throw new Error("No options passed to Waypoint constructor");if(!n.element)throw new Error("No element option passed to Waypoint constructor");if(!n.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+e,this.options=t.Adapter.extend({},t.defaults,n),this.element=this.options.element,this.adapter=new t.Adapter(this.element),this.callback=n.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=t.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=t.Context.findOrCreateByElement(this.options.context),t.offsetAliases[this.options.offset]&&(this.options.offset=t.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),i[this.key]=this,e+=1}var e=0,i={};t.prototype.queueTrigger=function(t){this.group.queueTrigger(this,t)},t.prototype.trigger=function(t){this.enabled&&this.callback&&this.callback.apply(this,t)},t.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete i[this.key]},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},t.prototype.next=function(){return this.group.next(this)},t.prototype.previous=function(){return this.group.previous(this)},t.invokeAll=function(t){var e=[];for(var n in i)e.push(i[n]);for(var o=0,r=e.length;r>o;o++)e[o][t]()},t.destroyAll=function(){t.invokeAll("destroy")},t.disableAll=function(){t.invokeAll("disable")},t.enableAll=function(){t.invokeAll("enable")},t.refreshAll=function(){t.Context.refreshAll()},t.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},t.viewportWidth=function(){return document.documentElement.clientWidth},t.adapters=[],t.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},t.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=t}(),function(){"use strict";function t(t){window.setTimeout(t,1e3/60)}function e(t){this.element=t,this.Adapter=o.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+i,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,n[t.waypointContextKey]=this,i+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var i=0,n={},o=window.Waypoint,r=window.onload;e.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},e.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical);t&&e&&(this.adapter.off(".waypoints"),delete n[this.key])},e.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,o.requestAnimationFrame(t))})},e.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){(!e.didScroll||o.isTouch)&&(e.didScroll=!0,o.requestAnimationFrame(t))})},e.prototype.handleResize=function(){o.Context.refreshAll()},e.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var i in e){var n=e[i],o=n.newScroll>n.oldScroll,r=o?n.forward:n.backward;for(var s in this.waypoints[i]){var l=this.waypoints[i][s],a=n.oldScroll<l.triggerPoint,h=n.newScroll>=l.triggerPoint,p=a&&h,u=!a&&!h;(p||u)&&(l.queueTrigger(r),t[l.group.id]=l.group)}}for(var c in t)t[c].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.innerHeight=function(){return this.element==this.element.window?o.viewportHeight():this.adapter.innerHeight()},e.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},e.prototype.innerWidth=function(){return this.element==this.element.window?o.viewportWidth():this.adapter.innerWidth()},e.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var i in this.waypoints[e])t.push(this.waypoints[e][i]);for(var n=0,o=t.length;o>n;n++)t[n].destroy()},e.prototype.refresh=function(){var t,e=this.element==this.element.window,i=this.adapter.offset(),n={};this.handleScroll(),t={horizontal:{contextOffset:e?0:i.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:i.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var o in t){var r=t[o];for(var s in this.waypoints[o]){var l,a,h,p,u,c=this.waypoints[o][s],f=c.options.offset,d=c.triggerPoint,y=0,g=null==d;c.element!==c.element.window&&(y=c.adapter.offset()[r.offsetProp]),"function"==typeof f?f=f.apply(c):"string"==typeof f&&(f=parseFloat(f),c.options.offset.indexOf("%")>-1&&(f=Math.ceil(r.contextDimension*f/100))),l=r.contextScroll-r.contextOffset,c.triggerPoint=y+l-f,a=d<r.oldScroll,h=c.triggerPoint>=r.oldScroll,p=a&&h,u=!a&&!h,!g&&p?(c.queueTrigger(r.backward),n[c.group.id]=c.group):!g&&u?(c.queueTrigger(r.forward),n[c.group.id]=c.group):g&&r.oldScroll>=c.triggerPoint&&(c.queueTrigger(r.forward),n[c.group.id]=c.group)}}for(var w in n)n[w].flushTriggers();return this},e.findOrCreateByElement=function(t){return e.findByElement(t)||new e(t)},e.refreshAll=function(){for(var t in n)n[t].refresh()},e.findByElement=function(t){return n[t.waypointContextKey]},window.onload=function(){r&&r(),e.refreshAll()},o.requestAnimationFrame=function(e){var i=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t;i.call(window,e)},o.Context=e}(),function(){"use strict";function t(t,e){return t.triggerPoint-e.triggerPoint}function e(t,e){return e.triggerPoint-t.triggerPoint}function i(t){this.name=t.name,this.axis=t.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),n[this.axis][this.name]=this}var n={vertical:{},horizontal:{}},o=window.Waypoint;i.prototype.add=function(t){this.waypoints.push(t)},i.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},i.prototype.flushTriggers=function(){for(var i in this.triggerQueues){var n=this.triggerQueues[i],o="up"===i||"left"===i;n.sort(o?e:t);for(var r=0,s=n.length;s>r;r+=1){var l=n[r];(l.options.continuous||r===n.length-1)&&l.trigger([i])}}this.clearTriggerQueues()},i.prototype.next=function(e){this.waypoints.sort(t);var i=o.Adapter.inArray(e,this.waypoints),n=i===this.waypoints.length-1;return n?null:this.waypoints[i+1]},i.prototype.previous=function(e){this.waypoints.sort(t);var i=o.Adapter.inArray(e,this.waypoints);return i?this.waypoints[i-1]:null},i.prototype.queueTrigger=function(t,e){this.triggerQueues[e].push(t)},i.prototype.remove=function(t){var e=o.Adapter.inArray(t,this.waypoints);e>-1&&this.waypoints.splice(e,1)},i.prototype.first=function(){return this.waypoints[0]},i.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},i.findOrCreate=function(t){return n[t.axis][t.name]||new i(t)},o.Group=i}(),function(){"use strict";function t(t){return t===t.window}function e(e){return t(e)?e:e.defaultView}function i(t){this.element=t,this.handlers={}}var n=window.Waypoint;i.prototype.innerHeight=function(){var e=t(this.element);return e?this.element.innerHeight:this.element.clientHeight},i.prototype.innerWidth=function(){var e=t(this.element);return e?this.element.innerWidth:this.element.clientWidth},i.prototype.off=function(t,e){function i(t,e,i){for(var n=0,o=e.length-1;o>n;n++){var r=e[n];i&&i!==r||t.removeEventListener(r)}}var n=t.split("."),o=n[0],r=n[1],s=this.element;if(r&&this.handlers[r]&&o)i(s,this.handlers[r][o],e),this.handlers[r][o]=[];else if(o)for(var l in this.handlers)i(s,this.handlers[l][o]||[],e),this.handlers[l][o]=[];else if(r&&this.handlers[r]){for(var a in this.handlers[r])i(s,this.handlers[r][a],e);this.handlers[r]={}}},i.prototype.offset=function(){if(!this.element.ownerDocument)return null;var t=this.element.ownerDocument.documentElement,i=e(this.element.ownerDocument),n={top:0,left:0};return this.element.getBoundingClientRect&&(n=this.element.getBoundingClientRect()),{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}},i.prototype.on=function(t,e){var i=t.split("."),n=i[0],o=i[1]||"__default",r=this.handlers[o]=this.handlers[o]||{},s=r[n]=r[n]||[];s.push(e),this.element.addEventListener(n,e)},i.prototype.outerHeight=function(e){var i,n=this.innerHeight();return e&&!t(this.element)&&(i=window.getComputedStyle(this.element),n+=parseInt(i.marginTop,10),n+=parseInt(i.marginBottom,10)),n},i.prototype.outerWidth=function(e){var i,n=this.innerWidth();return e&&!t(this.element)&&(i=window.getComputedStyle(this.element),n+=parseInt(i.marginLeft,10),n+=parseInt(i.marginRight,10)),n},i.prototype.scrollLeft=function(){var t=e(this.element);return t?t.pageXOffset:this.element.scrollLeft},i.prototype.scrollTop=function(){var t=e(this.element);return t?t.pageYOffset:this.element.scrollTop},i.extend=function(){function t(t,e){if("object"==typeof t&&"object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}for(var e=Array.prototype.slice.call(arguments),i=1,n=e.length;n>i;i++)t(e[0],e[i]);return e[0]},i.inArray=function(t,e,i){return null==e?-1:e.indexOf(t,i)},i.isEmptyObject=function(t){for(var e in t)return!1;return!0},n.adapters.push({name:"noframework",Adapter:i}),n.Adapter=i}(),function(){function fillString(str){var i,blockAmount=(str.length+8>>6)+1,blocks=[];for(i=0;i<16*blockAmount;i++)blocks[i]=0;for(i=0;i<str.length;i++)blocks[i>>2]|=str.charCodeAt(i)<<24-8*(3&i);return blocks[i>>2]|=128<<24-8*(3&i),blocks[16*blockAmount-1]=8*str.length,blocks}function binToHex(binArray){var i,hexString="0123456789abcdef",str="";for(i=0;i<4*binArray.length;i++)str+=hexString.charAt(binArray[i>>2]>>8*(3-i%4)+4&15)+hexString.charAt(binArray[i>>2]>>8*(3-i%4)&15);return str}function coreFunction(blockArray){var olda,oldb,oldc,oldd,olde,t,i,j,w=[],a=1732584193,b=4023233417,c=2562383102,d=271733878,e=3285377520;for(i=0;i<blockArray.length;i+=16){for(olda=a,oldb=b,oldc=c,oldd=d,olde=e,j=0;j<80;j++)j<16?w[j]=blockArray[i+j]:w[j]=cyclicShift(w[j-3]^w[j-8]^w[j-14]^w[j-16],1),t=modPlus(modPlus(cyclicShift(a,5),ft(j,b,c,d)),modPlus(modPlus(e,w[j]),kt(j))),e=d,d=c,c=cyclicShift(b,30),b=a,a=t;a=modPlus(a,olda),b=modPlus(b,oldb),c=modPlus(c,oldc),d=modPlus(d,oldd),e=modPlus(e,olde)}return[a,b,c,d,e]}function ft(t,b,c,d){return t<20?b&c|~b&d:t<40?b^c^d:t<60?b&c|b&d|c&d:b^c^d}function kt(t){return t<20?1518500249:t<40?1859775393:t<60?2400959708:3395469782}function modPlus(x,y){var low=(65535&x)+(65535&y),high=(x>>16)+(y>>16)+(low>>16);return high<<16|65535&low}function cyclicShift(num,k){return num<<k|num>>>32-k}function sha1(s){return binToHex(coreFunction(fillString(s)))}var root=this;"function"==typeof define?define(function(){return sha1}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=sha1),exports.sha1=sha1):root.sha1=sha1}.call(this),function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"undefined"!=typeof exports?module.exports=factory(require("jquery")):factory(jQuery)}(function($){"use strict";var Slick=window.Slick||{};Slick=function(){function Slick(element,settings){var dataSettings,_=this;_.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:$(element),appendDots:$(element),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(slider,i){return $('<button type="button" data-role="none" role="button" tabindex="0" />').text(i+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},_.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},$.extend(_,_.initials),_.activeBreakpoint=null,_.animType=null,_.animProp=null,_.breakpoints=[],_.breakpointSettings=[],_.cssTransitions=!1,_.focussed=!1,_.interrupted=!1,_.hidden="hidden",_.paused=!0,_.positionProp=null,_.respondTo=null,_.rowCount=1,_.shouldClick=!0,_.$slider=$(element),_.$slidesCache=null,_.transformType=null,_.transitionType=null,_.visibilityChange="visibilitychange",_.windowWidth=0,_.windowTimer=null,dataSettings=$(element).data("slick")||{},_.options=$.extend({},_.defaults,settings,dataSettings),_.currentSlide=_.options.initialSlide,_.originalSettings=_.options,"undefined"!=typeof document.mozHidden?(_.hidden="mozHidden",_.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(_.hidden="webkitHidden",_.visibilityChange="webkitvisibilitychange"),_.autoPlay=$.proxy(_.autoPlay,_),_.autoPlayClear=$.proxy(_.autoPlayClear,_),_.autoPlayIterator=$.proxy(_.autoPlayIterator,_),_.changeSlide=$.proxy(_.changeSlide,_),_.clickHandler=$.proxy(_.clickHandler,_),_.selectHandler=$.proxy(_.selectHandler,_),_.setPosition=$.proxy(_.setPosition,_),_.swipeHandler=$.proxy(_.swipeHandler,_),_.dragHandler=$.proxy(_.dragHandler,_),_.keyHandler=$.proxy(_.keyHandler,_),_.instanceUid=instanceUid++,_.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,_.registerBreakpoints(),_.init(!0)}var instanceUid=0;return Slick}(),Slick.prototype.activateADA=function(){var _=this;_.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},Slick.prototype.addSlide=Slick.prototype.slickAdd=function(markup,index,addBefore){var _=this;if("boolean"==typeof index)addBefore=index,index=null;else if(index<0||index>=_.slideCount)return!1;_.unload(),"number"==typeof index?0===index&&0===_.$slides.length?$(markup).appendTo(_.$slideTrack):addBefore?$(markup).insertBefore(_.$slides.eq(index)):$(markup).insertAfter(_.$slides.eq(index)):addBefore===!0?$(markup).prependTo(_.$slideTrack):$(markup).appendTo(_.$slideTrack),_.$slides=_.$slideTrack.children(this.options.slide),_.$slideTrack.children(this.options.slide).detach(),_.$slideTrack.append(_.$slides),_.$slides.each(function(index,element){$(element).attr("data-slick-index",index)}),_.$slidesCache=_.$slides,_.reinit()},Slick.prototype.animateHeight=function(){var _=this;if(1===_.options.slidesToShow&&_.options.adaptiveHeight===!0&&_.options.vertical===!1){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(!0);_.$list.animate({height:targetHeight},_.options.speed)}},Slick.prototype.animateSlide=function(targetLeft,callback){var animProps={},_=this;_.animateHeight(),_.options.rtl===!0&&_.options.vertical===!1&&(targetLeft=-targetLeft),_.transformsEnabled===!1?_.options.vertical===!1?_.$slideTrack.animate({left:targetLeft},_.options.speed,_.options.easing,callback):_.$slideTrack.animate({top:targetLeft},_.options.speed,_.options.easing,callback):_.cssTransitions===!1?(_.options.rtl===!0&&(_.currentLeft=-_.currentLeft),$({animStart:_.currentLeft}).animate({animStart:targetLeft},{duration:_.options.speed,easing:_.options.easing,step:function(now){now=Math.ceil(now),_.options.vertical===!1?(animProps[_.animType]="translate("+now+"px, 0px)",_.$slideTrack.css(animProps)):(animProps[_.animType]="translate(0px,"+now+"px)",_.$slideTrack.css(animProps))},complete:function(){callback&&callback.call()}})):(_.applyTransition(),targetLeft=Math.ceil(targetLeft),_.options.vertical===!1?animProps[_.animType]="translate3d("+targetLeft+"px, 0px, 0px)":animProps[_.animType]="translate3d(0px,"+targetLeft+"px, 0px)",_.$slideTrack.css(animProps),callback&&setTimeout(function(){_.disableTransition(),callback.call()},_.options.speed))},Slick.prototype.getNavTarget=function(){var _=this,asNavFor=_.options.asNavFor;return asNavFor&&null!==asNavFor&&(asNavFor=$(asNavFor).not(_.$slider)),asNavFor},Slick.prototype.asNavFor=function(index){var _=this,asNavFor=_.getNavTarget();null!==asNavFor&&"object"==typeof asNavFor&&asNavFor.each(function(){var target=$(this).slick("getSlick");target.unslicked||target.slideHandler(index,!0)})},Slick.prototype.applyTransition=function(slide){var _=this,transition={};_.options.fade===!1?transition[_.transitionType]=_.transformType+" "+_.options.speed+"ms "+_.options.cssEase:transition[_.transitionType]="opacity "+_.options.speed+"ms "+_.options.cssEase,_.options.fade===!1?_.$slideTrack.css(transition):_.$slides.eq(slide).css(transition)},Slick.prototype.autoPlay=function(){var _=this;_.autoPlayClear(),_.slideCount>_.options.slidesToShow&&(_.autoPlayTimer=setInterval(_.autoPlayIterator,_.options.autoplaySpeed))},Slick.prototype.autoPlayClear=function(){var _=this;_.autoPlayTimer&&clearInterval(_.autoPlayTimer)},Slick.prototype.autoPlayIterator=function(){var _=this,slideTo=_.currentSlide+_.options.slidesToScroll;_.paused||_.interrupted||_.focussed||(_.options.infinite===!1&&(1===_.direction&&_.currentSlide+1===_.slideCount-1?_.direction=0:0===_.direction&&(slideTo=_.currentSlide-_.options.slidesToScroll,_.currentSlide-1===0&&(_.direction=1))),_.slideHandler(slideTo))},Slick.prototype.buildArrows=function(){var _=this;_.options.arrows===!0&&(_.$prevArrow=$(_.options.prevArrow).addClass("slick-arrow"),_.$nextArrow=$(_.options.nextArrow).addClass("slick-arrow"),_.slideCount>_.options.slidesToShow?(_.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),_.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),_.htmlExpr.test(_.options.prevArrow)&&_.$prevArrow.prependTo(_.options.appendArrows),_.htmlExpr.test(_.options.nextArrow)&&_.$nextArrow.appendTo(_.options.appendArrows),_.options.infinite!==!0&&_.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):_.$prevArrow.add(_.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},Slick.prototype.buildDots=function(){var i,dot,_=this;if(_.options.dots===!0&&_.slideCount>_.options.slidesToShow){for(_.$slider.addClass("slick-dotted"),dot=$("<ul />").addClass(_.options.dotsClass),i=0;i<=_.getDotCount();i+=1)dot.append($("<li />").append(_.options.customPaging.call(this,_,i)));_.$dots=dot.appendTo(_.options.appendDots),_.$dots.find("li").first().addClass("slick-active").attr("aria-hidden","false")}},Slick.prototype.buildOut=function(){var _=this;_.$slides=_.$slider.children(_.options.slide+":not(.slick-cloned)").addClass("slick-slide"),_.slideCount=_.$slides.length,_.$slides.each(function(index,element){$(element).attr("data-slick-index",index).data("originalStyling",$(element).attr("style")||"")}),_.$slider.addClass("slick-slider"),_.$slideTrack=0===_.slideCount?$('<div class="slick-track"/>').appendTo(_.$slider):_.$slides.wrapAll('<div class="slick-track"/>').parent(),_.$list=_.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent(),_.$slideTrack.css("opacity",0),_.options.centerMode!==!0&&_.options.swipeToSlide!==!0||(_.options.slidesToScroll=1),$("img[data-lazy]",_.$slider).not("[src]").addClass("slick-loading"),_.setupInfinite(),_.buildArrows(),_.buildDots(),_.updateDots(),_.setSlideClasses("number"==typeof _.currentSlide?_.currentSlide:0),_.options.draggable===!0&&_.$list.addClass("draggable")},Slick.prototype.buildRows=function(){var a,b,c,newSlides,numOfSlides,originalSlides,slidesPerSection,_=this;if(newSlides=document.createDocumentFragment(),originalSlides=_.$slider.children(),_.options.rows>1){for(slidesPerSection=_.options.slidesPerRow*_.options.rows,numOfSlides=Math.ceil(originalSlides.length/slidesPerSection),a=0;a<numOfSlides;a++){var slide=document.createElement("div");for(b=0;b<_.options.rows;b++){var row=document.createElement("div");for(c=0;c<_.options.slidesPerRow;c++){var target=a*slidesPerSection+(b*_.options.slidesPerRow+c);originalSlides.get(target)&&row.appendChild(originalSlides.get(target))}slide.appendChild(row)}newSlides.appendChild(slide)}_.$slider.empty().append(newSlides),_.$slider.children().children().children().css({width:100/_.options.slidesPerRow+"%",display:"inline-block"})}},Slick.prototype.checkResponsive=function(initial,forceUpdate){var breakpoint,targetBreakpoint,respondToWidth,_=this,triggerBreakpoint=!1,sliderWidth=_.$slider.width(),windowWidth=window.innerWidth||$(window).width();if("window"===_.respondTo?respondToWidth=windowWidth:"slider"===_.respondTo?respondToWidth=sliderWidth:"min"===_.respondTo&&(respondToWidth=Math.min(windowWidth,sliderWidth)),_.options.responsive&&_.options.responsive.length&&null!==_.options.responsive){targetBreakpoint=null;for(breakpoint in _.breakpoints)_.breakpoints.hasOwnProperty(breakpoint)&&(_.originalSettings.mobileFirst===!1?respondToWidth<_.breakpoints[breakpoint]&&(targetBreakpoint=_.breakpoints[breakpoint]):respondToWidth>_.breakpoints[breakpoint]&&(targetBreakpoint=_.breakpoints[breakpoint]));null!==targetBreakpoint?null!==_.activeBreakpoint?(targetBreakpoint!==_.activeBreakpoint||forceUpdate)&&(_.activeBreakpoint=targetBreakpoint,"unslick"===_.breakpointSettings[targetBreakpoint]?_.unslick(targetBreakpoint):(_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]),initial===!0&&(_.currentSlide=_.options.initialSlide),_.refresh(initial)),triggerBreakpoint=targetBreakpoint):(_.activeBreakpoint=targetBreakpoint,"unslick"===_.breakpointSettings[targetBreakpoint]?_.unslick(targetBreakpoint):(_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]),initial===!0&&(_.currentSlide=_.options.initialSlide),
_.refresh(initial)),triggerBreakpoint=targetBreakpoint):null!==_.activeBreakpoint&&(_.activeBreakpoint=null,_.options=_.originalSettings,initial===!0&&(_.currentSlide=_.options.initialSlide),_.refresh(initial),triggerBreakpoint=targetBreakpoint),initial||triggerBreakpoint===!1||_.$slider.trigger("breakpoint",[_,triggerBreakpoint])}},Slick.prototype.changeSlide=function(event,dontAnimate){var indexOffset,slideOffset,unevenOffset,_=this,$target=$(event.currentTarget);switch($target.is("a")&&event.preventDefault(),$target.is("li")||($target=$target.closest("li")),unevenOffset=_.slideCount%_.options.slidesToScroll!==0,indexOffset=unevenOffset?0:(_.slideCount-_.currentSlide)%_.options.slidesToScroll,event.data.message){case"previous":slideOffset=0===indexOffset?_.options.slidesToScroll:_.options.slidesToShow-indexOffset,_.slideCount>_.options.slidesToShow&&_.slideHandler(_.currentSlide-slideOffset,!1,dontAnimate);break;case"next":slideOffset=0===indexOffset?_.options.slidesToScroll:indexOffset,_.slideCount>_.options.slidesToShow&&_.slideHandler(_.currentSlide+slideOffset,!1,dontAnimate);break;case"index":var index=0===event.data.index?0:event.data.index||$target.index()*_.options.slidesToScroll;_.slideHandler(_.checkNavigable(index),!1,dontAnimate),$target.children().trigger("focus");break;default:return}},Slick.prototype.checkNavigable=function(index){var navigables,prevNavigable,_=this;if(navigables=_.getNavigableIndexes(),prevNavigable=0,index>navigables[navigables.length-1])index=navigables[navigables.length-1];else for(var n in navigables){if(index<navigables[n]){index=prevNavigable;break}prevNavigable=navigables[n]}return index},Slick.prototype.cleanUpEvents=function(){var _=this;_.options.dots&&null!==_.$dots&&$("li",_.$dots).off("click.slick",_.changeSlide).off("mouseenter.slick",$.proxy(_.interrupt,_,!0)).off("mouseleave.slick",$.proxy(_.interrupt,_,!1)),_.$slider.off("focus.slick blur.slick"),_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow&&_.$prevArrow.off("click.slick",_.changeSlide),_.$nextArrow&&_.$nextArrow.off("click.slick",_.changeSlide)),_.$list.off("touchstart.slick mousedown.slick",_.swipeHandler),_.$list.off("touchmove.slick mousemove.slick",_.swipeHandler),_.$list.off("touchend.slick mouseup.slick",_.swipeHandler),_.$list.off("touchcancel.slick mouseleave.slick",_.swipeHandler),_.$list.off("click.slick",_.clickHandler),$(document).off(_.visibilityChange,_.visibility),_.cleanUpSlideEvents(),_.options.accessibility===!0&&_.$list.off("keydown.slick",_.keyHandler),_.options.focusOnSelect===!0&&$(_.$slideTrack).children().off("click.slick",_.selectHandler),$(window).off("orientationchange.slick.slick-"+_.instanceUid,_.orientationChange),$(window).off("resize.slick.slick-"+_.instanceUid,_.resize),$("[draggable!=true]",_.$slideTrack).off("dragstart",_.preventDefault),$(window).off("load.slick.slick-"+_.instanceUid,_.setPosition),$(document).off("ready.slick.slick-"+_.instanceUid,_.setPosition)},Slick.prototype.cleanUpSlideEvents=function(){var _=this;_.$list.off("mouseenter.slick",$.proxy(_.interrupt,_,!0)),_.$list.off("mouseleave.slick",$.proxy(_.interrupt,_,!1))},Slick.prototype.cleanUpRows=function(){var originalSlides,_=this;_.options.rows>1&&(originalSlides=_.$slides.children().children(),originalSlides.removeAttr("style"),_.$slider.empty().append(originalSlides))},Slick.prototype.clickHandler=function(event){var _=this;_.shouldClick===!1&&(event.stopImmediatePropagation(),event.stopPropagation(),event.preventDefault())},Slick.prototype.destroy=function(refresh){var _=this;_.autoPlayClear(),_.touchObject={},_.cleanUpEvents(),$(".slick-cloned",_.$slider).detach(),_.$dots&&_.$dots.remove(),_.$prevArrow&&_.$prevArrow.length&&(_.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),_.htmlExpr.test(_.options.prevArrow)&&_.$prevArrow.remove()),_.$nextArrow&&_.$nextArrow.length&&(_.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),_.htmlExpr.test(_.options.nextArrow)&&_.$nextArrow.remove()),_.$slides&&(_.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){$(this).attr("style",$(this).data("originalStyling"))}),_.$slideTrack.children(this.options.slide).detach(),_.$slideTrack.detach(),_.$list.detach(),_.$slider.append(_.$slides)),_.cleanUpRows(),_.$slider.removeClass("slick-slider"),_.$slider.removeClass("slick-initialized"),_.$slider.removeClass("slick-dotted"),_.unslicked=!0,refresh||_.$slider.trigger("destroy",[_])},Slick.prototype.disableTransition=function(slide){var _=this,transition={};transition[_.transitionType]="",_.options.fade===!1?_.$slideTrack.css(transition):_.$slides.eq(slide).css(transition)},Slick.prototype.fadeSlide=function(slideIndex,callback){var _=this;_.cssTransitions===!1?(_.$slides.eq(slideIndex).css({zIndex:_.options.zIndex}),_.$slides.eq(slideIndex).animate({opacity:1},_.options.speed,_.options.easing,callback)):(_.applyTransition(slideIndex),_.$slides.eq(slideIndex).css({opacity:1,zIndex:_.options.zIndex}),callback&&setTimeout(function(){_.disableTransition(slideIndex),callback.call()},_.options.speed))},Slick.prototype.fadeSlideOut=function(slideIndex){var _=this;_.cssTransitions===!1?_.$slides.eq(slideIndex).animate({opacity:0,zIndex:_.options.zIndex-2},_.options.speed,_.options.easing):(_.applyTransition(slideIndex),_.$slides.eq(slideIndex).css({opacity:0,zIndex:_.options.zIndex-2}))},Slick.prototype.filterSlides=Slick.prototype.slickFilter=function(filter){var _=this;null!==filter&&(_.$slidesCache=_.$slides,_.unload(),_.$slideTrack.children(this.options.slide).detach(),_.$slidesCache.filter(filter).appendTo(_.$slideTrack),_.reinit())},Slick.prototype.focusHandler=function(){var _=this;_.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*:not(.slick-arrow)",function(event){event.stopImmediatePropagation();var $sf=$(this);setTimeout(function(){_.options.pauseOnFocus&&(_.focussed=$sf.is(":focus"),_.autoPlay())},0)})},Slick.prototype.getCurrent=Slick.prototype.slickCurrentSlide=function(){var _=this;return _.currentSlide},Slick.prototype.getDotCount=function(){var _=this,breakPoint=0,counter=0,pagerQty=0;if(_.options.infinite===!0)for(;breakPoint<_.slideCount;)++pagerQty,breakPoint=counter+_.options.slidesToScroll,counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;else if(_.options.centerMode===!0)pagerQty=_.slideCount;else if(_.options.asNavFor)for(;breakPoint<_.slideCount;)++pagerQty,breakPoint=counter+_.options.slidesToScroll,counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;else pagerQty=1+Math.ceil((_.slideCount-_.options.slidesToShow)/_.options.slidesToScroll);return pagerQty-1},Slick.prototype.getLeft=function(slideIndex){var targetLeft,verticalHeight,targetSlide,_=this,verticalOffset=0;return _.slideOffset=0,verticalHeight=_.$slides.first().outerHeight(!0),_.options.infinite===!0?(_.slideCount>_.options.slidesToShow&&(_.slideOffset=_.slideWidth*_.options.slidesToShow*-1,verticalOffset=verticalHeight*_.options.slidesToShow*-1),_.slideCount%_.options.slidesToScroll!==0&&slideIndex+_.options.slidesToScroll>_.slideCount&&_.slideCount>_.options.slidesToShow&&(slideIndex>_.slideCount?(_.slideOffset=(_.options.slidesToShow-(slideIndex-_.slideCount))*_.slideWidth*-1,verticalOffset=(_.options.slidesToShow-(slideIndex-_.slideCount))*verticalHeight*-1):(_.slideOffset=_.slideCount%_.options.slidesToScroll*_.slideWidth*-1,verticalOffset=_.slideCount%_.options.slidesToScroll*verticalHeight*-1))):slideIndex+_.options.slidesToShow>_.slideCount&&(_.slideOffset=(slideIndex+_.options.slidesToShow-_.slideCount)*_.slideWidth,verticalOffset=(slideIndex+_.options.slidesToShow-_.slideCount)*verticalHeight),_.slideCount<=_.options.slidesToShow&&(_.slideOffset=0,verticalOffset=0),_.options.centerMode===!0&&_.options.infinite===!0?_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)-_.slideWidth:_.options.centerMode===!0&&(_.slideOffset=0,_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)),targetLeft=_.options.vertical===!1?slideIndex*_.slideWidth*-1+_.slideOffset:slideIndex*verticalHeight*-1+verticalOffset,_.options.variableWidth===!0&&(targetSlide=_.slideCount<=_.options.slidesToShow||_.options.infinite===!1?_.$slideTrack.children(".slick-slide").eq(slideIndex):_.$slideTrack.children(".slick-slide").eq(slideIndex+_.options.slidesToShow),targetLeft=_.options.rtl===!0?targetSlide[0]?(_.$slideTrack.width()-targetSlide[0].offsetLeft-targetSlide.width())*-1:0:targetSlide[0]?targetSlide[0].offsetLeft*-1:0,_.options.centerMode===!0&&(targetSlide=_.slideCount<=_.options.slidesToShow||_.options.infinite===!1?_.$slideTrack.children(".slick-slide").eq(slideIndex):_.$slideTrack.children(".slick-slide").eq(slideIndex+_.options.slidesToShow+1),targetLeft=_.options.rtl===!0?targetSlide[0]?(_.$slideTrack.width()-targetSlide[0].offsetLeft-targetSlide.width())*-1:0:targetSlide[0]?targetSlide[0].offsetLeft*-1:0,targetLeft+=(_.$list.width()-targetSlide.outerWidth())/2)),targetLeft},Slick.prototype.getOption=Slick.prototype.slickGetOption=function(option){var _=this;return _.options[option]},Slick.prototype.getNavigableIndexes=function(){var max,_=this,breakPoint=0,counter=0,indexes=[];for(_.options.infinite===!1?max=_.slideCount:(breakPoint=_.options.slidesToScroll*-1,counter=_.options.slidesToScroll*-1,max=2*_.slideCount);breakPoint<max;)indexes.push(breakPoint),breakPoint=counter+_.options.slidesToScroll,counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;return indexes},Slick.prototype.getSlick=function(){return this},Slick.prototype.getSlideCount=function(){var slidesTraversed,swipedSlide,centerOffset,_=this;return centerOffset=_.options.centerMode===!0?_.slideWidth*Math.floor(_.options.slidesToShow/2):0,_.options.swipeToSlide===!0?(_.$slideTrack.find(".slick-slide").each(function(index,slide){if(slide.offsetLeft-centerOffset+$(slide).outerWidth()/2>_.swipeLeft*-1)return swipedSlide=slide,!1}),slidesTraversed=Math.abs($(swipedSlide).attr("data-slick-index")-_.currentSlide)||1):_.options.slidesToScroll},Slick.prototype.goTo=Slick.prototype.slickGoTo=function(slide,dontAnimate){var _=this;_.changeSlide({data:{message:"index",index:parseInt(slide)}},dontAnimate)},Slick.prototype.init=function(creation){var _=this;$(_.$slider).hasClass("slick-initialized")||($(_.$slider).addClass("slick-initialized"),_.buildRows(),_.buildOut(),_.setProps(),_.startLoad(),_.loadSlider(),_.initializeEvents(),_.updateArrows(),_.updateDots(),_.checkResponsive(!0),_.focusHandler()),creation&&_.$slider.trigger("init",[_]),_.options.accessibility===!0&&_.initADA(),_.options.autoplay&&(_.paused=!1,_.autoPlay())},Slick.prototype.initADA=function(){var _=this;_.$slides.add(_.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),_.$slideTrack.attr("role","listbox"),_.$slides.not(_.$slideTrack.find(".slick-cloned")).each(function(i){$(this).attr({role:"option","aria-describedby":"slick-slide"+_.instanceUid+i})}),null!==_.$dots&&_.$dots.attr("role","tablist").find("li").each(function(i){$(this).attr({role:"presentation","aria-selected":"false","aria-controls":"navigation"+_.instanceUid+i,id:"slick-slide"+_.instanceUid+i})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role","toolbar"),_.activateADA()},Slick.prototype.initArrowEvents=function(){var _=this;_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},_.changeSlide),_.$nextArrow.off("click.slick").on("click.slick",{message:"next"},_.changeSlide))},Slick.prototype.initDotEvents=function(){var _=this;_.options.dots===!0&&_.slideCount>_.options.slidesToShow&&$("li",_.$dots).on("click.slick",{message:"index"},_.changeSlide),_.options.dots===!0&&_.options.pauseOnDotsHover===!0&&$("li",_.$dots).on("mouseenter.slick",$.proxy(_.interrupt,_,!0)).on("mouseleave.slick",$.proxy(_.interrupt,_,!1))},Slick.prototype.initSlideEvents=function(){var _=this;_.options.pauseOnHover&&(_.$list.on("mouseenter.slick",$.proxy(_.interrupt,_,!0)),_.$list.on("mouseleave.slick",$.proxy(_.interrupt,_,!1)))},Slick.prototype.initializeEvents=function(){var _=this;_.initArrowEvents(),_.initDotEvents(),_.initSlideEvents(),_.$list.on("touchstart.slick mousedown.slick",{action:"start"},_.swipeHandler),_.$list.on("touchmove.slick mousemove.slick",{action:"move"},_.swipeHandler),_.$list.on("touchend.slick mouseup.slick",{action:"end"},_.swipeHandler),_.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},_.swipeHandler),_.$list.on("click.slick",_.clickHandler),$(document).on(_.visibilityChange,$.proxy(_.visibility,_)),_.options.accessibility===!0&&_.$list.on("keydown.slick",_.keyHandler),_.options.focusOnSelect===!0&&$(_.$slideTrack).children().on("click.slick",_.selectHandler),$(window).on("orientationchange.slick.slick-"+_.instanceUid,$.proxy(_.orientationChange,_)),$(window).on("resize.slick.slick-"+_.instanceUid,$.proxy(_.resize,_)),$("[draggable!=true]",_.$slideTrack).on("dragstart",_.preventDefault),$(window).on("load.slick.slick-"+_.instanceUid,_.setPosition),$(document).on("ready.slick.slick-"+_.instanceUid,_.setPosition)},Slick.prototype.initUI=function(){var _=this;_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow.show(),_.$nextArrow.show()),_.options.dots===!0&&_.slideCount>_.options.slidesToShow&&_.$dots.show()},Slick.prototype.keyHandler=function(event){var _=this;event.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===event.keyCode&&_.options.accessibility===!0?_.changeSlide({data:{message:_.options.rtl===!0?"next":"previous"}}):39===event.keyCode&&_.options.accessibility===!0&&_.changeSlide({data:{message:_.options.rtl===!0?"previous":"next"}}))},Slick.prototype.lazyLoad=function(){function loadImages(imagesScope){$("img[data-lazy]",imagesScope).each(function(){var image=$(this),imageSource=$(this).attr("data-lazy"),imageToLoad=document.createElement("img");imageToLoad.onload=function(){image.animate({opacity:0},100,function(){image.attr("src",imageSource).animate({opacity:1},200,function(){image.removeAttr("data-lazy").removeClass("slick-loading")}),_.$slider.trigger("lazyLoaded",[_,image,imageSource])})},imageToLoad.onerror=function(){image.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),_.$slider.trigger("lazyLoadError",[_,image,imageSource])},imageToLoad.src=imageSource})}var loadRange,cloneRange,rangeStart,rangeEnd,_=this;_.options.centerMode===!0?_.options.infinite===!0?(rangeStart=_.currentSlide+(_.options.slidesToShow/2+1),rangeEnd=rangeStart+_.options.slidesToShow+2):(rangeStart=Math.max(0,_.currentSlide-(_.options.slidesToShow/2+1)),rangeEnd=2+(_.options.slidesToShow/2+1)+_.currentSlide):(rangeStart=_.options.infinite?_.options.slidesToShow+_.currentSlide:_.currentSlide,rangeEnd=Math.ceil(rangeStart+_.options.slidesToShow),_.options.fade===!0&&(rangeStart>0&&rangeStart--,rangeEnd<=_.slideCount&&rangeEnd++)),loadRange=_.$slider.find(".slick-slide").slice(rangeStart,rangeEnd),loadImages(loadRange),_.slideCount<=_.options.slidesToShow?(cloneRange=_.$slider.find(".slick-slide"),loadImages(cloneRange)):_.currentSlide>=_.slideCount-_.options.slidesToShow?(cloneRange=_.$slider.find(".slick-cloned").slice(0,_.options.slidesToShow),loadImages(cloneRange)):0===_.currentSlide&&(cloneRange=_.$slider.find(".slick-cloned").slice(_.options.slidesToShow*-1),loadImages(cloneRange))},Slick.prototype.loadSlider=function(){var _=this;_.setPosition(),_.$slideTrack.css({opacity:1}),_.$slider.removeClass("slick-loading"),_.initUI(),"progressive"===_.options.lazyLoad&&_.progressiveLazyLoad()},Slick.prototype.next=Slick.prototype.slickNext=function(){var _=this;_.changeSlide({data:{message:"next"}})},Slick.prototype.orientationChange=function(){var _=this;_.checkResponsive(),_.setPosition()},Slick.prototype.pause=Slick.prototype.slickPause=function(){var _=this;_.autoPlayClear(),_.paused=!0},Slick.prototype.play=Slick.prototype.slickPlay=function(){var _=this;_.autoPlay(),_.options.autoplay=!0,_.paused=!1,_.focussed=!1,_.interrupted=!1},Slick.prototype.postSlide=function(index){var _=this;_.unslicked||(_.$slider.trigger("afterChange",[_,index]),_.animating=!1,_.setPosition(),_.swipeLeft=null,_.options.autoplay&&_.autoPlay(),_.options.accessibility===!0&&_.initADA())},Slick.prototype.prev=Slick.prototype.slickPrev=function(){var _=this;_.changeSlide({data:{message:"previous"}})},Slick.prototype.preventDefault=function(event){event.preventDefault()},Slick.prototype.progressiveLazyLoad=function(tryCount){tryCount=tryCount||1;var image,imageSource,imageToLoad,_=this,$imgsToLoad=$("img[data-lazy]",_.$slider);$imgsToLoad.length?(image=$imgsToLoad.first(),imageSource=image.attr("data-lazy"),imageToLoad=document.createElement("img"),imageToLoad.onload=function(){image.attr("src",imageSource).removeAttr("data-lazy").removeClass("slick-loading"),_.options.adaptiveHeight===!0&&_.setPosition(),_.$slider.trigger("lazyLoaded",[_,image,imageSource]),_.progressiveLazyLoad()},imageToLoad.onerror=function(){tryCount<3?setTimeout(function(){_.progressiveLazyLoad(tryCount+1)},500):(image.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),_.$slider.trigger("lazyLoadError",[_,image,imageSource]),_.progressiveLazyLoad())},imageToLoad.src=imageSource):_.$slider.trigger("allImagesLoaded",[_])},Slick.prototype.refresh=function(initializing){var currentSlide,lastVisibleIndex,_=this;lastVisibleIndex=_.slideCount-_.options.slidesToShow,!_.options.infinite&&_.currentSlide>lastVisibleIndex&&(_.currentSlide=lastVisibleIndex),_.slideCount<=_.options.slidesToShow&&(_.currentSlide=0),currentSlide=_.currentSlide,_.destroy(!0),$.extend(_,_.initials,{currentSlide:currentSlide}),_.init(),initializing||_.changeSlide({data:{message:"index",index:currentSlide}},!1)},Slick.prototype.registerBreakpoints=function(){var breakpoint,currentBreakpoint,l,_=this,responsiveSettings=_.options.responsive||null;if("array"===$.type(responsiveSettings)&&responsiveSettings.length){_.respondTo=_.options.respondTo||"window";for(breakpoint in responsiveSettings)if(l=_.breakpoints.length-1,currentBreakpoint=responsiveSettings[breakpoint].breakpoint,responsiveSettings.hasOwnProperty(breakpoint)){for(;l>=0;)_.breakpoints[l]&&_.breakpoints[l]===currentBreakpoint&&_.breakpoints.splice(l,1),l--;_.breakpoints.push(currentBreakpoint),_.breakpointSettings[currentBreakpoint]=responsiveSettings[breakpoint].settings}_.breakpoints.sort(function(a,b){return _.options.mobileFirst?a-b:b-a})}},Slick.prototype.reinit=function(){var _=this;_.$slides=_.$slideTrack.children(_.options.slide).addClass("slick-slide"),_.slideCount=_.$slides.length,_.currentSlide>=_.slideCount&&0!==_.currentSlide&&(_.currentSlide=_.currentSlide-_.options.slidesToScroll),_.slideCount<=_.options.slidesToShow&&(_.currentSlide=0),_.registerBreakpoints(),_.setProps(),_.setupInfinite(),_.buildArrows(),_.updateArrows(),_.initArrowEvents(),_.buildDots(),_.updateDots(),_.initDotEvents(),_.cleanUpSlideEvents(),_.initSlideEvents(),_.checkResponsive(!1,!0),_.options.focusOnSelect===!0&&$(_.$slideTrack).children().on("click.slick",_.selectHandler),_.setSlideClasses("number"==typeof _.currentSlide?_.currentSlide:0),_.setPosition(),_.focusHandler(),_.paused=!_.options.autoplay,_.autoPlay(),_.$slider.trigger("reInit",[_])},Slick.prototype.resize=function(){var _=this;$(window).width()!==_.windowWidth&&(clearTimeout(_.windowDelay),_.windowDelay=window.setTimeout(function(){_.windowWidth=$(window).width(),_.checkResponsive(),_.unslicked||_.setPosition()},50))},Slick.prototype.removeSlide=Slick.prototype.slickRemove=function(index,removeBefore,removeAll){var _=this;return"boolean"==typeof index?(removeBefore=index,index=removeBefore===!0?0:_.slideCount-1):index=removeBefore===!0?--index:index,!(_.slideCount<1||index<0||index>_.slideCount-1)&&(_.unload(),removeAll===!0?_.$slideTrack.children().remove():_.$slideTrack.children(this.options.slide).eq(index).remove(),_.$slides=_.$slideTrack.children(this.options.slide),_.$slideTrack.children(this.options.slide).detach(),_.$slideTrack.append(_.$slides),_.$slidesCache=_.$slides,void _.reinit())},Slick.prototype.setCSS=function(position){var x,y,_=this,positionProps={};_.options.rtl===!0&&(position=-position),x="left"==_.positionProp?Math.ceil(position)+"px":"0px",y="top"==_.positionProp?Math.ceil(position)+"px":"0px",positionProps[_.positionProp]=position,_.transformsEnabled===!1?_.$slideTrack.css(positionProps):(positionProps={},_.cssTransitions===!1?(positionProps[_.animType]="translate("+x+", "+y+")",_.$slideTrack.css(positionProps)):(positionProps[_.animType]="translate3d("+x+", "+y+", 0px)",_.$slideTrack.css(positionProps)))},Slick.prototype.setDimensions=function(){var _=this;_.options.vertical===!1?_.options.centerMode===!0&&_.$list.css({padding:"0px "+_.options.centerPadding}):(_.$list.height(_.$slides.first().outerHeight(!0)*_.options.slidesToShow),_.options.centerMode===!0&&_.$list.css({padding:_.options.centerPadding+" 0px"})),_.listWidth=_.$list.width(),_.listHeight=_.$list.height(),_.options.vertical===!1&&_.options.variableWidth===!1?(_.slideWidth=Math.ceil(_.listWidth/_.options.slidesToShow),_.$slideTrack.width(Math.ceil(_.slideWidth*_.$slideTrack.children(".slick-slide").length))):_.options.variableWidth===!0?_.$slideTrack.width(5e3*_.slideCount):(_.slideWidth=Math.ceil(_.listWidth),_.$slideTrack.height(Math.ceil(_.$slides.first().outerHeight(!0)*_.$slideTrack.children(".slick-slide").length)));var offset=_.$slides.first().outerWidth(!0)-_.$slides.first().width();_.options.variableWidth===!1&&_.$slideTrack.children(".slick-slide").width(_.slideWidth-offset)},Slick.prototype.setFade=function(){var targetLeft,_=this;_.$slides.each(function(index,element){targetLeft=_.slideWidth*index*-1,_.options.rtl===!0?$(element).css({position:"relative",right:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0}):$(element).css({position:"relative",left:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0})}),_.$slides.eq(_.currentSlide).css({zIndex:_.options.zIndex-1,opacity:1})},Slick.prototype.setHeight=function(){var _=this;if(1===_.options.slidesToShow&&_.options.adaptiveHeight===!0&&_.options.vertical===!1){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(!0);_.$list.css("height",targetHeight)}},Slick.prototype.setOption=Slick.prototype.slickSetOption=function(){var l,item,option,value,type,_=this,refresh=!1;if("object"===$.type(arguments[0])?(option=arguments[0],refresh=arguments[1],type="multiple"):"string"===$.type(arguments[0])&&(option=arguments[0],value=arguments[1],refresh=arguments[2],"responsive"===arguments[0]&&"array"===$.type(arguments[1])?type="responsive":"undefined"!=typeof arguments[1]&&(type="single")),"single"===type)_.options[option]=value;else if("multiple"===type)$.each(option,function(opt,val){_.options[opt]=val});else if("responsive"===type)for(item in value)if("array"!==$.type(_.options.responsive))_.options.responsive=[value[item]];else{for(l=_.options.responsive.length-1;l>=0;)_.options.responsive[l].breakpoint===value[item].breakpoint&&_.options.responsive.splice(l,1),l--;_.options.responsive.push(value[item])}refresh&&(_.unload(),_.reinit())},Slick.prototype.setPosition=function(){var _=this;_.setDimensions(),_.setHeight(),_.options.fade===!1?_.setCSS(_.getLeft(_.currentSlide)):_.setFade(),_.$slider.trigger("setPosition",[_])},Slick.prototype.setProps=function(){var _=this,bodyStyle=document.body.style;_.positionProp=_.options.vertical===!0?"top":"left","top"===_.positionProp?_.$slider.addClass("slick-vertical"):_.$slider.removeClass("slick-vertical"),void 0===bodyStyle.WebkitTransition&&void 0===bodyStyle.MozTransition&&void 0===bodyStyle.msTransition||_.options.useCSS===!0&&(_.cssTransitions=!0),_.options.fade&&("number"==typeof _.options.zIndex?_.options.zIndex<3&&(_.options.zIndex=3):_.options.zIndex=_.defaults.zIndex),void 0!==bodyStyle.OTransform&&(_.animType="OTransform",_.transformType="-o-transform",_.transitionType="OTransition",void 0===bodyStyle.perspectiveProperty&&void 0===bodyStyle.webkitPerspective&&(_.animType=!1)),void 0!==bodyStyle.MozTransform&&(_.animType="MozTransform",_.transformType="-moz-transform",_.transitionType="MozTransition",void 0===bodyStyle.perspectiveProperty&&void 0===bodyStyle.MozPerspective&&(_.animType=!1)),void 0!==bodyStyle.webkitTransform&&(_.animType="webkitTransform",_.transformType="-webkit-transform",_.transitionType="webkitTransition",void 0===bodyStyle.perspectiveProperty&&void 0===bodyStyle.webkitPerspective&&(_.animType=!1)),void 0!==bodyStyle.msTransform&&(_.animType="msTransform",_.transformType="-ms-transform",_.transitionType="msTransition",void 0===bodyStyle.msTransform&&(_.animType=!1)),void 0!==bodyStyle.transform&&_.animType!==!1&&(_.animType="transform",_.transformType="transform",_.transitionType="transition"),_.transformsEnabled=_.options.useTransform&&null!==_.animType&&_.animType!==!1},Slick.prototype.setSlideClasses=function(index){var centerOffset,allSlides,indexOffset,remainder,_=this;allSlides=_.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),_.$slides.eq(index).addClass("slick-current"),_.options.centerMode===!0?(centerOffset=Math.floor(_.options.slidesToShow/2),_.options.infinite===!0&&(index>=centerOffset&&index<=_.slideCount-1-centerOffset?_.$slides.slice(index-centerOffset,index+centerOffset+1).addClass("slick-active").attr("aria-hidden","false"):(indexOffset=_.options.slidesToShow+index,allSlides.slice(indexOffset-centerOffset+1,indexOffset+centerOffset+2).addClass("slick-active").attr("aria-hidden","false")),0===index?allSlides.eq(allSlides.length-1-_.options.slidesToShow).addClass("slick-center"):index===_.slideCount-1&&allSlides.eq(_.options.slidesToShow).addClass("slick-center")),_.$slides.eq(index).addClass("slick-center")):index>=0&&index<=_.slideCount-_.options.slidesToShow?_.$slides.slice(index,index+_.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):allSlides.length<=_.options.slidesToShow?allSlides.addClass("slick-active").attr("aria-hidden","false"):(remainder=_.slideCount%_.options.slidesToShow,indexOffset=_.options.infinite===!0?_.options.slidesToShow+index:index,_.options.slidesToShow==_.options.slidesToScroll&&_.slideCount-index<_.options.slidesToShow?allSlides.slice(indexOffset-(_.options.slidesToShow-remainder),indexOffset+remainder).addClass("slick-active").attr("aria-hidden","false"):allSlides.slice(indexOffset,indexOffset+_.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")),"ondemand"===_.options.lazyLoad&&_.lazyLoad()},Slick.prototype.setupInfinite=function(){var i,slideIndex,infiniteCount,_=this;if(_.options.fade===!0&&(_.options.centerMode=!1),_.options.infinite===!0&&_.options.fade===!1&&(slideIndex=null,_.slideCount>_.options.slidesToShow)){for(infiniteCount=_.options.centerMode===!0?_.options.slidesToShow+1:_.options.slidesToShow,i=_.slideCount;i>_.slideCount-infiniteCount;i-=1)slideIndex=i-1,$(_.$slides[slideIndex]).clone(!0).attr("id","").attr("data-slick-index",slideIndex-_.slideCount).prependTo(_.$slideTrack).addClass("slick-cloned");for(i=0;i<infiniteCount;i+=1)slideIndex=i,$(_.$slides[slideIndex]).clone(!0).attr("id","").attr("data-slick-index",slideIndex+_.slideCount).appendTo(_.$slideTrack).addClass("slick-cloned");_.$slideTrack.find(".slick-cloned").find("[id]").each(function(){$(this).attr("id","")})}},Slick.prototype.interrupt=function(toggle){var _=this;toggle||_.autoPlay(),_.interrupted=toggle},Slick.prototype.selectHandler=function(event){var _=this,targetElement=$(event.target).is(".slick-slide")?$(event.target):$(event.target).parents(".slick-slide"),index=parseInt(targetElement.attr("data-slick-index"));return index||(index=0),_.slideCount<=_.options.slidesToShow?(_.setSlideClasses(index),void _.asNavFor(index)):void _.slideHandler(index)},Slick.prototype.slideHandler=function(index,sync,dontAnimate){var targetSlide,animSlide,oldSlide,slideLeft,navTarget,targetLeft=null,_=this;if(sync=sync||!1,(_.animating!==!0||_.options.waitForAnimate!==!0)&&!(_.options.fade===!0&&_.currentSlide===index||_.slideCount<=_.options.slidesToShow))return sync===!1&&_.asNavFor(index),targetSlide=index,targetLeft=_.getLeft(targetSlide),slideLeft=_.getLeft(_.currentSlide),_.currentLeft=null===_.swipeLeft?slideLeft:_.swipeLeft,_.options.infinite===!1&&_.options.centerMode===!1&&(index<0||index>_.getDotCount()*_.options.slidesToScroll)?void(_.options.fade===!1&&(targetSlide=_.currentSlide,dontAnimate!==!0?_.animateSlide(slideLeft,function(){_.postSlide(targetSlide)}):_.postSlide(targetSlide))):_.options.infinite===!1&&_.options.centerMode===!0&&(index<0||index>_.slideCount-_.options.slidesToScroll)?void(_.options.fade===!1&&(targetSlide=_.currentSlide,dontAnimate!==!0?_.animateSlide(slideLeft,function(){_.postSlide(targetSlide)}):_.postSlide(targetSlide))):(_.options.autoplay&&clearInterval(_.autoPlayTimer),animSlide=targetSlide<0?_.slideCount%_.options.slidesToScroll!==0?_.slideCount-_.slideCount%_.options.slidesToScroll:_.slideCount+targetSlide:targetSlide>=_.slideCount?_.slideCount%_.options.slidesToScroll!==0?0:targetSlide-_.slideCount:targetSlide,_.animating=!0,_.$slider.trigger("beforeChange",[_,_.currentSlide,animSlide]),oldSlide=_.currentSlide,_.currentSlide=animSlide,_.setSlideClasses(_.currentSlide),_.options.asNavFor&&(navTarget=_.getNavTarget(),navTarget=navTarget.slick("getSlick"),navTarget.slideCount<=navTarget.options.slidesToShow&&navTarget.setSlideClasses(_.currentSlide)),_.updateDots(),_.updateArrows(),_.options.fade===!0?(dontAnimate!==!0?(_.fadeSlideOut(oldSlide),_.fadeSlide(animSlide,function(){_.postSlide(animSlide)})):_.postSlide(animSlide),void _.animateHeight()):void(dontAnimate!==!0?_.animateSlide(targetLeft,function(){_.postSlide(animSlide)}):_.postSlide(animSlide)))},Slick.prototype.startLoad=function(){var _=this;_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow.hide(),_.$nextArrow.hide()),_.options.dots===!0&&_.slideCount>_.options.slidesToShow&&_.$dots.hide(),_.$slider.addClass("slick-loading")},Slick.prototype.swipeDirection=function(){var xDist,yDist,r,swipeAngle,_=this;return xDist=_.touchObject.startX-_.touchObject.curX,yDist=_.touchObject.startY-_.touchObject.curY,r=Math.atan2(yDist,xDist),swipeAngle=Math.round(180*r/Math.PI),swipeAngle<0&&(swipeAngle=360-Math.abs(swipeAngle)),swipeAngle<=45&&swipeAngle>=0?_.options.rtl===!1?"left":"right":swipeAngle<=360&&swipeAngle>=315?_.options.rtl===!1?"left":"right":swipeAngle>=135&&swipeAngle<=225?_.options.rtl===!1?"right":"left":_.options.verticalSwiping===!0?swipeAngle>=35&&swipeAngle<=135?"down":"up":"vertical"},Slick.prototype.swipeEnd=function(event){var slideCount,direction,_=this;if(_.dragging=!1,_.interrupted=!1,_.shouldClick=!(_.touchObject.swipeLength>10),void 0===_.touchObject.curX)return!1;if(_.touchObject.edgeHit===!0&&_.$slider.trigger("edge",[_,_.swipeDirection()]),_.touchObject.swipeLength>=_.touchObject.minSwipe){switch(direction=_.swipeDirection()){case"left":case"down":slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide+_.getSlideCount()):_.currentSlide+_.getSlideCount(),_.currentDirection=0;break;case"right":case"up":slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide-_.getSlideCount()):_.currentSlide-_.getSlideCount(),_.currentDirection=1}"vertical"!=direction&&(_.slideHandler(slideCount),_.touchObject={},_.$slider.trigger("swipe",[_,direction]))}else _.touchObject.startX!==_.touchObject.curX&&(_.slideHandler(_.currentSlide),
_.touchObject={})},Slick.prototype.swipeHandler=function(event){var _=this;if(!(_.options.swipe===!1||"ontouchend"in document&&_.options.swipe===!1||_.options.draggable===!1&&event.type.indexOf("mouse")!==-1))switch(_.touchObject.fingerCount=event.originalEvent&&void 0!==event.originalEvent.touches?event.originalEvent.touches.length:1,_.touchObject.minSwipe=_.listWidth/_.options.touchThreshold,_.options.verticalSwiping===!0&&(_.touchObject.minSwipe=_.listHeight/_.options.touchThreshold),event.data.action){case"start":_.swipeStart(event);break;case"move":_.swipeMove(event);break;case"end":_.swipeEnd(event)}},Slick.prototype.swipeMove=function(event){var curLeft,swipeDirection,swipeLength,positionOffset,touches,_=this;return touches=void 0!==event.originalEvent?event.originalEvent.touches:null,!(!_.dragging||touches&&1!==touches.length)&&(curLeft=_.getLeft(_.currentSlide),_.touchObject.curX=void 0!==touches?touches[0].pageX:event.clientX,_.touchObject.curY=void 0!==touches?touches[0].pageY:event.clientY,_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curX-_.touchObject.startX,2))),_.options.verticalSwiping===!0&&(_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curY-_.touchObject.startY,2)))),swipeDirection=_.swipeDirection(),"vertical"!==swipeDirection?(void 0!==event.originalEvent&&_.touchObject.swipeLength>4&&event.preventDefault(),positionOffset=(_.options.rtl===!1?1:-1)*(_.touchObject.curX>_.touchObject.startX?1:-1),_.options.verticalSwiping===!0&&(positionOffset=_.touchObject.curY>_.touchObject.startY?1:-1),swipeLength=_.touchObject.swipeLength,_.touchObject.edgeHit=!1,_.options.infinite===!1&&(0===_.currentSlide&&"right"===swipeDirection||_.currentSlide>=_.getDotCount()&&"left"===swipeDirection)&&(swipeLength=_.touchObject.swipeLength*_.options.edgeFriction,_.touchObject.edgeHit=!0),_.options.vertical===!1?_.swipeLeft=curLeft+swipeLength*positionOffset:_.swipeLeft=curLeft+swipeLength*(_.$list.height()/_.listWidth)*positionOffset,_.options.verticalSwiping===!0&&(_.swipeLeft=curLeft+swipeLength*positionOffset),_.options.fade!==!0&&_.options.touchMove!==!1&&(_.animating===!0?(_.swipeLeft=null,!1):void _.setCSS(_.swipeLeft))):void 0)},Slick.prototype.swipeStart=function(event){var touches,_=this;return _.interrupted=!0,1!==_.touchObject.fingerCount||_.slideCount<=_.options.slidesToShow?(_.touchObject={},!1):(void 0!==event.originalEvent&&void 0!==event.originalEvent.touches&&(touches=event.originalEvent.touches[0]),_.touchObject.startX=_.touchObject.curX=void 0!==touches?touches.pageX:event.clientX,_.touchObject.startY=_.touchObject.curY=void 0!==touches?touches.pageY:event.clientY,void(_.dragging=!0))},Slick.prototype.unfilterSlides=Slick.prototype.slickUnfilter=function(){var _=this;null!==_.$slidesCache&&(_.unload(),_.$slideTrack.children(this.options.slide).detach(),_.$slidesCache.appendTo(_.$slideTrack),_.reinit())},Slick.prototype.unload=function(){var _=this;$(".slick-cloned",_.$slider).remove(),_.$dots&&_.$dots.remove(),_.$prevArrow&&_.htmlExpr.test(_.options.prevArrow)&&_.$prevArrow.remove(),_.$nextArrow&&_.htmlExpr.test(_.options.nextArrow)&&_.$nextArrow.remove(),_.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},Slick.prototype.unslick=function(fromBreakpoint){var _=this;_.$slider.trigger("unslick",[_,fromBreakpoint]),_.destroy()},Slick.prototype.updateArrows=function(){var centerOffset,_=this;centerOffset=Math.floor(_.options.slidesToShow/2),_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&!_.options.infinite&&(_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),_.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===_.currentSlide?(_.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),_.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):_.currentSlide>=_.slideCount-_.options.slidesToShow&&_.options.centerMode===!1?(_.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):_.currentSlide>=_.slideCount-1&&_.options.centerMode===!0&&(_.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},Slick.prototype.updateDots=function(){var _=this;null!==_.$dots&&(_.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true"),_.$dots.find("li").eq(Math.floor(_.currentSlide/_.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden","false"))},Slick.prototype.visibility=function(){var _=this;_.options.autoplay&&(document[_.hidden]?_.interrupted=!0:_.interrupted=!1)},$.fn.slick=function(){var i,ret,_=this,opt=arguments[0],args=Array.prototype.slice.call(arguments,1),l=_.length;for(i=0;i<l;i++)if("object"==typeof opt||"undefined"==typeof opt?_[i].slick=new Slick(_[i],opt):ret=_[i].slick[opt].apply(_[i].slick,args),"undefined"!=typeof ret)return ret;return _}}),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(g.airbrakeJs||(g.airbrakeJs={})).Client=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(global){var Client,Promise,makeOnErrorHandler,merge;require("./internal/compat"),merge=require("./internal/merge"),Promise=require("./internal/promise"),makeOnErrorHandler=function(notifier){return function(message,file,line,column,error){return error?notifier.notify(error):notifier.notify({error:{message:message,fileName:file,lineNumber:line,columnNumber:column||0}})}},Client=function(){function Client(opts){var reporter;null==opts&&(opts={}),this._projectId=opts.projectId||0,this._projectKey=opts.projectKey||"",this._host=opts.host||"https://api.airbrake.io",this._processor=null,this._reporters=[],this._filters=[],void 0!==opts.processor?this._processor=opts.processor:this._processor=require("./processors/stack"),void 0!==opts.reporter?this.addReporter(opts.reporter):(reporter="withCredentials"in new global.XMLHttpRequest?"compat":"jsonp",this.addReporter(reporter)),this.addFilter(require("./internal/default_filter")),this.onerror=makeOnErrorHandler(this),null==global.onerror&&opts.onerror!==!1&&(global.onerror=this.onerror)}return Client.prototype.setProject=function(id,key){return this._projectId=id,this._projectKey=key},Client.prototype.setHost=function(host){return this._host=host},Client.prototype.addContext=function(context){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: addContext is deprecated, please use addFilter"),this.addFilter(function(notice){return notice.context=merge({},context,notice.context),notice})},Client.prototype.setEnvironmentName=function(envName){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: setEnvironmentName is deprecated, please use addFilter"),this.addFilter(function(notice){return null==notice.context.environment&&(notice.context.environment=envName),notice})},Client.prototype.addParams=function(params){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: addParams is deprecated, please use addFilter"),this.addFilter(function(notice){return notice.params=merge({},params,notice.params),notice})},Client.prototype.addEnvironment=function(env){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: addEnvironment is deprecated, please use addFilter"),this.addFilter(function(notice){return notice.environment=merge({},env,notice.environment),notice})},Client.prototype.addSession=function(session){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: addSession is deprecated, please use addFilter"),this.addFilter(function(notice){return notice.session=merge({},session,notice.session),notice})},Client.prototype.addReporter=function(reporter){switch(reporter){case"compat":reporter=require("./reporters/compat");break;case"xhr":reporter=require("./reporters/xhr");break;case"jsonp":reporter=require("./reporters/jsonp")}return this._reporters.push(reporter)},Client.prototype.addFilter=function(filter){return this._filters.push(filter)},Client.prototype.notify=function(err){var defContext,promise,ref;return defContext={language:"JavaScript",sourceMapEnabled:!0},(null!=(ref=global.navigator)?ref.userAgent:void 0)&&(defContext.userAgent=global.navigator.userAgent),global.location&&(defContext.url=String(global.location),defContext.rootDirectory=global.location.protocol+"//"+global.location.host),promise=new Promise,this._processor(err.error||err,function(_this){return function(processorName,errInfo){var filterFn,j,k,len,len1,n,notice,opts,ref1,ref2,reporterFn;for(notice={errors:[errInfo],context:merge(defContext,err.context),params:err.params||{},environment:err.environment||{},session:err.session||{}},notice.context.notifier={name:"airbrake-js-"+processorName,version:"0.5.9",url:"https://github.com/airbrake/airbrake-js"},ref1=_this._filters,j=0,len=ref1.length;j<len;j++){if(filterFn=ref1[j],n=filterFn(notice),null===n||n===!1)return;null!=n.errors?notice=n:"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: filter must return notice or null to ignore the notice")}for(opts={projectId:_this._projectId,projectKey:_this._projectKey,host:_this._host},ref2=_this._reporters,k=0,len1=ref2.length;k<len1;k++)(reporterFn=ref2[k])(notice,opts,promise)}}(this)),promise},Client.prototype.push=function(err){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: push is deprecated, please use notify"),this.notify(err)},Client.prototype._wrapArguments=function(args){var arg,i,j,len;for(i=j=0,len=args.length;j<len;i=++j)arg=args[i],"function"==typeof arg&&(args[i]=this.wrap(arg));return args},Client.prototype.wrap=function(fn){var airbrakeWrapper,prop,self;if(fn.__airbrake__)return fn;self=this,airbrakeWrapper=function(){var args,exc;args=self._wrapArguments(arguments);try{return fn.apply(this,args)}catch(_error){exc=_error,args=Array.prototype.slice.call(arguments),self.notify({error:exc,params:{arguments:args}})}};for(prop in fn)fn.hasOwnProperty(prop)&&(airbrakeWrapper[prop]=fn[prop]);return airbrakeWrapper.__airbrake__=!0,airbrakeWrapper.__inner__=fn,airbrakeWrapper},Client}(),module.exports=Client}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./internal/compat":2,"./internal/default_filter":3,"./internal/merge":5,"./internal/promise":6,"./processors/stack":8,"./reporters/compat":9,"./reporters/jsonp":10,"./reporters/xhr":11}],2:[function(require,module,exports){var base;null==(base=Array.prototype).indexOf&&(base.indexOf=function(obj,start){var i,j,ref,ref1;for(start=start||0,i=j=ref=start,ref1=this.length;ref<=ref1?j<ref1:j>ref1;i=ref<=ref1?++j:--j)if(this[i]===obj)return i;return-1})},{}],3:[function(require,module,exports){var IGNORED_MESSAGES,filter,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};IGNORED_MESSAGES=["Script error","Script error."],filter=function(notice){var msg;return msg=notice.errors[0].message,indexOf.call(IGNORED_MESSAGES,msg)>=0?null:notice},module.exports=filter},{}],4:[function(require,module,exports){var jsonifyNotice,truncate,truncateObj;truncate=require("./truncate"),truncateObj=function(obj,n){var dst,key;null==n&&(n=1e3),dst={};for(key in obj)dst[key]=truncate(obj[key],n=n);return dst},jsonifyNotice=function(notice,n,maxLength){var err,s;for(null==n&&(n=1e3),null==maxLength&&(maxLength=64e3);;){if(notice.params=truncateObj(notice.params,n=n),notice.environment=truncateObj(notice.environment,n=n),notice.session=truncateObj(notice.session,n=n),s=JSON.stringify(notice),s.length<maxLength)return s;if(0===n)break;n=Math.floor(n/2)}throw err=new Error("airbrake-js: cannot jsonify notice (length="+s.length+" maxLength="+maxLength+")"),err.params={json:s.slice(0,+Math.floor(n/2)+1||9e9)+"..."},err},module.exports=jsonifyNotice},{"./truncate":7}],5:[function(require,module,exports){var merge;merge=function(){var dst,i,key,len,obj,objs;for(objs=Array.prototype.slice.call(arguments),dst=objs.shift()||{},i=0,len=objs.length;i<len;i++){obj=objs[i];for(key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(dst[key]=obj[key])}return dst},module.exports=merge},{}],6:[function(require,module,exports){var Promise;Promise=function(){function Promise(executor){var reject,resolve;this._onResolved=[],this._onRejected=[],resolve=function(_this){return function(){return _this.resolve.apply(_this,arguments)}}(this),reject=function(_this){return function(){return _this.reject.apply(_this,arguments)}}(this),null!=executor&&executor(resolve,reject)}return Promise.prototype.then=function(onResolved,onRejected){return onResolved&&(null!=this._resolvedWith&&onResolved(this._resolvedWith),this._onResolved.push(onResolved)),onRejected&&(null!=this._rejectedWith&&onRejected(this._resolvedWith),this._onRejected.push(onRejected)),this},Promise.prototype["catch"]=function(onRejected){return null!=this._rejectedWith&&onRejected(this._rejectedWith),this._onRejected.push(onRejected),this},Promise.prototype.resolve=function(){var fn,i,len,ref;for(this._resolvedWith=arguments,ref=this._onResolved,i=0,len=ref.length;i<len;i++)fn=ref[i],fn.apply(this,this._resolvedWith);return this},Promise.prototype.reject=function(){var fn,i,len,ref;for(this._rejectedWith=arguments,ref=this._onRejected,i=0,len=ref.length;i<len;i++)fn=ref[i],fn.apply(this,this._rejectedWith);return this},Promise}(),module.exports=Promise},{}],7:[function(require,module,exports){var getAttr,truncate;getAttr=function(obj,attr){var exc;try{return obj[attr]}catch(_error){return void(exc=_error)}},truncate=function(value,n,depth){var fn,getPath,keys,nn,seen;return null==n&&(n=1e3),null==depth&&(depth=5),nn=0,keys=[],seen=[],getPath=function(value){var i,index,j,path,ref;for(index=seen.indexOf(value),path=[keys[index]],i=j=ref=index;ref<=0?j<=0:j>=0;i=ref<=0?++j:--j)seen[i]&&getAttr(seen[i],path[0])===value&&(value=seen[i],path.unshift(keys[i]));return"~"+path.join(".")},(fn=function(value,key,dd){var dst,el,i,j,len,val;if(null==key&&(key=""),null==dd&&(dd=0),nn++,nn>n)return"[Truncated]";if(null===value||void 0===value)return value;switch(typeof value){case"boolean":case"number":case"string":case"function":return value;case"object":break;default:return String(value)}if(value instanceof Boolean||value instanceof Number||value instanceof String||value instanceof Date||value instanceof RegExp)return value;if(seen.indexOf(value)>=0)return"[Circular "+getPath(value)+"]";if(dd++,dd>depth)return"[Truncated]";if(keys.push(key),seen.push(value),nn--,"[object Array]"===Object.prototype.toString.apply(value)){for(dst=[],i=j=0,len=value.length;j<len&&(el=value[i],nn++,!(nn>=n));i=++j)dst.push(fn(el,key=i,dd));return dst}dst={};for(key in value)if(Object.prototype.hasOwnProperty.call(value,key)){if(nn++,nn>=n)break;val=getAttr(value,key),void 0!==val&&(dst[key]=fn(val,key=key,dd))}return dst})(value)},module.exports=truncate},{}],8:[function(require,module,exports){var processor,rules,typeMessageRe;rules=[{name:"v8",re:/^\s*at\s(.+?)\s\((?:(?:(.+):(\d+):(\d+))|(.+))\)$/,fn:function(m){return{"function":m[1],file:m[2]||m[5],line:m[3]&&parseInt(m[3],10)||0,column:m[4]&&parseInt(m[4],10)||0}}},{name:"firefox30",re:/^(.*)@(.+):(\d+):(\d+)$/,fn:function(m){var evaledRe,file,func,mm;return func=m[1],file=m[2],evaledRe=/^(\S+)\s(line\s\d+\s>\seval.*)$/,(mm=file.match(evaledRe))&&(func=func.length>0?func+" "+mm[2]:mm[2],file=mm[1]),{"function":func,file:file,line:parseInt(m[3],10),column:parseInt(m[4],10)}}},{name:"firefox14",re:/^(.*)@(.+):(\d+)$/,fn:function(m,i,e){var column;return column=0===i?e.columnNumber||0:0,{"function":m[1],file:m[2],line:parseInt(m[3],10),column:column}}},{name:"v8-short",re:/^\s*at\s(.+):(\d+):(\d+)$/,fn:function(m){return{"function":"",file:m[1],line:parseInt(m[2],10),column:parseInt(m[3],10)}}},{name:"phantomjs",re:/^\s*at\s(.+):(\d+)$/,fn:function(m){return{"function":"",file:m[1],line:parseInt(m[2],10),column:0}}},{name:"default",re:/.+/,fn:function(m){return{"function":m[0],file:"",line:0,column:0}}}],typeMessageRe=/^\S+:\s.+$/,processor=function(e,cb){var backtrace,i,j,k,len,len1,line,lines,m,msg,processorName,rule,stack,type,uncaughtExcRe;for(processorName="nostack",stack=e.stack||"",lines=stack.split("\n"),backtrace=[],i=j=0,len=lines.length;j<len;i=++j)if(line=lines[i],""!==line)for(k=0,len1=rules.length;k<len1;k++)if(rule=rules[k],m=line.match(rule.re)){processorName=rule.name,backtrace.push(rule.fn(m,i,e));break}return("v8"===processorName||"v8-short"===processorName)&&backtrace.length>0&&backtrace[0]["function"].match(typeMessageRe)&&(backtrace=backtrace.slice(1)),0!==backtrace.length||null==e.fileName&&null==e.lineNumber&&null==e.columnNumber||backtrace.push({"function":"",file:e.fileName||"",line:parseInt(e.lineNumber,10)||0,column:parseInt(e.columnNumber,10)||0}),0!==backtrace.length||null==e.filename&&null==e.lineno&&null==e.column&&null==e.colno||backtrace.push({"function":"",file:e.filename||"",line:parseInt(e.lineno,10)||0,column:parseInt(e.column||e.colno,10)||0}),msg=null!=e.message?e.message:String(e),null!=e.name&&""!==e.name?type=e.name:(uncaughtExcRe=/^Uncaught\s(.+?):\s(.+)$/,m=msg.match(uncaughtExcRe),m?(type=m[1],msg=m[2]):type=""),""===type&&""===msg&&0===backtrace.length?void("undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("airbrake: can't process error",e)):cb(processorName,{type:type,message:msg,backtrace:backtrace})},module.exports=processor},{}],9:[function(require,module,exports){(function(global){var jsonifyNotice,report;jsonifyNotice=require("../internal/jsonify_notice"),report=function(notice,opts,promise){var payload,req,url;return url=opts.host+"/api/v3/projects/"+opts.projectId+"/create-notice?key="+opts.projectKey,payload=jsonifyNotice(notice),req=new global.XMLHttpRequest,req.open("POST",url,!0),req.send(payload),req.onreadystatechange=function(){var resp;if(4===req.readyState&&200===req.status)return resp=JSON.parse(req.responseText),notice.id=resp.id,promise.resolve(notice)}},module.exports=report}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../internal/jsonify_notice":4}],10:[function(require,module,exports){(function(global){var cbCount,jsonifyNotice,report;jsonifyNotice=require("../internal/jsonify_notice"),cbCount=0,report=function(notice,opts,promise){var cbName,document,head,payload,removeScript,script,url;return cbCount++,cbName="airbrakeCb"+String(cbCount),global[cbName]=function(resp){var _;notice.id=resp.id,promise.resolve(notice);try{return delete global[cbName]}catch(_error){return _=_error,global[cbName]=void 0}},payload=encodeURIComponent(jsonifyNotice(notice)),url=opts.host+"/api/v3/projects/"+opts.projectId+"/create-notice?key="+opts.projectKey+"&callback="+cbName+"&body="+payload,document=global.document,head=document.getElementsByTagName("head")[0],script=document.createElement("script"),script.src=url,removeScript=function(){return head.removeChild(script)},script.onload=removeScript,script.onerror=removeScript,head.appendChild(script)},module.exports=report}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../internal/jsonify_notice":4}],11:[function(require,module,exports){(function(global){var jsonifyNotice,report;jsonifyNotice=require("../internal/jsonify_notice"),report=function(notice,opts,promise){var payload,req,url;return url=opts.host+"/api/v3/projects/"+opts.projectId+"/notices?key="+opts.projectKey,payload=jsonifyNotice(notice),req=new global.XMLHttpRequest,req.open("POST",url,!0),req.setRequestHeader("Content-Type","application/json"),req.send(payload),req.onreadystatechange=function(){var resp;if(4===req.readyState&&201===req.status)return resp=JSON.parse(req.responseText),notice.id=resp.id,promise.resolve(notice)}},module.exports=report}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../internal/jsonify_notice":4}]},{},[1])(1)}),angular.module("pusher-angular",[]).factory("$pusher",["$rootScope","$channel","$connection",function($rootScope,$channel,$connection){function PusherAngular(pusherClient){return this instanceof PusherAngular?(this._assertValidClient(pusherClient),this.client=pusherClient,this.connection=$connection(pusherClient.connection,pusherClient),void(this.channels={})):new PusherAngular(pusherClient)}return PusherAngular.prototype={subscribe:function(channelName){var channel=this.client.channel(channelName);return void 0===channel&&(channel=this.client.subscribe(channelName)),channel=$channel(channel,this),this.channels[channelName]=channel,channel},unsubscribe:function(channelName){this.client.channel(channelName)&&(this.client.unsubscribe(channelName),this.channels[channelName]&&delete this.channels[channelName])},bind:function(eventName,callback,context,invokeDigest){var skipDigest=angular.isDefined(invokeDigest)&&!invokeDigest,decoratedCallback=function(data){callback(data),skipDigest||$rootScope.$digest()};return this.client.bind(eventName,decoratedCallback,context),decoratedCallback},bind_all:function(callback,invokeDigest){var skipDigest=angular.isDefined(invokeDigest)&&!invokeDigest;this.client.bind_all(function(eventName,data){callback(eventName,data),skipDigest||$rootScope.$digest()})},unbind:function(eventName,decoratedCallback,context){this.client.unbind(eventName,decoratedCallback,context)},disconnect:function(){this.client.disconnect()},channel:function(channelName){return this.channels[channelName]},allChannels:function(){return this.channels},_assertValidClient:function(pusherClient){if(!angular.isObject(pusherClient)||!angular.isObject(pusherClient.connection)||"function"!=typeof pusherClient.channel)throw new Error("Invalid Pusher client object")}},PusherAngular}]).factory("$channel",["$rootScope","$members",function($rootScope,$members){function checkPresenceOrPrivateChannel(channelName){if(channelName.indexOf("presence-")==-1&&channelName.indexOf("private-")==-1)throw new Error("Presence or private channel required")}function $channel(baseChannel,$pusherClient){return this instanceof $channel?(this._assertValidChannel(baseChannel),this.baseChannel=baseChannel,this.client=$pusherClient,this.name=baseChannel.name,void(baseChannel.name.indexOf("presence")==-1?this.members=function(){throw new Error("Members object only exists for presence channels")}:this.members=$members(baseChannel.members,baseChannel))):new $channel(baseChannel,$pusherClient)}return $channel.prototype={bind:function(eventName,callback,context,invokeDigest){var skipDigest=angular.isDefined(invokeDigest)&&!invokeDigest,decoratedCallback=function(data){callback(data),skipDigest||$rootScope.$digest()};return this.baseChannel.bind(eventName,decoratedCallback,context),decoratedCallback},unbind:function(eventName,decoratedCallback,context){this.baseChannel.unbind(eventName,decoratedCallback,context)},bind_all:function(callback,invokeDigest){var skipDigest=angular.isDefined(invokeDigest)&&!invokeDigest;this.baseChannel.bind_all(function(eventName,data){callback(eventName,data),skipDigest||$rootScope.$digest()})},trigger:function(eventName,obj){if(checkPresenceOrPrivateChannel(this.name),eventName.indexOf("client-")==-1)throw new Error("Event name requires 'client-' prefix");return this.baseChannel.trigger(eventName,obj)},_assertValidChannel:function(baseChannel){if(!angular.isObject(baseChannel)||"string"!=typeof baseChannel.name)throw new Error("Invalid Pusher channel object")}},$channel}]).factory("$members",["$rootScope",function($rootScope){function $members(baseMembers,baseChannel){if(!(this instanceof $members))return new $members(baseMembers,baseChannel);var self=this;this._assertValidMembers(baseMembers),this.baseMembers=baseMembers,this.baseChannel=baseChannel,this.me={},this.count=0,this.members={},baseChannel.bind("pusher:subscription_succeeded",function(members){self.me=members.me,self.count=members.count,self.members=members.members,$rootScope.$digest()}),baseChannel.bind("pusher:member_added",function(member){self.count++,member.info?self.members[member.id.toString()]=member.info:self.members[member.id.toString()]=null,$rootScope.$digest()}),baseChannel.bind("pusher:member_removed",function(member){self.count--,delete self.members[member.id.toString()],$rootScope.$digest()})}return $members.prototype={get:function(id){return this.baseMembers.get(id)},each:function(callback){this.baseMembers.each(function(member){callback(member),$rootScope.$digest()})},_assertValidMembers:function(baseMembers){if(!angular.isObject(baseMembers)||"object"!=typeof baseMembers.me)throw new Error("Invalid Pusher channel members object")}},$members}]).factory("$connection",["$rootScope",function($rootScope){function $connection(baseConnection,baseClient){return this instanceof $connection?(this._assertValidConnection(baseConnection),this.baseConnection=baseConnection,void(this.baseClient=baseClient)):new $connection(baseConnection,baseClient)}return $connection.prototype={bind:function(eventName,callback,context,invokeDigest){var skipDigest=angular.isDefined(invokeDigest)&&!invokeDigest;this.baseConnection.bind(eventName,function(data){callback(data),skipDigest||$rootScope.$digest()},context)},bind_all:function(callback,invokeDigest){var skipDigest=angular.isDefined(invokeDigest)&&!invokeDigest;this.baseConnection.bind_all(function(eventName,data){callback(eventName,data),skipDigest||$rootScope.$digest()})},_assertValidConnection:function(baseConnection){if(!angular.isObject(baseConnection))throw new Error("Invalid Pusher connection object")}},$connection}]),function(){function Pusher(app_key,options){checkAppKey(app_key),options=options||{};var self=this;this.key=app_key,this.config=Pusher.Util.extend(Pusher.getGlobalConfig(),options.cluster?Pusher.getClusterConfig(options.cluster):{},options),this.channels=new Pusher.Channels,this.global_emitter=new Pusher.EventsDispatcher,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new Pusher.Timeline(this.key,this.sessionID,{cluster:this.config.cluster,features:Pusher.Util.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:Pusher.Timeline.INFO,version:Pusher.VERSION}),this.config.disableStats||(this.timelineSender=new Pusher.TimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/jsonp"}));var getStrategy=function(options){var config=Pusher.Util.extend({},self.config,options);return Pusher.StrategyBuilder.build(Pusher.getDefaultStrategy(config),config)};this.connection=new Pusher.ConnectionManager(this.key,Pusher.Util.extend({getStrategy:getStrategy,timeline:this.timeline,activityTimeout:this.config.activity_timeout,pongTimeout:this.config.pong_timeout,unavailableTimeout:this.config.unavailable_timeout},this.config,{encrypted:this.isEncrypted()})),this.connection.bind("connected",function(){self.subscribeAll(),self.timelineSender&&self.timelineSender.send(self.connection.isEncrypted())}),this.connection.bind("message",function(params){var internal=0===params.event.indexOf("pusher_internal:");if(params.channel){var channel=self.channel(params.channel);channel&&channel.handleEvent(params.event,params.data)}internal||self.global_emitter.emit(params.event,params.data)}),this.connection.bind("disconnected",function(){self.channels.disconnect()}),this.connection.bind("error",function(err){Pusher.warn("Error",err)}),Pusher.instances.push(this),this.timeline.info({instances:Pusher.instances.length}),Pusher.isReady&&self.connect()}function checkAppKey(key){null!==key&&void 0!==key||Pusher.warn("Warning","You must pass your app key when you instantiate Pusher.")}var prototype=Pusher.prototype;Pusher.instances=[],Pusher.isReady=!1,Pusher.debug=function(){Pusher.log&&Pusher.log(Pusher.Util.stringify.apply(this,arguments))},Pusher.warn=function(){var message=Pusher.Util.stringify.apply(this,arguments);window.console&&(window.console.warn?window.console.warn(message):window.console.log&&window.console.log(message)),Pusher.log&&Pusher.log(message)},Pusher.ready=function(){Pusher.isReady=!0;for(var i=0,l=Pusher.instances.length;i<l;i++)Pusher.instances[i].connect()},prototype.channel=function(name){return this.channels.find(name)},prototype.allChannels=function(){return this.channels.all()},prototype.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var encrypted=this.connection.isEncrypted(),timelineSender=this.timelineSender;this.timelineSenderTimer=new Pusher.PeriodicTimer(6e4,function(){timelineSender.send(encrypted)})}},prototype.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},prototype.bind=function(event_name,callback){return this.global_emitter.bind(event_name,callback),this},prototype.bind_all=function(callback){return this.global_emitter.bind_all(callback),this},prototype.subscribeAll=function(){var channelName;for(channelName in this.channels.channels)this.channels.channels.hasOwnProperty(channelName)&&this.subscribe(channelName)},prototype.subscribe=function(channel_name){var channel=this.channels.add(channel_name,this);return"connected"===this.connection.state&&channel.subscribe(),channel},prototype.unsubscribe=function(channel_name){var channel=this.channels.remove(channel_name);"connected"===this.connection.state&&channel.unsubscribe()},prototype.send_event=function(event_name,data,channel){return this.connection.send_event(event_name,data,channel)},prototype.isEncrypted=function(){return"https:"===Pusher.Util.getDocument().location.protocol||Boolean(this.config.encrypted)},Pusher.HTTP={},this.Pusher=Pusher}.call(this),function(){function clearTimeout(timer){window.clearTimeout(timer)}function clearInterval(timer){window.clearInterval(timer)}function GenericTimer(set,clear,delay,callback){var self=this;this.clear=clear,this.timer=set(function(){null!==self.timer&&(self.timer=callback(self.timer))},delay)}var prototype=GenericTimer.prototype;prototype.isRunning=function(){return null!==this.timer},prototype.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},Pusher.Timer=function(delay,callback){return new GenericTimer(setTimeout,clearTimeout,delay,function(timer){return callback(),null})},Pusher.PeriodicTimer=function(delay,callback){return new GenericTimer(setInterval,clearInterval,delay,function(timer){return callback(),timer})}}.call(this),function(){Pusher.Util={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(callback){return new Pusher.Timer(0,callback)},extend:function(target){for(var i=1;i<arguments.length;i++){var extensions=arguments[i];for(var property in extensions)extensions[property]&&extensions[property].constructor&&extensions[property].constructor===Object?target[property]=Pusher.Util.extend(target[property]||{},extensions[property]):target[property]=extensions[property];
}return target},stringify:function(){for(var m=["Pusher"],i=0;i<arguments.length;i++)"string"==typeof arguments[i]?m.push(arguments[i]):void 0===window.JSON?m.push(arguments[i].toString()):m.push(JSON.stringify(arguments[i]));return m.join(" : ")},arrayIndexOf:function(array,item){var nativeIndexOf=Array.prototype.indexOf;if(null===array)return-1;if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(var i=0,l=array.length;i<l;i++)if(array[i]===item)return i;return-1},objectApply:function(object,f){for(var key in object)Object.prototype.hasOwnProperty.call(object,key)&&f(object[key],key,object)},keys:function(object){var keys=[];return Pusher.Util.objectApply(object,function(_,key){keys.push(key)}),keys},values:function(object){var values=[];return Pusher.Util.objectApply(object,function(value){values.push(value)}),values},apply:function(array,f,context){for(var i=0;i<array.length;i++)f.call(context||window,array[i],i,array)},map:function(array,f){for(var result=[],i=0;i<array.length;i++)result.push(f(array[i],i,array,result));return result},mapObject:function(object,f){var result={};return Pusher.Util.objectApply(object,function(value,key){result[key]=f(value)}),result},filter:function(array,test){test=test||function(value){return!!value};for(var result=[],i=0;i<array.length;i++)test(array[i],i,array,result)&&result.push(array[i]);return result},filterObject:function(object,test){var result={};return Pusher.Util.objectApply(object,function(value,key){(test&&test(value,key,object,result)||Boolean(value))&&(result[key]=value)}),result},flatten:function(object){var result=[];return Pusher.Util.objectApply(object,function(value,key){result.push([key,value])}),result},any:function(array,test){for(var i=0;i<array.length;i++)if(test(array[i],i,array))return!0;return!1},all:function(array,test){for(var i=0;i<array.length;i++)if(!test(array[i],i,array))return!1;return!0},method:function(name){var boundArguments=Array.prototype.slice.call(arguments,1);return function(object){return object[name].apply(object,boundArguments.concat(arguments))}},getWindow:function(){return window},getDocument:function(){return document},getNavigator:function(){return navigator},getLocalStorage:function(){try{return window.localStorage}catch(e){return}},getClientFeatures:function(){return Pusher.Util.keys(Pusher.Util.filterObject({ws:Pusher.WSTransport,flash:Pusher.FlashTransport},function(t){return t.isSupported({})}))},addWindowListener:function(event,listener){var _window=Pusher.Util.getWindow();void 0!==_window.addEventListener?_window.addEventListener(event,listener,!1):_window.attachEvent("on"+event,listener)},removeWindowListener:function(event,listener){var _window=Pusher.Util.getWindow();void 0!==_window.addEventListener?_window.removeEventListener(event,listener,!1):_window.detachEvent("on"+event,listener)},isXHRSupported:function(){var XHR=window.XMLHttpRequest;return Boolean(XHR)&&void 0!==(new XHR).withCredentials},isXDRSupported:function(encrypted){var protocol=encrypted?"https:":"http:",documentProtocol=Pusher.Util.getDocument().location.protocol;return Boolean(window.XDomainRequest)&&documentProtocol===protocol}}}.call(this),function(){Pusher.VERSION="2.2.4",Pusher.PROTOCOL=7,Pusher.host="ws.pusherapp.com",Pusher.ws_port=80,Pusher.wss_port=443,Pusher.sockjs_host="sockjs.pusher.com",Pusher.sockjs_http_port=80,Pusher.sockjs_https_port=443,Pusher.sockjs_path="/pusher",Pusher.stats_host="stats.pusher.com",Pusher.channel_auth_endpoint="/pusher/auth",Pusher.channel_auth_transport="ajax",Pusher.activity_timeout=12e4,Pusher.pong_timeout=3e4,Pusher.unavailable_timeout=1e4,Pusher.cdn_http="http://js.pusher.com/",Pusher.cdn_https="https://js.pusher.com/",Pusher.dependency_suffix="",Pusher.getDefaultStrategy=function(config){var wsStrategy;return wsStrategy=config.encrypted?[":best_connected_ever",":ws_loop",[":delayed",2e3,[":http_fallback_loop"]]]:[":best_connected_ever",":ws_loop",[":delayed",2e3,[":wss_loop"]],[":delayed",5e3,[":http_fallback_loop"]]],[[":def","ws_options",{hostUnencrypted:config.wsHost+":"+config.wsPort,hostEncrypted:config.wsHost+":"+config.wssPort}],[":def","wss_options",[":extend",":ws_options",{encrypted:!0}]],[":def","sockjs_options",{hostUnencrypted:config.httpHost+":"+config.httpPort,hostEncrypted:config.httpHost+":"+config.httpsPort,httpPath:config.httpPath}],[":def","timeouts",{loop:!0,timeout:15e3,timeoutLimit:6e4}],[":def","ws_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:config.activity_timeout}]],[":def","streaming_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:config.activity_timeout}]],[":def_transport","ws","ws",3,":ws_options",":ws_manager"],[":def_transport","wss","ws",3,":wss_options",":ws_manager"],[":def_transport","flash","flash",2,":ws_options",":ws_manager"],[":def_transport","sockjs","sockjs",1,":sockjs_options"],[":def_transport","xhr_streaming","xhr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport","xdr_streaming","xdr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport","xhr_polling","xhr_polling",1,":sockjs_options"],[":def_transport","xdr_polling","xdr_polling",1,":sockjs_options"],[":def","ws_loop",[":sequential",":timeouts",":ws"]],[":def","wss_loop",[":sequential",":timeouts",":wss"]],[":def","flash_loop",[":sequential",":timeouts",":flash"]],[":def","sockjs_loop",[":sequential",":timeouts",":sockjs"]],[":def","streaming_loop",[":sequential",":timeouts",[":if",[":is_supported",":xhr_streaming"],":xhr_streaming",":xdr_streaming"]]],[":def","polling_loop",[":sequential",":timeouts",[":if",[":is_supported",":xhr_polling"],":xhr_polling",":xdr_polling"]]],[":def","http_loop",[":if",[":is_supported",":streaming_loop"],[":best_connected_ever",":streaming_loop",[":delayed",4e3,[":polling_loop"]]],[":polling_loop"]]],[":def","http_fallback_loop",[":if",[":is_supported",":http_loop"],[":http_loop"],[":sockjs_loop"]]],[":def","strategy",[":cached",18e5,[":first_connected",[":if",[":is_supported",":ws"],wsStrategy,[":if",[":is_supported",":flash"],[":best_connected_ever",":flash_loop",[":delayed",2e3,[":http_fallback_loop"]]],[":http_fallback_loop"]]]]]]]}}.call(this),function(){Pusher.getGlobalConfig=function(){return{wsHost:Pusher.host,wsPort:Pusher.ws_port,wssPort:Pusher.wss_port,httpHost:Pusher.sockjs_host,httpPort:Pusher.sockjs_http_port,httpsPort:Pusher.sockjs_https_port,httpPath:Pusher.sockjs_path,statsHost:Pusher.stats_host,authEndpoint:Pusher.channel_auth_endpoint,authTransport:Pusher.channel_auth_transport,activity_timeout:Pusher.activity_timeout,pong_timeout:Pusher.pong_timeout,unavailable_timeout:Pusher.unavailable_timeout}},Pusher.getClusterConfig=function(clusterName){return{wsHost:"ws-"+clusterName+".pusher.com",httpHost:"sockjs-"+clusterName+".pusher.com"}}}.call(this),function(){function buildExceptionClass(name){var constructor=function(message){Error.call(this,message),this.name=name};return Pusher.Util.extend(constructor.prototype,Error.prototype),constructor}Pusher.Errors={BadEventName:buildExceptionClass("BadEventName"),RequestTimedOut:buildExceptionClass("RequestTimedOut"),TransportPriorityTooLow:buildExceptionClass("TransportPriorityTooLow"),TransportClosed:buildExceptionClass("TransportClosed"),UnsupportedTransport:buildExceptionClass("UnsupportedTransport"),UnsupportedStrategy:buildExceptionClass("UnsupportedStrategy")}}.call(this),function(){function EventsDispatcher(failThrough){this.callbacks=new CallbackRegistry,this.global_callbacks=[],this.failThrough=failThrough}function CallbackRegistry(){this._callbacks={}}function prefix(name){return"_"+name}var prototype=EventsDispatcher.prototype;prototype.bind=function(eventName,callback,context){return this.callbacks.add(eventName,callback,context),this},prototype.bind_all=function(callback){return this.global_callbacks.push(callback),this},prototype.unbind=function(eventName,callback,context){return this.callbacks.remove(eventName,callback,context),this},prototype.unbind_all=function(eventName,callback){return this.callbacks.remove(eventName,callback),this},prototype.emit=function(eventName,data){var i;for(i=0;i<this.global_callbacks.length;i++)this.global_callbacks[i](eventName,data);var callbacks=this.callbacks.get(eventName);if(callbacks&&callbacks.length>0)for(i=0;i<callbacks.length;i++)callbacks[i].fn.call(callbacks[i].context||window,data);else this.failThrough&&this.failThrough(eventName,data);return this},CallbackRegistry.prototype.get=function(name){return this._callbacks[prefix(name)]},CallbackRegistry.prototype.add=function(name,callback,context){var prefixedEventName=prefix(name);this._callbacks[prefixedEventName]=this._callbacks[prefixedEventName]||[],this._callbacks[prefixedEventName].push({fn:callback,context:context})},CallbackRegistry.prototype.remove=function(name,callback,context){if(!name&&!callback&&!context)return void(this._callbacks={});var names=name?[prefix(name)]:Pusher.Util.keys(this._callbacks);callback||context?Pusher.Util.apply(names,function(name){this._callbacks[name]=Pusher.Util.filter(this._callbacks[name]||[],function(binding){return callback&&callback!==binding.fn||context&&context!==binding.context}),0===this._callbacks[name].length&&delete this._callbacks[name]},this):Pusher.Util.apply(names,function(name){delete this._callbacks[name]},this)},Pusher.EventsDispatcher=EventsDispatcher}.call(this),function(){function ScriptReceiverFactory(prefix,name){this.lastId=0,this.prefix=prefix,this.name=name}var prototype=ScriptReceiverFactory.prototype;prototype.create=function(callback){this.lastId++;var number=this.lastId,id=this.prefix+number,name=this.name+"["+number+"]",called=!1,callbackWrapper=function(){called||(callback.apply(null,arguments),called=!0)};return this[number]=callbackWrapper,{number:number,id:id,name:name,callback:callbackWrapper}},prototype.remove=function(receiver){delete this[receiver.number]},Pusher.ScriptReceiverFactory=ScriptReceiverFactory,Pusher.ScriptReceivers=new ScriptReceiverFactory("_pusher_script_","Pusher.ScriptReceivers")}.call(this),function(){function ScriptRequest(src){this.src=src}var prototype=ScriptRequest.prototype;prototype.send=function(receiver){var self=this,errorString="Error loading "+self.src;self.script=document.createElement("script"),self.script.id=receiver.id,self.script.src=self.src,self.script.type="text/javascript",self.script.charset="UTF-8",self.script.addEventListener?(self.script.onerror=function(){receiver.callback(errorString)},self.script.onload=function(){receiver.callback(null)}):self.script.onreadystatechange=function(){"loaded"!==self.script.readyState&&"complete"!==self.script.readyState||receiver.callback(null)},void 0===self.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(self.errorScript=document.createElement("script"),self.errorScript.id=receiver.id+"_error",self.errorScript.text=receiver.name+"('"+errorString+"');",self.script.async=self.errorScript.async=!1):self.script.async=!0;var head=document.getElementsByTagName("head")[0];head.insertBefore(self.script,head.firstChild),self.errorScript&&head.insertBefore(self.errorScript,self.script.nextSibling)},prototype.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null},Pusher.ScriptRequest=ScriptRequest}.call(this),function(){function DependencyLoader(options){this.options=options,this.receivers=options.receivers||Pusher.ScriptReceivers,this.loading={}}var prototype=DependencyLoader.prototype;prototype.load=function(name,options,callback){var self=this;if(self.loading[name]&&self.loading[name].length>0)self.loading[name].push(callback);else{self.loading[name]=[callback];var request=new Pusher.ScriptRequest(self.getPath(name,options)),receiver=self.receivers.create(function(error){if(self.receivers.remove(receiver),self.loading[name]){var callbacks=self.loading[name];delete self.loading[name];for(var successCallback=function(wasSuccessful){wasSuccessful||request.cleanup()},i=0;i<callbacks.length;i++)callbacks[i](error,successCallback)}});request.send(receiver)}},prototype.getRoot=function(options){var cdn,protocol=Pusher.Util.getDocument().location.protocol;return cdn=options&&options.encrypted||"https:"===protocol?this.options.cdn_https:this.options.cdn_http,cdn.replace(/\/*$/,"")+"/"+this.options.version},prototype.getPath=function(name,options){return this.getRoot(options)+"/"+name+this.options.suffix+".js"},Pusher.DependencyLoader=DependencyLoader}.call(this),function(){function initialize(){Pusher.ready()}function onDocumentBody(callback){document.body?callback():setTimeout(function(){onDocumentBody(callback)},0)}function initializeOnDocumentBody(){onDocumentBody(initialize)}Pusher.DependenciesReceivers=new Pusher.ScriptReceiverFactory("_pusher_dependencies","Pusher.DependenciesReceivers"),Pusher.Dependencies=new Pusher.DependencyLoader({cdn_http:Pusher.cdn_http,cdn_https:Pusher.cdn_https,version:Pusher.VERSION,suffix:Pusher.dependency_suffix,receivers:Pusher.DependenciesReceivers}),window.JSON?initializeOnDocumentBody():Pusher.Dependencies.load("json2",{},initializeOnDocumentBody)}(),function(){for(var Base64={encode:function(s){return btoa(utob(s))}},fromCharCode=String.fromCharCode,b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab={},i=0,l=b64chars.length;i<l;i++)b64tab[b64chars.charAt(i)]=i;var cb_utob=function(c){var cc=c.charCodeAt(0);return cc<128?c:cc<2048?fromCharCode(192|cc>>>6)+fromCharCode(128|63&cc):fromCharCode(224|cc>>>12&15)+fromCharCode(128|cc>>>6&63)+fromCharCode(128|63&cc)},utob=function(u){return u.replace(/[^\x00-\x7F]/g,cb_utob)},cb_encode=function(ccc){var padlen=[0,2,1][ccc.length%3],ord=ccc.charCodeAt(0)<<16|(ccc.length>1?ccc.charCodeAt(1):0)<<8|(ccc.length>2?ccc.charCodeAt(2):0),chars=[b64chars.charAt(ord>>>18),b64chars.charAt(ord>>>12&63),padlen>=2?"=":b64chars.charAt(ord>>>6&63),padlen>=1?"=":b64chars.charAt(63&ord)];return chars.join("")},btoa=window.btoa||function(b){return b.replace(/[\s\S]{1,3}/g,cb_encode)};Pusher.Base64=Base64}.call(this),function(){function JSONPRequest(url,data){this.url=url,this.data=data}function encodeParamsObject(data){return Pusher.Util.mapObject(data,function(value){return"object"==typeof value&&(value=JSON.stringify(value)),encodeURIComponent(Pusher.Base64.encode(value.toString()))})}var prototype=JSONPRequest.prototype;prototype.send=function(receiver){if(!this.request){var params=Pusher.Util.filterObject(this.data,function(value){return void 0!==value}),query=Pusher.Util.map(Pusher.Util.flatten(encodeParamsObject(params)),Pusher.Util.method("join","=")).join("&"),url=this.url+"/"+receiver.number+"?"+query;this.request=new Pusher.ScriptRequest(url),this.request.send(receiver)}},prototype.cleanup=function(){this.request&&this.request.cleanup()},Pusher.JSONPRequest=JSONPRequest}.call(this),function(){function Timeline(key,session,options){this.key=key,this.session=session,this.events=[],this.options=options||{},this.sent=0,this.uniqueID=0}var prototype=Timeline.prototype;Timeline.ERROR=3,Timeline.INFO=6,Timeline.DEBUG=7,prototype.log=function(level,event){level<=this.options.level&&(this.events.push(Pusher.Util.extend({},event,{timestamp:Pusher.Util.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},prototype.error=function(event){this.log(Timeline.ERROR,event)},prototype.info=function(event){this.log(Timeline.INFO,event)},prototype.debug=function(event){this.log(Timeline.DEBUG,event)},prototype.isEmpty=function(){return 0===this.events.length},prototype.send=function(sendJSONP,callback){var self=this,data=Pusher.Util.extend({session:self.session,bundle:self.sent+1,key:self.key,lib:"js",version:self.options.version,cluster:self.options.cluster,features:self.options.features,timeline:self.events},self.options.params);return self.events=[],sendJSONP(data,function(error,result){error||self.sent++,callback&&callback(error,result)}),!0},prototype.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},Pusher.Timeline=Timeline}.call(this),function(){function TimelineSender(timeline,options){this.timeline=timeline,this.options=options||{}}var prototype=TimelineSender.prototype;prototype.send=function(encrypted,callback){var self=this;if(!self.timeline.isEmpty()){var sendJSONP=function(data,callback){var scheme="http"+(encrypted?"s":"")+"://",url=scheme+(self.host||self.options.host)+self.options.path,request=new Pusher.JSONPRequest(url,data),receiver=Pusher.ScriptReceivers.create(function(error,result){Pusher.ScriptReceivers.remove(receiver),request.cleanup(),result&&result.host&&(self.host=result.host),callback&&callback(error,result)});request.send(receiver)};self.timeline.send(sendJSONP,callback)}},Pusher.TimelineSender=TimelineSender}.call(this),function(){function BestConnectedEverStrategy(strategies){this.strategies=strategies}function connect(strategies,minPriority,callbackBuilder){var runners=Pusher.Util.map(strategies,function(strategy,i,_,rs){return strategy.connect(minPriority,callbackBuilder(i,rs))});return{abort:function(){Pusher.Util.apply(runners,abortRunner)},forceMinPriority:function(p){Pusher.Util.apply(runners,function(runner){runner.forceMinPriority(p)})}}}function allRunnersFailed(runners){return Pusher.Util.all(runners,function(runner){return Boolean(runner.error)})}function abortRunner(runner){runner.error||runner.aborted||(runner.abort(),runner.aborted=!0)}var prototype=BestConnectedEverStrategy.prototype;prototype.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},prototype.connect=function(minPriority,callback){return connect(this.strategies,minPriority,function(i,runners){return function(error,handshake){return runners[i].error=error,error?void(allRunnersFailed(runners)&&callback(!0)):(Pusher.Util.apply(runners,function(runner){runner.forceMinPriority(handshake.transport.priority)}),void callback(null,handshake))}})},Pusher.BestConnectedEverStrategy=BestConnectedEverStrategy}.call(this),function(){function CachedStrategy(strategy,transports,options){this.strategy=strategy,this.transports=transports,this.ttl=options.ttl||18e5,this.encrypted=options.encrypted,this.timeline=options.timeline}function getTransportCacheKey(encrypted){return"pusherTransport"+(encrypted?"Encrypted":"Unencrypted")}function fetchTransportCache(encrypted){var storage=Pusher.Util.getLocalStorage();if(storage)try{var serializedCache=storage[getTransportCacheKey(encrypted)];if(serializedCache)return JSON.parse(serializedCache)}catch(e){flushTransportCache(encrypted)}return null}function storeTransportCache(encrypted,transport,latency){var storage=Pusher.Util.getLocalStorage();if(storage)try{storage[getTransportCacheKey(encrypted)]=JSON.stringify({timestamp:Pusher.Util.now(),transport:transport,latency:latency})}catch(e){}}function flushTransportCache(encrypted){var storage=Pusher.Util.getLocalStorage();if(storage)try{delete storage[getTransportCacheKey(encrypted)]}catch(e){}}var prototype=CachedStrategy.prototype;prototype.isSupported=function(){return this.strategy.isSupported()},prototype.connect=function(minPriority,callback){var encrypted=this.encrypted,info=fetchTransportCache(encrypted),strategies=[this.strategy];if(info&&info.timestamp+this.ttl>=Pusher.Util.now()){var transport=this.transports[info.transport];transport&&(this.timeline.info({cached:!0,transport:info.transport,latency:info.latency}),strategies.push(new Pusher.SequentialStrategy([transport],{timeout:2*info.latency+1e3,failFast:!0})))}var startTimestamp=Pusher.Util.now(),runner=strategies.pop().connect(minPriority,function cb(error,handshake){error?(flushTransportCache(encrypted),strategies.length>0?(startTimestamp=Pusher.Util.now(),runner=strategies.pop().connect(minPriority,cb)):callback(error)):(storeTransportCache(encrypted,handshake.transport.name,Pusher.Util.now()-startTimestamp),callback(null,handshake))});return{abort:function(){runner.abort()},forceMinPriority:function(p){minPriority=p,runner&&runner.forceMinPriority(p)}}},Pusher.CachedStrategy=CachedStrategy}.call(this),function(){function DelayedStrategy(strategy,options){this.strategy=strategy,this.options={delay:options.delay}}var prototype=DelayedStrategy.prototype;prototype.isSupported=function(){return this.strategy.isSupported()},prototype.connect=function(minPriority,callback){var runner,strategy=this.strategy,timer=new Pusher.Timer(this.options.delay,function(){runner=strategy.connect(minPriority,callback)});return{abort:function(){timer.ensureAborted(),runner&&runner.abort()},forceMinPriority:function(p){minPriority=p,runner&&runner.forceMinPriority(p)}}},Pusher.DelayedStrategy=DelayedStrategy}.call(this),function(){function FirstConnectedStrategy(strategy){this.strategy=strategy}var prototype=FirstConnectedStrategy.prototype;prototype.isSupported=function(){return this.strategy.isSupported()},prototype.connect=function(minPriority,callback){var runner=this.strategy.connect(minPriority,function(error,handshake){handshake&&runner.abort(),callback(error,handshake)});return runner},Pusher.FirstConnectedStrategy=FirstConnectedStrategy}.call(this),function(){function IfStrategy(test,trueBranch,falseBranch){this.test=test,this.trueBranch=trueBranch,this.falseBranch=falseBranch}var prototype=IfStrategy.prototype;prototype.isSupported=function(){var branch=this.test()?this.trueBranch:this.falseBranch;return branch.isSupported()},prototype.connect=function(minPriority,callback){var branch=this.test()?this.trueBranch:this.falseBranch;return branch.connect(minPriority,callback)},Pusher.IfStrategy=IfStrategy}.call(this),function(){function SequentialStrategy(strategies,options){this.strategies=strategies,this.loop=Boolean(options.loop),this.failFast=Boolean(options.failFast),this.timeout=options.timeout,this.timeoutLimit=options.timeoutLimit}var prototype=SequentialStrategy.prototype;prototype.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},prototype.connect=function(minPriority,callback){var self=this,strategies=this.strategies,current=0,timeout=this.timeout,runner=null,tryNextStrategy=function(error,handshake){handshake?callback(null,handshake):(current+=1,self.loop&&(current%=strategies.length),current<strategies.length?(timeout&&(timeout=2*timeout,self.timeoutLimit&&(timeout=Math.min(timeout,self.timeoutLimit))),runner=self.tryStrategy(strategies[current],minPriority,{timeout:timeout,failFast:self.failFast},tryNextStrategy)):callback(!0))};return runner=this.tryStrategy(strategies[current],minPriority,{timeout:timeout,failFast:this.failFast},tryNextStrategy),{abort:function(){runner.abort()},forceMinPriority:function(p){minPriority=p,runner&&runner.forceMinPriority(p)}}},prototype.tryStrategy=function(strategy,minPriority,options,callback){var timer=null,runner=null;return options.timeout>0&&(timer=new Pusher.Timer(options.timeout,function(){runner.abort(),callback(!0)})),runner=strategy.connect(minPriority,function(error,handshake){error&&timer&&timer.isRunning()&&!options.failFast||(timer&&timer.ensureAborted(),callback(error,handshake))}),{abort:function(){timer&&timer.ensureAborted(),runner.abort()},forceMinPriority:function(p){runner.forceMinPriority(p)}}},Pusher.SequentialStrategy=SequentialStrategy}.call(this),function(){function TransportStrategy(name,priority,transport,options){this.name=name,this.priority=priority,this.transport=transport,this.options=options||{}}function failAttempt(error,callback){return Pusher.Util.defer(function(){callback(error)}),{abort:function(){},forceMinPriority:function(){}}}var prototype=TransportStrategy.prototype;prototype.isSupported=function(){return this.transport.isSupported({encrypted:this.options.encrypted})},prototype.connect=function(minPriority,callback){if(!this.isSupported())return failAttempt(new Pusher.Errors.UnsupportedStrategy,callback);if(this.priority<minPriority)return failAttempt(new Pusher.Errors.TransportPriorityTooLow,callback);var self=this,connected=!1,transport=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),handshake=null,onInitialized=function(){transport.unbind("initialized",onInitialized),transport.connect()},onOpen=function(){handshake=new Pusher.Handshake(transport,function(result){connected=!0,unbindListeners(),callback(null,result)})},onError=function(error){unbindListeners(),callback(error)},onClosed=function(){unbindListeners(),callback(new Pusher.Errors.TransportClosed(transport))},unbindListeners=function(){transport.unbind("initialized",onInitialized),transport.unbind("open",onOpen),transport.unbind("error",onError),transport.unbind("closed",onClosed)};return transport.bind("initialized",onInitialized),transport.bind("open",onOpen),transport.bind("error",onError),transport.bind("closed",onClosed),transport.initialize(),{abort:function(){connected||(unbindListeners(),handshake?handshake.close():transport.close())},forceMinPriority:function(p){connected||self.priority<p&&(handshake?handshake.close():transport.close())}}},Pusher.TransportStrategy=TransportStrategy}.call(this),function(){function getGenericURL(baseScheme,params,path){var scheme=baseScheme+(params.encrypted?"s":""),host=params.encrypted?params.hostEncrypted:params.hostUnencrypted;return scheme+"://"+host+path}function getGenericPath(key,queryString){var path="/app/"+key,query="?protocol="+Pusher.PROTOCOL+"&client=js&version="+Pusher.VERSION+(queryString?"&"+queryString:"");return path+query}Pusher.URLSchemes={ws:{getInitial:function(key,params){return getGenericURL("ws",params,getGenericPath(key,"flash=false"))}},flash:{getInitial:function(key,params){return getGenericURL("ws",params,getGenericPath(key,"flash=true"))}},sockjs:{getInitial:function(key,params){return getGenericURL("http",params,params.httpPath||"/pusher","")},getPath:function(key,params){return getGenericPath(key)}},http:{getInitial:function(key,params){var path=(params.httpPath||"/pusher")+getGenericPath(key);return getGenericURL("http",params,path)}}}}.call(this),function(){function TransportConnection(hooks,name,priority,key,options){Pusher.EventsDispatcher.call(this),this.hooks=hooks,this.name=name,this.priority=priority,this.key=key,this.options=options,this.state="new",this.timeline=options.timeline,this.activityTimeout=options.activityTimeout,this.id=this.timeline.generateUniqueID()}var prototype=TransportConnection.prototype;Pusher.Util.extend(prototype,Pusher.EventsDispatcher.prototype),prototype.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},prototype.supportsPing=function(){return Boolean(this.hooks.supportsPing)},prototype.initialize=function(){var self=this;self.timeline.info(self.buildTimelineMessage({transport:self.name+(self.options.encrypted?"s":"")})),self.hooks.beforeInitialize&&self.hooks.beforeInitialize.call(self),self.hooks.isInitialized()?self.changeState("initialized"):self.hooks.file?(self.changeState("initializing"),Pusher.Dependencies.load(self.hooks.file,{encrypted:self.options.encrypted},function(error,callback){self.hooks.isInitialized()?(self.changeState("initialized"),callback(!0)):(error&&self.onError(error),self.onClose(),callback(!1))})):self.onClose()},prototype.connect=function(){var self=this;if(self.socket||"initialized"!==self.state)return!1;var url=self.hooks.urls.getInitial(self.key,self.options);try{self.socket=self.hooks.getSocket(url,self.options)}catch(e){return Pusher.Util.defer(function(){self.onError(e),self.changeState("closed")}),!1}return self.bindListeners(),Pusher.debug("Connecting",{transport:self.name,url:url}),self.changeState("connecting"),!0},prototype.close=function(){return!!this.socket&&(this.socket.close(),!0)},prototype.send=function(data){var self=this;return"open"===self.state&&(Pusher.Util.defer(function(){self.socket&&self.socket.send(data)}),!0)},prototype.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()},prototype.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},prototype.onError=function(error){this.emit("error",{type:"WebSocketError",error:error}),this.timeline.error(this.buildTimelineMessage({error:error.toString()}))},prototype.onClose=function(closeEvent){closeEvent?this.changeState("closed",{code:closeEvent.code,reason:closeEvent.reason,wasClean:closeEvent.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},prototype.onMessage=function(message){this.emit("message",message)},prototype.onActivity=function(){this.emit("activity")},prototype.bindListeners=function(){var self=this;self.socket.onopen=function(){self.onOpen()},self.socket.onerror=function(error){self.onError(error)},self.socket.onclose=function(closeEvent){self.onClose(closeEvent)},self.socket.onmessage=function(message){self.onMessage(message)},self.supportsPing()&&(self.socket.onactivity=function(){self.onActivity()})},prototype.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},prototype.changeState=function(state,params){this.state=state,this.timeline.info(this.buildTimelineMessage({state:state,params:params})),this.emit(state,params)},prototype.buildTimelineMessage=function(message){return Pusher.Util.extend({cid:this.id},message)},Pusher.TransportConnection=TransportConnection}.call(this),function(){function Transport(hooks){this.hooks=hooks}var prototype=Transport.prototype;prototype.isSupported=function(environment){return this.hooks.isSupported(environment)},prototype.createConnection=function(name,priority,key,options){return new Pusher.TransportConnection(this.hooks,name,priority,key,options)},Pusher.Transport=Transport}.call(this),function(){Pusher.WSTransport=new Pusher.Transport({urls:Pusher.URLSchemes.ws,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(window.WebSocket||window.MozWebSocket)},isSupported:function(){return Boolean(window.WebSocket||window.MozWebSocket)},getSocket:function(url){var Constructor=window.WebSocket||window.MozWebSocket;return new Constructor(url)}}),Pusher.FlashTransport=new Pusher.Transport({file:"flashfallback",urls:Pusher.URLSchemes.flash,handlesActivityChecks:!1,supportsPing:!1,isSupported:function(){try{return Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(e1){try{var nav=Pusher.Util.getNavigator();return Boolean(nav&&nav.mimeTypes&&void 0!==nav.mimeTypes["application/x-shockwave-flash"])}catch(e2){return!1}}},beforeInitialize:function(){void 0===window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&(window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0),window.WEB_SOCKET_SWF_LOCATION=Pusher.Dependencies.getRoot({encrypted:this.options.encrypted})+"/WebSocketMain.swf"},isInitialized:function(){return void 0!==window.FlashWebSocket},getSocket:function(url){return new FlashWebSocket(url)}}),Pusher.SockJSTransport=new Pusher.Transport({file:"sockjs",urls:Pusher.URLSchemes.sockjs,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(url,options){return new SockJS(url,null,{js_path:Pusher.Dependencies.getPath("sockjs",{encrypted:options.encrypted}),ignore_null_origin:options.ignoreNullOrigin})},beforeOpen:function(socket,path){socket.send(JSON.stringify({path:path}))}});var httpConfiguration={urls:Pusher.URLSchemes.http,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return Boolean(Pusher.HTTP.Socket)}},streamingConfiguration=Pusher.Util.extend({
getSocket:function(url){return Pusher.HTTP.getStreamingSocket(url)}},httpConfiguration),pollingConfiguration=Pusher.Util.extend({getSocket:function(url){return Pusher.HTTP.getPollingSocket(url)}},httpConfiguration),xhrConfiguration={file:"xhr",isSupported:Pusher.Util.isXHRSupported},xdrConfiguration={file:"xdr",isSupported:function(environment){return Pusher.Util.isXDRSupported(environment.encrypted)}};Pusher.XHRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},streamingConfiguration,xhrConfiguration)),Pusher.XDRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},streamingConfiguration,xdrConfiguration)),Pusher.XHRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},pollingConfiguration,xhrConfiguration)),Pusher.XDRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},pollingConfiguration,xdrConfiguration))}.call(this),function(){function AssistantToTheTransportManager(manager,transport,options){this.manager=manager,this.transport=transport,this.minPingDelay=options.minPingDelay,this.maxPingDelay=options.maxPingDelay,this.pingDelay=void 0}var prototype=AssistantToTheTransportManager.prototype;prototype.createConnection=function(name,priority,key,options){var self=this;options=Pusher.Util.extend({},options,{activityTimeout:self.pingDelay});var connection=self.transport.createConnection(name,priority,key,options),openTimestamp=null,onOpen=function(){connection.unbind("open",onOpen),connection.bind("closed",onClosed),openTimestamp=Pusher.Util.now()},onClosed=function(closeEvent){if(connection.unbind("closed",onClosed),1002===closeEvent.code||1003===closeEvent.code)self.manager.reportDeath();else if(!closeEvent.wasClean&&openTimestamp){var lifespan=Pusher.Util.now()-openTimestamp;lifespan<2*self.maxPingDelay&&(self.manager.reportDeath(),self.pingDelay=Math.max(lifespan/2,self.minPingDelay))}};return connection.bind("open",onOpen),connection},prototype.isSupported=function(environment){return this.manager.isAlive()&&this.transport.isSupported(environment)},Pusher.AssistantToTheTransportManager=AssistantToTheTransportManager}.call(this),function(){function TransportManager(options){this.options=options||{},this.livesLeft=this.options.lives||1/0}var prototype=TransportManager.prototype;prototype.getAssistant=function(transport){return new Pusher.AssistantToTheTransportManager(this,transport,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},prototype.isAlive=function(){return this.livesLeft>0},prototype.reportDeath=function(){this.livesLeft-=1},Pusher.TransportManager=TransportManager}.call(this),function(){function returnWithOriginalContext(f){return function(context){return[f.apply(this,arguments),context]}}function isSymbol(expression){return"string"==typeof expression&&":"===expression.charAt(0)}function getSymbolValue(expression,context){return context[expression.slice(1)]}function evaluateListOfExpressions(expressions,context){if(0===expressions.length)return[[],context];var head=evaluate(expressions[0],context),tail=evaluateListOfExpressions(expressions.slice(1),head[1]);return[[head[0]].concat(tail[0]),tail[1]]}function evaluateString(expression,context){if(!isSymbol(expression))return[expression,context];var value=getSymbolValue(expression,context);if(void 0===value)throw"Undefined symbol "+expression;return[value,context]}function evaluateArray(expression,context){if(isSymbol(expression[0])){var f=getSymbolValue(expression[0],context);if(expression.length>1){if("function"!=typeof f)throw"Calling non-function "+expression[0];var args=[Pusher.Util.extend({},context)].concat(Pusher.Util.map(expression.slice(1),function(arg){return evaluate(arg,Pusher.Util.extend({},context))[0]}));return f.apply(this,args)}return[f,context]}return evaluateListOfExpressions(expression,context)}function evaluate(expression,context){return"string"==typeof expression?evaluateString(expression,context):"object"==typeof expression&&expression instanceof Array&&expression.length>0?evaluateArray(expression,context):[expression,context]}var StrategyBuilder={build:function(scheme,options){var context=Pusher.Util.extend({},globalContext,options);return evaluate(scheme,context)[1].strategy}},transports={ws:Pusher.WSTransport,flash:Pusher.FlashTransport,sockjs:Pusher.SockJSTransport,xhr_streaming:Pusher.XHRStreamingTransport,xdr_streaming:Pusher.XDRStreamingTransport,xhr_polling:Pusher.XHRPollingTransport,xdr_polling:Pusher.XDRPollingTransport},UnsupportedStrategy={isSupported:function(){return!1},connect:function(_,callback){var deferred=Pusher.Util.defer(function(){callback(new Pusher.Errors.UnsupportedStrategy)});return{abort:function(){deferred.ensureAborted()},forceMinPriority:function(){}}}},globalContext={extend:function(context,first,second){return[Pusher.Util.extend({},first,second),context]},def:function(context,name,value){if(void 0!==context[name])throw"Redefining symbol "+name;return context[name]=value,[void 0,context]},def_transport:function(context,name,type,priority,options,manager){var transportClass=transports[type];if(!transportClass)throw new Pusher.Errors.UnsupportedTransport(type);var transport,enabled=!(context.enabledTransports&&Pusher.Util.arrayIndexOf(context.enabledTransports,name)===-1||context.disabledTransports&&Pusher.Util.arrayIndexOf(context.disabledTransports,name)!==-1||"flash"===name&&context.disableFlash===!0);transport=enabled?new Pusher.TransportStrategy(name,priority,manager?manager.getAssistant(transportClass):transportClass,Pusher.Util.extend({key:context.key,encrypted:context.encrypted,timeline:context.timeline,ignoreNullOrigin:context.ignoreNullOrigin},options)):UnsupportedStrategy;var newContext=context.def(context,name,transport)[1];return newContext.transports=context.transports||{},newContext.transports[name]=transport,[void 0,newContext]},transport_manager:returnWithOriginalContext(function(_,options){return new Pusher.TransportManager(options)}),sequential:returnWithOriginalContext(function(_,options){var strategies=Array.prototype.slice.call(arguments,2);return new Pusher.SequentialStrategy(strategies,options)}),cached:returnWithOriginalContext(function(context,ttl,strategy){return new Pusher.CachedStrategy(strategy,context.transports,{ttl:ttl,timeline:context.timeline,encrypted:context.encrypted})}),first_connected:returnWithOriginalContext(function(_,strategy){return new Pusher.FirstConnectedStrategy(strategy)}),best_connected_ever:returnWithOriginalContext(function(){var strategies=Array.prototype.slice.call(arguments,1);return new Pusher.BestConnectedEverStrategy(strategies)}),delayed:returnWithOriginalContext(function(_,delay,strategy){return new Pusher.DelayedStrategy(strategy,{delay:delay})}),"if":returnWithOriginalContext(function(_,test,trueBranch,falseBranch){return new Pusher.IfStrategy(test,trueBranch,falseBranch)}),is_supported:returnWithOriginalContext(function(_,strategy){return function(){return strategy.isSupported()}})};Pusher.StrategyBuilder=StrategyBuilder}.call(this),function(){var Protocol={};Protocol.decodeMessage=function(message){try{var params=JSON.parse(message.data);if("string"==typeof params.data)try{params.data=JSON.parse(params.data)}catch(e){if(!(e instanceof SyntaxError))throw e}return params}catch(e){throw{type:"MessageParseError",error:e,data:message.data}}},Protocol.encodeMessage=function(message){return JSON.stringify(message)},Protocol.processHandshake=function(message){if(message=this.decodeMessage(message),"pusher:connection_established"===message.event){if(!message.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:message.data.socket_id,activityTimeout:1e3*message.data.activity_timeout}}if("pusher:error"===message.event)return{action:this.getCloseAction(message.data),error:this.getCloseError(message.data)};throw"Invalid handshake"},Protocol.getCloseAction=function(closeEvent){return closeEvent.code<4e3?closeEvent.code>=1002&&closeEvent.code<=1004?"backoff":null:4e3===closeEvent.code?"ssl_only":closeEvent.code<4100?"refused":closeEvent.code<4200?"backoff":closeEvent.code<4300?"retry":"refused"},Protocol.getCloseError=function(closeEvent){return 1e3!==closeEvent.code&&1001!==closeEvent.code?{type:"PusherError",data:{code:closeEvent.code,message:closeEvent.reason||closeEvent.message}}:null},Pusher.Protocol=Protocol}.call(this),function(){function Connection(id,transport){Pusher.EventsDispatcher.call(this),this.id=id,this.transport=transport,this.activityTimeout=transport.activityTimeout,this.bindListeners()}var prototype=Connection.prototype;Pusher.Util.extend(prototype,Pusher.EventsDispatcher.prototype),prototype.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},prototype.send=function(data){return this.transport.send(data)},prototype.send_event=function(name,data,channel){var message={event:name,data:data};return channel&&(message.channel=channel),Pusher.debug("Event sent",message),this.send(Pusher.Protocol.encodeMessage(message))},prototype.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},prototype.close=function(){this.transport.close()},prototype.bindListeners=function(){var self=this,listeners={message:function(m){var message;try{message=Pusher.Protocol.decodeMessage(m)}catch(e){self.emit("error",{type:"MessageParseError",error:e,data:m.data})}if(void 0!==message){switch(Pusher.debug("Event recd",message),message.event){case"pusher:error":self.emit("error",{type:"PusherError",data:message.data});break;case"pusher:ping":self.emit("ping");break;case"pusher:pong":self.emit("pong")}self.emit("message",message)}},activity:function(){self.emit("activity")},error:function(error){self.emit("error",{type:"WebSocketError",error:error})},closed:function(closeEvent){unbindListeners(),closeEvent&&closeEvent.code&&self.handleCloseEvent(closeEvent),self.transport=null,self.emit("closed")}},unbindListeners=function(){Pusher.Util.objectApply(listeners,function(listener,event){self.transport.unbind(event,listener)})};Pusher.Util.objectApply(listeners,function(listener,event){self.transport.bind(event,listener)})},prototype.handleCloseEvent=function(closeEvent){var action=Pusher.Protocol.getCloseAction(closeEvent),error=Pusher.Protocol.getCloseError(closeEvent);error&&this.emit("error",error),action&&this.emit(action)},Pusher.Connection=Connection}.call(this),function(){function Handshake(transport,callback){this.transport=transport,this.callback=callback,this.bindListeners()}var prototype=Handshake.prototype;prototype.close=function(){this.unbindListeners(),this.transport.close()},prototype.bindListeners=function(){var self=this;self.onMessage=function(m){self.unbindListeners();try{var result=Pusher.Protocol.processHandshake(m);"connected"===result.action?self.finish("connected",{connection:new Pusher.Connection(result.id,self.transport),activityTimeout:result.activityTimeout}):(self.finish(result.action,{error:result.error}),self.transport.close())}catch(e){self.finish("error",{error:e}),self.transport.close()}},self.onClosed=function(closeEvent){self.unbindListeners();var action=Pusher.Protocol.getCloseAction(closeEvent)||"backoff",error=Pusher.Protocol.getCloseError(closeEvent);self.finish(action,{error:error})},self.transport.bind("message",self.onMessage),self.transport.bind("closed",self.onClosed)},prototype.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},prototype.finish=function(action,params){this.callback(Pusher.Util.extend({transport:this.transport,action:action},params))},Pusher.Handshake=Handshake}.call(this),function(){function ConnectionManager(key,options){Pusher.EventsDispatcher.call(this),this.key=key,this.options=options||{},this.state="initialized",this.connection=null,this.encrypted=!!options.encrypted,this.timeline=this.options.timeline,this.connectionCallbacks=this.buildConnectionCallbacks(),this.errorCallbacks=this.buildErrorCallbacks(),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var self=this;Pusher.Network.bind("online",function(){self.timeline.info({netinfo:"online"}),"connecting"!==self.state&&"unavailable"!==self.state||self.retryIn(0)}),Pusher.Network.bind("offline",function(){self.timeline.info({netinfo:"offline"}),self.connection&&self.sendActivityCheck()}),this.updateStrategy()}var prototype=ConnectionManager.prototype;Pusher.Util.extend(prototype,Pusher.EventsDispatcher.prototype),prototype.connect=function(){if(!this.connection&&!this.runner){if(!this.strategy.isSupported())return void this.updateState("failed");this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}},prototype.send=function(data){return!!this.connection&&this.connection.send(data)},prototype.send_event=function(name,data,channel){return!!this.connection&&this.connection.send_event(name,data,channel)},prototype.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},prototype.isEncrypted=function(){return this.encrypted},prototype.startConnecting=function(){var self=this,callback=function(error,handshake){error?self.runner=self.strategy.connect(0,callback):"error"===handshake.action?(self.emit("error",{type:"HandshakeError",error:handshake.error}),self.timeline.error({handshakeError:handshake.error})):(self.abortConnecting(),self.handshakeCallbacks[handshake.action](handshake))};self.runner=self.strategy.connect(0,callback)},prototype.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},prototype.disconnectInternally=function(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var connection=this.abandonConnection();connection.close()}},prototype.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,encrypted:this.encrypted})},prototype.retryIn=function(delay){var self=this;self.timeline.info({action:"retry",delay:delay}),delay>0&&self.emit("connecting_in",Math.round(delay/1e3)),self.retryTimer=new Pusher.Timer(delay||0,function(){self.disconnectInternally(),self.connect()})},prototype.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},prototype.setUnavailableTimer=function(){var self=this;self.unavailableTimer=new Pusher.Timer(self.options.unavailableTimeout,function(){self.updateState("unavailable")})},prototype.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},prototype.sendActivityCheck=function(){var self=this;self.stopActivityCheck(),self.connection.ping(),self.activityTimer=new Pusher.Timer(self.options.pongTimeout,function(){self.timeline.error({pong_timed_out:self.options.pongTimeout}),self.retryIn(0)})},prototype.resetActivityCheck=function(){var self=this;self.stopActivityCheck(),self.connection.handlesActivityChecks()||(self.activityTimer=new Pusher.Timer(self.activityTimeout,function(){self.sendActivityCheck()}))},prototype.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},prototype.buildConnectionCallbacks=function(){var self=this;return{message:function(message){self.resetActivityCheck(),self.emit("message",message)},ping:function(){self.send_event("pusher:pong",{})},activity:function(){self.resetActivityCheck()},error:function(error){self.emit("error",{type:"WebSocketError",error:error})},closed:function(){self.abandonConnection(),self.shouldRetry()&&self.retryIn(1e3)}}},prototype.buildHandshakeCallbacks=function(errorCallbacks){var self=this;return Pusher.Util.extend({},errorCallbacks,{connected:function(handshake){self.activityTimeout=Math.min(self.options.activityTimeout,handshake.activityTimeout,handshake.connection.activityTimeout||1/0),self.clearUnavailableTimer(),self.setConnection(handshake.connection),self.socket_id=self.connection.id,self.updateState("connected",{socket_id:self.socket_id})}})},prototype.buildErrorCallbacks=function(){function withErrorEmitted(callback){return function(result){result.error&&self.emit("error",{type:"WebSocketError",error:result.error}),callback(result)}}var self=this;return{ssl_only:withErrorEmitted(function(){self.encrypted=!0,self.updateStrategy(),self.retryIn(0)}),refused:withErrorEmitted(function(){self.disconnect()}),backoff:withErrorEmitted(function(){self.retryIn(1e3)}),retry:withErrorEmitted(function(){self.retryIn(0)})}},prototype.setConnection=function(connection){this.connection=connection;for(var event in this.connectionCallbacks)this.connection.bind(event,this.connectionCallbacks[event]);this.resetActivityCheck()},prototype.abandonConnection=function(){if(this.connection){this.stopActivityCheck();for(var event in this.connectionCallbacks)this.connection.unbind(event,this.connectionCallbacks[event]);var connection=this.connection;return this.connection=null,connection}},prototype.updateState=function(newState,data){var previousState=this.state;this.state=newState,previousState!==newState&&(Pusher.debug("State changed",previousState+" -> "+newState),this.timeline.info({state:newState,params:data}),this.emit("state_change",{previous:previousState,current:newState}),this.emit(newState,data))},prototype.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},Pusher.ConnectionManager=ConnectionManager}.call(this),function(){function NetInfo(){Pusher.EventsDispatcher.call(this);var self=this;void 0!==window.addEventListener&&(window.addEventListener("online",function(){self.emit("online")},!1),window.addEventListener("offline",function(){self.emit("offline")},!1))}Pusher.Util.extend(NetInfo.prototype,Pusher.EventsDispatcher.prototype);var prototype=NetInfo.prototype;prototype.isOnline=function(){return void 0===window.navigator.onLine||window.navigator.onLine},Pusher.NetInfo=NetInfo,Pusher.Network=new NetInfo}.call(this),function(){function Members(){this.reset()}var prototype=Members.prototype;prototype.get=function(id){return Object.prototype.hasOwnProperty.call(this.members,id)?{id:id,info:this.members[id]}:null},prototype.each=function(callback){var self=this;Pusher.Util.objectApply(self.members,function(member,id){callback(self.get(id))})},prototype.setMyID=function(id){this.myID=id},prototype.onSubscription=function(subscriptionData){this.members=subscriptionData.presence.hash,this.count=subscriptionData.presence.count,this.me=this.get(this.myID)},prototype.addMember=function(memberData){return null===this.get(memberData.user_id)&&this.count++,this.members[memberData.user_id]=memberData.user_info,this.get(memberData.user_id)},prototype.removeMember=function(memberData){var member=this.get(memberData.user_id);return member&&(delete this.members[memberData.user_id],this.count--),member},prototype.reset=function(){this.members={},this.count=0,this.myID=null,this.me=null},Pusher.Members=Members}.call(this),function(){function Channel(name,pusher){Pusher.EventsDispatcher.call(this,function(event,data){Pusher.debug("No callbacks on "+name+" for "+event)}),this.name=name,this.pusher=pusher,this.subscribed=!1}var prototype=Channel.prototype;Pusher.Util.extend(prototype,Pusher.EventsDispatcher.prototype),prototype.authorize=function(socketId,callback){return callback(!1,{})},prototype.trigger=function(event,data){if(0!==event.indexOf("client-"))throw new Pusher.Errors.BadEventName("Event '"+event+"' does not start with 'client-'");return this.pusher.send_event(event,data,this.name)},prototype.disconnect=function(){this.subscribed=!1},prototype.handleEvent=function(event,data){0===event.indexOf("pusher_internal:")?"pusher_internal:subscription_succeeded"===event&&(this.subscribed=!0,this.emit("pusher:subscription_succeeded",data)):this.emit(event,data)},prototype.subscribe=function(){var self=this;self.authorize(self.pusher.connection.socket_id,function(error,data){error?self.handleEvent("pusher:subscription_error",data):self.pusher.send_event("pusher:subscribe",{auth:data.auth,channel_data:data.channel_data,channel:self.name})})},prototype.unsubscribe=function(){this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},Pusher.Channel=Channel}.call(this),function(){function PrivateChannel(name,pusher){Pusher.Channel.call(this,name,pusher)}var prototype=PrivateChannel.prototype;Pusher.Util.extend(prototype,Pusher.Channel.prototype),prototype.authorize=function(socketId,callback){var authorizer=new Pusher.Channel.Authorizer(this,this.pusher.config);return authorizer.authorize(socketId,callback)},Pusher.PrivateChannel=PrivateChannel}.call(this),function(){function PresenceChannel(name,pusher){Pusher.PrivateChannel.call(this,name,pusher),this.members=new Pusher.Members}var prototype=PresenceChannel.prototype;Pusher.Util.extend(prototype,Pusher.PrivateChannel.prototype),prototype.authorize=function(socketId,callback){var _super=Pusher.PrivateChannel.prototype.authorize,self=this;_super.call(self,socketId,function(error,authData){if(!error){if(void 0===authData.channel_data)return Pusher.warn("Invalid auth response for channel '"+self.name+"', expected 'channel_data' field"),void callback("Invalid auth response");var channelData=JSON.parse(authData.channel_data);self.members.setMyID(channelData.user_id)}callback(error,authData)})},prototype.handleEvent=function(event,data){switch(event){case"pusher_internal:subscription_succeeded":this.members.onSubscription(data),this.subscribed=!0,this.emit("pusher:subscription_succeeded",this.members);break;case"pusher_internal:member_added":var addedMember=this.members.addMember(data);this.emit("pusher:member_added",addedMember);break;case"pusher_internal:member_removed":var removedMember=this.members.removeMember(data);removedMember&&this.emit("pusher:member_removed",removedMember);break;default:Pusher.PrivateChannel.prototype.handleEvent.call(this,event,data)}},prototype.disconnect=function(){this.members.reset(),Pusher.PrivateChannel.prototype.disconnect.call(this)},Pusher.PresenceChannel=PresenceChannel}.call(this),function(){function Channels(){this.channels={}}function createChannel(name,pusher){return 0===name.indexOf("private-")?new Pusher.PrivateChannel(name,pusher):0===name.indexOf("presence-")?new Pusher.PresenceChannel(name,pusher):new Pusher.Channel(name,pusher)}var prototype=Channels.prototype;prototype.add=function(name,pusher){return this.channels[name]||(this.channels[name]=createChannel(name,pusher)),this.channels[name]},prototype.all=function(name){return Pusher.Util.values(this.channels)},prototype.find=function(name){return this.channels[name]},prototype.remove=function(name){var channel=this.channels[name];return delete this.channels[name],channel},prototype.disconnect=function(){Pusher.Util.objectApply(this.channels,function(channel){channel.disconnect()})},Pusher.Channels=Channels}.call(this),function(){Pusher.Channel.Authorizer=function(channel,options){this.channel=channel,this.type=options.authTransport,this.options=options,this.authOptions=(options||{}).auth||{}},Pusher.Channel.Authorizer.prototype={composeQuery:function(socketId){var query="socket_id="+encodeURIComponent(socketId)+"&channel_name="+encodeURIComponent(this.channel.name);for(var i in this.authOptions.params)query+="&"+encodeURIComponent(i)+"="+encodeURIComponent(this.authOptions.params[i]);return query},authorize:function(socketId,callback){return Pusher.authorizers[this.type].call(this,socketId,callback)}};var nextAuthCallbackID=1;Pusher.auth_callbacks={},Pusher.authorizers={ajax:function(socketId,callback){var xhr,self=this;xhr=Pusher.XHR?new Pusher.XHR:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),xhr.open("POST",self.options.authEndpoint,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var headerName in this.authOptions.headers)xhr.setRequestHeader(headerName,this.authOptions.headers[headerName]);return xhr.onreadystatechange=function(){if(4===xhr.readyState)if(200===xhr.status){var data,parsed=!1;try{data=JSON.parse(xhr.responseText),parsed=!0}catch(e){callback(!0,"JSON returned from webapp was invalid, yet status code was 200. Data was: "+xhr.responseText)}parsed&&callback(!1,data)}else Pusher.warn("Couldn't get auth info from your webapp",xhr.status),callback(!0,xhr.status)},xhr.send(this.composeQuery(socketId)),xhr},jsonp:function(socketId,callback){void 0!==this.authOptions.headers&&Pusher.warn("Warn","To send headers with the auth request, you must use AJAX, rather than JSONP.");var callbackName=nextAuthCallbackID.toString();nextAuthCallbackID++;var document=Pusher.Util.getDocument(),script=document.createElement("script");Pusher.auth_callbacks[callbackName]=function(data){callback(!1,data)};var callback_name="Pusher.auth_callbacks['"+callbackName+"']";script.src=this.options.authEndpoint+"?callback="+encodeURIComponent(callback_name)+"&"+this.composeQuery(socketId);var head=document.getElementsByTagName("head")[0]||document.documentElement;head.insertBefore(script,head.firstChild)}}}.call(this),!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(orig){return function(header,value){if("__setXHR_"===header){var val=value(this);val instanceof Function&&val(this)}else orig.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module("ngFileUpload",[]);ngFileUpload.version="12.0.4",ngFileUpload.service("UploadBase",["$http","$q","$timeout",function($http,$q,$timeout){function sendHttp(config){function notifyProgress(e){deferred.notify&&deferred.notify(e),promise.progressFunc&&$timeout(function(){promise.progressFunc(e)})}function getNotifyEvent(n){return null!=config._start&&resumeSupported?{loaded:n.loaded+config._start,total:config._file&&config._file.size||n.total,type:n.type,config:config,lengthComputable:!0,target:n.target}:n}function uploadWithAngular(){$http(config).then(function(r){resumeSupported&&config._chunkSize&&!config._finished&&config._file?(notifyProgress({loaded:config._end,total:config._file&&config._file.size,config:config,type:"progress"}),upload.upload(config,!0)):(config._finished&&delete config._finished,deferred.resolve(r))},function(e){deferred.reject(e)},function(n){deferred.notify(n)})}config.method=config.method||"POST",config.headers=config.headers||{};var deferred=config._deferred=config._deferred||$q.defer(),promise=deferred.promise;return config.disableProgress||(config.headers.__setXHR_=function(){return function(xhr){xhr&&xhr.upload&&xhr.upload.addEventListener&&(config.__XHR=xhr,config.xhrFn&&config.xhrFn(xhr),xhr.upload.addEventListener("progress",function(e){e.config=config,notifyProgress(getNotifyEvent(e))},!1),xhr.upload.addEventListener("load",function(e){e.lengthComputable&&(e.config=config,notifyProgress(getNotifyEvent(e)))},!1))}}),resumeSupported?config._chunkSize&&config._end&&!config._finished?(config._start=config._end,config._end+=config._chunkSize,uploadWithAngular()):config.resumeSizeUrl?$http.get(config.resumeSizeUrl).then(function(resp){config.resumeSizeResponseReader?config._start=config.resumeSizeResponseReader(resp.data):config._start=parseInt((null==resp.data.size?resp.data:resp.data.size).toString()),config._chunkSize&&(config._end=config._start+config._chunkSize),uploadWithAngular()},function(e){throw e}):config.resumeSize?config.resumeSize().then(function(size){config._start=size,uploadWithAngular()},function(e){throw e}):(config._chunkSize&&(config._start=0,config._end=config._start+config._chunkSize),uploadWithAngular()):uploadWithAngular(),promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.progress=function(fn){return promise.progressFunc=fn,promise.then(null,null,function(n){fn(n)}),promise},promise.abort=promise.pause=function(){return config.__XHR&&$timeout(function(){config.__XHR.abort()}),promise},promise.xhr=function(fn){return config.xhrFn=function(origXhrFn){return function(){origXhrFn&&origXhrFn.apply(promise,arguments),fn.apply(promise,arguments)}}(config.xhrFn),promise},upload.promisesCount++,promise["finally"](function(){upload.promisesCount--}),promise}function copy(obj){var clone={};for(var key in obj)obj.hasOwnProperty(key)&&(clone[key]=obj[key]);return clone}var upload=this;upload.promisesCount=0,this.isResumeSupported=function(){return window.Blob&&window.Blob.prototype.slice};var resumeSupported=this.isResumeSupported();this.isUploadInProgress=function(){return upload.promisesCount>0},this.rename=function(file,name){return file.ngfName=name,file},this.jsonBlob=function(val){null==val||angular.isString(val)||(val=JSON.stringify(val));var blob=new window.Blob([val],{type:"application/json"});return blob._ngfBlob=!0,blob},this.json=function(val){return angular.toJson(val)},this.isFile=function(file){return null!=file&&(file instanceof window.Blob||file.flashId&&file.name&&file.size)},this.upload=function(config,internal){function toResumeFile(file,formData){if(file._ngfBlob)return file;if(config._file=config._file||file,null!=config._start&&resumeSupported){config._end&&config._end>=file.size&&(config._finished=!0,config._end=file.size);var slice=file.slice(config._start,config._end||file.size);return slice.name=file.name,slice.ngfName=file.ngfName,config._chunkSize&&(formData.append("_chunkSize",config._chunkSize),formData.append("_currentChunkSize",config._end-config._start),formData.append("_chunkNumber",Math.floor(config._start/config._chunkSize)),formData.append("_totalSize",config._file.size)),slice}return file}function addFieldToFormData(formData,val,key){if(void 0!==val)if(angular.isDate(val)&&(val=val.toISOString()),angular.isString(val))formData.append(key,val);else if(upload.isFile(val)){var file=toResumeFile(val,formData),split=key.split(",");split[1]&&(file.ngfName=split[1].replace(/^\s+|\s+$/g,""),key=split[0]),config._fileKey=config._fileKey||key,formData.append(key,file,file.ngfName||file.name)}else if(angular.isObject(val)){if(val.$$ngfCircularDetection)throw"ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: "+key;val.$$ngfCircularDetection=!0;try{for(var k in val)if(val.hasOwnProperty(k)&&"$$ngfCircularDetection"!==k){var objectKey=null==config.objectKey?"[i]":config.objectKey;val.length&&parseInt(k)>-1&&(objectKey=null==config.arrayKey?objectKey:config.arrayKey),addFieldToFormData(formData,val[k],key+objectKey.replace(/[ik]/g,k))}}finally{delete val.$$ngfCircularDetection}}else formData.append(key,val)}function digestConfig(){config._chunkSize=upload.translateScalars(config.resumeChunkSize),config._chunkSize=config._chunkSize?parseInt(config._chunkSize.toString()):null,config.headers=config.headers||{},config.headers["Content-Type"]=void 0,config.transformRequest=config.transformRequest?angular.isArray(config.transformRequest)?config.transformRequest:[config.transformRequest]:[],config.transformRequest.push(function(data){var key,formData=new window.FormData;data=data||config.fields||{},config.file&&(data.file=config.file);for(key in data)if(data.hasOwnProperty(key)){var val=data[key];config.formDataAppender?config.formDataAppender(formData,key,val):addFieldToFormData(formData,val,key)}return formData})}return internal||(config=copy(config)),config._isDigested||(config._isDigested=!0,digestConfig()),sendHttp(config)},this.http=function(config){return config=copy(config),config.transformRequest=config.transformRequest||function(data){return window.ArrayBuffer&&data instanceof window.ArrayBuffer||data instanceof window.Blob?data:$http.defaults.transformRequest[0].apply(this,arguments)},config._chunkSize=upload.translateScalars(config.resumeChunkSize),config._chunkSize=config._chunkSize?parseInt(config._chunkSize.toString()):null,sendHttp(config);
},this.translateScalars=function(str){if(angular.isString(str)){if(str.search(/kb/i)===str.length-2)return parseFloat(1024*str.substring(0,str.length-2));if(str.search(/mb/i)===str.length-2)return parseFloat(1048576*str.substring(0,str.length-2));if(str.search(/gb/i)===str.length-2)return parseFloat(1073741824*str.substring(0,str.length-2));if(str.search(/b/i)===str.length-1)return parseFloat(str.substring(0,str.length-1));if(str.search(/s/i)===str.length-1)return parseFloat(str.substring(0,str.length-1));if(str.search(/m/i)===str.length-1)return parseFloat(60*str.substring(0,str.length-1));if(str.search(/h/i)===str.length-1)return parseFloat(3600*str.substring(0,str.length-1))}return str},this.urlToBlob=function(url){var defer=$q.defer();return $http({url:url,method:"get",responseType:"arraybuffer"}).then(function(resp){var arrayBufferView=new Uint8Array(resp.data),type=resp.headers("content-type")||"image/WebP",blob=new window.Blob([arrayBufferView],{type:type});defer.resolve(blob)},function(e){defer.reject(e)}),defer.promise},this.setDefaults=function(defaults){this.defaults=defaults||{}},this.defaults={},this.version=ngFileUpload.version}]),ngFileUpload.service("Upload",["$parse","$timeout","$compile","$q","UploadExif",function($parse,$timeout,$compile,$q,UploadExif){function applyExifRotations(files,attr,scope){var promises=[upload.emptyPromise()];return angular.forEach(files,function(f,i){0===f.type.indexOf("image/jpeg")&&upload.attrGetter("ngfFixOrientation",attr,scope,{$file:f})&&promises.push(upload.happyPromise(upload.applyExifRotation(f),f).then(function(fixedFile){files.splice(i,1,fixedFile)}))}),$q.all(promises)}function resize(files,attr,scope){var resizeVal=upload.attrGetter("ngfResize",attr,scope);if(!resizeVal||!upload.isResizeSupported()||!files.length)return upload.emptyPromise();if(!(resizeVal instanceof Function))return resizeWithParams(resizeVal,files,attr,scope);var defer=$q.defer();resizeVal(files).then(function(p){resizeWithParams(p,files,attr,scope).then(function(r){defer.resolve(r)},function(e){defer.reject(e)})},function(e){defer.reject(e)})}function resizeWithParams(param,files,attr,scope){function handleFile(f,i){if(0===f.type.indexOf("image")){if(param.pattern&&!upload.validatePattern(f,param.pattern))return;var promise=upload.resize(f,param.width,param.height,param.quality,param.type,param.ratio,param.centerCrop,function(width,height){return upload.attrGetter("ngfResizeIf",attr,scope,{$width:width,$height:height,$file:f})},param.restoreExif!==!1);promises.push(promise),promise.then(function(resizedFile){files.splice(i,1,resizedFile)},function(e){f.$error="resize",f.$errorParam=(e?(e.message?e.message:e)+": ":"")+(f&&f.name)})}}for(var promises=[upload.emptyPromise()],i=0;i<files.length;i++)handleFile(files[i],i);return $q.all(promises)}var upload=UploadExif;return upload.getAttrWithDefaults=function(attr,name){if(null!=attr[name])return attr[name];var def=upload.defaults[name];return null==def?def:angular.isString(def)?def:JSON.stringify(def)},upload.attrGetter=function(name,attr,scope,params){var attrVal=this.getAttrWithDefaults(attr,name);if(!scope)return attrVal;try{return params?$parse(attrVal)(scope,params):$parse(attrVal)(scope)}catch(e){if(name.search(/min|max|pattern/i))return attrVal;throw e}},upload.shouldUpdateOn=function(type,attr,scope){var modelOptions=upload.attrGetter("ngModelOptions",attr,scope);return!modelOptions||!modelOptions.updateOn||modelOptions.updateOn.split(" ").indexOf(type)>-1},upload.emptyPromise=function(){var d=$q.defer(),args=arguments;return $timeout(function(){d.resolve.apply(d,args)}),d.promise},upload.rejectPromise=function(){var d=$q.defer(),args=arguments;return $timeout(function(){d.reject.apply(d,args)}),d.promise},upload.happyPromise=function(promise,data){var d=$q.defer();return promise.then(function(result){d.resolve(result)},function(error){$timeout(function(){throw error}),d.resolve(data)}),d.promise},upload.updateModel=function(ngModel,attr,scope,fileChange,files,evt,noDelay){function update(files,invalidFiles,newFiles,dupFiles,isSingleModel){attr.$$ngfPrevValidFiles=files,attr.$$ngfPrevInvalidFiles=invalidFiles;var file=files&&files.length?files[0]:null,invalidFile=invalidFiles&&invalidFiles.length?invalidFiles[0]:null;ngModel&&(upload.applyModelValidation(ngModel,files),ngModel.$setViewValue(isSingleModel?file:files)),fileChange&&$parse(fileChange)(scope,{$files:files,$file:file,$newFiles:newFiles,$duplicateFiles:dupFiles,$invalidFiles:invalidFiles,$invalidFile:invalidFile,$event:evt});var invalidModel=upload.attrGetter("ngfModelInvalid",attr);invalidModel&&$timeout(function(){$parse(invalidModel).assign(scope,isSingleModel?invalidFile:invalidFiles)}),$timeout(function(){})}function removeDuplicates(){function equals(f1,f2){return f1.name===f2.name&&(f1.$ngfOrigSize||f1.size)===(f2.$ngfOrigSize||f2.size)&&f1.type===f2.type}function isInPrevFiles(f){var j;for(j=0;j<prevValidFiles.length;j++)if(equals(f,prevValidFiles[j]))return!0;for(j=0;j<prevInvalidFiles.length;j++)if(equals(f,prevInvalidFiles[j]))return!0;return!1}if(files){allNewFiles=[],dupFiles=[];for(var i=0;i<files.length;i++)isInPrevFiles(files[i])?dupFiles.push(files[i]):allNewFiles.push(files[i])}}function toArray(v){return angular.isArray(v)?v:[v]}function separateInvalids(){valids=[],invalids=[],angular.forEach(allNewFiles,function(file){file.$error?invalids.push(file):valids.push(file)})}function resizeAndUpdate(){function updateModel(){$timeout(function(){update(keep?prevValidFiles.concat(valids):valids,keep?prevInvalidFiles.concat(invalids):invalids,files,dupFiles,isSingleModel)},options&&options.debounce?options.debounce.change||options.debounce:0)}resize(validateAfterResize?allNewFiles:valids,attr,scope).then(function(){validateAfterResize?upload.validate(allNewFiles,prevValidFiles.length,ngModel,attr,scope).then(function(){separateInvalids(),updateModel()}):updateModel()},function(e){throw"Could not resize files "+e})}var allNewFiles,prevValidFiles,prevInvalidFiles,dupFiles=[],invalids=[],valids=[];prevValidFiles=attr.$$ngfPrevValidFiles||[],prevInvalidFiles=attr.$$ngfPrevInvalidFiles||[],ngModel&&ngModel.$modelValue&&(prevValidFiles=toArray(ngModel.$modelValue));var keep=upload.attrGetter("ngfKeep",attr,scope);allNewFiles=(files||[]).slice(0),"distinct"!==keep&&upload.attrGetter("ngfKeepDistinct",attr,scope)!==!0||removeDuplicates(attr,scope);var isSingleModel=!keep&&!upload.attrGetter("ngfMultiple",attr,scope)&&!upload.attrGetter("multiple",attr);if(!keep||allNewFiles.length){upload.attrGetter("ngfBeforeModelChange",attr,scope,{$files:files,$file:files&&files.length?files[0]:null,$newFiles:allNewFiles,$duplicateFiles:dupFiles,$event:evt});var validateAfterResize=upload.attrGetter("ngfValidateAfterResize",attr,scope),options=upload.attrGetter("ngModelOptions",attr,scope);upload.validate(allNewFiles,prevValidFiles.length,ngModel,attr,scope).then(function(){noDelay?update(allNewFiles,[],files,dupFiles,isSingleModel):(options&&options.allowInvalid||validateAfterResize?valids=allNewFiles:separateInvalids(),upload.attrGetter("ngfFixOrientation",attr,scope)&&upload.isExifSupported()?applyExifRotations(valids,attr,scope).then(function(){resizeAndUpdate()}):resizeAndUpdate())})}},upload}]),ngFileUpload.directive("ngfSelect",["$parse","$timeout","$compile","Upload",function($parse,$timeout,$compile,Upload){function isDelayedClickSupported(ua){var m=ua.match(/Android[^\d]*(\d+)\.(\d+)/);if(m&&m.length>2){var v=Upload.defaults.androidFixMinorVersion||4;return parseInt(m[1])<4||parseInt(m[1])===v&&parseInt(m[2])<v}return ua.indexOf("Chrome")===-1&&/.*Windows.*Safari.*/.test(ua)}function linkFileSelect(scope,elem,attr,ngModel,$parse,$timeout,$compile,upload){function isInputTypeFile(){return"input"===elem[0].tagName.toLowerCase()&&attr.type&&"file"===attr.type.toLowerCase()}function fileChangeAttr(){return attrGetter("ngfChange")||attrGetter("ngfSelect")}function changeFn(evt){if(upload.shouldUpdateOn("change",attr,scope)){for(var fileList=evt.__files_||evt.target&&evt.target.files,files=[],i=0;i<fileList.length;i++)files.push(fileList[i]);upload.updateModel(ngModel,attr,scope,fileChangeAttr(),files.length?files:null,evt)}}function bindAttrToFileInput(fileElem){if(elem!==fileElem)for(var i=0;i<elem[0].attributes.length;i++){var attribute=elem[0].attributes[i];"type"!==attribute.name&&"class"!==attribute.name&&"style"!==attribute.name&&(null!=attribute.value&&""!==attribute.value||("required"===attribute.name&&(attribute.value="required"),"multiple"===attribute.name&&(attribute.value="multiple")),fileElem.attr(attribute.name,"id"===attribute.name?"ngf-"+attribute.value:attribute.value))}}function createFileInput(){if(isInputTypeFile())return elem;var fileElem=angular.element('<input type="file">');bindAttrToFileInput(fileElem);var label=angular.element("<label>upload</label>");return label.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1"),generatedElems.push({el:elem,ref:label}),document.body.appendChild(label.append(fileElem)[0]),fileElem}function clickHandler(evt){if(elem.attr("disabled"))return!1;if(!attrGetter("ngfSelectDisabled",scope)){var r=handleTouch(evt);if(null!=r)return r;resetModel(evt);try{isInputTypeFile()||document.body.contains(fileElem[0])||(generatedElems.push({el:elem,ref:fileElem.parent()}),document.body.appendChild(fileElem.parent()[0]),fileElem.bind("change",changeFn))}catch(e){}return isDelayedClickSupported(navigator.userAgent)?setTimeout(function(){fileElem[0].click()},0):fileElem[0].click(),!1}}function handleTouch(evt){var touches=evt.changedTouches||evt.originalEvent&&evt.originalEvent.changedTouches;if("touchstart"===evt.type)return initialTouchStartY=touches?touches[0].clientY:0,!0;if(evt.stopPropagation(),evt.preventDefault(),"touchend"===evt.type){var currentLocation=touches?touches[0].clientY:0;if(Math.abs(currentLocation-initialTouchStartY)>20)return!1}}function resetModel(evt){upload.shouldUpdateOn("click",attr,scope)&&fileElem.val()&&(fileElem.val(null),upload.updateModel(ngModel,attr,scope,fileChangeAttr(),null,evt,!0))}function ie10SameFileSelectFix(evt){if(fileElem&&!fileElem.attr("__ngf_ie10_Fix_")){if(!fileElem[0].parentNode)return void(fileElem=null);evt.preventDefault(),evt.stopPropagation(),fileElem.unbind("click");var clone=fileElem.clone();return fileElem.replaceWith(clone),fileElem=clone,fileElem.attr("__ngf_ie10_Fix_","true"),fileElem.bind("change",changeFn),fileElem.bind("click",ie10SameFileSelectFix),fileElem[0].click(),!1}fileElem.removeAttr("__ngf_ie10_Fix_")}var attrGetter=function(name,scope){return upload.attrGetter(name,attr,scope)};upload.registerModelChangeValidator(ngModel,attr,scope);var unwatches=[];unwatches.push(scope.$watch(attrGetter("ngfMultiple"),function(){fileElem.attr("multiple",attrGetter("ngfMultiple",scope))})),unwatches.push(scope.$watch(attrGetter("ngfCapture"),function(){fileElem.attr("capture",attrGetter("ngfCapture",scope))})),unwatches.push(scope.$watch(attrGetter("ngfAccept"),function(){fileElem.attr("accept",attrGetter("ngfAccept",scope))})),attr.$observe("accept",function(){fileElem.attr("accept",attrGetter("accept"))}),unwatches.push(function(){attr.$$observers&&delete attr.$$observers.accept});var initialTouchStartY=0,fileElem=elem;isInputTypeFile()||(fileElem=createFileInput()),fileElem.bind("change",changeFn),isInputTypeFile()?elem.bind("click",resetModel):elem.bind("click touchstart touchend",clickHandler),navigator.appVersion.indexOf("MSIE 10")!==-1&&fileElem.bind("click",ie10SameFileSelectFix),ngModel&&ngModel.$formatters.push(function(val){return null!=val&&0!==val.length||fileElem.val()&&fileElem.val(null),val}),scope.$on("$destroy",function(){isInputTypeFile()||fileElem.parent().remove(),angular.forEach(unwatches,function(unwatch){unwatch()})}),$timeout(function(){for(var i=0;i<generatedElems.length;i++){var g=generatedElems[i];document.body.contains(g.el[0])||(generatedElems.splice(i,1),g.ref.remove())}}),window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(elem,fileElem,changeFn)}var generatedElems=[];return{restrict:"AEC",require:"?ngModel",link:function(scope,elem,attr,ngModel){linkFileSelect(scope,elem,attr,ngModel,$parse,$timeout,$compile,Upload)}}}]),function(){function getTagType(el){return"img"===el.tagName.toLowerCase()?"image":"audio"===el.tagName.toLowerCase()?"audio":"video"===el.tagName.toLowerCase()?"video":/./}function linkFileDirective(Upload,$timeout,scope,elem,attr,directiveName,resizeParams,isBackground){function constructDataUrl(file){var disallowObjectUrl=Upload.attrGetter("ngfNoObjectUrl",attr,scope);Upload.dataUrl(file,disallowObjectUrl)["finally"](function(){$timeout(function(){var src=(disallowObjectUrl?file.$ngfDataUrl:file.$ngfBlobUrl)||file.$ngfDataUrl;isBackground?elem.css("background-image","url('"+(src||"")+"')"):elem.attr("src",src),src?elem.removeClass("ng-hide"):elem.addClass("ng-hide")})})}$timeout(function(){var unwatch=scope.$watch(attr[directiveName],function(file){var size=resizeParams;if("ngfThumbnail"===directiveName&&(size||(size={width:elem[0].clientWidth,height:elem[0].clientHeight}),0===size.width&&window.getComputedStyle)){var style=getComputedStyle(elem[0]);size={width:parseInt(style.width.slice(0,-2)),height:parseInt(style.height.slice(0,-2))}}return angular.isString(file)?(elem.removeClass("ng-hide"),isBackground?elem.css("background-image","url('"+file+"')"):elem.attr("src",file)):void(!file||!file.type||0!==file.type.search(getTagType(elem[0]))||isBackground&&0!==file.type.indexOf("image")?elem.addClass("ng-hide"):size&&Upload.isResizeSupported()?Upload.resize(file,size.width,size.height,size.quality).then(function(f){constructDataUrl(f)},function(e){throw e}):constructDataUrl(file))});scope.$on("$destroy",function(){unwatch()})})}ngFileUpload.service("UploadDataUrl",["UploadBase","$timeout","$q",function(UploadBase,$timeout,$q){var upload=UploadBase;return upload.base64DataUrl=function(file){if(angular.isArray(file)){var d=$q.defer(),count=0;return angular.forEach(file,function(f){upload.dataUrl(f,!0)["finally"](function(){if(count++,count===file.length){var urls=[];angular.forEach(file,function(ff){urls.push(ff.$ngfDataUrl)}),d.resolve(urls,file)}})}),d.promise}return upload.dataUrl(file,!0)},upload.dataUrl=function(file,disallowObjectUrl){if(!file)return upload.emptyPromise(file,file);if(disallowObjectUrl&&null!=file.$ngfDataUrl||!disallowObjectUrl&&null!=file.$ngfBlobUrl)return upload.emptyPromise(disallowObjectUrl?file.$ngfDataUrl:file.$ngfBlobUrl,file);var p=disallowObjectUrl?file.$$ngfDataUrlPromise:file.$$ngfBlobUrlPromise;if(p)return p;var deferred=$q.defer();return $timeout(function(){if(window.FileReader&&file&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 8")===-1||file.size<2e4)&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 9")===-1||file.size<4e6)){var URL=window.URL||window.webkitURL;if(URL&&URL.createObjectURL&&!disallowObjectUrl){var url;try{url=URL.createObjectURL(file)}catch(e){return void $timeout(function(){file.$ngfBlobUrl="",deferred.reject()})}$timeout(function(){if(file.$ngfBlobUrl=url,url){deferred.resolve(url,file),upload.blobUrls=upload.blobUrls||[],upload.blobUrlsTotalSize=upload.blobUrlsTotalSize||0,upload.blobUrls.push({url:url,size:file.size}),upload.blobUrlsTotalSize+=file.size||0;for(var maxMemory=upload.defaults.blobUrlsMaxMemory||268435456,maxLength=upload.defaults.blobUrlsMaxQueueSize||200;(upload.blobUrlsTotalSize>maxMemory||upload.blobUrls.length>maxLength)&&upload.blobUrls.length>1;){var obj=upload.blobUrls.splice(0,1)[0];URL.revokeObjectURL(obj.url),upload.blobUrlsTotalSize-=obj.size}}})}else{var fileReader=new FileReader;fileReader.onload=function(e){$timeout(function(){file.$ngfDataUrl=e.target.result,deferred.resolve(e.target.result,file),$timeout(function(){delete file.$ngfDataUrl},1e3)})},fileReader.onerror=function(){$timeout(function(){file.$ngfDataUrl="",deferred.reject()})},fileReader.readAsDataURL(file)}}else $timeout(function(){file[disallowObjectUrl?"$ngfDataUrl":"$ngfBlobUrl"]="",deferred.reject()})}),p=disallowObjectUrl?file.$$ngfDataUrlPromise=deferred.promise:file.$$ngfBlobUrlPromise=deferred.promise,p["finally"](function(){delete file[disallowObjectUrl?"$$ngfDataUrlPromise":"$$ngfBlobUrlPromise"]}),p},upload}]),ngFileUpload.directive("ngfSrc",["Upload","$timeout",function(Upload,$timeout){return{restrict:"AE",link:function(scope,elem,attr){linkFileDirective(Upload,$timeout,scope,elem,attr,"ngfSrc",Upload.attrGetter("ngfResize",attr,scope),!1)}}}]),ngFileUpload.directive("ngfBackground",["Upload","$timeout",function(Upload,$timeout){return{restrict:"AE",link:function(scope,elem,attr){linkFileDirective(Upload,$timeout,scope,elem,attr,"ngfBackground",Upload.attrGetter("ngfResize",attr,scope),!0)}}}]),ngFileUpload.directive("ngfThumbnail",["Upload","$timeout",function(Upload,$timeout){return{restrict:"AE",link:function(scope,elem,attr){var size=Upload.attrGetter("ngfSize",attr,scope);linkFileDirective(Upload,$timeout,scope,elem,attr,"ngfThumbnail",size,Upload.attrGetter("ngfAsBackground",attr,scope))}}}]),ngFileUpload.config(["$compileProvider",function($compileProvider){$compileProvider.imgSrcSanitizationWhitelist&&$compileProvider.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/),$compileProvider.aHrefSanitizationWhitelist&&$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/)}]),ngFileUpload.filter("ngfDataUrl",["UploadDataUrl","$sce",function(UploadDataUrl,$sce){return function(file,disallowObjectUrl,trustedUrl){if(angular.isString(file))return $sce.trustAsResourceUrl(file);var src=file&&((disallowObjectUrl?file.$ngfDataUrl:file.$ngfBlobUrl)||file.$ngfDataUrl);return file&&!src?(!file.$ngfDataUrlFilterInProgress&&angular.isObject(file)&&(file.$ngfDataUrlFilterInProgress=!0,UploadDataUrl.dataUrl(file,disallowObjectUrl)),""):(file&&delete file.$ngfDataUrlFilterInProgress,(file&&src?trustedUrl?$sce.trustAsResourceUrl(src):src:file)||"")}}])}(),ngFileUpload.service("UploadValidate",["UploadDataUrl","$q","$timeout",function(UploadDataUrl,$q,$timeout){function globStringToRegex(str){var regexp="",excludes=[];if(str.length>2&&"/"===str[0]&&"/"===str[str.length-1])regexp=str.substring(1,str.length-1);else{var split=str.split(",");if(split.length>1)for(var i=0;i<split.length;i++){var r=globStringToRegex(split[i]);r.regexp?(regexp+="("+r.regexp+")",i<split.length-1&&(regexp+="|")):excludes=excludes.concat(r.excludes)}else 0===str.indexOf("!")?excludes.push("^((?!"+globStringToRegex(str.substring(1)).regexp+").)*$"):(0===str.indexOf(".")&&(str="*"+str),regexp="^"+str.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",regexp=regexp.replace(/\\\*/g,".*").replace(/\\\?/g,"."))}return{regexp:regexp,excludes:excludes}}function markModelAsDirty(ngModel,files){null==files||ngModel.$dirty||(ngModel.$setDirty?ngModel.$setDirty():ngModel.$dirty=!0)}var upload=UploadDataUrl;return upload.validatePattern=function(file,val){if(!val)return!0;var pattern=globStringToRegex(val),valid=!0;if(pattern.regexp&&pattern.regexp.length){var regexp=new RegExp(pattern.regexp,"i");valid=null!=file.type&&regexp.test(file.type)||null!=file.name&&regexp.test(file.name)}for(var len=pattern.excludes.length;len--;){var exclude=new RegExp(pattern.excludes[len],"i");valid=valid&&(null==file.type||exclude.test(file.type))&&(null==file.name||exclude.test(file.name))}return valid},upload.ratioToFloat=function(val){var r=val.toString(),xIndex=r.search(/[x:]/i);return r=xIndex>-1?parseFloat(r.substring(0,xIndex))/parseFloat(r.substring(xIndex+1)):parseFloat(r)},upload.registerModelChangeValidator=function(ngModel,attr,scope){ngModel&&ngModel.$formatters.push(function(files){ngModel.$dirty&&(files&&!angular.isArray(files)&&(files=[files]),upload.validate(files,0,ngModel,attr,scope).then(function(){upload.applyModelValidation(ngModel,files)}))})},upload.applyModelValidation=function(ngModel,files){markModelAsDirty(ngModel,files),angular.forEach(ngModel.$ngfValidations,function(validation){ngModel.$setValidity(validation.name,validation.valid)})},upload.getValidationAttr=function(attr,scope,name,validationName,file){var dName="ngf"+name[0].toUpperCase()+name.substr(1),val=upload.attrGetter(dName,attr,scope,{$file:file});if(null==val&&(val=upload.attrGetter("ngfValidate",attr,scope,{$file:file}))){var split=(validationName||name).split(".");val=val[split[0]],split.length>1&&(val=val&&val[split[1]])}return val},upload.validate=function(files,prevLength,ngModel,attr,scope){function validateSync(name,validationName,fn){if(files){for(var i=files.length,valid=null;i--;){var file=files[i];if(file){var val=upload.getValidationAttr(attr,scope,name,validationName,file);null!=val&&(fn(file,val,i)||(file.$error=name,(file.$errorMessages=file.$errorMessages||{})[name]=!0,file.$errorParam=val,files.splice(i,1),valid=!1))}}null!==valid&&ngModel.$ngfValidations.push({name:name,valid:valid})}}function validateAsync(name,validationName,type,asyncFn,fn){function resolveResult(defer,file,val){null!=val?asyncFn(file,val).then(function(d){fn(d,val)?defer.resolve():(file.$error=name,(file.$errorMessages=file.$errorMessages||{})[name]=!0,file.$errorParam=val,defer.reject())},function(){attrGetter("ngfValidateForce",{$file:file})?(file.$error=name,(file.$errorMessages=file.$errorMessages||{})[name]=!0,file.$errorParam=val,defer.reject()):defer.resolve()}):defer.resolve()}var promises=[upload.emptyPromise()];if(files)return files=void 0===files.length?[files]:files,angular.forEach(files,function(file){var defer=$q.defer();return promises.push(defer.promise),!type||null!=file.type&&0===file.type.search(type)?void("dimensions"===name&&null!=upload.attrGetter("ngfDimensions",attr)?upload.imageDimensions(file).then(function(d){resolveResult(defer,file,attrGetter("ngfDimensions",{$file:file,$width:d.width,$height:d.height}))},function(){defer.reject()}):"duration"===name&&null!=upload.attrGetter("ngfDuration",attr)?upload.mediaDuration(file).then(function(d){resolveResult(defer,file,attrGetter("ngfDuration",{$file:file,$duration:d}))},function(){defer.reject()}):resolveResult(defer,file,upload.getValidationAttr(attr,scope,name,validationName,file))):void defer.resolve()}),$q.all(promises).then(function(){ngModel.$ngfValidations.push({name:name,valid:!0})},function(){ngModel.$ngfValidations.push({name:name,valid:!1})})}ngModel=ngModel||{},ngModel.$ngfValidations=ngModel.$ngfValidations||[],angular.forEach(ngModel.$ngfValidations,function(v){v.valid=!0});var attrGetter=function(name,params){return upload.attrGetter(name,attr,scope,params)};if(null==files||0===files.length)return upload.emptyPromise(ngModel);files=void 0===files.length?[files]:files.slice(0),validateSync("maxFiles",null,function(file,val,i){return prevLength+i<val}),validateSync("pattern",null,upload.validatePattern),validateSync("minSize","size.min",function(file,val){return file.size+.1>=upload.translateScalars(val)}),validateSync("maxSize","size.max",function(file,val){return file.size-.1<=upload.translateScalars(val)});var totalSize=0;if(validateSync("maxTotalSize",null,function(file,val){return totalSize+=file.size,!(totalSize>upload.translateScalars(val))||(files.splice(0,files.length),!1)}),validateSync("validateFn",null,function(file,r){return r===!0||null===r||""===r}),!files.length)return upload.emptyPromise(ngModel,ngModel.$ngfValidations);var deffer=$q.defer(),promises=[];return promises.push(upload.happyPromise(validateAsync("maxHeight","height.max",/image/,this.imageDimensions,function(d,val){return d.height<=val}))),promises.push(upload.happyPromise(validateAsync("minHeight","height.min",/image/,this.imageDimensions,function(d,val){return d.height>=val}))),promises.push(upload.happyPromise(validateAsync("maxWidth","width.max",/image/,this.imageDimensions,function(d,val){return d.width<=val}))),promises.push(upload.happyPromise(validateAsync("minWidth","width.min",/image/,this.imageDimensions,function(d,val){return d.width>=val}))),promises.push(upload.happyPromise(validateAsync("dimensions",null,/image/,function(file,val){return upload.emptyPromise(val)},function(r){return r}))),promises.push(upload.happyPromise(validateAsync("ratio",null,/image/,this.imageDimensions,function(d,val){for(var split=val.toString().split(","),valid=!1,i=0;i<split.length;i++)Math.abs(d.width/d.height-upload.ratioToFloat(split[i]))<1e-4&&(valid=!0);return valid}))),promises.push(upload.happyPromise(validateAsync("maxRatio","ratio.max",/image/,this.imageDimensions,function(d,val){return d.width/d.height-upload.ratioToFloat(val)<1e-4}))),promises.push(upload.happyPromise(validateAsync("minRatio","ratio.min",/image/,this.imageDimensions,function(d,val){return d.width/d.height-upload.ratioToFloat(val)>-1e-4}))),promises.push(upload.happyPromise(validateAsync("maxDuration","duration.max",/audio|video/,this.mediaDuration,function(d,val){return d<=upload.translateScalars(val)}))),promises.push(upload.happyPromise(validateAsync("minDuration","duration.min",/audio|video/,this.mediaDuration,function(d,val){return d>=upload.translateScalars(val)}))),promises.push(upload.happyPromise(validateAsync("duration",null,/audio|video/,function(file,val){return upload.emptyPromise(val)},function(r){return r}))),promises.push(upload.happyPromise(validateAsync("validateAsyncFn",null,null,function(file,val){return val},function(r){return r===!0||null===r||""===r}))),$q.all(promises).then(function(){deffer.resolve(ngModel,ngModel.$ngfValidations)})},upload.imageDimensions=function(file){if(file.$ngfWidth&&file.$ngfHeight){var d=$q.defer();return $timeout(function(){d.resolve({width:file.$ngfWidth,height:file.$ngfHeight})}),d.promise}if(file.$ngfDimensionPromise)return file.$ngfDimensionPromise;var deferred=$q.defer();return $timeout(function(){return 0!==file.type.indexOf("image")?void deferred.reject("not image"):void upload.dataUrl(file).then(function(dataUrl){function success(){var width=img[0].clientWidth,height=img[0].clientHeight;img.remove(),file.$ngfWidth=width,file.$ngfHeight=height,deferred.resolve({width:width,height:height})}function error(){img.remove(),deferred.reject("load error")}function checkLoadError(){$timeout(function(){img[0].parentNode&&(img[0].clientWidth?success():count>10?error():checkLoadError())},1e3)}var img=angular.element("<img>").attr("src",dataUrl).css("visibility","hidden").css("position","fixed").css("max-width","none !important").css("max-height","none !important");img.on("load",success),img.on("error",error);var count=0;checkLoadError(),angular.element(document.getElementsByTagName("body")[0]).append(img)},function(){deferred.reject("load error")})}),file.$ngfDimensionPromise=deferred.promise,file.$ngfDimensionPromise["finally"](function(){delete file.$ngfDimensionPromise}),file.$ngfDimensionPromise},upload.mediaDuration=function(file){if(file.$ngfDuration){var d=$q.defer();return $timeout(function(){d.resolve(file.$ngfDuration)}),d.promise}if(file.$ngfDurationPromise)return file.$ngfDurationPromise;var deferred=$q.defer();return $timeout(function(){return 0!==file.type.indexOf("audio")&&0!==file.type.indexOf("video")?void deferred.reject("not media"):void upload.dataUrl(file).then(function(dataUrl){function success(){var duration=el[0].duration;file.$ngfDuration=duration,el.remove(),deferred.resolve(duration)}function error(){el.remove(),deferred.reject("load error")}function checkLoadError(){$timeout(function(){el[0].parentNode&&(el[0].duration?success():count>10?error():checkLoadError())},1e3)}var el=angular.element(0===file.type.indexOf("audio")?"<audio>":"<video>").attr("src",dataUrl).css("visibility","none").css("position","fixed");el.on("loadedmetadata",success),el.on("error",error);var count=0;checkLoadError(),angular.element(document.body).append(el)},function(){deferred.reject("load error")})}),file.$ngfDurationPromise=deferred.promise,file.$ngfDurationPromise["finally"](function(){delete file.$ngfDurationPromise}),file.$ngfDurationPromise},upload}]),ngFileUpload.service("UploadResize",["UploadValidate","$q",function(UploadValidate,$q){var upload=UploadValidate,calculateAspectRatioFit=function(srcWidth,srcHeight,maxWidth,maxHeight,centerCrop){var ratio=centerCrop?Math.max(maxWidth/srcWidth,maxHeight/srcHeight):Math.min(maxWidth/srcWidth,maxHeight/srcHeight);return{width:srcWidth*ratio,height:srcHeight*ratio,marginX:srcWidth*ratio-maxWidth,marginY:srcHeight*ratio-maxHeight}},resize=function(imagen,width,height,quality,type,ratio,centerCrop,resizeIf){var deferred=$q.defer(),canvasElement=document.createElement("canvas"),imageElement=document.createElement("img");return imageElement.onload=function(){if(null!=resizeIf&&resizeIf(imageElement.width,imageElement.height)===!1)return void deferred.reject("resizeIf");try{if(ratio){var ratioFloat=upload.ratioToFloat(ratio),imgRatio=imageElement.width/imageElement.height;imgRatio<ratioFloat?(width=imageElement.width,height=width/ratioFloat):(height=imageElement.height,width=height*ratioFloat)}width||(width=imageElement.width),height||(height=imageElement.height);var dimensions=calculateAspectRatioFit(imageElement.width,imageElement.height,width,height,centerCrop);canvasElement.width=Math.min(dimensions.width,width),canvasElement.height=Math.min(dimensions.height,height);var context=canvasElement.getContext("2d");context.drawImage(imageElement,Math.min(0,-dimensions.marginX/2),Math.min(0,-dimensions.marginY/2),dimensions.width,dimensions.height),deferred.resolve(canvasElement.toDataURL(type||"image/WebP",quality||.934))}catch(e){deferred.reject(e)}},imageElement.onerror=function(){deferred.reject()},imageElement.src=imagen,deferred.promise};return upload.dataUrltoBlob=function(dataurl,name,origSize){for(var arr=dataurl.split(","),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);n--;)u8arr[n]=bstr.charCodeAt(n);var blob=new window.Blob([u8arr],{type:mime});return blob.name=name,blob.$ngfOrigSize=origSize,blob},upload.isResizeSupported=function(){var elem=document.createElement("canvas");return window.atob&&elem.getContext&&elem.getContext("2d")&&window.Blob},upload.isResizeSupported()&&Object.defineProperty(window.Blob.prototype,"name",{get:function(){return this.$ngfName},set:function(v){this.$ngfName=v},configurable:!0}),upload.resize=function(file,width,height,quality,type,ratio,centerCrop,resizeIf,restoreExif){if(0!==file.type.indexOf("image"))return upload.emptyPromise(file);var deferred=$q.defer();return upload.dataUrl(file,!0).then(function(url){resize(url,width,height,quality,type||file.type,ratio,centerCrop,resizeIf).then(function(dataUrl){if("image/jpeg"===file.type&&restoreExif)try{dataUrl=upload.restoreExif(url,dataUrl)}catch(e){setTimeout(function(){throw e},1)}try{var blob=upload.dataUrltoBlob(dataUrl,file.name,file.size);deferred.resolve(blob)}catch(e){deferred.reject(e)}},function(r){"resizeIf"===r&&deferred.resolve(file),deferred.reject(r)})},function(e){deferred.reject(e)}),deferred.promise},upload}]),function(){function linkDrop(scope,elem,attr,ngModel,$parse,$timeout,$location,upload,$http,$q){function isDisabled(){return elem.attr("disabled")||attrGetter("ngfDropDisabled",scope)}function updateModel(files,evt){upload.updateModel(ngModel,attr,scope,attrGetter("ngfChange")||attrGetter("ngfDrop"),files,evt)}function extractFilesFromHtml(updateOn,html){if(!upload.shouldUpdateOn(updateOn,attr,scope)||!html)return upload.rejectPromise([]);var urls=[];html.replace(/<(img src|img [^>]* src) *=\"([^\"]*)\"/gi,function(m,n,src){urls.push(src)});var promises=[],files=[];if(urls.length){angular.forEach(urls,function(url){promises.push(upload.urlToBlob(url).then(function(blob){files.push(blob)}))});var defer=$q.defer();return $q.all(promises).then(function(){defer.resolve(files)},function(e){defer.reject(e);
}),defer.promise}return upload.emptyPromise()}function calculateDragOverClass(scope,attr,evt,callback){var obj=attrGetter("ngfDragOverClass",scope,{$event:evt}),dClass="dragover";if(angular.isString(obj))dClass=obj;else if(obj&&(obj.delay&&(dragOverDelay=obj.delay),obj.accept||obj.reject)){var items=evt.dataTransfer.items;if(null!=items&&items.length)for(var pattern=obj.pattern||attrGetter("ngfPattern",scope,{$event:evt}),len=items.length;len--;){if(!upload.validatePattern(items[len],pattern)){dClass=obj.reject;break}dClass=obj.accept}else dClass=obj.accept}callback(dClass)}function extractFiles(items,fileList,allowDir,multiple){function traverseFileTree(entry,path){var defer=$q.defer();if(null!=entry)if(entry.isDirectory){var promises=[upload.emptyPromise()];if(includeDir){var file={type:"directory"};file.name=file.path=(path||"")+entry.name+entry.name,files.push(file)}var dirReader=entry.createReader(),entries=[],readEntries=function(){dirReader.readEntries(function(results){try{results.length?(entries=entries.concat(Array.prototype.slice.call(results||[],0)),readEntries()):(angular.forEach(entries.slice(0),function(e){files.length<=maxFiles&&totalSize<=maxTotalSize&&promises.push(traverseFileTree(e,(path?path:"")+entry.name+"/"))}),$q.all(promises).then(function(){defer.resolve()},function(e){defer.reject(e)}))}catch(e){defer.reject(e)}},function(e){defer.reject(e)})};readEntries()}else entry.file(function(file){try{file.path=(path?path:"")+file.name,includeDir&&(file=upload.rename(file,file.path)),files.push(file),totalSize+=file.size,defer.resolve()}catch(e){defer.reject(e)}},function(e){defer.reject(e)});return defer.promise}var maxFiles=upload.getValidationAttr(attr,scope,"maxFiles")||Number.MAX_VALUE,maxTotalSize=upload.getValidationAttr(attr,scope,"maxTotalSize")||Number.MAX_VALUE,includeDir=attrGetter("ngfIncludeDir",scope),files=[],totalSize=0,promises=[upload.emptyPromise()];if(items&&items.length>0&&"file"!==$location.protocol())for(var i=0;i<items.length;i++){if(items[i].webkitGetAsEntry&&items[i].webkitGetAsEntry()&&items[i].webkitGetAsEntry().isDirectory){var entry=items[i].webkitGetAsEntry();if(entry.isDirectory&&!allowDir)continue;null!=entry&&promises.push(traverseFileTree(entry))}else{var f=items[i].getAsFile();null!=f&&(files.push(f),totalSize+=f.size)}if(files.length>maxFiles||totalSize>maxTotalSize||!multiple&&files.length>0)break}else if(null!=fileList)for(var j=0;j<fileList.length;j++){var file=fileList.item(j);if((file.type||file.size>0)&&(files.push(file),totalSize+=file.size),files.length>maxFiles||totalSize>maxTotalSize||!multiple&&files.length>0)break}var defer=$q.defer();return $q.all(promises).then(function(){if(multiple||includeDir||!files.length)defer.resolve(files);else{for(var i=0;files[i]&&"directory"===files[i].type;)i++;defer.resolve([files[i]])}},function(e){defer.reject(e)}),defer.promise}var available=dropAvailable(),attrGetter=function(name,scope,params){return upload.attrGetter(name,attr,scope,params)};if(attrGetter("dropAvailable")&&$timeout(function(){scope[attrGetter("dropAvailable")]?scope[attrGetter("dropAvailable")].value=available:scope[attrGetter("dropAvailable")]=available}),!available)return void(attrGetter("ngfHideOnDropNotAvailable",scope)===!0&&elem.css("display","none"));null==attrGetter("ngfSelect")&&upload.registerModelChangeValidator(ngModel,attr,scope);var actualDragOverClass,leaveTimeout=null,stopPropagation=$parse(attrGetter("ngfStopPropagation")),dragOverDelay=1;elem[0].addEventListener("dragover",function(evt){if(!isDisabled()&&upload.shouldUpdateOn("drop",attr,scope)){if(evt.preventDefault(),stopPropagation(scope)&&evt.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var b=evt.dataTransfer.effectAllowed;evt.dataTransfer.dropEffect="move"===b||"linkMove"===b?"move":"copy"}$timeout.cancel(leaveTimeout),actualDragOverClass||(actualDragOverClass="C",calculateDragOverClass(scope,attr,evt,function(clazz){actualDragOverClass=clazz,elem.addClass(actualDragOverClass),attrGetter("ngfDrag",scope,{$isDragging:!0,$class:actualDragOverClass,$event:evt})}))}},!1),elem[0].addEventListener("dragenter",function(evt){!isDisabled()&&upload.shouldUpdateOn("drop",attr,scope)&&(evt.preventDefault(),stopPropagation(scope)&&evt.stopPropagation())},!1),elem[0].addEventListener("dragleave",function(evt){!isDisabled()&&upload.shouldUpdateOn("drop",attr,scope)&&(evt.preventDefault(),stopPropagation(scope)&&evt.stopPropagation(),leaveTimeout=$timeout(function(){actualDragOverClass&&elem.removeClass(actualDragOverClass),actualDragOverClass=null,attrGetter("ngfDrag",scope,{$isDragging:!1,$event:evt})},dragOverDelay||100))},!1),elem[0].addEventListener("drop",function(evt){if(!isDisabled()&&upload.shouldUpdateOn("drop",attr,scope)){evt.preventDefault(),stopPropagation(scope)&&evt.stopPropagation(),actualDragOverClass&&elem.removeClass(actualDragOverClass),actualDragOverClass=null;var html,items=evt.dataTransfer.items;try{html=evt.dataTransfer&&evt.dataTransfer.getData&&evt.dataTransfer.getData("text/html")}catch(e){}extractFiles(items,evt.dataTransfer.files,attrGetter("ngfAllowDir",scope)!==!1,attrGetter("multiple")||attrGetter("ngfMultiple",scope)).then(function(files){files.length?updateModel(files,evt):extractFilesFromHtml("dropUrl",html).then(function(files){updateModel(files,evt)})})}},!1),elem[0].addEventListener("paste",function(evt){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&attrGetter("ngfEnableFirefoxPaste",scope)&&evt.preventDefault(),!isDisabled()&&upload.shouldUpdateOn("paste",attr,scope)){var files=[],clipboard=evt.clipboardData||evt.originalEvent.clipboardData;if(clipboard&&clipboard.items)for(var k=0;k<clipboard.items.length;k++)clipboard.items[k].type.indexOf("image")!==-1&&files.push(clipboard.items[k].getAsFile());files.length?updateModel(files,evt):extractFilesFromHtml("pasteUrl",clipboard).then(function(files){updateModel(files,evt)})}},!1),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&attrGetter("ngfEnableFirefoxPaste",scope)&&(elem.attr("contenteditable",!0),elem.on("keypress",function(e){e.metaKey||e.ctrlKey||e.preventDefault()}))}function dropAvailable(){var div=document.createElement("div");return"draggable"in div&&"ondrop"in div&&!/Edge\/12./i.test(navigator.userAgent)}ngFileUpload.directive("ngfDrop",["$parse","$timeout","$location","Upload","$http","$q",function($parse,$timeout,$location,Upload,$http,$q){return{restrict:"AEC",require:"?ngModel",link:function(scope,elem,attr,ngModel){linkDrop(scope,elem,attr,ngModel,$parse,$timeout,$location,Upload,$http,$q)}}}]),ngFileUpload.directive("ngfNoFileDrop",function(){return function(scope,elem){dropAvailable()&&elem.css("display","none")}}),ngFileUpload.directive("ngfDropAvailable",["$parse","$timeout","Upload",function($parse,$timeout,Upload){return function(scope,elem,attr){if(dropAvailable()){var model=$parse(Upload.attrGetter("ngfDropAvailable",attr));$timeout(function(){model(scope),model.assign&&model.assign(scope,!0)})}}}])}(),ngFileUpload.service("UploadExif",["UploadResize","$q",function(UploadResize,$q){function applyTransform(ctx,orientation,width,height){switch(orientation){case 2:return ctx.transform(-1,0,0,1,width,0);case 3:return ctx.transform(-1,0,0,-1,width,height);case 4:return ctx.transform(1,0,0,-1,0,height);case 5:return ctx.transform(0,1,1,0,0,0);case 6:return ctx.transform(0,1,-1,0,height,0);case 7:return ctx.transform(0,-1,-1,0,height,width);case 8:return ctx.transform(0,-1,1,0,0,width)}}function arrayBufferToBase64(buffer){for(var binary="",bytes=new Uint8Array(buffer),len=bytes.byteLength,i=0;i<len;i++)binary+=String.fromCharCode(bytes[i]);return window.btoa(binary)}var upload=UploadResize;return upload.isExifSupported=function(){return window.FileReader&&(new FileReader).readAsArrayBuffer&&upload.isResizeSupported()},upload.readOrientation=function(file){var defer=$q.defer(),reader=new FileReader,slicedFile=file.slice?file.slice(0,65536):file;return reader.readAsArrayBuffer(slicedFile),reader.onerror=function(e){return defer.reject(e)},reader.onload=function(e){var result={orientation:1},view=new DataView(this.result);if(65496!==view.getUint16(0,!1))return defer.resolve(result);for(var length=view.byteLength,offset=2;offset<length;){var marker=view.getUint16(offset,!1);if(offset+=2,65505===marker){if(1165519206!==view.getUint32(offset+=2,!1))return defer.resolve(result);var little=18761===view.getUint16(offset+=6,!1);offset+=view.getUint32(offset+4,little);var tags=view.getUint16(offset,little);offset+=2;for(var i=0;i<tags;i++)if(274===view.getUint16(offset+12*i,little)){var orientation=view.getUint16(offset+12*i+8,little);return orientation>=2&&orientation<=8&&(view.setUint16(offset+12*i+8,1,little),result.fixedArrayBuffer=e.target.result),result.orientation=orientation,defer.resolve(result)}}else{if(65280!==(65280&marker))break;offset+=view.getUint16(offset,!1)}}return defer.resolve(result)},defer.promise},upload.applyExifRotation=function(file){if(0!==file.type.indexOf("image/jpeg"))return upload.emptyPromise(file);var deferred=$q.defer();return upload.readOrientation(file).then(function(result){return result.orientation<2||result.orientation>8?deferred.resolve(file):void upload.dataUrl(file,!0).then(function(url){var canvas=document.createElement("canvas"),img=document.createElement("img");img.onload=function(){try{canvas.width=result.orientation>4?img.height:img.width,canvas.height=result.orientation>4?img.width:img.height;var ctx=canvas.getContext("2d");applyTransform(ctx,result.orientation,img.width,img.height),ctx.drawImage(img,0,0);var dataUrl=canvas.toDataURL(file.type||"image/WebP",.934);dataUrl=upload.restoreExif(arrayBufferToBase64(result.fixedArrayBuffer),dataUrl);var blob=upload.dataUrltoBlob(dataUrl,file.name);deferred.resolve(blob)}catch(e){return deferred.reject(e)}},img.onerror=function(){deferred.reject()},img.src=url},function(e){deferred.reject(e)})},function(e){deferred.reject(e)}),deferred.promise},upload.restoreExif=function(orig,resized){var ExifRestorer={};return ExifRestorer.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ExifRestorer.encode64=function(input){var chr1,chr2,enc1,enc2,enc3,output="",chr3="",enc4="",i=0;do chr1=input[i++],chr2=input[i++],chr3=input[i++],enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+this.KEY_STR.charAt(enc1)+this.KEY_STR.charAt(enc2)+this.KEY_STR.charAt(enc3)+this.KEY_STR.charAt(enc4),chr1=chr2=chr3="",enc1=enc2=enc3=enc4="";while(i<input.length);return output},ExifRestorer.restore=function(origFileBase64,resizedFileBase64){origFileBase64.match("data:image/jpeg;base64,")&&(origFileBase64=origFileBase64.replace("data:image/jpeg;base64,",""));var rawImage=this.decode64(origFileBase64),segments=this.slice2Segments(rawImage),image=this.exifManipulation(resizedFileBase64,segments);return"data:image/jpeg;base64,"+this.encode64(image)},ExifRestorer.exifManipulation=function(resizedFileBase64,segments){var exifArray=this.getExifArray(segments),newImageArray=this.insertExif(resizedFileBase64,exifArray);return new Uint8Array(newImageArray)},ExifRestorer.getExifArray=function(segments){for(var seg,x=0;x<segments.length;x++)if(seg=segments[x],255===seg[0]&225===seg[1])return seg;return[]},ExifRestorer.insertExif=function(resizedFileBase64,exifArray){var imageData=resizedFileBase64.replace("data:image/jpeg;base64,",""),buf=this.decode64(imageData),separatePoint=buf.indexOf(255,3),mae=buf.slice(0,separatePoint),ato=buf.slice(separatePoint),array=mae;return array=array.concat(exifArray),array=array.concat(ato)},ExifRestorer.slice2Segments=function(rawImageArray){for(var head=0,segments=[];;){if(255===rawImageArray[head]&218===rawImageArray[head+1])break;if(255===rawImageArray[head]&216===rawImageArray[head+1])head+=2;else{var length=256*rawImageArray[head+2]+rawImageArray[head+3],endPoint=head+length+2,seg=rawImageArray.slice(head,endPoint);segments.push(seg),head=endPoint}if(head>rawImageArray.length)break}return segments},ExifRestorer.decode64=function(input){var chr1,chr2,enc1,enc2,enc3,chr3="",enc4="",i=0,buf=[],base64test=/[^A-Za-z0-9\+\/\=]/g;base64test.exec(input)&&console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding."),input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");do enc1=this.KEY_STR.indexOf(input.charAt(i++)),enc2=this.KEY_STR.indexOf(input.charAt(i++)),enc3=this.KEY_STR.indexOf(input.charAt(i++)),enc4=this.KEY_STR.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,buf.push(chr1),64!==enc3&&buf.push(chr2),64!==enc4&&buf.push(chr3),chr1=chr2=chr3="",enc1=enc2=enc3=enc4="";while(i<input.length);return buf},ExifRestorer.restore(orig,resized)},upload}]),function(window){"use strict";function addEventListener(obj,evt,func){"addEventListener"in window?obj.addEventListener(evt,func,!1):"attachEvent"in window&&obj.attachEvent("on"+evt,func)}function removeEventListener(el,evt,func){"removeEventListener"in window?el.removeEventListener(evt,func,!1):"detachEvent"in window&&el.detachEvent("on"+evt,func)}function setupRequestAnimationFrame(){var x,vendors=["moz","webkit","o","ms"];for(x=0;x<vendors.length&&!requestAnimationFrame;x+=1)requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];requestAnimationFrame||log("setup","RequestAnimationFrame not supported")}function getMyID(iframeId){var retStr="Host page: "+iframeId;return window.top!==window.self&&(retStr=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+iframeId:"Nested host page: "+iframeId),retStr}function formatLogHeader(iframeId){return msgId+"["+getMyID(iframeId)+"]"}function isLogEnabled(iframeId){return settings[iframeId]?settings[iframeId].log:logEnabled}function log(iframeId,msg){output("log",iframeId,msg,isLogEnabled(iframeId))}function info(iframeId,msg){output("info",iframeId,msg,isLogEnabled(iframeId))}function warn(iframeId,msg){output("warn",iframeId,msg,!0)}function output(type,iframeId,msg,enabled){!0===enabled&&"object"==typeof window.console&&console[type](formatLogHeader(iframeId),msg)}function iFrameListener(event){function resizeIFrame(){function resize(){setSize(messageData),setPagePosition(iframeId)}ensureInRange("Height"),ensureInRange("Width"),syncResize(resize,messageData,"init")}function processMsg(){var data=msg.substr(msgIdLen).split(":");return{iframe:settings[data[0]].iframe,id:data[0],height:data[1],width:data[2],type:data[3]}}function ensureInRange(Dimension){var max=Number(settings[iframeId]["max"+Dimension]),min=Number(settings[iframeId]["min"+Dimension]),dimension=Dimension.toLowerCase(),size=Number(messageData[dimension]);log(iframeId,"Checking "+dimension+" is in range "+min+"-"+max),size<min&&(size=min,log(iframeId,"Set "+dimension+" to min value")),size>max&&(size=max,log(iframeId,"Set "+dimension+" to max value")),messageData[dimension]=""+size}function isMessageFromIFrame(){function checkAllowedOrigin(){function checkList(){var i=0,retCode=!1;for(log(iframeId,"Checking connection is from allowed list of origins: "+checkOrigin);i<checkOrigin.length;i++)if(checkOrigin[i]===origin){retCode=!0;break}return retCode}function checkSingle(){var remoteHost=settings[iframeId].remoteHost;return log(iframeId,"Checking connection is from: "+remoteHost),origin===remoteHost}return checkOrigin.constructor===Array?checkList():checkSingle()}var origin=event.origin,checkOrigin=settings[iframeId].checkOrigin;if(checkOrigin&&""+origin!="null"&&!checkAllowedOrigin())throw new Error("Unexpected message received from: "+origin+" for "+messageData.iframe.id+". Message was: "+event.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function isMessageForUs(){return msgId===(""+msg).substr(0,msgIdLen)&&msg.substr(msgIdLen).split(":")[0]in settings}function isMessageFromMetaParent(){var retCode=messageData.type in{"true":1,"false":1,undefined:1};return retCode&&log(iframeId,"Ignoring init message from meta parent page"),retCode}function getMsgBody(offset){return msg.substr(msg.indexOf(":")+msgHeaderLen+offset)}function forwardMsgFromIFrame(msgBody){log(iframeId,"MessageCallback passed: {iframe: "+messageData.iframe.id+", message: "+msgBody+"}"),callback("messageCallback",{iframe:messageData.iframe,message:JSON.parse(msgBody)}),log(iframeId,"--")}function getPageInfo(){var bodyPosition=document.body.getBoundingClientRect(),iFramePosition=messageData.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:iFramePosition.height,iframeWidth:iFramePosition.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(iFramePosition.top-bodyPosition.top,10),offsetLeft:parseInt(iFramePosition.left-bodyPosition.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})}function sendPageInfoToIframe(iframe,iframeId){function debouncedTrigger(){trigger("Send Page Info","pageInfo:"+getPageInfo(),iframe,iframeId)}debouce(debouncedTrigger,32)}function startPageInfoMonitor(){function setListener(type,func){function sendPageInfo(){settings[id]?sendPageInfoToIframe(settings[id].iframe,id):stop()}["scroll","resize"].forEach(function(evt){log(id,type+evt+" listener for sendPageInfo"),func(window,evt,sendPageInfo)})}function stop(){setListener("Remove ",removeEventListener)}function start(){setListener("Add ",addEventListener)}var id=iframeId;start(),settings[id].stopPageInfo=stop}function stopPageInfoMonitor(){settings[iframeId]&&settings[iframeId].stopPageInfo&&(settings[iframeId].stopPageInfo(),delete settings[iframeId].stopPageInfo)}function checkIFrameExists(){var retBool=!0;return null===messageData.iframe&&(warn(iframeId,"IFrame ("+messageData.id+") not found"),retBool=!1),retBool}function getElementPosition(target){var iFramePosition=target.getBoundingClientRect();return getPagePosition(iframeId),{x:Math.floor(Number(iFramePosition.left)+Number(pagePosition.x)),y:Math.floor(Number(iFramePosition.top)+Number(pagePosition.y))}}function scrollRequestFromChild(addOffset){function reposition(){pagePosition=newPosition,scrollTo(),log(iframeId,"--")}function calcOffset(){return{x:Number(messageData.width)+offset.x,y:Number(messageData.height)+offset.y}}function scrollParent(){window.parentIFrame?window.parentIFrame["scrollTo"+(addOffset?"Offset":"")](newPosition.x,newPosition.y):warn(iframeId,"Unable to scroll to requested position, window.parentIFrame not found")}var offset=addOffset?getElementPosition(messageData.iframe):{x:0,y:0},newPosition=calcOffset();log(iframeId,"Reposition requested from iFrame (offset x:"+offset.x+" y:"+offset.y+")"),window.top!==window.self?scrollParent():reposition()}function scrollTo(){!1!==callback("scrollCallback",pagePosition)?setPagePosition(iframeId):unsetPagePosition()}function findTarget(location){function jumpToTarget(){var jumpPosition=getElementPosition(target);log(iframeId,"Moving to in page link (#"+hash+") at x: "+jumpPosition.x+" y: "+jumpPosition.y),pagePosition={x:jumpPosition.x,y:jumpPosition.y},scrollTo(),log(iframeId,"--")}function jumpToParent(){window.parentIFrame?window.parentIFrame.moveToAnchor(hash):log(iframeId,"In page link #"+hash+" not found and window.parentIFrame not found")}var hash=location.split("#")[1]||"",hashData=decodeURIComponent(hash),target=document.getElementById(hashData)||document.getElementsByName(hashData)[0];target?jumpToTarget():window.top!==window.self?jumpToParent():log(iframeId,"In page link #"+hash+" not found")}function callback(funcName,val){return chkCallback(iframeId,funcName,val)}function actionMsg(){switch(settings[iframeId].firstRun&&firstRun(),messageData.type){case"close":closeIFrame(messageData.iframe);break;case"message":forwardMsgFromIFrame(getMsgBody(6));break;case"scrollTo":scrollRequestFromChild(!1);break;case"scrollToOffset":scrollRequestFromChild(!0);break;case"pageInfo":sendPageInfoToIframe(settings[iframeId].iframe,iframeId),startPageInfoMonitor();break;case"pageInfoStop":stopPageInfoMonitor();break;case"inPageLink":findTarget(getMsgBody(9));break;case"reset":resetIFrame(messageData);break;case"init":resizeIFrame(),callback("initCallback",messageData.iframe),callback("resizedCallback",messageData);break;default:resizeIFrame(),callback("resizedCallback",messageData)}}function hasSettings(iframeId){var retBool=!0;return settings[iframeId]||(retBool=!1,warn(messageData.type+" No settings for "+iframeId+". Message was: "+msg)),retBool}function iFrameReadyMsgReceived(){for(var iframeId in settings)trigger("iFrame requested init",createOutgoingMsg(iframeId),document.getElementById(iframeId),iframeId)}function firstRun(){settings[iframeId].firstRun=!1}var msg=event.data,messageData={},iframeId=null;"[iFrameResizerChild]Ready"===msg?iFrameReadyMsgReceived():isMessageForUs()?(messageData=processMsg(),iframeId=logId=messageData.id,!isMessageFromMetaParent()&&hasSettings(iframeId)&&(log(iframeId,"Received: "+msg),checkIFrameExists()&&isMessageFromIFrame()&&actionMsg())):info(iframeId,"Ignored: "+msg)}function chkCallback(iframeId,funcName,val){var func=null,retVal=null;if(settings[iframeId]){if(func=settings[iframeId][funcName],"function"!=typeof func)throw new TypeError(funcName+" on iFrame["+iframeId+"] is not a function");retVal=func(val)}return retVal}function closeIFrame(iframe){var iframeId=iframe.id;log(iframeId,"Removing iFrame: "+iframeId),iframe.parentNode.removeChild(iframe),chkCallback(iframeId,"closedCallback",iframeId),log(iframeId,"--"),delete settings[iframeId]}function getPagePosition(iframeId){null===pagePosition&&(pagePosition={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop},log(iframeId,"Get page position: "+pagePosition.x+","+pagePosition.y))}function setPagePosition(iframeId){null!==pagePosition&&(window.scrollTo(pagePosition.x,pagePosition.y),log(iframeId,"Set page position: "+pagePosition.x+","+pagePosition.y),unsetPagePosition())}function unsetPagePosition(){pagePosition=null}function resetIFrame(messageData){function reset(){setSize(messageData),trigger("reset","reset",messageData.iframe,messageData.id)}log(messageData.id,"Size reset requested by "+("init"===messageData.type?"host page":"iFrame")),getPagePosition(messageData.id),syncResize(reset,messageData,"reset")}function setSize(messageData){function setDimension(dimension){messageData.iframe.style[dimension]=messageData[dimension]+"px",log(messageData.id,"IFrame ("+iframeId+") "+dimension+" set to "+messageData[dimension]+"px")}function chkZero(dimension){hiddenCheckEnabled||"0"!==messageData[dimension]||(hiddenCheckEnabled=!0,log(iframeId,"Hidden iFrame detected, creating visibility listener"),fixHiddenIFrames())}function processDimension(dimension){setDimension(dimension),chkZero(dimension)}var iframeId=messageData.iframe.id;settings[iframeId]&&(settings[iframeId].sizeHeight&&processDimension("height"),settings[iframeId].sizeWidth&&processDimension("width"))}function syncResize(func,messageData,doNotSync){doNotSync!==messageData.type&&requestAnimationFrame?(log(messageData.id,"Requesting animation frame"),requestAnimationFrame(func)):func()}function trigger(calleeMsg,msg,iframe,id){function postMessageToIFrame(){var target=settings[id].targetOrigin;log(id,"["+calleeMsg+"] Sending msg to iframe["+id+"] ("+msg+") targetOrigin: "+target),iframe.contentWindow.postMessage(msgId+msg,target)}function iFrameNotFound(){info(id,"["+calleeMsg+"] IFrame("+id+") not found"),settings[id]&&delete settings[id]}function chkAndSend(){iframe&&"contentWindow"in iframe&&null!==iframe.contentWindow?postMessageToIFrame():iFrameNotFound()}id=id||iframe.id,settings[id]&&chkAndSend()}function createOutgoingMsg(iframeId){return iframeId+":"+settings[iframeId].bodyMarginV1+":"+settings[iframeId].sizeWidth+":"+settings[iframeId].log+":"+settings[iframeId].interval+":"+settings[iframeId].enablePublicMethods+":"+settings[iframeId].autoResize+":"+settings[iframeId].bodyMargin+":"+settings[iframeId].heightCalculationMethod+":"+settings[iframeId].bodyBackground+":"+settings[iframeId].bodyPadding+":"+settings[iframeId].tolerance+":"+settings[iframeId].inPageLinks+":"+settings[iframeId].resizeFrom+":"+settings[iframeId].widthCalculationMethod}function setupIFrame(iframe,options){function setLimits(){function addStyle(style){1/0!==settings[iframeId][style]&&0!==settings[iframeId][style]&&(iframe.style[style]=settings[iframeId][style]+"px",log(iframeId,"Set "+style+" = "+settings[iframeId][style]+"px"))}function chkMinMax(dimension){if(settings[iframeId]["min"+dimension]>settings[iframeId]["max"+dimension])throw new Error("Value for min"+dimension+" can not be greater than max"+dimension)}chkMinMax("Height"),chkMinMax("Width"),addStyle("maxHeight"),addStyle("minHeight"),addStyle("maxWidth"),addStyle("minWidth")}function newId(){var id=options&&options.id||defaults.id+count++;return null!==document.getElementById(id)&&(id+=count++),id}function ensureHasId(iframeId){return logId=iframeId,""===iframeId&&(iframe.id=iframeId=newId(),logEnabled=(options||{}).log,logId=iframeId,log(iframeId,"Added missing iframe ID: "+iframeId+" ("+iframe.src+")")),iframeId}function setScrolling(){log(iframeId,"IFrame scrolling "+(settings[iframeId].scrolling?"enabled":"disabled")+" for "+iframeId),iframe.style.overflow=!1===settings[iframeId].scrolling?"hidden":"auto",iframe.scrolling=!1===settings[iframeId].scrolling?"no":"yes"}function setupBodyMarginValues(){"number"!=typeof settings[iframeId].bodyMargin&&"0"!==settings[iframeId].bodyMargin||(settings[iframeId].bodyMarginV1=settings[iframeId].bodyMargin,settings[iframeId].bodyMargin=""+settings[iframeId].bodyMargin+"px")}function checkReset(){var firstRun=settings[iframeId].firstRun,resetRequertMethod=settings[iframeId].heightCalculationMethod in resetRequiredMethods;!firstRun&&resetRequertMethod&&resetIFrame({iframe:iframe,height:0,width:0,type:"init"})}function setupIFrameObject(){Function.prototype.bind&&(settings[iframeId].iframe.iFrameResizer={close:closeIFrame.bind(null,settings[iframeId].iframe),resize:trigger.bind(null,"Window resize","resize",settings[iframeId].iframe),moveToAnchor:function(anchor){trigger("Move to anchor","moveToAnchor:"+anchor,settings[iframeId].iframe,iframeId)},sendMessage:function(message){message=JSON.stringify(message),trigger("Send Message","message:"+message,settings[iframeId].iframe,iframeId)}})}function init(msg){function iFrameLoaded(){trigger("iFrame.onload",msg,iframe),checkReset()}addEventListener(iframe,"load",iFrameLoaded),trigger("init",msg,iframe)}function checkOptions(options){if("object"!=typeof options)throw new TypeError("Options is not an object")}function copyOptions(options){for(var option in defaults)defaults.hasOwnProperty(option)&&(settings[iframeId][option]=options.hasOwnProperty(option)?options[option]:defaults[option])}function getTargetOrigin(remoteHost){return""===remoteHost||"file://"===remoteHost?"*":remoteHost}function processOptions(options){options=options||{},settings[iframeId]={firstRun:!0,iframe:iframe,remoteHost:iframe.src.split("/").slice(0,3).join("/")},checkOptions(options),copyOptions(options),settings[iframeId].targetOrigin=!0===settings[iframeId].checkOrigin?getTargetOrigin(settings[iframeId].remoteHost):"*"}function beenHere(){return iframeId in settings&&"iFrameResizer"in iframe}var iframeId=ensureHasId(iframe.id);beenHere()?warn(iframeId,"Ignored iFrame, already setup."):(processOptions(options),setScrolling(),setLimits(),setupBodyMarginValues(),init(createOutgoingMsg(iframeId)),setupIFrameObject())}function debouce(fn,time){null===timer&&(timer=setTimeout(function(){timer=null,fn()},time))}function fixHiddenIFrames(){function checkIFrames(){function checkIFrame(settingId){function chkDimension(dimension){return"0px"===settings[settingId].iframe.style[dimension]}function isVisible(el){return null!==el.offsetParent}isVisible(settings[settingId].iframe)&&(chkDimension("height")||chkDimension("width"))&&trigger("Visibility change","resize",settings[settingId].iframe,settingId)}for(var settingId in settings)checkIFrame(settingId)}function mutationObserved(mutations){log("window","Mutation observed: "+mutations[0].target+" "+mutations[0].type),debouce(checkIFrames,16)}function createMutationObserver(){var target=document.querySelector("body"),config={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},observer=new MutationObserver(mutationObserved);observer.observe(target,config)}var MutationObserver=window.MutationObserver||window.WebKitMutationObserver;MutationObserver&&createMutationObserver()}function resizeIFrames(event){function resize(){sendTriggerMsg("Window "+event,"resize")}log("window","Trigger event: "+event),debouce(resize,16)}function tabVisible(){function resize(){sendTriggerMsg("Tab Visable","resize")}"hidden"!==document.visibilityState&&(log("document","Trigger event: Visiblity change"),debouce(resize,16))}function sendTriggerMsg(eventName,event){function isIFrameResizeEnabled(iframeId){return"parent"===settings[iframeId].resizeFrom&&settings[iframeId].autoResize&&!settings[iframeId].firstRun}for(var iframeId in settings)isIFrameResizeEnabled(iframeId)&&trigger(eventName,event,document.getElementById(iframeId),iframeId)}function setupEventListeners(){addEventListener(window,"message",iFrameListener),addEventListener(window,"resize",function(){resizeIFrames("resize")}),addEventListener(document,"visibilitychange",tabVisible),addEventListener(document,"-webkit-visibilitychange",tabVisible),addEventListener(window,"focusin",function(){resizeIFrames("focus")}),addEventListener(window,"focus",function(){resizeIFrames("focus")})}function factory(){function init(options,element){function chkType(){if(!element.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==element.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+element.tagName+">")}element&&(chkType(),setupIFrame(element,options),iFrames.push(element))}var iFrames;return setupRequestAnimationFrame(),setupEventListeners(),function(options,target){switch(iFrames=[],typeof target){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(target||"iframe"),init.bind(void 0,options));break;case"object":init(options,target);break;default:throw new TypeError("Unexpected data type ("+typeof target+")")}return iFrames}}function createJQueryPublicMethod($){$.fn?$.fn.iFrameResize=function(options){function init(index,element){setupIFrame(element,options)}return this.filter("iframe").each(init).end()}:info("","Unable to bind to jQuery, it is not fully loaded.")}var count=0,logEnabled=!1,hiddenCheckEnabled=!1,msgHeader="message",msgHeaderLen=msgHeader.length,msgId="[iFrameSizer]",msgIdLen=msgId.length,pagePosition=null,requestAnimationFrame=window.requestAnimationFrame,resetRequiredMethods={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},settings={},timer=null,logId="Host Page",defaults={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){warn("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};window.jQuery&&createJQueryPublicMethod(jQuery),"function"==typeof define&&define.amd?define([],factory):"object"==typeof module&&"object"==typeof module.exports?module.exports=factory():window.iFrameResize=window.iFrameResize||factory();
}(window||{}),function(window,undefined){"use strict";function addEventListener(el,evt,func){"addEventListener"in window?el.addEventListener(evt,func,!1):"attachEvent"in window&&el.attachEvent("on"+evt,func)}function removeEventListener(el,evt,func){"removeEventListener"in window?el.removeEventListener(evt,func,!1):"detachEvent"in window&&el.detachEvent("on"+evt,func)}function capitalizeFirstLetter(string){return string.charAt(0).toUpperCase()+string.slice(1)}function throttle(func){var context,args,result,timeout=null,previous=0,later=function(){previous=getNow(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=getNow();previous||(previous=now);var remaining=throttledTimer-(now-previous);return context=this,args=arguments,remaining<=0||remaining>throttledTimer?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||(timeout=setTimeout(later,remaining)),result}}function formatLogMsg(msg){return msgID+"["+myID+"] "+msg}function log(msg){logging&&"object"==typeof window.console&&console.log(formatLogMsg(msg))}function warn(msg){"object"==typeof window.console&&console.warn(formatLogMsg(msg))}function init(){readDataFromParent(),log("Initialising iFrame ("+location.href+")"),readDataFromPage(),setMargin(),setBodyStyle("background",bodyBackground),setBodyStyle("padding",bodyPadding),injectClearFixIntoBodyElement(),checkHeightMode(),checkWidthMode(),stopInfiniteResizingOfIFrame(),setupPublicMethods(),startEventListeners(),inPageLinks=setupInPageLinks(),sendSize("init","Init message from host page"),readyCallback()}function readDataFromParent(){function strBool(str){return"true"===str}var data=initMsg.substr(msgIdLen).split(":");myID=data[0],bodyMargin=undefined!==data[1]?Number(data[1]):bodyMargin,calculateWidth=undefined!==data[2]?strBool(data[2]):calculateWidth,logging=undefined!==data[3]?strBool(data[3]):logging,interval=undefined!==data[4]?Number(data[4]):interval,autoResize=undefined!==data[6]?strBool(data[6]):autoResize,bodyMarginStr=data[7],heightCalcMode=undefined!==data[8]?data[8]:heightCalcMode,bodyBackground=data[9],bodyPadding=data[10],tolerance=undefined!==data[11]?Number(data[11]):tolerance,inPageLinks.enable=undefined!==data[12]&&strBool(data[12]),resizeFrom=undefined!==data[13]?data[13]:resizeFrom,widthCalcMode=undefined!==data[14]?data[14]:widthCalcMode}function readDataFromPage(){function readData(){var data=window.iFrameResizer;log("Reading data from page: "+JSON.stringify(data)),messageCallback="messageCallback"in data?data.messageCallback:messageCallback,readyCallback="readyCallback"in data?data.readyCallback:readyCallback,targetOriginDefault="targetOrigin"in data?data.targetOrigin:targetOriginDefault,heightCalcMode="heightCalculationMethod"in data?data.heightCalculationMethod:heightCalcMode,widthCalcMode="widthCalculationMethod"in data?data.widthCalculationMethod:widthCalcMode}function setupCustomCalcMethods(calcMode,calcFunc){return"function"==typeof calcMode&&(log("Setup custom "+calcFunc+"CalcMethod"),customCalcMethods[calcFunc]=calcMode,calcMode="custom"),calcMode}"iFrameResizer"in window&&Object===window.iFrameResizer.constructor&&(readData(),heightCalcMode=setupCustomCalcMethods(heightCalcMode,"height"),widthCalcMode=setupCustomCalcMethods(widthCalcMode,"width")),log("TargetOrigin for parent set to: "+targetOriginDefault)}function chkCSS(attr,value){return-1!==value.indexOf("-")&&(warn("Negative CSS value ignored for "+attr),value=""),value}function setBodyStyle(attr,value){undefined!==value&&""!==value&&"null"!==value&&(document.body.style[attr]=value,log("Body "+attr+' set to "'+value+'"'))}function setMargin(){undefined===bodyMarginStr&&(bodyMarginStr=bodyMargin+"px"),setBodyStyle("margin",chkCSS("margin",bodyMarginStr))}function stopInfiniteResizingOfIFrame(){document.documentElement.style.height="",document.body.style.height="",log('HTML & body height set to "auto"')}function manageTriggerEvent(options){function handleEvent(){sendSize(options.eventName,options.eventType)}var listener={add:function(eventName){addEventListener(window,eventName,handleEvent)},remove:function(eventName){removeEventListener(window,eventName,handleEvent)}};options.eventNames&&Array.prototype.map?(options.eventName=options.eventNames[0],options.eventNames.map(listener[options.method])):listener[options.method](options.eventName),log(capitalizeFirstLetter(options.method)+" event listener: "+options.eventType)}function manageEventListeners(method){manageTriggerEvent({method:method,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),manageTriggerEvent({method:method,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),manageTriggerEvent({method:method,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),manageTriggerEvent({method:method,eventType:"Input",eventName:"input"}),manageTriggerEvent({method:method,eventType:"Mouse Up",eventName:"mouseup"}),manageTriggerEvent({method:method,eventType:"Mouse Down",eventName:"mousedown"}),manageTriggerEvent({method:method,eventType:"Orientation Change",eventName:"orientationchange"}),manageTriggerEvent({method:method,eventType:"Print",eventName:["afterprint","beforeprint"]}),manageTriggerEvent({method:method,eventType:"Ready State Change",eventName:"readystatechange"}),manageTriggerEvent({method:method,eventType:"Touch Start",eventName:"touchstart"}),manageTriggerEvent({method:method,eventType:"Touch End",eventName:"touchend"}),manageTriggerEvent({method:method,eventType:"Touch Cancel",eventName:"touchcancel"}),manageTriggerEvent({method:method,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),manageTriggerEvent({method:method,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),manageTriggerEvent({method:method,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),"child"===resizeFrom&&manageTriggerEvent({method:method,eventType:"IFrame Resized",eventName:"resize"})}function checkCalcMode(calcMode,calcModeDefault,modes,type){return calcModeDefault!==calcMode&&(calcMode in modes||(warn(calcMode+" is not a valid option for "+type+"CalculationMethod."),calcMode=calcModeDefault),log(type+' calculation method set to "'+calcMode+'"')),calcMode}function checkHeightMode(){heightCalcMode=checkCalcMode(heightCalcMode,heightCalcModeDefault,getHeight,"height")}function checkWidthMode(){widthCalcMode=checkCalcMode(widthCalcMode,widthCalcModeDefault,getWidth,"width")}function startEventListeners(){!0===autoResize?(manageEventListeners("add"),setupMutationObserver()):log("Auto Resize disabled")}function stopMsgsToParent(){log("Disable outgoing messages"),sendPermit=!1}function removeMsgListener(){log("Remove event listener: Message"),removeEventListener(window,"message",receiver)}function disconnectMutationObserver(){null!==bodyObserver&&bodyObserver.disconnect()}function stopEventListeners(){manageEventListeners("remove"),disconnectMutationObserver(),clearInterval(intervalTimer)}function teardown(){stopMsgsToParent(),removeMsgListener(),!0===autoResize&&stopEventListeners()}function injectClearFixIntoBodyElement(){var clearFix=document.createElement("div");clearFix.style.clear="both",clearFix.style.display="block",document.body.appendChild(clearFix)}function setupInPageLinks(){function getPagePosition(){return{x:window.pageXOffset!==undefined?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==undefined?window.pageYOffset:document.documentElement.scrollTop}}function getElementPosition(el){var elPosition=el.getBoundingClientRect(),pagePosition=getPagePosition();return{x:parseInt(elPosition.left,10)+parseInt(pagePosition.x,10),y:parseInt(elPosition.top,10)+parseInt(pagePosition.y,10)}}function findTarget(location){function jumpToTarget(target){var jumpPosition=getElementPosition(target);log("Moving to in page link (#"+hash+") at x: "+jumpPosition.x+" y: "+jumpPosition.y),sendMsg(jumpPosition.y,jumpPosition.x,"scrollToOffset")}var hash=location.split("#")[1]||location,hashData=decodeURIComponent(hash),target=document.getElementById(hashData)||document.getElementsByName(hashData)[0];undefined!==target?jumpToTarget(target):(log("In page link (#"+hash+") not found in iFrame, so sending to parent"),sendMsg(0,0,"inPageLink","#"+hash))}function checkLocationHash(){""!==location.hash&&"#"!==location.hash&&findTarget(location.href)}function bindAnchors(){function setupLink(el){function linkClicked(e){e.preventDefault(),findTarget(this.getAttribute("href"))}"#"!==el.getAttribute("href")&&addEventListener(el,"click",linkClicked)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),setupLink)}function bindLocationHash(){addEventListener(window,"hashchange",checkLocationHash)}function initCheck(){setTimeout(checkLocationHash,eventCancelTimer)}function enableInPageLinks(){Array.prototype.forEach&&document.querySelectorAll?(log("Setting up location.hash handlers"),bindAnchors(),bindLocationHash(),initCheck()):warn("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return inPageLinks.enable?enableInPageLinks():log("In page linking not enabled"),{findTarget:findTarget}}function setupPublicMethods(){log("Enable public methods"),win.parentIFrame={autoResize:function(resize){return!0===resize&&!1===autoResize?(autoResize=!0,startEventListeners()):!1===resize&&!0===autoResize&&(autoResize=!1,stopEventListeners()),autoResize},close:function(){sendMsg(0,0,"close"),teardown()},getId:function(){return myID},getPageInfo:function(callback){"function"==typeof callback?(pageInfoCallback=callback,sendMsg(0,0,"pageInfo")):(pageInfoCallback=function(){},sendMsg(0,0,"pageInfoStop"))},moveToAnchor:function(hash){inPageLinks.findTarget(hash)},reset:function(){resetIFrame("parentIFrame.reset")},scrollTo:function(x,y){sendMsg(y,x,"scrollTo")},scrollToOffset:function(x,y){sendMsg(y,x,"scrollToOffset")},sendMessage:function(msg,targetOrigin){sendMsg(0,0,"message",JSON.stringify(msg),targetOrigin)},setHeightCalculationMethod:function(heightCalculationMethod){heightCalcMode=heightCalculationMethod,checkHeightMode()},setWidthCalculationMethod:function(widthCalculationMethod){widthCalcMode=widthCalculationMethod,checkWidthMode()},setTargetOrigin:function(targetOrigin){log("Set targetOrigin: "+targetOrigin),targetOriginDefault=targetOrigin},size:function(customHeight,customWidth){var valString=""+(customHeight?customHeight:"")+(customWidth?","+customWidth:"");sendSize("size","parentIFrame.size("+valString+")",customHeight,customWidth)}}}function initInterval(){0!==interval&&(log("setInterval: "+interval+"ms"),intervalTimer=setInterval(function(){sendSize("interval","setInterval: "+interval)},Math.abs(interval)))}function setupBodyMutationObserver(){function addImageLoadListners(mutation){function addImageLoadListener(element){!1===element.complete&&(log("Attach listeners to "+element.src),element.addEventListener("load",imageLoaded,!1),element.addEventListener("error",imageError,!1),elements.push(element))}"attributes"===mutation.type&&"src"===mutation.attributeName?addImageLoadListener(mutation.target):"childList"===mutation.type&&Array.prototype.forEach.call(mutation.target.querySelectorAll("img"),addImageLoadListener)}function removeFromArray(element){elements.splice(elements.indexOf(element),1)}function removeImageLoadListener(element){log("Remove listeners from "+element.src),element.removeEventListener("load",imageLoaded,!1),element.removeEventListener("error",imageError,!1),removeFromArray(element)}function imageEventTriggered(event,type,typeDesc){removeImageLoadListener(event.target),sendSize(type,typeDesc+": "+event.target.src,undefined,undefined)}function imageLoaded(event){imageEventTriggered(event,"imageLoad","Image loaded")}function imageError(event){imageEventTriggered(event,"imageLoadFailed","Image load failed")}function mutationObserved(mutations){sendSize("mutationObserver","mutationObserver: "+mutations[0].target+" "+mutations[0].type),mutations.forEach(addImageLoadListners)}function createMutationObserver(){var target=document.querySelector("body"),config={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};return observer=new MutationObserver(mutationObserved),log("Create body MutationObserver"),observer.observe(target,config),observer}var elements=[],MutationObserver=window.MutationObserver||window.WebKitMutationObserver,observer=createMutationObserver();return{disconnect:function(){"disconnect"in observer&&(log("Disconnect body MutationObserver"),observer.disconnect(),elements.forEach(removeImageLoadListener))}}}function setupMutationObserver(){var forceIntervalTimer=0>interval;window.MutationObserver||window.WebKitMutationObserver?forceIntervalTimer?initInterval():bodyObserver=setupBodyMutationObserver():(log("MutationObserver not supported in this browser!"),initInterval())}function getComputedStyle(prop,el){function convertUnitsToPxForIE8(value){var PIXEL=/^\d+(px)?$/i;if(PIXEL.test(value))return parseInt(value,base);var style=el.style.left,runtimeStyle=el.runtimeStyle.left;return el.runtimeStyle.left=el.currentStyle.left,el.style.left=value||0,value=el.style.pixelLeft,el.style.left=style,el.runtimeStyle.left=runtimeStyle,value}var retVal=0;return el=el||document.body,"defaultView"in document&&"getComputedStyle"in document.defaultView?(retVal=document.defaultView.getComputedStyle(el,null),retVal=null!==retVal?retVal[prop]:0):retVal=convertUnitsToPxForIE8(el.currentStyle[prop]),parseInt(retVal,base)}function chkEventThottle(timer){timer>throttledTimer/2&&(throttledTimer=2*timer,log("Event throttle increased to "+throttledTimer+"ms"))}function getMaxElement(side,elements){for(var elementsLength=elements.length,elVal=0,maxVal=0,Side=capitalizeFirstLetter(side),timer=getNow(),i=0;i<elementsLength;i++)elVal=elements[i].getBoundingClientRect()[side]+getComputedStyle("margin"+Side,elements[i]),elVal>maxVal&&(maxVal=elVal);return timer=getNow()-timer,log("Parsed "+elementsLength+" HTML elements"),log("Element position calculated in "+timer+"ms"),chkEventThottle(timer),maxVal}function getAllMeasurements(dimention){return[dimention.bodyOffset(),dimention.bodyScroll(),dimention.documentElementOffset(),dimention.documentElementScroll()]}function getTaggedElements(side,tag){function noTaggedElementsFound(){return warn("No tagged elements ("+tag+") found on page"),height}var elements=document.querySelectorAll("["+tag+"]");return 0===elements.length?noTaggedElementsFound():getMaxElement(side,elements)}function getAllElements(){return document.querySelectorAll("body *")}function sizeIFrame(triggerEvent,triggerEventDesc,customHeight,customWidth){function resizeIFrame(){height=currentHeight,width=currentWidth,sendMsg(height,width,triggerEvent)}function isSizeChangeDetected(){function checkTolarance(a,b){var retVal=Math.abs(a-b)<=tolerance;return!retVal}return currentHeight=undefined!==customHeight?customHeight:getHeight[heightCalcMode](),currentWidth=undefined!==customWidth?customWidth:getWidth[widthCalcMode](),checkTolarance(height,currentHeight)||calculateWidth&&checkTolarance(width,currentWidth)}function isForceResizableEvent(){return!(triggerEvent in{init:1,interval:1,size:1})}function isForceResizableCalcMode(){return heightCalcMode in resetRequiredMethods||calculateWidth&&widthCalcMode in resetRequiredMethods}function logIgnored(){log("No change in size detected")}function checkDownSizing(){isForceResizableEvent()&&isForceResizableCalcMode()?resetIFrame(triggerEventDesc):triggerEvent in{interval:1}||logIgnored()}var currentHeight,currentWidth;isSizeChangeDetected()||"init"===triggerEvent?(lockTrigger(),resizeIFrame()):checkDownSizing()}function sendSize(triggerEvent,triggerEventDesc,customHeight,customWidth){function recordTrigger(){triggerEvent in{reset:1,resetPage:1,init:1}||log("Trigger event: "+triggerEventDesc)}function isDoubleFiredEvent(){return triggerLocked&&triggerEvent in doubleEventList}isDoubleFiredEvent()?log("Trigger event cancelled: "+triggerEvent):(recordTrigger(),sizeIFrameThrottled(triggerEvent,triggerEventDesc,customHeight,customWidth))}function lockTrigger(){triggerLocked||(triggerLocked=!0,log("Trigger event lock on")),clearTimeout(triggerLockedTimer),triggerLockedTimer=setTimeout(function(){triggerLocked=!1,log("Trigger event lock off"),log("--")},eventCancelTimer)}function triggerReset(triggerEvent){height=getHeight[heightCalcMode](),width=getWidth[widthCalcMode](),sendMsg(height,width,triggerEvent)}function resetIFrame(triggerEventDesc){var hcm=heightCalcMode;heightCalcMode=heightCalcModeDefault,log("Reset trigger event: "+triggerEventDesc),lockTrigger(),triggerReset("reset"),heightCalcMode=hcm}function sendMsg(height,width,triggerEvent,msg,targetOrigin){function setTargetOrigin(){undefined===targetOrigin?targetOrigin=targetOriginDefault:log("Message targetOrigin: "+targetOrigin)}function sendToParent(){var size=height+":"+width,message=myID+":"+size+":"+triggerEvent+(undefined!==msg?":"+msg:"");log("Sending message to host page ("+message+")"),target.postMessage(msgID+message,targetOrigin)}!0===sendPermit&&(setTargetOrigin(),sendToParent())}function receiver(event){function isMessageForUs(){return msgID===(""+event.data).substr(0,msgIdLen)}function initFromParent(){function fireInit(){initMsg=event.data,target=event.source,init(),firstRun=!1,setTimeout(function(){initLock=!1},eventCancelTimer)}document.body?fireInit():(log("Waiting for page ready"),addEventListener(window,"readystatechange",initFromParent))}function resetFromParent(){initLock?log("Page reset ignored by init"):(log("Page size reset by host page"),triggerReset("resetPage"))}function resizeFromParent(){sendSize("resizeParent","Parent window requested size check")}function moveToAnchor(){var anchor=getData();inPageLinks.findTarget(anchor)}function getMessageType(){return event.data.split("]")[1].split(":")[0]}function getData(){return event.data.substr(event.data.indexOf(":")+1)}function isMiddleTier(){return"iFrameResize"in window}function messageFromParent(){var msgBody=getData();log("MessageCallback called from parent: "+msgBody),messageCallback(JSON.parse(msgBody)),log(" --")}function pageInfoFromParent(){var msgBody=getData();log("PageInfoFromParent called from parent: "+msgBody),pageInfoCallback(JSON.parse(msgBody)),log(" --")}function isInitMsg(){return event.data.split(":")[2]in{"true":1,"false":1}}function callFromParent(){switch(getMessageType()){case"reset":resetFromParent();break;case"resize":resizeFromParent();break;case"inPageLink":case"moveToAnchor":moveToAnchor();break;case"message":messageFromParent();break;case"pageInfo":pageInfoFromParent();break;default:isMiddleTier()||isInitMsg()||warn("Unexpected message ("+event.data+")")}}function processMessage(){!1===firstRun?callFromParent():isInitMsg()?initFromParent():log('Ignored message of type "'+getMessageType()+'". Received before initialization.')}isMessageForUs()&&processMessage()}function chkLateLoaded(){"loading"!==document.readyState&&window.parent.postMessage("[iFrameResizerChild]Ready","*")}var autoResize=!0,base=10,bodyBackground="",bodyMargin=0,bodyMarginStr="",bodyObserver=null,bodyPadding="",calculateWidth=!1,doubleEventList={resize:1,click:1},eventCancelTimer=128,firstRun=!0,height=1,heightCalcModeDefault="bodyOffset",heightCalcMode=heightCalcModeDefault,initLock=!0,initMsg="",inPageLinks={},interval=32,intervalTimer=null,logging=!1,msgID="[iFrameSizer]",msgIdLen=msgID.length,myID="",resetRequiredMethods={max:1,min:1,bodyScroll:1,documentElementScroll:1},resizeFrom="child",sendPermit=!0,target=window.parent,targetOriginDefault="*",tolerance=0,triggerLocked=!1,triggerLockedTimer=null,throttledTimer=16,width=1,widthCalcModeDefault="scroll",widthCalcMode=widthCalcModeDefault,win=window,messageCallback=function(){warn("MessageCallback function not defined")},readyCallback=function(){},pageInfoCallback=function(){},customCalcMethods={height:function(){return warn("Custom height calculation function not defined"),document.documentElement.offsetHeight},width:function(){return warn("Custom width calculation function not defined"),document.body.scrollWidth}},getNow=Date.now||function(){return(new Date).getTime()},getHeight={bodyOffset:function(){return document.body.offsetHeight+getComputedStyle("marginTop")+getComputedStyle("marginBottom")},offset:function(){return getHeight.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},custom:function(){return customCalcMethods.height()},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,getAllMeasurements(getHeight))},min:function(){return Math.min.apply(null,getAllMeasurements(getHeight))},grow:function(){return getHeight.max()},lowestElement:function(){return Math.max(getHeight.bodyOffset(),getMaxElement("bottom",getAllElements()))},taggedElement:function(){return getTaggedElements("bottom","data-iframe-height")}},getWidth={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},custom:function(){return customCalcMethods.width()},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(getWidth.bodyScroll(),getWidth.documentElementScroll())},max:function(){return Math.max.apply(null,getAllMeasurements(getWidth))},min:function(){return Math.min.apply(null,getAllMeasurements(getWidth))},rightMostElement:function(){return getMaxElement("right",getAllElements())},taggedElement:function(){return getTaggedElements("right","data-iframe-width")}},sizeIFrameThrottled=throttle(sizeIFrame);addEventListener(window,"message",receiver),chkLateLoaded()}(window||{}),function(){function bindMapEvents(scope,eventsStr,googleObject,element){angular.forEach(eventsStr.split(" "),function(eventName){window.google.maps.event.addListener(googleObject,eventName,function(event){element.triggerHandler("map-"+eventName,event),scope.$$phase||scope.$apply()})})}function mapOverlayDirective(directiveName,events){app.directive(directiveName,[function(){return{restrict:"A",link:function(scope,elm,attrs){scope.$watch(attrs[directiveName],function(newObject){newObject&&bindMapEvents(scope,events,newObject,elm)})}}}])}var app=angular.module("ui.map",["ui.event"]);app.value("uiMapConfig",{}).directive("uiMap",["uiMapConfig","$parse",function(uiMapConfig,$parse){var mapEvents="bounds_changed center_changed click dblclick drag dragend dragstart heading_changed idle maptypeid_changed mousemove mouseout mouseover projection_changed resize rightclick tilesloaded tilt_changed zoom_changed",options=uiMapConfig||{};return{restrict:"A",link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions)),map=new window.google.maps.Map(elm[0],opts),model=$parse(attrs.uiMap);model.assign(scope,map),bindMapEvents(scope,mapEvents,map,elm)}}}]),app.value("uiMapInfoWindowConfig",{}).directive("uiMapInfoWindow",["uiMapInfoWindowConfig","$parse","$compile",function(uiMapInfoWindowConfig,$parse,$compile){var infoWindowEvents="closeclick content_change domready position_changed zindex_changed",options=uiMapInfoWindowConfig||{};return{link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions));opts.content=elm[0];var model=$parse(attrs.uiMapInfoWindow),infoWindow=model(scope);infoWindow||(infoWindow=new window.google.maps.InfoWindow(opts),model.assign(scope,infoWindow)),bindMapEvents(scope,infoWindowEvents,infoWindow,elm),elm.replaceWith("<div></div>");var _open=infoWindow.open;infoWindow.open=function(a1,a2,a3,a4,a5,a6){$compile(elm.contents())(scope),_open.call(infoWindow,a1,a2,a3,a4,a5,a6)}}}}]),mapOverlayDirective("uiMapMarker","animation_changed click clickable_changed cursor_changed dblclick drag dragend draggable_changed dragstart flat_changed icon_changed mousedown mouseout mouseover mouseup position_changed rightclick shadow_changed shape_changed title_changed visible_changed zindex_changed"),mapOverlayDirective("uiMapPolyline","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapPolygon","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapRectangle","bounds_changed click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapCircle","center_changed click dblclick mousedown mousemove mouseout mouseover mouseup radius_changed rightclick"),mapOverlayDirective("uiMapGroundOverlay","click dblclick")}(),function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){function $translateCookieStorageFactory($cookieStore){"use strict";var $translateCookieStorage={get:function(name){return $cookieStore.get(name)},set:function(name,value){$cookieStore.put(name,value)},put:function(name,value){$cookieStore.put(name,value)}};return $translateCookieStorage}return $translateCookieStorageFactory.$inject=["$cookieStore"],angular.module("pascalprecht.translate").factory("$translateCookieStorage",$translateCookieStorageFactory),$translateCookieStorageFactory.displayName="$translateCookieStorage","pascalprecht.translate"}),function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():factory()}(this,function(){function $translateLocalStorageFactory($window,$translateCookieStorage){"use strict";var localStorageAdapter=function(){var langKey;return{get:function(name){return langKey||(langKey=$window.localStorage.getItem(name)),langKey},set:function(name,value){langKey=value,$window.localStorage.setItem(name,value)},put:function(name,value){langKey=value,$window.localStorage.setItem(name,value)}}}(),hasLocalStorageSupport="localStorage"in $window;if(hasLocalStorageSupport){var testKey="pascalprecht.translate.storageTest";try{null!==$window.localStorage?($window.localStorage.setItem(testKey,"foo"),$window.localStorage.removeItem(testKey),hasLocalStorageSupport=!0):hasLocalStorageSupport=!1}catch(e){hasLocalStorageSupport=!1}}var $translateLocalStorage=hasLocalStorageSupport?localStorageAdapter:$translateCookieStorage;return $translateLocalStorage}return $translateLocalStorageFactory.$inject=["$window","$translateCookieStorage"],angular.module("pascalprecht.translate").factory("$translateLocalStorage",$translateLocalStorageFactory),$translateLocalStorageFactory.displayName="$translateLocalStorageFactory","pascalprecht.translate"});var deps=[];try{angular.module("ngSanitize"),deps.push("ngSanitize")}catch(e){}try{angular.module("ui.sortable"),deps.push("ui.sortable")}catch(e){}try{angular.module("angularSpectrumColorpicker"),deps.push("angularSpectrumColorpicker")}catch(e){}angular.module("schemaForm",deps),angular.module("schemaForm").provider("sfPath",[function(){var sfPath={parse:ObjectPath.parse};1===angular.version.major&&angular.version.minor<3?sfPath.stringify=function(arr){return Array.isArray(arr)?arr.join("."):arr.toString()}:sfPath.stringify=ObjectPath.stringify,sfPath.normalize=function(data,quote){return sfPath.stringify(Array.isArray(data)?data:sfPath.parse(data),quote)},this.parse=sfPath.parse,this.stringify=sfPath.stringify,this.normalize=sfPath.normalize,this.$get=function(){return sfPath}}]),angular.module("schemaForm").factory("sfSelect",["sfPath",function(sfPath){var numRe=/^\d+$/;return function(projection,obj,valueToSet){obj||(obj=this);var parts="string"==typeof projection?sfPath.parse(projection):projection;if("undefined"!=typeof valueToSet&&1===parts.length)return obj[parts[0]]=valueToSet,obj;"undefined"!=typeof valueToSet&&"undefined"==typeof obj[parts[0]]&&(obj[parts[0]]=parts.length>2&&numRe.test(parts[1])?[]:{});for(var value=obj[parts[0]],i=1;i<parts.length;i++){if(""===parts[i])return;if("undefined"!=typeof valueToSet){if(i===parts.length-1)return value[parts[i]]=valueToSet,valueToSet;var tmp=value[parts[i]];"undefined"!=typeof tmp&&null!==tmp||(tmp=numRe.test(parts[i+1])?[]:{},value[parts[i]]=tmp),value=tmp}else value&&(value=value[parts[i]])}return value}}]),angular.module("schemaForm").provider("schemaFormDecorators",["$compileProvider","sfPathProvider",function($compileProvider,sfPathProvider){var defaultDecorator="",directives={},templateUrl=function(name,form){"sfDecorator"===name&&(name=defaultDecorator);for(var directive=directives[name],rules=directive.rules,i=0;i<rules.length;i++){var res=rules[i](form);if(res)return res}return directive.mappings[form.type]?directive.mappings[form.type]:directive.mappings["default"]},createDirective=function(name){$compileProvider.directive(name,["$parse","$compile","$http","$templateCache",function($parse,$compile,$http,$templateCache){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"?^sfSchema",link:function(scope,element,attrs,sfSchema){scope.showTitle=function(){return scope.form&&scope.form.notitle!==!0&&scope.form.title},scope.listToCheckboxValues=function(list){var values={};return angular.forEach(list,function(v){values[v]=!0}),values},scope.checkboxValuesToList=function(values){var lst=[];return angular.forEach(values,function(v,k){v&&lst.push(k)}),lst},scope.buttonClick=function($event,form){angular.isFunction(form.onClick)?form.onClick($event,form):angular.isString(form.onClick)&&(sfSchema?sfSchema.evalInParentScope(form.onClick,{$event:$event,form:form}):scope.$eval(form.onClick,{$event:$event,form:form}))},scope.evalExpr=function(expression,locals){return sfSchema?sfSchema.evalInParentScope(expression,locals):scope.$eval(expression,locals)},scope.evalInScope=function(expression,locals){if(expression)return scope.$eval(expression,locals)},scope.errorMessage=function(schemaError){return scope.form.validationMessage?schemaError?angular.isString(scope.form.validationMessage)?scope.form.validationMessage:scope.form.validationMessage[schemaError.code]||scope.form.validationMessage["default"]:scope.form.validationMessage.number||scope.form.validationMessage["default"]||scope.form.validationMessage:schemaError?schemaError.message:"Not a number"};var once=scope.$watch(attrs.form,function(form){if(form){form.ngModelOptions=form.ngModelOptions||{},scope.form=form;var url=templateUrl(name,form);$http.get(url,{cache:$templateCache}).then(function(res){var key=form.key?sfPathProvider.stringify(form.key).replace(/"/g,"&quot;"):"",template=res.data.replace(/\$\$value\$\$/g,"model"+("["!==key[0]?".":"")+key);element.html(template),form.condition&&angular.forEach(element.children(),function(child){var ngIf=child.getAttribute("ng-if");child.setAttribute("ng-if",ngIf?"("+ngIf+') || (evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex }))':'evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex })')}),$compile(element.contents())(scope)}),once()}})}}}])},createManualDirective=function(type,templateUrl,transclude){transclude=!!angular.isDefined(transclude)&&transclude,$compileProvider.directive("sf"+angular.uppercase(type[0])+type.substr(1),function(){return{restrict:"EAC",scope:!0,replace:!0,transclude:transclude,template:'<sf-decorator form="form"></sf-decorator>',link:function(scope,element,attrs){var watchThis={items:"c",titleMap:"c",schema:"c"},form={type:type},once=!0;angular.forEach(attrs,function(value,name){if("$"!==name[0]&&0!==name.indexOf("ng")&&"sfField"!==name){
var updateForm=function(val){angular.isDefined(val)&&val!==form[name]&&(form[name]=val,once&&form.type&&(form.key||angular.isUndefined(attrs.key))&&(scope.form=form,once=!1))};"model"===name?scope.$watch(value,function(val){val&&scope.model!==val&&(scope.model=val)}):"c"===watchThis[name]?scope.$watchCollection(value,updateForm):attrs.$observe(name,updateForm)}})}}})};this.createDecorator=function(name,mappings,rules){directives[name]={mappings:mappings||{},rules:rules||[]},directives[defaultDecorator]||(defaultDecorator=name),createDirective(name)},this.createDirective=createManualDirective,this.createDirectives=function(mappings){angular.forEach(mappings,function(url,type){createManualDirective(type,url)})},this.directive=function(name){return name=name||defaultDecorator,directives[name]},this.addMapping=function(name,type,url){directives[name]&&(directives[name].mappings[type]=url)},this.$get=function(){return{directive:function(name){return directives[name]},defaultDecorator:defaultDecorator}},createDirective("sfDecorator")}]),angular.module("schemaForm").provider("schemaForm",["sfPathProvider",function(sfPathProvider){var enumToTitleMap=function(enm){var titleMap=[];return enm.forEach(function(name){titleMap.push({name:name,value:name})}),titleMap},canonicalTitleMap=function(titleMap,originalEnum){if(!angular.isArray(titleMap)){var canonical=[];return originalEnum?angular.forEach(originalEnum,function(value,index){canonical.push({name:titleMap[value],value:value})}):angular.forEach(titleMap,function(name,value){canonical.push({name:name,value:value})}),canonical}return titleMap},defaultFormDefinition=function(name,schema,options){var rules=defaults[schema.type];if(rules)for(var def,i=0;i<rules.length;i++)if(def=rules[i](name,schema,options))return def.schema["x-schema-form"]&&angular.isObject(def.schema["x-schema-form"])&&(def=angular.extend(def,def.schema["x-schema-form"])),def},stdFormObj=function(name,schema,options){options=options||{};var f=options.global&&options.global.formDefaults?angular.copy(options.global.formDefaults):{};return options.global&&options.global.supressPropertyTitles===!0?f.title=schema.title:f.title=schema.title||name,schema.description&&(f.description=schema.description),options.required!==!0&&schema.required!==!0||(f.required=!0),schema.maxLength&&(f.maxlength=schema.maxLength),schema.minLength&&(f.minlength=schema.maxLength),(schema.readOnly||schema.readonly)&&(f.readonly=!0),schema.minimum&&(f.minimum=schema.minimum+(schema.exclusiveMinimum?1:0)),schema.maximum&&(f.maximum=schema.maximum-(schema.exclusiveMaximum?1:0)),schema.validationMessage&&(f.validationMessage=schema.validationMessage),schema.enumNames&&(f.titleMap=canonicalTitleMap(schema.enumNames,schema["enum"])),f.schema=schema,f.ngModelOptions=f.ngModelOptions||{},f},text=function(name,schema,options){if("string"===schema.type&&!schema["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="text",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},number=function(name,schema,options){if("number"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="number",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},integer=function(name,schema,options){if("integer"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="number",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},checkbox=function(name,schema,options){if("boolean"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="checkbox",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},select=function(name,schema,options){if("string"===schema.type&&schema["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="select",f.titleMap||(f.titleMap=enumToTitleMap(schema["enum"])),options.lookup[sfPathProvider.stringify(options.path)]=f,f}},checkboxes=function(name,schema,options){if("array"===schema.type&&schema.items&&schema.items["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="checkboxes",f.titleMap||(f.titleMap=enumToTitleMap(schema.items["enum"])),options.lookup[sfPathProvider.stringify(options.path)]=f,f}},fieldset=function(name,schema,options){if("object"===schema.type){var f=stdFormObj(name,schema,options);return f.type="fieldset",f.items=[],options.lookup[sfPathProvider.stringify(options.path)]=f,angular.forEach(schema.properties,function(v,k){var path=options.path.slice();if(path.push(k),options.ignore[sfPathProvider.stringify(path)]!==!0){var required=schema.required&&schema.required.indexOf(k)!==-1,def=defaultFormDefinition(k,v,{path:path,required:required||!1,lookup:options.lookup,ignore:options.ignore});def&&f.items.push(def)}}),f}},array=function(name,schema,options){if("array"===schema.type){var f=stdFormObj(name,schema,options);f.type="array",f.key=options.path,options.lookup[sfPathProvider.stringify(options.path)]=f;var required=schema.required&&schema.required.indexOf(options.path[options.path.length-1])!==-1,arrPath=options.path.slice();return arrPath.push(""),f.items=[defaultFormDefinition(name,schema.items,{path:arrPath,required:required||!1,lookup:options.lookup,ignore:options.ignore,global:options.global})],f}},defaults={string:[select,text],object:[fieldset],number:[number],integer:[integer],"boolean":[checkbox],array:[checkboxes,array]},postProcessFn=function(form){return form};this.defaults=defaults,this.stdFormObj=stdFormObj,this.defaultFormDefinition=defaultFormDefinition,this.postProcess=function(fn){postProcessFn=fn},this.appendRule=function(type,rule){defaults[type]||(defaults[type]=[]),defaults[type].push(rule)},this.prependRule=function(type,rule){defaults[type]||(defaults[type]=[]),defaults[type].unshift(rule)},this.createStandardForm=stdFormObj,this.$get=function(){var service={};return service.merge=function(schema,form,ignore,options,readonly){form=form||["*"],options=options||{},readonly=readonly||schema.readonly||schema.readOnly;var stdForm=service.defaults(schema,ignore,options),idx=form.indexOf("*");idx!==-1&&(form=form.slice(0,idx).concat(stdForm.form).concat(form.slice(idx+1)));var lookup=stdForm.lookup;return postProcessFn(form.map(function(obj){if("string"==typeof obj&&(obj={key:obj}),obj.key&&"string"==typeof obj.key&&(obj.key=sfPathProvider.parse(obj.key)),obj.titleMap&&(obj.titleMap=canonicalTitleMap(obj.titleMap)),obj.itemForm){obj.items=[];var str=sfPathProvider.stringify(obj.key),stdForm=lookup[str];angular.forEach(stdForm.items,function(item){var o=angular.copy(obj.itemForm);o.key=item.key,obj.items.push(o)})}if(obj.key){var strid=sfPathProvider.stringify(obj.key);lookup[strid]&&(obj=angular.extend(lookup[strid],obj))}return readonly===!0&&(obj.readonly=!0),obj.items&&(obj.items=service.merge(schema,obj.items,ignore,options,obj.readonly)),obj.tabs&&angular.forEach(obj.tabs,function(tab){tab.items=service.merge(schema,tab.items,ignore,options,obj.readonly)}),"checkbox"===obj.type&&angular.isUndefined(obj.schema["default"])&&(obj.schema["default"]=!1),obj}))},service.defaults=function(schema,ignore,globalOptions){var form=[],lookup={};if(ignore=ignore||{},globalOptions=globalOptions||{},"object"!==schema.type)throw new Error('Not implemented. Only type "object" allowed at root level of schema.');return angular.forEach(schema.properties,function(v,k){if(ignore[k]!==!0){var required=schema.required&&schema.required.indexOf(k)!==-1,def=defaultFormDefinition(k,v,{path:[k],lookup:lookup,ignore:ignore,required:required,global:globalOptions});def&&form.push(def)}}),{form:form,lookup:lookup}},service.traverseSchema=function(schema,fn,path,ignoreArrays){ignoreArrays=!angular.isDefined(ignoreArrays)||ignoreArrays,path=path||[];var traverse=function(schema,fn,path){if(fn(schema,path),angular.forEach(schema.properties,function(prop,name){var currentPath=path.slice();currentPath.push(name),traverse(prop,fn,currentPath)}),!ignoreArrays&&schema.items){var arrPath=path.slice();arrPath.push(""),traverse(schema.items,fn,arrPath)}};traverse(schema,fn,path||[])},service.traverseForm=function(form,fn){fn(form),angular.forEach(form.items,function(f){service.traverseForm(f,fn)}),form.tabs&&angular.forEach(form.tabs,function(tab){angular.forEach(tab.items,function(f){service.traverseForm(f,fn)})})},service}}]),angular.module("schemaForm").factory("sfValidator",[function(){var validator={};return validator.validate=function(form,value){if(!form)return{valid:!0};var schema=form.schema;if(!schema)return{valid:!0};""===value&&(value=void 0),"number"===form.type&&null===value&&(value=void 0);var wrap={type:"object",properties:{}},propName=form.key[form.key.length-1];wrap.properties[propName]=schema,form.required&&(wrap.required=[propName]);var valueWrap={};return angular.isDefined(value)&&(valueWrap[propName]=value),tv4.validateResult(valueWrap,wrap)},validator}]),angular.module("schemaForm").directive("sfArray",["sfSelect","schemaForm","sfValidator","sfPath",function(sfSelect,schemaForm,sfValidator,sfPath){var setIndex=function(index){return function(form){form.key&&(form.key[form.key.indexOf("")]=index)}};return{restrict:"A",scope:!0,require:"?ngModel",link:function(scope,element,attrs,ngModel){var formDefCache={},once=scope.$watch(attrs.sfArray,function(form){var list=sfSelect(form.key,scope.model);if(scope.$watch("model"+sfPath.normalize(form.key),function(){list=sfSelect(form.key,scope.model),scope.modelArray=list}),angular.isUndefined(list)&&(list=[],sfSelect(form.key,scope.model,list)),scope.modelArray=list,form.items){var subForm=form.items[0];form.items.length>1&&(subForm={type:"section",items:form.items.map(function(item){return item.ngModelOptions=form.ngModelOptions,angular.isUndefined(item.readonly)&&(item.readonly=form.readonly),item})})}if(scope.copyWithIndex=function(index){if(!formDefCache[index]&&subForm){var copy=angular.copy(subForm);copy.arrayIndex=index,schemaForm.traverseForm(copy,setIndex(index)),formDefCache[index]=copy}return formDefCache[index]},scope.appendToArray=function(){var len=list.length,copy=scope.copyWithIndex(len);if(schemaForm.traverseForm(copy,function(part){if(part.key){var def;angular.isDefined(part["default"])&&(def=part["default"]),angular.isDefined(part.schema)&&angular.isDefined(part.schema["default"])&&(def=part.schema["default"]),angular.isDefined(def)&&sfSelect(part.key,scope.model,def)}}),len===list.length){var dflt,type=sfSelect("schema.items.type",form);"object"===type?dflt={}:"array"===type&&(dflt=[]),list.push(dflt)}return scope.validateArray&&scope.validateArray(),list},scope.deleteFromArray=function(index){return list.splice(index,1),scope.validateArray&&scope.validateArray(),ngModel&&ngModel.$setDirty&&ngModel.$setDirty(),list},form.titleMap||form.startEmpty===!0||0!==list.length||scope.appendToArray(),form.titleMap&&form.titleMap.length>0){scope.titleMapValues=[];var updateTitleMapValues=function(arr){scope.titleMapValues=[],arr=arr||[],form.titleMap.forEach(function(item){scope.titleMapValues.push(arr.indexOf(item.value)!==-1)})};updateTitleMapValues(scope.modelArray),scope.$watchCollection("modelArray",updateTitleMapValues),scope.$watchCollection("titleMapValues",function(vals){if(vals){for(var arr=scope.modelArray;arr.length>0;)arr.pop();form.titleMap.forEach(function(item,index){vals[index]&&arr.push(item.value)})}})}if(ngModel){var error;scope.validateArray=function(){var result=sfValidator.validate(form,scope.modelArray.length>0?scope.modelArray:void 0);result.valid!==!1||!result.error||""!==result.error.dataPath&&result.error.dataPath!=="/"+form.key[form.key.length-1]?ngModel.$setValidity("schema",!0):(ngModel.$setViewValue(scope.modelArray),error=result.error,ngModel.$setValidity("schema",!1))},scope.$on("schemaFormValidate",scope.validateArray),scope.hasSuccess=function(){return ngModel.$valid&&!ngModel.$pristine},scope.hasError=function(){return ngModel.$invalid},scope.schemaError=function(){return error}}once()})}}}]),angular.module("schemaForm").directive("sfChanged",function(){return{require:"ngModel",restrict:"AC",scope:!1,link:function(scope,element,attrs,ctrl){var form=scope.$eval(attrs.sfChanged);form&&form.onChange&&ctrl.$viewChangeListeners.push(function(){angular.isFunction(form.onChange)?form.onChange(ctrl.$modelValue,form):scope.evalExpr(form.onChange,{modelValue:ctrl.$modelValue,form:form})})}}}),angular.module("schemaForm").directive("sfSchema",["$compile","schemaForm","schemaFormDecorators","sfSelect","sfPath",function($compile,schemaForm,schemaFormDecorators,sfSelect,sfPath){var SNAKE_CASE_REGEXP=/[A-Z]/g,snakeCase=function(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})};return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel",options:"=sfOptions"},controller:["$scope",function($scope){this.evalInParentScope=function(expr,locals){return $scope.$parent.$eval(expr,locals)}}],replace:!1,restrict:"A",transclude:!0,require:"?form",link:function(scope,element,attrs,formCtrl,transclude){scope.formCtrl=formCtrl;var ignore={};transclude(scope,function(clone){if(clone.addClass("schema-form-ignore"),element.prepend(clone),element[0].querySelectorAll){var models=element[0].querySelectorAll("[ng-model]");if(models)for(var i=0;i<models.length;i++){var key=models[i].getAttribute("ng-model");ignore[key.substring(key.indexOf(".")+1)]=!0}}});var childScope,lastDigest={},render=function(schema,form){var merged=schemaForm.merge(schema,form,ignore,scope.options),frag=document.createDocumentFragment();childScope&&childScope.$destroy(),childScope=scope.$new(),childScope.schemaForm={form:merged,schema:schema},element.children(":not(.schema-form-ignore)").remove();for(var slots={},slotsFound=element[0].querySelectorAll("*[sf-insert-field]"),i=0;i<slotsFound.length;i++)slots[slotsFound[i].getAttribute("sf-insert-field")]=slotsFound[i];angular.forEach(merged,function(obj,i){var n=document.createElement(attrs.sfDecorator||snakeCase(schemaFormDecorators.defaultDecorator,"-"));if(n.setAttribute("form","schemaForm.form["+i+"]"),obj.key){var slot=slots[sfPath.stringify(obj.key)];if(slot){for(;slot.firstChild;)slot.removeChild(slot.firstChild);return void slot.appendChild(n)}}frag.appendChild(n)}),element[0].appendChild(frag),$compile(element.children())(childScope),schemaForm.traverseSchema(schema,function(prop,path){if(angular.isDefined(prop["default"])){var val=sfSelect(path,scope.model);angular.isUndefined(val)&&sfSelect(path,scope.model,prop["default"])}}),scope.$emit("sf-render-finished",element)};scope.$watch(function(){var schema=scope.schema,form=scope.initialForm||["*"];form&&schema&&schema.type&&(lastDigest.form!==form||lastDigest.schema!==schema)&&Object.keys(schema.properties).length>0&&(lastDigest.schema=schema,lastDigest.form=form,render(schema,form))}),scope.$on("schemaFormRedraw",function(){var schema=scope.schema,form=scope.initialForm||["*"];schema&&render(schema,form)})}}}]),angular.module("schemaForm").directive("schemaValidate",["sfValidator","sfSelect",function(sfValidator,sfSelect){return{restrict:"A",scope:!1,priority:1e3,require:"ngModel",link:function(scope,element,attrs,ngModel){scope.ngModel=ngModel;var error=null,getForm=function(){return form||(form=scope.$eval(attrs.schemaValidate)),form},form=getForm();form.copyValueTo&&ngModel.$viewChangeListeners.push(function(){var paths=form.copyValueTo;angular.forEach(paths,function(path){sfSelect(path,scope.model,ngModel.$modelValue)})}),ngModel.$validators?ngModel.$validators.schema=function(value){var result=sfValidator.validate(getForm(),value);return error=result.error,result.valid}:ngModel.$parsers.push(function(viewValue){if(form=getForm(),!form)return viewValue;var result=sfValidator.validate(form,viewValue);return result.valid?(ngModel.$setValidity("schema",!0),viewValue):(ngModel.$setValidity("schema",!1),void(error=result.error))}),scope.$on("schemaFormValidate",function(){ngModel.$validate?(ngModel.$validate(),ngModel.$invalid&&(ngModel.$dirty=!0,ngModel.$pristine=!1)):ngModel.$setViewValue(ngModel.$viewValue)}),scope.hasSuccess=function(){return ngModel.$valid&&(!ngModel.$pristine||!ngModel.$isEmpty(ngModel.$modelValue))},scope.hasError=function(){return ngModel.$invalid&&!ngModel.$pristine},scope.schemaError=function(){return error}}}}]),angular.module("schemaForm").run(["$templateCache",function($templateCache){$templateCache.put("directives/decorators/bootstrap/actions-trcl.html",'<div class="btn-group schema-form-actions {{form.htmlClass}}" ng-transclude=""></div>'),$templateCache.put("directives/decorators/bootstrap/actions.html",'<div class="btn-group schema-form-actions {{form.htmlClass}}"><input ng-repeat-start="item in form.items" type="submit" class="btn {{ item.style || \'btn-default\' }} {{form.fieldHtmlClass}}" value="{{item.title}}" ng-if="item.type === \'submit\'"> <button ng-repeat-end="" class="btn {{ item.style || \'btn-default\' }} {{form.fieldHtmlClass}}" type="button" ng-disabled="form.readonly" ng-if="item.type !== \'submit\'" ng-click="buttonClick($event,item)">{{item.title}}</button></div>'),$templateCache.put("directives/decorators/bootstrap/array.html",'<div sf-array="form" class="schema-form-array {{form.htmlClass}}" ng-model="$$value$$" ng-model-options="form.ngModelOptions"><h3 ng-show="form.title && form.notitle !== true">{{ form.title }}</h3><ol class="list-group" ng-model="modelArray" ui-sortable=""><li class="list-group-item {{form.fieldHtmlClass}}" ng-repeat="item in modelArray track by $index"><button ng-hide="form.readonly" ng-click="deleteFromArray($index)" style="position: relative; z-index: 20;" type="button" class="close pull-right"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><sf-decorator ng-init="arrayIndex = $index" form="copyWithIndex($index)"></sf-decorator></li></ol><div class="clearfix" style="padding: 15px;"><button ng-hide="form.readonly || form.add === null" ng-click="appendToArray()" type="button" class="btn {{ form.style.add || \'btn-default\' }} pull-right"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</button></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/checkbox.html",'<div class="checkbox schema-form-checkbox {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label><input type="checkbox" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" class="{{form.fieldHtmlClass}}" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="form.title"></span></label><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/checkboxes.html",'<div sf-array="form" ng-model="$$value$$" class="form-group schema-form-checkboxes {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div class="checkbox" ng-repeat="val in titleMapValues track by $index"><label><input type="checkbox" ng-disabled="form.readonly" sf-changed="form" class="{{form.fieldHtmlClass}}" ng-model="titleMapValues[$index]" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="form.titleMap[$index].name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/default.html",'<div class="form-group schema-form-{{form.type}} {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }"><label class="control-label" ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <input ng-show="form.key" type="{{form.type}}" step="any" sf-changed="form" placeholder="{{form.placeholder}}" class="form-control {{form.fieldHtmlClass}}" id="{{form.key.slice(-1)[0]}}" ng-model-options="form.ngModelOptions" ng-model="$$value$$" ng-disabled="form.readonly" schema-validate="form" name="{{form.key.slice(-1)[0]}}" aria-describedby="{{form.key.slice(-1)[0] + \'Status\'}}"> <span ng-if="form.feedback !== false" class="form-control-feedback" ng-class="evalInScope(form.feedback) || {\'glyphicon\': true, \'glyphicon-ok\': hasSuccess(), \'glyphicon-remove\': hasError() }" aria-hidden="true"></span> <span ng-if="hasError() || hasSuccess()" id="{{form.key.slice(-1)[0] + \'Status\'}}" class="sr-only">{{ hasSuccess() ? \'(success)\' : \'(error)\' }}</span><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/fieldset-trcl.html",'<fieldset ng-disabled="form.readonly" class="schema-form-fieldset {{form.htmlClass}}"><legend ng-show="form.title">{{ form.title }}</legend><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div><div ng-transclude=""></div></fieldset>'),$templateCache.put("directives/decorators/bootstrap/fieldset.html",'<fieldset ng-disabled="form.readonly" class="schema-form-fieldset {{form.htmlClass}}"><legend ng-show="form.title">{{ form.title }}</legend><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div><sf-decorator ng-repeat="item in form.items" form="item"></sf-decorator></fieldset>'),$templateCache.put("directives/decorators/bootstrap/help.html",'<div class="helpvalue schema-form-helpvalue {{form.htmlClass}}" ng-bind-html="form.helpvalue"></div>'),$templateCache.put("directives/decorators/bootstrap/radio-buttons.html",'<div class="form-group schema-form-radiobuttons {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><div><label class="control-label" ng-show="showTitle()">{{form.title}}</label></div><div class="btn-group"><label class="btn {{ (item.value === $$value$$) ? form.style.selected || \'btn-default\' : form.style.unselected || \'btn-default\'; }}" ng-class="{ active: item.value === $$value$$ }" ng-repeat="item in form.titleMap"><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" style="display: none;" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/radios-inline.html",'<div class="form-group schema-form-radios-inline {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div><label class="radio-inline" ng-repeat="item in form.titleMap"><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/radios.html",'<div class="form-group schema-form-radios {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div class="radio" ng-repeat="item in form.titleMap"><label><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/readonly.html",'<div class="form-group"><label ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <input ng-if="form.type !== \'textarea\'" type="text" disabled="" class="form-control" id="{{form.key.slice(-1)[0]}}" value="{{$$value$$}}"> <textarea ng-if="form.type === \'textarea\'" disabled="" class="form-control">{{$$value$$}}</textarea><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/section.html",'<div class="schema-form-section {{form.htmlClass}}"><sf-decorator ng-repeat="item in form.items" form="item"></sf-decorator></div>'),$templateCache.put("directives/decorators/bootstrap/select.html",'<div class="form-group {{form.htmlClass}} schema-form-select" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><select ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-disabled="form.readonly" sf-changed="form" class="form-control {{form.fieldHtmlClass}}" schema-validate="form" ng-options="item.value as item.name for item in form.titleMap" name="{{form.key.slice(-1)[0]}}"></select><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/submit.html",'<div class="form-group schema-form-submit {{form.htmlClass}}"><input type="submit" class="btn {{ form.style || \'btn-primary\' }} {{form.fieldHtmlClass}}" value="{{form.title}}" ng-disabled="form.readonly" ng-if="form.type === \'submit\'"> <button class="btn {{ form.style || \'btn-default\' }}" type="button" ng-click="buttonClick($event,form)" ng-disabled="form.readonly" ng-if="form.type !== \'submit\'">{{form.title}}</button></div>'),$templateCache.put("directives/decorators/bootstrap/tabarray.html",'<div sf-array="form" ng-init="selected = { tab: 0 }" class="clearfix schema-form-tabarray schema-form-tabarray-{{form.tabType || \'left\'}} {{form.htmlClass}}"><div ng-if="!form.tabType || form.tabType !== \'right\'" ng-class="{\'col-xs-3\': !form.tabType || form.tabType === \'left\'}"><ul class="nav nav-tabs" ng-class="{ \'tabs-left\': !form.tabType || form.tabType === \'left\'}"><li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{evalExpr(form.title,{\'$index\':$index, value: item}) || $index}}</a></li><li ng-hide="form.readonly" ng-click="$event.preventDefault() || (selected.tab = appendToArray().length - 1)"><a href="#"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</a></li></ul></div><div ng-class="{\'col-xs-9\': !form.tabType || form.tabType === \'left\' || form.tabType === \'right\'}"><div class="tab-content {{form.fieldHtmlClass}}"><div class="tab-pane clearfix" ng-repeat="item in modelArray track by $index" ng-show="selected.tab === $index" ng-class="{active: selected.tab === $index}"><sf-decorator ng-init="arrayIndex = $index" form="copyWithIndex($index)"></sf-decorator><button ng-hide="form.readonly" ng-click="selected.tab = deleteFromArray($index).length - 1" type="button" class="btn {{ form.style.remove || \'btn-default\' }} pull-right"><i class="glyphicon glyphicon-trash"></i> {{ form.remove || \'Remove\'}}</button></div></div></div><div ng-if="form.tabType === \'right\'" class="col-xs-3"><ul class="nav nav-tabs tabs-right"><li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{evalExpr(form.title,{\'$index\':$index, value: item}) || $index}}</a></li><li ng-hide="form.readonly" ng-click="$event.preventDefault() || appendToArray()"><a href="#"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</a></li></ul></div></div>'),$templateCache.put("directives/decorators/bootstrap/tabs.html",'<div ng-init="selected = { tab: 0 }" class="schema-form-tabs {{form.htmlClass}}"><ul class="nav nav-tabs"><li ng-repeat="tab in form.tabs" ng-disabled="form.readonly" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{ tab.title }}</a></li></ul><div class="tab-content {{form.fieldHtmlClass}}"><div class="tab-pane" ng-disabled="form.readonly" ng-repeat="tab in form.tabs" ng-show="selected.tab === $index" ng-class="{active: selected.tab === $index}"><bootstrap-decorator ng-repeat="item in tab.items" form="item"></bootstrap-decorator></div></div></div>'),$templateCache.put("directives/decorators/bootstrap/textarea.html",'<div class="form-group has-feedback {{form.htmlClass}} schema-form-textarea" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <textarea class="form-control {{form.fieldHtmlClass}}" id="{{form.key.slice(-1)[0]}}" sf-changed="form" placeholder="{{form.placeholder}}" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" name="{{form.key.slice(-1)[0]}}"></textarea> <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span></div>')}]),angular.module("schemaForm").config(["schemaFormDecoratorsProvider",function(decoratorsProvider){var base="directives/decorators/bootstrap/";decoratorsProvider.createDecorator("bootstrapDecorator",{textarea:base+"textarea.html",fieldset:base+"fieldset.html",array:base+"array.html",tabarray:base+"tabarray.html",tabs:base+"tabs.html",section:base+"section.html",conditional:base+"section.html",actions:base+"actions.html",select:base+"select.html",checkbox:base+"checkbox.html",checkboxes:base+"checkboxes.html",number:base+"default.html",password:base+"default.html",submit:base+"submit.html",button:base+"submit.html",radios:base+"radios.html","radios-inline":base+"radios-inline.html",radiobuttons:base+"radio-buttons.html",help:base+"help.html","default":base+"default.html"},[]),decoratorsProvider.createDirectives({textarea:base+"textarea.html",select:base+"select.html",checkbox:base+"checkbox.html",checkboxes:base+"checkboxes.html",number:base+"default.html",submit:base+"submit.html",button:base+"submit.html",text:base+"default.html",date:base+"default.html",password:base+"default.html",datepicker:base+"datepicker.html",input:base+"default.html",radios:base+"radios.html","radios-inline":base+"radios-inline.html",radiobuttons:base+"radio-buttons.html"})}]).directive("sfFieldset",function(){return{transclude:!0,scope:!0,templateUrl:"directives/decorators/bootstrap/fieldset-trcl.html",link:function(scope,element,attrs){scope.title=scope.$eval(attrs.title)}}}),!function(a,b){"use strict";var c=a.module("angularSpectrumColorpicker",[]);!function(b){c.directive("spectrumColorpicker",function(){return{restrict:"EA",require:"ngModel",scope:{fallbackValue:"=",disabled:"=?",format:"=?",options:"=?",triggerId:"@?",palette:"=?",onChange:"&?",onShow:"&?",onHide:"&?",onMove:"&?",onBeforeShow:"&?",onChangeOptions:"=?",onShowOptions:"=?",onHideOptions:"=?",onMoveOptions:"=?"},replace:!0,templateUrl:"directive.html",link:function(b,c,d,e){function f(a){
var c=a;return c&&(c=a.toString(b.format)),c}function g(c){a.isFunction(b.onChange)&&b.onChange({color:c})}function h(c){var d=b.fallbackValue;c?d=f(c):a.isUndefined(b.fallbackValue)&&(d=c),e.$setViewValue(d),g(d)}var i=c.find("input"),j=function(a){b.$evalAsync(function(){h(a)})},k=function(){return i.spectrum("toggle"),!1},l={color:e.$viewValue},m={};a.forEach({change:"onChange",move:"onMove",hide:"onHide",show:"onShow"},function(c,d){var e=b[c+"Options"];m[d]=function(d){return(!e||e.update)&&j(d),"change"!==c&&a.isFunction(b[c])?b[c]({color:f(d)}):null}}),a.isFunction(b.onBeforeShow)&&(m.beforeShow=function(a){return b.onBeforeShow({color:f(a)})}),b.palette&&(m.palette=b.palette);var n=a.extend({},l,b.options,m);b.triggerId&&a.element(document.body).on("click","#"+b.triggerId,k),e.$render=function(){i.spectrum("set",e.$viewValue||""),g(e.$viewValue)},n.color&&(i.spectrum("set",n.color||""),h(n.color)),i.spectrum(n),b.$on("$destroy",function(){b.triggerId&&a.element(document.body).off("click","#"+b.triggerId,k)}),c.on("$destroy",function(){i.spectrum("destroy")}),a.isDefined(n.disabled)&&(b.disabled=!!n.disabled),b.$watch("disabled",function(a){i.spectrum(a?"disable":"enable")}),b.$watch("palette",function(a){i.spectrum("option","palette",a)},!0)}}})}(),a.module("angularSpectrumColorpicker").run(["$templateCache",function(a){a.put("directive.html",'<span><input class="input-small"></span>')}])}(window.angular),function(window,angular,undefined){"use strict";(function(){angular.module("uiGmapgoogle-maps.providers",[]),angular.module("uiGmapgoogle-maps.wrapped",[]),angular.module("uiGmapgoogle-maps.extensions",["uiGmapgoogle-maps.wrapped","uiGmapgoogle-maps.providers"]),angular.module("uiGmapgoogle-maps.directives.api.utils",["uiGmapgoogle-maps.extensions"]),angular.module("uiGmapgoogle-maps.directives.api.managers",[]),angular.module("uiGmapgoogle-maps.directives.api.options",["uiGmapgoogle-maps.directives.api.utils"]),angular.module("uiGmapgoogle-maps.directives.api.options.builders",[]),angular.module("uiGmapgoogle-maps.directives.api.models.child",["uiGmapgoogle-maps.directives.api.utils","uiGmapgoogle-maps.directives.api.options","uiGmapgoogle-maps.directives.api.options.builders"]),angular.module("uiGmapgoogle-maps.directives.api.models.parent",["uiGmapgoogle-maps.directives.api.managers","uiGmapgoogle-maps.directives.api.models.child","uiGmapgoogle-maps.providers"]),angular.module("uiGmapgoogle-maps.directives.api",["uiGmapgoogle-maps.directives.api.models.parent"]),angular.module("uiGmapgoogle-maps",["uiGmapgoogle-maps.directives.api","uiGmapgoogle-maps.providers"])}).call(this),function(){angular.module("uiGmapgoogle-maps.providers").factory("uiGmapMapScriptLoader",["$q","uiGmapuuid",function($q,uuid){var getScriptUrl,includeScript,isGoogleMapsLoaded,scriptId;return scriptId=void 0,getScriptUrl=function(options){return options.china?"http://maps.google.cn/maps/api/js?":"auto"===options.transport?"//maps.googleapis.com/maps/api/js?":options.transport+"://maps.googleapis.com/maps/api/js?"},includeScript=function(options){var omitOptions,query,script;return omitOptions=["transport","isGoogleMapsForWork","china"],options.isGoogleMapsForWork&&omitOptions.push("key"),query=_.map(_.omit(options,omitOptions),function(v,k){return k+"="+v}),scriptId&&document.getElementById(scriptId).remove(),query=query.join("&"),script=document.createElement("script"),script.id=scriptId="ui_gmap_map_load_"+uuid.generate(),script.type="text/javascript",script.src=getScriptUrl(options)+query,document.body.appendChild(script)},isGoogleMapsLoaded=function(){return angular.isDefined(window.google)&&angular.isDefined(window.google.maps)},{load:function(options){var deferred,randomizedFunctionName;return deferred=$q.defer(),isGoogleMapsLoaded()?(deferred.resolve(window.google.maps),deferred.promise):(randomizedFunctionName=options.callback="onGoogleMapsReady"+Math.round(1e3*Math.random()),window[randomizedFunctionName]=function(){window[randomizedFunctionName]=null,deferred.resolve(window.google.maps)},window.navigator.connection&&window.Connection&&window.navigator.connection.type===window.Connection.NONE?document.addEventListener("online",function(){if(!isGoogleMapsLoaded())return includeScript(options)}):includeScript(options),deferred.promise)}}}]).provider("uiGmapGoogleMapApi",function(){return this.options={transport:"https",isGoogleMapsForWork:!1,china:!1,v:"3",libraries:"",language:"en",sensor:"false"},this.configure=function(options){angular.extend(this.options,options)},this.$get=["uiGmapMapScriptLoader",function(_this){return function(loader){return loader.load(_this.options)}}(this)],this})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendGWin",function(){return{init:_.once(function(){if(google||("undefined"!=typeof google&&null!==google?google.maps:void 0)||null!=google.maps.InfoWindow)return google.maps.InfoWindow.prototype._open=google.maps.InfoWindow.prototype.open,google.maps.InfoWindow.prototype._close=google.maps.InfoWindow.prototype.close,google.maps.InfoWindow.prototype._isOpen=!1,google.maps.InfoWindow.prototype.open=function(map,anchor,recurse){null==recurse&&(this._isOpen=!0,this._open(map,anchor,!0))},google.maps.InfoWindow.prototype.close=function(recurse){null==recurse&&(this._isOpen=!1,this._close(!0))},google.maps.InfoWindow.prototype.isOpen=function(val){return null==val&&(val=void 0),null==val?this._isOpen:this._isOpen=val},window.InfoBox&&(window.InfoBox.prototype._open=window.InfoBox.prototype.open,window.InfoBox.prototype._close=window.InfoBox.prototype.close,window.InfoBox.prototype._isOpen=!1,window.InfoBox.prototype.open=function(map,anchor){this._isOpen=!0,this._open(map,anchor)},window.InfoBox.prototype.close=function(){this._isOpen=!1,this._close()},window.InfoBox.prototype.isOpen=function(val){return null==val&&(val=void 0),null==val?this._isOpen:this._isOpen=val}),window.MarkerLabel_?window.MarkerLabel_.prototype.setContent=function(){var content;content=this.marker_.get("labelContent"),content&&!_.isEqual(this.oldContent,content)&&("undefined"==typeof(null!=content?content.nodeType:void 0)?(this.labelDiv_.innerHTML=content,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML,this.oldContent=content):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(content),content=content.cloneNode(!0),this.labelDiv_.innerHTML="",this.eventDiv_.appendChild(content),this.oldContent=content))}:void 0})}})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").service("uiGmapLodash",function(){return this.intersectionObjects=function(array1,array2,comparison){var res;return null==comparison&&(comparison=void 0),res=_.map(array1,function(_this){return function(obj1){return _.find(array2,function(obj2){return null!=comparison?comparison(obj1,obj2):_.isEqual(obj1,obj2)})}}(this)),_.filter(res,function(o){return null!=o})},this.containsObject=_.includeObject=function(obj,target,comparison){return null==comparison&&(comparison=void 0),null!==obj&&_.any(obj,function(_this){return function(value){return null!=comparison?comparison(value,target):_.isEqual(value,target)}}(this))},this.differenceObjects=function(array1,array2,comparison){return null==comparison&&(comparison=void 0),_.filter(array1,function(_this){return function(value){return!_this.containsObject(array2,value,comparison)}}(this))},this.withoutObjects=this.differenceObjects,this.indexOfObject=function(array,item,comparison,isSorted){var i,length;if(null==array)return-1;if(i=0,length=array.length,isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=isSorted<0?Math.max(0,length+isSorted):isSorted}for(;i<length;){if(null!=comparison){if(comparison(array[i],item))return i}else if(_.isEqual(array[i],item))return i;i++}return-1},this.isNullOrUndefined=function(thing){return _.isNull(thing||_.isUndefined(thing))},this})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").factory("uiGmapString",function(){return function(str){return this.contains=function(value,fromIndex){return str.indexOf(value,fromIndex)!==-1},this}})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmap_sync",[function(){return{fakePromise:function(){var _cb;return _cb=void 0,{then:function(cb){return _cb=cb},resolve:function(){return _cb.apply(void 0,arguments)}}}}}]).service("uiGmap_async",["$timeout","uiGmapPromise","uiGmapLogger","$q","uiGmapDataStructures","uiGmapGmapUtil",function($timeout,uiGmapPromise,$log,$q,uiGmapDataStructures,uiGmapGmapUtil){var ExposedPromise,PromiseQueueManager,SniffedPromise,_getArrayAndKeys,_getIterateeValue,defaultChunkSize,doChunk,doSkippPromise,each,errorObject,isInProgress,kickPromise,logTryCatch,managePromiseQueue,map,maybeCancelPromises,promiseStatus,promiseTypes,tryCatch;return promiseTypes=uiGmapPromise.promiseTypes,isInProgress=uiGmapPromise.isInProgress,promiseStatus=uiGmapPromise.promiseStatus,ExposedPromise=uiGmapPromise.ExposedPromise,SniffedPromise=uiGmapPromise.SniffedPromise,kickPromise=function(sniffedPromise,cancelCb){var promise;return promise=sniffedPromise.promise(),promise.promiseType=sniffedPromise.promiseType,promise.$$state&&$log.debug("promiseType: "+promise.promiseType+", state: "+promiseStatus(promise.$$state.status)),promise.cancelCb=cancelCb,promise},doSkippPromise=function(sniffedPromise,lastPromise){return sniffedPromise.promiseType===promiseTypes.create&&lastPromise.promiseType!==promiseTypes["delete"]&&lastPromise.promiseType!==promiseTypes.init&&($log.debug("lastPromise.promiseType "+lastPromise.promiseType+", newPromiseType: "+sniffedPromise.promiseType+", SKIPPED MUST COME AFTER DELETE ONLY"),!0)},maybeCancelPromises=function(queue,sniffedPromise,lastPromise){var first;if(sniffedPromise.promiseType===promiseTypes["delete"]&&lastPromise.promiseType!==promiseTypes["delete"]&&null!=lastPromise.cancelCb&&_.isFunction(lastPromise.cancelCb)&&isInProgress(lastPromise)&&($log.debug("promiseType: "+sniffedPromise.promiseType+", CANCELING LAST PROMISE type: "+lastPromise.promiseType),lastPromise.cancelCb("cancel safe"),first=queue.peek(),null!=first&&isInProgress(first)))return first.hasOwnProperty("cancelCb")&&_.isFunction(first.cancelCb)?($log.debug("promiseType: "+first.promiseType+", CANCELING FIRST PROMISE type: "+first.promiseType),first.cancelCb("cancel safe")):$log.warn("first promise was not cancelable")},PromiseQueueManager=function(existingPiecesObj,sniffedPromise,cancelCb){var lastPromise,newPromise;if(existingPiecesObj.existingPieces){if(lastPromise=_.last(existingPiecesObj.existingPieces._content),doSkippPromise(sniffedPromise,lastPromise))return;return maybeCancelPromises(existingPiecesObj.existingPieces,sniffedPromise,lastPromise),newPromise=ExposedPromise(lastPromise["finally"](function(){return kickPromise(sniffedPromise,cancelCb)})),newPromise.cancelCb=cancelCb,newPromise.promiseType=sniffedPromise.promiseType,existingPiecesObj.existingPieces.enqueue(newPromise),lastPromise["finally"](function(){return existingPiecesObj.existingPieces.dequeue()})}return existingPiecesObj.existingPieces=new uiGmapDataStructures.Queue,existingPiecesObj.existingPieces.enqueue(kickPromise(sniffedPromise,cancelCb))},managePromiseQueue=function(objectToLock,promiseType,msg,cancelCb,fnPromise){var cancelLogger;return null==msg&&(msg=""),cancelLogger=function(msg){if($log.debug(msg+": "+msg),null!=cancelCb&&_.isFunction(cancelCb))return cancelCb(msg)},PromiseQueueManager(objectToLock,SniffedPromise(fnPromise,promiseType),cancelLogger)},defaultChunkSize=80,errorObject={value:null},tryCatch=function(fn,ctx,args){var e;try{return fn.apply(ctx,args)}catch(_error){return e=_error,errorObject.value=e,errorObject}},logTryCatch=function(fn,ctx,deferred,args){var msg,result;return result=tryCatch(fn,ctx,args),result===errorObject&&(msg="error within chunking iterator: "+errorObject.value,$log.error(msg),deferred.reject(msg)),"cancel safe"!==result},_getIterateeValue=function(collection,array,index){var _isArray,valOrKey;return _isArray=collection===array,valOrKey=array[index],_isArray?valOrKey:collection[valOrKey]},_getArrayAndKeys=function(collection,keys,bailOutCb,cb){var array;return angular.isArray(collection)?array=collection:(array=keys?keys:Object.keys(_.omit(collection,["length","forEach","map"])),keys=array),null==cb&&(cb=bailOutCb),angular.isArray(array)&&(void 0===array||(null!=array?array.length:void 0)<=0)&&cb!==bailOutCb?bailOutCb():cb(array,keys)},doChunk=function(collection,chunkSizeOrDontChunk,pauseMilli,chunkCb,pauseCb,overallD,index,_keys){return _getArrayAndKeys(collection,_keys,function(array,keys){var cnt,i,keepGoing,val;for(cnt=chunkSizeOrDontChunk&&chunkSizeOrDontChunk<array.length?chunkSizeOrDontChunk:array.length,i=index,keepGoing=!0;keepGoing&&cnt--&&i<(array?array.length:i+1);)val=_getIterateeValue(collection,array,i),keepGoing=!!angular.isFunction(val)||logTryCatch(chunkCb,void 0,overallD,[val,i]),++i;if(array){if(!(keepGoing&&i<array.length))return overallD.resolve();if(index=i,chunkSizeOrDontChunk)return null!=pauseCb&&_.isFunction(pauseCb)&&logTryCatch(pauseCb,void 0,overallD,[]),$timeout(function(){return doChunk(collection,chunkSizeOrDontChunk,pauseMilli,chunkCb,pauseCb,overallD,index,keys)},pauseMilli,!1)}})},each=function(collection,chunk,chunkSizeOrDontChunk,pauseCb,index,pauseMilli,_keys){var error,overallD,ret;return null==chunkSizeOrDontChunk&&(chunkSizeOrDontChunk=defaultChunkSize),null==index&&(index=0),null==pauseMilli&&(pauseMilli=1),ret=void 0,overallD=uiGmapPromise.defer(),ret=overallD.promise,pauseMilli?_getArrayAndKeys(collection,_keys,function(){return overallD.resolve(),ret},function(array,keys){return doChunk(collection,chunkSizeOrDontChunk,pauseMilli,chunk,pauseCb,overallD,index,keys),ret}):(error="pause (delay) must be set from _async!",$log.error(error),overallD.reject(error),ret)},map=function(collection,iterator,chunkSizeOrDontChunk,pauseCb,index,pauseMilli,_keys){var results;return results=[],_getArrayAndKeys(collection,_keys,function(){return uiGmapPromise.resolve(results)},function(array,keys){return each(collection,function(o){return results.push(iterator(o))},chunkSizeOrDontChunk,pauseCb,index,pauseMilli,keys).then(function(){return results})})},{each:each,map:map,managePromiseQueue:managePromiseQueue,promiseLock:managePromiseQueue,defaultChunkSize:defaultChunkSize,chunkSizeFrom:function(fromSize,ret){return null==ret&&(ret=void 0),_.isNumber(fromSize)&&(ret=fromSize),(uiGmapGmapUtil.isFalse(fromSize)||fromSize===!1)&&(ret=!1),ret}}}])}.call(this),function(){var indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapBaseObject",function(){var BaseObject,baseObjectKeywords;return baseObjectKeywords=["extended","included"],BaseObject=function(){function BaseObject(){}return BaseObject.extend=function(obj){var key,ref,value;for(key in obj)value=obj[key],indexOf.call(baseObjectKeywords,key)<0&&(this[key]=value);return null!=(ref=obj.extended)&&ref.apply(this),this},BaseObject.include=function(obj){var key,ref,value;for(key in obj)value=obj[key],indexOf.call(baseObjectKeywords,key)<0&&(this.prototype[key]=value);return null!=(ref=obj.included)&&ref.apply(this),this},BaseObject}()})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChildEvents",function(){return{onChildCreation:function(child){}}})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapCtrlHandle",["$q",function($q){var CtrlHandle;return CtrlHandle={handle:function($scope,$element){return $scope.$on("$destroy",function(){return CtrlHandle.handle($scope)}),$scope.deferred=$q.defer(),{getScope:function(){return $scope}}},mapPromise:function(scope,ctrl){var mapScope;return mapScope=ctrl.getScope(),mapScope.deferred.promise.then(function(map){return scope.map=map}),mapScope.deferred.promise}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapEventsHelper",["uiGmapLogger",function($log){var _getEventsObj,_hasEvents;return _hasEvents=function(obj){return angular.isDefined(obj.events)&&null!=obj.events&&angular.isObject(obj.events)},_getEventsObj=function(scope,model){return _hasEvents(scope)?scope:_hasEvents(model)?model:void 0},{setEvents:function(gObject,scope,model,ignores){var eventObj;if(eventObj=_getEventsObj(scope,model),null!=eventObj)return _.compact(_.map(eventObj.events,function(eventHandler,eventName){var doIgnore;if(ignores&&(doIgnore=_(ignores).contains(eventName)),eventObj.events.hasOwnProperty(eventName)&&angular.isFunction(eventObj.events[eventName])&&!doIgnore)return google.maps.event.addListener(gObject,eventName,function(){return scope.$evalAsync||(scope.$evalAsync=function(){}),scope.$evalAsync(eventHandler.apply(scope,[gObject,eventName,model,arguments]))})}))},removeEvents:function(listeners){if(listeners)return listeners.forEach(function(l){if(l)return google.maps.event.removeListener(l)})}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapFitHelper",["uiGmapLogger","uiGmap_async",function($log,_async){return{fit:function(gMarkers,gMap){var bounds,everSet;if(gMap&&gMarkers&&gMarkers.length>0&&(bounds=new google.maps.LatLngBounds,everSet=!1,gMarkers.forEach(function(_this){return function(gMarker){if(gMarker)return everSet||(everSet=!0),bounds.extend(gMarker.getPosition())}}(this)),everSet))return gMap.fitBounds(bounds)}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapGmapUtil",["uiGmapLogger","$compile",function(Logger,$compile){var _isFalse,_isTruthy,getCoords,getLatitude,getLongitude,validateCoords;return _isTruthy=function(value,bool,optionsArray){return value===bool||optionsArray.indexOf(value)!==-1},_isFalse=function(value){return _isTruthy(value,!1,["false","FALSE",0,"n","N","no","NO"])},getLatitude=function(value){return Array.isArray(value)&&2===value.length?value[1]:angular.isDefined(value.type)&&"Point"===value.type?value.coordinates[1]:value.latitude},getLongitude=function(value){return Array.isArray(value)&&2===value.length?value[0]:angular.isDefined(value.type)&&"Point"===value.type?value.coordinates[0]:value.longitude},getCoords=function(value){if(value)return Array.isArray(value)&&2===value.length?new google.maps.LatLng(value[1],value[0]):angular.isDefined(value.type)&&"Point"===value.type?new google.maps.LatLng(value.coordinates[1],value.coordinates[0]):new google.maps.LatLng(value.latitude,value.longitude)},validateCoords=function(coords){if(angular.isUndefined(coords))return!1;if(_.isArray(coords)){if(2===coords.length)return!0}else if(null!=coords&&(null!=coords?coords.type:void 0)&&"Point"===coords.type&&_.isArray(coords.coordinates)&&2===coords.coordinates.length)return!0;return!(!coords||!angular.isDefined((null!=coords?coords.latitude:void 0)&&angular.isDefined(null!=coords?coords.longitude:void 0)))},{setCoordsFromEvent:function(prevValue,newLatLon){if(prevValue)return Array.isArray(prevValue)&&2===prevValue.length?(prevValue[1]=newLatLon.lat(),prevValue[0]=newLatLon.lng()):angular.isDefined(prevValue.type)&&"Point"===prevValue.type?(prevValue.coordinates[1]=newLatLon.lat(),prevValue.coordinates[0]=newLatLon.lng()):(prevValue.latitude=newLatLon.lat(),prevValue.longitude=newLatLon.lng()),prevValue},getLabelPositionPoint:function(anchor){var xPos,yPos;if(void 0!==anchor)return anchor=/^([-\d\.]+)\s([-\d\.]+)$/.exec(anchor),xPos=parseFloat(anchor[1]),yPos=parseFloat(anchor[2]),null!=xPos&&null!=yPos?new google.maps.Point(xPos,yPos):void 0},createWindowOptions:function(gMarker,scope,content,defaults){var options;return null!=content&&null!=defaults&&null!=$compile?(options=angular.extend({},defaults,{content:this.buildContent(scope,defaults,content),position:null!=defaults.position?defaults.position:angular.isObject(gMarker)?gMarker.getPosition():getCoords(scope.coords)}),null!=gMarker&&null==(null!=options?options.pixelOffset:void 0)&&(null==options.boxClass||(options.pixelOffset={height:0,width:-2})),options):defaults?defaults:(Logger.error("infoWindow defaults not defined"),content?void 0:Logger.error("infoWindow content not defined"))},buildContent:function(scope,defaults,content){var parsed,ret;return null!=defaults.content?ret=defaults.content:null!=$compile?(content=content.replace(/^\s+|\s+$/g,""),parsed=""===content?"":$compile(content)(scope),parsed.length>0&&(ret=parsed[0])):ret=content,ret},defaultDelay:50,isTrue:function(value){return _isTruthy(value,!0,["true","TRUE",1,"y","Y","yes","YES"])},isFalse:_isFalse,isFalsy:function(value){return _isTruthy(value,!1,[void 0,null])||_isFalse(value)},getCoords:getCoords,validateCoords:validateCoords,equalCoords:function(coord1,coord2){return getLatitude(coord1)===getLatitude(coord2)&&getLongitude(coord1)===getLongitude(coord2)},validatePath:function(path){var array,i,polygon,trackMaxVertices;if(i=0,angular.isUndefined(path.type)){if(!Array.isArray(path)||path.length<2)return!1;for(;i<path.length;){if(!(angular.isDefined(path[i].latitude)&&angular.isDefined(path[i].longitude)||"function"==typeof path[i].lat&&"function"==typeof path[i].lng))return!1;i++}return!0}if(angular.isUndefined(path.coordinates))return!1;if("Polygon"===path.type){if(path.coordinates[0].length<4)return!1;array=path.coordinates[0]}else if("MultiPolygon"===path.type){if(trackMaxVertices={max:0,index:0},_.forEach(path.coordinates,function(polygon,index){if(polygon[0].length>this.max)return this.max=polygon[0].length,this.index=index},trackMaxVertices),polygon=path.coordinates[trackMaxVertices.index],array=polygon[0],array.length<4)return!1}else{if("LineString"!==path.type)return!1;if(path.coordinates.length<2)return!1;array=path.coordinates}for(;i<array.length;){if(2!==array[i].length)return!1;i++}return!0},convertPathPoints:function(path){var array,i,latlng,result,trackMaxVertices;if(i=0,result=new google.maps.MVCArray,angular.isUndefined(path.type))for(;i<path.length;)angular.isDefined(path[i].latitude)&&angular.isDefined(path[i].longitude)?latlng=new google.maps.LatLng(path[i].latitude,path[i].longitude):"function"==typeof path[i].lat&&"function"==typeof path[i].lng&&(latlng=path[i]),result.push(latlng),i++;else for("Polygon"===path.type?array=path.coordinates[0]:"MultiPolygon"===path.type?(trackMaxVertices={max:0,index:0},_.forEach(path.coordinates,function(polygon,index){if(polygon[0].length>this.max)return this.max=polygon[0].length,this.index=index},trackMaxVertices),array=path.coordinates[trackMaxVertices.index][0]):"LineString"===path.type&&(array=path.coordinates);i<array.length;)result.push(new google.maps.LatLng(array[i][1],array[i][0])),i++;return result},extendMapBounds:function(map,points){var bounds,i;for(bounds=new google.maps.LatLngBounds,i=0;i<points.length;)bounds.extend(points.getAt(i)),i++;return map.fitBounds(bounds)},getPath:function(object,key){var obj;return null!=key&&_.isString(key)?(obj=object,_.each(key.split("."),function(value){if(obj)return obj=obj[value]}),obj):key},validateBoundPoints:function(bounds){return!(angular.isUndefined(bounds.sw.latitude)||angular.isUndefined(bounds.sw.longitude)||angular.isUndefined(bounds.ne.latitude)||angular.isUndefined(bounds.ne.longitude))},convertBoundPoints:function(bounds){var result;return result=new google.maps.LatLngBounds(new google.maps.LatLng(bounds.sw.latitude,bounds.sw.longitude),new google.maps.LatLng(bounds.ne.latitude,bounds.ne.longitude))},fitMapBounds:function(map,bounds){return map.fitBounds(bounds)}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapIsReady",["$q","$timeout",function($q,$timeout){var _checkIfReady,_ctr,_currentCheckNum,_maxCtrChecks,_promises,_proms;return _ctr=0,_proms=[],_currentCheckNum=1,_maxCtrChecks=50,_promises=function(){return $q.all(_proms)},_checkIfReady=function(deferred,expectedInstances){return $timeout(function(){return _currentCheckNum>=_maxCtrChecks&&deferred.reject("Your maps are not found we have checked the maximum amount of times. :)"),_currentCheckNum+=1,_ctr!==expectedInstances?_checkIfReady(deferred,expectedInstances):deferred.resolve(_promises())},100)},{spawn:function(){var d;return d=$q.defer(),_proms.push(d.promise),_ctr+=1,{instance:_ctr,deferred:d}},promises:_promises,instances:function(){return _ctr},promise:function(expectedInstances){var d;return null==expectedInstances&&(expectedInstances=1),d=$q.defer(),_checkIfReady(d,expectedInstances),d.promise},reset:function(){_ctr=0,_proms.length=0},decrement:function(){_ctr>0&&(_ctr-=1),_proms.length&&(_proms.length-=1)}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapLinked",["uiGmapBaseObject",function(BaseObject){var Linked;return Linked=function(superClass){function Linked(scope,element,attrs,ctrls){this.scope=scope,this.element=element,this.attrs=attrs,this.ctrls=ctrls}return extend(Linked,superClass),Linked}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapLogger",["$log",function($log){var LEVELS,Logger,log,maybeExecLevel;return LEVELS={log:1,info:2,debug:3,warn:4,error:5,none:6},maybeExecLevel=function(level,current,fn){if(level>=current)return fn()},log=function(logLevelFnName,msg){return null!=$log?$log[logLevelFnName](msg):console[logLevelFnName](msg)},new(Logger=function(){function Logger(){var logFns;this.doLog=!0,logFns={},["log","info","debug","warn","error"].forEach(function(_this){return function(level){return logFns[level]=function(msg){if(_this.doLog)return maybeExecLevel(LEVELS[level],_this.currentLevel,function(){return log(level,msg)})}}}(this)),this.LEVELS=LEVELS,this.currentLevel=LEVELS.error,this.log=logFns.log,this.info=logFns.info,this.debug=logFns.debug,this.warn=logFns.warn,this.error=logFns.error}return Logger.prototype.spawn=function(){return new Logger},Logger.prototype.setLog=function(someLogger){return $log=someLogger},Logger}())}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelKey",["uiGmapBaseObject","uiGmapGmapUtil","uiGmapPromise","$q","$timeout",function(BaseObject,GmapUtil,uiGmapPromise,$q,$timeout){var ModelKey;return ModelKey=function(superClass){function ModelKey(scope1){this.scope=scope1,this.modelsLength=bind(this.modelsLength,this),this.updateChild=bind(this.updateChild,this),this.destroy=bind(this.destroy,this),this.onDestroy=bind(this.onDestroy,this),this.setChildScope=bind(this.setChildScope,this),this.getChanges=bind(this.getChanges,this),this.getProp=bind(this.getProp,this),this.setIdKey=bind(this.setIdKey,this),this.modelKeyComparison=bind(this.modelKeyComparison,this),ModelKey.__super__.constructor.call(this),this["interface"]={},this["interface"].scopeKeys=[],this.defaultIdKey="id",this.idKey=void 0}return extend(ModelKey,superClass),ModelKey.prototype.evalModelHandle=function(model,modelKey){if(null!=model&&null!=modelKey)return"self"===modelKey?model:(_.isFunction(modelKey)&&(modelKey=modelKey()),GmapUtil.getPath(model,modelKey))},ModelKey.prototype.modelKeyComparison=function(model1,model2){var hasCoords,isEqual,scope;if(hasCoords=_.contains(this["interface"].scopeKeys,"coords"),(hasCoords&&null!=this.scope.coords||!hasCoords)&&(scope=this.scope),null==scope)throw"No scope set!";return hasCoords&&(isEqual=GmapUtil.equalCoords(this.evalModelHandle(model1,scope.coords),this.evalModelHandle(model2,scope.coords)),!isEqual)?isEqual:isEqual=_.every(_.without(this["interface"].scopeKeys,"coords"),function(_this){return function(k){return _this.evalModelHandle(model1,scope[k])===_this.evalModelHandle(model2,scope[k])}}(this))},ModelKey.prototype.setIdKey=function(scope){return this.idKey=null!=scope.idKey?scope.idKey:this.defaultIdKey},ModelKey.prototype.setVal=function(model,key,newValue){var thingToSet;return thingToSet=this.modelOrKey(model,key),thingToSet=newValue,model},ModelKey.prototype.modelOrKey=function(model,key){if(null!=key)return"self"!==key?GmapUtil.getPath(model,key):model},ModelKey.prototype.getProp=function(propName,model){return this.modelOrKey(model,propName)},ModelKey.prototype.getChanges=function(now,prev,whitelistedProps){var c,changes,prop;whitelistedProps&&(prev=_.pick(prev,whitelistedProps),now=_.pick(now,whitelistedProps)),changes={},prop={},c={};for(prop in now)prev&&prev[prop]===now[prop]||(_.isArray(now[prop])?changes[prop]=now[prop]:_.isObject(now[prop])?(c=this.getChanges(now[prop],prev?prev[prop]:null),_.isEmpty(c)||(changes[prop]=c)):changes[prop]=now[prop]);return changes},ModelKey.prototype.scopeOrModelVal=function(key,scope,model,doWrap){var maybeWrap,modelKey,modelProp,scopeProp;return null==doWrap&&(doWrap=!1),maybeWrap=function(isScope,ret,doWrap){return null==doWrap&&(doWrap=!1),doWrap?{isScope:isScope,value:ret}:ret},scopeProp=scope[key],_.isFunction(scopeProp)?maybeWrap(!0,scopeProp(model),doWrap):_.isObject(scopeProp)?maybeWrap(!0,scopeProp,doWrap):_.isString(scopeProp)?(modelKey=scopeProp,modelProp=modelKey?"self"===modelKey?model:model[modelKey]:model[key],_.isFunction(modelProp)?maybeWrap(!1,modelProp(),doWrap):maybeWrap(!1,modelProp,doWrap)):maybeWrap(!0,scopeProp,doWrap)},ModelKey.prototype.setChildScope=function(keys,childScope,model){return _.each(keys,function(_this){return function(name){var isScopeObj,newValue;if(isScopeObj=_this.scopeOrModelVal(name,childScope,model,!0),null!=(null!=isScopeObj?isScopeObj.value:void 0)&&(newValue=isScopeObj.value,newValue!==childScope[name]))return childScope[name]=newValue}}(this)),childScope.model=model},ModelKey.prototype.onDestroy=function(scope){},ModelKey.prototype.destroy=function(manualOverride){var ref;return null==manualOverride&&(manualOverride=!1),null==this.scope||(null!=(ref=this.scope)?ref.$$destroyed:void 0)||!this.needToManualDestroy&&!manualOverride?this.clean():this.scope.$destroy()},ModelKey.prototype.updateChild=function(child,model){return null==model[this.idKey]?void this.$log.error("Model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):child.updateModel(model)},ModelKey.prototype.modelsLength=function(arrayOrObjModels){var len,toCheck;return null==arrayOrObjModels&&(arrayOrObjModels=void 0),len=0,toCheck=arrayOrObjModels?arrayOrObjModels:this.scope.models,null==toCheck?len:len=angular.isArray(toCheck)||null!=toCheck.length?toCheck.length:Object.keys(toCheck).length},ModelKey}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelsWatcher",["uiGmapLogger","uiGmap_async","$q","uiGmapPromise",function(Logger,_async,$q,uiGmapPromise){return{didQueueInitPromise:function(existingPiecesObj,scope){return 0===scope.models.length&&(_async.promiseLock(existingPiecesObj,uiGmapPromise.promiseTypes.init,null,null,function(_this){return function(){return uiGmapPromise.resolve()}}(this)),!0)},figureOutState:function(idKey,scope,childObjects,comparison,callBack){var adds,children,mappedScopeModelIds,removals,updates;return adds=[],mappedScopeModelIds={},removals=[],updates=[],scope.models.forEach(function(m){var child;return null==m[idKey]?Logger.error(" id missing for model #{m.toString()},\ncan not use do comparison/insertion"):(mappedScopeModelIds[m[idKey]]={},
null==childObjects.get(m[idKey])?adds.push(m):(child=childObjects.get(m[idKey]),comparison(m,child.clonedModel)?void 0:updates.push({model:m,child:child})))}),children=childObjects.values(),children.forEach(function(c){var id;return null==c?void Logger.error("child undefined in ModelsWatcher."):null==c.model?void Logger.error("child.model undefined in ModelsWatcher."):(id=c.model[idKey],null==mappedScopeModelIds[id]?removals.push(c):void 0)}),{adds:adds,removals:removals,updates:updates}}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapPromise",["$q","$timeout","uiGmapLogger",function($q,$timeout,$log){var ExposedPromise,SniffedPromise,defer,isInProgress,isResolved,promise,promiseStatus,promiseStatuses,promiseTypes,resolve,strPromiseStatuses;return promiseTypes={create:"create",update:"update","delete":"delete",init:"init"},promiseStatuses={IN_PROGRESS:0,RESOLVED:1,REJECTED:2},strPromiseStatuses=function(){var obj;return obj={},obj[""+promiseStatuses.IN_PROGRESS]="in-progress",obj[""+promiseStatuses.RESOLVED]="resolved",obj[""+promiseStatuses.REJECTED]="rejected",obj}(),isInProgress=function(promise){return promise.$$state?promise.$$state.status===promiseStatuses.IN_PROGRESS:!promise.hasOwnProperty("$$v")||void 0},isResolved=function(promise){return promise.$$state?promise.$$state.status===promiseStatuses.RESOLVED:!!promise.hasOwnProperty("$$v")||void 0},promiseStatus=function(status){return strPromiseStatuses[status]||"done w error"},ExposedPromise=function(promise){var cancelDeferred,combined,wrapped;return cancelDeferred=$q.defer(),combined=$q.all([promise,cancelDeferred.promise]),wrapped=$q.defer(),promise.then(cancelDeferred.resolve,function(){},function(notify){return cancelDeferred.notify(notify),wrapped.notify(notify)}),combined.then(function(successes){return wrapped.resolve(successes[0]||successes[1])},function(error){return wrapped.reject(error)}),wrapped.promise.cancel=function(reason){return null==reason&&(reason="canceled"),cancelDeferred.reject(reason)},wrapped.promise.notify=function(msg){if(null==msg&&(msg="cancel safe"),wrapped.notify(msg),promise.hasOwnProperty("notify"))return promise.notify(msg)},null!=promise.promiseType&&(wrapped.promise.promiseType=promise.promiseType),wrapped.promise},SniffedPromise=function(fnPromise,promiseType){return{promise:fnPromise,promiseType:promiseType}},defer=function(){return $q.defer()},resolve=function(){var d;return d=$q.defer(),d.resolve.apply(void 0,arguments),d.promise},promise=function(fnToWrap){var d;return _.isFunction(fnToWrap)?(d=$q.defer(),$timeout(function(){var result;return result=fnToWrap(),d.resolve(result)}),d.promise):void $log.error("uiGmapPromise.promise() only accepts functions")},{defer:defer,promise:promise,resolve:resolve,promiseTypes:promiseTypes,isInProgress:isInProgress,isResolved:isResolved,promiseStatus:promiseStatus,ExposedPromise:ExposedPromise,SniffedPromise:SniffedPromise}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropMap",function(){var PropMap;return PropMap=function(){function PropMap(){this.removeAll=bind(this.removeAll,this),this.slice=bind(this.slice,this),this.push=bind(this.push,this),this.keys=bind(this.keys,this),this.values=bind(this.values,this),this.remove=bind(this.remove,this),this.put=bind(this.put,this),this.stateChanged=bind(this.stateChanged,this),this.get=bind(this.get,this),this.length=0,this.dict={},this.didValsStateChange=!1,this.didKeysStateChange=!1,this.allVals=[],this.allKeys=[]}return PropMap.prototype.get=function(key){return this.dict[key]},PropMap.prototype.stateChanged=function(){return this.didValsStateChange=!0,this.didKeysStateChange=!0},PropMap.prototype.put=function(key,value){return null==this.get(key)&&this.length++,this.stateChanged(),this.dict[key]=value},PropMap.prototype.remove=function(key,isSafe){var value;if(null==isSafe&&(isSafe=!1),!isSafe||this.get(key))return value=this.dict[key],delete this.dict[key],this.length--,this.stateChanged(),value},PropMap.prototype.valuesOrKeys=function(str){var keys,vals;return null==str&&(str="Keys"),this["did"+str+"StateChange"]?(vals=[],keys=[],_.each(this.dict,function(v,k){return vals.push(v),keys.push(k)}),this.didKeysStateChange=!1,this.didValsStateChange=!1,this.allVals=vals,this.allKeys=keys,this["all"+str]):this["all"+str]},PropMap.prototype.values=function(){return this.valuesOrKeys("Vals")},PropMap.prototype.keys=function(){return this.valuesOrKeys()},PropMap.prototype.push=function(obj,key){return null==key&&(key="key"),this.put(obj[key],obj)},PropMap.prototype.slice=function(){return this.keys().map(function(_this){return function(k){return _this.remove(k)}}(this))},PropMap.prototype.removeAll=function(){return this.slice()},PropMap.prototype.each=function(cb){return _.each(this.dict,function(v,k){return cb(v)})},PropMap.prototype.map=function(cb){return _.map(this.dict,function(v,k){return cb(v)})},PropMap}()})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropertyAction",["uiGmapLogger",function(Logger){var PropertyAction;return PropertyAction=function(setterFn){return this.setIfChange=function(newVal,oldVal){var callingKey;if(callingKey=this.exp,!_.isEqual(oldVal,newVal))return setterFn(callingKey,newVal)},this.sic=this.setIfChange,this}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapClustererMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap",function($log,FitHelper,PropMap){var ClustererMarkerManager;return ClustererMarkerManager=function(){function ClustererMarkerManager(gMap,opt_markers,opt_options,opt_events){null==opt_markers&&(opt_markers={}),this.opt_options=null!=opt_options?opt_options:{},this.opt_events=opt_events,this.checkSync=bind(this.checkSync,this),this.getGMarkers=bind(this.getGMarkers,this),this.fit=bind(this.fit,this),this.destroy=bind(this.destroy,this),this.clear=bind(this.clear,this),this.draw=bind(this.draw,this),this.removeMany=bind(this.removeMany,this),this.remove=bind(this.remove,this),this.addMany=bind(this.addMany,this),this.update=bind(this.update,this),this.add=bind(this.add,this),this.type=ClustererMarkerManager.type,this.clusterer=new NgMapMarkerClusterer(gMap,opt_markers,this.opt_options),this.propMapGMarkers=new PropMap,this.attachEvents(this.opt_events,"opt_events"),this.clusterer.setIgnoreHidden(!0),this.noDrawOnSingleAddRemoves=!0,$log.info(this)}return ClustererMarkerManager.type="ClustererMarkerManager",ClustererMarkerManager.prototype.checkKey=function(gMarker){var msg;if(null==gMarker.key)return msg="gMarker.key undefined and it is REQUIRED!!",$log.error(msg)},ClustererMarkerManager.prototype.add=function(gMarker){return this.checkKey(gMarker),this.clusterer.addMarker(gMarker,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.put(gMarker.key,gMarker),this.checkSync()},ClustererMarkerManager.prototype.update=function(gMarker){return this.remove(gMarker),this.add(gMarker)},ClustererMarkerManager.prototype.addMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.add(gMarker)}}(this))},ClustererMarkerManager.prototype.remove=function(gMarker){var exists;return this.checkKey(gMarker),exists=this.propMapGMarkers.get(gMarker.key),exists&&(this.clusterer.removeMarker(gMarker,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.remove(gMarker.key)),this.checkSync()},ClustererMarkerManager.prototype.removeMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.remove(gMarker)}}(this))},ClustererMarkerManager.prototype.draw=function(){return this.clusterer.repaint()},ClustererMarkerManager.prototype.clear=function(){return this.removeMany(this.getGMarkers()),this.clusterer.repaint()},ClustererMarkerManager.prototype.attachEvents=function(options,optionsName){var eventHandler,eventName,results;if(angular.isDefined(options)&&null!=options&&angular.isObject(options)){results=[];for(eventName in options)eventHandler=options[eventName],options.hasOwnProperty(eventName)&&angular.isFunction(options[eventName])?($log.info(optionsName+": Attaching event: "+eventName+" to clusterer"),results.push(google.maps.event.addListener(this.clusterer,eventName,options[eventName]))):results.push(void 0);return results}},ClustererMarkerManager.prototype.clearEvents=function(options,optionsName){var eventHandler,eventName,results;if(angular.isDefined(options)&&null!=options&&angular.isObject(options)){results=[];for(eventName in options)eventHandler=options[eventName],options.hasOwnProperty(eventName)&&angular.isFunction(options[eventName])?($log.info(optionsName+": Clearing event: "+eventName+" to clusterer"),results.push(google.maps.event.clearListeners(this.clusterer,eventName))):results.push(void 0);return results}},ClustererMarkerManager.prototype.destroy=function(){return this.clearEvents(this.opt_events,"opt_events"),this.clear()},ClustererMarkerManager.prototype.fit=function(){return FitHelper.fit(this.getGMarkers(),this.clusterer.getMap())},ClustererMarkerManager.prototype.getGMarkers=function(){return this.clusterer.getMarkers().values()},ClustererMarkerManager.prototype.checkSync=function(){},ClustererMarkerManager}()}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap",function(Logger,FitHelper,PropMap){var MarkerManager;return MarkerManager=function(){function MarkerManager(gMap,opt_markers,opt_options){this.getGMarkers=bind(this.getGMarkers,this),this.fit=bind(this.fit,this),this.handleOptDraw=bind(this.handleOptDraw,this),this.clear=bind(this.clear,this),this.draw=bind(this.draw,this),this.removeMany=bind(this.removeMany,this),this.remove=bind(this.remove,this),this.addMany=bind(this.addMany,this),this.update=bind(this.update,this),this.add=bind(this.add,this),this.type=MarkerManager.type,this.gMap=gMap,this.gMarkers=new PropMap,this.$log=Logger,this.$log.info(this)}return MarkerManager.type="MarkerManager",MarkerManager.prototype.add=function(gMarker,optDraw){var exists,msg;if(null==optDraw&&(optDraw=!0),null==gMarker.key)throw msg="gMarker.key undefined and it is REQUIRED!!",Logger.error(msg),msg;if(exists=this.gMarkers.get(gMarker.key),!exists)return this.handleOptDraw(gMarker,optDraw,!0),this.gMarkers.put(gMarker.key,gMarker)},MarkerManager.prototype.update=function(gMarker,optDraw){return null==optDraw&&(optDraw=!0),this.remove(gMarker,optDraw),this.add(gMarker,optDraw)},MarkerManager.prototype.addMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.add(gMarker)}}(this))},MarkerManager.prototype.remove=function(gMarker,optDraw){if(null==optDraw&&(optDraw=!0),this.handleOptDraw(gMarker,optDraw,!1),this.gMarkers.get(gMarker.key))return this.gMarkers.remove(gMarker.key)},MarkerManager.prototype.removeMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(marker){return _this.remove(marker)}}(this))},MarkerManager.prototype.draw=function(){var deletes;return deletes=[],this.gMarkers.each(function(_this){return function(gMarker){if(!gMarker.isDrawn)return gMarker.doAdd?(gMarker.setMap(_this.gMap),gMarker.isDrawn=!0):deletes.push(gMarker)}}(this)),deletes.forEach(function(_this){return function(gMarker){return gMarker.isDrawn=!1,_this.remove(gMarker,!0)}}(this))},MarkerManager.prototype.clear=function(){return this.gMarkers.each(function(gMarker){return gMarker.setMap(null)}),delete this.gMarkers,this.gMarkers=new PropMap},MarkerManager.prototype.handleOptDraw=function(gMarker,optDraw,doAdd){return optDraw===!0?(doAdd?gMarker.setMap(this.gMap):gMarker.setMap(null),gMarker.isDrawn=!0):(gMarker.isDrawn=!1,gMarker.doAdd=doAdd)},MarkerManager.prototype.fit=function(){return FitHelper.fit(this.getGMarkers(),this.gMap)},MarkerManager.prototype.getGMarkers=function(){return this.gMarkers.values()},MarkerManager}()}])}.call(this),function(){angular.module("uiGmapgoogle-maps").factory("uiGmapadd-events",["$timeout",function($timeout){var addEvent,addEvents;return addEvent=function(target,eventName,handler){return google.maps.event.addListener(target,eventName,function(){return handler.apply(this,arguments),$timeout(function(){},!0)})},addEvents=function(target,eventName,handler){var remove;return handler?addEvent(target,eventName,handler):(remove=[],angular.forEach(eventName,function(_handler,key){return remove.push(addEvent(target,key,_handler))}),function(){return angular.forEach(remove,function(listener){return google.maps.event.removeListener(listener)}),remove=null})}}])}.call(this),function(){angular.module("uiGmapgoogle-maps").factory("uiGmaparray-sync",["uiGmapadd-events",function(mapEvents){return function(mapArray,scope,pathEval,pathChangedFn){var geojsonArray,geojsonHandlers,geojsonWatcher,isSetFromScope,legacyHandlers,legacyWatcher,mapArrayListener,scopePath,watchListener;return isSetFromScope=!1,scopePath=scope.$eval(pathEval),scope["static"]||(legacyHandlers={set_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index)))return value.lng&&value.lat?(scopePath[index].latitude=value.lat(),scopePath[index].longitude=value.lng()):scopePath[index]=value},insert_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index)))return value.lng&&value.lat?scopePath.splice(index,0,{latitude:value.lat(),longitude:value.lng()}):scopePath.splice(index,0,value)},remove_at:function(index){if(!isSetFromScope)return scopePath.splice(index,1)}},"Polygon"===scopePath.type?geojsonArray=scopePath.coordinates[0]:"LineString"===scopePath.type&&(geojsonArray=scopePath.coordinates),geojsonHandlers={set_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index),value&&value.lng&&value.lat))return geojsonArray[index][1]=value.lat(),geojsonArray[index][0]=value.lng()},insert_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index),value&&value.lng&&value.lat))return geojsonArray.splice(index,0,[value.lng(),value.lat()])},remove_at:function(index){if(!isSetFromScope)return geojsonArray.splice(index,1)}},mapArrayListener=mapEvents(mapArray,angular.isUndefined(scopePath.type)?legacyHandlers:geojsonHandlers)),legacyWatcher=function(newPath){var changed,i,l,newLength,newValue,oldArray,oldLength,oldValue;if(isSetFromScope=!0,oldArray=mapArray,changed=!1,newPath){for(i=0,oldLength=oldArray.getLength(),newLength=newPath.length,l=Math.min(oldLength,newLength),newValue=void 0;i<l;)oldValue=oldArray.getAt(i),newValue=newPath[i],"function"==typeof newValue.equals?newValue.equals(oldValue)||(oldArray.setAt(i,newValue),changed=!0):oldValue.lat()===newValue.latitude&&oldValue.lng()===newValue.longitude||(oldArray.setAt(i,new google.maps.LatLng(newValue.latitude,newValue.longitude)),changed=!0),i++;for(;i<newLength;)newValue=newPath[i],"function"==typeof newValue.lat&&"function"==typeof newValue.lng?oldArray.push(newValue):oldArray.push(new google.maps.LatLng(newValue.latitude,newValue.longitude)),changed=!0,i++;for(;i<oldLength;)oldArray.pop(),changed=!0,i++}if(isSetFromScope=!1,changed)return pathChangedFn(oldArray)},geojsonWatcher=function(newPath){var array,changed,i,l,newLength,newValue,oldArray,oldLength,oldValue;if(isSetFromScope=!0,oldArray=mapArray,changed=!1,newPath){for("Polygon"===scopePath.type?array=newPath.coordinates[0]:"LineString"===scopePath.type&&(array=newPath.coordinates),i=0,oldLength=oldArray.getLength(),newLength=array.length,l=Math.min(oldLength,newLength),newValue=void 0;i<l;)oldValue=oldArray.getAt(i),newValue=array[i],oldValue.lat()===newValue[1]&&oldValue.lng()===newValue[0]||(oldArray.setAt(i,new google.maps.LatLng(newValue[1],newValue[0])),changed=!0),i++;for(;i<newLength;)newValue=array[i],oldArray.push(new google.maps.LatLng(newValue[1],newValue[0])),changed=!0,i++;for(;i<oldLength;)oldArray.pop(),changed=!0,i++}if(isSetFromScope=!1,changed)return pathChangedFn(oldArray)},scope["static"]||(watchListener=angular.isUndefined(scopePath.type)?scope.$watchCollection(pathEval,legacyWatcher):scope.$watch(pathEval,geojsonWatcher,!0)),function(){if(mapArrayListener&&(mapArrayListener(),mapArrayListener=null),watchListener)return watchListener(),watchListener=null}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChromeFixes",["$timeout",function($timeout){return{maybeRepaint:function(el){if(el)return el.style.opacity=.9,$timeout(function(){return el.style.opacity=1})}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps").service("uiGmapObjectIterators",function(){var _ignores,_iterators,_slapForEach,_slapMap;return _ignores=["length","forEach","map"],_iterators=[],_slapForEach=function(object){return object.forEach=function(cb){return _.each(_.omit(object,_ignores),function(val){if(!_.isFunction(val))return cb(val)})},object},_iterators.push(_slapForEach),_slapMap=function(object){return object.map=function(cb){return _.map(_.omit(object,_ignores),function(val){if(!_.isFunction(val))return cb(val)})},object},_iterators.push(_slapMap),{slapMap:_slapMap,slapForEach:_slapForEach,slapAll:function(object){return _iterators.forEach(function(it){return it(object)}),object}}})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.options.builders").service("uiGmapCommonOptionsBuilder",["uiGmapBaseObject","uiGmapLogger","uiGmapModelKey",function(BaseObject,$log,ModelKey){var CommonOptionsBuilder;return CommonOptionsBuilder=function(superClass){function CommonOptionsBuilder(){return this.watchProps=bind(this.watchProps,this),this.buildOpts=bind(this.buildOpts,this),CommonOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(CommonOptionsBuilder,superClass),CommonOptionsBuilder.prototype.props=["clickable","draggable","editable","visible",{prop:"stroke",isColl:!0}],CommonOptionsBuilder.prototype.getCorrectModel=function(scope){return angular.isDefined(null!=scope?scope.model:void 0)?scope.model:scope},CommonOptionsBuilder.prototype.buildOpts=function(customOpts,cachedEval,forEachOpts){var model,opts,stroke;return null==customOpts&&(customOpts={}),null==forEachOpts&&(forEachOpts={}),this.scope?this.map?(model=this.getCorrectModel(this.scope),stroke=this.scopeOrModelVal("stroke",this.scope,model),opts=angular.extend(customOpts,this.DEFAULTS,{map:this.map,strokeColor:null!=stroke?stroke.color:void 0,strokeOpacity:null!=stroke?stroke.opacity:void 0,strokeWeight:null!=stroke?stroke.weight:void 0}),angular.forEach(angular.extend(forEachOpts,{clickable:!0,draggable:!1,editable:!1,"static":!1,fit:!1,visible:!0,zIndex:0,icons:[]}),function(_this){return function(defaultValue,key){var val;return val=cachedEval?cachedEval[key]:_this.scopeOrModelVal(key,_this.scope,model),angular.isUndefined(val)?opts[key]=defaultValue:opts[key]=model[key]}}(this)),opts["static"]&&(opts.editable=!1),opts):void $log.error("this.map not defined in CommonOptionsBuilder can not buildOpts"):void $log.error("this.scope not defined in CommonOptionsBuilder can not buildOpts")},CommonOptionsBuilder.prototype.watchProps=function(props){return null==props&&(props=this.props),props.forEach(function(_this){return function(prop){if(null!=_this.attrs[prop]||null!=_this.attrs[null!=prop?prop.prop:void 0])return(null!=prop?prop.isColl:void 0)?_this.scope.$watchCollection(prop.prop,_this.setMyOptions):_this.scope.$watch(prop,_this.setMyOptions)}}(this))},CommonOptionsBuilder}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.options.builders").factory("uiGmapPolylineOptionsBuilder",["uiGmapCommonOptionsBuilder",function(CommonOptionsBuilder){var PolylineOptionsBuilder;return PolylineOptionsBuilder=function(superClass){function PolylineOptionsBuilder(){return PolylineOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(PolylineOptionsBuilder,superClass),PolylineOptionsBuilder.prototype.buildOpts=function(pathPoints,cachedEval){return PolylineOptionsBuilder.__super__.buildOpts.call(this,{path:pathPoints},cachedEval,{geodesic:!1})},PolylineOptionsBuilder}(CommonOptionsBuilder)}]).factory("uiGmapShapeOptionsBuilder",["uiGmapCommonOptionsBuilder",function(CommonOptionsBuilder){var ShapeOptionsBuilder;return ShapeOptionsBuilder=function(superClass){function ShapeOptionsBuilder(){return ShapeOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(ShapeOptionsBuilder,superClass),ShapeOptionsBuilder.prototype.buildOpts=function(customOpts,cachedEval,forEachOpts){var fill,model;return model=this.getCorrectModel(this.scope),fill=cachedEval?cachedEval.fill:this.scopeOrModelVal("fill",this.scope,model),customOpts=angular.extend(customOpts,{fillColor:null!=fill?fill.color:void 0,fillOpacity:null!=fill?fill.opacity:void 0}),ShapeOptionsBuilder.__super__.buildOpts.call(this,customOpts,cachedEval,forEachOpts)},ShapeOptionsBuilder}(CommonOptionsBuilder)}]).factory("uiGmapPolygonOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var PolygonOptionsBuilder;return PolygonOptionsBuilder=function(superClass){function PolygonOptionsBuilder(){return PolygonOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(PolygonOptionsBuilder,superClass),PolygonOptionsBuilder.prototype.buildOpts=function(pathPoints,cachedEval){return PolygonOptionsBuilder.__super__.buildOpts.call(this,{path:pathPoints},cachedEval,{geodesic:!1})},PolygonOptionsBuilder}(ShapeOptionsBuilder)}]).factory("uiGmapRectangleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var RectangleOptionsBuilder;return RectangleOptionsBuilder=function(superClass){function RectangleOptionsBuilder(){return RectangleOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(RectangleOptionsBuilder,superClass),RectangleOptionsBuilder.prototype.buildOpts=function(bounds,cachedEval){return RectangleOptionsBuilder.__super__.buildOpts.call(this,{bounds:bounds},cachedEval)},RectangleOptionsBuilder}(ShapeOptionsBuilder)}]).factory("uiGmapCircleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var CircleOptionsBuilder;return CircleOptionsBuilder=function(superClass){function CircleOptionsBuilder(){return CircleOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(CircleOptionsBuilder,superClass),CircleOptionsBuilder.prototype.buildOpts=function(center,radius,cachedEval){return CircleOptionsBuilder.__super__.buildOpts.call(this,{center:center,radius:radius},cachedEval)},CircleOptionsBuilder}(ShapeOptionsBuilder)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.options").service("uiGmapMarkerOptions",["uiGmapLogger","uiGmapGmapUtil",function($log,GmapUtil){return _.extend(GmapUtil,{createOptions:function(coords,icon,defaults,map){var opts;return null==defaults&&(defaults={}),opts=angular.extend({},defaults,{position:null!=defaults.position?defaults.position:GmapUtil.getCoords(coords),visible:null!=defaults.visible?defaults.visible:GmapUtil.validateCoords(coords)}),null==defaults.icon&&null==icon||(opts=angular.extend(opts,{icon:null!=defaults.icon?defaults.icon:icon})),null!=map&&(opts.map=map),opts},isLabel:function(options){return null!=options&&(null!=options.labelContent||null!=options.labelAnchor||null!=options.labelClass||null!=options.labelStyle||null!=options.labelVisible)}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapBasePolyChildModel",["uiGmapLogger","$timeout","uiGmaparray-sync","uiGmapGmapUtil","uiGmapEventsHelper",function($log,$timeout,arraySync,GmapUtil,EventsHelper){return function(Builder,gFactory){var BasePolyChildModel;return BasePolyChildModel=function(superClass){function BasePolyChildModel(scope,attrs,map,defaults,model){var create;this.scope=scope,this.attrs=attrs,this.map=map,this.defaults=defaults,this.model=model,this.clean=bind(this.clean,this),this.clonedModel=_.clone(this.model,!0),this.isDragging=!1,this.internalEvents={dragend:function(_this){return function(){return _.defer(function(){return _this.isDragging=!1})}}(this),dragstart:function(_this){return function(){return _this.isDragging=!0}}(this)},create=function(_this){return function(){var maybeCachedEval,pathPoints;if(!_this.isDragging)return pathPoints=_this.convertPathPoints(_this.scope.path),null!=_this.gObject&&_this.clean(),null!=_this.scope.model&&(maybeCachedEval=_this.scope),pathPoints.length>0&&(_this.gObject=gFactory(_this.buildOpts(pathPoints,maybeCachedEval))),_this.gObject?(_this.scope.fit&&_this.extendMapBounds(_this.map,pathPoints),arraySync(_this.gObject.getPath(),_this.scope,"path",function(pathPoints){if(_this.scope.fit)return _this.extendMapBounds(_this.map,pathPoints)}),angular.isDefined(_this.scope.events)&&angular.isObject(_this.scope.events)&&(_this.listeners=_this.model?EventsHelper.setEvents(_this.gObject,_this.scope,_this.model):EventsHelper.setEvents(_this.gObject,_this.scope,_this.scope)),_this.internalListeners=_this.model?EventsHelper.setEvents(_this.gObject,{events:_this.internalEvents},_this.model):EventsHelper.setEvents(_this.gObject,{events:_this.internalEvents},_this.scope)):void 0}}(this),create(),this.scope.$watch("path",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue)||!_this.gObject)return create()}}(this),!0),!this.scope["static"]&&angular.isDefined(this.scope.editable)&&this.scope.$watch("editable",function(_this){return function(newValue,oldValue){var ref;if(newValue!==oldValue)return newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setEditable(newValue):void 0}}(this),!0),angular.isDefined(this.scope.draggable)&&this.scope.$watch("draggable",function(_this){return function(newValue,oldValue){var ref;if(newValue!==oldValue)return newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setDraggable(newValue):void 0}}(this),!0),angular.isDefined(this.scope.visible)&&this.scope.$watch("visible",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&(newValue=!_this.isFalse(newValue)),null!=(ref=_this.gObject)?ref.setVisible(newValue):void 0}}(this),!0),angular.isDefined(this.scope.geodesic)&&this.scope.$watch("geodesic",function(_this){return function(newValue,oldValue){var ref;if(newValue!==oldValue)return newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.weight)&&this.scope.$watch("stroke.weight",function(_this){return function(newValue,oldValue){var ref;if(newValue!==oldValue)return null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.color)&&this.scope.$watch("stroke.color",function(_this){return function(newValue,oldValue){var ref;if(newValue!==oldValue)return null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.opacity)&&this.scope.$watch("stroke.opacity",function(_this){return function(newValue,oldValue){var ref;if(newValue!==oldValue)return null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.icons)&&this.scope.$watch("icons",function(_this){return function(newValue,oldValue){var ref;if(newValue!==oldValue)return null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),this.scope.$on("$destroy",function(_this){return function(){return _this.clean(),_this.scope=null}}(this)),angular.isDefined(this.scope.fill)&&angular.isDefined(this.scope.fill.color)&&this.scope.$watch("fill.color",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath()))}}(this)),angular.isDefined(this.scope.fill)&&angular.isDefined(this.scope.fill.opacity)&&this.scope.$watch("fill.opacity",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath()))}}(this)),angular.isDefined(this.scope.zIndex)&&this.scope.$watch("zIndex",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath()))}}(this))}return extend(BasePolyChildModel,superClass),BasePolyChildModel.include(GmapUtil),BasePolyChildModel.prototype.clean=function(){var ref;return EventsHelper.removeEvents(this.listeners),EventsHelper.removeEvents(this.internalListeners),null!=(ref=this.gObject)&&ref.setMap(null),this.gObject=null},BasePolyChildModel}(Builder)}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapDrawFreeHandChildModel",["uiGmapLogger","$q",function($log,$q){var drawFreeHand,freeHandMgr;return drawFreeHand=function(map,polys,enable){var move,poly;poly=new google.maps.Polyline({map:map,clickable:!1}),move=google.maps.event.addListener(map,"mousemove",function(e){return poly.getPath().push(e.latLng)}),google.maps.event.addListenerOnce(map,"mouseup",function(e){var path;return google.maps.event.removeListener(move),path=poly.getPath(),poly.setMap(null),polys.push(new google.maps.Polygon({map:map,path:path})),poly=null,google.maps.event.clearListeners(map.getDiv(),"mousedown"),enable()})},freeHandMgr=function(map1,defaultOptions){var disableMap,enable;return this.map=map1,defaultOptions||(defaultOptions={draggable:!0,zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0}),enable=function(_this){return function(){var ref;return null!=(ref=_this.deferred)&&ref.resolve(),_.defer(function(){return _this.map.setOptions(_.extend(_this.oldOptions,defaultOptions))})}}(this),disableMap=function(_this){return function(){return $log.info("disabling map move"),_this.oldOptions=map.getOptions(),_this.oldOptions.center=map.getCenter(),_this.map.setOptions({draggable:!1,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!1})}}(this),this.engage=function(_this){return function(polys1){return _this.polys=polys1,_this.deferred=$q.defer(),disableMap(),$log.info("DrawFreeHandChildModel is engaged (drawing)."),google.maps.event.addDomListener(_this.map.getDiv(),"mousedown",function(e){return drawFreeHand(_this.map,_this.polys,enable)}),_this.deferred.promise}}(this),this}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);
return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapMarkerChildModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger","uiGmapEventsHelper","uiGmapPropertyAction","uiGmapMarkerOptions","uiGmapIMarker","uiGmapMarkerManager","uiGmapPromise",function(ModelKey,GmapUtil,$log,EventsHelper,PropertyAction,MarkerOptions,IMarker,MarkerManager,uiGmapPromise){var MarkerChildModel;return MarkerChildModel=function(superClass){function MarkerChildModel(scope,model1,keys,gMap,defaults,doClick,gManager,doDrawSelf,trackModel,needRedraw){var action;this.model=model1,this.keys=keys,this.gMap=gMap,this.defaults=defaults,this.doClick=doClick,this.gManager=gManager,this.doDrawSelf=null==doDrawSelf||doDrawSelf,this.trackModel=null==trackModel||trackModel,this.needRedraw=null!=needRedraw&&needRedraw,this.internalEvents=bind(this.internalEvents,this),this.setLabelOptions=bind(this.setLabelOptions,this),this.setOptions=bind(this.setOptions,this),this.setIcon=bind(this.setIcon,this),this.setCoords=bind(this.setCoords,this),this.isNotValid=bind(this.isNotValid,this),this.maybeSetScopeValue=bind(this.maybeSetScopeValue,this),this.createMarker=bind(this.createMarker,this),this.setMyScope=bind(this.setMyScope,this),this.updateModel=bind(this.updateModel,this),this.handleModelChanges=bind(this.handleModelChanges,this),this.destroy=bind(this.destroy,this),this.clonedModel=_.extend({},this.model),this.deferred=uiGmapPromise.defer(),_.each(this.keys,function(_this){return function(v,k){return _this[k+"Key"]=_.isFunction(_this.keys[k])?_this.keys[k]():_this.keys[k]}}(this)),this.idKey=this.idKeyKey||"id",null!=this.model[this.idKey]&&(this.id=this.model[this.idKey]),MarkerChildModel.__super__.constructor.call(this,scope),this.scope.getGMarker=function(_this){return function(){return _this.gObject}}(this),this.firstTime=!0,this.trackModel?(this.scope.model=this.model,this.scope.$watch("model",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.handleModelChanges(newValue,oldValue)}}(this),!0)):(action=new PropertyAction(function(_this){return function(calledKey,newVal){if(!_this.firstTime)return _this.setMyScope(calledKey,scope)}}(this),(!1)),_.each(this.keys,function(v,k){return scope.$watch(k,action.sic,!0)})),this.scope.$on("$destroy",function(_this){return function(){return destroy(_this)}}(this)),this.createMarker(this.model),$log.info(this)}var destroy;return extend(MarkerChildModel,superClass),MarkerChildModel.include(GmapUtil),MarkerChildModel.include(EventsHelper),MarkerChildModel.include(MarkerOptions),destroy=function(child){if(null!=(null!=child?child.gObject:void 0)&&(child.removeEvents(child.externalListeners),child.removeEvents(child.internalListeners),null!=child?child.gObject:void 0))return child.removeFromManager&&child.gManager.remove(child.gObject),child.gObject.setMap(null),child.gObject=null},MarkerChildModel.prototype.destroy=function(removeFromManager){return null==removeFromManager&&(removeFromManager=!0),this.removeFromManager=removeFromManager,this.scope.$destroy()},MarkerChildModel.prototype.handleModelChanges=function(newValue,oldValue){var changes,ctr,len;if(changes=this.getChanges(newValue,oldValue,IMarker.keys),!this.firstTime)return ctr=0,len=_.keys(changes).length,_.each(changes,function(_this){return function(v,k){var doDraw;return ctr+=1,doDraw=len===ctr,_this.setMyScope(k,newValue,oldValue,!1,!0,doDraw),_this.needRedraw=!0}}(this))},MarkerChildModel.prototype.updateModel=function(model){return this.clonedModel=_.extend({},model),this.setMyScope("all",model,this.model)},MarkerChildModel.prototype.renderGMarker=function(doDraw,validCb){var coords;if(null==doDraw&&(doDraw=!0),coords=this.getProp(this.coordsKey,this.model),null!=coords){if(!this.validateCoords(coords))return void $log.debug("MarkerChild does not have coords yet. They may be defined later.");if(null!=validCb&&validCb(),doDraw&&this.gObject)return this.gManager.add(this.gObject)}else if(doDraw&&this.gObject)return this.gManager.remove(this.gObject)},MarkerChildModel.prototype.setMyScope=function(thingThatChanged,model,oldModel,isInit,doDraw){var justCreated;switch(null==oldModel&&(oldModel=void 0),null==isInit&&(isInit=!1),null==doDraw&&(doDraw=!0),null==model?model=this.model:this.model=model,this.gObject||(this.setOptions(this.scope,doDraw),justCreated=!0),thingThatChanged){case"all":return _.each(this.keys,function(_this){return function(v,k){return _this.setMyScope(k,model,oldModel,isInit,doDraw)}}(this));case"icon":return this.maybeSetScopeValue("icon",model,oldModel,this.iconKey,this.evalModelHandle,isInit,this.setIcon,doDraw);case"coords":return this.maybeSetScopeValue("coords",model,oldModel,this.coordsKey,this.evalModelHandle,isInit,this.setCoords,doDraw);case"options":if(!justCreated)return this.createMarker(model,oldModel,isInit,doDraw)}},MarkerChildModel.prototype.createMarker=function(model,oldModel,isInit,doDraw){return null==oldModel&&(oldModel=void 0),null==isInit&&(isInit=!1),null==doDraw&&(doDraw=!0),this.maybeSetScopeValue("options",model,oldModel,this.optionsKey,this.evalModelHandle,isInit,this.setOptions,doDraw),this.firstTime=!1},MarkerChildModel.prototype.maybeSetScopeValue=function(scopePropName,model,oldModel,modelKey,evaluate,isInit,gSetter,doDraw){if(null==gSetter&&(gSetter=void 0),null==doDraw&&(doDraw=!0),null!=gSetter)return gSetter(this.scope,doDraw)},MarkerChildModel.doDrawSelf&&doDraw&&MarkerChildModel.gManager.draw(),MarkerChildModel.prototype.isNotValid=function(scope,doCheckGmarker){var hasIdenticalScopes,hasNoGmarker;return null==doCheckGmarker&&(doCheckGmarker=!0),hasNoGmarker=!!doCheckGmarker&&void 0===this.gObject,hasIdenticalScopes=!this.trackModel&&scope.$id!==this.scope.$id,hasIdenticalScopes||hasNoGmarker},MarkerChildModel.prototype.setCoords=function(scope,doDraw){if(null==doDraw&&(doDraw=!0),!this.isNotValid(scope)&&null!=this.gObject)return this.renderGMarker(doDraw,function(_this){return function(){var newGValue,newModelVal,oldGValue;if(newModelVal=_this.getProp(_this.coordsKey,_this.model),newGValue=_this.getCoords(newModelVal),oldGValue=_this.gObject.getPosition(),null==oldGValue||null==newGValue||newGValue.lng()!==oldGValue.lng()||newGValue.lat()!==oldGValue.lat())return _this.gObject.setPosition(newGValue),_this.gObject.setVisible(_this.validateCoords(newModelVal))}}(this))},MarkerChildModel.prototype.setIcon=function(scope,doDraw){if(null==doDraw&&(doDraw=!0),!this.isNotValid(scope)&&null!=this.gObject)return this.renderGMarker(doDraw,function(_this){return function(){var coords,newValue,oldValue;if(oldValue=_this.gObject.getIcon(),newValue=_this.getProp(_this.iconKey,_this.model),oldValue!==newValue)return _this.gObject.setIcon(newValue),coords=_this.getProp(_this.coordsKey,_this.model),_this.gObject.setPosition(_this.getCoords(coords)),_this.gObject.setVisible(_this.validateCoords(coords))}}(this))},MarkerChildModel.prototype.setOptions=function(scope,doDraw){var ref;if(null==doDraw&&(doDraw=!0),!this.isNotValid(scope,!1)){if(this.renderGMarker(doDraw,function(_this){return function(){var _options,coords,icon;if(coords=_this.getProp(_this.coordsKey,_this.model),icon=_this.getProp(_this.iconKey,_this.model),_options=_this.getProp(_this.optionsKey,_this.model),_this.opts=_this.createOptions(coords,icon,_options),_this.isLabel(_this.gObject)!==_this.isLabel(_this.opts)&&null!=_this.gObject&&(_this.gManager.remove(_this.gObject),_this.gObject=void 0),null!=_this.gObject&&_this.gObject.setOptions(_this.setLabelOptions(_this.opts)),_this.gObject||(_this.isLabel(_this.opts)?_this.gObject=new MarkerWithLabel(_this.setLabelOptions(_this.opts)):_this.gObject=new google.maps.Marker(_this.opts),_.extend(_this.gObject,{model:_this.model})),_this.externalListeners&&_this.removeEvents(_this.externalListeners),_this.internalListeners&&_this.removeEvents(_this.internalListeners),_this.externalListeners=_this.setEvents(_this.gObject,_this.scope,_this.model,["dragend"]),_this.internalListeners=_this.setEvents(_this.gObject,{events:_this.internalEvents(),$evalAsync:function(){}},_this.model),null!=_this.id)return _this.gObject.key=_this.id}}(this)),this.gObject&&(this.gObject.getMap()||this.gManager.type!==MarkerManager.type))this.deferred.resolve(this.gObject);else{if(!this.gObject)return this.deferred.reject("gObject is null");null!=(ref=this.gObject)&&ref.getMap()&&this.gManager.type===MarkerManager.type||($log.debug("gObject has no map yet"),this.deferred.resolve(this.gObject))}return this.model[this.fitKey]?this.gManager.fit():void 0}},MarkerChildModel.prototype.setLabelOptions=function(opts){return opts.labelAnchor=this.getLabelPositionPoint(opts.labelAnchor),opts},MarkerChildModel.prototype.internalEvents=function(){return{dragend:function(_this){return function(marker,eventName,model,mousearg){var events,modelToSet,newCoords;return modelToSet=_this.trackModel?_this.scope.model:_this.model,newCoords=_this.setCoordsFromEvent(_this.modelOrKey(modelToSet,_this.coordsKey),_this.gObject.getPosition()),modelToSet=_this.setVal(model,_this.coordsKey,newCoords),events=_this.scope.events,null!=(null!=events?events.dragend:void 0)&&events.dragend(marker,eventName,modelToSet,mousearg),_this.scope.$apply()}}(this),click:function(_this){return function(marker,eventName,model,mousearg){var click;if(click=_.isFunction(_this.clickKey)?_this.clickKey:_this.getProp(_this.clickKey,_this.model),_this.doClick&&null!=click)return _this.scope.$evalAsync(click(marker,eventName,_this.model,mousearg))}}(this)}},MarkerChildModel}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygonChildModel",["uiGmapBasePolyChildModel","uiGmapPolygonOptionsBuilder",function(BaseGen,Builder){var PolygonChildModel,base,gFactory;return gFactory=function(opts){return new google.maps.Polygon(opts)},base=new BaseGen(Builder,gFactory),PolygonChildModel=function(superClass){function PolygonChildModel(){return PolygonChildModel.__super__.constructor.apply(this,arguments)}return extend(PolygonChildModel,superClass),PolygonChildModel}(base)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylineChildModel",["uiGmapBasePolyChildModel","uiGmapPolylineOptionsBuilder",function(BaseGen,Builder){var PolylineChildModel,base,gFactory;return gFactory=function(opts){return new google.maps.Polyline(opts)},base=BaseGen(Builder,gFactory),PolylineChildModel=function(superClass){function PolylineChildModel(){return PolylineChildModel.__super__.constructor.apply(this,arguments)}return extend(PolylineChildModel,superClass),PolylineChildModel}(base)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapWindowChildModel",["uiGmapBaseObject","uiGmapGmapUtil","uiGmapLogger","$compile","$http","$templateCache","uiGmapChromeFixes","uiGmapEventsHelper",function(BaseObject,GmapUtil,$log,$compile,$http,$templateCache,ChromeFixes,EventsHelper){var WindowChildModel;return WindowChildModel=function(superClass){function WindowChildModel(model1,scope1,opts,isIconVisibleOnClick,mapCtrl,markerScope,element,needToManualDestroy,markerIsVisibleAfterWindowClose){var maybeMarker;this.model=model1,this.scope=scope1,this.opts=opts,this.isIconVisibleOnClick=isIconVisibleOnClick,this.mapCtrl=mapCtrl,this.markerScope=markerScope,this.element=element,this.needToManualDestroy=null!=needToManualDestroy&&needToManualDestroy,this.markerIsVisibleAfterWindowClose=null==markerIsVisibleAfterWindowClose||markerIsVisibleAfterWindowClose,this.updateModel=bind(this.updateModel,this),this.destroy=bind(this.destroy,this),this.remove=bind(this.remove,this),this.getLatestPosition=bind(this.getLatestPosition,this),this.hideWindow=bind(this.hideWindow,this),this.showWindow=bind(this.showWindow,this),this.handleClick=bind(this.handleClick,this),this.watchOptions=bind(this.watchOptions,this),this.watchCoords=bind(this.watchCoords,this),this.createGWin=bind(this.createGWin,this),this.watchElement=bind(this.watchElement,this),this.watchAndDoShow=bind(this.watchAndDoShow,this),this.doShow=bind(this.doShow,this),this.clonedModel=_.clone(this.model,!0),this.getGmarker=function(){var ref,ref1;if(null!=(null!=(ref=this.markerScope)?ref.getGMarker:void 0))return null!=(ref1=this.markerScope)?ref1.getGMarker():void 0},this.listeners=[],this.createGWin(),maybeMarker=this.getGmarker(),null!=maybeMarker&&maybeMarker.setClickable(!0),this.watchElement(),this.watchOptions(),this.watchCoords(),this.watchAndDoShow(),this.scope.$on("$destroy",function(_this){return function(){return _this.destroy()}}(this)),$log.info(this)}return extend(WindowChildModel,superClass),WindowChildModel.include(GmapUtil),WindowChildModel.include(EventsHelper),WindowChildModel.prototype.doShow=function(wasOpen){return this.scope.show===!0||wasOpen?this.showWindow():this.hideWindow()},WindowChildModel.prototype.watchAndDoShow=function(){return null!=this.model.show&&(this.scope.show=this.model.show),this.scope.$watch("show",this.doShow,!0),this.doShow()},WindowChildModel.prototype.watchElement=function(){return this.scope.$watch(function(_this){return function(){var ref,wasOpen;if(_this.element||_this.html)return _this.html!==_this.element.html()&&_this.gObject?(null!=(ref=_this.opts)&&(ref.content=void 0),wasOpen=_this.gObject.isOpen(),_this.remove(),_this.createGWin(wasOpen)):void 0}}(this))},WindowChildModel.prototype.createGWin=function(isOpen){var _opts,defaults,maybeMarker,ref,ref1;if(null==isOpen&&(isOpen=!1),maybeMarker=this.getGmarker(),defaults={},null!=this.opts&&(this.scope.coords&&(this.opts.position=this.getCoords(this.scope.coords)),defaults=this.opts),this.element&&(this.html=_.isObject(this.element)?this.element.html():this.element),_opts=this.scope.options?this.scope.options:defaults,this.opts=this.createWindowOptions(maybeMarker,this.markerScope||this.scope,this.html,_opts),null!=this.opts)return this.gObject||(this.opts.boxClass&&window.InfoBox&&"function"==typeof window.InfoBox?this.gObject=new window.InfoBox(this.opts):this.gObject=new google.maps.InfoWindow(this.opts),this.listeners.push(google.maps.event.addListener(this.gObject,"domready",function(){return ChromeFixes.maybeRepaint(this.content)})),this.listeners.push(google.maps.event.addListener(this.gObject,"closeclick",function(_this){return function(){return maybeMarker&&(maybeMarker.setAnimation(_this.oldMarkerAnimation),_this.markerIsVisibleAfterWindowClose&&_.delay(function(){return maybeMarker.setVisible(!1),maybeMarker.setVisible(_this.markerIsVisibleAfterWindowClose)},250)),_this.gObject.close(),_this.model.show=!1,null!=_this.scope.closeClick?_this.scope.$evalAsync(_this.scope.closeClick()):_this.scope.$evalAsync()}}(this)))),this.gObject.setContent(this.opts.content),this.handleClick((null!=(ref=this.scope)&&null!=(ref1=ref.options)?ref1.forceClick:void 0)||isOpen),this.doShow(this.gObject.isOpen())},WindowChildModel.prototype.watchCoords=function(){var scope;return scope=null!=this.markerScope?this.markerScope:this.scope,scope.$watch("coords",function(_this){return function(newValue,oldValue){var pos;if(newValue!==oldValue){if(null==newValue)_this.hideWindow();else if(!_this.validateCoords(newValue))return void $log.error("WindowChildMarker cannot render marker as scope.coords as no position on marker: "+JSON.stringify(_this.model));if(pos=_this.getCoords(newValue),_this.gObject.setPosition(pos),_this.opts)return _this.opts.position=pos}}}(this),!0)},WindowChildModel.prototype.watchOptions=function(){return this.scope.$watch("options",function(_this){return function(newValue,oldValue){if(newValue!==oldValue&&(_this.opts=newValue,null!=_this.gObject)){if(_this.gObject.setOptions(_this.opts),null!=_this.opts.visible&&_this.opts.visible)return _this.showWindow();if(null!=_this.opts.visible)return _this.hideWindow()}}}(this),!0)},WindowChildModel.prototype.handleClick=function(forceClick){var click,maybeMarker;if(null!=this.gObject)return maybeMarker=this.getGmarker(),click=function(_this){return function(){if(null==_this.gObject&&_this.createGWin(),_this.showWindow(),null!=maybeMarker)return _this.initialMarkerVisibility=maybeMarker.getVisible(),_this.oldMarkerAnimation=maybeMarker.getAnimation(),maybeMarker.setVisible(_this.isIconVisibleOnClick)}}(this),forceClick&&click(),maybeMarker?this.listeners=this.listeners.concat(this.setEvents(maybeMarker,{events:{click:click}},this.model)):void 0},WindowChildModel.prototype.showWindow=function(){var compiled,show,templateScope;if(null!=this.gObject)return show=function(_this){return function(){var isOpen,maybeMarker,pos;if(!_this.gObject.isOpen()){if(maybeMarker=_this.getGmarker(),null!=_this.gObject&&null!=_this.gObject.getPosition&&(pos=_this.gObject.getPosition()),maybeMarker&&(pos=maybeMarker.getPosition()),!pos)return;if(_this.gObject.open(_this.mapCtrl,maybeMarker),isOpen=_this.gObject.isOpen(),_this.model.show!==isOpen)return _this.model.show=isOpen}}}(this),this.scope.templateUrl?$http.get(this.scope.templateUrl,{cache:$templateCache}).then(function(_this){return function(content){var compiled,templateScope;return templateScope=_this.scope.$new(),angular.isDefined(_this.scope.templateParameter)&&(templateScope.parameter=_this.scope.templateParameter),compiled=$compile(content.data)(templateScope),_this.gObject.setContent(compiled[0]),show()}}(this)):this.scope.template?(templateScope=this.scope.$new(),angular.isDefined(this.scope.templateParameter)&&(templateScope.parameter=this.scope.templateParameter),compiled=$compile(this.scope.template)(templateScope),this.gObject.setContent(compiled[0]),show()):show()},WindowChildModel.prototype.hideWindow=function(){if(null!=this.gObject&&this.gObject.isOpen())return this.gObject.close()},WindowChildModel.prototype.getLatestPosition=function(overridePos){var maybeMarker;return maybeMarker=this.getGmarker(),null==this.gObject||null==maybeMarker||overridePos?overridePos?this.gObject.setPosition(overridePos):void 0:this.gObject.setPosition(maybeMarker.getPosition())},WindowChildModel.prototype.remove=function(){return this.hideWindow(),this.removeEvents(this.listeners),this.listeners.length=0,delete this.gObject,delete this.opts},WindowChildModel.prototype.destroy=function(manualOverride){var ref;if(null==manualOverride&&(manualOverride=!1),this.remove(),null!=this.scope&&!(null!=(ref=this.scope)?ref.$$destroyed:void 0)&&(this.needToManualDestroy||manualOverride))return this.scope.$destroy()},WindowChildModel.prototype.updateModel=function(model){return this.clonedModel=_.extend({},model),_.extend(this.model,this.clonedModel)},WindowChildModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapBasePolysParentModel",["$timeout","uiGmapLogger","uiGmapModelKey","uiGmapModelsWatcher","uiGmapPropMap","uiGmap_async","uiGmapPromise",function($timeout,$log,ModelKey,ModelsWatcher,PropMap,_async,uiGmapPromise){return function(IPoly,PolyChildModel,gObjectName){var BasePolysParentModel;return BasePolysParentModel=function(superClass){function BasePolysParentModel(scope,element,attrs,gMap1,defaults){this.element=element,this.attrs=attrs,this.gMap=gMap1,this.defaults=defaults,this.createChild=bind(this.createChild,this),this.pieceMeal=bind(this.pieceMeal,this),this.createAllNew=bind(this.createAllNew,this),this.watchIdKey=bind(this.watchIdKey,this),this.createChildScopes=bind(this.createChildScopes,this),this.watchDestroy=bind(this.watchDestroy,this),this.onDestroy=bind(this.onDestroy,this),this.rebuildAll=bind(this.rebuildAll,this),this.doINeedToWipe=bind(this.doINeedToWipe,this),this.watchModels=bind(this.watchModels,this),BasePolysParentModel.__super__.constructor.call(this,scope),this["interface"]=IPoly,this.$log=$log,this.plurals=new PropMap,_.each(IPoly.scopeKeys,function(_this){return function(name){return _this[name+"Key"]=void 0}}(this)),this.models=void 0,this.firstTime=!0,this.$log.info(this),this.createChildScopes()}return extend(BasePolysParentModel,superClass),BasePolysParentModel.include(ModelsWatcher),BasePolysParentModel.prototype.watchModels=function(scope){return scope.$watchCollection("models",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.doINeedToWipe(newValue)||scope.doRebuildAll?_this.rebuildAll(scope,!0,!0):_this.createChildScopes(!1)}}(this))},BasePolysParentModel.prototype.doINeedToWipe=function(newValue){var newValueIsEmpty;return newValueIsEmpty=null==newValue||0===newValue.length,this.plurals.length>0&&newValueIsEmpty},BasePolysParentModel.prototype.rebuildAll=function(scope,doCreate,doDelete){return this.onDestroy(doDelete).then(function(_this){return function(){if(doCreate)return _this.createChildScopes()}}(this))},BasePolysParentModel.prototype.onDestroy=function(scope){return BasePolysParentModel.__super__.onDestroy.call(this,this.scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.plurals.values(),function(child){return child.destroy(!0)},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){var ref;return null!=(ref=_this.plurals)?ref.removeAll():void 0})}}(this))},BasePolysParentModel.prototype.watchDestroy=function(scope){return scope.$on("$destroy",function(_this){return function(){return _this.rebuildAll(scope,!1,!0)}}(this))},BasePolysParentModel.prototype.createChildScopes=function(isCreatingFromScratch){return null==isCreatingFromScratch&&(isCreatingFromScratch=!0),angular.isUndefined(this.scope.models)?void this.$log.error("No models to create "+gObjectName+"s from! I Need direct models!"):null!=this.gMap&&null!=this.scope.models?(this.watchIdKey(this.scope),isCreatingFromScratch?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1)):void 0},BasePolysParentModel.prototype.watchIdKey=function(scope){return this.setIdKey(scope),scope.$watch("idKey",function(_this){return function(newValue,oldValue){if(newValue!==oldValue&&null==newValue)return _this.idKey=newValue,_this.rebuildAll(scope,!0,!0)}}(this))},BasePolysParentModel.prototype.createAllNew=function(scope,isArray){var maybeCanceled;if(null==isArray&&(isArray=!1),this.models=scope.models,this.firstTime&&(this.watchModels(scope),this.watchDestroy(scope)),!this.didQueueInitPromise(this,scope))return maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){var child;return child=_this.createChild(model,_this.gMap),maybeCanceled&&($log.debug("createNew should fall through safely"),child.isEnabled=!1),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.firstTime=!1})}}(this))},BasePolysParentModel.prototype.pieceMeal=function(scope,isArray){var maybeCanceled,payload;if(null==isArray&&(isArray=!0),!scope.$$destroyed)return maybeCanceled=null,payload=null,this.models=scope.models,null!=scope&&this.modelsLength()&&this.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,payload.updates.length&&$log.info("polygons updates: "+payload.updates.length+" will be missed"),_async.each(payload.removals,function(child){if(null!=child)return child.destroy(),_this.plurals.remove(child.model[_this.idKey]),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){return maybeCanceled&&$log.debug("pieceMeal should fall through safely"),_this.createChild(modelToAdd,_this.gMap),maybeCanceled},_async.chunkSizeFrom(scope.chunk))})}}(this)):(this.inProgress=!1,this.rebuildAll(this.scope,!0,!0))},BasePolysParentModel.prototype.createChild=function(model,gMap){var child,childScope;return childScope=this.scope.$new(!1),this.setChildScope(IPoly.scopeKeys,childScope,model),childScope.$watch("model",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.setChildScope(childScope,newValue)}}(this),!0),childScope["static"]=this.scope["static"],child=new PolyChildModel(childScope,this.attrs,gMap,this.defaults,model),null==model[this.idKey]?void this.$log.error(gObjectName+" model has no id to assign a child to.\nThis is required for performance. Please assign id,\nor redirect id to a different key."):(this.plurals.put(model[this.idKey],child),child)},BasePolysParentModel}(ModelKey)}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapCircleParentModel",["uiGmapLogger","$timeout","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapCircleOptionsBuilder",function($log,$timeout,GmapUtil,EventsHelper,Builder){var CircleParentModel;return CircleParentModel=function(superClass){function CircleParentModel(scope,element,attrs,map,DEFAULTS){var clean,gObject,lastRadius;this.attrs=attrs,this.map=map,this.DEFAULTS=DEFAULTS,this.scope=scope,lastRadius=null,clean=function(_this){return function(){if(lastRadius=null,null!=_this.listeners)return _this.removeEvents(_this.listeners),_this.listeners=void 0}}(this),gObject=new google.maps.Circle(this.buildOpts(GmapUtil.getCoords(scope.center),scope.radius)),this.setMyOptions=function(_this){return function(newVals,oldVals){if(!_.isEqual(newVals,oldVals))return gObject.setOptions(_this.buildOpts(GmapUtil.getCoords(scope.center),scope.radius))}}(this),this.props=this.props.concat([{prop:"center",isColl:!0},{prop:"fill",isColl:!0},"radius","zIndex"]),this.watchProps(),clean(),this.listeners=this.setEvents(gObject,scope,scope,["radius_changed"]),null!=this.listeners&&this.listeners.push(google.maps.event.addListener(gObject,"radius_changed",function(){var newRadius,work;if(newRadius=gObject.getRadius(),newRadius!==lastRadius)return lastRadius=newRadius,work=function(){var ref,ref1;if(newRadius!==scope.radius&&(scope.radius=newRadius),(null!=(ref=scope.events)?ref.radius_changed:void 0)&&_.isFunction(null!=(ref1=scope.events)?ref1.radius_changed:void 0))return scope.events.radius_changed(gObject,"radius_changed",scope,arguments)},angular.mock?work():scope.$evalAsync(function(){return work()})})),null!=this.listeners&&this.listeners.push(google.maps.event.addListener(gObject,"center_changed",function(){return scope.$evalAsync(function(){return angular.isDefined(scope.center.type)?(scope.center.coordinates[1]=gObject.getCenter().lat(),scope.center.coordinates[0]=gObject.getCenter().lng()):(scope.center.latitude=gObject.getCenter().lat(),scope.center.longitude=gObject.getCenter().lng())})})),scope.$on("$destroy",function(_this){return function(){return clean(),gObject.setMap(null)}}(this)),$log.info(this)}return extend(CircleParentModel,superClass),CircleParentModel.include(GmapUtil),CircleParentModel.include(EventsHelper),CircleParentModel}(Builder)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapDrawingManagerParentModel",["uiGmapLogger","$timeout","uiGmapBaseObject","uiGmapEventsHelper",function($log,$timeout,BaseObject,EventsHelper){var DrawingManagerParentModel;return DrawingManagerParentModel=function(superClass){function DrawingManagerParentModel(scope,element,attrs,map){var gObject,listeners;this.scope=scope,this.attrs=attrs,this.map=map,gObject=new google.maps.drawing.DrawingManager(this.scope.options),gObject.setMap(this.map),listeners=void 0,null!=this.scope.control&&(this.scope.control.getDrawingManager=function(){return gObject}),!this.scope["static"]&&this.scope.options&&this.scope.$watch("options",function(newValue){return null!=gObject?gObject.setOptions(newValue):void 0},!0),null!=this.scope.events&&(listeners=this.setEvents(gObject,this.scope,this.scope),this.scope.$watch("events",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue))return null!=listeners&&_this.removeEvents(listeners),listeners=_this.setEvents(gObject,_this.scope,_this.scope)}}(this))),this.scope.$on("$destroy",function(_this){return function(){return null!=listeners&&_this.removeEvents(listeners),gObject.setMap(null),gObject=null}}(this))}return extend(DrawingManagerParentModel,superClass),DrawingManagerParentModel.include(EventsHelper),DrawingManagerParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIMarkerParentModel",["uiGmapModelKey","uiGmapLogger",function(ModelKey,Logger){var IMarkerParentModel;return IMarkerParentModel=function(superClass){function IMarkerParentModel(scope1,element,attrs,map){if(this.scope=scope1,this.element=element,this.attrs=attrs,this.map=map,this.onWatch=bind(this.onWatch,this),this.watch=bind(this.watch,this),this.validateScope=bind(this.validateScope,this),IMarkerParentModel.__super__.constructor.call(this,this.scope),this.$log=Logger,!this.validateScope(this.scope))throw new String("Unable to construct IMarkerParentModel due to invalid scope");this.doClick=angular.isDefined(this.attrs.click),null!=this.scope.options&&(this.DEFAULTS=this.scope.options),this.watch("coords",this.scope),this.watch("icon",this.scope),this.watch("options",this.scope),this.scope.$on("$destroy",function(_this){return function(){return _this.onDestroy(_this.scope)}}(this))}return extend(IMarkerParentModel,superClass),IMarkerParentModel.prototype.DEFAULTS={},IMarkerParentModel.prototype.validateScope=function(scope){var ret;return null==scope?(this.$log.error(this.constructor.name+": invalid scope used"),
!1):(ret=null!=scope.coords,ret?ret:(this.$log.error(this.constructor.name+": no valid coords attribute found"),!1))},IMarkerParentModel.prototype.watch=function(propNameToWatch,scope,equalityCheck){return null==equalityCheck&&(equalityCheck=!0),scope.$watch(propNameToWatch,function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue))return _this.onWatch(propNameToWatch,scope,newValue,oldValue)}}(this),equalityCheck)},IMarkerParentModel.prototype.onWatch=function(propNameToWatch,scope,newValue,oldValue){},IMarkerParentModel}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIWindowParentModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger",function(ModelKey,GmapUtil,Logger){var IWindowParentModel;return IWindowParentModel=function(superClass){function IWindowParentModel(scope,element,attrs,ctrls,$timeout,$compile,$http,$templateCache){IWindowParentModel.__super__.constructor.call(this,scope),this.$log=Logger,this.$timeout=$timeout,this.$compile=$compile,this.$http=$http,this.$templateCache=$templateCache,this.DEFAULTS={},null!=scope.options&&(this.DEFAULTS=scope.options)}return extend(IWindowParentModel,superClass),IWindowParentModel.include(GmapUtil),IWindowParentModel.prototype.getItem=function(scope,modelsPropToIterate,index){return"models"===modelsPropToIterate?scope[modelsPropToIterate][index]:scope[modelsPropToIterate].get(index)},IWindowParentModel}(ModelKey)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapLayerParentModel",["uiGmapBaseObject","uiGmapLogger","$timeout",function(BaseObject,Logger,$timeout){var LayerParentModel;return LayerParentModel=function(superClass){function LayerParentModel(scope,element,attrs,gMap,onLayerCreated,$log){return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.onLayerCreated=null!=onLayerCreated?onLayerCreated:void 0,this.$log=null!=$log?$log:Logger,this.createGoogleLayer=bind(this.createGoogleLayer,this),null==this.attrs.type?void this.$log.info("type attribute for the layer directive is mandatory. Layer creation aborted!!"):(this.createGoogleLayer(),this.doShow=!0,angular.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.gObject.setMap(this.gMap),this.scope.$watch("show",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.doShow=newValue,newValue?_this.gObject.setMap(_this.gMap):_this.gObject.setMap(null)}}(this),!0),this.scope.$watch("options",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.gObject.setMap(null),_this.gObject=null,_this.createGoogleLayer()}}(this),!0),void this.scope.$on("$destroy",function(_this){return function(){return _this.gObject.setMap(null)}}(this)))}return extend(LayerParentModel,superClass),LayerParentModel.prototype.createGoogleLayer=function(){var base;if(null==this.attrs.options?this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type]:new google.maps[this.attrs.namespace][this.attrs.type]:this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type](this.scope.options):new google.maps[this.attrs.namespace][this.attrs.type](this.scope.options),null!=this.gObject&&null!=this.onLayerCreated)return"function"==typeof(base=this.onLayerCreated(this.scope,this.gObject))?base(this.gObject):void 0},LayerParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMapTypeParentModel",["uiGmapBaseObject","uiGmapLogger",function(BaseObject,Logger){var MapTypeParentModel;return MapTypeParentModel=function(superClass){function MapTypeParentModel(scope,element,attrs,gMap,$log){return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.$log=null!=$log?$log:Logger,this.hideOverlay=bind(this.hideOverlay,this),this.showOverlay=bind(this.showOverlay,this),this.refreshMapType=bind(this.refreshMapType,this),this.createMapType=bind(this.createMapType,this),null==this.attrs.options?void this.$log.info("options attribute for the map-type directive is mandatory. Map type creation aborted!!"):(this.id=this.gMap.overlayMapTypesCount=this.gMap.overlayMapTypesCount+1||0,this.doShow=!0,this.createMapType(),angular.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.showOverlay(),this.scope.$watch("show",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.doShow=newValue,newValue?_this.showOverlay():_this.hideOverlay()}}(this),!0),this.scope.$watch("options",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue))return _this.refreshMapType()}}(this),!0),angular.isDefined(this.attrs.refresh)&&this.scope.$watch("refresh",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue))return _this.refreshMapType()}}(this),!0),void this.scope.$on("$destroy",function(_this){return function(){return _this.hideOverlay(),_this.mapType=null}}(this)))}return extend(MapTypeParentModel,superClass),MapTypeParentModel.prototype.createMapType=function(){if(null!=this.scope.options.getTile)this.mapType=this.scope.options;else{if(null==this.scope.options.getTileUrl)return void this.$log.info("options should provide either getTile or getTileUrl methods. Map type creation aborted!!");this.mapType=new google.maps.ImageMapType(this.scope.options)}return this.attrs.id&&this.scope.id&&(this.gMap.mapTypes.set(this.scope.id,this.mapType),angular.isDefined(this.attrs.show)||(this.doShow=!1)),this.mapType.layerId=this.id},MapTypeParentModel.prototype.refreshMapType=function(){if(this.hideOverlay(),this.mapType=null,this.createMapType(),this.doShow&&null!=this.gMap)return this.showOverlay()},MapTypeParentModel.prototype.showOverlay=function(){return this.gMap.overlayMapTypes.push(this.mapType)},MapTypeParentModel.prototype.hideOverlay=function(){var found;return found=!1,this.gMap.overlayMapTypes.forEach(function(_this){return function(mapType,index){found||mapType.layerId!==_this.id||(found=!0,_this.gMap.overlayMapTypes.removeAt(index))}}(this))},MapTypeParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMarkersParentModel",["uiGmapIMarkerParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapMarkerChildModel","uiGmap_async","uiGmapClustererMarkerManager","uiGmapMarkerManager","$timeout","uiGmapIMarker","uiGmapPromise","uiGmapGmapUtil","uiGmapLogger",function(IMarkerParentModel,ModelsWatcher,PropMap,MarkerChildModel,_async,ClustererMarkerManager,MarkerManager,$timeout,IMarker,uiGmapPromise,GmapUtil,$log){var MarkersParentModel,_setPlurals;return _setPlurals=function(val,objToSet){return objToSet.plurals=new PropMap,objToSet.scope.plurals=objToSet.plurals,objToSet},MarkersParentModel=function(superClass){function MarkersParentModel(scope,element,attrs,map){this.onDestroy=bind(this.onDestroy,this),this.newChildMarker=bind(this.newChildMarker,this),this.pieceMeal=bind(this.pieceMeal,this),this.rebuildAll=bind(this.rebuildAll,this),this.createAllNew=bind(this.createAllNew,this),this.createChildScopes=bind(this.createChildScopes,this),this.validateScope=bind(this.validateScope,this),this.onWatch=bind(this.onWatch,this);var self;MarkersParentModel.__super__.constructor.call(this,scope,element,attrs,map),this["interface"]=IMarker,self=this,_setPlurals(new PropMap,this),this.scope.pluralsUpdate={updateCtr:0},this.$log.info(this),this.doRebuildAll=null!=this.scope.doRebuildAll&&this.scope.doRebuildAll,this.setIdKey(this.scope),this.scope.$watch("doRebuildAll",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.doRebuildAll=newValue}}(this)),this.modelsLength()||(this.modelsRendered=!1),this.scope.$watch("models",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue)||!_this.modelsRendered){if(0===newValue.length&&0===oldValue.length)return;return _this.modelsRendered=!0,_this.onWatch("models",_this.scope,newValue,oldValue)}}}(this),!this.isTrue(attrs.modelsbyref)),this.watch("doCluster",this.scope),this.watch("clusterOptions",this.scope),this.watch("clusterEvents",this.scope),this.watch("fit",this.scope),this.watch("idKey",this.scope),this.gManager=void 0,this.createAllNew(this.scope)}return extend(MarkersParentModel,superClass),MarkersParentModel.include(GmapUtil),MarkersParentModel.include(ModelsWatcher),MarkersParentModel.prototype.onWatch=function(propNameToWatch,scope,newValue,oldValue){return"idKey"===propNameToWatch&&newValue!==oldValue&&(this.idKey=newValue),this.doRebuildAll||"doCluster"===propNameToWatch?this.rebuildAll(scope):this.pieceMeal(scope)},MarkersParentModel.prototype.validateScope=function(scope){var modelsNotDefined;return modelsNotDefined=angular.isUndefined(scope.models)||void 0===scope.models,modelsNotDefined&&this.$log.error(this.constructor.name+": no valid models attribute found"),MarkersParentModel.__super__.validateScope.call(this,scope)||modelsNotDefined},MarkersParentModel.prototype.createChildScopes=function(isCreatingFromScratch){if(null!=this.gMap&&null!=this.scope.models)return isCreatingFromScratch?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1)},MarkersParentModel.prototype.createAllNew=function(scope){var maybeCanceled,ref,ref1,ref2,self;if(null!=this.gManager&&(this.gManager.clear(),delete this.gManager),scope.doCluster?(scope.clusterEvents&&(self=this,this.origClusterEvents?angular.extend(scope.clusterEvents,this.origClusterEvents):this.origClusterEvents={click:null!=(ref=scope.clusterEvents)?ref.click:void 0,mouseout:null!=(ref1=scope.clusterEvents)?ref1.mouseout:void 0,mouseover:null!=(ref2=scope.clusterEvents)?ref2.mouseover:void 0},angular.extend(scope.clusterEvents,{click:function(cluster){return self.maybeExecMappedEvent(cluster,"click")},mouseout:function(cluster){return self.maybeExecMappedEvent(cluster,"mouseout")},mouseover:function(cluster){return self.maybeExecMappedEvent(cluster,"mouseover")}})),this.gManager=new ClustererMarkerManager(this.map,(void 0),scope.clusterOptions,scope.clusterEvents)):this.gManager=new MarkerManager(this.map),!this.didQueueInitPromise(this,scope))return maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){return _this.newChildMarker(model,scope),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.modelsRendered=!0,scope.fit&&_this.gManager.fit(),_this.gManager.draw(),_this.scope.pluralsUpdate.updateCtr+=1},_async.chunkSizeFrom(scope.chunk))}}(this))},MarkersParentModel.prototype.rebuildAll=function(scope){var ref;if(scope.doRebuild||void 0===scope.doRebuild)return(null!=(ref=this.scope.plurals)?ref.length:void 0)?this.onDestroy(scope).then(function(_this){return function(){return _this.createAllNew(scope)}}(this)):this.createAllNew(scope)},MarkersParentModel.prototype.pieceMeal=function(scope){var maybeCanceled,payload;if(!scope.$$destroyed)return maybeCanceled=null,payload=null,this.modelsLength()&&this.scope.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.scope.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,_async.each(payload.removals,function(child){if(null!=child)return null!=child.destroy&&child.destroy(),_this.scope.plurals.remove(child.id),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){return _this.newChildMarker(modelToAdd,scope),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.updates,function(update){return _this.updateChild(update.child,update.model),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return(payload.adds.length>0||payload.removals.length>0||payload.updates.length>0)&&(scope.plurals=_this.scope.plurals,scope.fit&&_this.gManager.fit(),_this.gManager.draw()),_this.scope.pluralsUpdate.updateCtr+=1})}}(this)):(this.inProgress=!1,this.rebuildAll(scope))},MarkersParentModel.prototype.newChildMarker=function(model,scope){var child,childScope,doDrawSelf,keys;return null==model[this.idKey]?void this.$log.error("Marker model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.$log.info("child",child,"markers",this.scope.plurals),childScope=scope.$new(!0),childScope.events=scope.events,keys={},IMarker.scopeKeys.forEach(function(k){return keys[k]=scope[k]}),child=new MarkerChildModel(childScope,model,keys,this.map,this.DEFAULTS,this.doClick,this.gManager,doDrawSelf=!1),this.scope.plurals.put(model[this.idKey],child),child)},MarkersParentModel.prototype.onDestroy=function(scope){return MarkersParentModel.__super__.onDestroy.call(this,scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.scope.plurals.values(),function(model){if(null!=model)return model.destroy(!1)},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){return null!=_this.gManager&&_this.gManager.clear(),_this.plurals.removeAll(),_this.plurals!==_this.scope.plurals&&console.error("plurals out of sync for MarkersParentModel"),_this.scope.pluralsUpdate.updateCtr+=1})}}(this))},MarkersParentModel.prototype.maybeExecMappedEvent=function(cluster,fnName){var pair,ref;if(_.isFunction(null!=(ref=this.scope.clusterEvents)?ref[fnName]:void 0)&&(pair=this.mapClusterToPlurals(cluster),this.origClusterEvents[fnName]))return this.origClusterEvents[fnName](pair.cluster,pair.mapped)},MarkersParentModel.prototype.mapClusterToPlurals=function(cluster){var mapped;return mapped=cluster.getMarkers().map(function(_this){return function(g){return _this.scope.plurals.get(g.key).model}}(this)),{cluster:cluster,mapped:mapped}},MarkersParentModel.prototype.getItem=function(scope,modelsPropToIterate,index){return"models"===modelsPropToIterate?scope[modelsPropToIterate][index]:scope[modelsPropToIterate].get(index)},MarkersParentModel}(IMarkerParentModel)}])}.call(this),function(){["Polygon","Polyline"].forEach(function(name){return angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmap"+name+"sParentModel",["uiGmapBasePolysParentModel","uiGmap"+name+"ChildModel","uiGmapI"+name,function(BasePolysParentModel,ChildModel,IPoly){return BasePolysParentModel(IPoly,ChildModel,name)}])})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapRectangleParentModel",["uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapRectangleOptionsBuilder",function($log,GmapUtil,EventsHelper,Builder){var RectangleParentModel;return RectangleParentModel=function(superClass){function RectangleParentModel(scope,element,attrs,map,DEFAULTS){var bounds,clear,createBounds,dragging,fit,gObject,init,listeners,myListeners,settingBoundsFromScope,updateBounds;this.scope=scope,this.attrs=attrs,this.map=map,this.DEFAULTS=DEFAULTS,bounds=void 0,dragging=!1,myListeners=[],listeners=void 0,fit=function(_this){return function(){if(_this.isTrue(_this.attrs.fit))return _this.fitMapBounds(_this.map,bounds)}}(this),createBounds=function(_this){return function(){var ref,ref1,ref2;return null!=_this.scope.bounds&&null!=(null!=(ref=_this.scope.bounds)?ref.sw:void 0)&&null!=(null!=(ref1=_this.scope.bounds)?ref1.ne:void 0)&&_this.validateBoundPoints(_this.scope.bounds)?(bounds=_this.convertBoundPoints(_this.scope.bounds),$log.info("new new bounds created: "+JSON.stringify(bounds))):null!=_this.scope.bounds.getNorthEast&&null!=_this.scope.bounds.getSouthWest?bounds=_this.scope.bounds:null!=_this.scope.bounds?$log.error("Invalid bounds for newValue: "+JSON.stringify(null!=(ref2=_this.scope)?ref2.bounds:void 0)):void 0}}(this),createBounds(),gObject=new google.maps.Rectangle(this.buildOpts(bounds)),$log.info("gObject (rectangle) created: "+gObject),settingBoundsFromScope=!1,updateBounds=function(_this){return function(){var b,ne,sw;if(b=gObject.getBounds(),ne=b.getNorthEast(),sw=b.getSouthWest(),!settingBoundsFromScope)return _this.scope.$evalAsync(function(s){if(null!=s.bounds&&null!=s.bounds.sw&&null!=s.bounds.ne&&(s.bounds.ne={latitude:ne.lat(),longitude:ne.lng()},s.bounds.sw={latitude:sw.lat(),longitude:sw.lng()}),null!=s.bounds.getNorthEast&&null!=s.bounds.getSouthWest)return s.bounds=b})}}(this),init=function(_this){return function(){return fit(),_this.removeEvents(myListeners),myListeners.push(google.maps.event.addListener(gObject,"dragstart",function(){return dragging=!0})),myListeners.push(google.maps.event.addListener(gObject,"dragend",function(){return dragging=!1,updateBounds()})),myListeners.push(google.maps.event.addListener(gObject,"bounds_changed",function(){if(!dragging)return updateBounds()}))}}(this),clear=function(_this){return function(){return _this.removeEvents(myListeners),null!=listeners&&_this.removeEvents(listeners),gObject.setMap(null)}}(this),null!=bounds&&init(),this.scope.$watch("bounds",function(newValue,oldValue){var isNew;if(!(_.isEqual(newValue,oldValue)&&null!=bounds||dragging))return settingBoundsFromScope=!0,null==newValue?void clear():(null==bounds?isNew=!0:fit(),createBounds(),gObject.setBounds(bounds),settingBoundsFromScope=!1,isNew&&null!=bounds?init():void 0)},!0),this.setMyOptions=function(_this){return function(newVals,oldVals){if(!_.isEqual(newVals,oldVals)&&null!=bounds&&null!=newVals)return gObject.setOptions(_this.buildOpts(bounds))}}(this),this.props.push("bounds"),this.watchProps(this.props),null!=this.attrs.events&&(listeners=this.setEvents(gObject,this.scope,this.scope),this.scope.$watch("events",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue))return null!=listeners&&_this.removeEvents(listeners),listeners=_this.setEvents(gObject,_this.scope,_this.scope)}}(this))),this.scope.$on("$destroy",function(_this){return function(){return clear()}}(this)),$log.info(this)}return extend(RectangleParentModel,superClass),RectangleParentModel.include(GmapUtil),RectangleParentModel.include(EventsHelper),RectangleParentModel}(Builder)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapSearchBoxParentModel",["uiGmapBaseObject","uiGmapLogger","uiGmapEventsHelper","$timeout","$http","$templateCache",function(BaseObject,Logger,EventsHelper,$timeout,$http,$templateCache){var SearchBoxParentModel;return SearchBoxParentModel=function(superClass){function SearchBoxParentModel(scope,element,attrs,gMap,ctrlPosition,template,$log){var controlDiv;return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.ctrlPosition=ctrlPosition,this.template=template,this.$log=null!=$log?$log:Logger,this.setVisibility=bind(this.setVisibility,this),this.getBounds=bind(this.getBounds,this),this.setBounds=bind(this.setBounds,this),this.createSearchBox=bind(this.createSearchBox,this),this.addToParentDiv=bind(this.addToParentDiv,this),this.addAsMapControl=bind(this.addAsMapControl,this),this.init=bind(this.init,this),null==this.attrs.template?void this.$log.error("template attribute for the search-box directive is mandatory. Places Search Box creation aborted!!"):(angular.isUndefined(this.scope.options)&&(this.scope.options={},this.scope.options.visible=!0),angular.isUndefined(this.scope.options.visible)&&(this.scope.options.visible=!0),angular.isUndefined(this.scope.options.autocomplete)&&(this.scope.options.autocomplete=!1),this.visible=this.scope.options.visible,this.autocomplete=this.scope.options.autocomplete,controlDiv=angular.element("<div></div>"),controlDiv.append(this.template),this.input=controlDiv.find("input")[0],void this.init())}return extend(SearchBoxParentModel,superClass),SearchBoxParentModel.include(EventsHelper),SearchBoxParentModel.prototype.init=function(){return this.createSearchBox(),this.scope.$watch("options",function(_this){return function(newValue,oldValue){if(angular.isObject(newValue)&&(null!=newValue.bounds&&_this.setBounds(newValue.bounds),null!=newValue.visible&&_this.visible!==newValue.visible))return _this.setVisibility(newValue.visible)}}(this),!0),null!=this.attrs.parentdiv?this.addToParentDiv():this.addAsMapControl(),this.autocomplete?this.listener=google.maps.event.addListener(this.gObject,"place_changed",function(_this){return function(){return _this.places=_this.gObject.getPlace()}}(this)):this.listener=google.maps.event.addListener(this.gObject,"places_changed",function(_this){return function(){return _this.places=_this.gObject.getPlaces()}}(this)),this.listeners=this.setEvents(this.gObject,this.scope,this.scope),this.$log.info(this),this.scope.$on("$destroy",function(_this){return function(){return _this.gObject=null}}(this))},SearchBoxParentModel.prototype.addAsMapControl=function(){return this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input)},SearchBoxParentModel.prototype.addToParentDiv=function(){return this.parentDiv=angular.element(document.getElementById(this.scope.parentdiv)),this.parentDiv.append(this.input)},SearchBoxParentModel.prototype.createSearchBox=function(){return this.autocomplete?this.gObject=new google.maps.places.Autocomplete(this.input,this.scope.options):this.gObject=new google.maps.places.SearchBox(this.input,this.scope.options)},SearchBoxParentModel.prototype.setBounds=function(bounds){if(angular.isUndefined(bounds.isEmpty))this.$log.error("Error: SearchBoxParentModel setBounds. Bounds not an instance of LatLngBounds.");else if(bounds.isEmpty()===!1&&null!=this.gObject)return this.gObject.setBounds(bounds)},SearchBoxParentModel.prototype.getBounds=function(){return this.gObject.getBounds()},SearchBoxParentModel.prototype.setVisibility=function(val){return null!=this.attrs.parentdiv?val===!1?this.parentDiv.addClass("ng-hide"):this.parentDiv.removeClass("ng-hide"):val===!1?this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].clear():this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input),this.visible=val},SearchBoxParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapWindowsParentModel",["uiGmapIWindowParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapWindowChildModel","uiGmapLinked","uiGmap_async","uiGmapLogger","$timeout","$compile","$http","$templateCache","$interpolate","uiGmapPromise","uiGmapIWindow","uiGmapGmapUtil",function(IWindowParentModel,ModelsWatcher,PropMap,WindowChildModel,Linked,_async,$log,$timeout,$compile,$http,$templateCache,$interpolate,uiGmapPromise,IWindow,GmapUtil){var WindowsParentModel;return WindowsParentModel=function(superClass){function WindowsParentModel(scope,element,attrs,ctrls,gMap1,markersScope){this.gMap=gMap1,this.markersScope=markersScope,this.modelKeyComparison=bind(this.modelKeyComparison,this),this.interpolateContent=bind(this.interpolateContent,this),this.setChildScope=bind(this.setChildScope,this),this.createWindow=bind(this.createWindow,this),this.setContentKeys=bind(this.setContentKeys,this),this.pieceMeal=bind(this.pieceMeal,this),this.createAllNew=bind(this.createAllNew,this),this.watchIdKey=bind(this.watchIdKey,this),this.createChildScopes=bind(this.createChildScopes,this),this.watchOurScope=bind(this.watchOurScope,this),this.watchDestroy=bind(this.watchDestroy,this),this.onDestroy=bind(this.onDestroy,this),this.rebuildAll=bind(this.rebuildAll,this),this.doINeedToWipe=bind(this.doINeedToWipe,this),this.watchModels=bind(this.watchModels,this),this.go=bind(this.go,this),WindowsParentModel.__super__.constructor.call(this,scope,element,attrs,ctrls,$timeout,$compile,$http,$templateCache),this["interface"]=IWindow,this.plurals=new PropMap,_.each(IWindow.scopeKeys,function(_this){return function(name){return _this[name+"Key"]=void 0}}(this)),this.linked=new Linked(scope,element,attrs,ctrls),this.contentKeys=void 0,this.isIconVisibleOnClick=void 0,this.firstTime=!0,this.firstWatchModels=!0,this.$log.info(self),this.parentScope=void 0,this.go(scope)}return extend(WindowsParentModel,superClass),WindowsParentModel.include(ModelsWatcher),WindowsParentModel.prototype.go=function(scope){return this.watchOurScope(scope),this.doRebuildAll=null!=this.scope.doRebuildAll&&this.scope.doRebuildAll,scope.$watch("doRebuildAll",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.doRebuildAll=newValue}}(this)),this.createChildScopes()},WindowsParentModel.prototype.watchModels=function(scope){var itemToWatch;return itemToWatch=null!=this.markersScope?"pluralsUpdate":"models",scope.$watch(itemToWatch,function(_this){return function(newValue,oldValue){var doScratch;if(!_.isEqual(newValue,oldValue)||_this.firstWatchModels)return _this.firstWatchModels=!1,_this.doRebuildAll||_this.doINeedToWipe(scope.models)?_this.rebuildAll(scope,!0,!0):(doScratch=0===_this.plurals.length,null!=_this.existingPieces?_.last(_this.existingPieces._content).then(function(){return _this.createChildScopes(doScratch)}):_this.createChildScopes(doScratch))}}(this),!0)},WindowsParentModel.prototype.doINeedToWipe=function(newValue){var newValueIsEmpty;return newValueIsEmpty=null==newValue||0===newValue.length,this.plurals.length>0&&newValueIsEmpty},WindowsParentModel.prototype.rebuildAll=function(scope,doCreate,doDelete){return this.onDestroy(doDelete).then(function(_this){return function(){if(doCreate)return _this.createChildScopes()}}(this))},WindowsParentModel.prototype.onDestroy=function(scope){return WindowsParentModel.__super__.onDestroy.call(this,this.scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.plurals.values(),function(child){return child.destroy()},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){var ref;return null!=(ref=_this.plurals)?ref.removeAll():void 0})}}(this))},WindowsParentModel.prototype.watchDestroy=function(scope){return scope.$on("$destroy",function(_this){return function(){return _this.firstWatchModels=!0,_this.firstTime=!0,_this.rebuildAll(scope,!1,!0)}}(this))},WindowsParentModel.prototype.watchOurScope=function(scope){return _.each(IWindow.scopeKeys,function(_this){return function(name){var nameKey;return nameKey=name+"Key",_this[nameKey]="function"==typeof scope[name]?scope[name]():scope[name]}}(this))},WindowsParentModel.prototype.createChildScopes=function(isCreatingFromScratch){var modelsNotDefined,ref,ref1;return null==isCreatingFromScratch&&(isCreatingFromScratch=!0),this.isIconVisibleOnClick=!0,angular.isDefined(this.linked.attrs.isiconvisibleonclick)&&(this.isIconVisibleOnClick=this.linked.scope.isIconVisibleOnClick),modelsNotDefined=angular.isUndefined(this.linked.scope.models),!modelsNotDefined||void 0!==this.markersScope&&void 0!==(null!=(ref=this.markersScope)?ref.plurals:void 0)&&void 0!==(null!=(ref1=this.markersScope)?ref1.models:void 0)?null!=this.gMap?null!=this.linked.scope.models?(this.watchIdKey(this.linked.scope),isCreatingFromScratch?this.createAllNew(this.linked.scope,!1):this.pieceMeal(this.linked.scope,!1)):(this.parentScope=this.markersScope,this.watchIdKey(this.parentScope),isCreatingFromScratch?this.createAllNew(this.markersScope,!0,"plurals",!1):this.pieceMeal(this.markersScope,!0,"plurals",!1)):void 0:void this.$log.error("No models to create windows from! Need direct models or models derived from markers!")},WindowsParentModel.prototype.watchIdKey=function(scope){return this.setIdKey(scope),scope.$watch("idKey",function(_this){return function(newValue,oldValue){if(newValue!==oldValue&&null==newValue)return _this.idKey=newValue,_this.rebuildAll(scope,!0,!0)}}(this))},WindowsParentModel.prototype.createAllNew=function(scope,hasGMarker,modelsPropToIterate,isArray){var maybeCanceled;if(null==modelsPropToIterate&&(modelsPropToIterate="models"),null==isArray&&(isArray=!1),this.firstTime&&(this.watchModels(scope),this.watchDestroy(scope)),this.setContentKeys(scope.models),!this.didQueueInitPromise(this,scope))return maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){var gMarker,ref;return gMarker=hasGMarker&&null!=(ref=_this.getItem(scope,modelsPropToIterate,model[_this.idKey]))?ref.gObject:void 0,maybeCanceled||(!gMarker&&_this.markersScope&&$log.error("Unable to get gMarker from markersScope!"),_this.createWindow(model,gMarker,_this.gMap)),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.firstTime=!1})}}(this))},WindowsParentModel.prototype.pieceMeal=function(scope,hasGMarker,modelsPropToIterate,isArray){var maybeCanceled,payload;if(null==modelsPropToIterate&&(modelsPropToIterate="models"),null==isArray&&(isArray=!0),!scope.$$destroyed)return maybeCanceled=null,payload=null,null!=scope&&this.modelsLength()&&this.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.plurals,_this.modelKeyComparison);
}).then(function(state){return payload=state,_async.each(payload.removals,function(child){if(null!=child)return _this.plurals.remove(child.id),null!=child.destroy&&child.destroy(!0),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){var gMarker,ref;if(gMarker=null!=(ref=_this.getItem(scope,modelsPropToIterate,modelToAdd[_this.idKey]))?ref.gObject:void 0,!gMarker)throw"Gmarker undefined";return _this.createWindow(modelToAdd,gMarker,_this.gMap),maybeCanceled})}).then(function(){return _async.each(payload.updates,function(update){return _this.updateChild(update.child,update.model),maybeCanceled},_async.chunkSizeFrom(scope.chunk))})}}(this)):($log.debug("pieceMeal: rebuildAll"),this.rebuildAll(this.scope,!0,!0))},WindowsParentModel.prototype.setContentKeys=function(models){if(this.modelsLength(models))return this.contentKeys=Object.keys(models[0])},WindowsParentModel.prototype.createWindow=function(model,gMarker,gMap){var child,childScope,fakeElement,opts,ref,ref1;return childScope=this.linked.scope.$new(!1),this.setChildScope(childScope,model),childScope.$watch("model",function(_this){return function(newValue,oldValue){if(newValue!==oldValue)return _this.setChildScope(childScope,newValue)}}(this),!0),fakeElement={html:function(_this){return function(){return _this.interpolateContent(_this.linked.element.html(),model)}}(this)},this.DEFAULTS=this.scopeOrModelVal(this.optionsKey,this.scope,model)||{},opts=this.createWindowOptions(gMarker,childScope,fakeElement.html(),this.DEFAULTS),child=new WindowChildModel(model,childScope,opts,this.isIconVisibleOnClick,gMap,null!=(ref=this.markersScope)&&null!=(ref1=ref.plurals.get(model[this.idKey]))?ref1.scope:void 0,fakeElement,(!1),(!0)),null==model[this.idKey]?void this.$log.error("Window model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.plurals.put(model[this.idKey],child),child)},WindowsParentModel.prototype.setChildScope=function(childScope,model){return _.each(IWindow.scopeKeys,function(_this){return function(name){var nameKey,newValue;if(nameKey=name+"Key",newValue="self"===_this[nameKey]?model:model[_this[nameKey]],newValue!==childScope[name])return childScope[name]=newValue}}(this)),childScope.model=model},WindowsParentModel.prototype.interpolateContent=function(content,model){var exp,i,interpModel,key,len,ref;if(void 0!==this.contentKeys&&0!==this.contentKeys.length){for(exp=$interpolate(content),interpModel={},ref=this.contentKeys,i=0,len=ref.length;i<len;i++)key=ref[i],interpModel[key]=model[key];return exp(interpModel)}},WindowsParentModel.prototype.modelKeyComparison=function(model1,model2){var isEqual,scope;if(scope=null!=this.scope.coords?this.scope:this.parentScope,null==scope)throw"No scope or parentScope set!";return(isEqual=GmapUtil.equalCoords(this.evalModelHandle(model1,scope.coords),this.evalModelHandle(model2,scope.coords)))?isEqual=_.every(_.without(this["interface"].scopeKeys,"coords"),function(_this){return function(k){return _this.evalModelHandle(model1,scope[k])===_this.evalModelHandle(model2,scope[k])}}(this)):isEqual},WindowsParentModel}(IWindowParentModel)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapCircle",["uiGmapICircle","uiGmapCircleParentModel",function(ICircle,CircleParentModel){return _.extend(ICircle,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new CircleParentModel(scope,element,attrs,map)}}(this))}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapControl",["uiGmapIControl","$http","$templateCache","$compile","$controller","uiGmapGoogleMapApi",function(IControl,$http,$templateCache,$compile,$controller,GoogleMapApi){var Control;return Control=function(superClass){function Control(){this.link=bind(this.link,this),Control.__super__.constructor.call(this)}return extend(Control,superClass),Control.prototype.link=function(scope,element,attrs,ctrl){return GoogleMapApi.then(function(_this){return function(maps){var index,position;return angular.isUndefined(scope.template)?void _this.$log.error("mapControl: could not find a valid template property"):(index=angular.isDefined(scope.index&&!isNaN(parseInt(scope.index)))?parseInt(scope.index):void 0,position=angular.isDefined(scope.position)?scope.position.toUpperCase().replace(/-/g,"_"):"TOP_CENTER",maps.ControlPosition[position]?IControl.mapPromise(scope,ctrl).then(function(map){var control,controlDiv;return control=void 0,controlDiv=angular.element("<div></div>"),$http.get(scope.template,{cache:$templateCache}).success(function(template){var templateCtrl,templateScope;if(templateScope=scope.$new(),controlDiv.append(template),angular.isDefined(scope.controller)&&(templateCtrl=$controller(scope.controller,{$scope:templateScope}),controlDiv.children().data("$ngControllerController",templateCtrl)),control=$compile(controlDiv.children())(templateScope),index)return control[0].index=index}).error(function(error){return _this.$log.error("mapControl: template could not be found")}).then(function(){return map.controls[google.maps.ControlPosition[position]].push(control[0])})}):void _this.$log.error("mapControl: invalid position property"))}}(this))},Control}(IControl)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapDragZoom",["uiGmapCtrlHandle","uiGmapPropertyAction",function(CtrlHandle,PropertyAction){return{restrict:"EMA",transclude:!0,template:'<div class="angular-google-map-dragzoom" ng-transclude style="display: none"></div>',require:"^uiGmapGoogleMap",scope:{keyboardkey:"=",options:"=",spec:"="},controller:["$scope","$element",function($scope,$element){return $scope.ctrlType="uiGmapDragZoom",_.extend(this,CtrlHandle.handle($scope,$element))}],link:function(scope,element,attrs,ctrl){return CtrlHandle.mapPromise(scope,ctrl).then(function(map){var enableKeyDragZoom,setKeyAction,setOptionsAction;return enableKeyDragZoom=function(opts){if(map.enableKeyDragZoom(opts),scope.spec)return scope.spec.enableKeyDragZoom(opts)},setKeyAction=new PropertyAction(function(key,newVal){return newVal?enableKeyDragZoom({key:newVal}):enableKeyDragZoom()}),setOptionsAction=new PropertyAction(function(key,newVal){if(newVal)return enableKeyDragZoom(newVal)}),scope.$watch("keyboardkey",setKeyAction.sic),setKeyAction.sic(scope.keyboardkey),scope.$watch("options",setOptionsAction.sic),setOptionsAction.sic(scope.options)})}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapDrawingManager",["uiGmapIDrawingManager","uiGmapDrawingManagerParentModel",function(IDrawingManager,DrawingManagerParentModel){return _.extend(IDrawingManager,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(map){return new DrawingManagerParentModel(scope,element,attrs,map)})}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapApiFreeDrawPolygons",["uiGmapLogger","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapDrawFreeHandChildModel","uiGmapLodash",function($log,BaseObject,CtrlHandle,DrawFreeHandChildModel,uiGmapLodash){var FreeDrawPolygons;return FreeDrawPolygons=function(superClass){function FreeDrawPolygons(){return this.link=bind(this.link,this),FreeDrawPolygons.__super__.constructor.apply(this,arguments)}return extend(FreeDrawPolygons,superClass),FreeDrawPolygons.include(CtrlHandle),FreeDrawPolygons.prototype.restrict="EMA",FreeDrawPolygons.prototype.replace=!0,FreeDrawPolygons.prototype.require="^uiGmapGoogleMap",FreeDrawPolygons.prototype.scope={polygons:"=",draw:"=",revertmapoptions:"="},FreeDrawPolygons.prototype.link=function(scope,element,attrs,ctrl){return this.mapPromise(scope,ctrl).then(function(_this){return function(map){var freeHand,listener;return scope.polygons?_.isArray(scope.polygons)?(freeHand=new DrawFreeHandChildModel(map,scope.revertmapoptions),listener=void 0,scope.draw=function(){return"function"==typeof listener&&listener(),freeHand.engage(scope.polygons).then(function(){var firstTime;return firstTime=!0,listener=scope.$watchCollection("polygons",function(newValue,oldValue){var removals;return firstTime||newValue===oldValue?void(firstTime=!1):(removals=uiGmapLodash.differenceObjects(oldValue,newValue),removals.forEach(function(p){return p.setMap(null)}))})})}):$log.error("Free Draw Polygons must be of type Array!"):$log.error("No polygons to bind to!")}}(this))},FreeDrawPolygons}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapICircle",[function(){var DEFAULTS;return DEFAULTS={},{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{center:"=center",radius:"=radius",stroke:"=stroke",fill:"=fill",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=icons",visible:"=",events:"=",zIndex:"=zindex"}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIControl",["uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(BaseObject,Logger,CtrlHandle){var IControl;return IControl=function(superClass){function IControl(){this.restrict="EA",this.replace=!0,this.require="^uiGmapGoogleMap",this.scope={template:"@template",position:"@position",controller:"@controller",index:"@index"},this.$log=Logger}return extend(IControl,superClass),IControl.extend(CtrlHandle),IControl.prototype.link=function(scope,element,attrs,ctrl){throw new Exception("Not implemented!!")},IControl}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapIDrawingManager",[function(){return{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{"static":"@",control:"=",options:"=",events:"="}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIMarker",["uiGmapBaseObject","uiGmapCtrlHandle",function(BaseObject,CtrlHandle){var IMarker;return IMarker=function(superClass){function IMarker(){this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.replace=!0,this.scope=_.extend(this.scope||{},IMarker.scope)}return extend(IMarker,superClass),IMarker.scope={coords:"=coords",icon:"=icon",click:"&click",options:"=options",events:"=events",fit:"=fit",idKey:"=idkey",control:"=control"},IMarker.scopeKeys=_.keys(IMarker.scope),IMarker.keys=IMarker.scopeKeys,IMarker.extend(CtrlHandle),IMarker}(BaseObject)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolygon",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(GmapUtil,BaseObject,Logger,CtrlHandle){var IPolygon;return IPolygon=function(superClass){function IPolygon(){}return extend(IPolygon,superClass),IPolygon.scope={path:"=path",stroke:"=stroke",clickable:"=",draggable:"=",editable:"=",geodesic:"=",fill:"=",icons:"=icons",visible:"=","static":"=",events:"=",zIndex:"=zindex",fit:"=",control:"=control"},IPolygon.scopeKeys=_.keys(IPolygon.scope),IPolygon.include(GmapUtil),IPolygon.extend(CtrlHandle),IPolygon.prototype.restrict="EMA",IPolygon.prototype.replace=!0,IPolygon.prototype.require="^uiGmapGoogleMap",IPolygon.prototype.scope=IPolygon.scope,IPolygon.prototype.DEFAULTS={},IPolygon.prototype.$log=Logger,IPolygon}(BaseObject)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolyline",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(GmapUtil,BaseObject,Logger,CtrlHandle){var IPolyline;return IPolyline=function(superClass){function IPolyline(){}return extend(IPolyline,superClass),IPolyline.scope={path:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=",visible:"=","static":"=",fit:"=",events:"=",zIndex:"=zindex"},IPolyline.scopeKeys=_.keys(IPolyline.scope),IPolyline.include(GmapUtil),IPolyline.extend(CtrlHandle),IPolyline.prototype.restrict="EMA",IPolyline.prototype.replace=!0,IPolyline.prototype.require="^uiGmapGoogleMap",IPolyline.prototype.scope=IPolyline.scope,IPolyline.prototype.DEFAULTS={},IPolyline.prototype.$log=Logger,IPolyline}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapIRectangle",[function(){var DEFAULTS;return DEFAULTS={},{restrict:"EMA",require:"^uiGmapGoogleMap",replace:!0,scope:{bounds:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",fill:"=",visible:"=",events:"="}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIWindow",["uiGmapBaseObject","uiGmapChildEvents","uiGmapCtrlHandle",function(BaseObject,ChildEvents,CtrlHandle){var IWindow;return IWindow=function(superClass){function IWindow(){this.restrict="EMA",this.template=void 0,this.transclude=!0,this.priority=-100,this.require="^uiGmapGoogleMap",this.replace=!0,this.scope=_.extend(this.scope||{},IWindow.scope)}return extend(IWindow,superClass),IWindow.scope={coords:"=coords",template:"=template",templateUrl:"=templateurl",templateParameter:"=templateparameter",isIconVisibleOnClick:"=isiconvisibleonclick",closeClick:"&closeclick",options:"=options",control:"=control",show:"=show"},IWindow.scopeKeys=_.keys(IWindow.scope),IWindow.include(ChildEvents),IWindow.extend(CtrlHandle),IWindow}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMap",["$timeout","$q","uiGmapLogger","uiGmapGmapUtil","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapIsReady","uiGmapuuid","uiGmapExtendGWin","uiGmapExtendMarkerClusterer","uiGmapGoogleMapsUtilV3","uiGmapGoogleMapApi","uiGmapEventsHelper",function($timeout,$q,$log,GmapUtil,BaseObject,CtrlHandle,IsReady,uuid,ExtendGWin,ExtendMarkerClusterer,GoogleMapsUtilV3,GoogleMapApi,EventsHelper){var DEFAULTS,Map,initializeItems;return DEFAULTS=void 0,initializeItems=[GoogleMapsUtilV3,ExtendGWin,ExtendMarkerClusterer],Map=function(superClass){function Map(){this.link=bind(this.link,this);var ctrlFn,self;ctrlFn=function($scope){var ctrlObj,retCtrl;return retCtrl=void 0,$scope.$on("$destroy",function(){return IsReady.decrement()}),ctrlObj=CtrlHandle.handle($scope),$scope.ctrlType="Map",$scope.deferred.promise.then(function(){return initializeItems.forEach(function(i){return i.init()})}),ctrlObj.getMap=function(){return $scope.map},retCtrl=_.extend(this,ctrlObj)},this.controller=["$scope",ctrlFn],self=this}return extend(Map,superClass),Map.include(GmapUtil),Map.prototype.restrict="EMA",Map.prototype.transclude=!0,Map.prototype.replace=!1,Map.prototype.template='<div class="angular-google-map"><div class="angular-google-map-container"></div><div ng-transclude style="display: none"></div></div>',Map.prototype.scope={center:"=",zoom:"=",dragging:"=",control:"=",options:"=",events:"=",eventOpts:"=",styles:"=",bounds:"=",update:"="},Map.prototype.link=function(scope,element,attrs){var listeners,unbindCenterWatch;return listeners=[],scope.$on("$destroy",function(){return EventsHelper.removeEvents(listeners)}),scope.idleAndZoomChanged=!1,null==scope.center?void(unbindCenterWatch=scope.$watch("center",function(_this){return function(){if(scope.center)return unbindCenterWatch(),_this.link(scope,element,attrs)}}(this))):GoogleMapApi.then(function(_this){return function(maps){var _gMap,customListeners,disabledEvents,dragging,el,eventName,getEventHandler,mapOptions,maybeHookToEvent,opts,ref,resolveSpawned,settingFromDirective,spawned,type,updateCenter,zoomPromise;if(DEFAULTS={mapTypeId:maps.MapTypeId.ROADMAP},spawned=IsReady.spawn(),resolveSpawned=function(){return spawned.deferred.resolve({instance:spawned.instance,map:_gMap})},!_this.validateCoords(scope.center))return void $log.error("angular-google-maps: could not find a valid center property");if(!angular.isDefined(scope.zoom))return void $log.error("angular-google-maps: map zoom property not set");if(el=angular.element(element),el.addClass("angular-google-map"),opts={options:{}},attrs.options&&(opts.options=scope.options),attrs.styles&&(opts.styles=scope.styles),attrs.type&&(type=attrs.type.toUpperCase(),google.maps.MapTypeId.hasOwnProperty(type)?opts.mapTypeId=google.maps.MapTypeId[attrs.type.toUpperCase()]:$log.error("angular-google-maps: invalid map type '"+attrs.type+"'")),mapOptions=angular.extend({},DEFAULTS,opts,{center:_this.getCoords(scope.center),zoom:scope.zoom,bounds:scope.bounds}),_gMap=new google.maps.Map(el.find("div")[1],mapOptions),_gMap.uiGmap_id=uuid.generate(),dragging=!1,listeners.push(google.maps.event.addListenerOnce(_gMap,"idle",function(){return scope.deferred.resolve(_gMap),resolveSpawned()})),disabledEvents=attrs.events&&null!=(null!=(ref=scope.events)?ref.blacklist:void 0)?scope.events.blacklist:[],_.isString(disabledEvents)&&(disabledEvents=[disabledEvents]),maybeHookToEvent=function(eventName,fn,prefn){if(!_.contains(disabledEvents,eventName))return prefn&&prefn(),listeners.push(google.maps.event.addListener(_gMap,eventName,function(){var ref1;if(!(null!=(ref1=scope.update)?ref1.lazy:void 0))return fn()}))},_.contains(disabledEvents,"all")||(maybeHookToEvent("dragstart",function(){return dragging=!0,scope.$evalAsync(function(s){if(null!=s.dragging)return s.dragging=dragging})}),maybeHookToEvent("dragend",function(){return dragging=!1,scope.$evalAsync(function(s){if(null!=s.dragging)return s.dragging=dragging})}),updateCenter=function(c,s){if(null==c&&(c=_gMap.center),null==s&&(s=scope),!_.contains(disabledEvents,"center"))if(angular.isDefined(s.center.type)){if(s.center.coordinates[1]!==c.lat()&&(s.center.coordinates[1]=c.lat()),s.center.coordinates[0]!==c.lng())return s.center.coordinates[0]=c.lng()}else if(s.center.latitude!==c.lat()&&(s.center.latitude=c.lat()),s.center.longitude!==c.lng())return s.center.longitude=c.lng()},settingFromDirective=!1,maybeHookToEvent("idle",function(){var b,ne,sw;return b=_gMap.getBounds(),ne=b.getNorthEast(),sw=b.getSouthWest(),settingFromDirective=!0,scope.$evalAsync(function(s){return updateCenter(),null===s.bounds||s.bounds===undefined||void 0===s.bounds||_.contains(disabledEvents,"bounds")||(s.bounds.northeast={latitude:ne.lat(),longitude:ne.lng()},s.bounds.southwest={latitude:sw.lat(),longitude:sw.lng()}),_.contains(disabledEvents,"zoom")||(s.zoom=_gMap.zoom,scope.idleAndZoomChanged=!scope.idleAndZoomChanged),settingFromDirective=!1})})),angular.isDefined(scope.events)&&null!==scope.events&&angular.isObject(scope.events)){getEventHandler=function(eventName){return function(){return scope.events[eventName].apply(scope,[_gMap,eventName,arguments])}},customListeners=[];for(eventName in scope.events)scope.events.hasOwnProperty(eventName)&&angular.isFunction(scope.events[eventName])&&customListeners.push(google.maps.event.addListener(_gMap,eventName,getEventHandler(eventName)));listeners.concat(customListeners)}return _gMap.getOptions=function(){return mapOptions},scope.map=_gMap,null!=attrs.control&&null!=scope.control&&(scope.control.refresh=function(maybeCoords){var coords,ref1,ref2;if(null!=_gMap)return null!=("undefined"!=typeof google&&null!==google&&null!=(ref1=google.maps)&&null!=(ref2=ref1.event)?ref2.trigger:void 0)&&null!=_gMap&&google.maps.event.trigger(_gMap,"resize"),null!=(null!=maybeCoords?maybeCoords.latitude:void 0)&&null!=(null!=maybeCoords?maybeCoords.longitude:void 0)?(coords=_this.getCoords(maybeCoords),_this.isTrue(attrs.pan)?_gMap.panTo(coords):_gMap.setCenter(coords)):void 0},scope.control.getGMap=function(){return _gMap},scope.control.getMapOptions=function(){return mapOptions},scope.control.getCustomEventListeners=function(){return customListeners},scope.control.removeEvents=function(yourListeners){return EventsHelper.removeEvents(yourListeners)}),scope.$watch("center",function(newValue,oldValue){var coords,settingCenterFromScope;if(newValue!==oldValue&&!settingFromDirective&&(coords=_this.getCoords(scope.center),coords.lat()!==_gMap.center.lat()||coords.lng()!==_gMap.center.lng()))return settingCenterFromScope=!0,dragging||(_this.validateCoords(newValue)||$log.error("Invalid center for newValue: "+JSON.stringify(newValue)),_this.isTrue(attrs.pan)&&scope.zoom===_gMap.zoom?_gMap.panTo(coords):_gMap.setCenter(coords)),settingCenterFromScope=!1},!0),zoomPromise=null,scope.$watch("zoom",function(newValue,oldValue){var ref1,ref2,settingZoomFromScope;if(null!=newValue&&!_.isEqual(newValue,oldValue)&&(null!=_gMap?_gMap.getZoom():void 0)!==(null!=scope?scope.zoom:void 0)&&!settingFromDirective)return settingZoomFromScope=!0,null!=zoomPromise&&$timeout.cancel(zoomPromise),zoomPromise=$timeout(function(){return _gMap.setZoom(newValue),settingZoomFromScope=!1},(null!=(ref1=scope.eventOpts)&&null!=(ref2=ref1.debounce)?ref2.zoomMs:void 0)+20,!1)}),scope.$watch("bounds",function(newValue,oldValue){var bounds,ne,ref1,ref2,ref3,ref4,sw;if(newValue!==oldValue)return null==(null!=newValue&&null!=(ref1=newValue.northeast)?ref1.latitude:void 0)||null==(null!=newValue&&null!=(ref2=newValue.northeast)?ref2.longitude:void 0)||null==(null!=newValue&&null!=(ref3=newValue.southwest)?ref3.latitude:void 0)||null==(null!=newValue&&null!=(ref4=newValue.southwest)?ref4.longitude:void 0)?void $log.error("Invalid map bounds for new value: "+JSON.stringify(newValue)):(ne=new google.maps.LatLng(newValue.northeast.latitude,newValue.northeast.longitude),sw=new google.maps.LatLng(newValue.southwest.latitude,newValue.southwest.longitude),bounds=new google.maps.LatLngBounds(sw,ne),_gMap.fitBounds(bounds))}),["options","styles"].forEach(function(toWatch){return scope.$watch(toWatch,function(newValue,oldValue){var watchItem;if(watchItem=this.exp,!_.isEqual(newValue,oldValue))return"options"===watchItem?opts.options=newValue:opts.options[watchItem]=newValue,null!=_gMap?_gMap.setOptions(opts):void 0},!0)})}}(this))},Map}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarker",["uiGmapIMarker","uiGmapMarkerChildModel","uiGmapMarkerManager","uiGmapLogger",function(IMarker,MarkerChildModel,MarkerManager,$log){var Marker;return Marker=function(superClass){function Marker(){this.link=bind(this.link,this),Marker.__super__.constructor.call(this),this.template='<span class="angular-google-map-marker" ng-transclude></span>',$log.info(this)}return extend(Marker,superClass),Marker.prototype.controller=["$scope","$element",function($scope,$element){return $scope.ctrlType="Marker",_.extend(this,IMarker.handle($scope,$element))}],Marker.prototype.link=function(scope,element,attrs,ctrl){var mapPromise;return mapPromise=IMarker.mapPromise(scope,ctrl),mapPromise.then(function(_this){return function(map){var doClick,doDrawSelf,gManager,keys,m,trackModel;if(gManager=new MarkerManager(map),keys=_.object(IMarker.keys,IMarker.keys),m=new MarkerChildModel(scope,scope,keys,map,{},doClick=!0,gManager,doDrawSelf=!1,trackModel=!1),m.deferred.promise.then(function(gMarker){return scope.deferred.resolve(gMarker)}),null!=scope.control)return scope.control.getGMarkers=gManager.getGMarkers}}(this)),scope.$on("$destroy",function(_this){return function(){var gManager;return"undefined"!=typeof gManager&&null!==gManager&&gManager.clear(),gManager=null}}(this))},Marker}(IMarker)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarkers",["uiGmapIMarker","uiGmapPlural","uiGmapMarkersParentModel","uiGmap_sync","uiGmapLogger",function(IMarker,Plural,MarkersParentModel,_sync,$log){var Markers;return Markers=function(superClass){function Markers(){Markers.__super__.constructor.call(this),this.template='<span class="angular-google-map-markers" ng-transclude></span>',Plural.extend(this,{doCluster:"=docluster",clusterOptions:"=clusteroptions",clusterEvents:"=clusterevents",modelsByRef:"=modelsbyref"}),$log.info(this)}return extend(Markers,superClass),Markers.prototype.controller=["$scope","$element",function($scope,$element){return $scope.ctrlType="Markers",_.extend(this,IMarker.handle($scope,$element))}],Markers.prototype.link=function(scope,element,attrs,ctrl){var parentModel,ready;return parentModel=void 0,ready=function(){return scope.deferred.resolve()},IMarker.mapPromise(scope,ctrl).then(function(map){var mapScope;return mapScope=ctrl.getScope(),mapScope.$watch("idleAndZoomChanged",function(){return _.defer(parentModel.gManager.draw)}),parentModel=new MarkersParentModel(scope,element,attrs,map),Plural.link(scope,parentModel),null!=scope.control&&(scope.control.getGMarkers=function(){var ref;return null!=(ref=parentModel.gManager)?ref.getGMarkers():void 0},scope.control.getChildMarkers=function(){return parentModel.plurals}),_.last(parentModel.existingPieces._content).then(function(){return ready()})})},Markers}(IMarker)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapPlural",[function(){var _initControl;return _initControl=function(scope,parent){if(null!=scope.control)return scope.control.updateModels=function(models){return scope.models=models,parent.createChildScopes(!1)},scope.control.newModels=function(models){return scope.models=models,parent.rebuildAll(scope,!0,!0)},scope.control.clean=function(){return parent.rebuildAll(scope,!1,!0)},scope.control.getPlurals=function(){return parent.plurals},scope.control.getManager=function(){return parent.gManager},scope.control.hasManager=function(){return null!=parent.gManager==!0},scope.control.managerDraw=function(){var ref;if(scope.control.hasManager())return null!=(ref=scope.control.getManager())?ref.draw():void 0}},{extend:function(obj,obj2){return _.extend(obj.scope||{},obj2||{},{idKey:"=idkey",doRebuildAll:"=dorebuildall",models:"=models",chunk:"=chunk",cleanchunk:"=cleanchunk",control:"=control"})},link:function(scope,parent){return _initControl(scope,parent)}}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygon",["uiGmapIPolygon","$timeout","uiGmaparray-sync","uiGmapPolygonChildModel",function(IPolygon,$timeout,arraySync,PolygonChild){var Polygon;return Polygon=function(superClass){function Polygon(){return this.link=bind(this.link,this),Polygon.__super__.constructor.apply(this,arguments)}return extend(Polygon,superClass),Polygon.prototype.link=function(scope,element,attrs,mapCtrl){var children,promise;return children=[],promise=IPolygon.mapPromise(scope,mapCtrl),null!=scope.control&&(scope.control.getInstance=this,scope.control.polygons=children,scope.control.promise=promise),promise.then(function(_this){return function(map){return children.push(new PolygonChild(scope,attrs,map,_this.DEFAULTS))}}(this))},Polygon}(IPolygon)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygons",["uiGmapIPolygon","$timeout","uiGmaparray-sync","uiGmapPolygonsParentModel","uiGmapPlural",function(Interface,$timeout,arraySync,ParentModel,Plural){var Polygons;return Polygons=function(superClass){function Polygons(){this.link=bind(this.link,this),Polygons.__super__.constructor.call(this),Plural.extend(this),this.$log.info(this)}return extend(Polygons,superClass),Polygons.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path)&&_this.$log.warn("polygons: no valid path attribute found"),scope.models||_this.$log.warn("polygons: no models found to create from"),Plural.link(scope,new ParentModel(scope,element,attrs,map,_this.DEFAULTS))}}(this))},Polygons}(Interface)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolyline",["uiGmapIPolyline","$timeout","uiGmaparray-sync","uiGmapPolylineChildModel",function(IPolyline,$timeout,arraySync,PolylineChildModel){var Polyline;return Polyline=function(superClass){function Polyline(){return this.link=bind(this.link,this),
Polyline.__super__.constructor.apply(this,arguments)}return extend(Polyline,superClass),Polyline.prototype.link=function(scope,element,attrs,mapCtrl){return IPolyline.mapPromise(scope,mapCtrl).then(function(_this){return function(map){return!angular.isUndefined(scope.path)&&null!==scope.path&&_this.validatePath(scope.path)||_this.$log.warn("polyline: no valid path attribute found"),new PolylineChildModel(scope,attrs,map,_this.DEFAULTS)}}(this))},Polyline}(IPolyline)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylines",["uiGmapIPolyline","$timeout","uiGmaparray-sync","uiGmapPolylinesParentModel","uiGmapPlural",function(IPolyline,$timeout,arraySync,PolylinesParentModel,Plural){var Polylines;return Polylines=function(superClass){function Polylines(){this.link=bind(this.link,this),Polylines.__super__.constructor.call(this),Plural.extend(this),this.$log.info(this)}return extend(Polylines,superClass),Polylines.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path)&&_this.$log.warn("polylines: no valid path attribute found"),scope.models||_this.$log.warn("polylines: no models found to create from"),Plural.link(scope,new PolylinesParentModel(scope,element,attrs,map,_this.DEFAULTS))}}(this))},Polylines}(IPolyline)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapRectangle",["uiGmapLogger","uiGmapGmapUtil","uiGmapIRectangle","uiGmapRectangleParentModel",function($log,GmapUtil,IRectangle,RectangleParentModel){return _.extend(IRectangle,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new RectangleParentModel(scope,element,attrs,map)}}(this))}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindow",["uiGmapIWindow","uiGmapGmapUtil","uiGmapWindowChildModel","uiGmapLodash","uiGmapLogger",function(IWindow,GmapUtil,WindowChildModel,uiGmapLodash,$log){var Window;return Window=function(superClass){function Window(){this.link=bind(this.link,this),Window.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarker"],this.template='<span class="angular-google-maps-window" ng-transclude></span>',$log.debug(this),this.childWindows=[]}return extend(Window,superClass),Window.include(GmapUtil),Window.prototype.link=function(scope,element,attrs,ctrls){var markerCtrl,markerScope;return markerCtrl=ctrls.length>1&&null!=ctrls[1]?ctrls[1]:void 0,markerScope=null!=markerCtrl?markerCtrl.getScope():void 0,this.mapPromise=IWindow.mapPromise(scope,ctrls[0]),this.mapPromise.then(function(_this){return function(mapCtrl){var isIconVisibleOnClick;return isIconVisibleOnClick=!0,angular.isDefined(attrs.isiconvisibleonclick)&&(isIconVisibleOnClick=scope.isIconVisibleOnClick),markerCtrl?markerScope.deferred.promise.then(function(gMarker){return _this.init(scope,element,isIconVisibleOnClick,mapCtrl,markerScope)}):void _this.init(scope,element,isIconVisibleOnClick,mapCtrl)}}(this))},Window.prototype.init=function(scope,element,isIconVisibleOnClick,mapCtrl,markerScope){var childWindow,defaults,gMarker,hasScopeCoords,opts;if(defaults=null!=scope.options?scope.options:{},hasScopeCoords=null!=scope&&this.validateCoords(scope.coords),null!=(null!=markerScope?markerScope.getGMarker:void 0)&&(gMarker=markerScope.getGMarker()),opts=hasScopeCoords?this.createWindowOptions(gMarker,scope,element.html(),defaults):defaults,null!=mapCtrl&&(childWindow=new WindowChildModel({},scope,opts,isIconVisibleOnClick,mapCtrl,markerScope,element),this.childWindows.push(childWindow),scope.$on("$destroy",function(_this){return function(){return _this.childWindows=uiGmapLodash.withoutObjects(_this.childWindows,[childWindow],function(child1,child2){return child1.scope.$id===child2.scope.$id}),_this.childWindows.length=0}}(this))),null!=scope.control&&(scope.control.getGWindows=function(_this){return function(){return _this.childWindows.map(function(child){return child.gObject})}}(this),scope.control.getChildWindows=function(_this){return function(){return _this.childWindows}}(this),scope.control.getPlurals=scope.control.getChildWindows,scope.control.showWindow=function(_this){return function(){return _this.childWindows.map(function(child){return child.showWindow()})}}(this),scope.control.hideWindow=function(_this){return function(){return _this.childWindows.map(function(child){return child.hideWindow()})}}(this)),null!=this.onChildCreation&&null!=childWindow)return this.onChildCreation(childWindow)},Window}(IWindow)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindows",["uiGmapIWindow","uiGmapPlural","uiGmapWindowsParentModel","uiGmapPromise","uiGmapLogger",function(IWindow,Plural,WindowsParentModel,uiGmapPromise,$log){var Windows;return Windows=function(superClass){function Windows(){this.init=bind(this.init,this),this.link=bind(this.link,this),Windows.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarkers"],this.template='<span class="angular-google-maps-windows" ng-transclude></span>',Plural.extend(this),$log.debug(this)}return extend(Windows,superClass),Windows.prototype.link=function(scope,element,attrs,ctrls){var mapScope,markerCtrl,markerScope;return mapScope=ctrls[0].getScope(),markerCtrl=ctrls.length>1&&null!=ctrls[1]?ctrls[1]:void 0,markerScope=null!=markerCtrl?markerCtrl.getScope():void 0,mapScope.deferred.promise.then(function(_this){return function(map){var promise,ref;return promise=(null!=markerScope&&null!=(ref=markerScope.deferred)?ref.promise:void 0)||uiGmapPromise.resolve(),promise.then(function(){var pieces,ref1;return pieces=null!=(ref1=_this.parentModel)?ref1.existingPieces:void 0,pieces?pieces.then(function(){return _this.init(scope,element,attrs,ctrls,map,markerScope)}):_this.init(scope,element,attrs,ctrls,map,markerScope)})}}(this))},Windows.prototype.init=function(scope,element,attrs,ctrls,map,additionalScope){var parentModel;if(parentModel=new WindowsParentModel(scope,element,attrs,ctrls,map,additionalScope),Plural.link(scope,parentModel),null!=scope.control)return scope.control.getGWindows=function(_this){return function(){return parentModel.plurals.map(function(child){return child.gObject})}}(this),scope.control.getChildWindows=function(_this){return function(){return parentModel.plurals}}(this)},Windows}(IWindow)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapGoogleMap",["uiGmapMap",function(Map){return new Map}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMarker",["$timeout","uiGmapMarker",function($timeout,Marker){return new Marker($timeout)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMarkers",["$timeout","uiGmapMarkers",function($timeout,Markers){return new Markers($timeout)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolygon",["uiGmapPolygon",function(Polygon){return new Polygon}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapCircle",["uiGmapCircle",function(Circle){return Circle}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolyline",["uiGmapPolyline",function(Polyline){return new Polyline}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolylines",["uiGmapPolylines",function(Polylines){return new Polylines}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapRectangle",["uiGmapLogger","uiGmapRectangle",function($log,Rectangle){return Rectangle}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapWindow",["$timeout","$compile","$http","$templateCache","uiGmapWindow",function($timeout,$compile,$http,$templateCache,Window){return new Window($timeout,$compile,$http,$templateCache)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapWindows",["$timeout","$compile","$http","$templateCache","$interpolate","uiGmapWindows",function($timeout,$compile,$http,$templateCache,$interpolate,Windows){return new Windows($timeout,$compile,$http,$templateCache,$interpolate)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapLayer",["$timeout","uiGmapLogger","uiGmapLayerParentModel",function($timeout,Logger,LayerParentModel){var Layer;return new(Layer=function(){function Layer(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-layer' ng-transclude></span>",this.replace=!0,this.scope={show:"=show",type:"=type",namespace:"=namespace",options:"=options",onCreated:"&oncreated"}}return Layer.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return null!=scope.onCreated?new LayerParentModel(scope,element,attrs,map,scope.onCreated):new LayerParentModel(scope,element,attrs,map)}}(this))},Layer}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMapControl",["uiGmapControl",function(Control){return new Control}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapDragZoom",["uiGmapDragZoom",function(DragZoom){return DragZoom}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapDrawingManager",["uiGmapDrawingManager",function(DrawingManager){return DrawingManager}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapFreeDrawPolygons",["uiGmapApiFreeDrawPolygons",function(FreeDrawPolygons){return new FreeDrawPolygons}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapMapType",["$timeout","uiGmapLogger","uiGmapMapTypeParentModel",function($timeout,Logger,MapTypeParentModel){var MapType;return new(MapType=function(){function MapType(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template='<span class="angular-google-map-layer" ng-transclude></span>',this.replace=!0,this.scope={show:"=show",options:"=options",refresh:"=refresh",id:"@"}}return MapType.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new MapTypeParentModel(scope,element,attrs,map)}}(this))},MapType}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolygons",["uiGmapPolygons",function(Polygons){return new Polygons}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapSearchBox",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapSearchBoxParentModel","$http","$templateCache","$compile",function(GoogleMapApi,Logger,SearchBoxParentModel,$http,$templateCache,$compile){var SearchBox;return new(SearchBox=function(){function SearchBox(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-search' ng-transclude></span>",this.replace=!0,this.scope={template:"=template",events:"=events",position:"=?position",options:"=?options",parentdiv:"=?parentdiv",ngModel:"=?"}}return SearchBox.prototype.require="ngModel",SearchBox.prototype.link=function(scope,element,attrs,mapCtrl){return GoogleMapApi.then(function(_this){return function(maps){return $http.get(scope.template,{cache:$templateCache}).success(function(template){return angular.isUndefined(scope.events)?void _this.$log.error("searchBox: the events property is required"):mapCtrl.getScope().deferred.promise.then(function(map){var ctrlPosition;return ctrlPosition=angular.isDefined(scope.position)?scope.position.toUpperCase().replace(/-/g,"_"):"TOP_LEFT",maps.ControlPosition[ctrlPosition]?new SearchBoxParentModel(scope,element,attrs,map,ctrlPosition,$compile(template)(scope)):void _this.$log.error("searchBox: invalid position property")})})}}(this))},SearchBox}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapShow",["$animate","uiGmapLogger",function($animate,$log){return{scope:{uiGmapShow:"=",uiGmapAfterShow:"&",uiGmapAfterHide:"&"},link:function(scope,element){var angular_post_1_3_handle,angular_pre_1_3_handle,handle;return angular_post_1_3_handle=function(animateAction,cb){return $animate[animateAction](element,"ng-hide").then(function(){return cb()})},angular_pre_1_3_handle=function(animateAction,cb){return $animate[animateAction](element,"ng-hide",cb)},handle=function(animateAction,cb){return angular.version.major>1?$log.error("uiGmapShow is not supported for Angular Major greater than 1.\nYour Major is "+angular.version.major+'"'):1===angular.version.major&&angular.version.minor<3?angular_pre_1_3_handle(animateAction,cb):angular_post_1_3_handle(animateAction,cb)},scope.$watch("uiGmapShow",function(show){if(show&&handle("removeClass",scope.uiGmapAfterShow),!show)return handle("addClass",scope.uiGmapAfterHide)})}}}])}.call(this),angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapuuid",function(){function UUID(){}return UUID.generate=function(){var a=UUID._gri,b=UUID._ha;return b(a(32),8)+"-"+b(a(16),4)+"-"+b(16384|a(12),4)+"-"+b(32768|a(14),4)+"-"+b(a(48),12)},UUID._gri=function(a){return 0>a?NaN:30>=a?0|Math.random()*(1<<a):53>=a?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<a-30)):NaN},UUID._ha=function(a,b){for(var c=a.toString(16),d=b-c.length,e="0";0<d;d>>>=1,e+=e)1&d&&(c=e+c);return c},UUID}),angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapGoogleMapsUtilV3",function(){return{init:_.once(function(){function InfoBox(opt_opts){opt_opts=opt_opts||{},google.maps.OverlayView.apply(this,arguments),this.content_=opt_opts.content||"",this.disableAutoPan_=opt_opts.disableAutoPan||!1,this.maxWidth_=opt_opts.maxWidth||0,this.pixelOffset_=opt_opts.pixelOffset||new google.maps.Size(0,0),this.position_=opt_opts.position||new google.maps.LatLng(0,0),this.zIndex_=opt_opts.zIndex||null,this.boxClass_=opt_opts.boxClass||"infoBox",this.boxStyle_=opt_opts.boxStyle||{},this.closeBoxMargin_=opt_opts.closeBoxMargin||"2px",this.closeBoxURL_=opt_opts.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===opt_opts.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=opt_opts.infoBoxClearance||new google.maps.Size(1,1),"undefined"==typeof opt_opts.visible&&("undefined"==typeof opt_opts.isHidden?opt_opts.visible=!0:opt_opts.visible=!opt_opts.isHidden),this.isHidden_=!opt_opts.visible,this.alignBottom_=opt_opts.alignBottom||!1,this.pane_=opt_opts.pane||"floatPane",this.enableEventPropagation_=opt_opts.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}function ClusterIcon(cluster,styles){cluster.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.cluster_=cluster,this.className_=cluster.getMarkerClusterer().getClusterClass(),this.styles_=styles,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(cluster.getMap())}function Cluster(mc){this.markerClusterer_=mc,this.map_=mc.getMap(),this.gridSize_=mc.getGridSize(),this.minClusterSize_=mc.getMinimumClusterSize(),this.averageCenter_=mc.getAverageCenter(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,mc.getStyles())}function MarkerClusterer(map,opt_markers,opt_options){this.extend(MarkerClusterer,google.maps.OverlayView),opt_markers=opt_markers||[],opt_options=opt_options||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=opt_options.gridSize||60,this.minClusterSize_=opt_options.minimumClusterSize||2,this.maxZoom_=opt_options.maxZoom||null,this.styles_=opt_options.styles||[],this.title_=opt_options.title||"",this.zoomOnClick_=!0,opt_options.zoomOnClick!==undefined&&(this.zoomOnClick_=opt_options.zoomOnClick),this.averageCenter_=!1,opt_options.averageCenter!==undefined&&(this.averageCenter_=opt_options.averageCenter),this.ignoreHidden_=!1,opt_options.ignoreHidden!==undefined&&(this.ignoreHidden_=opt_options.ignoreHidden),this.enableRetinaIcons_=!1,opt_options.enableRetinaIcons!==undefined&&(this.enableRetinaIcons_=opt_options.enableRetinaIcons),this.imagePath_=opt_options.imagePath||MarkerClusterer.IMAGE_PATH,this.imageExtension_=opt_options.imageExtension||MarkerClusterer.IMAGE_EXTENSION,this.imageSizes_=opt_options.imageSizes||MarkerClusterer.IMAGE_SIZES,this.calculator_=opt_options.calculator||MarkerClusterer.CALCULATOR,this.batchSize_=opt_options.batchSize||MarkerClusterer.BATCH_SIZE,this.batchSizeIE_=opt_options.batchSizeIE||MarkerClusterer.BATCH_SIZE_IE,this.clusterClass_=opt_options.clusterClass||"cluster",navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(opt_markers,!0),this.setMap(map)}function inherits(childCtor,parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype,childCtor.superClass_=parentCtor.prototype,childCtor.prototype=new tempCtor,childCtor.prototype.constructor=childCtor}function MarkerLabel_(marker,crossURL,handCursorURL){this.marker_=marker,this.handCursorURL_=marker.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.eventDiv_=document.createElement("div"),this.eventDiv_.style.cssText=this.labelDiv_.style.cssText,this.eventDiv_.setAttribute("onselectstart","return false;"),this.eventDiv_.setAttribute("ondragstart","return false;"),this.crossDiv_=MarkerLabel_.getSharedCross(crossURL)}function MarkerWithLabel(opt_options){opt_options=opt_options||{},opt_options.labelContent=opt_options.labelContent||"",opt_options.labelAnchor=opt_options.labelAnchor||new google.maps.Point(0,0),opt_options.labelClass=opt_options.labelClass||"markerLabels",opt_options.labelStyle=opt_options.labelStyle||{},opt_options.labelInBackground=opt_options.labelInBackground||!1,"undefined"==typeof opt_options.labelVisible&&(opt_options.labelVisible=!0),"undefined"==typeof opt_options.raiseOnDrag&&(opt_options.raiseOnDrag=!0),"undefined"==typeof opt_options.clickable&&(opt_options.clickable=!0),"undefined"==typeof opt_options.draggable&&(opt_options.draggable=!1),"undefined"==typeof opt_options.optimized&&(opt_options.optimized=!1),opt_options.crossImage=opt_options.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",opt_options.handCursor=opt_options.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",opt_options.optimized=!1,this.label=new MarkerLabel_(this,opt_options.crossImage,opt_options.handCursor),google.maps.Marker.apply(this,arguments)}function RichMarker(opt_options){var options=opt_options||{};this.ready_=!1,this.dragging_=!1,opt_options.visible==undefined&&(opt_options.visible=!0),opt_options.shadow==undefined&&(opt_options.shadow="7px -3px 5px rgba(88,88,88,0.7)"),opt_options.anchor==undefined&&(opt_options.anchor=RichMarkerPosition.BOTTOM),this.setValues(options)}InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var i,events,bw,me=this,cancelHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},ignoreHandler=function(e){e.returnValue=!1,e.preventDefault&&e.preventDefault(),me.enableEventPropagation_||cancelHandler(e)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(bw=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-bw.left-bw.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],events=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],i=0;i<events.length;i++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,events[i],cancelHandler));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(e){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",ignoreHandler),google.maps.event.trigger(this,"domready")}},InfoBox.prototype.getCloseBoxImg_=function(){var img="";return""!==this.closeBoxURL_&&(img="<img",img+=" src='"+this.closeBoxURL_+"'",img+=" align=right",img+=" style='",img+=" position: relative;",img+=" cursor: pointer;",img+=" margin: "+this.closeBoxMargin_+";",img+="'>"),img},InfoBox.prototype.addClickHandler_=function(){var closeBox;""!==this.closeBoxURL_?(closeBox=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(closeBox,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var me=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(me,"closeclick"),me.close()}},InfoBox.prototype.panBox_=function(disablePan){var map,bounds,xOffset=0,yOffset=0;if(!disablePan&&(map=this.getMap(),map instanceof google.maps.Map)){map.getBounds().contains(this.position_)||map.setCenter(this.position_),bounds=map.getBounds();var mapDiv=map.getDiv(),mapWidth=mapDiv.offsetWidth,mapHeight=mapDiv.offsetHeight,iwOffsetX=this.pixelOffset_.width,iwOffsetY=this.pixelOffset_.height,iwWidth=this.div_.offsetWidth,iwHeight=this.div_.offsetHeight,padX=this.infoBoxClearance_.width,padY=this.infoBoxClearance_.height,pixPosition=this.getProjection().fromLatLngToContainerPixel(this.position_);if(pixPosition.x<-iwOffsetX+padX?xOffset=pixPosition.x+iwOffsetX-padX:pixPosition.x+iwWidth+iwOffsetX+padX>mapWidth&&(xOffset=pixPosition.x+iwWidth+iwOffsetX+padX-mapWidth),this.alignBottom_?pixPosition.y<-iwOffsetY+padY+iwHeight?yOffset=pixPosition.y+iwOffsetY-padY-iwHeight:pixPosition.y+iwOffsetY+padY>mapHeight&&(yOffset=pixPosition.y+iwOffsetY+padY-mapHeight):pixPosition.y<-iwOffsetY+padY?yOffset=pixPosition.y+iwOffsetY-padY:pixPosition.y+iwHeight+iwOffsetY+padY>mapHeight&&(yOffset=pixPosition.y+iwHeight+iwOffsetY+padY-mapHeight),0!==xOffset||0!==yOffset){map.getCenter();map.panBy(xOffset,yOffset)}}},InfoBox.prototype.setBoxStyle_=function(){var i,boxStyle;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",boxStyle=this.boxStyle_;for(i in boxStyle)boxStyle.hasOwnProperty(i)&&(this.div_.style[i]=boxStyle[i]);this.div_.style.WebkitTransform="translateZ(0)","undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var computedStyle,bw={top:0,bottom:0,left:0,right:0},box=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(computedStyle=box.ownerDocument.defaultView.getComputedStyle(box,""),computedStyle&&(bw.top=parseInt(computedStyle.borderTopWidth,10)||0,bw.bottom=parseInt(computedStyle.borderBottomWidth,10)||0,bw.left=parseInt(computedStyle.borderLeftWidth,10)||0,bw.right=parseInt(computedStyle.borderRightWidth,10)||0)):document.documentElement.currentStyle&&box.currentStyle&&(bw.top=parseInt(box.currentStyle.borderTopWidth,10)||0,bw.bottom=parseInt(box.currentStyle.borderBottomWidth,10)||0,bw.left=parseInt(box.currentStyle.borderLeftWidth,10)||0,bw.right=parseInt(box.currentStyle.borderRightWidth,10)||0),bw},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var pixPosition=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=pixPosition.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(pixPosition.y+this.pixelOffset_.height)+"px":this.div_.style.top=pixPosition.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},InfoBox.prototype.setOptions=function(opt_opts){"undefined"!=typeof opt_opts.boxClass&&(this.boxClass_=opt_opts.boxClass,this.setBoxStyle_()),"undefined"!=typeof opt_opts.boxStyle&&(this.boxStyle_=opt_opts.boxStyle,this.setBoxStyle_()),"undefined"!=typeof opt_opts.content&&this.setContent(opt_opts.content),"undefined"!=typeof opt_opts.disableAutoPan&&(this.disableAutoPan_=opt_opts.disableAutoPan),"undefined"!=typeof opt_opts.maxWidth&&(this.maxWidth_=opt_opts.maxWidth),"undefined"!=typeof opt_opts.pixelOffset&&(this.pixelOffset_=opt_opts.pixelOffset),"undefined"!=typeof opt_opts.alignBottom&&(this.alignBottom_=opt_opts.alignBottom),"undefined"!=typeof opt_opts.position&&this.setPosition(opt_opts.position),"undefined"!=typeof opt_opts.zIndex&&this.setZIndex(opt_opts.zIndex),"undefined"!=typeof opt_opts.closeBoxMargin&&(this.closeBoxMargin_=opt_opts.closeBoxMargin),"undefined"!=typeof opt_opts.closeBoxURL&&(this.closeBoxURL_=opt_opts.closeBoxURL),"undefined"!=typeof opt_opts.infoBoxClearance&&(this.infoBoxClearance_=opt_opts.infoBoxClearance),"undefined"!=typeof opt_opts.isHidden&&(this.isHidden_=opt_opts.isHidden),"undefined"!=typeof opt_opts.visible&&(this.isHidden_=!opt_opts.visible),"undefined"!=typeof opt_opts.enableEventPropagation&&(this.enableEventPropagation_=opt_opts.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(content){this.content_=content,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof content.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+content:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(content)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof content.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+content:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(content))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(latlng){this.position_=latlng,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(index){this.zIndex_=index,this.div_&&(this.div_.style.zIndex=index),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.setVisible=function(isVisible){this.isHidden_=!isVisible,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.getVisible=function(){var isVisible;return isVisible="undefined"!=typeof this.getMap()&&null!==this.getMap()&&!this.isHidden_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(map,anchor){var me=this;anchor&&(this.position_=anchor.getPosition(),this.moveListener_=google.maps.event.addListener(anchor,"position_changed",function(){me.setPosition(this.getPosition())})),this.setMap(map),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){var i;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(i=0;i<this.eventListeners_.length;i++)google.maps.event.removeListener(this.eventListeners_[i]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},function(){function DragZoom(map,opt_zoomOpts){var me=this,ov=new google.maps.OverlayView;ov.onAdd=function(){me.init_(map,opt_zoomOpts)},ov.draw=function(){},ov.onRemove=function(){},ov.setMap(map),this.prjov_=ov}var toPixels=function(widthValue){var px;switch(widthValue){case"thin":px="2px";break;case"medium":px="4px";break;case"thick":px="6px";break;default:px=widthValue}return px},getBorderWidths=function(h){var computedStyle,bw={};if(document.defaultView&&document.defaultView.getComputedStyle){if(computedStyle=h.ownerDocument.defaultView.getComputedStyle(h,""))return bw.top=parseInt(computedStyle.borderTopWidth,10)||0,bw.bottom=parseInt(computedStyle.borderBottomWidth,10)||0,bw.left=parseInt(computedStyle.borderLeftWidth,10)||0,bw.right=parseInt(computedStyle.borderRightWidth,10)||0,bw}else if(document.documentElement.currentStyle&&h.currentStyle)return bw.top=parseInt(toPixels(h.currentStyle.borderTopWidth),10)||0,bw.bottom=parseInt(toPixels(h.currentStyle.borderBottomWidth),10)||0,bw.left=parseInt(toPixels(h.currentStyle.borderLeftWidth),10)||0,bw.right=parseInt(toPixels(h.currentStyle.borderRightWidth),10)||0,bw;return bw.top=parseInt(h.style["border-top-width"],10)||0,bw.bottom=parseInt(h.style["border-bottom-width"],10)||0,bw.left=parseInt(h.style["border-left-width"],10)||0,bw.right=parseInt(h.style["border-right-width"],10)||0,bw},scroll={x:0,y:0},getScrollValue=function(e){scroll.x="undefined"!=typeof document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,scroll.y="undefined"!=typeof document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop};getScrollValue();var getMousePosition=function(e){var posX=0,posY=0;return e=e||window.event,"undefined"!=typeof e.pageX?(posX=e.pageX,posY=e.pageY):"undefined"!=typeof e.clientX&&(posX=e.clientX+scroll.x,posY=e.clientY+scroll.y),{left:posX,top:posY}},getElementPosition=function(h){for(var posX=h.offsetLeft,posY=h.offsetTop,parent=h.offsetParent;null!==parent;){
parent!==document.body&&parent!==document.documentElement&&(posX-=parent.scrollLeft,posY-=parent.scrollTop);var m=parent,moffx=m.offsetLeft,moffy=m.offsetTop;if(!moffx&&!moffy&&window.getComputedStyle){var matrix=document.defaultView.getComputedStyle(m,null).MozTransform||document.defaultView.getComputedStyle(m,null).WebkitTransform;if(matrix&&"string"==typeof matrix){var parms=matrix.split(",");moffx+=parseInt(parms[4],10)||0,moffy+=parseInt(parms[5],10)||0}}posX+=moffx,posY+=moffy,parent=parent.offsetParent}return{left:posX,top:posY}},setVals=function(obj,vals){if(obj&&vals)for(var x in vals)vals.hasOwnProperty(x)&&(obj[x]=vals[x]);return obj},setOpacity=function(h,op){"undefined"!=typeof op&&(h.style.opacity=op),"undefined"!=typeof h.style.opacity&&""!==h.style.opacity&&(h.style.filter="alpha(opacity="+100*h.style.opacity+")")};DragZoom.prototype.init_=function(map,opt_zoomOpts){var i,me=this;for(this.map_=map,opt_zoomOpts=opt_zoomOpts||{},this.key_=opt_zoomOpts.key||"shift",this.key_=this.key_.toLowerCase(),this.borderWidths_=getBorderWidths(this.map_.getDiv()),this.veilDiv_=[],i=0;i<4;i++)this.veilDiv_[i]=document.createElement("div"),this.veilDiv_[i].onselectstart=function(){return!1},setVals(this.veilDiv_[i].style,{backgroundColor:"gray",opacity:.25,cursor:"crosshair"}),setVals(this.veilDiv_[i].style,opt_zoomOpts.paneStyle),setVals(this.veilDiv_[i].style,opt_zoomOpts.veilStyle),setVals(this.veilDiv_[i].style,{position:"absolute",overflow:"hidden",display:"none"}),"shift"===this.key_&&(this.veilDiv_[i].style.MozUserSelect="none"),setOpacity(this.veilDiv_[i]),"transparent"===this.veilDiv_[i].style.backgroundColor&&(this.veilDiv_[i].style.backgroundColor="white",setOpacity(this.veilDiv_[i],0)),this.map_.getDiv().appendChild(this.veilDiv_[i]);this.noZoom_=opt_zoomOpts.noZoom||!1,this.visualEnabled_=opt_zoomOpts.visualEnabled||!1,this.visualClass_=opt_zoomOpts.visualClass||"",this.visualPosition_=opt_zoomOpts.visualPosition||google.maps.ControlPosition.LEFT_TOP,this.visualPositionOffset_=opt_zoomOpts.visualPositionOffset||new google.maps.Size(35,0),this.visualPositionIndex_=opt_zoomOpts.visualPositionIndex||null,this.visualSprite_=opt_zoomOpts.visualSprite||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/mapfiles/ftr/controls/dragzoom_btn.png",this.visualSize_=opt_zoomOpts.visualSize||new google.maps.Size(20,20),this.visualTips_=opt_zoomOpts.visualTips||{},this.visualTips_.off=this.visualTips_.off||"Turn on drag zoom mode",this.visualTips_.on=this.visualTips_.on||"Turn off drag zoom mode",this.boxDiv_=document.createElement("div"),setVals(this.boxDiv_.style,{border:"4px solid #736AFF"}),setVals(this.boxDiv_.style,opt_zoomOpts.boxStyle),setVals(this.boxDiv_.style,{position:"absolute",display:"none"}),setOpacity(this.boxDiv_),this.map_.getDiv().appendChild(this.boxDiv_),this.boxBorderWidths_=getBorderWidths(this.boxDiv_),this.listeners_=[google.maps.event.addDomListener(document,"keydown",function(e){me.onKeyDown_(e)}),google.maps.event.addDomListener(document,"keyup",function(e){me.onKeyUp_(e)}),google.maps.event.addDomListener(this.veilDiv_[0],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[1],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[2],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[3],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(document,"mousedown",function(e){me.onMouseDownDocument_(e)}),google.maps.event.addDomListener(document,"mousemove",function(e){me.onMouseMove_(e)}),google.maps.event.addDomListener(document,"mouseup",function(e){me.onMouseUp_(e)}),google.maps.event.addDomListener(window,"scroll",getScrollValue)],this.hotKeyDown_=!1,this.mouseDown_=!1,this.dragging_=!1,this.startPt_=null,this.endPt_=null,this.mapWidth_=null,this.mapHeight_=null,this.mousePosn_=null,this.mapPosn_=null,this.visualEnabled_&&(this.buttonDiv_=this.initControl_(this.visualPositionOffset_),null!==this.visualPositionIndex_&&(this.buttonDiv_.index=this.visualPositionIndex_),this.map_.controls[this.visualPosition_].push(this.buttonDiv_),this.controlIndex_=this.map_.controls[this.visualPosition_].length-1)},DragZoom.prototype.initControl_=function(offset){var control,image,me=this;return control=document.createElement("div"),control.className=this.visualClass_,control.style.position="relative",control.style.overflow="hidden",control.style.height=this.visualSize_.height+"px",control.style.width=this.visualSize_.width+"px",control.title=this.visualTips_.off,image=document.createElement("img"),image.src=this.visualSprite_,image.style.position="absolute",image.style.left=-(2*this.visualSize_.width)+"px",image.style.top="0px",control.appendChild(image),control.onclick=function(e){me.hotKeyDown_=!me.hotKeyDown_,me.hotKeyDown_?(me.buttonDiv_.firstChild.style.left=-(0*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.on,me.activatedByControl_=!0,google.maps.event.trigger(me,"activate")):(me.buttonDiv_.firstChild.style.left=-(2*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.off,google.maps.event.trigger(me,"deactivate")),me.onMouseMove_(e)},control.onmouseover=function(){me.buttonDiv_.firstChild.style.left=-(1*me.visualSize_.width)+"px"},control.onmouseout=function(){me.hotKeyDown_?(me.buttonDiv_.firstChild.style.left=-(0*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.on):(me.buttonDiv_.firstChild.style.left=-(2*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.off)},control.ondragstart=function(){return!1},setVals(control.style,{cursor:"pointer",marginTop:offset.height+"px",marginLeft:offset.width+"px"}),control},DragZoom.prototype.isHotKeyDown_=function(e){var isHot;if(e=e||window.event,isHot=e.shiftKey&&"shift"===this.key_||e.altKey&&"alt"===this.key_||e.ctrlKey&&"ctrl"===this.key_,!isHot)switch(e.keyCode){case 16:"shift"===this.key_&&(isHot=!0);break;case 17:"ctrl"===this.key_&&(isHot=!0);break;case 18:"alt"===this.key_&&(isHot=!0)}return isHot},DragZoom.prototype.isMouseOnMap_=function(){var mousePosn=this.mousePosn_;if(mousePosn){var mapPosn=this.mapPosn_,mapDiv=this.map_.getDiv();return mousePosn.left>mapPosn.left&&mousePosn.left<mapPosn.left+mapDiv.offsetWidth&&mousePosn.top>mapPosn.top&&mousePosn.top<mapPosn.top+mapDiv.offsetHeight}return!1},DragZoom.prototype.setVeilVisibility_=function(){var i;if(this.map_&&this.hotKeyDown_&&this.isMouseOnMap_()){var mapDiv=this.map_.getDiv();if(this.mapWidth_=mapDiv.offsetWidth-(this.borderWidths_.left+this.borderWidths_.right),this.mapHeight_=mapDiv.offsetHeight-(this.borderWidths_.top+this.borderWidths_.bottom),this.activatedByControl_){var left=parseInt(this.buttonDiv_.style.left,10)+this.visualPositionOffset_.width,top=parseInt(this.buttonDiv_.style.top,10)+this.visualPositionOffset_.height,width=this.visualSize_.width,height=this.visualSize_.height;for(this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=left+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=left+width+"px",this.veilDiv_[1].style.width=this.mapWidth_-(left+width)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=left+"px",this.veilDiv_[2].style.width=width+"px",this.veilDiv_[2].style.height=top+"px",this.veilDiv_[3].style.top=top+height+"px",this.veilDiv_[3].style.left=left+"px",this.veilDiv_[3].style.width=width+"px",this.veilDiv_[3].style.height=this.mapHeight_-(top+height)+"px",i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="block"}else{for(this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.width=this.mapWidth_+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",i=1;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.width="0px",this.veilDiv_[i].style.height="0px";for(i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="block"}}else for(i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="none"},DragZoom.prototype.onKeyDown_=function(e){this.map_&&!this.hotKeyDown_&&this.isHotKeyDown_(e)&&(this.mapPosn_=getElementPosition(this.map_.getDiv()),this.hotKeyDown_=!0,this.activatedByControl_=!1,this.setVeilVisibility_(),google.maps.event.trigger(this,"activate"))},DragZoom.prototype.getMousePoint_=function(e){var mousePosn=getMousePosition(e),p=new google.maps.Point;return p.x=mousePosn.left-this.mapPosn_.left-this.borderWidths_.left,p.y=mousePosn.top-this.mapPosn_.top-this.borderWidths_.top,p.x=Math.min(p.x,this.mapWidth_),p.y=Math.min(p.y,this.mapHeight_),p.x=Math.max(p.x,0),p.y=Math.max(p.y,0),p},DragZoom.prototype.onMouseDown_=function(e){if(this.map_&&this.hotKeyDown_){this.mapPosn_=getElementPosition(this.map_.getDiv()),this.dragging_=!0,this.startPt_=this.endPt_=this.getMousePoint_(e),this.boxDiv_.style.width=this.boxDiv_.style.height="0px";var prj=this.prjov_.getProjection(),latlng=prj.fromContainerPixelToLatLng(this.startPt_);google.maps.event.trigger(this,"dragstart",latlng)}},DragZoom.prototype.onMouseDownDocument_=function(e){this.mouseDown_=!0},DragZoom.prototype.onMouseMove_=function(e){if(this.mousePosn_=getMousePosition(e),this.dragging_){this.endPt_=this.getMousePoint_(e);var left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),boxWidth=Math.max(0,width-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)),boxHeight=Math.max(0,height-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom));this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=left+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=left+width+"px",this.veilDiv_[1].style.width=this.mapWidth_-(left+width)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=left+"px",this.veilDiv_[2].style.width=width+"px",this.veilDiv_[2].style.height=top+"px",this.veilDiv_[3].style.top=top+height+"px",this.veilDiv_[3].style.left=left+"px",this.veilDiv_[3].style.width=width+"px",this.veilDiv_[3].style.height=this.mapHeight_-(top+height)+"px",this.boxDiv_.style.top=top+"px",this.boxDiv_.style.left=left+"px",this.boxDiv_.style.width=boxWidth+"px",this.boxDiv_.style.height=boxHeight+"px",this.boxDiv_.style.display="block",google.maps.event.trigger(this,"drag",new google.maps.Point(left,top+height),new google.maps.Point(left+width,top),this.prjov_.getProjection())}else this.mouseDown_||(this.mapPosn_=getElementPosition(this.map_.getDiv()),this.setVeilVisibility_())},DragZoom.prototype.onMouseUp_=function(e){var z,me=this;if(this.mouseDown_=!1,this.dragging_){if(this.getMousePoint_(e).x===this.startPt_.x&&this.getMousePoint_(e).y===this.startPt_.y)return void this.onKeyUp_(e);var left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),kGoogleCenteringBug=!0;kGoogleCenteringBug&&(left+=this.borderWidths_.left,top+=this.borderWidths_.top);var prj=this.prjov_.getProjection(),sw=prj.fromContainerPixelToLatLng(new google.maps.Point(left,top+height)),ne=prj.fromContainerPixelToLatLng(new google.maps.Point(left+width,top)),bnds=new google.maps.LatLngBounds(sw,ne);if(this.noZoom_)this.boxDiv_.style.display="none";else{z=this.map_.getZoom(),this.map_.fitBounds(bnds),this.map_.getZoom()<z&&this.map_.setZoom(z);var swPt=prj.fromLatLngToContainerPixel(sw),nePt=prj.fromLatLngToContainerPixel(ne);kGoogleCenteringBug&&(swPt.x-=this.borderWidths_.left,swPt.y-=this.borderWidths_.top,nePt.x-=this.borderWidths_.left,nePt.y-=this.borderWidths_.top),this.boxDiv_.style.left=swPt.x+"px",this.boxDiv_.style.top=nePt.y+"px",this.boxDiv_.style.width=Math.abs(nePt.x-swPt.x)-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)+"px",this.boxDiv_.style.height=Math.abs(nePt.y-swPt.y)-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom)+"px",setTimeout(function(){me.boxDiv_.style.display="none"},1e3)}this.dragging_=!1,this.onMouseMove_(e),google.maps.event.trigger(this,"dragend",bnds),this.isHotKeyDown_(e)||this.onKeyUp_(e)}},DragZoom.prototype.onKeyUp_=function(e){var i,left,top,width,height,prj,sw,ne,bnds=null;if(this.map_&&this.hotKeyDown_){for(this.hotKeyDown_=!1,this.dragging_&&(this.boxDiv_.style.display="none",this.dragging_=!1,left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),prj=this.prjov_.getProjection(),sw=prj.fromContainerPixelToLatLng(new google.maps.Point(left,top+height)),ne=prj.fromContainerPixelToLatLng(new google.maps.Point(left+width,top)),bnds=new google.maps.LatLngBounds(sw,ne)),i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="none";this.visualEnabled_&&(this.buttonDiv_.firstChild.style.left=-(2*this.visualSize_.width)+"px",this.buttonDiv_.title=this.visualTips_.off,this.buttonDiv_.style.display=""),google.maps.event.trigger(this,"deactivate",bnds)}},google.maps.Map.prototype.enableKeyDragZoom=function(opt_zoomOpts){this.dragZoom_=new DragZoom(this,opt_zoomOpts)},google.maps.Map.prototype.disableKeyDragZoom=function(){var i,d=this.dragZoom_;if(d){for(i=0;i<d.listeners_.length;++i)google.maps.event.removeListener(d.listeners_[i]);for(this.getDiv().removeChild(d.boxDiv_),i=0;i<d.veilDiv_.length;i++)this.getDiv().removeChild(d.veilDiv_[i]);d.visualEnabled_&&this.controls[d.visualPosition_].removeAt(d.controlIndex_),d.prjov_.setMap(null),this.dragZoom_=null}},google.maps.Map.prototype.keyDragZoomEnabled=function(){return null!==this.dragZoom_},google.maps.Map.prototype.getDragZoomObject=function(){return this.dragZoom_}}(),ClusterIcon.prototype.onAdd=function(){var cMouseDownInCluster,cDraggingMapByCluster,cClusterIcon=this;this.div_=document.createElement("div"),this.div_.className=this.className_,this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),this.boundsChangedListener_=google.maps.event.addListener(this.getMap(),"bounds_changed",function(){cDraggingMapByCluster=cMouseDownInCluster}),google.maps.event.addDomListener(this.div_,"mousedown",function(){cMouseDownInCluster=!0,cDraggingMapByCluster=!1}),google.maps.event.addDomListener(this.div_,"click",function(e){if(cMouseDownInCluster=!1,!cDraggingMapByCluster){var theBounds,mz,mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"click",cClusterIcon.cluster_),google.maps.event.trigger(mc,"clusterclick",cClusterIcon.cluster_),mc.getZoomOnClick()&&(mz=mc.getMaxZoom(),theBounds=cClusterIcon.cluster_.getBounds(),mc.getMap().fitBounds(theBounds),setTimeout(function(){mc.getMap().fitBounds(theBounds),null!==mz&&mc.getMap().getZoom()>mz&&mc.getMap().setZoom(mz+1)},100)),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseover",cClusterIcon.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseout",cClusterIcon.cluster_)})},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.removeListener(this.boundsChangedListener_),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.draw=function(){if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.top=pos.y+"px",this.div_.style.left=pos.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var img="",bp=this.backgroundPosition_.split(" "),spriteH=parseInt(bp[0].trim(),10),spriteV=parseInt(bp[1].trim(),10),pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos),img="<img src='"+this.url_+"' style='position: absolute; top: "+spriteV+"px; left: "+spriteH+"px; ",this.cluster_.getMarkerClusterer().enableRetinaIcons_||(img+="clip: rect("+-1*spriteV+"px, "+(-1*spriteH+this.width_)+"px, "+(-1*spriteV+this.height_)+"px, "+-1*spriteH+"px);"),img+="'>",this.div_.innerHTML=img+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.useStyle=function(sums){this.sums_=sums;var index=Math.max(0,sums.index-1);index=Math.min(this.styles_.length-1,index);var style=this.styles_[index];this.url_=style.url,this.height_=style.height,this.width_=style.width,this.anchorText_=style.anchorText||[0,0],this.anchorIcon_=style.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=style.textColor||"black",this.textSize_=style.textSize||11,this.textDecoration_=style.textDecoration||"none",this.fontWeight_=style.fontWeight||"bold",this.fontStyle_=style.fontStyle||"normal",this.fontFamily_=style.fontFamily||"Arial,sans-serif",this.backgroundPosition_=style.backgroundPosition||"0 0"},ClusterIcon.prototype.setCenter=function(center){this.center_=center},ClusterIcon.prototype.createCss=function(pos){var style=[];return style.push("cursor: pointer;"),style.push("position: absolute; top: "+pos.y+"px; left: "+pos.x+"px;"),style.push("width: "+this.width_+"px; height: "+this.height_+"px;"),style.join("")},ClusterIcon.prototype.getPosFromLatLng_=function(latlng){var pos=this.getProjection().fromLatLngToDivPixel(latlng);return pos.x-=this.anchorIcon_[1],pos.y-=this.anchorIcon_[0],pos.x=parseInt(pos.x,10),pos.y=parseInt(pos.y,10),pos},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){var i,bounds=new google.maps.LatLngBounds(this.center_,this.center_),markers=this.getMarkers();for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());return bounds},Cluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},Cluster.prototype.addMarker=function(marker){var i,mCount,mz;if(this.isMarkerAlreadyAdded_(marker))return!1;if(this.center_){if(this.averageCenter_){var l=this.markers_.length+1,lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l,lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng),this.calculateBounds_()}}else this.center_=marker.getPosition(),this.calculateBounds_();if(marker.isAdded=!0,this.markers_.push(marker),mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom(),null!==mz&&this.map_.getZoom()>mz)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount<this.minClusterSize_)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount===this.minClusterSize_)for(i=0;i<mCount;i++)this.markers_[i].setMap(null);else marker.setMap(null);return this.updateIcon_(),!0},Cluster.prototype.isMarkerInClusterBounds=function(marker){return this.bounds_.contains(marker.getPosition())},Cluster.prototype.calculateBounds_=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(bounds)},Cluster.prototype.updateIcon_=function(){var mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom();if(null!==mz&&this.map_.getZoom()>mz)return void this.clusterIcon_.hide();if(mCount<this.minClusterSize_)return void this.clusterIcon_.hide();var numStyles=this.markerClusterer_.getStyles().length,sums=this.markerClusterer_.getCalculator()(this.markers_,numStyles);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(sums),this.clusterIcon_.show()},Cluster.prototype.isMarkerAlreadyAdded_=function(marker){var i;if(this.markers_.indexOf)return this.markers_.indexOf(marker)!==-1;for(i=0;i<this.markers_.length;i++)if(marker===this.markers_[i])return!0;return!1},MarkerClusterer.prototype.onAdd=function(){var cMarkerClusterer=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){cMarkerClusterer.resetViewport_(!1),this.getZoom()!==(this.get("minZoom")||0)&&this.getZoom()!==this.get("maxZoom")||google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){cMarkerClusterer.redraw_()})]},MarkerClusterer.prototype.onRemove=function(){var i;for(i=0;i<this.markers_.length;i++)this.markers_[i].getMap()!==this.activeMap_&&this.markers_[i].setMap(this.activeMap_);for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.listeners_.length;i++)google.maps.event.removeListener(this.listeners_[i]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){var i,size;if(!(this.styles_.length>0))for(i=0;i<this.imageSizes_.length;i++)size=this.imageSizes_[i],this.styles_.push({url:this.imagePath_+(i+1)+"."+this.imageExtension_,height:size,width:size})},MarkerClusterer.prototype.fitMapToMarkers=function(){var i,markers=this.getMarkers(),bounds=new google.maps.LatLngBounds;for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());this.getMap().fitBounds(bounds)},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(gridSize){this.gridSize_=gridSize},MarkerClusterer.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinimumClusterSize=function(minimumClusterSize){this.minClusterSize_=minimumClusterSize},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.setMaxZoom=function(maxZoom){this.maxZoom_=maxZoom},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.setStyles=function(styles){this.styles_=styles},MarkerClusterer.prototype.getTitle=function(){return this.title_},MarkerClusterer.prototype.setTitle=function(title){this.title_=title},MarkerClusterer.prototype.getZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.setZoomOnClick=function(zoomOnClick){this.zoomOnClick_=zoomOnClick},MarkerClusterer.prototype.getAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.setAverageCenter=function(averageCenter){this.averageCenter_=averageCenter},MarkerClusterer.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},MarkerClusterer.prototype.setIgnoreHidden=function(ignoreHidden){this.ignoreHidden_=ignoreHidden},MarkerClusterer.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons_},MarkerClusterer.prototype.setEnableRetinaIcons=function(enableRetinaIcons){this.enableRetinaIcons_=enableRetinaIcons},MarkerClusterer.prototype.getImageExtension=function(){return this.imageExtension_},MarkerClusterer.prototype.setImageExtension=function(imageExtension){this.imageExtension_=imageExtension},MarkerClusterer.prototype.getImagePath=function(){return this.imagePath_},MarkerClusterer.prototype.setImagePath=function(imagePath){this.imagePath_=imagePath},MarkerClusterer.prototype.getImageSizes=function(){return this.imageSizes_},MarkerClusterer.prototype.setImageSizes=function(imageSizes){this.imageSizes_=imageSizes},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.setCalculator=function(calculator){this.calculator_=calculator},MarkerClusterer.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},MarkerClusterer.prototype.setBatchSizeIE=function(batchSizeIE){this.batchSizeIE_=batchSizeIE},MarkerClusterer.prototype.getClusterClass=function(){return this.clusterClass_},MarkerClusterer.prototype.setClusterClass=function(clusterClass){this.clusterClass_=clusterClass},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.getClusters=function(){return this.clusters_},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.addMarker=function(marker,opt_nodraw){this.pushMarkerTo_(marker),opt_nodraw||this.redraw_()},MarkerClusterer.prototype.addMarkers=function(markers,opt_nodraw){var key;for(key in markers)markers.hasOwnProperty(key)&&this.pushMarkerTo_(markers[key]);opt_nodraw||this.redraw_()},MarkerClusterer.prototype.pushMarkerTo_=function(marker){if(marker.getDraggable()){var cMarkerClusterer=this;google.maps.event.addListener(marker,"dragend",function(){cMarkerClusterer.ready_&&(this.isAdded=!1,cMarkerClusterer.repaint())})}marker.isAdded=!1,this.markers_.push(marker)},MarkerClusterer.prototype.removeMarker=function(marker,opt_nodraw){var removed=this.removeMarker_(marker);return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarkers=function(markers,opt_nodraw){var i,r,removed=!1;for(i=0;i<markers.length;i++)r=this.removeMarker_(markers[i]),removed=removed||r;return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarker_=function(marker){var i,index=-1;if(this.markers_.indexOf)index=this.markers_.indexOf(marker);else for(i=0;i<this.markers_.length;i++)if(marker===this.markers_[i]){index=i;break}return index!==-1&&(marker.setMap(null),this.markers_.splice(index,1),!0)},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},MarkerClusterer.prototype.repaint=function(){var oldClusters=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var i;for(i=0;i<oldClusters.length;i++)oldClusters[i].remove()},0)},MarkerClusterer.prototype.getExtendedBounds=function(bounds){var projection=this.getProjection(),tr=new google.maps.LatLng(bounds.getNorthEast().lat(),bounds.getNorthEast().lng()),bl=new google.maps.LatLng(bounds.getSouthWest().lat(),bounds.getSouthWest().lng()),trPix=projection.fromLatLngToDivPixel(tr);trPix.x+=this.gridSize_,trPix.y-=this.gridSize_;var blPix=projection.fromLatLngToDivPixel(bl);blPix.x-=this.gridSize_,blPix.y+=this.gridSize_;var ne=projection.fromDivPixelToLatLng(trPix),sw=projection.fromDivPixelToLatLng(blPix);return bounds.extend(ne),bounds.extend(sw),bounds},MarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},MarkerClusterer.prototype.resetViewport_=function(opt_hide){var i,marker;for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.markers_.length;i++)marker=this.markers_[i],marker.isAdded=!1,opt_hide&&marker.setMap(null)},MarkerClusterer.prototype.distanceBetweenPoints_=function(p1,p2){var R=6371,dLat=(p2.lat()-p1.lat())*Math.PI/180,dLon=(p2.lng()-p1.lng())*Math.PI/180,a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(p1.lat()*Math.PI/180)*Math.cos(p2.lat()*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c;return d},MarkerClusterer.prototype.isMarkerInBounds_=function(marker,bounds){return bounds.contains(marker.getPosition())},MarkerClusterer.prototype.addToClosestCluster_=function(marker){var i,d,cluster,center,distance=4e4,clusterToAddTo=null;for(i=0;i<this.clusters_.length;i++)cluster=this.clusters_[i],center=cluster.getCenter(),center&&(d=this.distanceBetweenPoints_(center,marker.getPosition()),d<distance&&(distance=d,clusterToAddTo=cluster));clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)?clusterToAddTo.addMarker(marker):(cluster=new Cluster(this),cluster.addMarker(marker),this.clusters_.push(cluster))},MarkerClusterer.prototype.createClusters_=function(iFirst){var i,marker,mapBounds,cMarkerClusterer=this;if(this.ready_){0===iFirst&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),mapBounds=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,(-178.48388434375)),new google.maps.LatLng((-85.08136444384544),178.00048865625));var bounds=this.getExtendedBounds(mapBounds),iLast=Math.min(iFirst+this.batchSize_,this.markers_.length);for(i=iFirst;i<iLast;i++)marker=this.markers_[i],!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)&&(!this.ignoreHidden_||this.ignoreHidden_&&marker.getVisible())&&this.addToClosestCluster_(marker);iLast<this.markers_.length?this.timerRefStatic=setTimeout(function(){cMarkerClusterer.createClusters_(iLast)},0):(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this))}},MarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){var property;for(property in object.prototype)this.prototype[property]=object.prototype[property];return this}.apply(obj1,[obj2])},MarkerClusterer.CALCULATOR=function(markers,numStyles){for(var index=0,title="",count=markers.length.toString(),dv=count;0!==dv;)dv=parseInt(dv/10,10),index++;return index=Math.min(index,numStyles),{text:count,index:index,title:title}},MarkerClusterer.BATCH_SIZE=2e3,MarkerClusterer.BATCH_SIZE_IE=500,MarkerClusterer.IMAGE_PATH="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m",MarkerClusterer.IMAGE_EXTENSION="png",MarkerClusterer.IMAGE_SIZES=[53,56,66,78,90],inherits(MarkerLabel_,google.maps.OverlayView),MarkerLabel_.getSharedCross=function(crossURL){var div;return"undefined"==typeof MarkerLabel_.getSharedCross.crossDiv&&(div=document.createElement("img"),div.style.cssText="position: absolute; z-index: 1000002; display: none;",div.style.marginLeft="-8px",div.style.marginTop="-9px",div.src=crossURL,MarkerLabel_.getSharedCross.crossDiv=div),MarkerLabel_.getSharedCross.crossDiv},MarkerLabel_.prototype.onAdd=function(){var cSavedZIndex,cLatOffset,cLngOffset,cIgnoreClick,cRaiseEnabled,cStartPosition,cStartCenter,me=this,cMouseIsDown=!1,cDraggingLabel=!1,cRaiseOffset=20,cDraggingCursor="url("+this.handCursorURL_+")",cAbortEvent=function(e){e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},cStopBounce=function(){me.marker_.setAnimation(null)};this.getPanes().overlayImage.appendChild(this.labelDiv_),this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_),"undefined"==typeof MarkerLabel_.getSharedCross.processed&&(this.getPanes().overlayImage.appendChild(this.crossDiv_),MarkerLabel_.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(me.marker_,"mouseover",e))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(e){!me.marker_.getDraggable()&&!me.marker_.getClickable()||cDraggingLabel||(this.style.cursor=me.marker_.getCursor(),google.maps.event.trigger(me.marker_,"mouseout",e));
}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(e){cDraggingLabel=!1,me.marker_.getDraggable()&&(cMouseIsDown=!0,this.style.cursor=cDraggingCursor),(me.marker_.getDraggable()||me.marker_.getClickable())&&(google.maps.event.trigger(me.marker_,"mousedown",e),cAbortEvent(e))}),google.maps.event.addDomListener(document,"mouseup",function(mEvent){var position;if(cMouseIsDown&&(cMouseIsDown=!1,me.eventDiv_.style.cursor="pointer",google.maps.event.trigger(me.marker_,"mouseup",mEvent)),cDraggingLabel){if(cRaiseEnabled){position=me.getProjection().fromLatLngToDivPixel(me.marker_.getPosition()),position.y+=cRaiseOffset,me.marker_.setPosition(me.getProjection().fromDivPixelToLatLng(position));try{me.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(cStopBounce,1406)}catch(e){}}me.crossDiv_.style.display="none",me.marker_.setZIndex(cSavedZIndex),cIgnoreClick=!0,cDraggingLabel=!1,mEvent.latLng=me.marker_.getPosition(),google.maps.event.trigger(me.marker_,"dragend",mEvent)}}),google.maps.event.addListener(me.marker_.getMap(),"mousemove",function(mEvent){var position;cMouseIsDown&&(cDraggingLabel?(mEvent.latLng=new google.maps.LatLng(mEvent.latLng.lat()-cLatOffset,mEvent.latLng.lng()-cLngOffset),position=me.getProjection().fromLatLngToDivPixel(mEvent.latLng),cRaiseEnabled&&(me.crossDiv_.style.left=position.x+"px",me.crossDiv_.style.top=position.y+"px",me.crossDiv_.style.display="",position.y-=cRaiseOffset),me.marker_.setPosition(me.getProjection().fromDivPixelToLatLng(position)),cRaiseEnabled&&(me.eventDiv_.style.top=position.y+cRaiseOffset+"px"),google.maps.event.trigger(me.marker_,"drag",mEvent)):(cLatOffset=mEvent.latLng.lat()-me.marker_.getPosition().lat(),cLngOffset=mEvent.latLng.lng()-me.marker_.getPosition().lng(),cSavedZIndex=me.marker_.getZIndex(),cStartPosition=me.marker_.getPosition(),cStartCenter=me.marker_.getMap().getCenter(),cRaiseEnabled=me.marker_.get("raiseOnDrag"),cDraggingLabel=!0,me.marker_.setZIndex(1e6),mEvent.latLng=me.marker_.getPosition(),google.maps.event.trigger(me.marker_,"dragstart",mEvent)))}),google.maps.event.addDomListener(document,"keydown",function(e){cDraggingLabel&&27===e.keyCode&&(cRaiseEnabled=!1,me.marker_.setPosition(cStartPosition),me.marker_.getMap().setCenter(cStartCenter),google.maps.event.trigger(document,"mouseup",e))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(cIgnoreClick?cIgnoreClick=!1:(google.maps.event.trigger(me.marker_,"click",e),cAbortEvent(e)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(google.maps.event.trigger(me.marker_,"dblclick",e),cAbortEvent(e))}),google.maps.event.addListener(this.marker_,"dragstart",function(mEvent){cDraggingLabel||(cRaiseEnabled=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(mEvent){cDraggingLabel||cRaiseEnabled&&(me.setPosition(cRaiseOffset),me.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(mEvent){cDraggingLabel||cRaiseEnabled&&me.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){me.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){me.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){me.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){me.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){me.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){me.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){me.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){me.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){me.setStyles()})]},MarkerLabel_.prototype.onRemove=function(){var i;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),i=0;i<this.listeners_.length;i++)google.maps.event.removeListener(this.listeners_[i])},MarkerLabel_.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles()},MarkerLabel_.prototype.setContent=function(){var content=this.marker_.get("labelContent");"undefined"==typeof content.nodeType?(this.labelDiv_.innerHTML=content,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(content),content=content.cloneNode(!0),this.eventDiv_.innerHTML="",this.eventDiv_.appendChild(content))},MarkerLabel_.prototype.setTitle=function(){this.eventDiv_.title=this.marker_.getTitle()||""},MarkerLabel_.prototype.setStyles=function(){var i,labelStyle;this.labelDiv_.className=this.marker_.get("labelClass"),this.eventDiv_.className=this.labelDiv_.className,this.labelDiv_.style.cssText="",this.eventDiv_.style.cssText="",labelStyle=this.marker_.get("labelStyle");for(i in labelStyle)labelStyle.hasOwnProperty(i)&&(this.labelDiv_.style[i]=labelStyle[i],this.eventDiv_.style[i]=labelStyle[i]);this.setMandatoryStyles()},MarkerLabel_.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+100*this.labelDiv_.style.opacity+')"',this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.eventDiv_.style.position=this.labelDiv_.style.position,this.eventDiv_.style.overflow=this.labelDiv_.style.overflow,this.eventDiv_.style.opacity=.01,this.eventDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity=1)"',this.eventDiv_.style.filter="alpha(opacity=1)",this.setAnchor(),this.setPosition(),this.setVisible()},MarkerLabel_.prototype.setAnchor=function(){var anchor=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-anchor.x+"px",this.labelDiv_.style.marginTop=-anchor.y+"px",this.eventDiv_.style.marginLeft=-anchor.x+"px",this.eventDiv_.style.marginTop=-anchor.y+"px"},MarkerLabel_.prototype.setPosition=function(yOffset){var position=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof yOffset&&(yOffset=0),this.labelDiv_.style.left=Math.round(position.x)+"px",this.labelDiv_.style.top=Math.round(position.y-yOffset)+"px",this.eventDiv_.style.left=this.labelDiv_.style.left,this.eventDiv_.style.top=this.labelDiv_.style.top,this.setZIndex()},MarkerLabel_.prototype.setZIndex=function(){var zAdjust=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+zAdjust,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+zAdjust,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)},MarkerLabel_.prototype.setVisible=function(){this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none",this.eventDiv_.style.display=this.labelDiv_.style.display},inherits(MarkerWithLabel,google.maps.Marker),MarkerWithLabel.prototype.setMap=function(theMap){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(theMap)},RichMarker.prototype=new google.maps.OverlayView,window.RichMarker=RichMarker,RichMarker.prototype.getVisible=function(){return this.get("visible")},RichMarker.prototype.getVisible=RichMarker.prototype.getVisible,RichMarker.prototype.setVisible=function(visible){this.set("visible",visible)},RichMarker.prototype.setVisible=RichMarker.prototype.setVisible,RichMarker.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())},RichMarker.prototype.visible_changed=RichMarker.prototype.visible_changed,RichMarker.prototype.setFlat=function(flat){this.set("flat",!!flat)},RichMarker.prototype.setFlat=RichMarker.prototype.setFlat,RichMarker.prototype.getFlat=function(){return this.get("flat")},RichMarker.prototype.getFlat=RichMarker.prototype.getFlat,RichMarker.prototype.getWidth=function(){return this.get("width")},RichMarker.prototype.getWidth=RichMarker.prototype.getWidth,RichMarker.prototype.getHeight=function(){return this.get("height")},RichMarker.prototype.getHeight=RichMarker.prototype.getHeight,RichMarker.prototype.setShadow=function(shadow){this.set("shadow",shadow),this.flat_changed()},RichMarker.prototype.setShadow=RichMarker.prototype.setShadow,RichMarker.prototype.getShadow=function(){return this.get("shadow")},RichMarker.prototype.getShadow=RichMarker.prototype.getShadow,RichMarker.prototype.flat_changed=function(){this.ready_&&(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},RichMarker.prototype.flat_changed=RichMarker.prototype.flat_changed,RichMarker.prototype.setZIndex=function(index){this.set("zIndex",index)},RichMarker.prototype.setZIndex=RichMarker.prototype.setZIndex,RichMarker.prototype.getZIndex=function(){return this.get("zIndex")},RichMarker.prototype.getZIndex=RichMarker.prototype.getZIndex,RichMarker.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())},RichMarker.prototype.zIndex_changed=RichMarker.prototype.zIndex_changed,RichMarker.prototype.getDraggable=function(){return this.get("draggable")},RichMarker.prototype.getDraggable=RichMarker.prototype.getDraggable,RichMarker.prototype.setDraggable=function(draggable){this.set("draggable",!!draggable)},RichMarker.prototype.setDraggable=RichMarker.prototype.setDraggable,RichMarker.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())},RichMarker.prototype.draggable_changed=RichMarker.prototype.draggable_changed,RichMarker.prototype.getPosition=function(){return this.get("position")},RichMarker.prototype.getPosition=RichMarker.prototype.getPosition,RichMarker.prototype.setPosition=function(position){this.set("position",position)},RichMarker.prototype.setPosition=RichMarker.prototype.setPosition,RichMarker.prototype.position_changed=function(){this.draw()},RichMarker.prototype.position_changed=RichMarker.prototype.position_changed,RichMarker.prototype.getAnchor=function(){return this.get("anchor")},RichMarker.prototype.getAnchor=RichMarker.prototype.getAnchor,RichMarker.prototype.setAnchor=function(anchor){this.set("anchor",anchor)},RichMarker.prototype.setAnchor=RichMarker.prototype.setAnchor,RichMarker.prototype.anchor_changed=function(){this.draw()},RichMarker.prototype.anchor_changed=RichMarker.prototype.anchor_changed,RichMarker.prototype.htmlToDocumentFragment_=function(htmlString){var tempDiv=document.createElement("DIV");if(tempDiv.innerHTML=htmlString,1==tempDiv.childNodes.length)return tempDiv.removeChild(tempDiv.firstChild);for(var fragment=document.createDocumentFragment();tempDiv.firstChild;)fragment.appendChild(tempDiv.firstChild);return fragment},RichMarker.prototype.removeChildren_=function(node){if(node)for(var child;child=node.firstChild;)node.removeChild(child)},RichMarker.prototype.setContent=function(content){this.set("content",content)},RichMarker.prototype.setContent=RichMarker.prototype.setContent,RichMarker.prototype.getContent=function(){return this.get("content")},RichMarker.prototype.getContent=RichMarker.prototype.getContent,RichMarker.prototype.content_changed=function(){if(this.markerContent_){this.removeChildren_(this.markerContent_);var content=this.getContent();if(content){"string"==typeof content&&(content=content.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),content=this.htmlToDocumentFragment_(content)),this.markerContent_.appendChild(content);for(var image,that=this,images=this.markerContent_.getElementsByTagName("IMG"),i=0;image=images[i];i++)google.maps.event.addDomListener(image,"mousedown",function(e){that.getDraggable()&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1)}),google.maps.event.addDomListener(image,"load",function(){that.draw()});google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}},RichMarker.prototype.content_changed=RichMarker.prototype.content_changed,RichMarker.prototype.setCursor_=function(whichCursor){if(this.ready_){var cursor="";navigator.userAgent.indexOf("Gecko/")!==-1?("dragging"==whichCursor&&(cursor="-moz-grabbing"),"dragready"==whichCursor&&(cursor="-moz-grab"),"draggable"==whichCursor&&(cursor="pointer")):("dragging"!=whichCursor&&"dragready"!=whichCursor||(cursor="move"),"draggable"==whichCursor&&(cursor="pointer")),this.markerWrapper_.style.cursor!=cursor&&(this.markerWrapper_.style.cursor=cursor)}},RichMarker.prototype.startDrag=function(e){if(this.getDraggable()&&!this.dragging_){this.dragging_=!0;var map=this.getMap();this.mapDraggable_=map.get("draggable"),map.set("draggable",!1),this.mouseX_=e.clientX,this.mouseY_=e.clientY,this.setCursor_("dragready"),this.markerWrapper_.style.MozUserSelect="none",this.markerWrapper_.style.KhtmlUserSelect="none",this.markerWrapper_.style.WebkitUserSelect="none",this.markerWrapper_.unselectable="on",this.markerWrapper_.onselectstart=function(){return!1},this.addDraggingListeners_(),google.maps.event.trigger(this,"dragstart")}},RichMarker.prototype.stopDrag=function(){this.getDraggable()&&this.dragging_&&(this.dragging_=!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())},RichMarker.prototype.drag=function(e){if(!this.getDraggable()||!this.dragging_)return void this.stopDrag();var dx=this.mouseX_-e.clientX,dy=this.mouseY_-e.clientY;this.mouseX_=e.clientX,this.mouseY_=e.clientY;var left=parseInt(this.markerWrapper_.style.left,10)-dx,top=parseInt(this.markerWrapper_.style.top,10)-dy;this.markerWrapper_.style.left=left+"px",this.markerWrapper_.style.top=top+"px";var offset=this.getOffset_(),point=new google.maps.Point(left-offset.width,top-offset.height),projection=this.getProjection();this.setPosition(projection.fromDivPixelToLatLng(point)),this.setCursor_("dragging"),google.maps.event.trigger(this,"drag")},RichMarker.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_),this.setCursor_("")},RichMarker.prototype.addDragging_=function(node){if(node){var that=this;this.draggableListener_=google.maps.event.addDomListener(node,"mousedown",function(e){that.startDrag(e)}),this.setCursor_("draggable")}},RichMarker.prototype.addDraggingListeners_=function(){var that=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(e){that.drag(e)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){that.stopDrag(),that.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(window,"mousemove",function(e){that.drag(e)},!0),google.maps.event.addDomListener(window,"mouseup",function(){that.stopDrag()},!0)]},RichMarker.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var listener,i=0;listener=this.draggingListeners_[i];i++)google.maps.event.removeListener(listener);this.draggingListeners_.length=0}},RichMarker.prototype.getOffset_=function(){var anchor=this.getAnchor();if("object"==typeof anchor)return anchor;var offset=new google.maps.Size(0,0);if(!this.markerContent_)return offset;var width=this.markerContent_.offsetWidth,height=this.markerContent_.offsetHeight;switch(anchor){case RichMarkerPosition.TOP_LEFT:break;case RichMarkerPosition.TOP:offset.width=-width/2;break;case RichMarkerPosition.TOP_RIGHT:offset.width=-width;break;case RichMarkerPosition.LEFT:offset.height=-height/2;break;case RichMarkerPosition.MIDDLE:offset.width=-width/2,offset.height=-height/2;break;case RichMarkerPosition.RIGHT:offset.width=-width,offset.height=-height/2;break;case RichMarkerPosition.BOTTOM_LEFT:offset.height=-height;break;case RichMarkerPosition.BOTTOM:offset.width=-width/2,offset.height=-height;break;case RichMarkerPosition.BOTTOM_RIGHT:offset.width=-width,offset.height=-height}return offset},RichMarker.prototype.onAdd=function(){if(this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute"),this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex()),this.markerWrapper_.style.display=this.getVisible()?"":"none",!this.markerContent_){this.markerContent_=document.createElement("DIV"),this.markerWrapper_.appendChild(this.markerContent_);var that=this;google.maps.event.addDomListener(this.markerContent_,"click",function(e){google.maps.event.trigger(that,"click")}),google.maps.event.addDomListener(this.markerContent_,"mouseover",function(e){google.maps.event.trigger(that,"mouseover")}),google.maps.event.addDomListener(this.markerContent_,"mouseout",function(e){google.maps.event.trigger(that,"mouseout")})}this.ready_=!0,this.content_changed(),this.flat_changed(),this.draggable_changed();var panes=this.getPanes();panes&&panes.overlayMouseTarget.appendChild(this.markerWrapper_),google.maps.event.trigger(this,"ready")},RichMarker.prototype.onAdd=RichMarker.prototype.onAdd,RichMarker.prototype.draw=function(){if(this.ready_&&!this.dragging_){var projection=this.getProjection();if(projection){var latLng=this.get("position"),pos=projection.fromLatLngToDivPixel(latLng),offset=this.getOffset_();this.markerWrapper_.style.top=pos.y+offset.height+"px",this.markerWrapper_.style.left=pos.x+offset.width+"px";var height=this.markerContent_.offsetHeight,width=this.markerContent_.offsetWidth;width!=this.get("width")&&this.set("width",width),height!=this.get("height")&&this.set("height",height)}}},RichMarker.prototype.draw=RichMarker.prototype.draw,RichMarker.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_),this.removeDragListeners_()},RichMarker.prototype.onRemove=RichMarker.prototype.onRemove;var RichMarkerPosition={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=RichMarkerPosition,window.InfoBox=InfoBox,window.Cluster=Cluster,window.ClusterIcon=ClusterIcon,window.MarkerClusterer=MarkerClusterer,window.MarkerLabel_=MarkerLabel_,window.MarkerWithLabel=MarkerWithLabel})}}),function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapDataStructures",function(){return{Graph:__webpack_require__(1).Graph,Queue:__webpack_require__(1).Queue}})},function(module,exports,__webpack_require__){(function(){module.exports={Graph:__webpack_require__(2),Heap:__webpack_require__(3),LinkedList:__webpack_require__(4),Map:__webpack_require__(5),Queue:__webpack_require__(6),RedBlackTree:__webpack_require__(7),Trie:__webpack_require__(8)}}).call(this)},function(module,exports,__webpack_require__){(function(){var Graph,__hasProp={}.hasOwnProperty;Graph=function(){function Graph(){this._nodes={},this.nodeSize=0,this.edgeSize=0}return Graph.prototype.addNode=function(id){if(!this._nodes[id])return this.nodeSize++,this._nodes[id]={_outEdges:{},_inEdges:{}}},Graph.prototype.getNode=function(id){return this._nodes[id]},Graph.prototype.removeNode=function(id){var inEdgeId,nodeToRemove,outEdgeId,_ref,_ref1;if(nodeToRemove=this._nodes[id]){_ref=nodeToRemove._outEdges;for(outEdgeId in _ref)__hasProp.call(_ref,outEdgeId)&&this.removeEdge(id,outEdgeId);_ref1=nodeToRemove._inEdges;for(inEdgeId in _ref1)__hasProp.call(_ref1,inEdgeId)&&this.removeEdge(inEdgeId,id);return this.nodeSize--,delete this._nodes[id],nodeToRemove}},Graph.prototype.addEdge=function(fromId,toId,weight){var edgeToAdd,fromNode,toNode;if(null==weight&&(weight=1),!this.getEdge(fromId,toId)&&(fromNode=this._nodes[fromId],toNode=this._nodes[toId],fromNode&&toNode))return edgeToAdd={weight:weight},fromNode._outEdges[toId]=edgeToAdd,toNode._inEdges[fromId]=edgeToAdd,this.edgeSize++,edgeToAdd},Graph.prototype.getEdge=function(fromId,toId){var fromNode,toNode;if(fromNode=this._nodes[fromId],toNode=this._nodes[toId],fromNode&&toNode)return fromNode._outEdges[toId]},Graph.prototype.removeEdge=function(fromId,toId){var edgeToDelete,fromNode,toNode;if(fromNode=this._nodes[fromId],toNode=this._nodes[toId],edgeToDelete=this.getEdge(fromId,toId))return delete fromNode._outEdges[toId],delete toNode._inEdges[fromId],this.edgeSize--,edgeToDelete},Graph.prototype.getInEdgesOf=function(nodeId){var fromId,inEdges,toNode,_ref;toNode=this._nodes[nodeId],inEdges=[],_ref=null!=toNode?toNode._inEdges:void 0;for(fromId in _ref)__hasProp.call(_ref,fromId)&&inEdges.push(this.getEdge(fromId,nodeId));return inEdges},Graph.prototype.getOutEdgesOf=function(nodeId){var fromNode,outEdges,toId,_ref;fromNode=this._nodes[nodeId],outEdges=[],_ref=null!=fromNode?fromNode._outEdges:void 0;for(toId in _ref)__hasProp.call(_ref,toId)&&outEdges.push(this.getEdge(nodeId,toId));return outEdges},Graph.prototype.getAllEdgesOf=function(nodeId){var i,inEdges,outEdges,selfEdge,_i,_ref,_ref1;if(inEdges=this.getInEdgesOf(nodeId),outEdges=this.getOutEdgesOf(nodeId),0===inEdges.length)return outEdges;for(selfEdge=this.getEdge(nodeId,nodeId),i=_i=0,_ref=inEdges.length;0<=_ref?_i<_ref:_i>_ref;i=0<=_ref?++_i:--_i)if(inEdges[i]===selfEdge){_ref1=[inEdges[inEdges.length-1],inEdges[i]],inEdges[i]=_ref1[0],inEdges[inEdges.length-1]=_ref1[1],inEdges.pop();break}return inEdges.concat(outEdges)},Graph.prototype.forEachNode=function(operation){var nodeId,nodeObject,_ref;_ref=this._nodes;for(nodeId in _ref)__hasProp.call(_ref,nodeId)&&(nodeObject=_ref[nodeId],operation(nodeObject,nodeId))},Graph.prototype.forEachEdge=function(operation){var edgeObject,nodeId,nodeObject,toId,_ref,_ref1;_ref=this._nodes;for(nodeId in _ref)if(__hasProp.call(_ref,nodeId)){nodeObject=_ref[nodeId],_ref1=nodeObject._outEdges;for(toId in _ref1)__hasProp.call(_ref1,toId)&&(edgeObject=_ref1[toId],operation(edgeObject))}},Graph}(),module.exports=Graph}).call(this)},function(module,exports,__webpack_require__){(function(){var Heap,_leftChild,_parent,_rightChild;Heap=function(){function Heap(dataToHeapify){var i,item,_i,_j,_len,_ref;for(null==dataToHeapify&&(dataToHeapify=[]),this._data=[void 0],_i=0,_len=dataToHeapify.length;_i<_len;_i++)item=dataToHeapify[_i],null!=item&&this._data.push(item);if(this._data.length>1)for(i=_j=2,_ref=this._data.length;2<=_ref?_j<_ref:_j>_ref;i=2<=_ref?++_j:--_j)this._upHeap(i);this.size=this._data.length-1}return Heap.prototype.add=function(value){if(null!=value)return this._data.push(value),this._upHeap(this._data.length-1),this.size++,value},Heap.prototype.removeMin=function(){var min;if(1!==this._data.length)return this.size--,2===this._data.length?this._data.pop():(min=this._data[1],this._data[1]=this._data.pop(),this._downHeap(),min)},Heap.prototype.peekMin=function(){return this._data[1]},Heap.prototype._upHeap=function(index){var valueHolder,_ref;for(valueHolder=this._data[index];this._data[index]<this._data[_parent(index)]&&index>1;)_ref=[this._data[_parent(index)],this._data[index]],this._data[index]=_ref[0],this._data[_parent(index)]=_ref[1],index=_parent(index)},Heap.prototype._downHeap=function(){var currentIndex,smallerChildIndex,_ref;for(currentIndex=1;_leftChild(currentIndex<this._data.length)&&(smallerChildIndex=_leftChild(currentIndex),smallerChildIndex<this._data.length-1&&this._data[_rightChild(currentIndex)]<this._data[smallerChildIndex]&&(smallerChildIndex=_rightChild(currentIndex)),this._data[smallerChildIndex]<this._data[currentIndex]);)_ref=[this._data[currentIndex],this._data[smallerChildIndex]],this._data[smallerChildIndex]=_ref[0],this._data[currentIndex]=_ref[1],currentIndex=smallerChildIndex},Heap}(),_parent=function(index){return index>>1},_leftChild=function(index){return index<<1},_rightChild=function(index){return(index<<1)+1},module.exports=Heap}).call(this)},function(module,exports,__webpack_require__){(function(){var LinkedList;LinkedList=function(){function LinkedList(valuesToAdd){var value,_i,_len;for(null==valuesToAdd&&(valuesToAdd=[]),this.head={prev:void 0,value:void 0,next:void 0},this.tail={prev:void 0,value:void 0,next:void 0},this.size=0,_i=0,_len=valuesToAdd.length;_i<_len;_i++)value=valuesToAdd[_i],this.add(value)}return LinkedList.prototype.at=function(position){var currentNode,i,_i,_j,_ref;if(-this.size<=position&&position<this.size){if(position=this._adjust(position),2*position<this.size)for(currentNode=this.head,i=_i=1;_i<=position;i=_i+=1)currentNode=currentNode.next;else for(currentNode=this.tail,i=_j=1,_ref=this.size-position-1;_j<=_ref;i=_j+=1)currentNode=currentNode.prev;return currentNode}},LinkedList.prototype.add=function(value,position){var currentNode,nodeToAdd,_ref,_ref1,_ref2;if(null==position&&(position=this.size),-this.size<=position&&position<=this.size)return nodeToAdd={value:value},position=this._adjust(position),0===this.size?this.head=nodeToAdd:0===position?(_ref=[nodeToAdd,this.head,nodeToAdd],this.head.prev=_ref[0],nodeToAdd.next=_ref[1],this.head=_ref[2]):(currentNode=this.at(position-1),_ref1=[currentNode.next,nodeToAdd,nodeToAdd,currentNode],nodeToAdd.next=_ref1[0],null!=(_ref2=currentNode.next)?_ref2.prev=_ref1[1]:void 0,currentNode.next=_ref1[2],nodeToAdd.prev=_ref1[3]),position===this.size&&(this.tail=nodeToAdd),this.size++,value},LinkedList.prototype.removeAt=function(position){var currentNode,valueToReturn,_ref;if(null==position&&(position=this.size-1),-this.size<=position&&position<this.size&&0!==this.size)return position=this._adjust(position),1===this.size?(valueToReturn=this.head.value,this.head.value=this.tail.value=void 0):0===position?(valueToReturn=this.head.value,this.head=this.head.next,this.head.prev=void 0):(currentNode=this.at(position),valueToReturn=currentNode.value,currentNode.prev.next=currentNode.next,null!=(_ref=currentNode.next)&&(_ref.prev=currentNode.prev),position===this.size-1&&(this.tail=currentNode.prev)),this.size--,valueToReturn},LinkedList.prototype.remove=function(value){var currentNode;if(null!=value){for(currentNode=this.head;currentNode&&currentNode.value!==value;)currentNode=currentNode.next;if(currentNode)return 1===this.size?this.head.value=this.tail.value=void 0:currentNode===this.head?(this.head=this.head.next,this.head.prev=void 0):currentNode===this.tail?(this.tail=this.tail.prev,this.tail.next=void 0):(currentNode.prev.next=currentNode.next,currentNode.next.prev=currentNode.prev),this.size--,value}},LinkedList.prototype.indexOf=function(value,startingPosition){var currentNode,position;if(null==startingPosition&&(startingPosition=0),null==this.head.value&&!this.head.next||startingPosition>=this.size)return-1;for(startingPosition=Math.max(0,this._adjust(startingPosition)),currentNode=this.at(startingPosition),position=startingPosition;currentNode&&currentNode.value!==value;)currentNode=currentNode.next,position++;return position===this.size?-1:position},LinkedList.prototype._adjust=function(position){return position<0?this.size+position:position},LinkedList}(),module.exports=LinkedList}).call(this)},function(module,exports,__webpack_require__){(function(){var Map,SPECIAL_TYPE_KEY_PREFIX,_extractDataType,_isSpecialType,__hasProp={}.hasOwnProperty;SPECIAL_TYPE_KEY_PREFIX="_mapId_",Map=function(){function Map(objectToMap){var key,value;this._content={},this._itemId=0,this._id=Map._newMapId(),this.size=0;for(key in objectToMap)__hasProp.call(objectToMap,key)&&(value=objectToMap[key],this.set(key,value))}return Map._mapIdTracker=0,Map._newMapId=function(){return this._mapIdTracker++},Map.prototype.hash=function(key,makeHash){var propertyForMap,type;return null==makeHash&&(makeHash=!1),type=_extractDataType(key),_isSpecialType(key)?(propertyForMap=SPECIAL_TYPE_KEY_PREFIX+this._id,makeHash&&!key[propertyForMap]&&(key[propertyForMap]=this._itemId++),propertyForMap+"_"+key[propertyForMap]):type+"_"+key},Map.prototype.set=function(key,value){return this.has(key)||this.size++,this._content[this.hash(key,!0)]=[value,key],value},Map.prototype.get=function(key){var _ref;return null!=(_ref=this._content[this.hash(key)])?_ref[0]:void 0},Map.prototype.has=function(key){return this.hash(key)in this._content},Map.prototype["delete"]=function(key){var hashedKey;return hashedKey=this.hash(key),hashedKey in this._content&&(delete this._content[hashedKey],_isSpecialType(key)&&delete key[SPECIAL_TYPE_KEY_PREFIX+this._id],this.size--,!0)},Map.prototype.forEach=function(operation){var key,value,_ref;_ref=this._content;for(key in _ref)__hasProp.call(_ref,key)&&(value=_ref[key],operation(value[1],value[0]))},Map}(),_isSpecialType=function(key){var simpleHashableTypes,simpleType,type,_i,_len;for(simpleHashableTypes=["Boolean","Number","String","Undefined","Null","RegExp","Function"],type=_extractDataType(key),_i=0,_len=simpleHashableTypes.length;_i<_len;_i++)if(simpleType=simpleHashableTypes[_i],type===simpleType)return!1;return!0},_extractDataType=function(type){return Object.prototype.toString.apply(type).match(/\[object (.+)\]/)[1]},module.exports=Map}).call(this)},function(module,exports,__webpack_require__){(function(){var Queue;Queue=function(){function Queue(initialArray){null==initialArray&&(initialArray=[]),this._content=initialArray,this._dequeueIndex=0,this.size=this._content.length}return Queue.prototype.enqueue=function(item){return this.size++,this._content.push(item),item},Queue.prototype.dequeue=function(){var itemToDequeue;if(0!==this.size)return this.size--,itemToDequeue=this._content[this._dequeueIndex],this._dequeueIndex++,2*this._dequeueIndex>this._content.length&&(this._content=this._content.slice(this._dequeueIndex),this._dequeueIndex=0),itemToDequeue},Queue.prototype.peek=function(){return this._content[this._dequeueIndex]},Queue}(),module.exports=Queue}).call(this)},function(module,exports,__webpack_require__){(function(){var BLACK,NODE_FOUND,NODE_TOO_BIG,NODE_TOO_SMALL,RED,RedBlackTree,STOP_SEARCHING,_findNode,_grandParentOf,_isLeft,_leftOrRight,_peekMaxNode,_peekMinNode,_siblingOf,_uncleOf;NODE_FOUND=0,NODE_TOO_BIG=1,NODE_TOO_SMALL=2,STOP_SEARCHING=3,RED=1,BLACK=2,RedBlackTree=function(){function RedBlackTree(valuesToAdd){var value,_i,_len;for(null==valuesToAdd&&(valuesToAdd=[]),this._root,this.size=0,_i=0,_len=valuesToAdd.length;_i<_len;_i++)value=valuesToAdd[_i],null!=value&&this.add(value)}return RedBlackTree.prototype.add=function(value){var currentNode,foundNode,nodeToInsert,_ref;if(null!=value){if(this.size++,nodeToInsert={value:value,_color:RED},this._root){if(foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?node._left?NODE_TOO_BIG:(nodeToInsert._parent=node,node._left=nodeToInsert,STOP_SEARCHING):node._right?NODE_TOO_SMALL:(nodeToInsert._parent=node,node._right=nodeToInsert,STOP_SEARCHING);
}),null!=foundNode)return}else this._root=nodeToInsert;for(currentNode=nodeToInsert;;){if(currentNode===this._root){currentNode._color=BLACK;break}if(currentNode._parent._color===BLACK)break;{if((null!=(_ref=_uncleOf(currentNode))?_ref._color:void 0)!==RED){!_isLeft(currentNode)&&_isLeft(currentNode._parent)?(this._rotateLeft(currentNode._parent),currentNode=currentNode._left):_isLeft(currentNode)&&!_isLeft(currentNode._parent)&&(this._rotateRight(currentNode._parent),currentNode=currentNode._right),currentNode._parent._color=BLACK,_grandParentOf(currentNode)._color=RED,_isLeft(currentNode)?this._rotateRight(_grandParentOf(currentNode)):this._rotateLeft(_grandParentOf(currentNode));break}currentNode._parent._color=BLACK,_uncleOf(currentNode)._color=BLACK,_grandParentOf(currentNode)._color=RED,currentNode=_grandParentOf(currentNode)}}return value}},RedBlackTree.prototype.has=function(value){var foundNode;return foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?NODE_TOO_BIG:NODE_TOO_SMALL}),!!foundNode},RedBlackTree.prototype.peekMin=function(){var _ref;return null!=(_ref=_peekMinNode(this._root))?_ref.value:void 0},RedBlackTree.prototype.peekMax=function(){var _ref;return null!=(_ref=_peekMaxNode(this._root))?_ref.value:void 0},RedBlackTree.prototype.remove=function(value){var foundNode;if(foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?NODE_TOO_BIG:NODE_TOO_SMALL}))return this._removeNode(this._root,foundNode),this.size--,value},RedBlackTree.prototype.removeMin=function(){var nodeToRemove,valueToReturn;if(nodeToRemove=_peekMinNode(this._root))return valueToReturn=nodeToRemove.value,this._removeNode(this._root,nodeToRemove),valueToReturn},RedBlackTree.prototype.removeMax=function(){var nodeToRemove,valueToReturn;if(nodeToRemove=_peekMaxNode(this._root))return valueToReturn=nodeToRemove.value,this._removeNode(this._root,nodeToRemove),valueToReturn},RedBlackTree.prototype._removeNode=function(root,node){var sibling,successor,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(node._left&&node._right&&(successor=_peekMinNode(node._right),node.value=successor.value,node=successor),successor=node._left||node._right,successor||(successor={color:BLACK,_right:void 0,_left:void 0,isLeaf:!0}),successor._parent=node._parent,null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=successor),node._color===BLACK)if(successor._color===RED)successor._color=BLACK,successor._parent||(this._root=successor);else for(;;){if(!successor._parent){successor.isLeaf?this._root=void 0:this._root=successor;break}if(sibling=_siblingOf(successor),(null!=sibling?sibling._color:void 0)===RED&&(successor._parent._color=RED,sibling._color=BLACK,_isLeft(successor)?this._rotateLeft(successor._parent):this._rotateRight(successor._parent)),sibling=_siblingOf(successor),successor._parent._color!==BLACK||sibling&&(sibling._color!==BLACK||sibling._left&&sibling._left._color!==BLACK||sibling._right&&sibling._right._color!==BLACK)){if(!(successor._parent._color!==RED||sibling&&(sibling._color!==BLACK||sibling._left&&(null!=(_ref1=sibling._left)?_ref1._color:void 0)!==BLACK||sibling._right&&(null!=(_ref2=sibling._right)?_ref2._color:void 0)!==BLACK))){null!=sibling&&(sibling._color=RED),successor._parent._color=BLACK;break}if((null!=sibling?sibling._color:void 0)===BLACK){!_isLeft(successor)||sibling._right&&sibling._right._color!==BLACK||(null!=(_ref3=sibling._left)?_ref3._color:void 0)!==RED?_isLeft(successor)||sibling._left&&sibling._left._color!==BLACK||(null!=(_ref5=sibling._right)?_ref5._color:void 0)!==RED||(sibling._color=RED,null!=(_ref6=sibling._right)&&(_ref6._color=BLACK),this._rotateLeft(sibling)):(sibling._color=RED,null!=(_ref4=sibling._left)&&(_ref4._color=BLACK),this._rotateRight(sibling));break}sibling=_siblingOf(successor),sibling._color=successor._parent._color,_isLeft(successor)?(sibling._right._color=BLACK,this._rotateRight(successor._parent)):(sibling._left._color=BLACK,this._rotateLeft(successor._parent))}else null!=sibling&&(sibling._color=RED),successor.isLeaf&&(successor._parent[_leftOrRight(successor)]=void 0),successor=successor._parent}if(successor.isLeaf)return null!=(_ref7=successor._parent)?_ref7[_leftOrRight(successor)]=void 0:void 0},RedBlackTree.prototype._rotateLeft=function(node){var _ref,_ref1;if(null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=node._right),node._right._parent=node._parent,node._parent=node._right,node._right=node._right._left,node._parent._left=node,null!=(_ref1=node._right)&&(_ref1._parent=node),null==node._parent._parent)return this._root=node._parent},RedBlackTree.prototype._rotateRight=function(node){var _ref,_ref1;if(null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=node._left),node._left._parent=node._parent,node._parent=node._left,node._left=node._left._right,node._parent._right=node,null!=(_ref1=node._left)&&(_ref1._parent=node),null==node._parent._parent)return this._root=node._parent},RedBlackTree}(),_isLeft=function(node){return node===node._parent._left},_leftOrRight=function(node){return _isLeft(node)?"_left":"_right"},_findNode=function(startingNode,comparator){var comparisonResult,currentNode,foundNode;for(currentNode=startingNode,foundNode=void 0;currentNode;){if(comparisonResult=comparator(currentNode),comparisonResult===NODE_FOUND){foundNode=currentNode;break}if(comparisonResult===NODE_TOO_BIG)currentNode=currentNode._left;else if(comparisonResult===NODE_TOO_SMALL)currentNode=currentNode._right;else if(comparisonResult===STOP_SEARCHING)break}return foundNode},_peekMinNode=function(startingNode){return _findNode(startingNode,function(node){return node._left?NODE_TOO_BIG:NODE_FOUND})},_peekMaxNode=function(startingNode){return _findNode(startingNode,function(node){return node._right?NODE_TOO_SMALL:NODE_FOUND})},_grandParentOf=function(node){var _ref;return null!=(_ref=node._parent)?_ref._parent:void 0},_uncleOf=function(node){if(_grandParentOf(node))return _isLeft(node._parent)?_grandParentOf(node)._right:_grandParentOf(node)._left},_siblingOf=function(node){return _isLeft(node)?node._parent._right:node._parent._left},module.exports=RedBlackTree}).call(this)},function(module,exports,__webpack_require__){(function(){var Queue,Trie,WORD_END,_hasAtLeastNChildren,__hasProp={}.hasOwnProperty;Queue=__webpack_require__(6),WORD_END="end",Trie=function(){function Trie(words){var word,_i,_len;for(null==words&&(words=[]),this._root={},this.size=0,_i=0,_len=words.length;_i<_len;_i++)word=words[_i],this.add(word)}return Trie.prototype.add=function(word){var currentNode,letter,_i,_len;if(null!=word){for(this.size++,currentNode=this._root,_i=0,_len=word.length;_i<_len;_i++)letter=word[_i],null==currentNode[letter]&&(currentNode[letter]={}),currentNode=currentNode[letter];return currentNode[WORD_END]=!0,word}},Trie.prototype.has=function(word){var currentNode,letter,_i,_len;if(null==word)return!1;for(currentNode=this._root,_i=0,_len=word.length;_i<_len;_i++){if(letter=word[_i],null==currentNode[letter])return!1;currentNode=currentNode[letter]}return!!currentNode[WORD_END]},Trie.prototype.longestPrefixOf=function(word){var currentNode,letter,prefix,_i,_len;if(null==word)return"";for(currentNode=this._root,prefix="",_i=0,_len=word.length;_i<_len&&(letter=word[_i],null!=currentNode[letter]);_i++)prefix+=letter,currentNode=currentNode[letter];return prefix},Trie.prototype.wordsWithPrefix=function(prefix){var accumulatedLetters,currentNode,letter,node,queue,subNode,words,_i,_len,_ref;if(null==prefix)return[];for(null!=prefix||(prefix=""),words=[],currentNode=this._root,_i=0,_len=prefix.length;_i<_len;_i++)if(letter=prefix[_i],currentNode=currentNode[letter],null==currentNode)return[];for(queue=new Queue,queue.enqueue([currentNode,""]);0!==queue.size;){_ref=queue.dequeue(),node=_ref[0],accumulatedLetters=_ref[1],node[WORD_END]&&words.push(prefix+accumulatedLetters);for(letter in node)__hasProp.call(node,letter)&&(subNode=node[letter],queue.enqueue([subNode,accumulatedLetters+letter]))}return words},Trie.prototype.remove=function(word){var currentNode,i,letter,prefix,_i,_j,_len,_ref;if(null!=word){for(currentNode=this._root,prefix=[],_i=0,_len=word.length;_i<_len;_i++){if(letter=word[_i],null==currentNode[letter])return;currentNode=currentNode[letter],prefix.push([letter,currentNode])}if(currentNode[WORD_END]){if(this.size--,delete currentNode[WORD_END],_hasAtLeastNChildren(currentNode,1))return word;for(i=_j=_ref=prefix.length-1;(_ref<=1?_j<=1:_j>=1)&&!_hasAtLeastNChildren(prefix[i][1],1);i=_ref<=1?++_j:--_j)delete prefix[i-1][1][prefix[i][0]];return _hasAtLeastNChildren(this._root[prefix[0][0]],1)||delete this._root[prefix[0][0]],word}}},Trie}(),_hasAtLeastNChildren=function(node,n){var child,childCount;if(0===n)return!0;childCount=0;for(child in node)if(__hasProp.call(node,child)&&(childCount++,childCount>=n))return!0;return!1},module.exports=Trie}).call(this)}]),angular.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendMarkerClusterer",["uiGmapLodash","uiGmapPropMap",function(uiGmapLodash,PropMap){return{init:_.once(function(){(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.NgMapCluster=function(_super){function NgMapCluster(opts){NgMapCluster.__super__.constructor.call(this,opts),this.markers_=new PropMap}return __extends(NgMapCluster,_super),NgMapCluster.prototype.addMarker=function(marker){var mCount,mz;if(this.isMarkerAlreadyAdded_(marker)){var oldMarker=this.markers_.get(marker.key);if(oldMarker.getPosition().lat()==marker.getPosition().lat()&&oldMarker.getPosition().lon()==marker.getPosition().lon())return!1}if(this.center_){if(this.averageCenter_){var l=this.markers_.length+1,lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l,lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng),this.calculateBounds_()}}else this.center_=marker.getPosition(),this.calculateBounds_();return marker.isAdded=!0,this.markers_.push(marker),mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom(),null!==mz&&this.map_.getZoom()>mz?marker.getMap()!==this.map_&&marker.setMap(this.map_):mCount<this.minClusterSize_?marker.getMap()!==this.map_&&marker.setMap(this.map_):mCount===this.minClusterSize_?this.markers_.each(function(m){m.setMap(null)}):marker.setMap(null),!0},NgMapCluster.prototype.isMarkerAlreadyAdded_=function(marker){return uiGmapLodash.isNullOrUndefined(this.markers_.get(marker.key))},NgMapCluster.prototype.getBounds=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);return this.getMarkers().each(function(m){bounds.extend(m.getPosition())}),bounds},NgMapCluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=new PropMap,delete this.markers_},NgMapCluster}(Cluster),window.NgMapMarkerClusterer=function(_super){function NgMapMarkerClusterer(map,opt_markers,opt_options){NgMapMarkerClusterer.__super__.constructor.call(this,map,opt_markers,opt_options),this.markers_=new PropMap}return __extends(NgMapMarkerClusterer,_super),NgMapMarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=new PropMap},NgMapMarkerClusterer.prototype.removeMarker_=function(marker){return!!this.markers_.get(marker.key)&&(marker.setMap(null),this.markers_.remove(marker.key),!0)},NgMapMarkerClusterer.prototype.createClusters_=function(iFirst){var i,marker,mapBounds,cMarkerClusterer=this;if(this.ready_){0===iFirst&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),mapBounds=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,(-178.48388434375)),new google.maps.LatLng((-85.08136444384544),178.00048865625));var bounds=this.getExtendedBounds(mapBounds),iLast=Math.min(iFirst+this.batchSize_,this.markers_.length),_ms=this.markers_.values();for(i=iFirst;i<iLast;i++)marker=_ms[i],!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)&&(!this.ignoreHidden_||this.ignoreHidden_&&marker.getVisible())&&this.addToClosestCluster_(marker);if(iLast<this.markers_.length)this.timerRefStatic=setTimeout(function(){cMarkerClusterer.createClusters_(iLast)},0);else{for(i=0;i<this.clusters_.length;i++)this.clusters_[i].updateIcon_();delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this)}}},NgMapMarkerClusterer.prototype.addToClosestCluster_=function(marker){var i,d,cluster,center,distance=4e4,clusterToAddTo=null;for(i=0;i<this.clusters_.length;i++)cluster=this.clusters_[i],center=cluster.getCenter(),center&&(d=this.distanceBetweenPoints_(center,marker.getPosition()),d<distance&&(distance=d,clusterToAddTo=cluster));clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)?clusterToAddTo.addMarker(marker):(cluster=new NgMapCluster(this),cluster.addMarker(marker),this.clusters_.push(cluster))},NgMapMarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},NgMapMarkerClusterer.prototype.resetViewport_=function(opt_hide){var i;for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();this.clusters_=[],this.markers_.each(function(marker){marker.isAdded=!1,opt_hide&&marker.setMap(null)})},NgMapMarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){var property;for(property in object.prototype)"constructor"!==property&&(this.prototype[property]=object.prototype[property]);return this}.apply(obj1,[obj2])},ClusterIcon.prototype.show=function(){if(this.div_){var img="",bp=this.backgroundPosition_.split(" "),spriteH=parseInt(bp[0].trim(),10),spriteV=parseInt(bp[1].trim(),10),pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos),img="<img src='"+this.url_+"' style='position: absolute; top: "+spriteV+"px; left: "+spriteH+"px; ",img+=this.cluster_.getMarkerClusterer().enableRetinaIcons_?"width: "+this.width_+"px;height: "+this.height_+"px;":"clip: rect("+-1*spriteV+"px, "+(-1*spriteH+this.width_)+"px, "+(-1*spriteV+this.height_)+"px, "+-1*spriteH+"px);",img+="'>",this.div_.innerHTML=img+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},NgMapMarkerClusterer}(MarkerClusterer)}).call(this)})}}])}(window,angular),function(angular,analytics){"use strict";var angulartics=window.angulartics||(window.angulartics={});angulartics.waitForVendorCount=0,angulartics.waitForVendorApi=function(objectName,delay,containsField,registerFn,onTimeout){onTimeout||angulartics.waitForVendorCount++,registerFn||(registerFn=containsField,containsField=void 0),!Object.prototype.hasOwnProperty.call(window,objectName)||void 0!==containsField&&void 0===window[objectName][containsField]?setTimeout(function(){angulartics.waitForVendorApi(objectName,delay,containsField,registerFn,!0)},delay):(angulartics.waitForVendorCount--,registerFn(window[objectName]))},angular.module("angulartics",[]).provider("$analytics",function(){var settings={pageTracking:{autoTrackFirstPage:!0,autoTrackVirtualPages:!0,trackRelativePath:!1,autoBasePath:!1,basePath:""},eventTracking:{},bufferFlushDelay:1e3,developerMode:!1},knownHandlers=["pageTrack","eventTrack","setAlias","setUsername","setUserProperties","setUserPropertiesOnce","setSuperProperties","setSuperPropertiesOnce"],cache={},handlers={},bufferedHandler=function(handlerName){return function(){angulartics.waitForVendorCount&&(cache[handlerName]||(cache[handlerName]=[]),cache[handlerName].push(arguments))}},updateHandlers=function(handlerName,fn){return handlers[handlerName]||(handlers[handlerName]=[]),handlers[handlerName].push(fn),function(){var handlerArgs=arguments;angular.forEach(handlers[handlerName],function(handler){handler.apply(this,handlerArgs)},this)}},api={settings:settings},onTimeout=function(fn,delay){delay?setTimeout(fn,delay):fn()},provider={$get:function(){return api},api:api,settings:settings,virtualPageviews:function(value){this.settings.pageTracking.autoTrackVirtualPages=value},firstPageview:function(value){this.settings.pageTracking.autoTrackFirstPage=value},withBase:function(value){this.settings.pageTracking.basePath=value?angular.element(document).find("base").attr("href"):""},withAutoBase:function(value){this.settings.pageTracking.autoBasePath=value},developerMode:function(value){this.settings.developerMode=value}},register=function(handlerName,fn){api[handlerName]=updateHandlers(handlerName,fn);var handlerSettings=settings[handlerName],handlerDelay=handlerSettings?handlerSettings.bufferFlushDelay:null,delay=null!==handlerDelay?handlerDelay:settings.bufferFlushDelay;angular.forEach(cache[handlerName],function(args,index){onTimeout(function(){fn.apply(this,args)},index*delay)})},capitalize=function(input){return input.replace(/^./,function(match){return match.toUpperCase()})},installHandlerRegisterFunction=function(handlerName){var registerName="register"+capitalize(handlerName);provider[registerName]=function(fn){register(handlerName,fn)},api[handlerName]=updateHandlers(handlerName,bufferedHandler(handlerName))};return angular.forEach(knownHandlers,installHandlerRegisterFunction),provider}).run(["$rootScope","$window","$analytics","$injector",function($rootScope,$window,$analytics,$injector){$analytics.settings.pageTracking.autoTrackFirstPage&&$injector.invoke(["$location",function($location){var noRoutesOrStates=!0;if($injector.has("$route")){var $route=$injector.get("$route");for(var route in $route.routes){noRoutesOrStates=!1;break}}else if($injector.has("$state")){var $state=$injector.get("$state");for(var state in $state.get()){noRoutesOrStates=!1;break}}if(noRoutesOrStates)if($analytics.settings.pageTracking.autoBasePath&&($analytics.settings.pageTracking.basePath=$window.location.pathname),$analytics.settings.pageTracking.trackRelativePath){var url=$analytics.settings.pageTracking.basePath+$location.url();$analytics.pageTrack(url,$location)}else $analytics.pageTrack($location.absUrl(),$location)}]),$analytics.settings.pageTracking.autoTrackVirtualPages&&$injector.invoke(["$location",function($location){$analytics.settings.pageTracking.autoBasePath&&($analytics.settings.pageTracking.basePath=$window.location.pathname+"#"),$injector.has("$route")&&$rootScope.$on("$routeChangeSuccess",function(event,current){if(!current||!(current.$$route||current).redirectTo){var url=$analytics.settings.pageTracking.basePath+$location.url();$analytics.pageTrack(url,$location)}}),$injector.has("$state")&&$rootScope.$on("$stateChangeSuccess",function(event,current){var url=$analytics.settings.pageTracking.basePath+$location.url();$analytics.pageTrack(url,$location)})}]),$analytics.settings.developerMode&&angular.forEach($analytics,function(attr,name){"function"==typeof attr&&($analytics[name]=function(){})})}]).directive("analyticsOn",["$analytics",function($analytics){function isCommand(element){return["a:","button:","button:button","button:submit","input:button","input:submit"].indexOf(element.tagName.toLowerCase()+":"+(element.type||""))>=0}function inferEventType(element){return isCommand(element),"click"}function inferEventName(element){return isCommand(element)?element.innerText||element.value:element.id||element.name||element.tagName}function isProperty(name){return"analytics"===name.substr(0,9)&&["On","Event","If","Properties","EventType"].indexOf(name.substr(9))===-1}function propertyName(name){var s=name.slice(9);return"undefined"!=typeof s&&null!==s&&s.length>0?s.substring(0,1).toLowerCase()+s.substring(1):s}return{restrict:"A",link:function($scope,$element,$attrs){var eventType=$attrs.analyticsOn||inferEventType($element[0]),trackingData={};angular.forEach($attrs.$attr,function(attr,name){isProperty(name)&&(trackingData[propertyName(name)]=$attrs[name],$attrs.$observe(name,function(value){trackingData[propertyName(name)]=value}))}),angular.element($element[0]).bind(eventType,function($event){var eventName=$attrs.analyticsEvent||inferEventName($element[0]);trackingData.eventType=$event.type,$attrs.analyticsIf&&!$scope.$eval($attrs.analyticsIf)||($attrs.analyticsProperties&&angular.extend(trackingData,$scope.$eval($attrs.analyticsProperties)),$analytics.eventTrack(eventName,trackingData))})}}}])}(angular),function(angular){"use strict";angular.module("angulartics.adobe.analytics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.settings.trackRelativePath=!0,$analyticsProvider.registerPageTrack(function(path){window.s&&s.t({pageName:path})}),$analyticsProvider.registerEventTrack(function(action){window.s&&action&&("DOWNLOAD"===action.toUpperCase()?s.tl(this,"d",action):"EXIT"===action.toUpperCase()?s.tl(this,"e",action):s.tl(this,"o",action))})}])}(angular),function(angular){"use strict";angular.module("angulartics.chartbeat",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("pSUPERFLY",500,function(pSUPERFLY){$analyticsProvider.registerPageTrack(function(path){pSUPERFLY.virtualPage(path)})}),$analyticsProvider.registerEventTrack(function(){console.warn("Chartbeat doesn't support event tracking -- silently ignored.")})}])}(angular),function(angular){"use strict";angular.module("angulartics.clicky",["angulartics"]).config(["$analyticsProvider","$documentProvider",function($analyticsProvider,$documentProvider){function registerEvents(clicky){clickyApi=clicky,clickyApi&&($analyticsProvider.registerPageTrack(pageTrack),$analyticsProvider.registerEventTrack(eventTrack))}function pageTrack(path,properties){var title=properties.title||$document[0].title,type=validateType(properties.type);clickyApi.log(path,title,type)}function eventTrack(action,properties){var goalId,revenue,noQueue,title,type;angular.isDefined(properties.goal)?(goalId=properties.goal,revenue=validateNumber(properties.revenue)?properties.revenue:void 0,noQueue=!!properties.noQueue,clickyApi.goal(goalId,revenue,noQueue)):(type=validateType(properties.type)===properties.type?properties.type:"click",title=properties.title||properties.value,clickyApi.log(action,title,type))}function validateType(type){var TYPE_ENUM=["click","download","outbound","pageview"];return TYPE_ENUM.indexOf(type)>=0?type:"pageview"}function validateNumber(number){return"number"==typeof number&&isFinite(number)}var clickyApi,$document=$documentProvider.$get;$analyticsProvider.settings.trackRelativePath=!0,angulartics.waitForVendorApi("clicky",100,registerEvents)}])}(angular),function(angular){"use strict";angular.module("angulartics.cnzz",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){window._czc=_czc||[],_czc.push(["_setAutoPageview",!1]),$analyticsProvider.registerPageTrack(function(path){_czc.push(["_trackPageview",path])}),$analyticsProvider.registerEventTrack(function(action,prop){_czc.push(["_trackEvent",prop.category,action,prop.label,prop.value,prop.nodeid])})}])}(angular),function(angular){"use strict";angular.module("angulartics.flurry",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){}),$analyticsProvider.registerEventTrack(function(action,properties){FlurryAgent.logEvent(action,properties)})}])}(angular),function(angular){"use strict";angular.module("angulartics.google.analytics.cordova",["angulartics"]).provider("googleAnalyticsCordova",function(){var GoogleAnalyticsCordova=["$q","$log","ready","debug","trackingId","period",function($q,$log,ready,debug,trackingId,period){function success(){debug&&$log.info(arguments)}function failure(err){debug&&$log.error(err)}var deferred=$q.defer(),deviceReady=!1;window.addEventListener("deviceReady",function(){deviceReady=!0,deferred.resolve()}),setTimeout(function(){deviceReady||deferred.resolve()},3e3),this.init=function(){return deferred.promise.then(function(){var analytics=window.plugins&&window.plugins.gaPlugin;analytics?analytics.init(function(){ready(analytics,success,failure)},failure,trackingId,period||10):debug&&$log.error("Google Analytics for Cordova is not available")})}}];return{$get:["$injector",function($injector){return $injector.instantiate(GoogleAnalyticsCordova,{ready:this._ready||angular.noop,debug:this.debug,trackingId:this.trackingId,period:this.period})}],ready:function(fn){this._ready=fn}}}).config(["$analyticsProvider","googleAnalyticsCordovaProvider",function($analyticsProvider,googleAnalyticsCordovaProvider){googleAnalyticsCordovaProvider.ready(function(analytics,success,failure){$analyticsProvider.registerPageTrack(function(path){analytics.trackPage(success,failure,path)}),$analyticsProvider.registerEventTrack(function(action,properties){analytics.trackEvent(success,failure,properties.category,action,properties.label,properties.value)})})}]).run(["googleAnalyticsCordova",function(googleAnalyticsCordova){googleAnalyticsCordova.init()}])}(angular),function(angular){"use strict";angular.module("angulartics.google.analytics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.settings.trackRelativePath=!0,$analyticsProvider.settings.ga={additionalAccountNames:void 0,userId:null},$analyticsProvider.registerPageTrack(function(path){window._gaq&&(_gaq.push(["_trackPageview",path]),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){_gaq.push([accountName+"._trackPageview",path])})),window.ga&&($analyticsProvider.settings.ga.userId&&ga("set","&uid",$analyticsProvider.settings.ga.userId),ga("send","pageview",path),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){ga(accountName+".send","pageview",path)}))}),$analyticsProvider.registerEventTrack(function(action,properties){if(properties&&properties.category||(properties=properties||{},properties.category="Event"),properties.value){var parsed=parseInt(properties.value,10);properties.value=isNaN(parsed)?0:parsed}if(window.ga){for(var eventOptions={eventCategory:properties.category,eventAction:action,eventLabel:properties.label,eventValue:properties.value,nonInteraction:properties.noninteraction,page:properties.page||window.location.hash.substring(1),userId:$analyticsProvider.settings.ga.userId},idx=1;idx<=20;idx++)properties["dimension"+idx.toString()]&&(eventOptions["dimension"+idx.toString()]=properties["dimension"+idx.toString()]),properties["metric"+idx.toString()]&&(eventOptions["metric"+idx.toString()]=properties["metric"+idx.toString()]);ga("send","event",eventOptions),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){ga(accountName+".send","event",eventOptions)})}else window._gaq&&_gaq.push(["_trackEvent",properties.category,action,properties.label,properties.value,properties.noninteraction])}),$analyticsProvider.registerSetUsername(function(userId){$analyticsProvider.settings.ga.userId=userId})}])}(angular),function(angular){"use strict";angular.module("angulartics.google.tagmanager",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){var dataLayer=window.dataLayer=window.dataLayer||[];dataLayer.push({event:"content-view","content-name":path})}),$analyticsProvider.registerEventTrack(function(action,properties){var dataLayer=window.dataLayer=window.dataLayer||[];dataLayer.push({event:"interaction",target:properties.category,action:action,"target-properties":properties.label,value:properties.value,"interaction-type":properties.noninteraction})})}])}(angular),function(angular){"use strict";angular.module("angulartics.kissmetrics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){"undefined"==typeof _kmq?window._kmq=[]:window._kmq=_kmq,$analyticsProvider.registerPageTrack(function(path){window._kmq.push(["record","Pageview",{Page:path}])}),$analyticsProvider.registerEventTrack(function(action,properties){window._kmq.push(["record",action,properties])}),$analyticsProvider.registerSetUsername(function(uuid){window._kmq.push(["identify",uuid])}),$analyticsProvider.registerSetUserProperties(function(properties){window._kmq.push(["set",properties])})}])}(angular),function(angular){"use strict";angular.module("angulartics.mixpanel",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetUsername(function(userId){mixpanel.identify(userId)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetAlias(function(userId){mixpanel.alias(userId)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetSuperPropertiesOnce(function(properties){mixpanel.register_once(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetSuperProperties(function(properties){mixpanel.register(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetUserPropertiesOnce(function(properties){mixpanel.people.set_once(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerSetUserProperties(function(properties){mixpanel.people.set(properties)})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerPageTrack(function(path){mixpanel.track("Page Viewed",{page:path})})}),angulartics.waitForVendorApi("mixpanel",500,"__loaded",function(mixpanel){$analyticsProvider.registerEventTrack(function(action,properties){mixpanel.track(action,properties)})})}])}(angular),function(angular){"use strict";angular.module("angulartics.piwik",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.settings.trackRelativePath=!0,$analyticsProvider.registerPageTrack(function(path){window._paq&&(_paq.push(["setCustomUrl",path]),_paq.push(["trackPageView"]))}),$analyticsProvider.registerEventTrack(function(action,properties){if(properties.value){var parsed=parseInt(properties.value,10);properties.value=isNaN(parsed)?0:parsed}window._paq&&_paq.push(["trackEvent",properties.category,action,properties.label,properties.value])})}])}(angular),function(angular){"use strict";angular.module("angulartics.scroll",["angulartics"]).directive("analyticsOn",["$analytics",function($analytics){function isProperty(name){return"scrollby"===name.substr(0,8)}function cast(value){return["","true","false"].indexOf(value)>-1?"true"===value.replace("","true"):value}return{restrict:"A",priority:5,scope:!1,link:function($scope,$element,$attrs){if("scrollby"===$attrs.analyticsOn){var properties={continuous:!1,triggerOnce:!0};angular.forEach($attrs.$attr,function(attr,name){isProperty(attr)&&(properties[name.slice(8,9).toLowerCase()+name.slice(9)]=cast($attrs[name]))}),$element.waypoint(function(){$element.triggerHandler("scrollby")},properties)}}}}])}(angular),function(angular){"use strict";angular.module("angulartics.segment.io",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){
try{analytics.page(path)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerEventTrack(function(event,properties,options,callback){try{analytics.track(event,properties,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetUserProperties(function(userId,traits,options,callback){try{analytics.identify(userId,traits,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetUserPropertiesOnce(function(userId,traits,options,callback){try{analytics.identify(userId,traits,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}}),$analyticsProvider.registerSetAlias(function(userId,previousId,options,callback){try{analytics.alias(userId,previousId,options,callback)}catch(e){if(!(e instanceof ReferenceError))throw e}})}])}(angular),function(angular){"use strict";angular.module("angulartics.splunk",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){var errorFunction=function(){throw"Define sp "},_getSp=function(){return window.sp||{pageview:errorFunction,track:errorFunction}};$analyticsProvider.registerPageTrack(function(path){_getSp().pageview(path)}),$analyticsProvider.registerEventTrack(function(action,properties){_getSp().track(action,properties)})}])}(angular),function(angular){"use strict";angular.module("angulartics.woopra",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){woopra.track("pv",{url:path})}),$analyticsProvider.registerEventTrack(function(action,properties){woopra.track(action,properties)}),$analyticsProvider.registerSetUsername(function(email){woopra.identify("email",email).push()}),$analyticsProvider.registerSetUserProperties(function(properties){properties.email&&woopra.identify(properties).push()})}])}(angular),function(angular){"use strict";angular.module("angulartics.marketo",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("Munchkin",500,"sKey",function(Munchkin){$analyticsProvider.registerPageTrack(function(path){Munchkin.munchkinFunction("visitWebPage",{url:path})})}),angulartics.waitForVendorApi("Munchkin",500,"sKey",function(Munchkin){$analyticsProvider.registerEventTrack(function(action,properties){if(void 0!==properties.path){var params=[];for(var prop in properties)"path"!==prop&&params.push(prop+"="+properties[prop]);"CLICK"==action.toUpperCase()&&Munchkin.munchkinFunction("clickLink",{href:properties.path}),Munchkin.munchkinFunction("visitWebPage",{url:properties.path,params:params.join("&")})}})});var associateLead=function(properties){void 0!==properties.email&&(email=properties.email,email_sha=sha1(Munckin.sKey+email),properties.Email=properties.email,Munchkin.munchkinFunction("associateLead",properties,email_sha))};angulartics.waitForVendorApi("Munchkin",500,function(Munchkin){$analyticsProvider.registerSetUsername(function(userId){/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/.test(userId)&&associateLead({Email:userId})})}),angulartics.waitForVendorApi("Munchkin",500,function(Munchkin){$analyticsProvider.registerSetUserProperties(function(properties){associateLead(properties)})}),angulartics.waitForVendorApi("Munchkin",500,function(Munchkin){$analyticsProvider.registerSetUserPropertiesOnce(function(properties){associateLead(properties)})})}])}(angular),function(angular){"use strict";angular.module("angulartics.intercom",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerSetUsername(function(userId){window.Intercom&&window.Intercom("update",{user_id:userId})}),$analyticsProvider.registerEventTrack(function(action,properties){window.Intercom&&window.Intercom("trackEvent",action,properties)})}])}(angular),function(angular){"use strict";angular.module("angulartics.inspectlet",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.registerPageTrack(function(path){var pageTrackArray=[];pageTrackArray.push("virtualPage"),path&&pageTrackArray.push({url:path}),__insp.push(pageTrackArray)}),$analyticsProvider.registerEventTrack(function(action,properties){if("identify"==action||"tagSession"==action){properties.category&&delete properties.category;var eventTrackArray=[];eventTrackArray.push(action),eventTrackArray.push(properties),__insp.push(eventTrackArray)}})}])}(angular),function(angular){"use strict";angular.module("angulartics.newrelic.insights",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){angulartics.waitForVendorApi("newrelic",100,function(newrelic){$analyticsProvider.registerEventTrack(function(action,properties){newrelic.addPageAction(action,properties)}),$analyticsProvider.registerSetUsername(function(name){newrelic.setCustomAttribute("username",name)}),$analyticsProvider.registerSetAlias(function(name){newrelic.setCustomAttribute("alias",name)}),$analyticsProvider.registerSetUserProperties(function(properties){angular.forEach(properties,function(value,key){newrelic.setCustomAttribute(key,value)})})})}])}(angular),angular.module("slickCarousel",[]).constant("slickCarouselConfig",{method:{},event:{}}).directive("slick",["$timeout","slickCarouselConfig",function($timeout,slickCarouselConfig){var slickMethodList,slickEventList;return slickMethodList=["slickGoTo","slickNext","slickPrev","slickPause","slickPlay","slickAdd","slickRemove","slickFilter","slickUnfilter","unslick"],slickEventList=["afterChange","beforeChange","breakpoint","destroy","edge","init","reInit","setPosition","swipe","lazyLoaded","lazyLoadError"],{scope:{settings:"=",enabled:"@",accessibility:"@",adaptiveHeight:"@",autoplay:"@",autoplaySpeed:"@",arrows:"@",asNavFor:"@",appendArrows:"@",prevArrow:"@",nextArrow:"@",centerMode:"@",centerPadding:"@",cssEase:"@",customPaging:"&",dots:"@",draggable:"@",fade:"@",focusOnSelect:"@",easing:"@",edgeFriction:"@",infinite:"@",initialSlide:"@",lazyLoad:"@",mobileFirst:"@",pauseOnHover:"@",pauseOnDotsHover:"@",respondTo:"@",responsive:"=?",rows:"@",slide:"@",slidesPerRow:"@",slidesToShow:"@",slidesToScroll:"@",speed:"@",swipe:"@",swipeToSlide:"@",touchMove:"@",touchThreshold:"@",useCSS:"@",variableWidth:"@",vertical:"@",verticalSwiping:"@",rtl:"@"},restrict:"AE",link:function(scope,element,attr){angular.element(element).css("display","none");var options,initOptions,destroy,init,destroyAndInit,currentIndex;return initOptions=function(){options=angular.extend(angular.copy(slickCarouselConfig),{enabled:"false"!==scope.enabled,accessibility:"false"!==scope.accessibility,adaptiveHeight:"true"===scope.adaptiveHeight,autoplay:"true"===scope.autoplay,autoplaySpeed:null!=scope.autoplaySpeed?parseInt(scope.autoplaySpeed,10):3e3,arrows:"false"!==scope.arrows,asNavFor:scope.asNavFor?scope.asNavFor:void 0,appendArrows:scope.appendArrows?angular.element(scope.appendArrows):angular.element(element),prevArrow:scope.prevArrow?angular.element(scope.prevArrow):void 0,nextArrow:scope.nextArrow?angular.element(scope.nextArrow):void 0,centerMode:"true"===scope.centerMode,centerPadding:scope.centerPadding||"50px",cssEase:scope.cssEase||"ease",customPaging:attr.customPaging?function(slick,index){return scope.customPaging({slick:slick,index:index})}:void 0,dots:"true"===scope.dots,draggable:"false"!==scope.draggable,fade:"true"===scope.fade,focusOnSelect:"true"===scope.focusOnSelect,easing:scope.easing||"linear",edgeFriction:scope.edgeFriction||.15,infinite:"false"!==scope.infinite,initialSlide:parseInt(scope.initialSlide)||0,lazyLoad:scope.lazyLoad||"ondemand",mobileFirst:"true"===scope.mobileFirst,pauseOnHover:"false"!==scope.pauseOnHover,pauseOnDotsHover:"true"===scope.pauseOnDotsHover,respondTo:null!=scope.respondTo?scope.respondTo:"window",responsive:scope.responsive||void 0,rows:null!=scope.rows?parseInt(scope.rows,10):1,slide:scope.slide||"",slidesPerRow:null!=scope.slidesPerRow?parseInt(scope.slidesPerRow,10):1,slidesToShow:null!=scope.slidesToShow?parseInt(scope.slidesToShow,10):1,slidesToScroll:null!=scope.slidesToScroll?parseInt(scope.slidesToScroll,10):1,speed:null!=scope.speed?parseInt(scope.speed,10):300,swipe:"false"!==scope.swipe,swipeToSlide:"true"===scope.swipeToSlide,touchMove:"false"!==scope.touchMove,touchThreshold:scope.touchThreshold?parseInt(scope.touchThreshold,10):5,useCSS:"false"!==scope.useCSS,variableWidth:"true"===scope.variableWidth,vertical:"true"===scope.vertical,verticalSwiping:"true"===scope.verticalSwiping,rtl:"true"===scope.rtl},scope.settings)},destroy=function(){var slickness=angular.element(element);return slickness.hasClass("slick-initialized")&&(slickness.remove("slick-list"),slickness.slick("unslick")),slickness},init=function(){initOptions();var slickness=angular.element(element);if(angular.element(element).hasClass("slick-initialized")){if(options.enabled)return slickness.slick("getSlick");destroy()}else{if(!options.enabled)return;slickness.on("init",function(event,slick){if("undefined"!=typeof options.event.init&&options.event.init(event,slick),"undefined"!=typeof currentIndex)return slick.slideHandler(currentIndex)}),$timeout(function(){angular.element(element).css("display","block"),slickness.not(".slick-initialized").slick(options)})}scope.internalControl=options.method||{},slickMethodList.forEach(function(value){scope.internalControl[value]=function(){var args;args=Array.prototype.slice.call(arguments),args.unshift(value),slickness.slick.apply(element,args)}}),slickness.on("afterChange",function(event,slick,currentSlide){currentIndex=currentSlide,"undefined"!=typeof options.event.afterChange&&$timeout(function(){scope.$apply(function(){options.event.afterChange(event,slick,currentSlide)})})}),slickness.on("beforeChange",function(event,slick,currentSlide,nextSlide){"undefined"!=typeof options.event.beforeChange&&$timeout(function(){$timeout(function(){scope.$apply(function(){options.event.beforeChange(event,slick,currentSlide,nextSlide)})})})}),slickness.on("reInit",function(event,slick){"undefined"!=typeof options.event.reInit&&$timeout(function(){scope.$apply(function(){options.event.reInit(event,slick)})})}),"undefined"!=typeof options.event.breakpoint&&slickness.on("breakpoint",function(event,slick,breakpoint){$timeout(function(){scope.$apply(function(){options.event.breakpoint(event,slick,breakpoint)})})}),"undefined"!=typeof options.event.destroy&&slickness.on("destroy",function(event,slick){$timeout(function(){scope.$apply(function(){options.event.destroy(event,slick)})})}),"undefined"!=typeof options.event.edge&&slickness.on("edge",function(event,slick,direction){$timeout(function(){scope.$apply(function(){options.event.edge(event,slick,direction)})})}),"undefined"!=typeof options.event.setPosition&&slickness.on("setPosition",function(event,slick){$timeout(function(){scope.$apply(function(){options.event.setPosition(event,slick)})})}),"undefined"!=typeof options.event.swipe&&slickness.on("swipe",function(event,slick,direction){$timeout(function(){scope.$apply(function(){options.event.swipe(event,slick,direction)})})}),"undefined"!=typeof options.event.lazyLoaded&&slickness.on("lazyLoaded",function(event,slick,image,imageSource){$timeout(function(){scope.$apply(function(){options.event.lazyLoaded(event,slick,image,imageSource)})})}),"undefined"!=typeof options.event.lazyLoadError&&slickness.on("lazyLoadError",function(event,slick,image,imageSource){$timeout(function(){scope.$apply(function(){options.event.lazyLoadError(event,slick,image,imageSource)})})})},destroyAndInit=function(){destroy(),init()},element.one("$destroy",function(){destroy()}),scope.$watch("settings",function(newVal,oldVal){if(null!==newVal)return destroyAndInit()},!0)}}}]),function(){"use strict";var app;app=angular.module("BB",["BB.Controllers","BB.Filters","BB.Models","BB.Services","BB.Directives","ngStorage","angular-hal","ui.bootstrap","ngSanitize","ui.map","ui.router.util","ngLocalData","ngAnimate","angular-data.DSCacheFactory","ngFileUpload","schemaForm","uiGmapgoogle-maps","angular.filter","ui-rangeSlider","ngCookies","pascalprecht.translate","vcRecaptcha","slickCarousel"]),app.value("AppConfig",{appId:"f6b16c23",appKey:"f0bc4f65f4fbfe7b4b3b7264b655f5eb"}),app.value("AirbrakeConfig",{projectId:"122836",projectKey:"e6d6710b2cf00be965e8452d6a384d37",environment:"localhost"===window.location.hostname?"development":"production"}),window.use_no_conflict?(window.bbjq=$.noConflict(),app.value("$bbug",jQuery.noConflict(!0))):app.value("$bbug",jQuery),app.constant("UriTemplate",window.UriTemplate),app.config(["$locationProvider","$httpProvider","$provide","ie8HttpBackendProvider",function($locationProvider,$httpProvider,$provide,ie8HttpBackendProvider){var base,int,lowercase,msie,regexp,result,webkit;return $httpProvider.defaults.headers.common={"App-Id":"f6b16c23","App-Key":"f0bc4f65f4fbfe7b4b3b7264b655f5eb"},int=function(str){return parseInt(str,10)},lowercase=function(string){return angular.isString(string)?string.toLowerCase():string},msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1])),regexp=/Safari\/([\d.]+)/,result=regexp.exec(navigator.userAgent),result&&(webkit=parseFloat(result[1])),(msie&&msie<=9||webkit&&webkit<537)&&$provide.provider({$httpBackend:ie8HttpBackendProvider}),(base=moment.fn).toISODate||(base.toISODate=function(){return this.locale("en").format("YYYY-MM-DD")})}]),app.run(["$rootScope","$log","DebugUtilsService","FormDataStoreService","$bbug","$document","$sessionStorage","AppConfig",function($rootScope,$log,DebugUtilsService,FormDataStoreService,$bbug,$document,$sessionStorage,AppConfig){if($rootScope.$log=$log,$rootScope.$setIfUndefined=FormDataStoreService.setIfUndefined,$rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=$sessionStorage.getItem("host"),$bbug.support.opacity===!1)return document.createElement("header"),document.createElement("nav"),document.createElement("section"),document.createElement("footer")}]),angular.module("BB.Services",["ngResource","ngSanitize","ngLocalData"]),angular.module("BB.Controllers",["ngLocalData","ngSanitize"]),angular.module("BB.Directives",[]),angular.module("BB.Filters",[]),angular.module("BB.Models",[]),window.bookingbug={logout:function(options){var logout_opts;if(options||(options={}),options.reload!==!1&&(options.reload=!0),logout_opts={app_id:"f6b16c23",app_key:"f0bc4f65f4fbfe7b4b3b7264b655f5eb"},options.root&&(logout_opts.root=options.root),angular.injector(["BB.Services","BB.Models","ng"]).get("LoginService").logout(logout_opts),options.reload)return window.location.reload()}},String.prototype.includes||(String.prototype.includes=function(search,start){return"number"!=typeof start&&(start=0),!(start+search.length>this.length)&&this.indexOf(search,start)!==-1}),String.prototype.parameterise=function(seperator){return null==seperator&&(seperator="-"),this.trim().replace(/\s/g,seperator).toLowerCase()}}.call(this),angular.module("BB.Services").provider("ie8HttpBackend",function(){function ieCreateHttpBackend($browser,XHR,$browserDefer,callbacks,rawDocument,locationProtocol,sniffer,xhr){function completeRequest(callback,status,response,headersString){var url=url||$browser.url(),URL_MATCH=/^([^:]+):\/\/(\w+:{0,1}\w*@)?(\{?[\w\.-]*\}?)(:([0-9]+))?(\/[^\?#]*)?(\?([^#]*))?(#(.*))?$/,protocol=(url.match(URL_MATCH)||["",locationProtocol])[1];status="file"==protocol?response?200:404:status,status=1223==status?204:status,callback(status,response,headersString),$browser.$$completeOutstandingRequest(angular.noop)}if(!(sniffer.msie&&sniffer.msie<=9||sniffer.webkit&&sniffer.webkit<537))return null;var getHostName=function(path){var a=document.createElement("a");return a.href=path,a.hostname},isLocalCall=function(reqUrl){var reqHost=getHostName(reqUrl),localHost=getHostName($browser.url());return""==reqHost||(patt=new RegExp(localHost+"$","i"),patt.test(reqHost))},pmHandler=function(method,url,post,callback,headers,timeout,withCredentials){var win=$('[name="'+getHostName(url)+'"]')[0].id;pm({target:window.frames[win],type:"xhrRequest",data:{headers:headers,method:method,data:post,url:url},success:function(respObj){headers="Content-Type: "+respObj.contentType,respObj.authToken&&(headers+="\r\nAuth-Token: "+respObj.authToken),completeRequest(callback,respObj.statusCode.status,respObj.responseText,headers)},error:function(data){completeRequest(callback,500,"Error","Content-Type: text/plain")}})};return function(method,url,post,callback,headers,timeout,withCredentials){$browser.$$incOutstandingRequestCount(),url=url||$browser.url(),isLocalCall(url)?xhr(method,url,post,callback,headers,timeout,withCredentials):pmHandler(method,url,post,callback,headers,timeout,withCredentials),timeout>0&&$browserDefer(function(){status=-1,xdr.abort()},timeout)}}function int(str){return parseInt(str,10)}function createXhr(method){if(msie<=8&&(!method.match(/^(get|post|head|put|delete|options)$/i)||!window.XMLHttpRequest))return new window.ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new window.XMLHttpRequest;throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument,locationProtocol,msie){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),msie<=8&&(script.onreadystatechange=function(){isString(script.readyState)&&/loaded|complete/.test(script.readyState)&&(script.onreadystatechange=null,callback({type:"load"}))}),rawDocument.body.appendChild(script),callback}var ABORTED=-1;return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=ABORTED,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),status=1223===status?204:status,statusText=statusText||"",callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(angular.noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=angular.noop})}else{var xhr=createXhr(method);if(xhr.open(method,url,!0),angular.forEach(headers,function(value,key){angular.isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(xhr&&4==xhr.readyState){var responseHeaders=null,response=null,statusText="";status!==ABORTED&&(responseHeaders=xhr.getAllResponseHeaders(),response="response"in xhr?xhr.response:xhr.responseText),status===ABORTED&&msie<10||(statusText=xhr.statusText),completeRequest(callback,status||xhr.status,response,responseHeaders,statusText)}},withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}this.$get=["$browser","$window","$document","$sniffer",function($browser,$window,$document,$sniffer){var params=[$browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0],$window.location.protocol.replace(":",""),$sniffer],param4ie=params.concat([createHttpBackend.apply(this,params)]);return ieCreateHttpBackend&&ieCreateHttpBackend.apply(this,param4ie)||createHttpBackend.apply(this,params)}];var lowercase=function(string){return angular.isString(string)?string.toLowerCase():string},msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]);isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1]));var lowercase=function(string){return angular.isString(string)?string.toLowerCase():string}});var NO_JQUERY={};!function(window,$,undefined){if(!("console"in window)){var c=window.console={};c.log=c.warn=c.error=c.debug=function(){}}$===NO_JQUERY&&($={fn:{},extend:function(){for(var a=arguments[0],i=1,len=arguments.length;i<len;i++){var b=arguments[i];for(var prop in b)a[prop]=b[prop]}return a}}),$.fn.pm=function(){return console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])"),this},$.pm=window.pm=function(options){pm.send(options)},$.pm.bind=window.pm.bind=function(type,fn,origin,hash,async_reply){pm.bind(type,fn,origin,hash,async_reply===!0)},$.pm.unbind=window.pm.unbind=function(type,fn){pm.unbind(type,fn)},$.pm.origin=window.pm.origin=null,$.pm.poll=window.pm.poll=200;var pm={send:function(options){var o=$.extend({},pm.defaults,options),target=o.target;if(!o.target)return void console.warn("postmessage target window required");if(!o.type)return void console.warn("postmessage type required");var msg={data:o.data,type:o.type};o.success&&(msg.callback=pm._callback(o.success)),o.error&&(msg.errback=pm._callback(o.error)),"postMessage"in target&&!o.hash?(pm._bind(),target.postMessage(JSON.stringify(msg),o.origin||"*")):"postMessage"in target.contentWindow&&!o.hash?(pm._bind(),target.contentWindow.postMessage(JSON.stringify(msg),o.origin||"*")):(pm.hash._bind(),pm.hash.send(o,msg))},bind:function(type,fn,origin,hash,async_reply){pm._replyBind(type,fn,origin,hash,async_reply)},_replyBind:function(type,fn,origin,hash,isCallback){"postMessage"in window&&!hash?pm._bind():pm.hash._bind();var l=pm.data("listeners.postmessage");l||(l={},pm.data("listeners.postmessage",l));var fns=l[type];fns||(fns=[],l[type]=fns),fns.push({fn:fn,callback:isCallback,origin:origin||$.pm.origin})},unbind:function(type,fn){var l=pm.data("listeners.postmessage");if(l)if(type)if(fn){var fns=l[type];if(fns){for(var m=[],i=0,len=fns.length;i<len;i++){var o=fns[i];o.fn!==fn&&m.push(o)}l[type]=m}}else delete l[type];else for(var i in l)delete l[i]},data:function(k,v){return v===undefined?pm._data[k]:(pm._data[k]=v,v)},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var r=[],i=0;i<32;i++)r[i]=pm._CHARS[0|32*Math.random()];return r.join("")},_callback:function(fn){var cbs=pm.data("callbacks.postmessage");cbs||(cbs={},pm.data("callbacks.postmessage",cbs));var r=pm._random();return cbs[r]=fn,r},_bind:function(){pm.data("listening.postmessage")||(window.addEventListener?window.addEventListener("message",pm._dispatch,!1):window.attachEvent&&window.attachEvent("onmessage",pm._dispatch),pm.data("listening.postmessage",1))},_dispatch:function(e){function sendReply(data){msg.callback&&pm.send({target:e.source,data:data,type:msg.callback})}try{var msg=JSON.parse(e.data)}catch(ex){return void console.warn("postmessage data invalid json: ",ex)}if(!msg.type)return void console.warn("postmessage message type required");var cbs=pm.data("callbacks.postmessage")||{},cb=cbs[msg.type];if(cb)cb(msg.data);else for(var l=pm.data("listeners.postmessage")||{},fns=l[msg.type]||[],i=0,len=fns.length;i<len;i++){var o=fns[i];if(o.origin&&"*"!==o.origin&&e.origin!==o.origin){if(console.warn("postmessage message origin mismatch",e.origin,o.origin),msg.errback){var error={message:"postmessage origin mismatch",origin:[e.origin,o.origin]};pm.send({target:e.source,data:error,type:msg.errback})}}else try{o.callback?o.fn(msg.data,sendReply,e):sendReply(o.fn(msg.data,e))}catch(ex){if(!msg.errback)throw ex;pm.send({target:e.source,data:ex,type:msg.errback})}}}};pm.hash={send:function(options,msg){var target_window=options.target,target_url=options.url;if(!target_url)return void console.warn("postmessage target window url is required");target_url=pm.hash._url(target_url);var source_window,source_url=pm.hash._url(window.location.href);if(window==target_window.parent)source_window="parent";else try{for(var i=0,len=parent.frames.length;i<len;i++){var f=parent.frames[i];if(f==window){source_window=i;break}}}catch(ex){source_window=window.name}if(null==source_window)return void console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list");var hashmessage={"x-requested-with":"postmessage",source:{name:source_window,url:source_url},postmessage:msg},hash_id="#x-postmessage-id="+pm._random();target_window.location=target_url+hash_id+encodeURIComponent(JSON.stringify(hashmessage))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){pm.data("polling.postmessage")||(setInterval(function(){var hash=""+window.location.hash,m=pm.hash._regex.exec(hash);if(m){var id=m[1];pm.hash._last!==id&&(pm.hash._last=id,pm.hash._dispatch(hash.substring(pm.hash._regex_len)))}},$.pm.poll||200),pm.data("polling.postmessage",1))},_dispatch:function(hash){function sendReply(data){msg.callback&&pm.send({target:source_window,data:data,type:msg.callback,hash:!0,url:hash.source.url})}if(hash){try{if(hash=JSON.parse(decodeURIComponent(hash)),!("postmessage"===hash["x-requested-with"]&&hash.source&&null!=hash.source.name&&hash.source.url&&hash.postmessage))return}catch(ex){return}var msg=hash.postmessage,cbs=pm.data("callbacks.postmessage")||{},cb=cbs[msg.type];if(cb)cb(msg.data);else{var source_window;source_window="parent"===hash.source.name?window.parent:window.frames[hash.source.name];for(var l=pm.data("listeners.postmessage")||{},fns=l[msg.type]||[],i=0,len=fns.length;i<len;i++){var o=fns[i];if(o.origin){var origin=/https?\:\/\/[^\/]*/.exec(hash.source.url)[0];if("*"!==o.origin&&origin!==o.origin){if(console.warn("postmessage message origin mismatch",origin,o.origin),msg.errback){var error={message:"postmessage origin mismatch",origin:[origin,o.origin]};pm.send({target:source_window,data:error,type:msg.errback,hash:!0,url:hash.source.url})}continue}}try{o.callback?o.fn(msg.data,sendReply):sendReply(o.fn(msg.data))}catch(ex){if(!msg.errback)throw ex;pm.send({target:source_window,data:ex,type:msg.errback,hash:!0,url:hash.source.url})}}}}},_url:function(url){return(""+url).replace(/#.*$/,"")}},$.extend(pm,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})}(this,"undefined"==typeof jQuery?NO_JQUERY:jQuery),"JSON"in window&&window.JSON||(JSON={}),function(){function f(n){return n<10?"0"+n:n}function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;i<length;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;i<length;i+=1)k=rep[i],"string"==typeof k&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.hasOwnProperty.call(value,k)&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(key){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;i<space;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){angular.module("schemaForm").config(["schemaFormProvider","schemaFormDecoratorsProvider","sfPathProvider",function(schemaFormProvider,schemaFormDecoratorsProvider,sfPathProvider){var datetimepicker,timepicker;return timepicker=function(name,schema,options){var f;if("string"===schema.type&&"time"===schema.format)return f=schemaFormProvider.stdFormObj(name,schema,options),f.key=options.path,f.type="timepicker",options.lookup[sfPathProvider.stringify(options.path)]=f,f},schemaFormProvider.defaults.string.unshift(timepicker),datetimepicker=function(name,schema,options){var f;if("string"===schema.type&&"datetime"===schema.format)return f=schemaFormProvider.stdFormObj(name,schema,options),f.key=options.path,f.type="datetime",options.lookup[sfPathProvider.stringify(options.path)]=f,f},schemaFormProvider.defaults.string.unshift(datetimepicker),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","time","bootstrap_ui_time_form.html"),schemaFormDecoratorsProvider.createDirective("time","bootstrap_ui_time_form.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","datetime","bootstrap_ui_datetime_form.html"),schemaFormDecoratorsProvider.createDirective("datetime","bootstrap_ui_datetime_form.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","price","price_form.html"),schemaFormDecoratorsProvider.createDirective("price","price_form.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","date","date_form.html"),schemaFormDecoratorsProvider.createDirective("date","date_form.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","radios","radios.html"),
schemaFormDecoratorsProvider.createDirective("radios","radios.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","radios-inline","radios-inline.html"),schemaFormDecoratorsProvider.createDirective("radios-inline","radios-inline.html"),schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","radiobuttons","radio-buttons.html"),schemaFormDecoratorsProvider.createDirective("radiobuttons","radio-buttons.html")}])}.call(this),function(){window.Collection=function(){function Collection(){}return Collection}(),window.Collection.Base=function(){function Base(res,items,params){var clean_params,key,m,n,val;this.res=res,this.items=items,this.params=params,this.callbacks=[],clean_params={};for(key in params)val=params[key],null!=val&&(null!=val.id?clean_params[key+"_id"]=val.id:clean_params[key]=val);if(this.jparams=JSON.stringify(clean_params),res)for(n in res)m=res[n],this[n]=m}return Base.prototype.checkItem=function(item){var call,existingItem,i,index,j,k,len1,len2,len3,ref,ref1,ref2,results;if(!this.matchesParams(item))return this.deleteItem(item),!0;for(ref=this.items,index=i=0,len1=ref.length;i<len1;index=++i)if(existingItem=ref[index],item.self===existingItem.self){for(this.items[index]=item,ref1=this.callbacks,j=0,len2=ref1.length;j<len2;j++)call=ref1[j],call[1](item,"update");return!0}for(this.items.push(item),ref2=this.callbacks,results=[],k=0,len3=ref2.length;k<len3;k++)call=ref2[k],results.push(call[1](item,"add"));return results},Base.prototype.deleteItem=function(item){var call,i,len,len1,ref,results;if(len=this.items.length,this.items=this.items.filter(function(x){return x.self!==item.self}),this.items.length!==len){for(ref=this.callbacks,results=[],i=0,len1=ref.length;i<len1;i++)call=ref[i],results.push(call[1](item,"delete"));return results}},Base.prototype.getItems=function(){return this.items},Base.prototype.addCallback=function(obj,fn){var call,i,len1,ref;for(ref=this.callbacks,i=0,len1=ref.length;i<len1;i++)if(call=ref[i],call[0]===obj)return;return this.callbacks.push([obj,fn])},Base.prototype.matchesParams=function(item){return!0},Base}(),window.BaseCollections=function(){function BaseCollections(){this.collections=[]}return BaseCollections.prototype.count=function(){return this.collections.length},BaseCollections.prototype.add=function(col){return this.collections.push(col)},BaseCollections.prototype.checkItems=function(item){var col,i,len1,ref,results;for(ref=this.collections,results=[],i=0,len1=ref.length;i<len1;i++)col=ref[i],results.push(col.checkItem(item));return results},BaseCollections.prototype.deleteItems=function(item){var col,i,len1,ref,results;for(ref=this.collections,results=[],i=0,len1=ref.length;i<len1;i++)col=ref[i],results.push(col.deleteItem(item));return results},BaseCollections.prototype.find=function(prms){var clean_params,col,i,jprms,key,len1,ref,val;clean_params={};for(key in prms)val=prms[key],null!=val&&(null!=val.id?clean_params[key+"_id"]=val.id:clean_params[key]=val);for(jprms=JSON.stringify(clean_params),ref=this.collections,i=0,len1=ref.length;i<len1;i++)if(col=ref[i],jprms===col.jparams)return col},BaseCollections.prototype["delete"]=function(col){return this.collections=_.without(this.collections,col)},BaseCollections}()}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;window.Collection.Day=function(superClass){function Day(){return Day.__super__.constructor.apply(this,arguments)}return extend(Day,superClass),Day.prototype.checkItem=function(item){return Day.__super__.checkItem.apply(this,arguments)},Day}(window.Collection.Base),angular.module("BB.Services").provider("DayCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;window.Collection.Space=function(superClass){function Space(){return Space.__super__.constructor.apply(this,arguments)}return extend(Space,superClass),Space.prototype.checkItem=function(item){return Space.__super__.checkItem.apply(this,arguments)},Space}(window.Collection.Base),angular.module("BB.Services").provider("SpaceCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),angular.module("angular-hal",[]).provider("data_cache",function(){this.$get=function(){return data=[],{set:function(key,val){return data[key]=val,val},get:function(key){return data[key]},del:function(key){delete data[key]},has:function(key){return key in data},delMatching:function(str){for(var k in data)k.indexOf(str)!=-1&&delete data[k]}}}}).provider("shared_header",function(){this.$get=function(){return data={},{set:function(key,val,store){return store.setItem(key,val),data[key]=val,val},get:function(key){return data[key]},del:function(key){delete data[key]},has:function(key){return key in data}}}}).factory("halClient",["$http","$q","data_cache","shared_header","UriTemplate","$cookies","$sessionStorage","$localStorage",function($http,$q,data_cache,shared_header,UriTemplate,$cookies,$sessionStorage,$localStorage){function BaseResource(href,options,data,extra){function defineHiddenProperty(target,name,value){target[name]=value}function embedResource(resource){if(angular.isArray(resource))return resource.map(function(resource){return embedResource(resource)});var href=resource.$href("self");embedded.set(href,$q.when(resource))}function hrefLink(link,params){var href=link.templated?new UriTemplate(link.href).fillFromObject(params||{}):link.href;return href}function callLink(method,link,params,data){if(null==params&&(params={}),angular.isArray(link))return $q.all(link.map(function(link){if("GET"!==method)throw"method is not supported for arrays";return callLink(method,link,params,data)}));var linkHref=hrefLink(link,params);return"GET"===method?embedded.has(linkHref)&&!params.no_cache?embedded.get(linkHref):embedded.set(linkHref,callService(method,linkHref,options,data)):callService(method,linkHref,options,data)}function flushLink(link,params){if(angular.isArray(link))return link.map(function(link){return flushLink(link,params)});var linkHref=hrefLink(link,params);embedded.has(linkHref)&&embedded.del(linkHref)}options||(options={}),extra||(extra={});var links={},embedded=data_cache;data.hasOwnProperty("auth_token")&&(options.auth_token=data.auth_token),href=getSelfLink(href,data).href,defineHiddenProperty(this,"$href",function(rel,params){return rel in links?hrefLink(links[rel],params):null}),defineHiddenProperty(this,"$has",function(rel){return rel in links}),defineHiddenProperty(this,"$flush",function(rel,params){var link=links[rel];return flushLink(link,params)}),defineHiddenProperty(this,"$get",function(rel,params){var link=links[rel];return callLink("GET",link,params)}),defineHiddenProperty(this,"$post",function(rel,params,data){var link=links[rel];return callLink("POST",link,params,data)}),defineHiddenProperty(this,"$put",function(rel,params,data){var link=links[rel];return callLink("PUT",link,params,data)}),defineHiddenProperty(this,"$patch",function(rel,params,data){var link=links[rel];return callLink("PATCH",link,params,data)}),defineHiddenProperty(this,"$del",function(rel,params,data){var link=links[rel];return callLink("DELETE",link,params,data)}),defineHiddenProperty(this,"$links",function(){return links}),defineHiddenProperty(this,"$toStore",function(){return JSON.stringify({data:this,links:links,options:options})}),defineHiddenProperty(this,"setOption",function(key,value){options[key]=value}),defineHiddenProperty(this,"getOption",function(key){return options[key]}),defineHiddenProperty(this,"$link",function(rel){return links[rel]}),Object.keys(data).filter(function(key){return!~["_","$"].indexOf(key[0])}).forEach(function(key){this[key]=data[key]},this),data._links&&Object.keys(data._links).forEach(function(rel){var link=data._links[rel];link=normalizeLink(href,link),links[rel]=link},this),data._embedded&&Object.keys(data._embedded).forEach(function(rel){var embedded=data._embedded[rel],link=getSelfLink(href,embedded);links[rel]=link;var resource=createResource(href,options,embedded);embedResource(resource)},this),extra.is_new&&(this.is_new=!0)}function createResource(href,options,data,extra){if(angular.isArray(data))return data.map(function(data){return createResource(href,options,data,extra)});var resource=new BaseResource(href,options,data,extra);return resource}function normalizeLink(baseHref,link){return angular.isArray(link)?link.map(function(link){return normalizeLink(baseHref,link)}):(link?("string"==typeof link&&(link={href:link}),link.href=resolveUrl(baseHref,link.href)):link={href:baseHref},link)}function getSelfLink(baseHref,resource){return angular.isArray(resource)?resource.map(function(resource){return getSelfLink(baseHref,resource)}):normalizeLink(baseHref,resource&&resource._links&&resource._links.self)}function callService(method,href,options,data){options||(options={});var headers={"Content-Type":"application/json",Accept:"application/hal+json,application/json"};options.authorization&&(headers.Authorization=options.authorization),options.app_id&&shared_header.set("app_id",options.app_id,$sessionStorage),options.app_key&&shared_header.set("app_key",options.app_key,$sessionStorage),options.auth_token&&($sessionStorage.setItem("auth_token",options.auth_token),shared_header.set("auth_token",options.auth_token,$sessionStorage)),shared_header.has("app_id")&&(headers["App-Id"]=shared_header.get("app_id")),shared_header.has("app_key")&&(headers["App-Key"]=shared_header.get("app_key")),shared_header.has("auth_token")&&(headers["Auth-Token"]=shared_header.get("auth_token")),options.bypass_auth&&(headers["Bypass-Auth"]=options.bypass_auth);var resource=$http({method:method,url:options.transformUrl?options.transformUrl(href):href,headers:headers,data:data}).then(function(res){switch(res.headers("auth-token")&&201==res.status&&(options.auth_token=res.headers("Auth-Token"),shared_header.set("auth_token",res.headers("Auth-Token"),$sessionStorage),$localStorage.getItem("auth_token")&&$localStorage.setItem("auth_token",res.headers("Auth-Token"))),res.status){case 200:return res.data&&'"null"'!==res.data?createResource(href,options,res.data):null;case 201:return extra={is_new:!0},res.data?createResource(href,options,res.data,extra):res.headers("Content-Location")?res.headers("Content-Location"):null;case 204:return null;default:return $q.reject(res)}},function(res){return $q.reject(res)});return resource}function parseHal(data){var resource=createResource(data._links.self.href,null,data);return resource}function resolveUrl(baseHref,href){for(var resultHref="",reFullUrl=/^((?:\w+\:)?)((?:\/\/)?)([^\/]*)((?:\/.*)?)$/,baseHrefMatch=reFullUrl.exec(baseHref),hrefMatch=reFullUrl.exec(href),partIndex=1;partIndex<5;partIndex++)resultHref+=hrefMatch[partIndex]?hrefMatch[partIndex]:baseHrefMatch[partIndex];return resultHref}return $sessionStorage.getItem("auth_token")?shared_header.set("auth_token",$sessionStorage.getItem("auth_token"),$sessionStorage):$cookies["Auth-Token"]&&!shared_header.has("auth_token")&&shared_header.set("auth_token",$cookies["Auth-Token"],$sessionStorage),{setCache:function(cache){data_cache=cache},clearCache:function(str){data_cache.delMatching(str)},createResource:function(store){return"string"==typeof store&&(store=JSON.parse(store)),resource=store.data,resource._links=store.links,key=store.links.self.href,options=store.options,new BaseResource(key,options,resource)},$get:function(href,options){return!data_cache.has(href)||options&&options.no_cache?data_cache.set(href,callService("GET",href,options)):data_cache.get(href)},$post:function(href,options,data){return callService("POST",href,options,data)},$put:function(href,options,data){return callService("PUT",href,options,data)},$patch:function(href,options,data){return callService("PATCH",href,options,data)},$del:function(href,options,data){return callService("DELETE",href,options,data)},$parse:function(data){return parseHal(data)}}}]),angular.module("ngStorage",[]).factory("$fakeStorage",["$cookies",function($cookies){function FakeStorage(){}return FakeStorage.prototype.setItem=function(key,value){$cookies[key]=value},FakeStorage.prototype.getItem=function(key){return"undefined"==typeof $cookies[key]?null:$cookies[key]},FakeStorage.prototype.removeItem=function(key){$cookies[key]&&delete $cookies[key]},FakeStorage.prototype.clear=function(){for(var key in $cookies)$cookies.hasOwnProperty(key)&&delete $cookies[key]},FakeStorage.prototype.key=function(index){return Object.keys($cookies)[index]},new FakeStorage}]).factory("$localStorage",["$window","$fakeStorage",function($window,$fakeStorage){function isStorageSupported(storageName){var testKey="test",storage=$window[storageName];try{return storage.setItem(testKey,"1"),storage.removeItem(testKey),!0}catch(error){return!1}}var storage=isStorageSupported("localStorage")?$window.localStorage:$fakeStorage;return{setItem:function(key,value){storage.setItem(key,value)},getItem:function(key,defaultValue){return storage.getItem(key)||defaultValue},setObject:function(key,value){storage.setItem(key,JSON.stringify(value))},getObject:function(key){return JSON.parse(storage.getItem(key)||"{}")},removeItem:function(key){storage.removeItem(key)},clear:function(){storage.clear()},key:function(index){storage.key(index)}}}]).factory("$sessionStorage",["$window","$fakeStorage",function($window,$fakeStorage){function isStorageSupported(storageName){var testKey="test",storage=$window[storageName];try{return storage.setItem(testKey,"1"),storage.removeItem(testKey),!0}catch(error){return!1}}var storage=isStorageSupported("sessionStorage")?$window.sessionStorage:$fakeStorage;return{setItem:function(key,value){storage.setItem(key,value)},getItem:function(key,defaultValue){return storage.getItem(key)||defaultValue},setObject:function(key,value){storage.setItem(key,JSON.stringify(value))},getObject:function(key){return JSON.parse(storage.getItem(key)||"{}")},removeItem:function(key){storage.removeItem(key)},clear:function(){storage.clear()},key:function(index){storage.key(index)}}}]),angular.module("ngLocalData",["angular-hal"]).factory("$localCache",["halClient","$q","$sessionStorage",function(halClient,$q,$sessionStorage){return data={},jsonData=function(data){return data&&JSON.parse(data)},storage=function(){return $sessionStorage},localSave=function(key,item){storage().setItem(key,item.$toStore())},localLoad=function(key){return res=jsonData(storage().getItem(key)),res?(r=halClient.createResource(res),def=$q.defer(),def.resolve(r),def.promise):null},localDelete=function(key){storage().removeItem(key)},{set:function(key,val){return data[key]=val,val.then(function(item){localSave(key,item)}),val},get:function(key){return localLoad(key),data[key]||(data[key]=localLoad(key)),data[key]},del:function(key){localDelete(key),delete data[key]},has:function(key){return data[key]||(res=localLoad(key),res&&(data[key]=res)),key in data}}}]).factory("$localData",["$http","$rootScope","$sessionStorage",function($http,$rootScope,$sessionStorage){function LocalDataFactory(name){function LocalData(value){this.setStore(value)}return LocalData.prototype.jsonData=function(data){return data&&JSON.parse(data)},LocalData.prototype.storage=function(){return $sessionStorage},LocalData.prototype.localSave=function(item){this.storage().setItem(this.store_name+item.id,JSON.stringify(item))},LocalData.prototype.localSaveIndex=function(ids){this.storage().setItem(this.store_name,ids.join(",")),this.ids=ids},LocalData.prototype.localLoadIndex=function(){return store=this.storage().getItem(this.store_name),records=store&&store.split(",")||[],records},LocalData.prototype.localLoad=function(id){return this.jsonData(this.storage().getItem(this.store_name+id))},LocalData.prototype.count=function(){return this.ids.length},LocalData.prototype.setStore=function(name){for(this.store_name=name,this.data_store=[],this.ids=this.localLoadIndex(),a=0;a<this.ids.length;a++)this.data_store.push(this.localLoad(this.ids[a]))},LocalData.prototype.update=function(data){ids=[];for(x in data)data[x].id&&(ids.push(data[x].id),this.localSave(data[x]));this.localSaveIndex(ids)},new LocalData(name)}return LocalDataFactory}]),getControllerScope=function(controller,fn){$(document).ready(function(){var $element=$('div[data-ng-controller="'+controller+'"]'),scope=angular.element($element).scope();fn(scope)})},function(){"use strict";angular.module("BB.Directives").directive("bbAccordionRangeGroup",["PathSvc",function(PathSvc){return{restrict:"AE",replace:!1,scope:{day:"=",slots:"=",selectSlot:"=",disabled_slot:"=disabledSlot"},controller:"AccordionRangeGroup",link:function(scope,element,attrs){return scope.options=scope.$eval(attrs.bbAccordionRangeGroup)||{}},templateUrl:function(element,attrs){return PathSvc.directivePartial("_accordion_range_group")}}}]),angular.module("BB.Controllers").controller("AccordionRangeGroup",["$scope","$attrs","$rootScope","$q","FormDataStoreService","SettingsService","DateTimeUtilitiesService",function($scope,$attrs,$rootScope,$q,FormDataStoreService,SettingsService,DateTimeUtilitiesService){var hasAvailability,setData,updateAvailability;return $scope.controller="public.controllers.AccordionRangeGroup",$scope.$watch("slots",function(){return setData()}),$rootScope.connection_started.then(function(){return $scope.init()}),$scope.setFormDataStoreId=function(id){return FormDataStoreService.init("AccordionRangeGroup"+id,$scope,[])},$scope.init=function(){return $scope.start_time=$scope.options.range[0],$scope.end_time=$scope.options.range[1],$scope.options.collaspe_when_time_selected=!_.isBoolean($scope.options.collaspe_when_time_selected)||$scope.options.collaspe_when_time_selected,$scope.options.hide_availability_summary=!!_.isBoolean($scope.options.hide_availability_summary)&&$scope.options.hide_availability_summary,$scope.heading=$scope.options.heading,setData()},setData=function(){if($scope.accordion_slots=[],$scope.is_open=$scope.is_open||!1,$scope.has_availability=$scope.has_availability||!1,$scope.is_selected=$scope.is_selected||!1,$scope.slots)return angular.forEach($scope.slots,function(slot){var datetime,slot_time;if(SettingsService.getDisplayTimeZone()!==SettingsService.getTimeZone()?(datetime=moment(slot.datetime).tz(SettingsService.getDisplayTimeZone()),slot_time=DateTimeUtilitiesService.convertMomentToTime(datetime)):slot_time=slot.time,slot_time>=$scope.start_time&&slot_time<$scope.end_time&&1===slot.avail)return $scope.accordion_slots.push(slot)}),updateAvailability()},updateAvailability=function(day,slot){var datetime,i,j,len,len1,ref,ref1,relevent_slot,slot_time,times;if($scope.selected_slot=null,$scope.accordion_slots&&($scope.has_availability=hasAvailability()),$scope.disabled_slot&&$scope.disabled_slot.time&&$scope.disabled_slot.date===$scope.day.date.toISODate())if(Array.isArray($scope.disabled_slot.time))for(ref=$scope.disabled_slot.time,i=0,len=ref.length;i<len;i++)times=ref[i],relevent_slot=_.findWhere($scope.slots,{time:times}),relevent_slot&&(relevent_slot.disabled=!0);else relevent_slot=_.findWhere($scope.slots,{time:$scope.disabled_slot.time}),relevent_slot&&(relevent_slot.disabled=!0);if(day&&slot)SettingsService.getDisplayTimeZone()!==SettingsService.getTimeZone()?(datetime=moment(slot.datetime).tz(SettingsService.getDisplayTimeZone()),slot_time=DateTimeUtilitiesService.convertMomentToTime(datetime)):slot_time=slot.time,day.date.isSame($scope.day.date)&&slot_time>=$scope.start_time&&slot_time<$scope.end_time&&($scope.selected_slot=slot);else for(ref1=$scope.accordion_slots,j=0,len1=ref1.length;j<len1;j++)if(slot=ref1[j],slot.selected){$scope.selected_slot=slot;break}if($scope.selected_slot){if($scope.hideHeading=!0,$scope.is_selected=!0,$scope.options.collaspe_when_time_selected)return $scope.is_open=!1}else if($scope.is_selected=!1,$scope.options.collaspe_when_time_selected)return $scope.is_open=!1},hasAvailability=function(){var i,len,ref,slot;if(!$scope.accordion_slots)return!1;for(ref=$scope.accordion_slots,i=0,len=ref.length;i<len;i++)if(slot=ref[i],slot.availability()>0)return!0;return!1},$scope.$on("slotChanged",function(event,day,slot){return day&&slot?updateAvailability(day,slot):updateAvailability()})}])}.call(this),function(){angular.module("BB.Directives").directive("bbAddresses",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"AddressList"}}),angular.module("BB.Controllers").controller("AddressList",["$scope","$rootScope","$filter","$sniffer","AddressListService","FormDataStoreService",function($scope,$rootScope,$filter,$sniffer,AddressListService,FormDataStoreService){return $scope.controller="public.controllers.AddressList",$scope.manual_postcode_entry=!1,FormDataStoreService.init("AddressList",$scope,["show_complete_address"]),$rootScope.connection_started.then(function(_this){return function(){if($scope.client.postcode&&!$scope.bb.postcode&&($scope.bb.postcode=$scope.client.postcode),$scope.client.postcode&&$scope.bb.postcode&&$scope.client.postcode===$scope.bb.postcode&&!$scope.bb.address1&&($scope.bb.address1=$scope.client.address1,$scope.bb.address2=$scope.client.address2,$scope.bb.address3=$scope.client.address3,$scope.bb.address4=$scope.client.address4,$scope.bb.address5=$scope.client.address5),$scope.manual_postcode_entry=!$scope.bb.postcode,$scope.show_complete_address=!!$scope.bb.address1,!$scope.postcode_submitted)return $scope.findByPostcode(),$scope.postcode_submitted=!1}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.findByPostcode=function(){if($scope.postcode_submitted=!0,$scope.bb.postcode)return $scope.notLoaded($scope),AddressListService.query({company:$scope.bb.company,post_code:$scope.bb.postcode}).then(function(response){var addressArr,newaddr;addressArr=angular.isArray(response)?_.map(response,function(item,i){return{address:item.partialAddress,moniker:item.moniker}}):[{address:response.partialAddress,moniker:response.moniker}],1===addressArr.length&&$sniffer.msie&&(newaddr=[],newaddr.push(addressArr[0]),newaddr.push({address:""}),addressArr=newaddr),$scope.addresses=addressArr,$scope.bb.address=addressArr[0],$scope.client.address=addressArr[0],$scope.setLoaded($scope)},function(err){return $scope.show_complete_address=!0,$scope.postcode_submitted=!0,$scope.setLoaded($scope)})},$scope.showCompleteAddress=function(){if($scope.show_complete_address=!0,$scope.postcode_submitted=!1,$scope.bb.address&&$scope.bb.address.moniker)return $scope.notLoaded($scope),AddressListService.getAddress({company:$scope.bb.company,id:$scope.bb.address.moniker}).then(function(response){var address,address2,address3,addressLine2,building_number,house_number,streetName;address=response,house_number="","string"==typeof address.buildingNumber?house_number=address.buildingNumber:null==address.buildingNumber&&(house_number=address.buildingName),"string"==typeof address.streetName?(streetName=address.streetName?address.streetName:"",$scope.bb.address1=house_number+" "+streetName):(addressLine2=address.addressLine2?address.addressLine2:"",$scope.bb.address1=house_number+" "+addressLine2),address.buildingName&&null==address.buildingNumber&&($scope.bb.address1=house_number,$scope.bb.address2=address.streetName,null!=address.county&&($scope.bb.address4=address.county)),"string"==typeof address.buildingNumber&&"string"==typeof address.buildingName&&"string"==typeof address.streetName&&(streetName=address.streetName?address.streetName:"",$scope.bb.address1=address.buildingName,$scope.bb.address2=address.buildingNumber+" "+streetName),null!=address.buildingName&&address.buildingName.match(/(^[^0-9]+$)/)&&(building_number=address.buildingNumber?address.buildingNumber:"",$scope.bb.address1=address.buildingName+" "+building_number,$scope.bb.address2=address.streetName),null==address.buildingNumber&&null==address.streetName&&($scope.bb.address1=address.buildingName,$scope.bb.address2=address.addressLine3,$scope.bb.address4=address.town),null!=address.companyName&&($scope.bb.address1=address.companyName,null==address.buildingNumber&&null==address.streetName?$scope.bb.address2=address.addressLine3:null==address.buildingNumber?(address2=address.buildingName?address.buildingName+", "+address.streetName:address.streetName,$scope.bb.address2=address2):null==address.buildingName&&null==address.addressLine2?$scope.bb.address2=address.buildingNumber+", "+address.streetName:$scope.bb.address2=address.buildingName,$scope.bb.address3=address.buildingName,address3=address.addressLine3&&null!=address.buildingNumber?address.addressLine3:null==address.addressLine2&&null!=address.buildingNumber?address.buildingNumber+" "+address.streetName:null==address.addressLine2&&null==address.buildingNumber&&null!=address.buildingName?address.addressLine3:"",$scope.bb.address3=address3,$scope.bb.address4=address.town,$scope.bb.address5="",$scope.bb.postcode=address.postCode),null==address.buildingName&&null==address.companyName&&null==address.county?(address2=null==address.addressLine2&&null==address.companyName?address.addressLine3:address.addressLine2,$scope.bb.address2=address2):null==address.buildingName&&null==address.companyName&&($scope.bb.address2=address.addressLine3),null!=address.buildingName&&null!=address.streetName&&null==address.companyName&&null!=address.addressLine3?null==address.addressLine3?$scope.bb.address3=address.buildingName:$scope.bb.address3=address.addressLine3:null==address.buildingName&&null==address.companyName&&null!=address.addressLine2?$scope.bb.address3=address.addressLine3:null==address.buildingName&&null!=address.streetName&&null==address.addressLine3&&($scope.bb.address3=address.addressLine3),$scope.bb.address4=address.town,null!=address.county&&($scope.bb.address5=address.county),$scope.setLoaded($scope)},function(err){return $scope.show_complete_address=!0,$scope.postcode_submitted=!1,$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.setManualPostcodeEntry=function(value){return $scope.manual_postcode_entry=value},$scope.$on("client_details:reset_search",function(event){return $scope.bb.address1=null,$scope.bb.address2=null,$scope.bb.address3=null,$scope.bb.address4=null,$scope.bb.address5=null,$scope.show_complete_address=!1,$scope.postcode_submitted=!1,$scope.bb.address=$scope.addresses[0]})}])}.call(this),function(){angular.module("BB.Directives").directive("bbAttendees",function(){return{restrict:"AE",replace:!0,scope:!0,controller:["$scope","$rootScope","$q","PurchaseService","BBModel","AlertService","ValidatorService","ClientService",function($scope,$rootScope,$q,PurchaseService,BBModel,AlertService,ValidatorService,ClientService){var initialise,updateBooking;return $scope.validator=ValidatorService,$rootScope.connection_started.then(function(){return initialise()}),initialise=function(){return $scope.items=$scope.bb.basket.timeItems()},updateBooking=function(){var deferred,params;return deferred=$q.defer(),params={purchase:$scope.bb.moving_purchase,bookings:$scope.bb.basket.items,notify:!0},PurchaseService.update(params).then(function(purchase){return $scope.bb.purchase=purchase,$scope.setLoaded($scope),$scope.bb.current_item.move_done=!0,$rootScope.$broadcast("booking:updated"),deferred.resolve()},function(err){return deferred.reject()}),deferred.promise},$scope.markItemAsChanged=function(item){return item.attendee_changed=!0},$scope.changeAttendees=function(){var client,client_promises,deferred,i,item,len,ref;if(!$scope.bb.current_item.ready||!$scope.bb.moving_purchase)return!1;for(deferred=$q.defer(),$scope.notLoaded($scope),client_promises=[],ref=$scope.items,i=0,len=ref.length;i<len;i++)item=ref[i],item.attendee_changed?(client=new BBModel.Client,client.first_name=item.first_name,client.last_name=item.last_name,client_promises.push(ClientService.create_or_update($scope.bb.company,client))):client_promises.push($q.when([]));return $q.all(client_promises).then(function(result){var index,j,len1,ref1;for(ref1=$scope.items,index=j=0,len1=ref1.length;j<len1;index=++j)item=ref1[index],result[index]&&result[index].id&&(item.client_id=result[index].id);return updateBooking().then(function(){return $scope.$parent.$has_page_control?deferred.resolve():($scope.decideNextPage("purchase"),AlertService.raise("ATTENDEES_CHANGED"),deferred.resolve())},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}),deferred.promise},$scope.setReady=function(){return $scope.changeAttendees()}}]}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbWidget",["PathSvc","$http","$log","$templateCache","$compile","$q","AppConfig","$timeout","$bbug","$rootScope",function(PathSvc,$http,$log,$templateCache,$compile,$q,AppConfig,$timeout,$bbug,$rootScope){var appendCustomPartials,getTemplate,renderTemplate,setupPusher,updatePartials;return getTemplate=function(template){var fromTemplateCache,partial,src;return partial=template?template:"main",fromTemplateCache=$templateCache.get(partial),fromTemplateCache?fromTemplateCache:(src=PathSvc.directivePartial(partial).$$unwrapTrustedValue(),$http.get(src,{cache:$templateCache}).then(function(response){return response.data}))},updatePartials=function(scope,element,prms){var i,j,len,ref;for(ref=element.children(),j=0,len=ref.length;j<len;j++)i=ref[j],$bbug(i).hasClass("custom_partial")&&$bbug(i).remove();return appendCustomPartials(scope,element,prms).then(function(){return scope.$broadcast("refreshPage")})},setupPusher=function(scope,element,prms){return $timeout(function(){return scope.pusher=new Pusher("c8d8cea659cc46060608"),scope.pusher_channel=scope.pusher.subscribe("widget_"+prms.design_id),scope.pusher_channel.bind("update",function(data){return updatePartials(scope,element,prms)})})},appendCustomPartials=function(scope,element,prms){var defer;return defer=$q.defer(),$http.get(prms.custom_partial_url).then(function(custom_templates){return $compile(custom_templates.data)(scope,function(custom,scope){var non_style,style,tag;return custom.addClass("custom_partial"),style=function(){var j,len,results;for(results=[],j=0,len=custom.length;j<len;j++)tag=custom[j],"STYLE"===tag.tagName&&results.push(tag);return results}(),non_style=function(){var j,len,results;for(results=[],j=0,len=custom.length;j<len;j++)tag=custom[j],"STYLE"!==tag.tagName&&results.push(tag);return results}(),$bbug("#widget_"+prms.design_id).html(non_style),element.append(style),scope.bb.path_setup=!0,defer.resolve(style)})}),defer.promise},renderTemplate=function(scope,element,design_mode,template){return $q.when(getTemplate(template)).then(function(template){return element.html(template).show(),design_mode&&element.append("<style widget_css scoped></style>"),$compile(element.contents())(scope)})},{restrict:"A",scope:{client:"=?",apiUrl:"@?",useParent:"="},transclude:!0,controller:"BBCtrl",link:function(scope,element,attrs,controller,transclude){var evaluator,init_params;return null!=attrs.member&&(scope.client=attrs.member),evaluator=scope,scope.useParent&&null!=scope.$parent&&(evaluator=scope.$parent),init_params=evaluator.$eval(attrs.bbWidget),scope.initWidget(init_params),$rootScope.widget_started.then(function(_this){return function(){var prms;return prms=scope.bb,prms.custom_partial_url&&(prms.design_id=prms.custom_partial_url.match(/^.*\/(.*?)$/)[1],$bbug("[ng-app='BB']").append("<div id='widget_"+prms.design_id+"'></div>")),scope.bb.partial_url&&(init_params.partial_url?AppConfig.partial_url=init_params.partial_url:AppConfig.partial_url=scope.bb.partial_url),
transclude(scope,function(clone){return scope.has_content=clone.length>1||1===clone.length&&(!clone[0].wholeText||/\S/.test(clone[0].wholeText)),scope.has_content?prms.custom_partial_url?(appendCustomPartials(scope,element,prms),prms.update_design&&setupPusher(scope,element,prms),scope.$on("refreshPage",function(){return scope.showPage(scope.bb.current_page)})):(element.html(clone).show(),prms.design_mode?element.append("<style widget_css scoped></style>"):void 0):(prms.custom_partial_url?appendCustomPartials(scope,element,prms).then(function(style){return $q.when(getTemplate()).then(function(template){if(element.html(template).show(),$compile(element.contents())(scope),element.append(style),prms.update_design)return setupPusher(scope,element,prms)})}):prms.template?renderTemplate(scope,element,prms.design_mode,prms.template):renderTemplate(scope,element,prms.design_mode),scope.$on("refreshPage",function(){return renderTemplate(scope,element,prms.design_mode)}))})}}(this))}}}]),angular.module("BB.Controllers").controller("bbContentController",["$scope",function($scope){return $scope.controller="public.controllers.bbContentController",$scope.initPage=function(_this){return function(){return $scope.setPageLoaded(),$scope.setLoadingPage(!1)}}(this)}]),angular.module("BB.Controllers").controller("BBCtrl",["$scope","$location","$rootScope","halClient","$window","$http","$localCache","$q","$timeout","BasketService","LoginService","AlertService","$sce","$element","$compile","$sniffer","$modal","$log","BBModel","BBWidget","SSOService","ErrorService","AppConfig","QueryStringService","QuestionService","LocaleService","PurchaseService","$sessionStorage","$bbug","SettingsService","UriTemplate","$anchorScroll","$localStorage",function($scope,$location,$rootScope,halClient,$window,$http,$localCache,$q,$timeout,BasketService,LoginService,AlertService,$sce,$element,$compile,$sniffer,$modal,$log,BBModel,BBWidget,SSOService,ErrorService,AppConfig,QueryStringService,QuestionService,LocaleService,PurchaseService,$sessionStorage,$bbug,SettingsService,UriTemplate,$anchorScroll,$localStorage){var base,base1,con_started,first_call,restoreBasket,setupDefaults,widget_started;return $scope.cid="BBCtrl",$scope.controller="public.controllers.BBCtrl",$scope.bb=new BBWidget,AppConfig.uid=$scope.bb.uid,$scope.qs=QueryStringService,$scope.company_api_path="/api/v1/company/{company_id}{?embed,category_id}",$scope.company_admin_api_path="/api/v1/admin/{company_id}/company{?embed,category_id}",$scope.apiUrl&&($scope.bb||($scope.bb={}),$scope.bb.api_url=$scope.apiUrl),$rootScope.bb&&$rootScope.bb.api_url&&($scope.bb.api_url=$rootScope.bb.api_url,$rootScope.bb.partial_url?$scope.bb.partial_url=$rootScope.bb.partial_url:$scope.bb.partial_url=""),80!==$location.port()&&443!==$location.port()?(base=$scope.bb).api_url||(base.api_url=$location.protocol()+"://"+$location.host()+":"+$location.port()):(base1=$scope.bb).api_url||(base1.api_url=$location.protocol()+"://"+$location.host()),$scope.bb.stacked_items=[],first_call=!0,con_started=$q.defer(),$rootScope.connection_started=con_started.promise,widget_started=$q.defer(),$rootScope.widget_started=widget_started.promise,moment.locale([LocaleService,"en"]),$rootScope.Route={Company:0,Category:1,Service:2,Person:3,Resource:4,Duration:5,Date:6,Time:7,Client:8,Summary:9,Basket:10,Checkout:11,Slot:12,Event:13,Login:14,Questions:15},$scope.Route=$rootScope.Route,$compile("<span bb-display-mode></span>")($scope,function(_this){return function(cloned,scope){return $bbug($element).append(cloned)}}(this)),$scope.set_company=function(_this){return function(prms){return $scope.initWidget(prms)}}(this),$scope.initWidget=function(_this){return function(prms){var url;if(null==prms&&(prms={}),_this.$init_prms=prms,con_started=$q.defer(),$rootScope.connection_started=con_started.promise,($sniffer.webkit&&$sniffer.webkit<537||$sniffer.msie&&$sniffer.msie<=9)&&first_call){if($scope.bb.api_url&&(url=document.createElement("a"),url.href=$scope.bb.api_url,""===url.host||url.host===$location.host()||url.host===$location.host()+":"+$location.port()))return void $scope.initWidget2();$rootScope.iframe_proxy_ready?$scope.initWidget2():$scope.$on("iframe_proxy_ready",function(event,args){if(args.iframe_proxy_ready)return $scope.initWidget2()})}else $scope.initWidget2()}}(this),$scope.initWidget2=function(_this){return function(){var aff_promise,comp_category_id,comp_def,comp_promise,comp_url,company_id,embed_params,get_total,k,match,options,params,prms,ref,setup_promises,setup_promises2,sso_admin_login,sso_member_login,total_id,v;if($scope.init_widget_started=!0,prms=_this.$init_prms,prms.query){ref=prms.query;for(k in ref)v=ref[k],prms[k]=QueryStringService(v)}return prms.custom_partial_url?($scope.bb.custom_partial_url=prms.custom_partial_url,$scope.bb.partial_id=prms.custom_partial_url.substring(prms.custom_partial_url.lastIndexOf("/")+1),prms.update_design&&($scope.bb.update_design=prms.update_design)):prms.design_mode&&($scope.bb.design_mode=prms.design_mode),company_id=$scope.bb.company_id,prms.company_id&&(company_id=prms.company_id),prms.affiliate_id&&($scope.bb.affiliate_id=prms.affiliate_id,$rootScope.affiliate_id=prms.affiliate_id),prms.api_url&&($scope.bb.api_url=prms.api_url),prms.partial_url&&($scope.bb.partial_url=prms.partial_url),prms.page_suffix&&($scope.bb.page_suffix=prms.page_suffix),prms.admin&&($scope.bb.isAdmin=prms.admin),prms.auth_token&&$sessionStorage.setItem("auth_token",prms.auth_token),$scope.bb.app_id=1,$scope.bb.app_key=1,$scope.bb.clear_basket=!0,prms.basket&&($scope.bb.clear_basket=!1),prms.clear_basket===!1&&($scope.bb.clear_basket=!1),($window.bb_setup||prms.client)&&(prms.clear_member||(prms.clear_member=!0)),$scope.bb.client_defaults=prms.client||{},prms.client_defaults&&prms.client_defaults.membership_ref&&($scope.bb.client_defaults.membership_ref=prms.client_defaults.membership_ref),$scope.bb.client_defaults&&$scope.bb.client_defaults.name&&(match=$scope.bb.client_defaults.name.match(/^(\S+)(?:\s(\S+))?/),match&&($scope.bb.client_defaults.first_name=match[1],null!=match[2]&&($scope.bb.client_defaults.last_name=match[2]))),prms.clear_member&&($scope.bb.clear_member=prms.clear_member,$sessionStorage.removeItem("login")),prms.app_id&&($scope.bb.app_id=prms.app_id),prms.app_key&&($scope.bb.app_key=prms.app_key),prms.item_defaults?($scope.bb.original_item_defaults=prms.item_defaults,$scope.bb.item_defaults=angular.copy($scope.bb.original_item_defaults)):$scope.bb.original_item_defaults&&($scope.bb.item_defaults=angular.copy($scope.bb.original_item_defaults)),$scope.bb.selected_service&&$scope.bb.selected_service.company_id===company_id&&($scope.bb.item_defaults.service=$scope.bb.selected_service.id),prms.route_format&&($scope.bb.setRouteFormat(prms.route_format),$scope.bb_route_init&&$scope.bb_route_init()),prms.locale&&moment.locale(prms.locale),prms.use_local_time_zone&&SettingsService.setUseLocalTimeZone(prms.use_local_time_zone),prms.hide===!0?$scope.hide_page=!0:$scope.hide_page=!1,prms.from_datetime&&($scope.bb.from_datetime=prms.from_datetime),prms.to_datetime&&($scope.bb.to_datetime=prms.to_datetime),prms.min_date&&($scope.bb.min_date=prms.min_date),prms.max_date&&($scope.bb.max_date=prms.max_date),prms.hide_block&&($scope.bb.hide_block=prms.hide_block),prms.custom_partial_url||($scope.bb.path_setup=!0),prms.extra_setup&&($scope.bb.extra_setup=prms.extra_setup,prms.extra_setup.step&&($scope.bb.starting_step_number=parseInt(prms.extra_setup.step)),prms.extra_setup.return_url&&($scope.bb.return_url=prms.extra_setup.return_url),prms.extra_setup.destination&&($scope.bb.destination=prms.extra_setup.destination)),prms.booking_settings&&($scope.bb.booking_settings=prms.booking_settings),prms.template&&($scope.bb.template=prms.template),prms.i18n&&SettingsService.enableInternationalizaton(),prms.login_required&&($scope.bb.login_required=!0),prms.private_note&&($scope.bb.private_note=prms.private_note),prms.qudini_booking_id&&($scope.bb.qudini_booking_id=prms.qudini_booking_id),prms.scroll_offset&&SettingsService.setScrollOffset(prms.scroll_offset),SettingsService.update_document_title=SettingsService.update_document_title||prms.update_document_title||!1,_this.waiting_for_conn_started_def=$q.defer(),$scope.waiting_for_conn_started=_this.waiting_for_conn_started_def.promise,company_id||$scope.bb.affiliate_id?$scope.waiting_for_conn_started=$rootScope.connection_started:_this.waiting_for_conn_started_def.resolve(),widget_started.resolve(),setup_promises2=[],setup_promises=[],$scope.bb.affiliate_id&&(aff_promise=halClient.$get($scope.bb.api_url+"/api/v1/affiliates/"+$scope.bb.affiliate_id),setup_promises.push(aff_promise),aff_promise.then(function(affiliate){var comp_p,comp_promise;if($scope.bb.$wait_for_routing&&setup_promises2.push($scope.bb.$wait_for_routing.promise),$scope.setAffiliate(new BBModel.Affiliate(affiliate)),$scope.bb.item_defaults.affiliate=$scope.affiliate,prms.company_ref)return comp_p=$q.defer(),comp_promise=$scope.affiliate.getCompanyByRef(prms.company_ref),setup_promises2.push(comp_p.promise),comp_promise.then(function(company){return $scope.setCompany(company,prms.keep_basket).then(function(val){return comp_p.resolve(val)},function(err){return comp_p.reject(err)})},function(err){return comp_p.reject(err)})})),company_id&&(prms.embed&&(embed_params=prms.embed),embed_params||(embed_params=null),comp_category_id=null,null!=$scope.bb.item_defaults.category&&(comp_category_id=null!=$scope.bb.item_defaults.category.id?$scope.bb.item_defaults.category.id:$scope.bb.item_defaults.category),comp_def=$q.defer(),comp_promise=comp_def.promise,options={},$sessionStorage.getItem("auth_token")&&(options.auth_token=$sessionStorage.getItem("auth_token")),$scope.bb.isAdmin?(comp_url=new UriTemplate($scope.bb.api_url+$scope.company_admin_api_path).fillFromObject({company_id:company_id,category_id:comp_category_id,embed:embed_params}),halClient.$get(comp_url,options).then(function(company){return comp_def.resolve(company)},function(err){return comp_url=new UriTemplate($scope.bb.api_url+$scope.company_api_path).fillFromObject({company_id:company_id,category_id:comp_category_id,embed:embed_params}),halClient.$get(comp_url,options).then(function(company){return comp_def.resolve(company)},function(err){return comp_def.reject(err)})})):(comp_url=new UriTemplate($scope.bb.api_url+$scope.company_api_path).fillFromObject({company_id:company_id,category_id:comp_category_id,embed:embed_params}),halClient.$get(comp_url,options).then(function(company){return company?comp_def.resolve(company):comp_def.reject("Invalid company ID "+company_id)},function(err){return comp_def.reject(err)})),setup_promises.push(comp_promise),comp_promise.then(function(company){var child,comp,cprom,parent_company;return $scope.bb.$wait_for_routing&&setup_promises2.push($scope.bb.$wait_for_routing.promise),comp=new BBModel.Company(company),cprom=$q.defer(),setup_promises2.push(cprom.promise),child=null,comp.companies&&$scope.bb.item_defaults.company&&(child=comp.findChildCompany($scope.bb.item_defaults.company)),child?(parent_company=comp,halClient.$get($scope.bb.api_url+"/api/v1/company/"+child.id).then(function(company){return comp=new BBModel.Company(company),setupDefaults(comp.id),$scope.bb.parent_company=parent_company,$scope.setCompany(comp,prms.keep_basket).then(function(){return cprom.resolve()},function(err){return cprom.reject()})},function(err){return cprom.reject()})):(setupDefaults(comp.id),$scope.setCompany(comp,prms.keep_basket).then(function(){return cprom.resolve()},function(err){return cprom.reject()}))}),prms.member_sso&&(params={company_id:company_id,root:$scope.bb.api_url,member_sso:prms.member_sso},sso_member_login=SSOService.memberLogin(params).then(function(client){return $scope.setClient(client)}),setup_promises.push(sso_member_login)),prms.admin_sso&&(params={company_id:prms.parent_company_id?prms.parent_company_id:company_id,root:$scope.bb.api_url,admin_sso:prms.admin_sso},sso_admin_login=SSOService.adminLogin(params).then(function(admin){return $scope.bb.admin=admin}),setup_promises.push(sso_admin_login)),total_id=$scope.bb.item_defaults&&$scope.bb.item_defaults.long_id?$scope.bb.item_defaults.long_id:QueryStringService("total_id"),total_id&&(params={purchase_id:total_id,url_root:$scope.bb.api_url},get_total=PurchaseService.query(params).then(function(total){if($scope.bb.total=total,total.paid>0)return $scope.bb.payment_status="complete"}),setup_promises.push(get_total))),$scope.isLoaded=!1,$q.all(setup_promises).then(function(){return $q.all(setup_promises2).then(function(){var base2,clear_prom,def_clear;return $scope.bb.basket||(base2=$scope.bb).basket||(base2.basket=new BBModel.Basket(null,$scope.bb)),$scope.client||$scope.clearClient(),def_clear=$q.defer(),clear_prom=def_clear.promise,$scope.bb.current_item?def_clear.resolve():clear_prom=$scope.clearBasketItem(),clear_prom.then(function(){var page;if($scope.client_details||($scope.client_details=new BBModel.ClientDetails),$scope.bb.stacked_items||($scope.bb.stacked_items=[]),($scope.bb.company||$scope.bb.affiliate)&&(con_started.resolve(),$scope.done_starting=!0,!prms.no_route))return page=null,first_call&&$bbug.isEmptyObject($scope.bb.routeSteps)&&(page=$scope.bb.firstStep),prms.first_page&&(page=prms.first_page),first_call=!1,$scope.decideNextPage(page)})},function(err){return con_started.reject("Failed to start widget"),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return con_started.reject("Failed to start widget"),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),setupDefaults=function(_this){return function(company_id){var category,clinic,def,event,event_chain,event_group,k,person,ref,resource,service,v;if(def=$q.defer(),first_call||$scope.bb.orginal_company_id&&$scope.bb.orginal_company_id!==company_id){if($scope.bb.orginal_company_id=company_id,$scope.bb.default_setup_promises=[],$scope.bb.item_defaults.query){ref=$scope.bb.item_defaults.query;for(k in ref)v=ref[k],$scope.bb.item_defaults[k]=QueryStringService(v)}$scope.bb.item_defaults.resource&&(resource=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/resources/"+$scope.bb.item_defaults.resource):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/resources/"+$scope.bb.item_defaults.resource),$scope.bb.default_setup_promises.push(resource),resource.then(function(res){return $scope.bb.item_defaults.resource=new BBModel.Resource(res)})),$scope.bb.item_defaults.person&&(person=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/people/"+$scope.bb.item_defaults.person):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/people/"+$scope.bb.item_defaults.person),$scope.bb.default_setup_promises.push(person),person.then(function(res){return $scope.bb.item_defaults.person=new BBModel.Person(res)})),$scope.bb.item_defaults.person_ref&&(person=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/people/find_by_ref/"+$scope.bb.item_defaults.person_ref):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/people/find_by_ref/"+$scope.bb.item_defaults.person_ref),$scope.bb.default_setup_promises.push(person),person.then(function(res){return $scope.bb.item_defaults.person=new BBModel.Person(res)})),$scope.bb.item_defaults.service&&(service=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/services/"+$scope.bb.item_defaults.service):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/services/"+$scope.bb.item_defaults.service),$scope.bb.default_setup_promises.push(service),service.then(function(res){return $scope.bb.item_defaults.service=new BBModel.Service(res)})),$scope.bb.item_defaults.service_ref&&(service=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/services?api_ref="+$scope.bb.item_defaults.service_ref):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/services?api_ref="+$scope.bb.item_defaults.service_ref),$scope.bb.default_setup_promises.push(service),service.then(function(res){return $scope.bb.item_defaults.service=new BBModel.Service(res)})),$scope.bb.item_defaults.event_group&&(event_group=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/event_groups/"+$scope.bb.item_defaults.event_group):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/event_groups/"+$scope.bb.item_defaults.event_group),$scope.bb.default_setup_promises.push(event_group),event_group.then(function(res){return $scope.bb.item_defaults.event_group=new BBModel.EventGroup(res)})),$scope.bb.item_defaults.event&&(event=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/event_chains/"+$scope.bb.item_defaults.event_chain+"/events/"+$scope.bb.item_defaults.event):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/events/"+$scope.bb.item_defaults.event),$scope.bb.default_setup_promises.push(event),event.then(function(res){return $scope.bb.item_defaults.event=new BBModel.Event(res)})),$scope.bb.item_defaults.event_chain&&(event_chain=$scope.bb.isAdmin?halClient.$get($scope.bb.api_url+"/api/v1/admin/"+company_id+"/event_chains/"+$scope.bb.item_defaults.event_chain):halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/event_chains/"+$scope.bb.item_defaults.event_chain),$scope.bb.default_setup_promises.push(event_chain),event_chain.then(function(res){return $scope.bb.item_defaults.event_chain=new BBModel.EventChain(res)})),$scope.bb.item_defaults.category&&(category=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/categories/"+$scope.bb.item_defaults.category),$scope.bb.default_setup_promises.push(category),category.then(function(res){return $scope.bb.item_defaults.category=new BBModel.Category(res)})),$scope.bb.item_defaults.clinic&&(clinic=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/clinics/"+$scope.bb.item_defaults.clinic),$scope.bb.default_setup_promises.push(clinic),clinic.then(function(res){return $scope.bb.item_defaults.clinic=new BBModel.Clinic(res)})),$scope.bb.item_defaults.duration&&($scope.bb.item_defaults.duration=parseInt($scope.bb.item_defaults.duration)),$q.all($scope.bb.default_setup_promises)["finally"](function(){return def.resolve()})}else def.resolve();return def.promise}}(this),$scope.setLoadingPage=function(_this){return function(val){return $scope.loading_page=val}}(this),$scope.isLoadingPage=function(_this){return function(){return $scope.loading_page}}(this),$scope.$on("$locationChangeStart",function(angular_event,new_url,old_url){var step_number;if($scope.bb.routeFormat)return $scope.bb.routing&&!SettingsService.isModalOpen()||(step_number=$scope.bb.matchURLToStep(),null!=step_number&&step_number>$scope.bb.current_step?$scope.loadStep(step_number):$scope.loadPreviousStep("locationChangeStart")),$scope.bb.routing=!1}),$scope.showPage=function(_this){return function(route,dont_record_page){if($scope.bb.updateRoute(route),$scope.jumped=!1,!$scope.isLoadingPage())return $scope.setLoadingPage(!0),$scope.bb.current_page===route?($scope.bb_main="",setTimeout(function(){return $scope.bb_main=$sce.trustAsResourceUrl($scope.bb.pageURL(route)),$scope.$apply()},0)):(AlertService.clear(),$scope.bb.current_page=route,dont_record_page||$scope.bb.recordCurrentPage(),$scope.notLoaded($scope),$scope.bb_main=$sce.trustAsResourceUrl($scope.bb.pageURL(route))),$rootScope.$broadcast("page:loaded")}}(this),$scope.jumpToPage=function(_this){return function(route){return $scope.current_page=route,$scope.jumped=!0,$scope.bb_main=$sce.trustAsResourceUrl($scope.partial_url+route+$scope.page_suffix)}}(this),$scope.clearPage=function(){return $scope.bb_main=""},$scope.getPartial=function(file){return $scope.bb.pageURL(file)},$scope.setPageLoaded=function(){return $scope.setLoaded($scope)},$scope.setPageRoute=function(_this){return function(route){return $scope.bb.current_page_route=route,!(!$scope.bb.routeSteps||!$scope.bb.routeSteps[route])&&($scope.showPage($scope.bb.routeSteps[route]),!0)}}(this),$scope.decideNextPage=function(route){if(route){if("none"===route)return;if(!$scope.bb.total||"complete"!==$scope.bb.payment_status)return $scope.showPage(route);$scope.showPage("confirmation")}if($scope.bb.nextSteps&&$scope.bb.current_page&&$scope.bb.nextSteps[$scope.bb.current_page]&&!$scope.bb.routeSteps)return $scope.showPage($scope.bb.nextSteps[$scope.bb.current_page]);if(!$scope.client.valid()&&LoginService.isLoggedIn()&&($scope.client=new BBModel.Client(LoginService.member()._data)),$scope.bb.company&&$scope.bb.company.companies||!$scope.bb.company&&$scope.affiliate){if($scope.setPageRoute($rootScope.Route.Company))return;return $scope.showPage("company_list")}if($scope.bb.total&&"complete"===$scope.bb.payment_status)return $scope.showPage("confirmation");if($scope.bb.total&&"pending"===$scope.bb.payment_status)return $scope.showPage("payment");if($scope.bb.company.$has("event_groups")&&!$scope.bb.current_item.event_group&&!$scope.bb.current_item.service&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal||$scope.bb.company.$has("events")&&$scope.bb.current_item.event_group&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Event))return;return $scope.showPage("event_list")}if(!(!$scope.bb.company.$has("events")||!$scope.bb.current_item.event||$scope.bb.current_item.num_book||$scope.bb.current_item.tickets&&$scope.bb.current_item.tickets.qty||$scope.bb.current_item.product||$scope.bb.current_item.deal))return $scope.showPage("event");if($scope.bb.company.$has("services")&&!$scope.bb.current_item.service&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Service))return;return $scope.showPage("service_list")}if($scope.bb.company.$has("resources")&&!$scope.bb.current_item.resource&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Resource))return;return $scope.showPage("resource_list")}if($scope.bb.company.$has("people")&&!$scope.bb.current_item.person&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product&&!$scope.bb.current_item.deal){if($scope.setPageRoute($rootScope.Route.Person))return;return $scope.showPage("person_list")}if(!($scope.bb.current_item.duration||null!=$scope.bb.current_item.event||$scope.bb.current_item.product||$scope.bb.current_item.deal)){if($scope.setPageRoute($rootScope.Route.Duration))return;return $scope.showPage("duration_list")}if($scope.bb.current_item.days_link&&!$scope.bb.current_item.date&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.deal){if($scope.bb.company.$has("availability_slots")){if($scope.setPageRoute($rootScope.Route.Slot))return;return $scope.showPage("slot_list")}if($scope.setPageRoute($rootScope.Route.Date))return;return $scope.showPage("calendar")}if(!(!$scope.bb.current_item.days_link||$scope.bb.current_item.time||null!=$scope.bb.current_item.event||$scope.bb.current_item.service&&"day"===$scope.bb.current_item.service.duration_unit||$scope.bb.current_item.deal)){if($scope.setPageRoute($rootScope.Route.Time))return;return $scope.showPage("time")}if(!(!$scope.bb.moving_booking||$scope.bb.current_item.ready&&$scope.bb.current_item.move_done))return $scope.showPage("check_move");if(!$scope.client.valid()){if($scope.setPageRoute($rootScope.Route.Client))return;return $scope.showPage("client")}if($scope.bb.current_item.item_details&&$scope.bb.current_item.item_details.hasQuestions&&!$scope.bb.current_item.asked_questions){if($scope.setPageRoute($rootScope.Route.Questions))return;return $scope.showPage("check_items")}if($scope.bb.moving_booking&&$scope.bb.basket.itemsReady())return $scope.showPage("purchase");if(!$scope.bb.basket.readyToCheckout()){if($scope.setPageRoute($rootScope.Route.Summary))return;return $scope.showPage("basket_summary")}if($scope.bb.usingBasket&&(!$scope.bb.confirmCheckout||$scope.bb.company_settings.has_vouchers||$scope.bb.company.$has("coupon"))){if($scope.setPageRoute($rootScope.Route.Basket))return;return $scope.showPage("basket")}if($scope.bb.basket.readyToCheckout()&&null===$scope.bb.payment_status&&!$scope.bb.basket.waiting_for_checkout){if($scope.setPageRoute($rootScope.Route.Checkout))return;return $scope.showPage("checkout")}return"complete"===$scope.bb.payment_status?$scope.showPage("confirmation"):void 0},$scope.showCheckout=function(){return $scope.bb.current_item.ready},$scope.addItemToBasket=function(){var add_defer;if(add_defer=$q.defer(),$scope.bb.current_item.submitted||$scope.bb.moving_booking){if($scope.bb.current_item.submitted)return $scope.bb.current_item.submitted;add_defer.resolve()}else $scope.moveToBasket(),$scope.bb.current_item.submitted=$scope.updateBasket(),$scope.bb.current_item.submitted.then(function(basket){return add_defer.resolve(basket)},function(err){return 409===err.status&&($scope.bb.current_item.person=null,$scope.bb.current_item.resource=null,$scope.bb.current_item.setTime(null),$scope.bb.current_item.service&&$scope.bb.current_item.setService($scope.bb.current_item.service)),$scope.bb.current_item.submitted=null,add_defer.reject(err)});return add_defer.promise},$scope.updateBasket=function(){var add_defer,current_item_ref,params;return current_item_ref=$scope.bb.current_item.ref,add_defer=$q.defer(),params={member_id:$scope.client.id,member:$scope.client,items:$scope.bb.basket.items,bb:$scope.bb},BasketService.updateBasket($scope.bb.company,params).then(function(basket){var current_item,item,j,len,ref;for(ref=basket.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.storeDefaults($scope.bb.item_defaults);return halClient.clearCache("time_data"),halClient.clearCache("events"),basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),current_item=_.find(basket.items,function(item){return item.ref===current_item_ref}),current_item||(current_item=_.last(basket.items)),$scope.setBasketItem(current_item),$scope.bb.current_item?add_defer.resolve(basket):$scope.clearBasketItem().then(function(){return add_defer.resolve(basket)})},function(err){var error_modal;if(add_defer.reject(err),409===err.status)return halClient.clearCache("time_data"),halClient.clearCache("events"),$scope.bb.current_item.person=null,error_modal=$modal.open({templateUrl:$scope.getPartial("_error_modal"),controller:["$scope","$modalInstance",function($scope,$modalInstance){return $scope.message=ErrorService.getError("ITEM_NO_LONGER_AVAILABLE").msg,$scope.ok=function(){return $modalInstance.close()}}]}),error_modal.result["finally"](function(){if(!$scope.bb.nextSteps)return $scope.decideNextPage();if($scope.setPageRoute($rootScope.Route.Date));else if(!$scope.setPageRoute($rootScope.Route.Event))return $scope.loadPreviousStep()})}),add_defer.promise},$scope.emptyBasket=function(){var defer;if($scope.bb.basket.items&&(!$scope.bb.basket.items||0!==$scope.bb.basket.items.length))return defer=$q.defer(),BasketService.empty($scope.bb).then(function(basket){return $scope.bb.current_item.id&&delete $scope.bb.current_item.id,$scope.setBasket(basket),defer.resolve()},function(err){return defer.reject()}),defer.promise},$scope.deleteBasketItem=function(item){return BasketService.deleteItem(item,$scope.bb.company,{bb:$scope.bb}).then(function(basket){return $scope.setBasket(basket)})},$scope.deleteBasketItems=function(items){var item,j,len,results;for(results=[],j=0,len=items.length;j<len;j++)item=items[j],results.push(BasketService.deleteItem(item,$scope.bb.company,{bb:$scope.bb}).then(function(basket){return $scope.setBasket(basket)}));return results},$scope.clearBasketItem=function(){var def;return def=$q.defer(),$scope.setBasketItem(new BBModel.BasketItem(null,$scope.bb)),$scope.bb.default_setup_promises?$q.all($scope.bb.default_setup_promises)["finally"](function(){return $scope.bb.current_item.setDefaults($scope.bb.item_defaults),$q.all($scope.bb.current_item.promises)["finally"](function(){return def.resolve()})}):($scope.bb.current_item.setDefaults({}),def.resolve()),def.promise},$scope.setBasketItem=function(item){return $scope.bb.current_item=item,$scope.current_item=$scope.bb.current_item},$scope.setReadyToCheckout=function(ready){return $scope.bb.confirmCheckout=ready},$scope.moveToBasket=function(){return $scope.bb.basket.addItem($scope.bb.current_item)},$scope.quickEmptybasket=function(options){var def,preserve_stacked_items;return preserve_stacked_items=!(!options||!options.preserve_stacked_items),preserve_stacked_items?($scope.bb.basket=new BBModel.Basket(null,$scope.bb),$scope.basket=$scope.bb.basket,$scope.bb.basket.company_id=$scope.bb.company_id,def=$q.defer(),def.resolve(),def.promise):($scope.bb.stacked_items=[],$scope.setBasket(new BBModel.Basket(null,$scope.bb)),$scope.clearBasketItem())},$scope.setBasket=function(basket){if($scope.bb.basket=basket,$scope.basket=basket,$scope.bb.basket.company_id=$scope.bb.company_id,$scope.bb.stacked_items)return $scope.bb.setStackedItems(basket.timeItems())},$scope.logout=function(route){return $scope.client&&$scope.client.valid()?LoginService.logout({root:$scope.bb.api_url}).then(function(){return $scope.client=new BBModel.Client,$scope.decideNextPage(route)}):$scope.member?LoginService.logout({root:$scope.bb.api_url}).then(function(){return $scope.member=new BBModel.Member.Member,$scope.decideNextPage(route)}):void 0},$scope.setAffiliate=function(affiliate){return $scope.bb.affiliate_id=affiliate.id,$scope.bb.affiliate=affiliate,$scope.affiliate=affiliate,$scope.affiliate_id=affiliate.id},restoreBasket=function(){var restore_basket_defer;return restore_basket_defer=$q.defer(),$scope.quickEmptybasket().then(function(){var auth_token,href,params,status,uri;return auth_token=$localStorage.getItem("auth_token")||$sessionStorage.getItem("auth_token"),href=$scope.bb.api_url+"/api/v1/status{?company_id,affiliate_id,clear_baskets,clear_member}",params={company_id:$scope.bb.company_id,affiliate_id:$scope.bb.affiliate_id,clear_baskets:$scope.bb.clear_basket?"1":null,clear_member:$scope.bb.clear_member?"1":null},uri=new UriTemplate(href).fillFromObject(params),status=halClient.$get(uri,{auth_token:auth_token,no_cache:!0}),status.then(function(_this){return function(res){return res.$has("client")&&res.$get("client").then(function(client){if(!$scope.client||$scope.client&&!$scope.client.valid())return $scope.client=new BBModel.Client(client)}),res.$has("member")&&res.$get("member").then(function(member){if("Contact"!==member.client_type)return member=LoginService.setLogin(member),$scope.setClient(member)}),$scope.bb.clear_basket?restore_basket_defer.resolve():res.$has("baskets")?res.$get("baskets").then(function(baskets){var basket;return basket=_.find(baskets,function(b){return parseInt(b.company_id)===$scope.bb.company_id}),basket?(basket=new BBModel.Basket(basket,$scope.bb),basket.$get("items").then(function(items){var i,j,len,promises;for(items=function(){var j,len,results;for(results=[],j=0,len=items.length;j<len;j++)i=items[j],results.push(new BBModel.BasketItem(i));return results}(),j=0,len=items.length;j<len;j++)i=items[j],basket.addItem(i);return $scope.setBasket(basket),promises=[].concat.apply([],function(){var l,len1,results;for(results=[],l=0,len1=items.length;l<len1;l++)i=items[l],results.push(i.promises);return results}()),$q.all(promises).then(function(){return basket.items.length>0&&$scope.setBasketItem(basket.items[0]),restore_basket_defer.resolve()})})):restore_basket_defer.resolve()}):restore_basket_defer.resolve()}}(this),function(err){return restore_basket_defer.resolve()})}),restore_basket_defer.promise},$scope.setCompany=function(company,keep_basket){var defer;return defer=$q.defer(),$scope.bb.company_id=company.id,$scope.bb.company=company,$scope.company=company,$scope.bb.item_defaults.company=$scope.bb.company,SettingsService.setCountryCode(company.country_code),
SettingsService.setCurrency(company.currency_code),SettingsService.setTimeZone(company.timezone),company.$has("settings")?company.getSettings().then(function(_this){return function(settings){return $scope.bb.company_settings=settings,$scope.bb.company_settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),$scope.bb.company_settings.merge_people&&($scope.bb.item_defaults.merge_people=!0),$rootScope.bb_currency=$scope.bb.company_settings.currency,$scope.bb.currency=$scope.bb.company_settings.currency,$scope.bb.has_prices=$scope.bb.company_settings.has_prices,!$scope.bb.basket||$scope.bb.basket.company_id!==$scope.bb.company_id&&!keep_basket?restoreBasket().then(function(){return defer.resolve(),$scope.$emit("company:setup")}):(defer.resolve(),$scope.$emit("company:setup"))}}(this)):!$scope.bb.basket||$scope.bb.basket.company_id!==$scope.bb.company_id&&!keep_basket?restoreBasket().then(function(){return defer.resolve(),$scope.$emit("company:setup")}):(defer.resolve(),$scope.$emit("company:setup")),defer.promise},$scope.recordStep=function(step,title){return $scope.bb.recordStep(step,title)},$scope.setStepTitle=function(title){return $scope.bb.steps[$scope.bb.current_step-1].title=title},$scope.getCurrentStepTitle=function(){var steps;if(steps=$scope.bb.steps,(!_.compact(steps).length||1===steps.length&&steps[0].number!==$scope.bb.current_step)&&(steps=$scope.bb.allSteps),$scope.bb.current_step)return steps[$scope.bb.current_step-1].title},$scope.checkStepTitle=function(title){if($scope.bb.steps[$scope.bb.current_step-1]&&!$scope.bb.steps[$scope.bb.current_step-1].title)return $scope.setStepTitle(title)},$scope.loadStep=function(step){var j,len,prev_step,ref,st;if(step!==$scope.bb.current_step&&($scope.bb.calculatePercentageComplete(step),st=$scope.bb.steps[step],prev_step=$scope.bb.steps[step-1],st&&!prev_step&&(prev_step=st),st||(st=prev_step),st&&!$scope.bb.last_step_reached&&(st.stacked_length&&0!==st.stacked_length||($scope.bb.stacked_items=[]),$scope.bb.current_item.loadStep(st.current_item),$scope.bb.steps.length>1&&$scope.bb.steps.splice(step,$scope.bb.steps.length-step),$scope.bb.current_step=step,$scope.showPage(prev_step.page,!0)),$scope.bb.allSteps)){for(ref=$scope.bb.allSteps,j=0,len=ref.length;j<len;j++)step=ref[j],step.active=!1,step.passed=step.number<$scope.bb.current_step;if($scope.bb.allSteps[$scope.bb.current_step-1])return $scope.bb.allSteps[$scope.bb.current_step-1].active=!0}},$scope.loadPreviousStep=function(caller){var last_step,pages_to_remove_from_history,past_steps,step_to_load;for(past_steps=_.reject($scope.bb.steps,function(s){return s.number>=$scope.bb.current_step}),step_to_load=0;past_steps[0]&&(last_step=past_steps.pop());)if(!last_step.skipped){step_to_load=last_step.number;break}if($scope.bb.routeFormat&&(pages_to_remove_from_history=0===step_to_load?$scope.bb.current_step+1:$scope.bb.current_step-step_to_load,"locationChangeStart"===caller&&pages_to_remove_from_history--,pages_to_remove_from_history>0&&window.history.go(pages_to_remove_from_history*-1)),step_to_load>0)return $scope.loadStep(step_to_load)},$scope.loadStepByPageName=function(page_name){var j,len,ref,step;for(ref=$scope.bb.allSteps,j=0,len=ref.length;j<len;j++)if(step=ref[j],step.page===page_name)return $scope.loadStep(step.number);return $scope.loadStep(1)},$scope.reset=function(){return $rootScope.$broadcast("clear:formData"),$rootScope.$broadcast("widget:restart"),$scope.setLastSelectedDate(null),LoginService.isLoggedIn()||($scope.client=new BBModel.Client),$scope.bb.last_step_reached=!1,$scope.bb.steps.splice(1)},$scope.restart=function(){return $scope.reset(),$scope.loadStep(1)},$scope.setRoute=function(rdata){return $scope.bb.setRoute(rdata)},$scope.setBasicRoute=function(routes){return $scope.bb.setBasicRoute(routes)},$scope.skipThisStep=function(){if($scope.bb.steps[$scope.bb.steps.length-1])return $scope.bb.steps[$scope.bb.steps.length-1].skipped=!0},$scope.setUsingBasket=function(_this){return function(usingBasket){return $scope.bb.usingBasket=usingBasket}}(this),$scope.setClient=function(_this){return function(client){if($scope.client=client,client.postcode&&!$scope.bb.postcode)return $scope.bb.postcode=client.postcode}}(this),$scope.clearClient=function(_this){return function(){if($scope.client=new BBModel.Client,$window.bb_setup&&$scope.client.setDefaults($window.bb_setup),$scope.bb.client_defaults)return $scope.client.setDefaults($scope.bb.client_defaults)}}(this),$scope.parseDate=function(_this){return function(d){return moment(d)}}(this),$scope.getUrlParam=function(_this){return function(param){return $window.getURIparam(param)}}(this),$scope.base64encode=function(_this){return function(param){return $window.btoa(param)}}(this),$scope.setLastSelectedDate=function(_this){return function(date){return $scope.last_selected_date=date}}(this),$scope.setLoaded=function(cscope){var loadingFinished;for(cscope.$emit("hide:loader",cscope),cscope.isLoaded=!0,loadingFinished=!0;cscope;)cscope.hasOwnProperty("scopeLoaded")&&($scope.areScopesLoaded(cscope)?cscope.scopeLoaded=!0:loadingFinished=!1),cscope=cscope.$parent;loadingFinished&&$rootScope.$broadcast("loading:finished")},$scope.setLoadedAndShowError=function(scope,err,error_string){return $log.warn(err,error_string),scope.setLoaded(scope),err&&409===err.status?AlertService.danger(ErrorService.getError("ITEM_NO_LONGER_AVAILABLE")):err&&err.data&&"Number of Bookings exceeds the maximum"===err.data.error?AlertService.danger(ErrorService.getError("MAXIMUM_TICKETS")):AlertService.danger(ErrorService.getError("GENERIC"))},$scope.areScopesLoaded=function(cscope){var child;if(cscope.hasOwnProperty("isLoaded")&&!cscope.isLoaded)return!1;for(child=cscope.$$childHead;child;){if(!$scope.areScopesLoaded(child))return!1;child=child.$$nextSibling}return!0},$scope.notLoaded=function(cscope){for($scope.$emit("show:loader",$scope),cscope.isLoaded=!1;cscope;)cscope.hasOwnProperty("scopeLoaded")&&(cscope.scopeLoaded=!1),cscope=cscope.$parent},$scope.broadcastItemUpdate=function(_this){return function(){return $scope.$broadcast("currentItemUpdate",$scope.bb.current_item)}}(this),$scope.hidePage=function(){return $scope.hide_page=!0},$scope.bb.company_set=function(){return null!=$scope.bb.company_id},$scope.isAdmin=function(){return $scope.bb.isAdmin},$scope.isAdminIFrame=function(){var err,error,location;if(!$scope.bb.isAdmin)return!1;try{return location=$window.parent.location.href,!(!location||!$window.parent.reload_dashboard)}catch(error){return err=error,!1}},$scope.reloadDashboard=function(){return $window.parent.reload_dashboard()},$scope.$debounce=function(tim){return!$scope._debouncing&&(tim||(tim=100),$scope._debouncing=!0,$timeout(function(){return $scope._debouncing=!1},tim))},$scope.supportsTouch=function(){return Modernizr.touch},$rootScope.$on("show:loader",function(){return $scope.loading=!0}),$rootScope.$on("hide:loader",function(){return $scope.loading=!1}),$scope.isMemberLoggedIn=function(){return LoginService.isLoggedIn()},$scope.scrollTo=function(id){return $location.hash(id),$anchorScroll()},$scope.redirectTo=function(url){return $window.location.href=url}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMiniBasket",function(){return{restrict:"AE",replace:!0,scope:!0,controller:["$scope","$rootScope","BasketService","$q",function($scope,$rootScope,BasketService,$q){return $scope.controller="public.controllers.MiniBasket",$scope.setUsingBasket(!0)}]}}),angular.module("BB.Directives").directive("bbBasketList",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"BasketList"}}),angular.module("BB.Controllers").controller("BasketList",["$scope","$element","$attrs","$rootScope","BasketService","$q","AlertService","FormDataStoreService","LoginService",function($scope,$element,$attrs,$rootScope,BasketService,$q,AlertService,FormDataStoreService,LoginService){var groupBasketItems;return $scope.controller="public.controllers.BasketList",$scope.setUsingBasket(!0),$scope.show_wallet=$scope.bb.company_settings.hasOwnProperty("has_wallets")&&$scope.bb.company_settings.has_wallets&&$scope.client.valid()&&LoginService.isLoggedIn()&&LoginService.member().id===$scope.client.id&&$scope.client.has_active_wallet,$scope.bb.basket.setSettings($scope.$eval($attrs.bbBasketList)||{}),$rootScope.connection_started.then(function(){var basket_item,i,len,params,promises,ref;if($scope.client&&$scope.bb.basket.setClient($scope.client),$scope.client.$has("pre_paid_bookings")&&$scope.bb.basket.timeItems().length>0){for($scope.notLoaded($scope),promises=[],ref=$scope.bb.basket.timeItems(),i=0,len=ref.length;i<len;i++)basket_item=ref[i],params={event_id:basket_item.getEventId()},promises.push($scope.client.getPrePaidBookingsPromise(params));return $q.all(promises).then(function(result){var booking_left,index,j,k,l,len1,len2,len3,len4,m,prepaid_booking,prepaid_bookings,ref1;for(booking_left={},j=0,len1=result.length;j<len1;j++)for(basket_item=result[j],k=0,len2=basket_item.length;k<len2;k++)prepaid_booking=basket_item[k],booking_left[prepaid_booking.id]=prepaid_booking.number_of_bookings_remaining;for(ref1=$scope.bb.basket.timeItems(),index=l=0,len3=ref1.length;l<len3;index=++l)if(basket_item=ref1[index],prepaid_bookings=result[index],$scope.bb.basket.settings&&$scope.bb.basket.settings.auto_use_prepaid_bookings&&prepaid_bookings.length>0&&basket_item.price>0)for(index=m=0,len4=prepaid_bookings.length;m<len4;index=++m)if(prepaid_booking=prepaid_bookings[index],booking_left[prepaid_booking.id]>0){basket_item.setPrepaidBooking(prepaid_booking),booking_left[prepaid_booking.id]-=1;break}return $scope.bb.basket.settings.auto_use_prepaid_bookings?$scope.updateBasket().then(function(){return groupBasketItems($scope.bb.basket.timeItems())},function(err){return $scope.setLoaded($scope)}):groupBasketItems($scope.bb.basket.timeItems())})}return groupBasketItems($scope.bb.basket.timeItems())}),$scope.deleteGroupItem=function(_this){return function(items){return $scope.deleteBasketItems(items),$scope.multi_basket_grouping=_.without($scope.multi_basket_grouping,items)}}(this),$scope.editGroupItem=function(_this){return function(items,route){return $scope.bb.current_item=items[0],$scope.decideNextPage(route)}}(this),$scope.groupPrice=function(items){var group_price,i,item,len;for(group_price=0,i=0,len=items.length;i<len;i++)item=items[i],group_price+=item.total_price;return group_price},$scope.groupTicketQty=function(items){var group_ticket_qty,i,item,len;for(group_ticket_qty=0,i=0,len=items.length;i<len;i++)item=items[i],group_ticket_qty+=item.tickets.qty;return group_ticket_qty},groupBasketItems=function(items){return $scope.multi_basket_grouping=_.groupBy($scope.bb.basket.timeItems(),"event_id"),$scope.multi_basket_grouping=_.values($scope.multi_basket_grouping),$scope.setLoaded($scope)},$scope.addAnother=function(_this){return function(route){return $scope.clearBasketItem(),$scope.bb.emptyStackedItems(),$scope.decideNextPage(route)}}(this),$scope.checkout=function(_this){return function(route){return $scope.bb.basket.settings&&$scope.bb.basket.settings.requires_deal&&!$scope.bb.basket.hasDeal()?(AlertService.raise("GIFT_CERTIFICATE_REQUIRED"),!1):$scope.bb.basket.items.length>0?($scope.setReadyToCheckout(!0),!!$scope.$parent.$has_page_control||$scope.decideNextPage(route)):(AlertService.raise("EMPTY_BASKET_FOR_CHECKOUT"),!1)}}(this),$scope.setReady=function(){return $scope.checkout()},$scope.applyCoupon=function(_this){return function(coupon){var params;return AlertService.clear(),$scope.notLoaded($scope),params={bb:$scope.bb,coupon:coupon},BasketService.applyCoupon($scope.bb.company,params).then(function(basket){var i,item,len,ref;for(ref=basket.items,i=0,len=ref.length;i<len;i++)item=ref[i],item.storeDefaults($scope.bb.item_defaults);return basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.setLoaded($scope)},function(err){return err&&err.data&&err.data.error&&(AlertService.clear(),AlertService.add("danger",{msg:err.data.error})),$scope.setLoaded($scope)})}}(this),$scope.applyDeal=function(_this){return function(deal_code){var params;return AlertService.clear(),params=$scope.client?{bb:$scope.bb,deal_code:deal_code,member_id:$scope.client.id}:{bb:$scope.bb,deal_code:deal_code,member_id:null},BasketService.applyDeal($scope.bb.company,params).then(function(basket){var i,item,len,ref;for(ref=basket.items,i=0,len=ref.length;i<len;i++)item=ref[i],item.storeDefaults($scope.bb.item_defaults);return basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.items=$scope.bb.basket.items,$scope.deal_code=null},function(err){if(err&&err.data&&err.data.error)return AlertService.clear(),AlertService.add("danger",{msg:err.data.error})})}}(this),$scope.removeDeal=function(_this){return function(deal_code){var params;return params={bb:$scope.bb,deal_code_id:deal_code.id},BasketService.removeDeal($scope.bb.company,params).then(function(basket){var i,item,len,ref;for(ref=basket.items,i=0,len=ref.length;i<len;i++)item=ref[i],item.storeDefaults($scope.bb.item_defaults);return basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.items=$scope.bb.basket.items},function(err){if(err&&err.data&&err.data.error)return AlertService.clear(),AlertService.add("danger",{msg:err.data.error})})}}(this),$scope.topUpWallet=function(){return $scope.decideNextPage("basket_wallet")}}])}.call(this),function(){angular.module("BB.Directives").directive("bbBasketSummary",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"BasketSummary"}}),angular.module("BB.Controllers").controller("BasketSummary",["$scope",function($scope){return $scope.controller="public.controllers.BasketSummary",$scope.basket_items=$scope.bb.basket.items,$scope.confirm=function(_this){return function(){return $scope.bb.basket.reviewed=!0,$scope.decideNextPage()}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbBulkPurchases",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"BulkPurchase"}}),angular.module("BB.Controllers").controller("BulkPurchase",["$scope","$rootScope","BulkPurchaseService",function($scope,$rootScope,BulkPurchaseService){return $scope.controller="public.controllers.BulkPurchase",$rootScope.connection_started.then(function(){if($scope.bb.company)return $scope.init($scope.bb.company)}),$scope.init=function(company){return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),BulkPurchaseService.query(company).then(function(bulk_purchases){return $scope.bulk_purchases=bulk_purchases})},$scope.selectItem=function(item,route){return $scope.$parent.$has_page_control?($scope.bulk_purchase=item,!1):($scope.booking_item.setBulkPurchase(item),$scope.decideNextPage(route),!0)},$scope.setReady=function(_this){return function(){return!!$scope.bulk_purchase&&($scope.booking_item.setBulkPurchase($scope.bulk_purchase),!0)}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCategories",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CategoryList"}}),angular.module("BB.Controllers").controller("CategoryList",["$scope","$rootScope","CategoryService","$q","PageControllerService",function($scope,$rootScope,CategoryService,$q,PageControllerService){return $scope.controller="public.controllers.CategoryList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(_this){return function(){if($scope.bb.company)return $scope.init($scope.bb.company)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(_this){return function(comp){return CategoryService.query(comp).then(function(items){return $scope.items=items,1===items.length&&($scope.skipThisStep(),$rootScope.categories=items,$scope.selectItem(items[0],$scope.nextRoute)),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectItem=function(_this){return function(item,route){return $scope.bb.current_item.setCategory(item),$scope.decideNextPage(route)}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCheckout",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Checkout"}}),angular.module("BB.Controllers").controller("Checkout",["$scope","$rootScope","$attrs","BasketService","$q","$location","$window","$bbug","FormDataStoreService","$timeout",function($scope,$rootScope,$attrs,BasketService,$q,$location,$window,$bbug,FormDataStoreService,$timeout){return $scope.controller="public.controllers.Checkout",$scope.notLoaded($scope),$scope.options=$scope.$eval($attrs.bbCheckout)||{},FormDataStoreService.destroy($scope),$rootScope.connection_started.then(function(_this){return function(){return $scope.checkout()}}(this)),$scope.checkout=function(){return $scope.bb.basket.setClient($scope.client),$scope.options.no_notifications&&($scope.bb.no_notifications=$scope.options.no_notifications),$scope.loadingTotal=BasketService.checkout($scope.bb.company,$scope.bb.basket,{bb:$scope.bb}),$scope.loadingTotal.then(function(_this){return function(total){return $scope.total=total,total.$has("new_payment")||($scope.$emit("checkout:success",total),$scope.bb.total=$scope.total,$scope.bb.payment_status="complete",$scope.options.disable_confirmation?$scope.reset():($scope.skipThisStep(),$scope.decideNextPage())),$scope.checkoutSuccess=!0,$scope.setLoaded($scope)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong"),$scope.checkoutFailed=!0,$scope.$emit("checkout:fail",err)})},$scope.print=function(_this){return function(){return $window.open($scope.bb.partial_url+"print_purchase.html?id="+$scope.total.long_id,"_blank","width=700,height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=1,left=0,top=0"),!0}}(this),$scope.printElement=function(id,stylesheet){var data,mywindow;return data=$bbug("#"+id).html(),mywindow=$window.open("","","height=600,width=800"),$timeout(function(){return mywindow.document.write("<html><head><title>Booking Confirmation</title>"),stylesheet&&mywindow.document.write('<link rel="stylesheet" href="'+stylesheet+'" type="text/css" />'),mywindow.document.write("</head><body>"),mywindow.document.write(data),mywindow.document.write("</body></html>"),$timeout(function(){return mywindow.document.close(),mywindow.focus(),mywindow.print(),mywindow.close()},100)},2e3)}}])}.call(this),function(){angular.module("BB.Directives").directive("bbClientDetails",["$q","$templateCache","$compile",function($q,$templateCache,$compile){return{restrict:"AE",replace:!0,scope:!0,transclude:!0,controller:"ClientDetails",link:function(scope,element,attrs,controller,transclude){return transclude(scope,function(_this){return function(clone){var has_content;return has_content=clone.length>1||1===clone.length&&(!clone[0].wholeText||/\S/.test(clone[0].wholeText)),has_content?element.html(clone).show():$q.when($templateCache.get("client_form.html")).then(function(template){return element.html(template).show(),$compile(element.contents())(scope)})}}(this))}}}]),angular.module("BB.Controllers").controller("ClientDetails",["$scope","$attrs","$rootScope","ClientDetailsService","ClientService","LoginService","BBModel","ValidatorService","QuestionService","AlertService",function($scope,$attrs,$rootScope,ClientDetailsService,ClientService,LoginService,BBModel,ValidatorService,QuestionService,AlertService){var handleError,options;return $scope.controller="public.controllers.ClientDetails",$scope.notLoaded($scope),$scope.validator=ValidatorService,$scope.existing_member=!1,$scope.login_error=!1,options=$scope.$eval($attrs.bbClientDetails)||{},$scope.suppress_client_create=null!=$attrs.bbSuppressCreate||options.suppress_client_create,$rootScope.connection_started.then(function(_this){return function(){return $scope.initClientDetails()}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$rootScope.$watch("member",function(_this){return function(oldmem,newmem){if(!$scope.client.valid()&&LoginService.isLoggedIn())return $scope.setClient(new BBModel.Client(LoginService.member()._data))}}(this)),$scope.initClientDetails=function(){return!$scope.client.valid()&&LoginService.isLoggedIn()&&$scope.setClient(new BBModel.Client(LoginService.member()._data)),LoginService.isLoggedIn()&&LoginService.member().$has("child_clients")&&LoginService.member()&&LoginService.member().getChildClientsPromise().then(function(_this){return function(children){return $scope.bb.parent_client=new BBModel.Client(LoginService.member()._data),$scope.bb.child_clients=children,$scope.bb.basket.parent_client_id=$scope.bb.parent_client.id}}(this)),$scope.client.client_details?($scope.client_details=$scope.client.client_details,$scope.client_details.questions&&QuestionService.checkConditionalQuestions($scope.client_details.questions),$scope.setLoaded($scope)):ClientDetailsService.query($scope.bb.company).then(function(_this){return function(details){return $scope.client_details=details,$scope.client&&$scope.client.pre_fill_answers($scope.client_details),$scope.client_details.questions&&QuestionService.checkConditionalQuestions($scope.client_details.questions),$scope.setLoaded($scope)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.validateClient=function(_this){return function(client_form,route){return $scope.notLoaded($scope),$scope.existing_member=!1,$scope.bb&&$scope.bb.parent_client&&($scope.client.parent_client_id=$scope.bb.parent_client.id),$scope.client.setClientDetails($scope.client_details),ClientService.create_or_update($scope.bb.company,$scope.client).then(function(client){return $scope.setLoaded($scope),$scope.setClient(client),$scope.bb.isAdmin&&$scope.client.setValid(!0),$scope.existing_member=!1,$scope.decideNextPage(route)},function(err){return handleError(err)})}}(this),$scope.clientLogin=function(_this){return function(){if($scope.login_error=!1,$scope.login)return LoginService.companyLogin($scope.bb.company,{},{email:$scope.login.email,password:$scope.login.password}).then(function(client){return $scope.setClient(new BBModel.Client(client)),$scope.login_error=!1,$scope.decideNextPage()},function(err){return $scope.login_error=!0,$scope.setLoaded($scope),AlertService.raise("LOGIN_FAILED")})}}(this),$scope.setReady=function(_this){return function(){var prom;return $scope.client.setClientDetails($scope.client_details),!!$scope.suppress_client_create||(prom=ClientService.create_or_update($scope.bb.company,$scope.client),prom.then(function(client){if($scope.setLoaded($scope),$scope.setClient(client),client.waitingQuestions)return client.gotQuestions.then(function(){return $scope.client_details=client.client_details})},function(err){return handleError(err)}),prom)}}(this),$scope.clientSearch=function(){return null!=$scope.client&&null!=$scope.client.email&&""!==$scope.client.email?($scope.notLoaded($scope),ClientService.query_by_email($scope.bb.company,$scope.client.email).then(function(client){return null!=client&&($scope.setClient(client),$scope.client=client),$scope.setLoaded($scope)},function(err){return $scope.setLoaded($scope)})):($scope.setClient({}),$scope.client={})},$scope.switchNumber=function(to){return $scope.no_mobile=!$scope.no_mobile,"mobile"===to?($scope.bb.basket.setSettings({send_sms_reminder:!0}),$scope.client.phone=null):($scope.bb.basket.setSettings({send_sms_reminder:!1}),$scope.client.mobile=null)},$scope.getQuestion=function(id){var i,len,question,ref;for(ref=$scope.client_details.questions,i=0,len=ref.length;i<len;i++)if(question=ref[i],question.id===id)return question;return null},$scope.useClient=function(client){return $scope.setClient(client)},$scope.recalc_question=function(){if($scope.client_details.questions)return QuestionService.checkConditionalQuestions($scope.client_details.questions)},handleError=function(error){return"Please Login"===error.data.error?($scope.existing_member=!0,AlertService.raise("ALREADY_REGISTERED")):"Invalid Password"===error.data.error&&AlertService.raise("PASSWORD_INVALID"),$scope.setLoaded($scope)}}])}.call(this),function(){"use strict";var CompanyListBase;CompanyListBase=function($scope,$rootScope,$q,$attrs){var options;return $scope.controller="public.controllers.CompanyList",$scope.notLoaded($scope),options=$scope.$eval($attrs.bbCompanies),$rootScope.connection_started.then(function(_this){return function(){return $scope.bb.company.companies?($scope.init($scope.bb.company),$rootScope.parent_id=$scope.bb.company.id):$rootScope.parent_id?void $scope.initWidget({company_id:$rootScope.parent_id,first_page:$scope.bb.current_page}):$scope.init($scope.bb.company)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(_this){return function(comp){return $scope.companies=$scope.bb.company.companies,$scope.companies&&0!==$scope.companies.length||($scope.companies=[$scope.bb.company]),1===$scope.companies.length?($scope.skipThisStep(),$scope.selectItem($scope.companies[0])):options&&options.hide_not_live_stores?$scope.items=$scope.companies.filter(function(c){return c.live}):$scope.items=$scope.companies,$scope.setLoaded($scope)}}(this),$scope.selectItem=function(_this){return function(item,route){var company_id,prms;return company_id=angular.isNumber(item)?item:item.id,$scope.notLoaded($scope),prms={company_id:company_id},$scope.initWidget(prms)}}(this),$scope.splitString=function(company){var arr,result;return arr=company.name.split(" "),result=arr[2]?arr[2]:""}},angular.module("BB.Directives").directive("bbCompanies",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CompanyList"}}),angular.module("BB.Controllers").controller("CompanyList",CompanyListBase),angular.module("BB.Directives").directive("bbPostcodeLookup",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PostcodeLookup"}}),angular.module("BB.Controllers").controller("PostcodeLookup",["$scope","$rootScope","$q","ValidatorService","AlertService","$attrs",function($scope,$rootScope,$q,ValidatorService,AlertService,$attrs){return $scope.controller="PostcodeLookup",angular.extend(this,new CompanyListBase($scope,$rootScope,$q,$attrs)),$scope.validator=ValidatorService,$scope.searchPostcode=function(_this){return function(form,prms){var promise;return $scope.notLoaded($scope),promise=ValidatorService.validatePostcode(form,prms),promise?promise.then(function(){var loc;return $scope.bb.postcode=ValidatorService.getGeocodeResult().address_components[0].short_name,$scope.postcode=$scope.bb.postcode,loc=ValidatorService.getGeocodeResult().geometry.location,$scope.selectItem($scope.getNearestCompany({center:loc}))},function(err){return $scope.setLoaded($scope)}):$scope.setLoaded($scope)}}(this),$scope.getNearestCompany=function(_this){return function(arg){var R,a,c,center,chLat,chLon,company,d,dLat,dLon,distances,i,lat1,lat2,latlong,len,lon1,lon2,pi,rLat1,rLat2,ref;for(center=arg.center,pi=Math.PI,R=6371,distances=[],lat1=center.lat(),lon1=center.lng(),ref=$scope.items,i=0,len=ref.length;i<len;i++)company=ref[i],company.address.lat&&company.address["long"]&&company.live&&(latlong=new google.maps.LatLng(company.address.lat,company.address["long"]),lat2=latlong.lat(),lon2=latlong.lng(),chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c,company.distance=d,distances.push(company)),distances.sort(function(a,b){return a.distance-b.distance});return distances[0]}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCustomBookingText",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CustomBookingText"}}),angular.module("BB.Controllers").controller("CustomBookingText",["$scope","$rootScope","CustomTextService","$q",function($scope,$rootScope,CustomTextService,$q){return $scope.controller="public.controllers.CustomBookingText",$scope.notLoaded($scope),$rootScope.connection_started.then(function(_this){return function(){return CustomTextService.BookingText($scope.bb.company,$scope.bb.current_item).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}]),angular.module("BB.Directives").directive("bbCustomConfirmationText",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CustomConfirmationText"}}),angular.module("BB.Controllers").controller("CustomConfirmationText",["$scope","$rootScope","CustomTextService","$q","PageControllerService",function($scope,$rootScope,CustomTextService,$q,PageControllerService){return $scope.controller="public.controllers.CustomConfirmationText",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return $scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadData=function(_this){return function(){return $scope.total?CustomTextService.confirmationText($scope.bb.company,$scope.total).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.loadingTotal?$scope.loadingTotal.then(function(total){return CustomTextService.confirmationText($scope.bb.company,total).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMonthAvailability",function(){return{restrict:"A",replace:!0,scope:!0,controller:"DayList"}}),angular.module("BB.Controllers").controller("DayList",["$scope","$rootScope","$q","DayService","AlertService",function($scope,$rootScope,$q,DayService,AlertService){return $scope.controller="public.controllers.DayList",$scope.notLoaded($scope),$scope.WeekHeaders=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],$scope.day_data={},$scope.type||($scope.type="month"),$scope.data_source||($scope.data_source=$scope.bb.current_item),$rootScope.connection_started.then(function(_this){return function(){return!$scope.current_date&&$scope.last_selected_date?$scope.current_date=$scope.last_selected_date.startOf($scope.type):$scope.current_date||($scope.current_date=moment().startOf($scope.type)),$scope.loadData()}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.$on("currentItemUpdate",function(event){return $scope.loadData()}),$scope.setCalType=function(_this){return function(type){return $scope.type=type}}(this),$scope.setDataSource=function(_this){return function(source){return $scope.data_source=source}}(this),$scope.format_date=function(_this){return function(fmt){if($scope.current_date)return $scope.current_date.format(fmt)}}(this),$scope.format_start_date=function(_this){return function(fmt){return $scope.format_date(fmt)}}(this),$scope.format_end_date=function(_this){return function(fmt){if($scope.end_date)return $scope.end_date.format(fmt)}}(this),$scope.selectDay=function(_this){return function(day,route,force){return!(0===day.spaces&&!force)&&($scope.setLastSelectedDate(day.date),$scope.bb.current_item.setDate(day),$scope.$parent.$has_page_control?void 0:$scope.decideNextPage(route))}}(this),$scope.setMonth=function(_this){
return function(month,year){return $scope.current_date=moment().startOf("month").year(year).month(month-1),$scope.current_date.year(),$scope.type="month"}}(this),$scope.setWeek=function(_this){return function(week,year){return $scope.current_date=moment().year(year).isoWeek(week).startOf("week"),$scope.current_date.year(),$scope.type="week"}}(this),$scope.add=function(_this){return function(type,amount){return $scope.current_date.add(amount,type),$scope.loadData()}}(this),$scope.subtract=function(_this){return function(type,amount){return $scope.add(type,-amount)}}(this),$scope.isPast=function(_this){return function(){return!$scope.current_date||moment().isAfter($scope.current_date)}}(this),$scope.loadData=function(_this){return function(){return"week"===$scope.type?$scope.loadWeek():$scope.loadMonth()}}(this),$scope.loadMonth=function(_this){return function(){var date,edate;return date=$scope.current_date,$scope.month=date.month(),$scope.notLoaded($scope),edate=moment(date).add(1,"months"),$scope.end_date=moment(edate).add(-1,"days"),$scope.data_source?DayService.query({company:$scope.bb.company,cItem:$scope.data_source,month:date.format("MMYY"),client:$scope.client}).then(function(days){var d,day,i,j,k,len,w,week,weeks;for($scope.days=days,i=0,len=days.length;i<len;i++)day=days[i],$scope.day_data[day.string_date]=day;for(weeks=[],w=j=0;j<=5;w=++j){for(week=[],d=k=0;k<=6;d=++k)week.push(days[7*w+d]);weeks.push(week)}return $scope.weeks=weeks,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this),$scope.loadWeek=function(_this){return function(){var date,edate;return date=$scope.current_date,$scope.notLoaded($scope),edate=moment(date).add(7,"days"),$scope.end_date=moment(edate).add(-1,"days"),$scope.data_source?DayService.query({company:$scope.bb.company,cItem:$scope.data_source,date:date.toISODate(),edate:edate.toISODate(),client:$scope.client}).then(function(days){var day,i,len;for($scope.days=days,i=0,len=days.length;i<len;i++)day=days[i],$scope.day_data[day.string_date]=day;return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this),$scope.setReady=function(_this){return function(){return!!$scope.bb.current_item.date||(AlertService.clear(),AlertService.add("danger",{msg:"You need to select a date"}),!1)}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbDeals",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"DealList"}}),angular.module("BB.Controllers").controller("DealList",["$scope","$rootScope","DealService","$q","BBModel","AlertService","FormDataStoreService","ValidatorService","$modal",function($scope,$rootScope,DealService,$q,BBModel,AlertService,FormDataStoreService,ValidatorService,$modal){var ModalInstanceCtrl,init;return $scope.controller="public.controllers.DealList",FormDataStoreService.init("TimeRangeList",$scope,["deals"]),$rootScope.connection_started.then(function(){return init()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),init=function(){var deal_promise;if($scope.notLoaded($scope),!$scope.deals)return deal_promise=DealService.query($scope.bb.company),deal_promise.then(function(deals){return $scope.deals=deals,$scope.setLoaded($scope)})},$scope.selectDeal=function(deal){var iitem,modalInstance;return iitem=new BBModel.BasketItem(null,$scope.bb),iitem.setDefaults($scope.bb.item_defaults),iitem.setDeal(deal),$scope.bb.company_settings.no_recipient?($scope.notLoaded($scope),$scope.setBasketItem(iitem),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):(modalInstance=$modal.open({templateUrl:$scope.getPartial("_add_recipient"),scope:$scope,controller:ModalInstanceCtrl,resolve:{item:function(){return iitem}}}),modalInstance.result.then(function(item){return $scope.notLoaded($scope),$scope.setBasketItem(item),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}))},ModalInstanceCtrl=function($scope,$modalInstance,item,ValidatorService){return $scope.controller="ModalInstanceCtrl",$scope.item=item,$scope.recipient=!1,$scope.addToBasket=function(form){if(ValidatorService.validateForm(form))return $modalInstance.close($scope.item)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},$scope.purchaseDeals=function(){return $scope.bb.basket.items&&$scope.bb.basket.items.length>0?$scope.decideNextPage():AlertService.add("danger",{msg:"You need to select at least one Gift Certificate to continue"})},$scope.setReady=function(){return!!($scope.bb.basket.items&&$scope.bb.basket.items.length>0)||AlertService.add("danger",{msg:"You need to select at least one Gift Certificate to continue"})}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbDurations",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"DurationList"}}),angular.module("BB.Controllers").controller("DurationList",["$scope","$attrs","$rootScope","PageControllerService","$q","AlertService","$filter",function($scope,$attrs,$rootScope,PageControllerService,$q,AlertService,$filter){var options;return $scope.controller="public.controllers.DurationList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),options=$scope.$eval($attrs.bbDurations)||{},$rootScope.connection_started.then(function(){return $scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadData=function(_this){return function(){var d,duration,i,id,initial_duration,len,ref,service;if(id=$scope.bb.company_id,service=$scope.bb.current_item.service){for($scope.durations=function(){var i,len,ref,results;for(ref=_.zip(service.durations,service.prices),results=[],i=0,len=ref.length;i<len;i++)d=ref[i],results.push({value:d[0],price:d[1]});return results}(),initial_duration=$scope.$eval($attrs.bbInitialDuration),ref=$scope.durations,i=0,len=ref.length;i<len;i++)duration=ref[i],$scope.bb.current_item.duration&&duration.value===$scope.bb.current_item.duration?$scope.duration=duration:initial_duration&&initial_duration===duration.value&&($scope.duration=duration,$scope.bb.current_item.setDuration(duration.value)),duration.pretty=$filter("time_period")(duration.value),options.show_prices&&(duration.pretty+=" ("+$filter("currency")(duration.price)+")");1===$scope.durations.length&&($scope.skipThisStep(),$scope.selectDuration($scope.durations[0],$scope.nextRoute))}return $scope.setLoaded($scope)}}(this),$scope.selectDuration=function(_this){return function(dur,route){return $scope.$parent.$has_page_control?void($scope.duration=dur):($scope.bb.current_item.setDuration(dur.value),$scope.decideNextPage(route),!0)}}(this),$scope.durationChanged=function(_this){return function(){return $scope.bb.current_item.setDuration($scope.duration.value),$scope.broadcastItemUpdate()}}(this),$scope.setReady=function(_this){return function(){return $scope.duration?($scope.bb.current_item.setDuration($scope.duration.value),!0):(AlertService.clear(),AlertService.add("danger",{msg:"You need to select a duration"}),!1)}}(this),$scope.$on("currentItemUpdate",function(event){return $scope.loadData()})}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEvent",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Event"}}),angular.module("BB.Controllers").controller("Event",["$scope","$attrs","$rootScope","EventService","$q","PageControllerService","BBModel","ValidatorService","FormDataStoreService",function($scope,$attrs,$rootScope,EventService,$q,PageControllerService,BBModel,ValidatorService,FormDataStoreService){var init,initImage,initTickets,ticket_refs;return $scope.controller="public.controllers.Event",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$scope.event_options=$scope.$eval($attrs.bbEvent)||{},ticket_refs=[],FormDataStoreService.init("Event",$scope,["selected_tickets","event_options"]),$rootScope.connection_started.then(function(){if($scope.bb.company)return init($scope.bb.company)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),init=function(comp){var promises;return $scope.bb.stacked_items&&0===$scope.bb.stacked_items.length&&delete $scope.selected_tickets,$scope.event=$scope.bb.current_item.event,$scope.event_options.use_my_details=null==$scope.event_options.use_my_details||$scope.event_options.use_my_details,promises=[$scope.bb.current_item.event_group.getImagesPromise(),$scope.event.prepEvent()],$scope.client&&promises.push($scope.getPrePaidsForEvent($scope.client,$scope.event)),$q.all(promises).then(function(result){var event,images,item,prepaids;return result[0]&&result[0].length>0&&(images=result[0]),event=result[1],result[2]&&result[2].length>0&&(prepaids=result[2]),$scope.event=event,images&&initImage(images),$scope.bb.current_item.tickets&&$scope.bb.current_item.tickets.qty>0?($scope.edit_mode=!0,$scope.setLoaded($scope),$scope.selected_tickets=!0,$scope.current_ticket_items=_.filter($scope.bb.basket.timeItems(),function(item){return item.event_id===$scope.event.id}),$scope.tickets=function(){var i,len,ref1,results;for(ref1=$scope.current_ticket_items,results=[],i=0,len=ref1.length;i<len;i++)item=ref1[i],results.push(item.tickets);return results}(),void $scope.$watch("current_ticket_items",function(items,olditems){return $scope.bb.basket.total_price=$scope.bb.basket.totalPrice()},!0)):(initTickets(),$scope.$broadcast("bbEvent:initialised"),$scope.setLoaded($scope))},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.selectTickets=function(){var base_item,c,i,item,j,len,ref,ref1,ref2,ticket;for($scope.notLoaded($scope),$scope.bb.emptyStackedItems(),base_item=$scope.bb.current_item,ref1=$scope.event.tickets,i=0,len=ref1.length;i<len;i++)if(ticket=ref1[i],ticket.qty)switch($scope.event.chain.ticket_type){case"single_space":for(c=j=1,ref2=ticket.qty;1<=ref2?j<=ref2:j>=ref2;c=1<=ref2?++j:--j)item=new BBModel.BasketItem,ref=item.ref,angular.extend(item,base_item),item.ref=ref,ticket_refs.push(item.ref),delete item.id,item.tickets=angular.copy(ticket),item.tickets.qty=1,$scope.bb.stackItem(item);break;case"multi_space":item=new BBModel.BasketItem,ref=item.ref,angular.extend(item,base_item),item.ref=ref,ticket_refs.push(item.ref),item.tickets=angular.copy(ticket),delete item.id,item.tickets.qty=ticket.qty,$scope.bb.stackItem(item)}return 0===$scope.bb.stacked_items.length?void $scope.setLoaded($scope):($scope.bb.pushStackToBasket(),$scope.updateBasket().then(function(_this){return function(){return $scope.setLoaded($scope),$scope.selected_tickets=!0,$scope.stopTicketWatch(),$scope.current_ticket_items=_.filter($scope.bb.basket.timeItems(),function(item){return _.contains(ticket_refs,item.ref)}),$scope.tickets=function(){var k,len1,ref3,results;for(ref3=$scope.current_ticket_items,results=[],k=0,len1=ref3.length;k<len1;k++)item=ref3[k],results.push(item.tickets);return results}(),$scope.$watch("current_ticket_items",function(items,olditems){return $scope.bb.basket.total_price=$scope.bb.basket.totalPrice()},!0)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},$scope.selectItem=function(_this){return function(item,route){return $scope.$parent.$has_page_control?($scope.event=item,!1):($scope.bb.current_item.setEvent(item),$scope.bb.current_item.ready=!1,$scope.decideNextPage(route),!0)}}(this),$scope.setReady=function(_this){return function(){var i,item,len,ref1;for(ref1=$scope.current_ticket_items,i=0,len=ref1.length;i<len;i++)item=ref1[i],item.setEvent($scope.event);return $scope.bb.event_details={name:$scope.event.chain.name,image:$scope.event.image,address:$scope.event.chain.address,datetime:$scope.event.date,end_datetime:$scope.event.end_datetime,duration:$scope.event.duration,tickets:$scope.event.tickets},!!$scope.event_options.suppress_basket_update||$scope.updateBasket()}}(this),$scope.getPrePaidsForEvent=function(client,event){var defer,params;return defer=$q.defer(),params={event_id:event.id},client.getPrePaidBookingsPromise(params).then(function(prepaids){return $scope.pre_paid_bookings=prepaids,defer.resolve(prepaids)},function(err){return defer.reject(err)}),defer.promise},initImage=function(images){var image;if(image=images[0])return image.background_css={"background-image":"url("+image.url+")"},$scope.event.image=image},initTickets=function(){var i,len,ref1,ticket;if(!$scope.selected_tickets){if($scope.event.tickets[0].qty=$scope.event_options.default_num_tickets?$scope.event_options.default_num_tickets:0,$scope.event.tickets.length>1)for(ref1=$scope.event.tickets.slice(1),i=0,len=ref1.length;i<len;i++)ticket=ref1[i],ticket.qty=0;return $scope.event_options.default_num_tickets&&$scope.event_options.auto_select_tickets&&1===$scope.event.tickets.length&&1===$scope.event.tickets[0].max_num_bookings&&$scope.selectTickets(),$scope.tickets=$scope.event.tickets,$scope.bb.basket.total_price=$scope.bb.basket.totalPrice(),$scope.stopTicketWatch=$scope.$watch("tickets",function(tickets,oldtickets){return $scope.bb.basket.total_price=$scope.bb.basket.totalPrice(),$scope.event.updatePrice()},!0)}}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEventGroups",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"EventGroupList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("EventGroupList",["$scope","$rootScope","$q","$attrs","ItemService","FormDataStoreService","ValidatorService","PageControllerService","halClient",function($scope,$rootScope,$q,$attrs,ItemService,FormDataStoreService,ValidatorService,PageControllerService,halClient){var setEventGroupItem;return $scope.controller="public.controllers.EventGroupList",FormDataStoreService.init("EventGroupList",$scope,["event_group"]),$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(_this){return function(){if($scope.bb.company)return $scope.init($scope.bb.company)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(comp){var ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),ppromise=comp.getEventGroupsPromise(),ppromise.then(function(items){var default_event_group,filterItems,i,item,j,len,len1;if(filterItems="false"!==$attrs.filterServices,filterItems&&($scope.booking_item.service_ref&&!$scope.show_all?items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref}):$scope.booking_item.category&&!$scope.show_all&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.booking_item.category.self}))),1!==items.length||$scope.allowSinglePick?setEventGroupItem(items):$scope.selectItem(items[0],$scope.nextRoute)?$scope.skipThisStep():setEventGroupItem(items),default_event_group=$scope.booking_item.defaultService())for(i=0,len=items.length;i<len;i++)item=items[i],item.self===default_event_group.self&&$scope.selectItem(item,$scope.nextRoute);if($scope.booking_item.event_group)for(j=0,len1=items.length;j<len1;j++)item=items[j],item.selected=!1,item.self===$scope.booking_item.event_group.self&&($scope.event_group=item,item.selected=!0,$scope.booking_item.setEventGroup($scope.event_group));if($scope.setLoaded($scope),$scope.booking_item.event_group||!$scope.booking_item.person&&!$scope.booking_item.resource)return $scope.bookable_services=$scope.items},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},setEventGroupItem=function(items){if($scope.items=items,$scope.event_group)return _.each(items,function(item){if(item.id===$scope.event_group.id)return $scope.event_group=item})},$scope.selectItem=function(_this){return function(item,route){return $scope.$parent.$has_page_control?($scope.event_group=item,!1):($scope.booking_item.setEventGroup(item),$scope.decideNextPage(route),!0)}}(this),$scope.$watch("event_group",function(_this){return function(newval,oldval){if($scope.event_group&&(!$scope.booking_item.event_group||$scope.booking_item.event_group.self!==$scope.event_group.self))return $scope.booking_item.setEventGroup($scope.event_group),$scope.broadcastItemUpdate()}}(this)),$scope.setReady=function(_this){return function(){return!!$scope.event_group&&($scope.booking_item.setEventGroup($scope.event_group),!0)}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEvents",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"EventList",link:function(scope,element,attrs){scope.summary=null!=attrs.summary,scope.events_options=scope.$eval(attrs.bbEvents)||{},scope.mode=scope.events_options&&scope.events_options.mode?scope.events_options.mode:0,scope.summary&&(scope.mode=0),scope.events_options&&scope.events_options.per_page&&(scope.per_page=scope.events_options.per_page)}}}),angular.module("BB.Controllers").controller("EventList",["$scope","$rootScope","EventService","EventChainService","$q","PageControllerService","FormDataStoreService","$filter","PaginationService","$timeout",function($scope,$rootScope,EventService,EventChainService,$q,PageControllerService,FormDataStoreService,$filter,PaginationService,$timeout){var buildDynamicFilters,sort;return $scope.controller="public.controllers.EventList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.pick={},$scope.start_date=moment(),$scope.end_date=moment().add(1,"year"),$scope.filters={hide_sold_out_events:!0},$scope.pagination=PaginationService.initialise({page_size:10,max_size:5}),$scope.events={},$scope.fully_booked=!1,$scope.event_data_loaded=!1,FormDataStoreService.init("EventList",$scope,["selected_date","event_group_id","event_group_manually_set"]),$rootScope.connection_started.then(function(){if($scope.bb.company){if(!$scope.bb.current_item.defaults||!$scope.bb.current_item.defaults.event)return $scope.bb.company.$has("parent")&&!$scope.bb.company.$has("company_questions")?$scope.bb.company.getParentPromise().then(function(parent){return $scope.company_parent=parent,$scope.initialise()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.initialise();$scope.skipThisStep(),$scope.decideNextPage()}},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.initialise=function(){var event_group,promises;return $scope.notLoaded($scope),0!==$scope.mode&&delete $scope.selected_date,$scope.event_group_manually_set||null!=$scope.current_item.event_group||($scope.event_group_manually_set=null==$scope.event_group_manually_set&&null!=$scope.current_item.event_group),$scope.bb.current_item.event&&(event_group=$scope.current_item.event_group,$scope.clearBasketItem(),$scope.emptyBasket(),$scope.event_group_manually_set&&$scope.current_item.setEventGroup(event_group)),promises=[],$scope.bb.company.$has("company_questions")?promises.push($scope.bb.company.getCompanyQuestionsPromise()):null!=$scope.company_parent&&$scope.company_parent.$has("company_questions")?promises.push($scope.company_parent.getCompanyQuestionsPromise()):(promises.push($q.when([])),$scope.has_company_questions=!1),!$scope.current_item.event_group&&$scope.bb.company.$has("event_groups")?promises.push($scope.bb.company.getEventGroupsPromise()):promises.push($q.when([])),0===$scope.mode||2===$scope.mode?promises.push($scope.loadEventSummary()):promises.push($q.when([])),1===$scope.mode||2===$scope.mode?promises.push($scope.loadEventData()):promises.push($q.when([])),$q.all(promises).then(function(result){var company_questions,event_data,event_groups,event_groups_collection,event_summary,item,j,len,ref;if(company_questions=result[0],event_groups=result[1],event_summary=result[2],event_data=result[3],$scope.has_company_questions=null!=company_questions&&company_questions.length>0,company_questions&&buildDynamicFilters(company_questions),$scope.event_groups=event_groups,event_groups_collection=_.indexBy(event_groups,"id"),$scope.items)for(ref=$scope.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.group=event_groups_collection[item.service_id];return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.loadEventSummary=function(){var comp,current_event,deferred,params;return deferred=$q.defer(),current_event=$scope.current_item.event,$scope.bb.current_item&&($scope.bb.current_item.event_chain_id||$scope.bb.current_item.event_chain)&&(delete $scope.bb.current_item.event_chain,delete $scope.bb.current_item.event_chain_id),comp=$scope.bb.company,params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()},$scope.bb.item_defaults.event_chain&&(params.event_chain_id=$scope.bb.item_defaults.event_chain.id),EventService.summary(comp,params).then(function(items){var d,item,item_dates,j,len;if(items&&items.length>0){for(item_dates=[],j=0,len=items.length;j<len;j++)item=items[j],d=moment(item),item_dates.push({date:d,idate:parseInt(d.format("YYYYDDDD")),count:1,spaces:1});$scope.item_dates=item_dates.sort(function(a,b){return a.idate-b.idate}),0===$scope.mode&&($scope.selected_date&&($scope.selected_date.isAfter($scope.item_dates[0].date)||$scope.selected_date.isSame($scope.item_dates[0].date))&&($scope.selected_date.isBefore($scope.item_dates[$scope.item_dates.length-1].date)||$scope.selected_date.isSame($scope.item_dates[$scope.item_dates.length-1].date))?$scope.showDay($scope.selected_date):$scope.showDay($scope.item_dates[0].date))}return deferred.resolve($scope.item_dates)},function(err){return deferred.reject()}),deferred.promise},$scope.loadEventChainData=function(comp){var deferred,params;return deferred=$q.defer(),$scope.bb.item_defaults.event_chain?deferred.resolve([]):(comp||(comp=$scope.bb.company),params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()},$scope.events_options.embed&&(params.embed=$scope.events_options.embed),EventChainService.query(comp,params).then(function(event_chains){return deferred.resolve(event_chains)},function(err){return deferred.reject()})),deferred.promise},$scope.loadEventData=function(comp){var chains,current_event,deferred,params;return $scope.notLoaded($scope),$scope.event_data_loaded=!1,0===$scope.mode&&delete $scope.items,deferred=$q.defer(),current_event=$scope.current_item.event,comp||(comp=$scope.bb.company),$scope.bb.current_item&&($scope.bb.current_item.event_chain_id||$scope.bb.current_item.event_chain)&&(delete $scope.bb.current_item.event_chain,delete $scope.bb.current_item.event_chain_id),params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate(),include_non_bookable:!0},$scope.bb.item_defaults.event_chain&&(params.event_chain_id=$scope.bb.item_defaults.event_chain.id),$scope.per_page&&(params.per_page=$scope.per_page),chains=$scope.loadEventChainData(comp),$scope.events={},EventService.query(comp,params).then(function(events){var item,j,len,ref;for($scope.items=_.flatten(events),ref=$scope.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.spaces_left=item.getSpacesLeft();return $scope.bb.company.$has("address")&&$scope.bb.company.getAddressPromise().then(function(address){var k,len1,ref1,results;for(ref1=$scope.items,results=[],k=0,len1=ref1.length;k<len1;k++)item=ref1[k],results.push(item.address=address);return results}),chains.then(function(){var idate,item_dates,k,l,len1,len2,ref1,x,y;for(ref1=$scope.items,k=0,len1=ref1.length;k<len1;k++)item=ref1[k],item.prepEvent({embed:"events"}),0===$scope.mode&&current_event&&current_event.self===item.self&&(item.select(),$scope.event=item);if(1===$scope.mode)if(item_dates={},items.length>0){for(l=0,len2=items.length;l<len2;l++)item=items[l],item.getDuration(),idate=parseInt(item.date.format("YYYYDDDD")),item.idate=idate,item_dates[idate]||(item_dates[idate]={date:item.date,idate:idate,count:0,spaces:0}),item_dates[idate].count+=1,item_dates[idate].spaces+=item.num_spaces;$scope.item_dates=[];for(x in item_dates)y=item_dates[x],$scope.item_dates.push(y);$scope.item_dates=$scope.item_dates.sort(function(a,b){return a.idate-b.idate})}else idate=parseInt($scope.start_date.format("YYYYDDDD")),$scope.item_dates=[{date:$scope.start_date,idate:idate,count:0,spaces:0}];return $scope.isFullyBooked(),$scope.filtered_items=$scope.items,$scope.filterChanged(),PaginationService.update($scope.pagination,$scope.filtered_items.length),$scope.setLoaded($scope),$scope.event_data_loaded=!0,deferred.resolve($scope.items)},function(err){return deferred.reject()})},function(err){return deferred.reject()}),deferred.promise},$scope.isFullyBooked=function(){var full_events,item,j,len,ref;for(full_events=[],ref=$scope.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.num_spaces===item.spaces_booked&&full_events.push(item);if(full_events.length===$scope.items.length)return $scope.fully_booked=!0},$scope.showDay=function(date){var new_date;if(moment.isMoment(date))return 0===$scope.mode?($scope.event&&!$scope.selected_date.isSame(date,"day")&&delete $scope.event,new_date=date,$scope.start_date=moment(date),$scope.end_date=moment(date),$scope.loadEventData()):$scope.selected_date&&date.isSame($scope.selected_date,"day")||(new_date=date),new_date?($scope.selected_date=new_date,$scope.filters.date=new_date.toDate()):(delete $scope.selected_date,delete $scope.filters.date),$scope.filterChanged()},$scope.$watch("pick.date",function(_this){return function(new_val,old_val){if(new_val)return $scope.start_date=moment(new_val),$scope.end_date=moment(new_val),$scope.loadEventData()}}(this)),$scope.selectItem=function(_this){return function(item,route){var i,j,len,ref;if(!(item.getSpacesLeft()<=0&&$scope.bb.company.settings.has_waitlists||item.hasSpace()))return!1;if($scope.notLoaded($scope),$scope.$parent.$has_page_control)return $scope.event&&$scope.event.unselect(),$scope.event=item,$scope.event.select(),$scope.setLoaded($scope),!1;if($scope.bb.moving_purchase)for(ref=$scope.bb.basket.items,j=0,len=ref.length;j<len;j++)i=ref[j],i.setEvent(item);return $scope.bb.current_item.setEvent(item),$scope.bb.current_item.ready=!1,$q.all($scope.bb.current_item.promises).then(function(){return $scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),!0}}(this),$scope.setReady=function(){return!!$scope.event&&($scope.bb.current_item.setEvent($scope.event),!0)},$scope.filterEvents=function(item){var result;return result=(moment($scope.filters.date).isSame(item.date,"day")||null==$scope.filters.date)&&($scope.filters.event_group&&item.service_id===$scope.filters.event_group.id||null==$scope.filters.event_group)&&(null!=$scope.filters.price&&item.price_range.from<=$scope.filters.price||null==$scope.filters.price)&&($scope.filters.hide_sold_out_events&&item.bookable||!$scope.filters.hide_sold_out_events)&&$scope.filterEventsWithDynamicFilters(item)},$scope.filterEventsWithDynamicFilters=function(item){var dynamic_filter,filter,i,j,k,l,len,len1,len2,len3,m,name,ref,ref1,ref2,ref3,result,type;if(!$scope.has_company_questions||!$scope.dynamic_filters)return!0;for(result=!0,ref=$scope.dynamic_filters.question_types,j=0,len=ref.length;j<len;j++)if(type=ref[j],"check"===type)for(ref1=$scope.dynamic_filters.check,k=0,len1=ref1.length;k<len1;k++){if(dynamic_filter=ref1[k],name=dynamic_filter.name.parameterise("_"),filter=!1,item.chain&&item.chain.extra[name])for(ref2=item.chain.extra[name],l=0,len2=ref2.length;l<len2&&(i=ref2[l],!(filter=$scope.dynamic_filters.values[dynamic_filter.name]&&i===$scope.dynamic_filters.values[dynamic_filter.name].name||null==$scope.dynamic_filters.values[dynamic_filter.name]));l++);else void 0!==item.chain.extra[name]||!_.isEmpty($scope.dynamic_filters.values)&&null!=$scope.dynamic_filters.values[dynamic_filter.name]||(filter=!0);result=result&&filter}else for(ref3=$scope.dynamic_filters[type],m=0,len3=ref3.length;m<len3;m++)dynamic_filter=ref3[m],name=dynamic_filter.name.parameterise("_"),filter=$scope.dynamic_filters.values[dynamic_filter.name]&&item.chain.extra[name]===$scope.dynamic_filters.values[dynamic_filter.name].name||null==$scope.dynamic_filters.values[dynamic_filter.name],result=result&&filter;return result},$scope.filterDateChanged=function(options){var date;if(null==options&&(options={reset:!1}),$scope.filters.date&&(date=moment($scope.filters.date),$scope.$broadcast("event_list_filter_date:changed",date),$scope.showDay(date),options.reset===!0||null==$scope.selected_date))return $timeout(function(){return delete $scope.filters.date},250)},$scope.resetFilters=function(){return $scope.filters={},$scope.has_company_questions&&($scope.dynamic_filters.values={}),$scope.filterChanged()},buildDynamicFilters=function(questions){return $scope.dynamic_filters=_.groupBy(questions,"question_type"),$scope.dynamic_filters.question_types=_.uniq(_.pluck(questions,"question_type")),$scope.dynamic_filters.values={}},sort=function(){},$scope.filterChanged=function(){if($scope.items)return $scope.filtered_items=$filter("filter")($scope.items,$scope.filterEvents),$scope.pagination.num_items=$scope.filtered_items.length,$scope.filter_active=$scope.filtered_items.length!==$scope.items.length,PaginationService.update($scope.pagination,$scope.filtered_items.length)},$scope.pageChanged=function(){return PaginationService.update($scope.pagination,$scope.filtered_items.length),$rootScope.$broadcast("page:changed")}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbGetAvailability",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"GetAvailability",link:function(scope,element,attrs){attrs.bbGetAvailability&&scope.loadAvailability(scope.$eval(attrs.bbGetAvailability))}}}),angular.module("BB.Controllers").controller("GetAvailability",["$scope","$element","$attrs","$rootScope","$q","TimeService","AlertService","BBModel","halClient",function($scope,$element,$attrs,$rootScope,$q,TimeService,AlertService,BBModel,halClient){return $scope.loadAvailability=function(_this){return function(prms){var service;return service=halClient.$get($scope.bb.api_url+"/api/v1/"+prms.company_id+"/services/"+prms.service),service.then(function(serv){var eday,sday;return $scope.earliest_day=null,sday=moment(),eday=moment().add(30,"days"),serv.$get("days",{date:sday.toISOString(),edate:eday.toISOString()}).then(function(res){var day,i,len,ref,results;for(ref=res.days,results=[],i=0,len=ref.length;i<len;i++)day=ref[i],day.spaces>0&&!$scope.earliest_day?($scope.earliest_day=moment(day.date),day.first?results.push($scope.earliest_day.add(day.first,"minutes")):results.push(void 0)):results.push(void 0);return results})})}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbItemDetails",["$q","$templateCache","$compile",function($q,$templateCache,$compile){return{restrict:"AE",replace:!0,scope:!0,transclude:!0,controller:"ItemDetails",link:function(scope,element,attrs,controller,transclude){var item;return attrs.bbItemDetails&&(item=scope.$eval(attrs.bbItemDetails),scope.item_from_param=item,scope.item_details&&delete scope.item_details,item&&scope.loadItem(item)),transclude(scope,function(_this){return function(clone){var has_content;
return has_content=clone.length>1||1===clone.length&&(!clone[0].wholeText||/\S/.test(clone[0].wholeText)),has_content?element.html(clone).show():$q.when($templateCache.get("_item_details.html")).then(function(template){return element.html(template).show(),$compile(element.contents())(scope)})}}(this))}}}]),angular.module("BB.Controllers").controller("ItemDetails",["$scope","$attrs","$rootScope","ItemDetailsService","PurchaseBookingService","AlertService","BBModel","FormDataStoreService","ValidatorService","QuestionService","$modal","$location","$translate","SettingsService","PurchaseService",function($scope,$attrs,$rootScope,ItemDetailsService,PurchaseBookingService,AlertService,BBModel,FormDataStoreService,ValidatorService,QuestionService,$modal,$location,$translate,SettingsService,PurchaseService){var confirming,setItemDetails;return $scope.controller="public.controllers.ItemDetails",$scope.suppress_basket_update=null!=$attrs.bbSuppressBasketUpdate,$scope.item_details_id=$scope.$eval($attrs.bbSuppressBasketUpdate),$scope.suppress_basket_update?FormDataStoreService.init("ItemDetails"+$scope.item_details_id,$scope,["item_details"]):FormDataStoreService.init("ItemDetails",$scope,["item_details"]),QuestionService.addAnswersByName($scope.client,["first_name","last_name","email","mobile"]),$scope.validator=ValidatorService,confirming=!1,$rootScope.connection_started.then(function(){if(!confirming)return $scope.loadItem($scope.bb.current_item)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadItem=function(item){var params;return $scope.notLoaded($scope),confirming=!0,$scope.item=item,$scope.bb.private_note&&($scope.item.private_note=$scope.bb.private_note),$scope.product=item.product,$scope.item.item_details?(setItemDetails($scope.item.item_details),QuestionService.addDynamicAnswersByName($scope.item_details.questions),$scope.bb.item_defaults.answers&&QuestionService.addAnswersFromDefaults($scope.item_details.questions,$scope.bb.item_defaults.answers),$scope.recalc_price(),$scope.setLoaded($scope),$scope.$emit("item_details:loaded",$scope.item_details)):(params={company:$scope.bb.company,cItem:$scope.item},ItemDetailsService.query(params).then(function(details){return details&&(setItemDetails(details),$scope.item.item_details=$scope.item_details,QuestionService.addDynamicAnswersByName($scope.item_details.questions),$scope.bb.item_defaults.answers&&QuestionService.addAnswersFromDefaults($scope.item_details.questions,$scope.bb.item_defaults.answers),$scope.recalc_price(),$scope.$emit("item_details:loaded",$scope.item_details)),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},setItemDetails=function(details){var oldQuestions;return $scope.item&&$scope.item.defaults&&_.each(details.questions,function(item){var n;if(n="q_"+item.name,$scope.item.defaults[n])return item.answer=$scope.item.defaults[n]}),$scope.hasOwnProperty("item_details")&&(oldQuestions=$scope.item_details.questions,_.each(details.questions,function(item){var search;if(search=_.findWhere(oldQuestions,{name:item.name}))return item.answer=search.answer})),$scope.item_details=details},$scope.$on("currentItemUpdate",function(event){return $scope.item_from_param?$scope.loadItem($scope.item_from_param):$scope.loadItem($scope.bb.current_item)}),$scope.recalc_price=function(){var bprice,qprice;return qprice=$scope.item_details.questionPrice($scope.item.getQty()),bprice=$scope.item.base_price,bprice||(bprice=$scope.item.price),$scope.item.setPrice(qprice+bprice)},$scope.confirm=function(form,route){if(ValidatorService.validateForm(form))return $scope.bb.moving_booking?$scope.confirm_move(form,route):($scope.item.setAskedQuestions(),!!$scope.$parent.$has_page_control||($scope.item.ready?($scope.notLoaded($scope),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoaded($scope)})):$scope.decideNextPage(route)))},$scope.setReady=function(_this){return function(){return $scope.item.setAskedQuestions(),!($scope.item.ready&&!$scope.suppress_basket_update)||$scope.addItemToBasket()}}(this),$scope.confirm_move=function(route){var params;return confirming=!0,$scope.item||($scope.item=$scope.bb.current_item),$scope.item.moved_booking=!1,$scope.item.setAskedQuestions(),$scope.item.ready?($scope.notLoaded($scope),$scope.bb.moving_purchase?(params={purchase:$scope.bb.moving_purchase,bookings:$scope.bb.basket.items},$scope.bb.current_item.move_reason&&(params.move_reason=$scope.bb.current_item.move_reason),PurchaseService.update(params).then(function(purchase){return $scope.bb.purchase=purchase,$scope.bb.purchase.getBookingsPromise().then(function(bookings){return $scope.purchase=purchase,$scope.setLoaded($scope),$scope.item.move_done=!0,$scope.item.moved_booking=!0,$rootScope.$broadcast("booking:moved"),$scope.decideNextPage(route),$scope.showMoveMessage(bookings[0].datetime)})},function(err){return $scope.setLoaded($scope),AlertService.add("danger",{msg:"Failed to move booking. Please try again."})})):($scope.bb.current_item.move_reason&&($scope.item.move_reason=$scope.bb.current_item.move_reason),PurchaseBookingService.update($scope.item).then(function(booking){var _i,b,i,len,oldb,ref;if(b=new BBModel.Purchase.Booking(booking),$scope.bb.purchase)for(ref=$scope.bb.purchase.bookings,_i=i=0,len=ref.length;i<len;_i=++i)oldb=ref[_i],oldb.id===b.id&&($scope.bb.purchase.bookings[_i]=b);return $scope.setLoaded($scope),$scope.bb.moved_booking=booking,$scope.item.move_done=!0,$rootScope.$broadcast("booking:moved"),$scope.decideNextPage(route),$scope.showMoveMessage(b.datetime)},function(_this){return function(err){return $scope.setLoaded($scope),AlertService.add("danger",{msg:"Failed to move booking. Please try again."})}}(this)))):$scope.decideNextPage(route)},$scope.showMoveMessage=function(datetime){return SettingsService.isInternationalizatonEnabled()?$translate("MOVE_BOOKINGS_MSG",{datetime:datetime.format("LLLL")}).then(function(translated_text){return AlertService.add("info",{msg:translated_text})}):AlertService.add("info",{msg:"Your booking has been moved to "+datetime.format("LLLL")})},$scope.openTermsAndConditions=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:$scope.getPartial("terms_and_conditions"),scope:$scope})},$scope.getQuestion=function(id){var i,len,question,ref;for(ref=$scope.item_details.questions,i=0,len=ref.length;i<len;i++)if(question=ref[i],question.id===id)return question;return null},$scope.updateItem=function(){if($scope.item.setAskedQuestions(),$scope.item.ready)return $scope.notLoaded($scope),PurchaseBookingService.update($scope.item).then(function(booking){var _i,b,i,len,oldb,ref;if(b=new BBModel.Purchase.Booking(booking),$scope.bookings)for(ref=$scope.bookings,_i=i=0,len=ref.length;i<len;_i=++i)oldb=ref[_i],oldb.id===b.id&&($scope.bookings[_i]=b);return $scope.purchase.bookings=$scope.bookings,$scope.item_details_updated=!0,$scope.setLoaded($scope)},function(_this){return function(err){return $scope.setLoaded($scope)}}(this))},$scope.editItem=function(){return $scope.item_details_updated=!1}}])}.call(this),function(){angular.module("BB.Directives").directive("bbLogin",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Login"}}),angular.module("BB.Controllers").controller("Login",["$scope","$rootScope","LoginService","$q","ValidatorService","BBModel","$location","AlertService",function($scope,$rootScope,LoginService,$q,ValidatorService,BBModel,$location,AlertService){return $scope.controller="public.controllers.Login",$scope.validator=ValidatorService,$scope.login_form={},$scope.login_sso=function(token,route){return $rootScope.connection_started.then(function(_this){return function(){return LoginService.ssoLogin({company_id:$scope.bb.company.id,root:$scope.bb.api_url},{token:token}).then(function(member){if(route)return $scope.showPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.login_with_password=function(email,password){return LoginService.companyLogin($scope.bb.company,{},{email:email,password:password}).then(function(_this){return function(member){return $scope.member=new BBModel.Member.Member(member)}}(this),function(_this){return function(err){return AlertService.raise("LOGIN_FAILED")}}(this))},$scope.showEmailPasswordReset=function(_this){return function(){return $scope.showPage("email_reset_password")}}(this),$scope.isLoggedIn=function(){return LoginService.isLoggedIn()},$scope.sendPasswordReset=function(email){return LoginService.sendPasswordReset($scope.bb.company,{email:email,custom:!0}).then(function(){return AlertService.raise("PASSWORD_RESET_REQ_SUCCESS")},function(_this){return function(err){return AlertService.raise("PASSWORD_RESET_REQ_FAILED")}}(this))},$scope.updatePassword=function(new_password,confirm_new_password){return AlertService.clear(),$rootScope.member&&new_password&&confirm_new_password&&new_password===confirm_new_password?LoginService.updatePassword($rootScope.member,{new_password:new_password,confirm_new_password:confirm_new_password,persist_login:$scope.login_form.persist_login}).then(function(_this){return function(member){if(member)return $scope.setClient(member),$scope.password_updated=!0,AlertService.raise("PASSWORD_RESET_SUCESS")}}(this),function(_this){return function(err){return $scope.error=err,AlertService.raise("PASSWORD_RESET_FAILED")}}(this)):AlertService.raise("PASSWORD_MISMATCH")}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMap",function(){return{restrict:"A",replace:!0,scope:!0,controller:"MapCtrl"}}),angular.module("BB.Controllers").controller("MapCtrl",["$scope","$element","$attrs","$rootScope","AlertService","FormDataStoreService","$q","$window","$timeout","SettingsService",function($scope,$element,$attrs,$rootScope,AlertService,FormDataStoreService,$q,$window,$timeout,SettingsService){var cc,checkDataStore,du,filterByService,geolocateFail,haversine,mapInit,map_ready_def,reverseGeocode,searchFailed,searchPlaces,searchSuccess,setAnswers,setMarkers;return $scope.controller="public.controllers.MapCtrl",FormDataStoreService.init("MapCtrl",$scope,["address","selectedStore","search_prms"]),$scope.options=$scope.$eval($attrs.bbMap)||{},$scope.num_search_results=$scope.options.num_search_results||6,$scope.range_limit=$scope.options.range_limit||1/0,$scope.hide_not_live_stores=$scope.options.hide_not_live_stores||!1,$scope.can_filter_by_service=$scope.options.filter_by_service||!1,$scope.filter_by_service=$scope.options.filter_by_service||!1,$scope.default_zoom=$scope.options.default_zoom||6,cc=SettingsService.getCountryCode(),du=_.contains(["gb","us","jp"],cc)?"miles":"km",$scope.distance_unit=du,map_ready_def=$q.defer(),$scope.mapLoaded=$q.defer(),$scope.mapReady=map_ready_def.promise,$scope.map_init=$scope.mapLoaded.promise,$scope.showAllMarkers=!1,$scope.mapMarkers=[],$scope.shownMarkers=$scope.shownMarkers||[],$scope.numberedPin||($scope.numberedPin=null),$scope.defaultPin||($scope.defaultPin=null),!$scope.address&&$attrs.bbAddress&&($scope.address=$scope.$eval($attrs.bbAddress)),$scope.notLoaded($scope),webshim.setOptions({waitReady:!1,loadStyles:!1}),webshim.polyfill("geolocation"),$rootScope.connection_started.then(function(){var comp,i,key,latlong,len,ref,ref1,value;if($scope.selectedStore||$scope.setLoaded($scope),!$scope.bb.company.companies)return $rootScope.parent_id?void $scope.initWidget({company_id:$rootScope.parent_id,first_page:$scope.bb.current_page,keep_basket:!0,item_defaults:$scope.bb.item_defaults?$scope.bb.item_defaults:{}}):void $scope.initWidget({company_id:$scope.bb.company.id,first_page:null});for($rootScope.parent_id=$scope.bb.company.id,$scope.companies=$scope.bb.company.companies,$scope.companies&&0!==$scope.companies.length||($scope.companies=[$scope.bb.company]),$scope.bb.current_item.service&&$scope.options&&$scope.options.filter_by_service?($scope.notLoaded($scope),filterByService().then(function(){return $scope.map_init.then(function(){return mapInit()})})):$scope.map_init.then(function(){return mapInit()}),$scope.mapBounds=new google.maps.LatLngBounds,ref=$scope.companies,i=0,len=ref.length;i<len;i++)comp=ref[i],comp.address&&comp.address.lat&&comp.address["long"]&&(latlong=new google.maps.LatLng(comp.address.lat,comp.address["long"]),$scope.mapBounds.extend(latlong));if($scope.mapOptions={center:$scope.mapBounds.getCenter(),zoom:$scope.default_zoom,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,mapTypeControlOptions:{style:window.google.maps.MapTypeControlStyle.DROPDOWN_MENU}},$scope.options&&$scope.options.map_options){ref1=$scope.options.map_options;for(key in ref1)value=ref1[key],$scope.mapOptions[key]=value}return map_ready_def.resolve(!0)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),filterByService=function(){var deferred;return deferred=$q.defer(),$scope.bb.selected_service.$has("all_children")?$scope.bb.selected_service.$get("all_children").then(function(resource){return resource.$get("services").then(function(services){var company,company_ids,i,len,ref,results1,service;for(company_ids=_.map(services,function(service){return service.company_id}),ref=$scope.companies,results1=[],i=0,len=ref.length;i<len;i++)company=ref[i],company.has_service=_.contains(company_ids,company.id),service=_.find(services,function(service){return service.company_id===company.id}),company.service=service,results1.push(deferred.resolve());return results1})}):deferred.resolve(),deferred.promise},$scope.filterByService=function(){var i,len,marker,ref;for(ref=$scope.shownMarkers,i=0,len=ref.length;i<len;i++)marker=ref[i],marker.setMap(null);return $scope.options&&$scope.filter_by_service?$scope.shownMarkers=$scope.shown_markers_with_services:$scope.shownMarkers=$scope.shown_markers,$timeout(function(){return setMarkers()})},mapInit=function(){var comp,i,latlong,len,marker,ref;for(ref=$scope.companies,i=0,len=ref.length;i<len;i++)comp=ref[i],comp.address&&comp.address.lat&&comp.address["long"]&&(latlong=new google.maps.LatLng(comp.address.lat,comp.address["long"]),marker=new google.maps.Marker({map:$scope.myMap,position:latlong,visible:$scope.showAllMarkers,icon:$scope.defaultPin}),marker.company=comp,$scope.hide_not_live_stores&&!comp.live||$scope.mapMarkers.push(marker));return $timeout(function(){if($scope.myMap.fitBounds($scope.mapBounds),$scope.myMap.setZoom(15),$scope.bb.current_item.service&&$scope.options&&$scope.filter_by_service)return $scope.setLoaded($scope)}),checkDataStore()},checkDataStore=function(){if($scope.selectedStore)return $scope.notLoaded($scope),$scope.search_prms?$scope.searchAddress($scope.search_prms):$scope.geolocate(),google.maps.event.addListenerOnce($scope.myMap,"idle",function(){return _.each($scope.mapMarkers,function(marker){if($scope.selectedStore.id===marker.company.id)return google.maps.event.trigger(marker,"click")})})},$scope.title=function(){var ci,p1;return ci=$scope.bb.current_item,p1=ci.category&&ci.category.description?ci.category.description:$scope.bb.company.extra.department,p1+" - "+$scope.$eval("getCurrentStepTitle()")},$scope.searchAddress=function(prms){return(!$scope.reverse_geocode_address||$scope.reverse_geocode_address!==$scope.address)&&(delete $scope.geocoder_result,prms||(prms={}),$scope.search_prms=prms,$scope.map_init.then(function(){var address,ne,req,sw;if(address=$scope.address,prms.address&&(address=prms.address),address)return req={address:address},prms.region&&(req.region=prms.region),prms.componentRestrictions&&(req.componentRestrictions=prms.componentRestrictions),prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),req.bounds=new google.maps.LatLngBounds(sw,ne)),(new google.maps.Geocoder).geocode(req,function(results,status){return results.length>0&&"OK"===status&&($scope.geocoder_result=results[0]),!$scope.geocoder_result||$scope.geocoder_result&&$scope.geocoder_result.partial_match?void searchPlaces(req):($scope.geocoder_result?searchSuccess($scope.geocoder_result):searchFailed(),$scope.setLoaded($scope))})}),$scope.setLoaded($scope))},searchPlaces=function(prms){var req,service;return req={query:prms.address,types:["shopping_mall","store","embassy"]},prms.bounds&&(req.bounds=prms.bounds),service=new google.maps.places.PlacesService($scope.myMap),service.textSearch(req,function(results,status){return results.length>0&&"OK"===status?searchSuccess(results[0]):$scope.geocoder_result?searchSuccess($scope.geocoder_result):searchFailed()})},searchSuccess=function(result){return AlertService.clear(),$scope.search_failed=!1,$scope.loc=result.geometry.location,$scope.myMap.setCenter($scope.loc),$scope.myMap.setZoom(15),$scope.showClosestMarkers($scope.loc),$rootScope.$broadcast("map:search_success")},searchFailed=function(){return $scope.search_failed=!0,AlertService.raise("LOCATION_NOT_FOUND"),$rootScope.$apply()},$scope.validateAddress=function(form){return!!form&&(!form.$error.required||(AlertService.clear(),AlertService.raise("MISSING_LOCATION"),!1))},haversine=function(latlong,marker){var R,a,c,chLat,chLon,d,dLat,dLon,lat1,lat2,lon1,lon2,pi,rLat1,rLat2;return pi=Math.PI,R=6371,lat1=latlong.lat(),lon1=latlong.lng(),lat2=marker.position.lat(),lon2=marker.position.lng(),chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c},$scope.showClosestMarkers=function(latlong){var distances,distances_with_services,i,km,len,marker,ref;for(distances=[],distances_with_services=[],ref=$scope.mapMarkers,i=0,len=ref.length;i<len;i++)marker=ref[i],km=haversine(latlong,marker),$scope.showAllMarkers||marker.setVisible(!1),marker.distance=km,"miles"===$scope.distance_unit&&(marker.distance*=.621371192),marker.distance<$scope.range_limit&&(distances.push(marker),marker.company.has_service&&distances_with_services.push(marker));return distances.sort(function(a,b){return a.distance-b.distance}),distances_with_services.sort(function(a,b){return a.distance-b.distance}),$scope.shown_markers=distances.slice(0,$scope.num_search_results),$scope.shown_markers_with_services=distances_with_services.slice(0,$scope.num_search_results),$scope.options&&$scope.filter_by_service?$scope.shownMarkers=$scope.shown_markers_with_services:$scope.shownMarkers=$scope.shown_markers,$timeout(function(){return setMarkers()})},setMarkers=function(){var i,iconPath,index,latlong,len,localBounds,marker,open_marker,open_marker_index,ref;for(latlong=$scope.loc,localBounds=new google.maps.LatLngBounds,localBounds.extend(latlong),index=1,ref=$scope.shownMarkers,i=0,len=ref.length;i<len;i++)marker=ref[i],$scope.numberedPin&&(iconPath=$window.sprintf($scope.numberedPin,index),marker.setIcon(iconPath)),marker.setVisible(!0),marker.setMap($scope.myMap),localBounds.extend(marker.position),index+=1;return $scope.$emit("map:shown_markers_updated",$scope.shownMarkers),google.maps.event.trigger($scope.myMap,"resize"),$scope.myMap.fitBounds(localBounds),open_marker_index=0,open_marker=_.find($scope.shownMarkers,function(obj){return open_marker_index++,obj.company.id===$scope.bb.current_item.company.id}),open_marker?open_marker_index--:open_marker_index=0,$scope.shownMarkers[open_marker_index].is_open=!0,$scope.openMarkerInfo($scope.shownMarkers[open_marker_index])},$scope.openMarkerInfo=function(marker){return $timeout(function(){return $scope.currentMarker=marker,$scope.myInfoWindow.open($scope.myMap,marker)},250)},$scope.selectItem=function(company,route){var init_obj;if($scope.$debounce(1e3))return company?($scope.notLoaded($scope),$scope.selectedStore&&$scope.selectedStore.id!==company.id&&$scope.$emit("change:storeLocation"),$scope.selectedStore=company,$scope.bb.current_item.item_details&&$scope.bb.current_item.item_details.questions&&setAnswers(),company.service&&($scope.bb.item_defaults.service=company.service.id),init_obj={company_id:company.id,item_defaults:$scope.bb.item_defaults},route&&(init_obj.first_page=route),$scope.initWidget(init_obj)):void AlertService.warning(ErrorService.getError("STORE_NOT_SELECTED"))},setAnswers=function(){var answers,i,len,q,ref;for(answers={},ref=$scope.bb.current_item.item_details.questions,i=0,len=ref.length;i<len;i++)q=ref[i],answers["q_"+q.name]=q.answer;if(!_.isEmpty(answers))return $scope.bb.item_defaults.answers=answers},$scope.roundNumberUp=function(num,places){return Math.round(num*Math.pow(10,places))/Math.pow(10,places)},$scope.geolocate=function(){return!(!navigator.geolocation||$scope.reverse_geocode_address&&$scope.reverse_geocode_address===$scope.address)&&($scope.notLoaded($scope),webshim.ready("geolocation",function(){var options;return options={timeout:5e3,maximumAge:36e5},navigator.geolocation.getCurrentPosition(reverseGeocode,geolocateFail,options)}))},geolocateFail=function(error){switch(error.code){case 2:case 3:$scope.setLoaded($scope),AlertService.raise("GEOLOCATION_ERROR");break;default:$scope.setLoaded($scope)}return $scope.$apply()},reverseGeocode=function(position){var lat,latlng,long;return lat=parseFloat(position.coords.latitude),long=parseFloat(position.coords.longitude),latlng=new google.maps.LatLng(lat,long),(new google.maps.Geocoder).geocode({latLng:latlng},function(results,status){var ac,i,len,ref;if(results.length>0&&"OK"===status){for($scope.geocoder_result=results[0],ref=$scope.geocoder_result.address_components,i=0,len=ref.length;i<len;i++)ac=ref[i],ac.types.indexOf("route")>=0&&($scope.reverse_geocode_address=ac.long_name),ac.types.indexOf("locality")>=0&&($scope.reverse_geocode_address+=", "+ac.long_name),$scope.address=$scope.reverse_geocode_address;searchSuccess($scope.geocoder_result)}return $scope.setLoaded($scope)})},$scope.increaseRange=function(){return $scope.range_limit=1/0,$scope.searchAddress($scope.search_prms)},$scope.$watch("display.xs",function(_this){return function(new_value,old_value){if(new_value!==old_value&&$scope.loc)return $scope.myInfoWindow.close(),$scope.myMap.setCenter($scope.loc),$scope.myMap.setZoom(15),$scope.showClosestMarkers($scope.loc)}}(this)),$rootScope.$on("widget:restart",function(){return $scope.loc=null,$scope.reverse_geocode_address=null,$scope.address=null})}])}.call(this),function(){angular.module("BB.Directives").directive("bbMembershipLevels",["$rootScope","MembershipLevelsService",function($rootScope,MembershipLevelsService){var controller;return controller=function($scope,$element,$attrs){var checkClientDefaults;return $rootScope.connection_started.then(function(){return $scope.initialise()}),$scope.initialise=function(){if($scope.bb.company&&$scope.bb.company.$has("member_levels"))return $scope.notLoaded($scope),MembershipLevelsService.getMembershipLevels($scope.bb.company).then(function(member_levels){return $scope.setLoaded($scope),$scope.membership_levels=member_levels},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.selectMemberLevel=function(level){if(level&&$scope.client&&($scope.client.member_level_id=level.id,!$scope.$parent.$has_page_control))return $scope.decideNextPage()},checkClientDefaults=function(){var i,len,membership_level,ref,results;if($scope.bb.client_defaults.membership_ref){for(ref=$scope.membership_levels,results=[],i=0,len=ref.length;i<len;i++)membership_level=ref[i],membership_level.name===$scope.bb.client_defaults.membership_ref?results.push($scope.selectMemberLevel(membership_level)):results.push(void 0);return results}},$scope.setReady=function(){return!!$scope.client.member_level_id},$scope.getMembershipLevel=function(member_level_id){return _.find($scope.membership_levels,function(level){return level.id===member_level_id})}}}])}.call(this),function(){"use strict";var hasProp={}.hasOwnProperty;angular.module("BB.Directives").directive("bbMultiServiceSelect",function(){return{restrict:"AE",scope:!0,controller:"MultiServiceSelect"}}),angular.module("BB.Controllers").controller("MultiServiceSelect",["$scope","$rootScope","$q","$attrs","BBModel","AlertService","CategoryService","FormDataStoreService","$modal",function($scope,$rootScope,$q,$attrs,BBModel,AlertService,CategoryService,FormDataStoreService,$modal){var checkItemDefaults,initialise,initialiseCategories;return FormDataStoreService.init("MultiServiceSelect",$scope,["selected_category_name"]),$scope.options=$scope.$eval($attrs.bbMultiServiceSelect)||{},$scope.options.max_services=$scope.options.max_services||1/0,$scope.options.ordered_categories=$scope.options.ordered_categories||!1,$scope.options.services=$scope.options.services||"items",$rootScope.connection_started.then(function(){return $scope.bb.company.$has("parent")&&!$scope.bb.company.$has("company_questions")?$scope.bb.company.getParentPromise().then(function(parent){return $scope.company=parent,initialise()}):$scope.company=$scope.bb.company,$scope.$watch($scope.options.services,function(newval,oldval){if(newval&&angular.isArray(newval))return $scope.items=newval,initialise()})}),initialise=function(){var promises;if($scope.items&&$scope.company)return $scope.initialised=!0,promises=[],promises.push(CategoryService.query($scope.bb.company)),$scope.company.$has("company_questions")&&promises.push($scope.company.getCompanyQuestionsPromise()),$q.all(promises).then(function(result){var item,j,k,len,len1,ref,ref1,stacked_item;if($scope.company_questions=result[1],initialiseCategories(result[0]),$scope.bb.stacked_items&&$scope.bb.stacked_items.length>0){for(ref=$scope.bb.stacked_items,j=0,len=ref.length;j<len;j++)for(stacked_item=ref[j],ref1=$scope.items,k=0,len1=ref1.length;k<len1;k++)if(item=ref1[k],item.self===stacked_item.service.self){stacked_item.service=item,stacked_item.service.selected=!0;break}}else checkItemDefaults();return $scope.bb.moving_booking&&$scope.nextStep(),$scope.$broadcast("multi_service_select:loaded"),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},checkItemDefaults=function(){var j,len,ref,service;if($scope.bb.item_defaults.service)for(ref=$scope.items,j=0,len=ref.length;j<len;j++)if(service=ref[j],service.self===$scope.bb.item_defaults.service.self)return void $scope.addItem(service)},initialiseCategories=function(categories){var all_categories,category,category_details,category_id,grouped_sub_categories,grouped_sub_category,j,k,key,len,len1,results,services,sub_categories,sub_category,value;if($scope.options.ordered_categories)for(j=0,len=categories.length;j<len;j++)category=categories[j],category.order=parseInt(category.name.slice(0,2)),category.name=category.name.slice(3);$scope.all_categories=_.indexBy(categories,"id"),all_categories=_.groupBy($scope.items,function(item){return item.category_id}),sub_categories=_.findWhere($scope.company_questions,{name:"Extra Category"}),sub_categories&&(sub_categories=_.map(sub_categories.question_items,function(sub_category){return sub_category.name})),categories={};for(key in all_categories)hasProp.call(all_categories,key)&&(value=all_categories[key],value.length>0&&(categories[key]=value));$scope.categories=[],results=[];for(category_id in categories){if(services=categories[category_id],category={},grouped_sub_categories=[],sub_categories){for(k=0,len1=sub_categories.length;k<len1;k++)sub_category=sub_categories[k],grouped_sub_category={name:sub_category,services:_.filter(services,function(service){return service.extra.extra_category===sub_category})},grouped_sub_category.services.length>0&&grouped_sub_categories.push(grouped_sub_category);category.sub_categories=grouped_sub_categories}else category.services=services;$scope.all_categories[category_id]&&(category_details={name:$scope.all_categories[category_id].name,description:$scope.all_categories[category_id].description}),category.name=category_details.name,category.description=category_details.description,$scope.options.ordered_categories&&$scope.all_categories[category_id]&&(category.order=$scope.all_categories[category_id].order),$scope.categories.push(category),$scope.selected_category_name&&$scope.selected_category_name===category_details.name?results.push($scope.selected_category=$scope.categories[$scope.categories.length-1]):$scope.bb.item_defaults.category&&$scope.bb.item_defaults.category.name===category_details.name&&!$scope.selected_category?($scope.selected_category=$scope.categories[$scope.categories.length-1],results.push($scope.selected_category_name=$scope.selected_category.name)):results.push(void 0)}return results},$scope.changeCategory=function(category_name,services){if(category_name&&services)return $scope.selected_category={name:category_name,sub_categories:services},$scope.selected_category_name=$scope.selected_category.name,$rootScope.$broadcast("multi_service_select:category_changed")},$scope.changeCategoryName=function(){return $scope.selected_category_name=$scope.selected_category.name,$rootScope.$broadcast("multi_service_select:category_changed")},$scope.addItem=function(item,duration){var i,iitem,j,len,ref,results;if(!($scope.bb.stacked_items.length<$scope.options.max_services)){for(ref=$scope.items,results=[],j=0,len=ref.length;j<len;j++)i=ref[j],i.popover="Sorry, you can only book a maximum of "+$scope.options.max_services+" treatments",results.push(i.popoverText=i.popover);return results}if($scope.bb.clearStackedItemsDateTime(),item.selected=!0,iitem=new BBModel.BasketItem(null,$scope.bb),iitem.setDefaults($scope.bb.item_defaults),iitem.setService(item),duration&&iitem.setDuration(duration),iitem.setGroup(item.group),$scope.bb.stackItem(iitem),$rootScope.$broadcast("multi_service_select:item_added"),$scope.options.raise_alerts)return AlertService.info({msg:item.name+" added to your treatment selection",persist:!1})},$scope.removeItem=function(item,options){var i,j,len,ref,results;for(item.selected=!1,options&&"BasketItem"===options.type?$scope.bb.deleteStackedItem(item):$scope.bb.deleteStackedItemByService(item),$scope.bb.clearStackedItemsDateTime(),$rootScope.$broadcast("multi_service_select:item_removed"),ref=$scope.items,results=[],j=0,len=ref.length;j<len;j++){if(i=ref[j],i.self===item.self){i.selected=!1;break}results.push(void 0)}return results},$scope.removeStackedItem=function(item){return $scope.removeItem(item,{type:"BasketItem"})},$scope.nextStep=function(){return $scope.bb.stacked_items.length>1?$scope.decideNextPage():1===$scope.bb.stacked_items.length?($scope.bb.basket&&$scope.bb.basket.items.length>0&&$scope.quickEmptybasket({preserve_stacked_items:!0}),$scope.setBasketItem($scope.bb.stacked_items[0]),$scope.decideNextPage()):(AlertService.clear(),AlertService.add("danger",{msg:"You need to select at least one treatment to continue"}))},$scope.addService=function(){return $rootScope.$broadcast("multi_service_select:add_item")},$scope.setReady=function(){return $scope.bb.stacked_items.length>1||(1===$scope.bb.stacked_items.length?($scope.bb.basket&&$scope.bb.basket.items.length>0&&$scope.quickEmptybasket({preserve_stacked_items:!0}),$scope.setBasketItem($scope.bb.stacked_items[0]),!0):(AlertService.clear(),AlertService.add("danger",{msg:"You need to select at least one treatment to continue"}),!1))},$scope.selectDuration=function(service){var modalInstance;return 1===service.durations.length?$scope.addItem(service):(modalInstance=$modal.open({templateUrl:$scope.getPartial("_select_duration_modal"),scope:$scope,controller:["$scope","$modalInstance","service",function($scope,$modalInstance,service){return $scope.durations=service.durations,$scope.duration=$scope.durations[0],$scope.service=service,$scope.cancel=function(){
return $modalInstance.dismiss("cancel")},$scope.setDuration=function(){return $modalInstance.close({service:$scope.service,duration:$scope.duration})}}],resolve:{service:function(){return service}}}),modalInstance.result.then(function(result){return $scope.addItem(result.service,result.duration)}))}}])}.call(this),function(){"use strict";var hasProp={}.hasOwnProperty;angular.module("BB.Directives").directive("bbTimeRangeStacked",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"TimeRangeListStackedController"}}),angular.module("BB.Controllers").controller("TimeRangeListStackedController",["$scope","$element","$attrs","$rootScope","$q","TimeService","AlertService","BBModel","FormDataStoreService","PersonService","PurchaseService","DateTimeUtilitiesService",function($scope,$element,$attrs,$rootScope,$q,TimeService,AlertService,BBModel,FormDataStoreService,PersonService,PurchaseService,DateTimeUtilitiesService){var isSubtractValid,setEnabledSlots,setTimeRange,spliceExistingDateTimes,updateHideStatus;return $scope.controller="public.controllers.TimeRangeListStacked",FormDataStoreService.init("TimeRangeListStacked",$scope,["selected_slot","original_start_date","start_at_week_start"]),$scope.notLoaded($scope),$scope.available_times=0,$rootScope.connection_started.then(function(){var diff,selected_day,start_date;return $scope.options=$scope.$eval($attrs.bbTimeRangeStacked)||{},$scope.time_range_length||(null!=$attrs.bbTimeRangeLength?$scope.time_range_length=$scope.$eval($attrs.bbTimeRangeLength):$scope.options&&$scope.options.time_range_length?$scope.time_range_length=$scope.options.time_range_length:$scope.time_range_length=7),(null!=$attrs.bbDayOfWeek||$scope.options&&$scope.options.day_of_week)&&($scope.day_of_week=null!=$attrs.bbDayOfWeek?$scope.$eval($attrs.bbDayOfWeek):$scope.options.day_of_week),(null!=$attrs.bbSelectedDay||$scope.options&&$scope.options.selected_day)&&(selected_day=null!=$attrs.bbSelectedDay?moment($scope.$eval($attrs.bbSelectedDay)):moment($scope.options.selected_day),moment.isMoment(selected_day)&&($scope.selected_day=selected_day)),!$scope.start_date&&$scope.last_selected_date?$scope.original_start_date?(diff=$scope.last_selected_date.diff($scope.original_start_date,"days"),diff%=$scope.time_range_length,diff=0===diff?diff:diff+1,start_date=$scope.last_selected_date.clone().subtract(diff,"days"),setTimeRange($scope.last_selected_date,start_date)):setTimeRange($scope.last_selected_date):$scope.bb.stacked_items[0].date?setTimeRange($scope.bb.stacked_items[0].date.date):$scope.selected_day?($scope.original_start_date=$scope.original_start_date||moment($scope.selected_day),setTimeRange($scope.selected_day)):($scope.start_at_week_start=!0,setTimeRange(moment())),$scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),setTimeRange=function(selected_date,start_date){return start_date?$scope.start_date=start_date:$scope.day_of_week?$scope.start_date=selected_date.clone().day($scope.day_of_week):$scope.start_at_week_start?$scope.start_date=selected_date.clone().startOf("week"):$scope.start_date=selected_date.clone(),$scope.selected_day=selected_date,$scope.selected_date=$scope.selected_day.toDate(),isSubtractValid()},$scope.add=function(amount,type){switch($scope.selected_day=moment($scope.selected_date),type){case"days":setTimeRange($scope.selected_day.add(amount,"days"));break;case"weeks":$scope.start_date.add(amount,"weeks"),setTimeRange($scope.start_date)}return $scope.loadData()},$scope.subtract=function(amount,type){return $scope.add(-amount,type)},isSubtractValid=function(){var diff;return $scope.is_subtract_valid=!0,diff=Math.ceil($scope.selected_day.diff(moment(),"day",!0)),$scope.subtract_length=diff<$scope.time_range_length?diff:$scope.time_range_length,diff<=0&&($scope.is_subtract_valid=!1),$scope.subtract_length>1?$scope.subtract_string="Prev "+$scope.subtract_length+" days":1===$scope.subtract_length?$scope.subtract_string="Prev day":$scope.subtract_string="Prev"},$scope.selectedDateChanged=function(){return setTimeRange(moment($scope.selected_date)),$scope.selected_slot=null,$scope.loadData()},updateHideStatus=function(){var day,key,ref,results;ref=$scope.days,results=[];for(key in ref)day=ref[key],results.push($scope.days[key].hide=!day.date.isSame($scope.selected_day,"day"));return results},$scope.isPast=function(){return!$scope.start_date||moment().isAfter($scope.start_date)},$scope.status=function(day,slot){var status;if(slot)return status=slot.status()},$scope.highlightSlot=function(slot,day){var i,item,len,ref;if(day&&slot&&slot.availability()>0){for($scope.bb.clearStackedItemsDateTime(),$scope.selected_slot&&($scope.selected_slot.selected=!1),$scope.setLastSelectedDate(day.date),$scope.selected_slot=angular.copy(slot),$scope.selected_day=day.date,$scope.selected_date=day.date.toDate(),$scope.$broadcast("slotChanged",day,slot);slot;)for(ref=$scope.bb.stacked_items,i=0,len=ref.length;i<len;i++)if(item=ref[i],item.service.self===slot.service.self&&!item.date&&!item.time){item.setDate(day),item.setTime(slot),slot=slot.next;break}return updateHideStatus(),$rootScope.$broadcast("time:selected")}},$scope.loadData=function(){var edate,grouped_items,i,items,len,pslots;if($scope.notLoaded($scope),$scope.request&&$scope.request.start.twix($scope.request.end).contains($scope.selected_day))return updateHideStatus(),void $scope.setLoaded($scope);for($scope.start_date=moment($scope.start_date),edate=moment($scope.start_date).add($scope.time_range_length,"days"),$scope.end_date=moment(edate).add(-1,"days"),$scope.request={start:moment($scope.start_date),end:moment($scope.end_date)},pslots=[],grouped_items=_.groupBy($scope.bb.stacked_items,function(item){return item.service.id}),grouped_items=_.toArray(grouped_items),i=0,len=grouped_items.length;i<len;i++)items=grouped_items[i],pslots.push(TimeService.query({company:$scope.bb.company,cItem:items[0],date:$scope.start_date,end_date:$scope.end_date,client:$scope.client,available:1}));return $q.all(pslots).then(function(res){var _i,day,item,j,k,l,len1,len2,ref,slots,times,v;for($scope.data_valid=!0,$scope.days={},_i=j=0,len1=grouped_items.length;j<len1;_i=++j)for(items=grouped_items[_i],slots=res[_i],slots&&0!==slots.length||($scope.data_valid=!1),l=0,len2=items.length;l<len2;l++){item=items[l],spliceExistingDateTimes(item,slots),item.slots={};for(day in slots)hasProp.call(slots,day)&&(times=slots[day],item.slots[day]=_.indexBy(times,"time"))}if($scope.data_valid){ref=res[0];for(k in ref)v=ref[k],$scope.days[k]={date:moment(k)};setEnabledSlots(),updateHideStatus(),$rootScope.$broadcast("TimeRangeListStacked:loadFinished")}return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},spliceExistingDateTimes=function(stacked_item,slots){var datetime,time,time_slot;if(stacked_item.datetime||stacked_item.date)return datetime=stacked_item.datetime||DateTimeUtilitiesService.convertTimeSlotToMoment(stacked_item.date.date,stacked_item.time),$scope.start_date<=datetime&&$scope.end_date>=datetime?(time=DateTimeUtilitiesService.convertMomentToTime(datetime),time_slot=_.findWhere(slots[datetime.toISODate()],{time:time}),time_slot||(time_slot=stacked_item.time,slots[datetime.toISODate()].splice(0,0,time_slot)),time_slot.selected=stacked_item.self===$scope.bb.stacked_items[0].self):void 0},setEnabledSlots=function(){var day,day_data,isSlotValid,ref,results,slot,time;ref=$scope.days,results=[];for(day in ref)day_data=ref[day],day_data.slots={},$scope.bb.stacked_items.length>1?results.push(function(){var ref1,results1;ref1=$scope.bb.stacked_items[0].slots[day],results1=[];for(time in ref1)slot=ref1[time],slot=angular.copy(slot),isSlotValid=function(slot){var duration,i,index,next,ref2,valid;for(valid=!1,time=slot.time,duration=$scope.bb.stacked_items[0].service.duration,next=time+duration,index=i=1,ref2=$scope.bb.stacked_items.length-1;1<=ref2?i<=ref2:i>=ref2;index=1<=ref2?++i:--i){if(_.isEmpty($scope.bb.stacked_items[index].slots[day])||!$scope.bb.stacked_items[index].slots[day][next])return!1;slot.next=angular.copy($scope.bb.stacked_items[index].slots[day][next]),slot=slot.next,next+=$scope.bb.stacked_items[index].service.duration}return!0},isSlotValid(slot)?results1.push(day_data.slots[slot.time]=slot):results1.push(void 0);return results1}()):results.push(function(){var ref1,results1;ref1=$scope.bb.stacked_items[0].slots[day],results1=[];for(time in ref1)slot=ref1[time],results1.push(day_data.slots[slot.time]=slot);return results1}());return results},$scope.pretty_month_title=function(month_format,year_format,seperator){var month_year_format,start_date;if(null==seperator&&(seperator="-"),$scope.start_date)return month_year_format=month_format+" "+year_format,$scope.start_date&&$scope.end_date&&$scope.end_date.isAfter($scope.start_date,"month")?(start_date=$scope.start_date.format(month_format),11===$scope.start_date.month()&&(start_date=$scope.start_date.format(month_year_format)),start_date+" "+seperator+" "+$scope.end_date.format(month_year_format)):$scope.start_date.format(month_year_format)},$scope.confirm=function(route,options){var booking,different,found,i,item,j,l,len,len1,len2,prom,ref,ref1,ref2;for(null==options&&(options={}),ref=$scope.bb.stacked_items,i=0,len=ref.length;i<len;i++)if(item=ref[i],!item.time)return AlertService.add("danger",{msg:"Select a time to continue your booking"}),!1;if(null!=$scope.bb.moving_booking&&null!=$scope.bb.moving_booking.bookings){for(different=!1,ref1=$scope.bb.moving_booking.bookings,j=0,len1=ref1.length;j<len1;j++){for(booking=ref1[j],found=!1,ref2=$scope.bb.stacked_items,l=0,len2=ref2.length;l<len2;l++)item=ref2[l],booking.getDateString()===item.date.string_date&&booking.getTimeInMins()===item.time.time&&booking.category_name===item.category_name&&(found=!0);if(!found){different=!0;break}}if(!different)return AlertService.add("danger",{msg:"Your treatments are already booked for this time."}),!1}return $scope.bb.basket.clear(),$scope.bb.pushStackToBasket(),$scope.bb.moving_booking?($scope.notLoaded($scope),prom=PurchaseService.update({purchase:$scope.bb.moving_booking,bookings:$scope.bb.basket.items}),void prom.then(function(purchase){return purchase.getBookingsPromise().then(function(bookings){var _i,len3,m,oldb,results;for(results=[],m=0,len3=bookings.length;m<len3;m++)booking=bookings[m],$scope.bookings?results.push(function(){var len4,n,ref3,results1;for(ref3=$scope.bookings,results1=[],_i=n=0,len4=ref3.length;n<len4;_i=++n)oldb=ref3[_i],oldb.id===booking.id?results1.push($scope.bookings[_i]=booking):results1.push(void 0);return results1}()):results.push(void 0);return results}),$scope.setLoaded($scope),$scope.bb.current_item.move_done=!0,$scope.decideNextPage()},function(err){return $scope.setLoaded($scope),AlertService.add("danger",{msg:"Failed to move booking"})})):($scope.notLoaded($scope),options.do_not_route?$scope.updateBasket():$scope.updateBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},$scope.setReady=function(){return $scope.confirm("",{do_not_route:!0})}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPackageItems",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PackageItem"}}),angular.module("BB.Controllers").controller("PackageItem",["$scope","$rootScope","PackageItemService",function($scope,$rootScope,PackageItemService){return $scope.controller="public.controllers.PackageItem",$rootScope.connection_started.then(function(){if($scope.bb.company)return $scope.init($scope.bb.company)}),$scope.init=function(company){return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),PackageItemService.query(company).then(function(package_items){return $scope.packages=package_items})},$scope.selectItem=function(item,route){return $scope.$parent.$has_page_control?($scope["package"]=item,!1):($scope.booking_item.setPackageItem(item),$scope.decideNextPage(route),!0)},$scope.setReady=function(){return!!$scope["package"]&&($scope.booking_item.setPackageItem($scope["package"]),!0)},$scope.getPackageServices=function(item){var promise;return!(!item||item.service_list)&&(item.service_list=[],promise=PackageItemService.getPackageServices(item),promise.then(function(services){return item.service_list=services}),!0)}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPackagePicker",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PackagePicker"}}),angular.module("BB.Controllers").controller("PackagePicker",["$scope","$rootScope","$q","TimeService","BBModel",function($scope,$rootScope,$q,TimeService,BBModel){return $scope.controller="public.controllers.PackagePicker",$scope.sel_date=moment().add(1,"days"),$scope.selected_date=$scope.sel_date.toDate(),$scope.picked_time=!1,$scope.$watch("selected_date",function(_this){return function(newv,oldv){return $scope.sel_date=moment(newv),$scope.loadDay()}}(this)),$scope.loadDay=function(_this){return function(){var i,item,len,pslots,ref;for($scope.timeSlots=[],$scope.notLoaded($scope),pslots=[],ref=$scope.stackedItems,i=0,len=ref.length;i<len;i++)item=ref[i],pslots.push(TimeService.query({company:$scope.bb.company,cItem:item,date:$scope.sel_date,client:$scope.client}));return $q.all(pslots).then(function(res){var _i,earliest,j,k,l,latest,len1,len2,len3,len4,len5,m,n,next_earliest,next_latest,ref1,ref2,ref3,ref4,ref5,results,slot;for($scope.setLoaded($scope),$scope.data_valid=!0,$scope.timeSlots=[],ref1=$scope.stackedItems,_i=j=0,len1=ref1.length;j<len1;_i=++j)item=ref1[_i],item.slots=res[_i],item.slots&&0!==item.slots.length||($scope.data_valid=!1),item.order=_i;if($scope.data_valid){for($scope.timeSlots=res,earliest=null,ref2=$scope.stackedItems,k=0,len2=ref2.length;k<len2;k++){for(item=ref2[k],next_earliest=null,ref3=item.slots,l=0,len3=ref3.length;l<len3;l++)slot=ref3[l],earliest&&slot.time<earliest?slot.disable():next_earliest||(next_earliest=slot.time+item.service.duration);earliest=next_earliest}for(latest=null,ref4=$scope.bb.stacked_items.slice(0).reverse(),results=[],m=0,len4=ref4.length;m<len4;m++){for(item=ref4[m],next_latest=null,ref5=item.slots,n=0,len5=ref5.length;n<len5;n++)slot=ref5[n],latest&&slot.time>latest?slot.disable():next_latest=slot.time-item.service.duration;results.push(latest=next_latest)}return results}},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectSlot=function(_this){return function(sel_item,slot){var count,current,i,item,j,k,latest,len,len1,len2,next,ref,ref1,slots,time;for(ref=$scope.stackedItems,count=i=0,len=ref.length;i<len;count=++i)if(item=ref[count],count===sel_item.order){if(item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),item.setTime(slot),next=slot.time+item.service.duration,time=slot.time,slot=null,count>0)for(current=count-1;current>=0;){if(item=$scope.bb.stacked_items[current],latest=time-item.service.duration,!item.time||item.time.time>latest)for(item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),item.setTime(null),ref1=item.slots,j=0,len1=ref1.length;j<len1;j++)slot=ref1[j],slot.time<latest&&item.setTime(slot);time=item.time.time,current-=1}}else if(count>sel_item.order&&(slots=item.slots,item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),slots))for(item.setTime(null),k=0,len2=slots.length;k<len2;k++)slot=slots[k],slot.time>=next&&!item.time&&(item.setTime(slot),next=slot.time+item.service.duration);return $scope.picked_time=!0}}(this),$scope.hasAvailability=function(_this){return function(slots,start_time,end_time){var i,j,k,l,len,len1,len2,len3,slot;if(!slots)return!1;if(start_time&&end_time){for(i=0,len=slots.length;i<len;i++)if(slot=slots[i],slot.time>=start_time&&slot.time<end_time&&slot.availability()>0)return!0}else if(end_time){for(j=0,len1=slots.length;j<len1;j++)if(slot=slots[j],slot.time<end_time&&slot.availability()>0)return!0}else if(start_time){for(k=0,len2=slots.length;k<len2;k++)if(slot=slots[k],slot.time>=start_time&&slot.availability()>0)return!0}else for(l=0,len3=slots.length;l<len3;l++)if(slot=slots[l],slot.availability()>0)return!0}}(this),$scope.confirm=function(_this){return function(){}}(this)}])}.call(this),function(){"use strict";var BBBasicPageCtrl;BBBasicPageCtrl=function($scope,$q,ValidatorService){var isScopeReady;return $scope.controllerClass="public.controllers.PageController",$scope.$has_page_control=!0,$scope.validator=ValidatorService,isScopeReady=function(_this){return function(cscope){var child,children,i,len,ready,ready_list;for(ready_list=[],children=[],child=cscope.$$childHead;child;)children.push(child),child=child.$$nextSibling;for(children.sort(function(a,b){return(a.ready_order||0)>=(b.ready_order||0)?1:-1}),i=0,len=children.length;i<len;i++)child=children[i],ready=isScopeReady(child),angular.isArray(ready)?Array.prototype.push.apply(ready_list,ready):ready_list.push(ready);return cscope.hasOwnProperty("setReady")&&ready_list.push(cscope.setReady()),ready_list}}(this),$scope.checkReady=function(){var checkread,i,len,ready_list,v;if(ready_list=isScopeReady($scope),checkread=$q.defer(),$scope.$checkingReady=checkread.promise,ready_list=ready_list.filter(function(v){return!("boolean"==typeof v&&v)}),!ready_list||0===ready_list.length)return checkread.resolve(),!0;for(i=0,len=ready_list.length;i<len;i++)if(v=ready_list[i],"boolean"==typeof value||!v)return checkread.reject(),!1;return $scope.notLoaded($scope),$q.all(ready_list).then(function(){return $scope.setLoaded($scope),checkread.resolve()},function(err){return $scope.setLoaded($scope)}),!0},$scope.routeReady=function(route){return $scope.$checkingReady?$scope.$checkingReady.then(function(_this){return function(){return $scope.decideNextPage(route)}}(this)):$scope.decideNextPage(route)}},angular.module("BB.Directives").directive("bbPage",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PageController"}}),angular.module("BB.Controllers").controller("PageController",BBBasicPageCtrl),angular.module("BB.Services").value("PageControllerService",BBBasicPageCtrl)}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPayment",["$window","$location","$sce","SettingsService","AlertService",function($window,$location,$sce,SettingsService,AlertService){return{restrict:"AE",replace:!0,scope:!0,controller:"Payment",link:function(scope,element,attributes){var error,getHost,sendLoadEvent;return error=function(scope,message){return scope.error(message)},getHost=function(url){var a;return a=document.createElement("a"),a.href=url,a.protocol+"//"+a.host},sendLoadEvent=function(element,origin,scope){var custom_stylesheet,payload,referrer;return referrer=$location.protocol()+"://"+$location.host(),$location.port()&&(referrer+=":"+$location.port()),scope.payment_options.custom_stylesheet&&(custom_stylesheet=scope.payment_options.custom_stylesheet),payload=JSON.stringify({type:"load",message:referrer,custom_partial_url:scope.bb.custom_partial_url,custom_stylesheet:custom_stylesheet,scroll_offset:SettingsService.getScrollOffset()}),element.find("iframe")[0].contentWindow.postMessage(payload,origin)},scope.payment_options=scope.$eval(attributes.bbPayment)||{},scope.route_to_next_page=null==scope.payment_options.route_to_next_page||scope.payment_options.route_to_next_page,element.find("iframe").bind("load",function(_this){return function(event){var origin,url;return scope.bb&&scope.bb.total&&scope.bb.total.$href("new_payment")&&(url=scope.bb.total.$href("new_payment")),origin=getHost(url),sendLoadEvent(element,origin,scope),scope.$apply(function(){return scope.callSetLoaded()})}}(this)),$window.addEventListener("message",function(_this){return function(event){var data;return angular.isObject(event.data)?data=event.data:event.data.match(/iFrameSizer/)||(data=JSON.parse(event.data)),scope.$apply(function(){if(data)switch(data.type){case"submitting":return scope.callNotLoaded();case"error":return scope.$emit("payment:failed"),scope.callNotLoaded(),AlertService.raise("PAYMENT_FAILED"),document.getElementsByTagName("iframe")[0].src+="";case"payment_complete":return scope.callSetLoaded(),scope.paymentDone()}})}}(this),!1)}}}]),angular.module("BB.Controllers").controller("Payment",["$scope","$rootScope","$q","$location","$window","$sce","$log","$timeout",function($scope,$rootScope,$q,$location,$window,$sce,$log,$timeout){return $scope.controller="public.controllers.Payment",$scope.notLoaded($scope),$scope.purchase&&($scope.bb.total=$scope.purchase),$rootScope.connection_started.then(function(){if($scope.total&&($scope.bb.total=$scope.total),$scope.bb&&$scope.bb.total&&$scope.bb.total.$href("new_payment"))return $scope.url=$sce.trustAsResourceUrl($scope.bb.total.$href("new_payment"))}),$scope.callNotLoaded=function(_this){return function(){return $scope.notLoaded($scope)}}(this),$scope.callSetLoaded=function(_this){return function(){return $scope.setLoaded($scope)}}(this),$scope.paymentDone=function(){if($scope.bb.payment_status="complete",$scope.$emit("payment:complete"),$scope.route_to_next_page)return $scope.decideNextPage()},$scope.error=function(message){return $log.warn("Payment Failure: "+message)}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPayForm",["$window","$timeout","$sce","$http","$compile","$document","$location","SettingsService",function($window,$timeout,$sce,$http,$compile,$document,$location,SettingsService){var applyCustomPartials,applyCustomStylesheet,linker;return applyCustomPartials=function(custom_partial_url,scope,element){if(null!=custom_partial_url)return $document.domain="bookingbug.com",$http.get(custom_partial_url).then(function(custom_templates){return $compile(custom_templates.data)(scope,function(custom,scope){var custom_form,e,i,len;for(i=0,len=custom.length;i<len;i++)e=custom[i],"STYLE"===e.tagName&&element.after(e.outerHTML);if(custom_form=function(){var j,len1,results;for(results=[],j=0,len1=custom.length;j<len1;j++)e=custom[j],"payment_form"===e.id&&results.push(e);return results}(),custom_form&&custom_form[0])return $compile(custom_form[0].innerHTML)(scope,function(compiled_form,scope){var action,form;return form=element.find("form")[0],action=form.action,compiled_form.attr("action",action),$(form).replaceWith(compiled_form)})})})},applyCustomStylesheet=function(href){var css_id,head,link;if(css_id="custom_css",!document.getElementById(css_id))return head=document.getElementsByTagName("head")[0],link=document.createElement("link"),link.id=css_id,link.rel="stylesheet",link.type="text/css",link.href=href,link.media="all",head.appendChild(link),link.onload=function(){if("parentIFrame"in $window)return parentIFrame.size()}},linker=function(scope,element,attributes){return $window.addEventListener("message",function(_this){return function(event){var data;if(angular.isObject(event.data)?data=event.data:angular.isString(event.data)&&!event.data.match(/iFrameSizer/)&&(data=JSON.parse(event.data)),data)switch(data.type){case"load":return scope.$apply(function(){if(scope.referrer=data.message,data.custom_partial_url&&applyCustomPartials(event.data.custom_partial_url,scope,element),data.custom_stylesheet&&applyCustomStylesheet(data.custom_stylesheet),data.scroll_offset)return SettingsService.setScrollOffset(data.scroll_offset)})}}}(this),!1)},{restrict:"AE",replace:!0,scope:!0,controller:"PayForm",link:linker}}]),angular.module("BB.Controllers").controller("PayForm",["$scope","$location",function($scope,$location){var sendSubmittingEvent,submitPaymentForm;return $scope.controller="public.controllers.PayForm",$scope.setTotal=function(total){return $scope.total=total},$scope.setCard=function(card){return $scope.card=card},sendSubmittingEvent=function(_this){return function(){var payload,referrer,target_origin;return referrer=$location.protocol()+"://"+$location.host(),$location.port()&&(referrer+=":"+$location.port()),target_origin=$scope.referrer,payload=JSON.stringify({type:"submitting",message:referrer}),parent.postMessage(payload,target_origin)}}(this),submitPaymentForm=function(_this){return function(){var payment_form;return payment_form=angular.element.find("form"),payment_form[0].submit()}}(this),$scope.submitAndSendMessage=function(_this){return function(event){var payment_form;return event.preventDefault(),event.stopPropagation(),payment_form=$scope.$eval("payment_form"),payment_form.$invalid?(payment_form.submitted=!0,!1):(sendSubmittingEvent(),submitPaymentForm())}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPeople",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PersonList",link:function(scope,element,attrs){return attrs.bbItems?(scope.booking_items=scope.$eval(attrs.bbItems)||[],scope.booking_item=scope.booking_items[0]):(scope.booking_item=scope.$eval(attrs.bbItem)||scope.bb.current_item,scope.booking_items=[scope.booking_item])}}}),angular.module("BB.Controllers").controller("PersonList",["$scope","$rootScope","PageControllerService","PersonService","ItemService","$q","BBModel","PersonModel","FormDataStoreService",function($scope,$rootScope,PageControllerService,PersonService,ItemService,$q,BBModel,PersonModel,FormDataStoreService){var getItemFromPerson,loadData,setPerson;return $scope.controller="public.controllers.PersonList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(){return loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),loadData=function(){var bi,ppromise;return bi=$scope.booking_item,bi.service&&bi.service!==$scope.change_watch_item?($scope.change_watch_item=bi.service,$scope.notLoaded($scope),ppromise=PersonService.query($scope.bb.company),ppromise.then(function(people){return bi.group&&(people=people.filter(function(x){return!x.group_id||x.group_id===bi.group})),$scope.all_people=people}),ItemService.query({company:$scope.bb.company,cItem:bi,wait:ppromise,item:"person"}).then(function(items){var i,j,len,promises;for(bi.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===bi.group})),promises=[],j=0,len=items.length;j<len;j++)i=items[j],promises.push(i.promise);return $q.all(promises).then(function(_this){return function(res){var k,len1,people;for(people=[],k=0,len1=items.length;k<len1;k++)i=items[k],people.push(i.item),bi&&bi.person&&bi.person.id===i.item.id&&($scope.bb.current_item.settings.person!==-1&&($scope.person=i.item),$scope.selected_bookable_items=[i]);return 1===items.length&&$scope.bb.company.settings&&$scope.bb.company.settings.merge_people?$scope.selectItem(items[0],$scope.nextRoute)?$scope.skipThisStep():(setPerson(people),$scope.bookable_items=items,$scope.selected_bookable_items=items):(setPerson(people),$scope.bookable_items=items,$scope.selected_bookable_items||($scope.selected_bookable_items=items)),$scope.setLoaded($scope)}}(this))},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void(bi.service||$scope.setLoaded($scope))},setPerson=function(people){if($scope.bookable_people=people,$scope.person)return _.each(people,function(person){if(person.id===$scope.person.id)return $scope.person=person})},getItemFromPerson=function(_this){return function(person){var item,j,len,ref;if(person instanceof PersonModel&&$scope.bookable_items)for(ref=$scope.bookable_items,j=0,len=ref.length;j<len;j++)if(item=ref[j],item.item.self===person.self)return item;return person}}(this),$scope.selectItem=function(_this){return function(item,route){var new_person;return $scope.$parent.$has_page_control?($scope.person=item,!1):(new_person=getItemFromPerson(item),_.each($scope.booking_items,function(bi){return bi.setPerson(new_person)}),$scope.decideNextPage(route),!0)}}(this),$scope.selectAndRoute=function(_this){return function(item,route){var new_person;return new_person=getItemFromPerson(item),_.each($scope.booking_items,function(bi){return bi.setPerson(new_person)}),$scope.decideNextPage(route),!0}}(this),$scope.$watch("person",function(_this){return function(newval,oldval){var new_person;if($scope.person&&$scope.booking_item){if(!$scope.booking_item.person||$scope.booking_item.person.self!==$scope.person.self)return new_person=getItemFromPerson($scope.person),_.each($scope.booking_items,function(item){return item.setPerson(new_person)}),$scope.broadcastItemUpdate()}else if(newval!==oldval)return _.each($scope.booking_items,function(item){return item.setPerson(null)}),$scope.broadcastItemUpdate()}}(this)),$scope.$on("currentItemUpdate",function(event){return loadData()}),$scope.setReady=function(_this){return function(){var new_person;return $scope.person?(new_person=getItemFromPerson($scope.person),_.each($scope.booking_items,function(item){return item.setPerson(new_person)}),!0):(_.each($scope.booking_items,function(item){return item.setPerson(null)}),!0)}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbProductList",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ProductList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("ProductList",["$scope","$rootScope","$q","$attrs","ItemService","FormDataStoreService","ValidatorService","PageControllerService","halClient",function($scope,$rootScope,$q,$attrs,ItemService,FormDataStoreService,ValidatorService,PageControllerService,halClient){return $scope.controller="public.controllers.ProductList",$scope.notLoaded($scope),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(){if($scope.bb.company)return $scope.init($scope.bb.company)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(company){return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),company.$get("products").then(function(products){return products.$get("products").then(function(products){return $scope.products=products,$scope.setLoaded($scope)})})},$scope.selectItem=function(item,route){return $scope.$parent.$has_page_control?($scope.product=item,!1):($scope.booking_item.setProduct(item),$scope.decideNextPage(route),!0)}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPurchaseTotal",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PurchaseTotal"}}),angular.module("BB.Controllers").controller("PurchaseTotal",["$scope","$rootScope","$window","PurchaseTotalService","$q",function($scope,$rootScope,$window,PurchaseTotalService,$q){return $scope.controller="public.controllers.PurchaseTotal",angular.extend(this,new $window.PageController($scope,$q)),$scope.load=function(_this){return function(total_id){return $rootScope.connection_started.then(function(){return $scope.loadingTotal=PurchaseTotalService.query({company:$scope.bb.company,total_id:total_id}),$scope.loadingTotal.then(function(total){return $scope.total=total})})}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbResources",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ResourceList",link:function(scope,element,attrs){return scope.options=scope.$eval(attrs.bbResources)||{},attrs.bbItems?(scope.booking_items=scope.$eval(attrs.bbItems)||[],scope.booking_item=scope.booking_items[0]):(scope.booking_item=scope.$eval(attrs.bbItem)||scope.bb.current_item,scope.booking_items=[scope.booking_item])}}}),angular.module("BB.Controllers").controller("ResourceList",["$scope","$rootScope","$attrs","PageControllerService","ResourceService","ItemService","$q","BBModel","ResourceModel",function($scope,$rootScope,$attrs,PageControllerService,ResourceService,ItemService,$q,BBModel,ResourceModel){
var getItemFromResource,loadData;return $scope.controller="public.controllers.ResourceList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(_this){return function(){return loadData()}}(this)),loadData=function(_this){return function(){var params,rpromise;return $scope.bb.steps&&"resource_list"===$scope.bb.steps[0].page||$scope.options.resource_first||$scope.booking_item.service&&$scope.booking_item.service!==$scope.change_watch_item?($scope.change_watch_item=$scope.booking_item.service,$scope.notLoaded($scope),rpromise=ResourceService.query($scope.bb.company),rpromise.then(function(resources){return $scope.booking_item.group&&(resources=resources.filter(function(x){return!x.group_id||x.group_id===$scope.booking_item.group})),$scope.all_resources=resources}),params={company:$scope.bb.company,cItem:$scope.booking_item,wait:rpromise,item:"resource"},ItemService.query(params).then(function(items){var i,j,len,promises;for(promises=[],$scope.booking_item.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===$scope.booking_item.group})),j=0,len=items.length;j<len;j++)i=items[j],promises.push(i.promise);return $q.all(promises).then(function(res){var k,len1,resources;for(resources=[],k=0,len1=items.length;k<len1;k++)i=items[k],resources.push(i.item),$scope.booking_item&&$scope.booking_item.resource&&$scope.booking_item.resource.id===i.item.id&&$scope.bb.current_item.settings.resource!==-1&&($scope.resource=i.item);return 1!==resources.length||$scope.options.allow_single_pick?($scope.bookable_resources=resources,$scope.bookable_items=items):$scope.selectItem(items[0].item,$scope.nextRoute,{skip_step:!0})||($scope.bookable_resources=resources,$scope.bookable_items=items),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return"No service link found"===err&&($scope.bb.steps&&"resource_list"===$scope.bb.steps[0].page||$scope.options.resource_first)?$scope.setLoaded($scope):$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void($scope.booking_item.service||$scope.setLoaded($scope))}}(this),getItemFromResource=function(_this){return function(resource){var item,j,len,ref;if(resource instanceof ResourceModel&&$scope.bookable_items)for(ref=$scope.bookable_items,j=0,len=ref.length;j<len;j++)if(item=ref[j],item.item.self===resource.self)return item;return resource}}(this),$scope.selectItem=function(_this){return function(item,route,options){var new_resource;return null==options&&(options={}),$scope.$parent.$has_page_control?($scope.resource=item,!1):(new_resource=getItemFromResource(item),_.each($scope.booking_items,function(item){return item.setResource(new_resource)}),options.skip_step&&$scope.skipThisStep(),$scope.decideNextPage(route),!0)}}(this),$scope.$watch("resource",function(_this){return function(newval,oldval){var new_resource;if($scope.resource&&$scope.booking_item){if(!$scope.booking_item.resource||$scope.booking_item.resource.self!==$scope.resource.self)return new_resource=getItemFromResource($scope.resource),_.each($scope.booking_items,function(item){return item.setResource(new_resource)}),$scope.broadcastItemUpdate()}else if(newval!==oldval)return _.each($scope.booking_items,function(item){return item.setResource(null)}),$scope.broadcastItemUpdate()}}(this)),$scope.$on("currentItemUpdate",function(event){return loadData()}),$scope.setReady=function(_this){return function(){var new_resource;return $scope.resource?(new_resource=getItemFromResource($scope.resource),_.each($scope.booking_items,function(item){return item.setResource(new_resource)}),!0):(_.each($scope.booking_items,function(item){return item.setResource(null)}),!0)}}(this)}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbServices",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ServiceList"}}),angular.module("BB.Controllers").controller("ServiceList",["$scope","$rootScope","$q","$attrs","$modal","$sce","ItemService","FormDataStoreService","ValidatorService","PageControllerService","halClient","AlertService","ErrorService","$filter","CategoryService",function($scope,$rootScope,$q,$attrs,$modal,$sce,ItemService,FormDataStoreService,ValidatorService,PageControllerService,halClient,AlertService,ErrorService,$filter,CategoryService){var setServiceItem,setServicesDisplayName;return $scope.controller="public.controllers.ServiceList",FormDataStoreService.init("ServiceList",$scope,["service"]),$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$scope.filters={category_name:null,service_name:null,price:{min:0,max:100},custom_array_value:null},$scope.show_custom_array=!1,$scope.options=$scope.$eval($attrs.bbServices)||{},$attrs.bbItem&&($scope.booking_item=$scope.$eval($attrs.bbItem)),($attrs.bbShowAll||$scope.options.show_all)&&($scope.show_all=!0),$scope.options.allow_single_pick&&($scope.allowSinglePick=!0),$scope.options.hide_disabled&&($scope.hide_disabled=!0),$scope.price_options={min:0,max:100},$rootScope.connection_started.then(function(_this){return function(){if($scope.bb.company)return $scope.init($scope.bb.company)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(comp){var all_loaded,ispromise,ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),$scope.bb.company.$has("named_categories")?CategoryService.query($scope.bb.company).then(function(_this){return function(items){return $scope.all_categories=items}}(this),function(err){return $scope.all_categories=[]}):$scope.all_categories=[],$scope.service&&$scope.service.company_id!==$scope.bb.company.id&&($scope.service=null),ppromise=comp.getServicesPromise(),all_loaded=[ppromise],ppromise.then(function(_this){return function(items){var filterItems,item,j,k,len,len1;if($scope.hide_disabled&&(items=items.filter(function(x){return!x.disabled&&!x.deleted})),filterItems="false"!==$attrs.filterServices,filterItems&&($scope.booking_item.service_ref&&!$scope.show_all?items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref}):$scope.booking_item.category&&!$scope.show_all&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.booking_item.category.self}))),$scope.options.show_event_groups||(items=items.filter(function(x){return!x.is_event_group})),1!==items.length||$scope.allowSinglePick?setServiceItem(items):$scope.selectItem(items[0],$scope.nextRoute,{skip_step:!0})||setServiceItem(items),$scope.booking_item.defaultService())for(j=0,len=items.length;j<len;j++)item=items[j],(item.self===$scope.booking_item.defaultService().self||item.name===$scope.booking_item.defaultService().name&&!item.deleted)&&$scope.selectItem(item,$scope.nextRoute,{skip_step:!0});if($scope.booking_item.service)for(k=0,len1=items.length;k<len1;k++)item=items[k],item.selected=!1,item.self===$scope.booking_item.service.self&&($scope.service=item,item.selected=!0,$scope.booking_item.setService($scope.service));if($scope.booking_item.service||!($scope.booking_item.person&&!$scope.booking_item.anyPerson()||$scope.booking_item.resource&&!$scope.booking_item.anyResource()))return items=setServicesDisplayName(items),$scope.bookable_services=items}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),($scope.booking_item.person&&!$scope.booking_item.anyPerson()||$scope.booking_item.resource&&!$scope.booking_item.anyResource())&&(ispromise=ItemService.query({company:$scope.bb.company,cItem:$scope.booking_item,wait:ppromise,item:"service"}),all_loaded.push(ispromise),ispromise.then(function(_this){return function(items){var i,services;return $scope.booking_item.service_ref&&(items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref})),$scope.booking_item.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===$scope.booking_item.group})),$scope.hide_disabled&&(items=items.filter(function(x){return null==x.item||!x.item.disabled&&!x.item.deleted})),services=function(){var j,len,results;for(results=[],j=0,len=items.length;j<len;j++)i=items[j],null!=i.item&&results.push(i.item);return results}(),services=setServicesDisplayName(services),$scope.bookable_services=services,$scope.bookable_items=items,1!==services.length||$scope.allowSinglePick?setServiceItem(services):$scope.selectItem(services[0],$scope.nextRoute,{skip_step:!0})?void 0:setServiceItem(services)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})),$q.all(all_loaded).then(function(){return $scope.setLoaded($scope)})},setServicesDisplayName=function(items){var item,j,len;for(j=0,len=items.length;j<len;j++)item=items[j],item.listed_durations&&1===item.listed_durations.length?item.display_name=item.name+" - "+$filter("time_period")(item.duration):item.display_name=item.name;return items},setServiceItem=function(items){if($scope.items=items,$scope.filtered_items=$scope.items,$scope.service)return _.each(items,function(item){if(item.id===$scope.service.id)return $scope.service=item})},$scope.selectItem=function(_this){return function(item,route,options){return null==options&&(options={}),!!$scope.routed||($scope.$parent.$has_page_control?($scope.service=item,!1):item.is_event_group?($scope.booking_item.setEventGroup(item),options.skip_step&&$scope.skipThisStep(),$scope.decideNextPage(route),$scope.routed=!0):($scope.booking_item.setService(item),$scope.bb.selected_service=$scope.booking_item.service,options.skip_step&&$scope.skipThisStep(),$scope.decideNextPage(route),$scope.routed=!0,!0))}}(this),$scope.$watch("service",function(_this){return function(newval,oldval){if($scope.service&&$scope.booking_item&&(!$scope.booking_item.service||$scope.booking_item.service.self!==$scope.service.self))return $scope.booking_item.setService($scope.service),$scope.broadcastItemUpdate(),$scope.bb.selected_service=$scope.service}}(this)),$scope.setReady=function(_this){return function(){return $scope.service?($scope.booking_item.setService($scope.service),!0):!!($scope.bb.stacked_items&&$scope.bb.stacked_items.length>0)}}(this),$scope.errorModal=function(){var error_modal;return error_modal=$modal.open({templateUrl:$scope.getPartial("_error_modal"),controller:["$scope","$modalInstance",function($scope,$modalInstance){return $scope.message=ErrorService.getError("GENERIC").msg,$scope.ok=function(){return $modalInstance.close()}}]})},$scope.filterFunction=function(service){return!!service&&($scope.service_array=[],$scope.custom_array=function(match){var item,j,len,ref;if(!match)return!1;if($scope.options.custom_filter){for(match=match.toLowerCase(),ref=service.extra[$scope.options.custom_filter],j=0,len=ref.length;j<len;j++)if(item=ref[j],item=item.toLowerCase(),item===match)return $scope.show_custom_array=!0,!0;return!1}},$scope.service_name_include=function(match){var item;return!!match&&(match?(match=match.toLowerCase(),item=service.name.toLowerCase(),!!item.includes(match)):void 0)},(!$scope.filters.category_name||service.category_id===$scope.filters.category_name.id)&&(!$scope.filters.service_name||$scope.service_name_include($scope.filters.service_name))&&(!$scope.filters.custom_array_value||$scope.custom_array($scope.filters.custom_array_value))&&(!service.price||service.price>=100*$scope.filters.price.min&&service.price<=100*$scope.filters.price.max))},$scope.resetFilters=function(){return $scope.options.clear_results&&($scope.show_custom_array=!1),$scope.filters.category_name=null,$scope.filters.service_name=null,$scope.filters.price.min=0,$scope.filters.price.max=100,$scope.filters.custom_array_value=null,$scope.filterChanged()},$scope.filterChanged=function(){return $scope.filtered_items=$filter("filter")($scope.items,$scope.filterFunction)}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimeSlots",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"TimeSlots",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("TimeSlots",["$scope","$rootScope","$q","$attrs","SlotService","FormDataStoreService","ValidatorService","PageControllerService","halClient","BBModel",function($scope,$rootScope,$q,$attrs,SlotService,FormDataStoreService,ValidatorService,PageControllerService,halClient,BBModel){var setItem;return $scope.controller="public.controllers.SlotList",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){if($scope.bb.company)return $scope.init($scope.bb.company)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(company){return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),$scope.start_date=moment(),$scope.end_date=moment().add(1,"month"),SlotService.query($scope.bb.company,{item:$scope.booking_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()}).then(function(slots){return $scope.slots=slots,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},setItem=function(slot){return $scope.booking_item.setSlot(slot)},$scope.selectItem=function(slot,route){return $scope.$parent.$has_page_control?(setItem(slot),!1):(setItem(slot),$scope.decideNextPage(route),!0)}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbSpaces",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"SpaceList"}}),angular.module("BB.Controllers").controller("SpaceList",["$scope","$rootScope","ServiceService","SpaceService","$q",function($scope,$rootScope,ServiceService,SpaceService,$q){return $scope.controller="public.controllers.SpaceList",$rootScope.connection_started.then(function(_this){return function(){if($scope.bb.company)return $scope.init($scope.bb.company)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(_this){return function(comp){return SpaceService.query(comp).then(function(items){return $scope.currentItem.category&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.currentItem.category.self})),$scope.items=items,1!==items.length||$scope.allowSinglePick?$scope.listLoaded=!0:($scope.skipThisStep(),$rootScope.services=items,$scope.selectItem(items[0],$scope.nextRoute))},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectItem=function(_this){return function(item,route){return $scope.currentItem.setService(item),$scope.decide_next_page(route)}}(this)}])}.call(this),function(){angular.module("BB.Directives").directive("bbSummary",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Summary"}}),angular.module("BB.Controllers").controller("Summary",["$scope","$rootScope","ClientService","$q",function($scope,$rootScope,ClientService,$q){return $scope.controller="public.controllers.Summary",$rootScope.connection_started.then(function(_this){return function(){return $scope.item=$scope.bb.current_item,$scope.items=$scope.bb.basket.timeItems()}}(this)),$scope.confirm=function(_this){return function(){var promises;return $scope.notLoaded($scope),promises=[ClientService.create_or_update($scope.bb.company,$scope.client)],$scope.bb.current_item.service&&promises.push($scope.addItemToBasket()),$q.all(promises).then(function(result){var client;return client=result[0],$scope.setClient(client),client.waitingQuestions&&client.gotQuestions.then(function(){return $scope.client_details=client.client_details}),$scope.setLoaded($scope),$scope.decideNextPage()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this)}])}.call(this),function(){angular.module("BB.Directives").directive("bbSurveyQuestions",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"SurveyQuestions"}}),angular.module("BB.Controllers").controller("SurveyQuestions",["$scope","$rootScope","CompanyService","PurchaseService","ClientService","$modal","$location","$timeout","BBWidget","BBModel","$q","QueryStringService","SSOService","AlertService","LoginService","$window","ServiceService","ValidatorService","PurchaseBookingService","$sessionStorage",function($scope,$rootScope,CompanyService,PurchaseService,ClientService,$modal,$location,$timeout,BBWidget,BBModel,$q,QueryStringService,SSOService,AlertService,LoginService,$window,ServiceService,ValidatorService,PurchaseBookingService,$sessionStorage){var getBookingAndSurvey,getBookingRef,getMember,getPurchaseID,init,setPurchaseCompany,showLoginError;return $scope.controller="SurveyQuestions",$scope.completed=!1,$scope.login={email:"",password:""},$scope.login_error=!1,$scope.booking_ref="",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return init()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),init=function(_this){return function(){if($scope.company){if(!$scope.company.settings.requires_login)return getBookingAndSurvey();if($scope.checkIfLoggedIn(),$rootScope.member)return getBookingAndSurvey()}}}(this),$scope.checkIfLoggedIn=function(_this){return function(){return LoginService.checkLogin()}}(this),$scope.loadSurvey=function(_this){return function(purchase){return $scope.company||$scope.purchase.$get("company").then(function(company){return setPurchaseCompany(company)}),$scope.purchase.$has("client")&&$scope.purchase.$get("client").then(function(client){return $scope.setClient(new BBModel.Client(client))}),$scope.purchase.getBookingsPromise().then(function(bookings){var address,booking,i,len,params,pretty_address,ref,results;for(params={},$scope.bookings=bookings,ref=$scope.bookings,results=[],i=0,len=ref.length;i<len;i++)booking=ref[i],booking.datetime&&(booking.pretty_date=moment(booking.datetime).format("dddd, MMMM Do YYYY")),booking.address&&(address=new BBModel.Address(booking.address),pretty_address=address.addressSingleLine(),booking.pretty_address=pretty_address),$rootScope.user&&(params.admin_only=!0),results.push(booking.$get("survey_questions",params).then(function(details){var item_details;return item_details=new BBModel.ItemDetails(details),booking.survey_questions=item_details.survey_questions,booking.getSurveyAnswersPromise().then(function(answers){var answer,j,k,len1,len2,question,ref1,ref2;for(booking.survey_answers=answers,ref1=booking.survey_questions,j=0,len1=ref1.length;j<len1;j++)if(question=ref1[j],booking.survey_answers)for(ref2=booking.survey_answers,k=0,len2=ref2.length;k<len2;k++)answer=ref2[k],answer.question_text===question.name&&answer.value&&(question.answer=answer.value);return $scope.setLoaded($scope)})}));return results},function(err){return $scope.setLoaded($scope),failMsg()})}}(this),$scope.submitSurveyLogin=function(_this){return function(form){if(ValidatorService.validateForm(form))return LoginService.companyLogin($scope.company,{},{email:$scope.login.email,password:$scope.login.password,id:$scope.company.id}).then(function(member){return LoginService.setLogin(member),getBookingAndSurvey()},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.loadSurveyFromPurchaseID=function(_this){return function(id){var auth_token,params;return params={purchase_id:id,url_root:$scope.bb.api_url},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.query(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.loadSurvey($scope.purchase)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.loadSurveyFromBookingRef=function(_this){return function(id){var auth_token,params;return params={booking_ref:id,url_root:$scope.bb.api_url,raw:!0},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.bookingRefQuery(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.loadSurvey($scope.purchase)},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.submitSurvey=function(_this){return function(form){var booking,i,len,params,ref,results;if(ValidatorService.validateForm(form)){for(ref=$scope.bookings,results=[],i=0,len=ref.length;i<len;i++)booking=ref[i],booking.checkReady(),booking.ready?($scope.notLoaded($scope),booking.client_id=$scope.client.id,params=booking,results.push(PurchaseBookingService.addSurveyAnswersToBooking(params).then(function(booking){return $scope.setLoaded($scope),$scope.completed=!0},function(err){return $scope.setLoaded($scope)}))):results.push($scope.decideNextPage(route));return results}}}(this),$scope.submitBookingRef=function(_this){return function(form){var auth_token,params;if(ValidatorService.validateForm(form))return $scope.notLoaded($scope),params={booking_ref:$scope.booking_ref,url_root:$scope.bb.api_url,raw:!0},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.bookingRefQuery(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.loadSurvey($scope.purchase)},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.storeBookingCookie=function(){return document.cookie="bookingrefsc="+$scope.booking_ref},showLoginError=function(_this){return function(){return $scope.login_error=!0}}(this),getMember=function(_this){return function(){var params;return params={member_id:$scope.member_id,company_id:$scope.company_id},LoginService.memberQuery(params).then(function(member){return $scope.member=member})}}(this),setPurchaseCompany=function(company){if($scope.bb.company_id=company.id,$scope.bb.company=new BBModel.Company(company),$scope.company=$scope.bb.company,$scope.bb.item_defaults.company=$scope.bb.company,company.settings&&(company.settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),company.settings.merge_people))return $scope.bb.item_defaults.merge_people=!0},getBookingRef=function(){var booking_ref,matches;return matches=/^.*(?:\?|&)booking_ref=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(booking_ref=matches[1]),booking_ref},getPurchaseID=function(){var matches,purchase_id;return matches=/^.*(?:\?|&)id=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(purchase_id=matches[1]),purchase_id},getBookingAndSurvey=function(){var id;return id=getBookingRef(),id?$scope.loadSurveyFromBookingRef(id):(id=getPurchaseID())?$scope.loadSurveyFromPurchaseID(id):$scope.bb.total?$scope.loadSurveyFromPurchaseID($scope.bb.total.long_id):void 0}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimes",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"TimeList"}}),angular.module("BB.Controllers").controller("TimeList",["$attrs","$element","$scope","$rootScope","$q","TimeService","AlertService","BBModel","DateTimeUtilitiesService","PageControllerService","ErrorService",function($attrs,$element,$scope,$rootScope,$q,TimeService,AlertService,BBModel,DateTimeUtilitiesService,PageControllerService,ErrorService){var checkRequestedSlots;return $scope.controller="public.controllers.TimeList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.data_source||($scope.data_source=$scope.bb.current_item),$scope.options=$scope.$eval($attrs.bbTimes)||{},$rootScope.connection_started.then(function(){return $scope.bb.current_item.defaults.date&&!$scope.bb.current_item.date?$scope.setDate($scope.bb.current_item.defaults.date):$scope.bb.current_item.date?$scope.setDate($scope.bb.current_item.date.date):$scope.setDate(moment()),$scope.loadDay()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.setDate=function(_this){return function(date){var day;return day=new BBModel.Day({date:date,spaces:1}),$scope.selected_day=day,$scope.selected_date=day.date}}(this),$scope.setDataSource=function(_this){return function(source){return $scope.data_source=source}}(this),$scope.setItemLinkSource=function(_this){return function(source){return $scope.item_link_source=source}}(this),$scope.$on("dateChanged",function(_this){return function(event,newdate){return $scope.setDate(newdate),$scope.loadDay()}}(this)),$scope.$on("currentItemUpdate",function(event){return $scope.loadDay({check_requested_slot:!1})}),$scope.selectSlot=function(_this){return function(slot,day,route){if(slot&&slot.availability()>0)return $scope.item_link_source&&$scope.data_source.setItem($scope.item_link_source),slot.datetime?($scope.setLastSelectedDate(slot.datetime),$scope.data_source.setDate({date:slot.datetime})):day&&($scope.setLastSelectedDate(day.date),$scope.data_source.setDate(day)),$scope.data_source.setTime(slot),$scope.data_source.reserve_ready?$scope.addItemToBasket().then(function(){return $scope.decideNextPage(route)}):$scope.decideNextPage(route)}}(this),$scope.highlightSlot=function(_this){return function(slot,day){if(day&&slot&&slot.availability()>0)return slot.datetime?($scope.setLastSelectedDate(slot.datetime),$scope.data_source.setDate({date:slot.datetime})):day&&($scope.setLastSelectedDate(day.date),$scope.data_source.setDate(day)),$scope.data_source.setTime(slot),$scope.$broadcast("slotChanged")}}(this),$scope.status=function(slot){var status;if(slot)return status=slot.status()},$scope.add=function(_this){return function(type,amount){var new_date;return delete $scope.bb.current_item.time,new_date=moment($scope.selected_day.date).add(amount,type),$scope.setDate(new_date),$scope.loadDay()}}(this),$scope.subtract=function(_this){return function(type,amount){return $scope.add(type,-amount)}}(this),$scope.loadDay=function(_this){return function(options){var pslots;return options||(options={check_requested_slot:!0}),$scope.data_source&&($scope.data_source.days_link||$scope.item_link_source)&&$scope.selected_day?($scope.notLoaded($scope),pslots=TimeService.query({company:$scope.bb.company,cItem:$scope.data_source,item_link:$scope.item_link_source,date:$scope.selected_day.date,client:$scope.client,available:1}),pslots["finally"](function(){return $scope.setLoaded($scope)}),pslots.then(function(time_slots){var dtimes,i,j,len,len1,pad,ref,s,v;if($scope.slots=time_slots,$scope.$broadcast("slotsUpdated",$scope.data_source,time_slots),$scope.add_padding&&time_slots.length>0){for(dtimes={},i=0,len=time_slots.length;i<len;i++)s=time_slots[i],dtimes[s.time]=1;for(ref=$scope.add_padding,v=j=0,len1=ref.length;j<len1;v=++j)pad=ref[v],dtimes[pad]||time_slots.splice(v,0,new BBModel.TimeSlot({time:pad,avail:0},time_slots[0].service))}if(options.check_requested_slot===!0)return checkRequestedSlots(time_slots)},function(err){return 404===err.status&&err.data&&err.data.error&&"No bookable events found"===err.data.error?$scope.data_source&&$scope.data_source.person?(AlertService.warning(ErrorService.getError("NOT_BOOKABLE_PERSON")),$scope.setLoaded($scope)):$scope.data_source&&$scope.data_source.resource?(AlertService.warning(ErrorService.getError("NOT_BOOKABLE_RESOURCE")),$scope.setLoaded($scope)):$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong"):$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.setLoaded($scope)}}(this),checkRequestedSlots=function(time_slots){var requested_slot;if($scope.bb.item_defaults&&$scope.bb.item_defaults.time)return requested_slot=DateTimeUtilitiesService.checkDefaultTime($scope.selected_date,time_slots,$scope.data_source,$scope.bb.item_defaults),console.log($scope.bb.item_defaults),console.log(requested_slot),null===requested_slot.slot||null===requested_slot.match?$scope.availability_conflict=!0:requested_slot.slot&&"full"===requested_slot.match?($scope.skipThisStep(),$scope.selectSlot(requested_slot.slot,$scope.selected_day)):requested_slot.slot&&"partial"===requested_slot.match?$scope.highlightSlot(requested_slot.slot,$scope.selected_day):void 0},$scope.padTimes=function(_this){return function(times){return $scope.add_padding=times}}(this),$scope.setReady=function(){return $scope.data_source.time?!$scope.data_source.reserve_ready||$scope.addItemToBasket():(AlertService.clear(),AlertService.add("danger",{msg:"You need to select a time slot"}),!1)}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimeRanges",["$q","$templateCache","$compile",function($q,$templateCache,$compile){return{restrict:"AE",replace:!0,scope:!0,priority:1,transclude:!0,controller:"TimeRangeList",link:function(scope,element,attrs,controller,transclude){return scope.today=moment().toDate(),scope.tomorrow=moment().add(1,"days").toDate(),scope.options=scope.$eval(attrs.bbTimeRanges)||{},transclude(scope,function(_this){return function(clone){var has_content;return has_content=clone.length>1||1===clone.length&&(!clone[0].wholeText||/\S/.test(clone[0].wholeText)),has_content?element.html(clone).show():$q.when($templateCache.get("_week_calendar.html")).then(function(template){return element.html(template).show(),$compile(element.contents())(scope)})}}(this))}}}]),angular.module("BB.Controllers").controller("TimeRangeList",["$scope","$element","$attrs","$rootScope","$q","TimeService","AlertService","BBModel","FormDataStoreService","DateTimeUtilitiesService","SlotDates","ViewportSize",function($scope,$element,$attrs,$rootScope,$q,TimeService,AlertService,BBModel,FormDataStoreService,DateTimeUtilitiesService,SlotDates,ViewportSize){var currentPostcode,isSubtractValid,setTimeRange;return $scope.controller="public.controllers.TimeRangeList",currentPostcode=$scope.bb.postcode,FormDataStoreService.init("TimeRangeList",$scope,["selected_slot","postcode","original_start_date","start_at_week_start"]),currentPostcode!==$scope.postcode&&($scope.selected_slot=null,$scope.selected_date=null),$scope.postcode=$scope.bb.postcode,$scope.notLoaded($scope),$scope.data_source||($scope.data_source=$scope.bb.current_item),$rootScope.connection_started.then(function(){return $scope.initialise()}),$scope.initialise=function(){var calculateDayNum,date,diff,selected_day,start_date;return null!=$attrs.bbTimeRangeLength?$scope.time_range_length=$scope.$eval($attrs.bbTimeRangeLength):$scope.options&&$scope.options.time_range_length?$scope.time_range_length=$scope.options.time_range_length:(calculateDayNum=function(){var cal_days,days,size,timeRange;cal_days={lg:7,md:5,sm:3,xs:1},timeRange=7;for(size in cal_days)days=cal_days[size],size===ViewportSize.getViewportSize()&&(timeRange=days);return timeRange},$scope.time_range_length=calculateDayNum(),$scope.$on("ViewportSize:changed",function(){return $scope.time_range_length=null,$scope.initialise()})),(null!=$attrs.bbDayOfWeek||$scope.options&&$scope.options.day_of_week)&&($scope.day_of_week=null!=$attrs.bbDayOfWeek?$scope.$eval($attrs.bbDayOfWeek):$scope.options.day_of_week),(null!=$attrs.bbSelectedDay||$scope.options&&$scope.options.selected_day)&&(selected_day=null!=$attrs.bbSelectedDay?moment($scope.$eval($attrs.bbSelectedDay)):moment($scope.options.selected_day),moment.isMoment(selected_day)&&($scope.selected_day=selected_day)),$scope.options.ignore_min_advance_datetime=!!$scope.options.ignore_min_advance_datetime,!$scope.start_date&&$scope.last_selected_date?$scope.original_start_date?(diff=$scope.last_selected_date.diff($scope.original_start_date,"days"),diff%=$scope.time_range_length,diff=0===diff?diff:diff+1,start_date=$scope.last_selected_date.clone().subtract(diff,"days"),setTimeRange($scope.last_selected_date,start_date)):setTimeRange($scope.last_selected_date):$scope.bb.current_item.date||$scope.bb.current_item.defaults.date?(date=$scope.bb.current_item.date?$scope.bb.current_item.date.date:$scope.bb.current_item.defaults.date,
setTimeRange(date)):$scope.selected_day?($scope.original_start_date=$scope.original_start_date||moment($scope.selected_day),setTimeRange($scope.selected_day)):($scope.start_at_week_start=!0,setTimeRange(moment())),$scope.loadData()},setTimeRange=function(selected_date,start_date){start_date?$scope.start_date=start_date:$scope.day_of_week?$scope.start_date=selected_date.clone().day($scope.day_of_week):$scope.start_at_week_start?$scope.start_date=selected_date.clone().startOf("week"):$scope.start_date=selected_date.clone(),$scope.selected_day=selected_date,$scope.selected_date=$scope.selected_day.toDate(),isSubtractValid()},$scope.moment=function(date){return moment(date)},$scope.setDataSource=function(source){return $scope.data_source=source},$scope.$on("currentItemUpdate",function(event){return $scope.loadData()}),$scope.add=function(type,amount){switch(amount>0&&($element.removeClass("subtract"),$element.addClass("add")),$scope.selected_day=moment($scope.selected_date),type){case"days":setTimeRange($scope.selected_day.add(amount,"days"));break;case"weeks":$scope.start_date.add(amount,type),setTimeRange($scope.start_date);break;case"months":$scope.start_date.add(amount,type).startOf("month"),setTimeRange($scope.start_date)}return $scope.loadData()},$scope.subtract=function(type,amount){return $element.removeClass("add"),$element.addClass("subtract"),$scope.add(type,-amount)},isSubtractValid=function(){var diff;return $scope.is_subtract_valid=!0,diff=Math.ceil($scope.selected_day.diff(moment(),"day",!0)),$scope.subtract_length=diff<$scope.time_range_length?diff:$scope.time_range_length,diff<=0&&($scope.is_subtract_valid=!1),$scope.subtract_length>1?$scope.subtract_string="Prev "+$scope.subtract_length+" days":1===$scope.subtract_length?$scope.subtract_string="Prev day":$scope.subtract_string="Prev"},$scope.selectedDateChanged=function(){return setTimeRange(moment($scope.selected_date)),$scope.selected_slot=null,$scope.loadData()},$scope.isPast=function(){return!$scope.start_date||moment().isAfter($scope.start_date)},$scope.status=function(day,slot){var status;if(slot)return status=slot.status()},$scope.selectSlot=function(slot,day,route){if(slot&&slot.availability()>0)return $scope.bb.current_item.setTime(slot),slot.datetime?($scope.setLastSelectedDate(slot.datetime),$scope.bb.current_item.setDate({date:slot.datetime})):day&&($scope.setLastSelectedDate(day.date),$scope.bb.current_item.setDate(day)),$scope.bb.current_item.reserve_ready?($scope.notLoaded($scope),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.decideNextPage(route)},$scope.highlightSlot=function(slot,day){var current_item;if(current_item=$scope.bb.current_item,slot&&slot.availability()>0&&!slot.disabled)return slot.datetime?($scope.setLastSelectedDate(slot.datetime),current_item.setDate({date:slot.datetime})):day&&($scope.setLastSelectedDate(day.date),current_item.setDate(day)),current_item.setTime(slot),current_item.setDate(day),$scope.selected_slot=slot,$scope.selected_day=day.date,$scope.selected_date=day.date.toDate(),!$scope.bb.current_item.earliest_time_slot||!$scope.bb.current_item.earliest_time_slot.selected||$scope.bb.current_item.earliest_time_slot.date.isSame(day.date,"day")&&$scope.bb.current_item.earliest_time_slot.time===slot.time||($scope.bb.current_item.earliest_time_slot.selected=!1),$rootScope.$broadcast("time:selected"),$scope.$broadcast("slotChanged",day,slot)},$scope.loadData=function(){var current_item,date,duration,edate,loc,promise;return current_item=$scope.bb.current_item,current_item.service&&!$scope.options.ignore_min_advance_datetime&&($scope.min_date=current_item.service.min_advance_datetime,$scope.max_date=current_item.service.max_advance_datetime,$scope.selected_day&&$scope.selected_day.isBefore(current_item.service.min_advance_datetime,"day")&&!$scope.isAdmin()&&setTimeRange(current_item.service.min_advance_datetime)),date=$scope.start_date,edate=moment(date).add($scope.time_range_length,"days"),$scope.end_date=moment(edate).add(-1,"days"),AlertService.clear(),duration=$scope.bb.current_item.duration,$scope.bb.current_item.min_duration&&(duration=$scope.bb.current_item.min_duration),$scope.data_source&&$scope.data_source.days_link?($scope.notLoaded($scope),loc=null,$scope.bb.postcode&&(loc=",,,,"+$scope.bb.postcode+","),promise=TimeService.query({company:$scope.bb.company,resource_ids:$scope.bb.item_defaults.resources,cItem:$scope.data_source,date:date,client:$scope.client,end_date:$scope.end_date,duration:duration,location:loc,num_resources:$scope.bb.current_item.num_resources,available:1}),promise["finally"](function(){return $scope.setLoaded($scope)}),promise.then(function(datetime_arr){var d,day,dtimes,i,j,k,len,len1,len2,pad,pair,ref,ref1,requested_slot,slot,time_slots,v;for($scope.days=[],_.every(_.values(datetime_arr),_.isEmpty)?$scope.no_slots_in_week=!0:$scope.no_slots_in_week=!1,ref=_.sortBy(_.pairs(datetime_arr),function(pair){return pair[0]}),i=0,len=ref.length;i<len;i++){if(pair=ref[i],d=pair[0],time_slots=pair[1],day={date:moment(d),slots:time_slots},$scope.days.push(day),time_slots.length>0&&(current_item.earliest_time&&!current_item.earliest_time.isAfter(d)||(current_item.earliest_time=moment(d).add(time_slots[0].time,"minutes")),current_item.earliest_time_slot&&!current_item.earliest_time_slot.date.isAfter(d)||(current_item.earliest_time_slot={date:moment(d).add(time_slots[0].time,"minutes"),time:time_slots[0].time})),$scope.add_padding&&time_slots.length>0){for(dtimes={},j=0,len1=time_slots.length;j<len1;j++)slot=time_slots[j],dtimes[slot.time]=1,slot.date=day.date.format("DD-MM-YY");for(ref1=$scope.add_padding,v=k=0,len2=ref1.length;k<len2;v=++k)pad=ref1[v],dtimes[pad]||time_slots.splice(v,0,new BBModel.TimeSlot({time:pad,avail:0},time_slots[0].service))}requested_slot=DateTimeUtilitiesService.checkDefaultTime(day.date,day.slots,current_item,$scope.bb.item_defaults),requested_slot.slot&&"full"===requested_slot.match?$scope.selectSlot(requested_slot.slot,day):requested_slot.slot&&$scope.highlightSlot(requested_slot.slot,day)}return $scope.$broadcast("time_slots:loaded",time_slots)},function(err){return 404===err.status&&err.data&&err.data.error&&"No bookable events found"===err.data.error?($scope.data_source&&$scope.data_source.person?(AlertService.warning(ErrorService.getError("NOT_BOOKABLE_PERSON")),$scope.setLoaded($scope)):$scope.data_source&&$scope.data_source.resource&&(AlertService.warning(ErrorService.getError("NOT_BOOKABLE_RESOURCE")),$scope.setLoaded($scope)),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")):$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.setLoaded($scope)},$scope.showFirstAvailableDay=function(){return SlotDates.getFirstDayWithSlots($scope.data_source,$scope.selected_day).then(function(day){return $scope.no_slots_in_week=!1,setTimeRange(day),$scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.padTimes=function(times){return $scope.add_padding=times},$scope.setReady=function(){return $scope.bb.current_item.time?$scope.bb.moving_booking&&$scope.bb.current_item.start_datetime().isSame($scope.bb.current_item.original_datetime)&&$scope.current_item.person_name===$scope.current_item.person.name?(AlertService.raise("APPT_AT_SAME_TIME"),!1):$scope.bb.moving_booking?($scope.bb.company.$has("resources")&&!$scope.bb.current_item.resource&&($scope.bb.current_item.resource=!0),$scope.bb.company.$has("people")&&!$scope.bb.current_item.person&&($scope.bb.current_item.person=!0),!0):!$scope.bb.current_item.reserve_ready||$scope.addItemToBasket():(AlertService.raise("TIME_SLOT_NOT_SELECTED"),!1)},$scope.pretty_month_title=function(month_format,year_format,seperator){var month_year_format,start_date;if(null==seperator&&(seperator="-"),$scope.start_date&&$scope.end_date)return month_year_format=month_format+" "+year_format,$scope.start_date&&$scope.end_date&&$scope.end_date.isAfter($scope.start_date,"month")?(start_date=$scope.start_date.format(month_format),11===$scope.start_date.month()&&(start_date=$scope.start_date.format(month_year_format)),start_date+" "+seperator+" "+$scope.end_date.format(month_year_format)):$scope.start_date.format(month_year_format)},$scope.selectEarliestTimeSlot=function(){var day,slot;if(day=_.find($scope.days,function(day){return day.date.isSame($scope.bb.current_item.earliest_time_slot.date,"day")}),slot=_.find(day.slots,function(slot){return slot.time===$scope.bb.current_item.earliest_time_slot.time}),day&&slot)return $scope.bb.current_item.earliest_time_slot.selected=!0,$scope.highlightSlot(day,slot)}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTotal",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Total"}}),angular.module("BB.Controllers").controller("Total",["$scope","$rootScope","$q","$location","$window","PurchaseService","QueryStringService",function($scope,$rootScope,$q,$location,$window,PurchaseService,QueryStringService){return $scope.controller="public.controllers.Total",$scope.notLoaded($scope),$rootScope.connection_started.then(function(_this){return function(){var id;return $scope.bb.payment_status=null,id=QueryStringService("purchase_id"),id&&!$scope.bb.total?PurchaseService.query({url_root:$scope.bb.api_url,purchase_id:id}).then(function(total){if($scope.total=total,$scope.setLoaded($scope),total.paid===total.total_price)return $scope.$emit("checkout:success",total)}):($scope.total=$scope.bb.total,$scope.setLoaded($scope),$scope.total.paid===$scope.total.total_price&&$scope.$emit("checkout:success",$scope.total)),$scope.reset()}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.print=function(_this){return function(){return $window.open($scope.bb.partial_url+"print_purchase.html?id="+$scope.total.long_id,"_blank","width=700,height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=1,left=0,top=0"),!0}}(this)}])}.call(this),angular.module("BB.Directives").directive("bbAccordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!1,templateUrl:"accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(element){this.heading=element}},link:function(scope,element,attrs,accordionCtrl){accordionCtrl.addGroup(scope),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope)}),scope.toggleOpen=function(){scope.isDisabled||(scope.isOpen=!scope.isOpen)}}}}).directive("bbAccordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^bbAccordionGroup",link:function(scope,element,attr,accordionGroupCtrl,transclude){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}).directive("bbAccordionTransclude",function(){return{require:"^bbAccordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.bbAccordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),function(){"use strict";angular.module("BB.Directives").directive("bbBasket",["PathSvc",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,templateUrl:function(element,attrs){return _.has(attrs,"mini")?PathSvc.directivePartial("_basket_mini"):PathSvc.directivePartial("basket")},controllerAs:"BasketCtrl",controller:["$scope","$modal","BasketService",function($scope,$modal,BasketService){var BasketInstanceCtrl;$scope.setUsingBasket(!0),this.empty=function(){return $scope.$eval("emptyBasket()")},this.view=function(){return $scope.$eval("viewBasket()")},$scope.showBasketDetails=function(){var modalInstance;return"basket"!==$scope.bb.current_page&&"checkout"!==$scope.bb.current_page&&(modalInstance=$modal.open({templateUrl:$scope.getPartial("_basket_details"),scope:$scope,controller:BasketInstanceCtrl,resolve:{basket:function(){return $scope.bb.basket}}}))},BasketInstanceCtrl=function($scope,$rootScope,$modalInstance,basket){return $scope.basket=basket,$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},$scope.$watch(function(){var len;$scope.basketItemCount=len=$scope.bb.basket?$scope.bb.basket.length():0,len?1===len?$scope.basketStatus="1 item in your basket":$scope.basketStatus=len+" items in your basket":$scope.basketStatus="empty"})}],link:function(scope,element,attrs){return element.bind("click",function(e){return e.preventDefault()})}}}]),angular.module("BB.Directives").directive("bbMinSpend",function(){return{restrict:"A",scope:!0,controller:["$scope","$element","$attrs","AlertService","$filter",function($scope,$element,$attrs,AlertService,$filter){var checkMinSpend,options;return options=$scope.$eval($attrs.bbMinSpend||{}),$scope.min_spend=options.min_spend||0,$scope.setReady=function(){return checkMinSpend()},checkMinSpend=function(){var i,item,len1,price,ref;for(price=0,ref=$scope.bb.stacked_items,i=0,len1=ref.length;i<len1;i++)item=ref[i],price+=item.service.price;return price>=$scope.min_spend?(AlertService.clear(),!0):(AlertService.clear(),price=$filter("ipretty_price")($scope.min_spend),AlertService.add("warning",{msg:"You need to spend at least "+price+" to make a booking."}),!1)}}]}})}.call(this),function(){angular.module("BB.Directives").directive("bbDateTimePicker",["PathSvc",function(PathSvc){return{scope:{date:"=",showMeridian:"=?",minuteStep:"=?",minDate:"=?",maxDate:"=?",format:"=?",bbDisabled:"=?"},restrict:"A",templateUrl:"bb_date_time_picker.html",controller:["$scope","$filter","$timeout","GeneralOptions",function($scope,$filter,$timeout,GeneralOptions){var filterDate;return null==$scope.format&&($scope.format="dd/MM/yyyy"),null==$scope.bbDisabled&&($scope.bbDisabled=!1),$scope.minuteStep&&"undefined"!=typeof $scope.minuteStep||($scope.minuteStep=GeneralOptions.calendar_minute_step),$scope.showMeridian&&"undefined"!=typeof $scope.showMeridian||($scope.showMeridian=GeneralOptions.twelve_hour_format),$scope.$watch("datetimeWithNoTz",function(newValue,oldValue){var assembledDate,maxDateClean,minDateDate;newValue=new Date(newValue),null!=newValue&&moment(newValue).isValid()&&(assembledDate=moment(),assembledDate.set({year:parseInt(newValue.getFullYear()),month:parseInt(newValue.getMonth()),date:parseInt(newValue.getDate()),hour:parseInt(newValue.getHours()),minute:parseInt(newValue.getMinutes()),second:0}),null!=$scope.minDateClean&&(minDateDate=new Date($scope.minDateClean),newValue.getTime()/1e3<minDateDate.getTime()/1e3&&(newValue.getFullYear()<minDateDate.getFullYear()&&assembledDate.year(parseInt(minDateDate.getFullYear())),newValue.getMonth()<minDateDate.getMonth()&&assembledDate.month(parseInt(minDateDate.getMonth())),newValue.getDate()<minDateDate.getDate()&&assembledDate.date(parseInt(minDateDate.getDate())),newValue.getHours()<minDateDate.getHours()&&assembledDate.hours(parseInt(minDateDate.getHours())),newValue.getMinutes()<minDateDate.getMinutes()&&assembledDate.minutes(parseInt(minDateDate.getMinutes())),$scope.datetimeWithNoTz=$filter("clearTimezone")(assembledDate.format()))),null!=$scope.maxDateClean&&(maxDateClean=new Date($scope.maxDateClean),newValue.getTime()/1e3>maxDateClean.getTime()/1e3&&(newValue.getFullYear()>minDateDate.getFullYear()&&assembledDate.year(parseInt(minDateDate.getFullYear())),newValue.getMonth()>minDateDate.getMonth()&&assembledDate.month(parseInt(minDateDate.getMonth())),newValue.getDate()>minDateDate.getDate()&&assembledDate.date(parseInt(minDateDate.getDate())),newValue.getHours()>maxDateClean.getHours()&&assembledDate.hours(parseInt(maxDateClean.getHours())),newValue.getMinutes()>maxDateClean.getMinutes()&&assembledDate.minutes(parseInt(maxDateClean.getMinutes())),$scope.datetimeWithNoTz=$filter("clearTimezone")(assembledDate.format()))),$scope.date=assembledDate.format())}),$scope.datetimeWithNoTz=$filter("clearTimezone")(moment($scope.date).format()),$scope.$watch("date",function(newValue,oldValue){if(newValue!==oldValue)return $scope.datetimeWithNoTz=$filter("clearTimezone")(moment($scope.date).format())}),$scope.$watch("minDate",function(newValue,oldValue){if(newValue!==oldValue)return $scope.minDateClean=filterDate(newValue)}),$scope.$watch("maxDate",function(newValue,oldValue){if(newValue!==oldValue)return $scope.maxDateClean=filterDate(newValue)}),filterDate=function(date){return null!=date&&moment(date).isValid()?$filter("clearTimezone")(moment(date).format()):null},$scope.minDateClean=filterDate($scope.minDate),$scope.maxDateClean=filterDate($scope.maxDate)}]}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbBreadcrumb",["PathSvc",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,controller:"Breadcrumbs",templateUrl:function(element,attrs){return _.has(attrs,"complex")?PathSvc.directivePartial("_breadcrumb_complex"):PathSvc.directivePartial("_breadcrumb")},link:function(scope){}}}]),angular.module("BB.Controllers").controller("Breadcrumbs",["$scope",function($scope){var atDisablePoint,currentStep,lastStep,loadStep;return loadStep=$scope.loadStep,$scope.steps=$scope.bb.steps,$scope.allSteps=$scope.bb.allSteps,$scope.loadStep=function(number){if(!lastStep()&&!currentStep(number)&&!atDisablePoint())return loadStep(number)},lastStep=function(){return $scope.bb.current_step===$scope.bb.allSteps.length},currentStep=function(step){return step===$scope.bb.current_step},atDisablePoint=function(){return!!angular.isDefined($scope.bb.disableGoingBackAtStep)&&$scope.bb.current_step>=$scope.bb.disableGoingBackAtStep},$scope.isDisabledStep=function(step){return!(!lastStep()&&!currentStep(step.number)&&step.passed&&!atDisablePoint())}}])}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbContentNew",["PathSvc",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,templateUrl:PathSvc.directivePartial("content_main"),controller:["$scope",function($scope){$scope.initPage=function(){return $scope.$eval("setPageLoaded()")}}]}}])}.call(this),function(){angular.module("BB.Directives").directive("bbDatepickerPopup",["$parse","$document","$timeout","$bbug",function($parse,$document,$timeout,$bbug){var e,error,ie8orLess;ie8orLess=!1;try{ie8orLess=window.parseInt(/MSIE\s*(\d)/.exec(window.navigator.userAgent)[1])}catch(error){e=error,ie8orLess=!1}return{restrict:"A",priority:-1,require:"ngModel",link:function(scope,element,attrs,ngModel){var callDateHandler,data,dateFormat,f,format,getTimeRangeScope,getter,origDateParser,replacementDateParser,timeRangeScope,yearNow;return origDateParser=null,data=element.controller("ngModel"),null!=attrs.datepickerPopup&&(format={date_us:"MM/dd/yyyy",date_uk:"dd/MM/yyyy"},"us"===scope.bb.company.country_code?attrs.datepickerPopup=format.date_us:attrs.datepickerPopup=format.date_uk),dateFormat=attrs.bbDatepickerPopup?attrs.bbDatepickerPopup:"DD/MM/YYYY",yearNow=moment(new Date).year(),getter=$parse(attrs.ngModel),timeRangeScope=scope,getTimeRangeScope=function(scope){if(scope)return scope.controller&&scope.controller.indexOf("TimeRangeList")>0?timeRangeScope=scope:getTimeRangeScope(scope.$parent)},getTimeRangeScope(scope),ie8orLess&&$bbug(element).on("keydown keyup keypress",function(ev){return ev.preventDefault(),ev.stopPropagation()}),(ie8orLess||scope.display.xs)&&$bbug(element).attr("readonly","true"),$bbug(element).on("keydown",function(e){if(13===e.keyCode)return replacementDateParser($bbug(e.target).val(),!0),$document.trigger("click"),$bbug(element).blur()}),$bbug(element).on("click",function(e){return e.preventDefault(),e.stopPropagation(),$timeout(function(){return scope.opened=!0})}),$bbug(element).on("focus",function(){if($(this).attr("readonly"))return this.blur()}),callDateHandler=function(date){var isDate,watch;return watch=scope.$watch(getter,function(newVal,oldVal){if(!newVal)return getter.assign(timeRangeScope,date)}),$timeout(watch,0),isDate=_.isDate(date),isDate&&(getter.assign(timeRangeScope,date),ngModel.$setValidity("date",!0),scope.$eval(attrs.onDateChange)),isDate},replacementDateParser=function(viewValue,returnKey){var mDate;return callDateHandler(viewValue)?viewValue:ie8orLess?viewValue:(mDate=moment(viewValue,dateFormat),mDate.isValid()||(mDate=moment(new Date)),/\/YY$/.test(dateFormat)&&(dateFormat+="YY"),0===mDate.year()&&mDate.year(yearNow),viewValue=mDate.format("MM/DD/YYYY"),viewValue=viewValue.replace(/\/00/,"/20"),/\/02\d{2}$/.test(viewValue)?void 0:returnKey?(2===mDate.year().toString().length&&mDate.year(mDate.year()+2e3),callDateHandler(mDate._d)):origDateParser.call(this,viewValue))},(f=function(){return _.isFunction(data.$parsers[0])?(origDateParser=data.$parsers[0],void(data.$parsers[0]=replacementDateParser)):setTimeout(f,10)})()}}}])}.call(this),function(){angular.module("BB.Directives").directive("bbFbLogin",["LoginService","$rootScope","AlertService","$window",function(LoginService,$rootScope,AlertService,$window){return{restrict:"A",scope:!0,link:function(scope,element,attrs){var checkLoginState,loginToBBWithFBUser,options,statusChangeCallback;return options=scope.$eval(attrs.bbFbLogin)||{},$rootScope.connection_started.then(function(){return checkLoginState()}),statusChangeCallback=function(response){var params;"connected"===response.status?(params={},params.access_token=response.authResponse.accessToken,options.login_only&&(params.login_only=options.login_only),loginToBBWithFBUser(params)):"not_authorized"===response.status?scope.loginFB():scope.loginFB()},checkLoginState=function(){FB.getLoginStatus(function(response){statusChangeCallback(response)})},loginToBBWithFBUser=function(params){return LoginService.FBLogin(scope.bb.company,params).then(function(member){return $rootScope.member=member,scope.setClient($rootScope.member),scope.bb.destination?scope.redirectTo(scope.bb.destination):(scope.setLoaded(scope),scope.decideNextPage())},function(err){return"FACEBOOK-LOGIN-MEMBER-NOT-FOUND"===err.data.error?AlertService.raise("FB_LOGIN_NOT_A_MEMBER"):AlertService.raise("LOGIN_FAILED")})},scope.loginFB=function(){return FB.login(function(response){var params;"connected"===response.status?(params={},params.access_token=response.authResponse.accessToken,options.login_only&&(params.login_only=options.login_only),loginToBBWithFBUser(params)):"not_authorized"===response.status?AlertService.raise("LOGIN_FAILED"):AlertService.raise("LOGIN_FAILED")},{scope:"public_profile,email"})}}}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbFileUpload",function(){return{restrict:"A",replace:!1,scope:{accept:"@",prettyAccept:"@",maxSize:"@",item:"="},controller:"FileUpload",templateUrl:"file_upload.html"}}),angular.module("BB.Controllers").controller("FileUpload",["$scope","Upload",function($scope,Upload){return $scope.controller="public.controllers.FileUpload",$scope.uploadFile=function(item,file,err_files,existing){var accepted_files,att_id,file_is_valid,method,onError,onProgress,onSuccess,url;return $scope.err_file=err_files&&err_files[0],$scope.show_error=!1,$scope.file_type_error=!1,$scope.my_file=file,accepted_files=$scope.accept.replace(/\'/g,"").split(","),file_is_valid=file&&(0<=accepted_files.indexOf(file.type)||0<=file.type.indexOf("image")),file_is_valid?(att_id=existing?existing:null,method="POST",att_id&&(method="PUT"),url=item.$href("add_attachment"),onSuccess=function(response){return file.result=response.data,item.attachment=response.data,item.attachment_id=response.data.id,file.progress=100},onError=function(response){return $scope.show_error=!0,file.progress=100},onProgress=function(evt){return file.progress=Math.min(100,parseInt(99*evt.loaded/evt.total))},Upload.rename(file,file.name.replace(/[^\x00-\x7F]/g,"")),file.upload=Upload.upload({url:url,method:method,data:{attachment_id:att_id},file:file}),file.upload.then(onSuccess,onError,onProgress)):file_is_valid===!1?$scope.file_type_error=!0:void 0}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbFormDataStore",["FormDataStoreService",function(FormDataStoreService){return{require:"?bbWidget",link:function(scope){return FormDataStoreService.register(scope)}}}])}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("ngConfirmClick",function(){return{link:function(scope,element,attr){var clickAction,msg;return msg=attr.ngConfirmClick||"Are you sure?",clickAction=attr.ngConfirmedClick,element.bind("click",function(_this){return function(event){if(window.confirm(msg))return scope.$eval(clickAction)}}(this))}}}),app.directive("ngValidInclude",["$compile",function($compile){return{link:function(scope,element,attr){return scope[attr.watchValue].then(function(_this){return function(logged){return element.attr("ng-include",attr.ngValidInclude),element.attr("ng-valid-include",null),$compile(element)(scope)}}(this))}}}]),app.directive("ngDelayed",["$compile",function($compile){return{link:function(scope,element,attr){return scope[attr.ngDelayedWatch].then(function(_this){return function(logged){if(element.attr(attr.ngDelayed,attr.ngDelayedValue),element.attr("ng-delayed-value",null),element.attr("ng-delayed-watch",null),element.attr("ng-delayed",null),$compile(element)(scope),attr.ngDelayedReady)return scope[attr.ngDelayedReady].resolve(!0)}}(this))}}}]),app.directive("ngInitial",function(){return{restrict:"A",controller:["$scope","$element","$attrs","$parse",function($scope,$element,$attrs,$parse){var getter,setter,val;return val=$attrs.ngInitial||$attrs.value,getter=$parse($attrs.ngModel),setter=getter.assign,"true"===val?val=!0:"false"===val&&(val=!1),setter($scope,val)}]}}),app.directive("bbPrintPage",["$window","$timeout",function($window,$timeout){return{restrict:"A",link:function(scope,element,attr){if(attr.bbPrintPage)return scope.$watch(attr.bbPrintPage,function(_this){return function(newVal,oldVal){return $timeout(function(){return $window.print()},3e3)}}(this))}}}]),app.directive("bbInclude",["$compile","$rootScope",function($compile,$rootScope){return{link:function(scope,element,attr){var track_page;return track_page=null!=attr.bbTrackPage,scope.$watch("bb.path_setup",function(_this){return function(newval,oldval){if(newval&&(element.attr("ng-include","'"+scope.getPartial(attr.bbInclude)+"'"),element.attr("bb-include",null),$compile(element)(scope),track_page))return $rootScope.$broadcast("page:loaded",attr.bbInclude)}}(this))}}}]),app.directive("bbRaiseAlertWhenInvalid",["$compile",function($compile){return{require:"^form",link:function(scope,element,attr,ctrl){var options;if(ctrl.raise_alerts=!0,options=scope.$eval(attr.bbRaiseAlertWhenInvalid),options&&options.alert)return ctrl.alert=options.alert}}}]),app.directive("bbHeader",["$compile",function($compile){return{link:function(scope,element,attr){return scope.bb.waitForRoutes(),scope.$watch("bb.path_setup",function(_this){return function(newval,oldval){if(newval)return element.attr("ng-include","'"+scope.getPartial(attr.bbHeader)+"'"),element.attr("bb-header",null),$compile(element)(scope)}}(this))}}}]),app.directive("bbDate",function(){return{restrict:"AE",scope:!0,link:function(scope,element,attrs){var date,track_service;return track_service=null!=attrs.bbTrackService,date=attrs.bbDate?moment(scope.$eval(attrs.bbDate)):scope.bb&&scope.bb.current_item&&scope.bb.current_item.date?scope.bb.current_item.date.date:moment(),track_service&&scope.bb.current_item&&scope.bb.current_item.service&&(scope.min_date=scope.bb.current_item.service.min_advance_datetime,scope.max_date=scope.bb.current_item.service.max_advance_datetime),scope.$broadcast("dateChanged",moment(date)),scope.bb_date={date:date,js_date:date.toDate(),addDays:function(type,amount){return this.date=moment(this.date).add(amount,type),this.js_date=this.date.toDate(),scope.$broadcast("dateChanged",moment(this.date))},subtractDays:function(type,amount){return this.addDays(type,-amount)},setDate:function(date){return this.date=date,this.js_date=date.toDate(),scope.$broadcast("dateChanged",moment(this.date))}},scope.$on("currentItemUpdate",function(event){if(scope.bb.current_item.service&&track_service&&(scope.min_date=scope.bb.current_item.service.min_advance_datetime,scope.max_date=scope.bb.current_item.service.max_advance_datetime,scope.bb_date.date.isBefore(scope.min_date,"day")&&scope.bb_date.setDate(scope.min_date.clone()),scope.bb_date.date.isAfter(scope.max_date,"day")))return scope.bb_date.setDate(scope.max_date.clone())}),scope.$watch("bb_date.js_date",function(newval,oldval){var ndate;if(ndate=moment(newval),!scope.bb_date.date.isSame(ndate)&&(scope.bb_date.date=ndate,moment(ndate).isValid()))return scope.$broadcast("dateChanged",moment(ndate))})}}}),app.directive("bbDebounce",["$timeout",function($timeout){return{restrict:"A",link:function(scope,element,attrs){var delay;return delay=400,attrs.bbDebounce&&(delay=attrs.bbDebounce),element.bind("click",function(_this){return function(){return $timeout(function(){return element.attr("disabled",!0)},0),$timeout(function(){return element.attr("disabled",!1)},delay)}}(this))}}}]),app.directive("bbLocalNumber",["$filter",function($filter){return{restrict:"A",scope:{},require:"ngModel",link:function(scope,element,attrs,ctrl){var prettyifyNumber,storeNumber;return scope.userinput_mobile=null,storeNumber=function(value){return value&&(scope.userinput_mobile=value),value},prettyifyNumber=function(value){return scope.userinput_mobile?value=scope.userinput_mobile:$filter("local_phone_number")(value)},ctrl.$parsers.push(storeNumber),ctrl.$formatters.push(prettyifyNumber)}}}]),app.directive("bbPadWithZeros",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var how_many,options,padNumber;return options=scope.$eval(attrs.bbPadWithZeros)||{},how_many=options.how_many||2,padNumber=function(value){var i,index,padding,ref;if(value=String(value),value&&value.length<how_many){for(padding="",index=i=1,ref=how_many-value.length;1<=ref?i<=ref:i>=ref;index=1<=ref?++i:--i)padding+="0";value=padding.concat(value)}return value},ctrl.$formatters.push(padNumber)}}}),app.directive("bbFormResettable",["$parse",function($parse){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){return $scope.inputs=[],$scope.resetForm=function(options){var i,input,len,ref,results;for(options&&options.clear_submitted&&($scope[$attrs.name].submitted=!1),ref=$scope.inputs,results=[],i=0,len=ref.length;i<len;i++)input=ref[i],input.getter.assign($scope,null),results.push(input.controller.$setPristine());return results},{registerInput:function(input,ctrl){var getter;return getter=$parse(input),$scope.inputs.push({getter:getter,controller:ctrl})}}}]}}]),app.directive("bbResettable",function(){return{restrict:"A",require:["ngModel","^bbFormResettable"],link:function(scope,element,attrs,ctrls){var formResettableCtrl,ngModelCtrl;return ngModelCtrl=ctrls[0],formResettableCtrl=ctrls[1],formResettableCtrl.registerInput(attrs.ngModel,ngModelCtrl)}}}),app.directive("bbDateSplit",["$parse",function($parse){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var ngModel,question;if(ngModel=ctrls[0],question=scope.$eval(attrs.bbDateSplit),question.date={day:null,month:null,year:null,date:null,joinDate:function(){var date_string;if(this.day&&this.month&&this.year)return date_string=this.day+"/"+this.month+"/"+this.year,this.date=moment(date_string,"DD/MM/YYYY"),date_string=this.date.toISODate(),ngModel.$setViewValue(date_string),ngModel.$render()},splitDate:function(date){if(date&&date.isValid())return this.day=date.date(),this.month=date.month()+1,this.year=date.year(),this.date=date}},question.answer&&question.date.splitDate(moment(question.answer)),ngModel.$viewValue)return question.date.splitDate(moment(ngModel.$viewValue))}}}]),app.directive("bbCommPref",function(){
return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var comm_pref,ng_model_ctrl,parser;return ng_model_ctrl=ctrls[0],comm_pref=scope.$eval(attrs.bbCommPref)||!1,null!=scope.bb.current_item.settings.send_email_followup&&null!=scope.bb.current_item.settings.send_sms_followup?comm_pref=scope.bb.current_item.settings.send_email_followup:(scope.bb.current_item.settings.send_email_followup=comm_pref,scope.bb.current_item.settings.send_sms_followup=comm_pref),ng_model_ctrl.$setViewValue(comm_pref),parser=function(value){return scope.bb.current_item.settings.send_email_followup=value,scope.bb.current_item.settings.send_sms_followup=value,value},ng_model_ctrl.$parsers.push(parser)}}}),app.directive("bbCountTicketTypes",["$rootScope",function($rootScope){return{restrict:"A",scope:!1,link:function(scope,element,attrs){var countTicketTypes;return $rootScope.connection_started.then(function(){return countTicketTypes()}),scope.$on("basket:updated",function(event,basket){return countTicketTypes()}),countTicketTypes=function(items){var counts,i,item,len;for(items=scope.bb.basket.timeItems(),counts=[],i=0,len=items.length;i<len;i++)item=items[i],item.tickets&&(counts[item.tickets.name]?counts[item.tickets.name]+=item.tickets.qty:counts[item.tickets.name]=item.tickets.qty,item.number=counts[item.tickets.name]);return scope.counts=counts}}}}]),app.directive("bbCapitaliseFirstLetter",function(){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var ngModel;return ngModel=ctrls[0],scope.$watch(attrs.ngModel,function(newval,oldval){var string;newval&&(string=scope.$eval(attrs.ngModel),string=string.charAt(0).toUpperCase()+string.slice(1),ngModel.$setViewValue(string),ngModel.$render())})}}}),app.directive("bbApiUrl",["$rootScope","$compile","$sniffer","$timeout","$window","$location",function($rootScope,$compile,$sniffer,$timeout,$window,$location){return{restrict:"A",scope:{apiUrl:"@bbApiUrl"},compile:function(tElem,tAttrs){return{pre:function(scope,element,attrs){var src,url;if($rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=scope.apiUrl,url=document.createElement("a"),url.href=scope.apiUrl,($sniffer.msie&&$sniffer.msie<=9||$sniffer.webkit&&$sniffer.webkit<537)&&""!==url.host&&url.host!==$location.host()&&url.host!==$location.host()+":"+$location.port())return src=":"===url.protocol[url.protocol.length-1]?url.protocol+"//"+url.host+"/ClientProxy.html":url.protocol+"://"+url.host+"/ClientProxy.html",$rootScope.iframe_proxy_ready=!1,$compile("<iframe id='ieapiframefix' name='"+url.hostname+("' src='"+src+"' style='visibility:false;display:none;'></iframe>"))(scope,function(_this){return function(cloned,scope){return cloned.bind("load",function(){return $rootScope.iframe_proxy_ready=!0,$rootScope.$broadcast("iframe_proxy_ready",{iframe_proxy_ready:!0})}),element.append(cloned)}}(this))}}}}}]),app.directive("bbPriceFilter",["PathSvc",function(PathSvc){return{restrict:"AE",replace:!0,scope:!1,require:"^?bbServices",templateUrl:function(element,attrs){return PathSvc.directivePartial("_price_filter")},controller:["$scope","$attrs",function($scope,$attrs){var setPricefilter,suitable_max;return $scope.$watch("items",function(new_val,old_val){if(new_val)return setPricefilter(new_val)}),setPricefilter=function(items){return $scope.price_array=_.uniq(_.map(items,function(item){return item.price/100||0})),$scope.price_array.sort(function(a,b){return a-b}),suitable_max()},suitable_max=function(){var max_number,min_number,top_number;return top_number=_.last($scope.price_array),max_number=function(){switch(!1){case!(top_number<1):return 0;case!(top_number<11):return 10;case!(top_number<51):return 50;case!(top_number<101):return 100;case!(top_number<1e3):return 100*Math.ceil(top_number/100)}}(),min_number=0,$scope.price_options={min:min_number,max:max_number},$scope.filters.price={min:min_number,max:max_number}},$scope.$watch("filters.price.min",function(new_val,old_val){if(new_val!==old_val)return $scope.filterChanged()}),$scope.$watch("filters.price.max",function(new_val,old_val){if(new_val!==old_val)return $scope.filterChanged()})}]}}]),angular.module("BB.Directives").directive("bbBookingExport",function(){return{restrict:"AE",scope:!0,template:'<div bb-include="_popout_export_booking" style="display: inline-block"></div>',link:function(scope,el,attrs){var setHTML;return scope.$watch("total",function(new_val,old_val){if(new_val)return setHTML(new_val)}),scope.$watch("purchase",function(new_val,old_val){if(new_val)return setHTML(new_val)}),setHTML=function(purchase_total){return scope.html="<div class='text-center'><a href='"+purchase_total.webcalLink()+"'><img src='images/outlook.png' alt='outlook calendar icon' height='30' width='30' /><div class='clearfix'></div><span>Outlook</span></a></div><p></p>"+("<div class='text-center'><a href='"+purchase_total.gcalLink()+"'><img src='images/google.png' alt='google calendar icon' height='30' width='30' /><div class='clearfix'></div><span>Google</span></a></div><p></p>")+("<div class='text-center'><a href='"+purchase_total.icalLink()+"'><img src='images/ical.png' alt='ical calendar icon' height='30' width='30' /><div class='clearfix'></div><span>iCal</span></a></div>")}}}}),angular.module("BB.Directives").directive("bbDynamicFooter",["$timeout","$bbug",function($timeout,$bbug){return function(scope,el,attrs){return scope.$on("page:loaded",function(){return $bbug(".content").css("height","auto")}),scope.$watch(function(){return $bbug(".content")[0].scrollHeight},function(new_val,old_val){if(new_val!==old_val)return scope.setContentHeight()}),scope.setContentHeight=function(){var content_height,min_content_height;if($bbug(".content").css("height","auto"),content_height=$bbug(".content")[0].scrollHeight,min_content_height=$bbug(window).innerHeight()-$bbug(".content").offset().top-$bbug(".footer").height(),content_height<min_content_height)return $bbug(".content").css("height",min_content_height+"px")},$bbug(window).on("resize",function(){return scope.setContentHeight()})}}]),angular.module("BB.Directives").directive("bbBlurOnReturn",["$timeout",function($timeout){return{restrict:"A",require:"ngModel",link:function(scope,el,attrs){return el.keydown(function(e){var key;if(key=e.which||e.keyCode,13===key||"13"===key)return $timeout(function(){if(e.target)return e.target.blur()},10)})}}}])}.call(this),function(){"use strict";var app,isEmpty;app=angular.module("BB.Directives"),app.directive("bbQuestionLine",["$compile",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){var e,elm,html,index;if("heading"===scope.question.detail_type&&(elm="",scope.question.name.length>0&&(elm+="<div class='bb-question-heading'>"+scope.question.name+"</div>"),scope.question.help_text&&scope.question.help_text.length>0&&(elm+="<div class='bb-question-help-text'>"+scope.question.help_text+"</div>"),element.html(elm)),scope.idmaps&&(scope.idmaps[scope.question.detail_type]&&scope.idmaps[scope.question.detail_type].block||scope.idmaps[scope.question.id]&&scope.idmaps[scope.question.id].block))return index=scope.idmaps[scope.question.id]?scope.question.id:scope.question.detail_type,html=scope.$parent.idmaps[index].html,e=$compile(html)(scope,function(_this){return function(cloned,scope){return element.replaceWith(cloned)}}(this))}}}]),app.directive("bbQuestion",["$compile","$timeout",function($compile,$timeout){return{priority:0,replace:!0,transclude:!1,restrict:"A",compile:function(el,attr,trans){return{pre:function(scope,element,attrs){var adminRequired,date_format,date_format_2;return adminRequired=null!=attrs.bbAdminRequired,date_format="DD/MM/YYYY",date_format_2="dd/MM/yyyy",null!=attrs.bbDateFormat&&"US"===attrs.bbDateFormat&&(date_format="MM/DD/YYYY",date_format_2="MM/dd/yyyy"),scope.$watch(attrs.bbQuestion,function(question){var e,html,i,index,itemx,j,k,lastName,len1,len2,len3,name,placeholder,ref,ref1,ref2;if(question){if(html="",lastName="",placeholder="",null!=attrs.defaultPlaceholder&&"text_area"===question.detail_type|"text_field"===question.detail_type&&(question["default"]&&(placeholder=question["default"]),question.answer===question["default"]&&(question.answer="")),scope.recalc=function(_this){return function(){if(angular.isDefined(scope.recalc_price)&&(question.outcome||scope.recalc_price()),angular.isDefined(scope.recalc_question))return scope.recalc_question()}}(this),scope.idmaps&&(scope.idmaps[question.detail_type]||scope.idmaps[question.id]))index=scope.idmaps[scope.question.id]?scope.question.id:scope.question.detail_type,html=scope.idmaps[index].html;else if("select"===question.detail_type||"select-price"===question.detail_type){for(html="<select ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-change='recalc()' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' class='form-question form-control'>",ref=question.options,i=0,len1=ref.length;i<len1;i++)itemx=ref[i],html+="<option data_id='"+itemx.id+"' value='"+itemx.name.replace(/'/g,"&apos;")+"'>"+itemx.display_name+"</option>";html+="</select>"}else if("text_area"===question.detail_type)html="<textarea placeholder='"+placeholder+"' ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' rows=3 class='form-question form-control'>"+question.answer+"</textarea>";else if("radio"===question.detail_type){for(html='<div class="radio-group">',ref1=question.options,j=0,len2=ref1.length;j<len2;j++)itemx=ref1[j],html+="<div class='radio'><label class='radio-label'><input ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-change='recalc()' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' type='radio' value=\""+itemx.name+'"/>'+itemx.name+"</label></div>";html+="</div>"}else if("check"===question.detail_type)name=question.name,name===lastName&&(name=""),lastName=question.name,html="<div class='checkbox' ng-class='{\"selected\": question.answer}'><label><input name='q"+question.id+"' id='"+question.id+"' ng-model='question.answer' ng-checked='question.answer == \"1\"' ng-change='recalc()' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' type='checkbox' value=1>"+name+"</label></div>";else if("check-price"===question.detail_type)html="<div class='checkbox'><label><input name='q"+question.id+"' id='"+question.id+"' ng-model='question.answer' ng-checked='question.answer == \"1\"' ng-change='recalc()' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' type='checkbox' value=1> ({{question.price | currency:'GBP'}})</label></div>";else if("radio-price"===question.detail_type){for(html='<div class="radio-group">',ref2=question.options,k=0,len3=ref2.length;k<len3;k++)itemx=ref2[k],html+="<div class='radio'><label class='radio-label'><input ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-change='recalc()' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' type='radio' value=\""+itemx.name+'"/>'+itemx.display_name+"</label></div>";html+="</div>"}else html="date"===question.detail_type?"<div class='input-group date-picker'> <input type='text' class='form-question form-control' name='q"+question.id+"' id='"+question.id+"' bb-datepicker-popup='"+date_format+"' datepicker-popup='"+date_format_2+"' ng-model='question.answer' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' ng-change='recalc()' datepicker-options='{\"starting-day\": 1}' show-weeks='false' show-button-bar='false' is-open='opened' /> <span class='input-group-btn' ng-click='$event.preventDefault();$event.stopPropagation();opened=true'> <button class='btn btn-default' type='submit'><span class='glyphicon glyphicon-calendar'></span></button> </span> </div>":"<input type='text' placeholder='"+placeholder+"'  ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-required='question.currentlyShown && (("+adminRequired+" && question.required) || (question.required && !bb.isAdmin))' class='form-question form-control'/>";if(html)return e=$compile(html)(scope,function(_this){return function(cloned,scope){return element.replaceWith(cloned)}}(this))}})},post:function(scope,$e,$a,parentControl){}}}}}]),app.directive("bbQuestionSetup",function(){return{restrict:"A",terminal:!0,priority:1e3,link:function(scope,element,attrs){var block,child,def,i,id,idmaps,index,len1,ref;for(idmaps={},def=null,ref=element.children(),index=i=0,len1=ref.length;i<len1;index=++i)child=ref[index],id=$(child).attr("bb-question-id"),block=!1,$(child).attr("bb-replace-block")&&(block=!0),child.innerHTML=child.innerHTML.replace(/question_form/g,"question_form_"+index),idmaps[id]={id:id,html:child.innerHTML,block:block};return scope.idmaps=idmaps,element.replaceWith("")}}}),app.directive("bbFocus",function(){var FOCUS_CLASS;return FOCUS_CLASS="bb-focused",{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){return ctrl.$focused=!1,element.bind("focus",function(evt){return element.addClass(FOCUS_CLASS),scope.$apply(function(){return ctrl.$focused=!0})}).bind("blur",function(evt){return element.removeClass(FOCUS_CLASS),scope.$apply(function(){return ctrl.$focused=!1})})}}}),app.directive("bbCurrencyField",["$filter",function($filter){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var convertToCurrency,convertToInteger;return convertToCurrency=function(value){return value/100},convertToInteger=function(value){return 100*value},ctrl.$formatters.push(convertToCurrency),ctrl.$parsers.push(convertToInteger)}}}]),isEmpty=function(value){return angular.isUndefined(value)||""===value||null===value||value!==value},app.directive("ngMin",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){var minValidator;minValidator=function(value){var min;return min=scope.$eval(attr.ngMin)||0,ctrl.$setValidity("ngMin",isEmpty(value)||value>=min),value},ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}}}),app.directive("ngMax",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){var maxValidator;maxValidator=function(value){var max;return max=scope.$eval(attr.ngMax),ctrl.$setValidity("ngMax",isEmpty(value)||value<=max),value},ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}}}),app.directive("creditCardNumber",function(){var getCardType,isValid,linker;return getCardType=function(ccnumber){return ccnumber?(ccnumber=ccnumber.toString().replace(/\s+/g,""),/^(34)|^(37)/.test(ccnumber)?"american_express":/^(62)|^(88)/.test(ccnumber)?"china_unionpay":/^30[0-5]/.test(ccnumber)?"diners_club_carte_blanche":/^(2014)|^(2149)/.test(ccnumber)?"diners_club_enroute":/^36/.test(ccnumber)?"diners_club_international":/^(6011)|^(622(1(2[6-9]|[3-9][0-9])|[2-8][0-9]{2}|9([01][0-9]|2[0-5])))|^(64[4-9])|^65/.test(ccnumber)?"discover":/^35(2[89]|[3-8][0-9])/.test(ccnumber)?"jcb":/^(6304)|^(6706)|^(6771)|^(6709)/.test(ccnumber)?"laser":/^(5018)|^(5020)|^(5038)|^(5893)|^(6304)|^(6759)|^(6761)|^(6762)|^(6763)|^(0604)/.test(ccnumber)?"maestro":/^5[1-5]/.test(ccnumber)?"master":/^4/.test(ccnumber)?"visa":/^(4026)|^(417500)|^(4405)|^(4508)|^(4844)|^(4913)|^(4917)/.test(ccnumber)?"visa_electron":void 0):""},isValid=function(ccnumber){var len,mul,prodArr,sum;if(!ccnumber)return!1;for(ccnumber=ccnumber.toString().replace(/\s+/g,""),len=ccnumber.length,mul=0,prodArr=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],sum=0;len--;)sum+=prodArr[mul][parseInt(ccnumber.charAt(len),10)],mul^=1;return sum%10===0&&sum>0},linker=function(scope,element,attributes,ngModel){return scope.$watch(function(){return ngModel.$modelValue},function(newValue){return ngModel.$setValidity("card_number",isValid(newValue)),scope.cardType=getCardType(newValue),null!=newValue&&16===newValue.length?ngModel.$invalid?(element.parent().addClass("has-error"),element.parent().removeClass("has-success")):(element.parent().removeClass("has-error"),element.parent().addClass("has-success")):element.parent().removeClass("has-success")})},{restrict:"C",require:"ngModel",link:linker,scope:{cardType:"="}}}),app.directive("cardSecurityCode",function(){var linker;return linker=function(scope,element,attributes){return scope.$watch("cardType",function(newValue){return"american_express"===newValue?(element.attr("maxlength",4),element.attr("placeholder","")):(element.attr("maxlength",3),element.attr("placeholder",""))})},{restrict:"AC",link:linker,scope:{cardType:"="}}}),app.directive("bbInputGroupManager",["ValidatorService",function(ValidatorService){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){return $scope.input_manger={input_groups:{},inputs:[],registerInput:function(input,name){if(!(this.inputs.indexOf(input.$name)>=0))return this.inputs.push(input.$name),this.input_groups[name]||(this.input_groups[name]={inputs:[],valid:!1}),this.input_groups[name].inputs.push(input)},validateInputGroup:function(name){var i,input,is_valid,j,len1,len2,ref,ref1;for(is_valid=!1,ref=this.input_groups[name].inputs,i=0,len1=ref.length;i<len1&&(input=ref[i],!(is_valid=input.$modelValue));i++);if(is_valid===!this.input_groups[name].valid){for(ref1=this.input_groups[name].inputs,j=0,len2=ref1.length;j<len2;j++)input=ref1[j],input.$setValidity(input.$name,is_valid);return this.input_groups[name].valid=is_valid}}},$element.on("submit",function(){var input_group,results;results=[];for(input_group in $scope.input_manger.input_groups)results.push($scope.input_manger.validateInputGroup(input_group));return results})}]}}]),app.directive("bbInputGroup",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ngModel){if(!(scope.input_manger.inputs.indexOf(ngModel.$name)>=0))return scope.input_manger.registerInput(ngModel,attrs.bbInputGroup),scope.$watch(attrs.ngModel,function(newval,oldval){if(newval===!oldval)return scope.input_manger.validateInputGroup(attrs.bbInputGroup)})}}}),app.directive("bbQuestionLabel",["$compile",function($compile){return{transclude:!1,restrict:"A",scope:!1,link:function(scope,element,attrs){return scope.$watch(attrs.bbQuestionLabel,function(question){if(question&&("check"===question.detail_type||"check-price"===question.detail_type))return element.html("")})}}}]),app.directive("bbQuestionLink",["$compile",function($compile){return{transclude:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var id;return id=parseInt(attrs.bbQuestionLink),scope.$watch("question_set",function(newval,oldval){var i,len1,q,ref,results;if(newval){for(ref=scope.question_set,results=[],i=0,len1=ref.length;i<len1;i++)q=ref[i],q.id===id?(scope.question=q,element.attr("ng-model","question.answer"),element.attr("bb-question-link",null),results.push($compile(element)(scope))):results.push(void 0);return results}})}}}]),app.directive("bbQuestionSet",["$compile",function($compile){return{transclude:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var set;return set=attrs.bbQuestionSet,element.addClass("ng-hide"),scope.$watch(set,function(newval,oldval){if(newval)return scope.question_set=newval,element.removeClass("ng-hide")})}}}]),app.directive("bbMatchInput",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl,ngModel){var compare;return scope.$watch(attrs.bbMatchInput,function(){return scope.val_1=scope.$eval(attrs.bbMatchInput),compare(ctrl.$viewValue)}),compare=function(value){return ctrl.$setValidity("match",scope.val_1===value),value},ctrl.$parsers.push(compare)}}})}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("bbIntTelNumber",["$parse",function($parse){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var format,isValid,options,parse;return options=scope.$eval(attrs.bbIntTelNumber),element.intlTelInput(options),isValid=function(value){return!value||element.intlTelInput("isValidNumber")},format=function(value){var str;return str="",null!=scope.$eval(attrs.ngModel+"_prefix")&&(str+="+"+scope.$eval(attrs.ngModel+"_prefix")+" "),null!=scope.$eval(attrs.ngModel)&&(str+=scope.$eval(attrs.ngModel)),"+"===str[0]&&(element.intlTelInput("setNumber","+"+scope.$eval(attrs.ngModel+"_prefix")+" "+scope.$eval(attrs.ngModel)),ctrl.$setValidity("phone",isValid(value))),str},parse=function(value){var getter,prefix;return prefix=element.intlTelInput("getSelectedCountryData").dialCode,getter=$parse(attrs.ngModel+"_prefix"),getter.assign(scope,prefix),ctrl.$setValidity("phone",isValid(value)),value},ctrl.$formatters.push(format),ctrl.$parsers.push(parse)}}}])}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbLoader",["$rootScope","$compile","PathSvc","TemplateSvc",function($rootScope,$compile,PathSvc,TemplateSvc){return{restrict:"A",replace:!1,scope:{},controllerAs:"LoaderCtrl",controller:["$scope",function($scope){var addScopeId,hideLoader,parentScopeId,removeScopeId,scopeIdArr,showLoader;parentScopeId=$scope.$parent.$id,scopeIdArr=[],addScopeId=function(id){scopeIdArr.push(id),scopeIdArr=_.uniq(scopeIdArr)},removeScopeId=function(id){return scopeIdArr=_.without(scopeIdArr,id),scopeIdArr.length},showLoader=function(e,cscope){var sid;for(sid=cscope.$id;cscope;){if(cscope.$id===parentScopeId){addScopeId(sid),$scope.scopeLoaded=!1;break}cscope=cscope.$parent}},hideLoader=function(e,cscope){removeScopeId(cscope.$id)||($scope.scopeLoaded=!0)},$rootScope.$on("show:loader",showLoader),$rootScope.$on("hide:loader",hideLoader),$scope.scopeLoaded=!1}],link:function(scope,element,attrs){TemplateSvc.get(PathSvc.directivePartial("loader")).then(function(html){var str;_.isString(attrs.bbLoader)&&(str=attrs.bbLoader.slice(1),/^#/.test(attrs.bbLoader)?html.attr("id",str):/^\./.test(attrs.bbLoader)&&html.addClass(str)),element.prepend(html),$compile(html)(scope)})}}}]),app.directive("bbLoadingSpinner",["$compile",function($compile){return{transclude:!0,link:function(scope,element,attrs,controller,transclude){var loadingScopes;return loadingScopes={},scope.isLoading=!1,scope.$on("isLoading",function(event,isLoading){return event.stopPropagation(),loadingScopes[event.targetScope.$id]=isLoading,scope.isLoading=_.every(_.values(loadingScopes))})},template:'<div ng-show="isLoading" class="loader-wrapper">\n  <div class="loader"></div>\n</div>\n<div ng-transclude></div>'}}])}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbContent",["$compile",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){return element.attr("ng-include","bb_main"),element.attr("onLoad","initPage()"),element.attr("bb-content",null),element.attr("ng-hide","hide_page"),scope.initPage=function(_this){return function(){return scope.setPageLoaded(),scope.setLoadingPage(!1)}}(this),$compile(element)(scope)}}}]),angular.module("BB.Directives").directive("bbLoading",["$compile","$timeout","$bbug",function($compile,$timeout,$bbug){return{link:function(scope,element,attrs){var positionLoadingIcon;scope.scopeLoaded=scope.areScopesLoaded(scope),element.attr("ng-hide","scopeLoaded"),element.attr("bb-loading",null),positionLoadingIcon=function(){var center,loading_icon,modal_open,wait_graphic;return loading_icon=$bbug(".bb-loader").find("#loading_icon"),wait_graphic=$bbug(".bb-loader").find("#wait_graphic"),modal_open=$bbug("[ng-app]").find("body").hasClass("modal-open"),modal_open?$timeout(function(){var center;return center=$bbug("[ng-app]").find(".modal-dialog").height()||$bbug("[ng-app]").find(".modal-content").height()||$bbug("[ng-app]").find(".modal").height(),center=center/2-wait_graphic.height()/2,loading_icon.css("padding-top",center+"px")},50):(center=$(window).innerHeight()/2-wait_graphic.height()/2,loading_icon.css("padding-top",center+"px"))},positionLoadingIcon(),$bbug(window).on("resize",function(){return positionLoadingIcon()}),scope.$on("page:loaded",function(){return positionLoadingIcon()}),$compile(element)(scope)}}}]),angular.module("BB.Directives").directive("bbWaitFor",["$compile",function($compile){return{transclude:!1,restrict:"A",priority:800,link:function(scope,element,attrs){var name,prom;name=attrs.bbWaitVar,name||(name="allDone"),scope[name]=!1,prom=scope.$eval(attrs.bbWaitFor),prom.then(function(){return scope[name]=!0})}}}]),angular.module("BB.Directives").directive("bbScrollTo",["$rootScope","AppConfig","BreadcrumbService","$bbug","$window","SettingsService",function($rootScope,AppConfig,BreadcrumbService,$bbug,$window,SettingsService){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){var always_scroll,bb_transition_time,evnts,scrollToCallback;return evnts=attrs.bbScrollTo.split(","),always_scroll=null!=attrs.bbAlwaysScroll||!1,bb_transition_time=null!=attrs.bbTransitionTime?parseInt(attrs.bbTransitionTime,10):500,angular.isArray(evnts)?angular.forEach(evnts,function(evnt){return scope.$on(evnt,function(e){return scrollToCallback(evnt)})}):scope.$on(evnts,function(e){return scrollToCallback(evnts)}),scrollToCallback=function(evnt){var current_step,scroll_to_element;if(scroll_to_element=$bbug("page:loaded"===evnt&&scope.display&&scope.display.xs&&$bbug('[data-scroll-id="'+AppConfig.uid+'"]').length?'[data-scroll-id="'+AppConfig.uid+'"]':element),current_step=BreadcrumbService.getCurrentStep(),scroll_to_element&&("page:loaded"===evnt&&current_step>1||always_scroll||"widget:restart"===evnt||!scroll_to_element.is(":visible")&&0!==scroll_to_element.offset().top))return"parentIFrame"in $window?parentIFrame.scrollToOffset(0,scroll_to_element.offset().top-SettingsService.getScrollOffset()):$bbug("html, body").animate({scrollTop:scroll_to_element.offset().top-SettingsService.getScrollOffset()},bb_transition_time)}}}}]),angular.module("BB.Directives").directive("bbSlotGrouper",function(){return{restrict:"A",scope:!0,link:function(scope,element,attrs){var i,len,slot,slots;if(slots=scope.$eval(attrs.slots)){for(scope.grouped_slots=[],i=0,len=slots.length;i<len;i++)slot=slots[i],slot.time>=scope.$eval(attrs.startTime)&&slot.time<scope.$eval(attrs.endTime)&&scope.grouped_slots.push(slot);return scope.has_slots=scope.grouped_slots.length>0}}}}),angular.module("BB.Directives").directive("bbForm",["$bbug","$window","SettingsService","ValidatorService","$timeout",function($bbug,$window,SettingsService,ValidatorService,$timeout){return{restrict:"A",require:"^form",scope:!0,link:function(scope,elem,attrs,ctrls){return scope.form=ctrls,elem.on("submit",function(){return scope.submitForm(),scope.$apply()}),scope.submitForm=function(){var property;scope.form.submitted=!0;for(property in scope.form)angular.isObject(scope.form[property])&&scope.form[property].hasOwnProperty("$valid")&&(scope.form[property].submitted=!0);return $timeout(function(){var invalid_form_group,invalid_input;if(invalid_form_group=elem.find(".has-error:first"),invalid_form_group&&invalid_form_group.length>0&&!scope.form.raise_alerts)return"parentIFrame"in $window?parentIFrame.scrollToOffset(0,invalid_form_group.offset().top-SettingsService.getScrollOffset()):$bbug("html, body").animate({scrollTop:invalid_form_group.offset().top-SettingsService.getScrollOffset()},1e3),invalid_input=invalid_form_group.find(".ng-invalid"),invalid_input.focus()},100),ValidatorService.validateForm(scope.form)}}}}]),angular.module("BB.Directives").directive("bbAddressMap",["$document",function($document){return{restrict:"A",scope:!0,replace:!0,controller:["$scope","$element","$attrs",function($scope,$element,$attrs){return $scope.isDraggable=$document.width()>480,$scope.$watch($attrs.bbAddressMap,function(new_val,old_val){var map_item;if(new_val)return map_item=new_val,$scope.map={center:{latitude:map_item.lat,longitude:map_item["long"]},zoom:15},$scope.options={scrollwheel:!1,draggable:$scope.isDraggable},$scope.marker={id:0,coords:{latitude:map_item.lat,longitude:map_item["long"]}}})}]}}]),angular.module("BB.Directives").directive("bbMergeDuplicateQuestions",function(){return{restrict:"A",scope:!0,controller:["$scope","$rootScope",function($scope,$rootScope){return $scope.questions={},$rootScope.$on("item_details:loaded",function(){var i,item,j,len,len1,question,ref,ref1;for(ref=$scope.bb.stacked_items,i=0,len=ref.length;i<len;i++)if(item=ref[i],item.item_details&&item.item_details.questions)for(item.item_details.hide_questions=!1,ref1=item.item_details.questions,j=0,len1=ref1.length;j<len1;j++){if(question=ref1[j],$scope.questions[question.id]){item.setCloneAnswers($scope.questions[question.id].item),item.item_details.hide_questions=!0;break}$scope.questions[question.id]={question:question,item:item}}return $scope.has_questions=_.pluck($scope.questions,"question").length>0})}]}}),angular.module("BB.Directives").directive("bbModal",["$window","$bbug","$timeout",function($window,$bbug,$timeout){return{restrict:"A",scope:!0,link:function(scope,elem,attrs){var deregisterWatcher;return $timeout(function(){return elem.parent().parent().parent().css("z-index",999999)},deregisterWatcher=scope.$watch(function(){var height,modal_padding,new_height;if(height=elem.height(),modal_padding=$bbug(window).width()>=769?200:20,height>$bbug(window).height())return new_height=$bbug(window).height()-modal_padding,elem.css({height:new_height+"px","overflow-y":"scroll"}),deregisterWatcher()}))}}}]),angular.module("BB.Directives").directive("bbBackgroundImage",function(){return{restrict:"A",scope:!0,link:function(scope,el,attrs){var killWatch;if(attrs.bbBackgroundImage&&""!==attrs.bbBackgroundImage)return killWatch=scope.$watch(attrs.bbBackgroundImage,function(new_val,old_val){if(new_val)return killWatch(),el.css("background-image",'url("'+new_val+'")')})}}}),angular.module("BB.Directives").directive("bbCapacityView",function(){return{restrict:"A",template:"{{capacity_view_description}}",link:function(scope,el,attrs){var killWatch,ticket_type;return ticket_type=attrs.ticketTypeSingular||"ticket",killWatch=scope.$watch(attrs.bbCapacityView,function(item){var num_spaces_plural,spaces_left_plural;if(item)switch(killWatch(),num_spaces_plural=item.num_spaces>1?"s":"",spaces_left_plural=item.spaces_left>1?"s":"",item.chain.capacity_view){case"NUM_SPACES":return scope.capacity_view_description=scope.ticket_spaces=item.num_spaces+" "+ticket_type+num_spaces_plural;case"NUM_SPACES_LEFT":return scope.capacity_view_description=scope.ticket_spaces=item.spaces_left+" "+ticket_type+spaces_left_plural+" available";case"NUM_SPACES_AND_SPACES_LEFT":return scope.capacity_view_description=scope.ticket_spaces=item.spaces_left+" of "+item.num_spaces+" "+ticket_type+num_spaces_plural+" available"}})}}}),angular.module("BB.Directives").directive("bbTimeZone",["SettingsService",function(SettingsService){return{restrict:"A",link:function(scope,el,attrs){var company_time_zone;if(company_time_zone=SettingsService.getTimeZone(),scope.time_zone_name=moment().tz(company_time_zone).format("zz"),!SettingsService.getUseLocalTimeZone()&&moment.tz.guess()!==company_time_zone)return scope.is_time_zone_diff=!0}}}])}.call(this),function(){angular.module("BB").directive("bbMemberLogin",["PathSvc",function(PathSvc){return{restrict:"A",controller:"MemberLogin",templateUrl:function(elem,attrs){return null!=attrs.bbCustomLoginForm?PathSvc.directivePartial("_member_login_form"):PathSvc.directivePartial("_member_login_schema_form")}}}]),angular.module("BB.Controllers").controller("MemberLogin",["$scope","$log","$rootScope","$templateCache","$q","halClient","BBModel","$sessionStorage","$window","AlertService","LoginService","ValidatorService",function($scope,$log,$rootScope,$templateCache,$q,halClient,BBModel,$sessionStorage,$window,AlertService,LoginService,ValidatorService){
return $scope.login={},$scope.validator=ValidatorService,$rootScope.connection_started.then(function(){return LoginService.checkLogin()?($scope.setClient($rootScope.member),$scope.bb.destination?$scope.redirectTo($scope.bb.destination):($scope.setLoaded($scope),$scope.skipThisStep(),$scope.decideNextPage())):halClient.$get($scope.bb.api_url+"/api/v1").then(function(root){return root.$get("new_login").then(function(new_login){return $scope.form=new_login.form,$scope.schema=new_login.schema},function(err){return console.log("err ",err)})},function(err){return console.log("err ",err)})}),$scope.submit=function(){return $scope.login.role="member",$scope.company.$post("login",{},$scope.login).then(function(login){return login.$has("members")?login.$get("members").then(function(members){return $scope.handleLogin(members[0])}):login.$has("member")?login.$get("member").then(function(member){return $scope.handleLogin(member)}):void 0},function(err){return"Account has been disabled"===err.data.error?AlertService.raise("ACCOUNT_DISABLED"):AlertService.raise("LOGIN_FAILED")})},$scope.handleLogin=function(member){return member=LoginService.setLogin(member,$scope.login.persist_login),$scope.setClient(member),$scope.bb.destination?$scope.redirectTo($scope.bb.destination):($scope.skipThisStep(),$scope.decideNextPage())}}])}.call(this),function(){angular.module("BB.Directives").directive("bbMonthPicker",["PathSvc","$timeout",function(PathSvc,$timeout){return{restrict:"AE",replace:!0,scope:!0,require:["^?bbEvents","^?bbMultiCompanyEvents"],templateUrl:function(element,attrs){return PathSvc.directivePartial("_month_picker")},link:function(scope,el,attrs){var stopWatch;return scope.picker_settings=scope.$eval(attrs.bbMonthPicker)||{},scope.picker_settings.months_to_show=scope.picker_settings.months_to_show||3,stopWatch=scope.$watch(attrs.dayData,function(dates){if(dates)return scope.processDates(dates),stopWatch()})},controller:["$scope",function($scope){return $scope.processDates=function(dates){var cur_month,d,date,datehash,day,day_data,diff,i,j,k,l,last_date,len,m,month,months,ref,w,week;for(datehash={},i=0,len=dates.length;i<len;i++)date=dates[i],datehash[date.date.format("DDMMYY")]=date,!$scope.first_available_day&&date.spaces>0&&($scope.first_available_day=date.date);for(cur_month=$scope.picker_settings.start_at_first_available_day?$scope.first_available_day.clone().startOf("month"):moment().startOf("month"),last_date=_.last(dates),diff=last_date.date.diff(cur_month,"months"),diff=diff>0?diff+1:1,$scope.num_months=$scope.picker_settings&&$scope.picker_settings.months?$scope.picker_settings.months:diff,months=[],m=j=1,ref=$scope.num_months;1<=ref?j<=ref:j>=ref;m=1<=ref?++j:--j){for(date=cur_month.clone().startOf("week"),month={weeks:[]},month.index=m-1,w=k=1;k<=6;w=++k){for(week={days:[]},d=l=1;l<=7;d=++l)date.isSame(date.clone().startOf("month"),"day")&&!month.start_date&&(month.start_date=date.clone()),day_data=datehash[date.format("DDMMYY")],day={date:date.clone(),data:day_data,available:day_data&&day_data.spaces&&day_data.spaces>0,today:moment().isSame(date,"day"),past:date.isBefore(moment(),"day"),disabled:!month.start_date||!date.isSame(month.start_date,"month")},week.days.push(day),$scope.selected_date&&day.date.isSame($scope.selected_date,"day")&&(day.selected=!0,$scope.selected_day=day),date.add(1,"day");month.weeks.push(week)}months.push(month),cur_month.add(1,"month")}return $scope.months=months,$scope.slick_config={nextArrow:".month-next",prevArrow:".month-prev",slidesToShow:$scope.months.length>=$scope.picker_settings.months_to_show?$scope.picker_settings.months_to_show:$scope.months.length,infinite:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:$scope.months.length>=2?2:$scope.months.length}},{breakpoint:992,settings:{slidesToShow:1}}],method:{},event:{init:function(event,slick){return $timeout(function(){var len1,n,ref1,results;if(null!=$scope.selected_day){for(ref1=$scope.months,results=[],n=0,len1=ref1.length;n<len1;n++)m=ref1[n],m.start_date.month()===$scope.selected_day.date.month()?results.push(slick.slickGoTo(m.index)):results.push(void 0);return results}})}}}},$scope.$on("event_list_filter_date:changed",function(event,date){if($scope.selected_day)return $scope.selected_day.selected=!1}),$scope.toggleDay=function(day){if(day&&(!day.data||0!==day.data.spaces&&!day.disabled&&day.available)&&(day.data||day._d))return $scope.selected_day&&($scope.selected_day.selected=!1),(!$scope.selected_day||$scope.selected_day&&!day.date.isSame($scope.selected_day.date,"day"))&&(day.selected=!0,$scope.selected_day=day),$scope.showDay(day.date)}}]}}])}.call(this),function(){angular.module("BB.Directives").directive("ngOptions",["$sniffer","$rootScope",function($sniffer,$rootScope){return{restrict:"A",link:function(scope,el,attrs){var size;if(size=parseInt(attrs.size,10),!isNaN(size)&&size>1&&$sniffer.msie)return $rootScope.$on("loading:finished",function(){return el.focus(),$("body").focus()})}}}])}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("script",["$compile","halClient",function($compile,halClient){return{transclude:!1,restrict:"E",link:function(scope,element,attrs){var body,json,res;if("text/hal-object"===attrs.type)return body=element[0].innerText,json=$bbug.parseJSON(body),res=halClient.$parse(json)}}}])}.call(this),function(){angular.module("BB.Directives").directive("bbPaymentButton",["$compile","$sce","$http","$templateCache","$q","$log","TemplateSvc",function($compile,$sce,$http,$templateCache,$q,$log,TemplateSvc){return{restrict:"EA",replace:!0,scope:{total:"=",bb:"=",decideNextPage:"=",notLoaded:"=",setLoaded:"="},link:function(scope,element,attributes){var getButtonFormTemplate,getTemplate,killWatch,setClassAndValue;return getTemplate=function(type,scope){switch(type){case"button_form":return getButtonFormTemplate(scope);case"page":return TemplateSvc.get("payment.html");case"location":return"<a href='{{payment_link}}'>{{label}}</a>";default:return""}},getButtonFormTemplate=function(scope){var src;return src=$sce.parseAsResourceUrl("'"+scope.payment_link+"'")(),$http.get(src,{}).then(function(response){return response.data})},setClassAndValue=function(scope,element,attributes){var c,i,inputs,j,len,main_tag,ref,results;switch(scope.link_type){case"button_form":inputs=element.find("input"),main_tag=function(){var j,len,results;for(results=[],j=0,len=inputs.length;j<len;j++)i=inputs[j],"submit"===$(i).attr("type")&&results.push(i);return results}()[0],attributes.value&&$(main_tag).attr("value",attributes.value);break;case"page":case"location":main_tag=element.find("a")[0]}if(attributes["class"]){for(ref=attributes["class"].split(" "),results=[],j=0,len=ref.length;j<len;j++)c=ref[j],$(main_tag).addClass(c),results.push($(element).removeClass(c));return results}},killWatch=scope.$watch("total",function(total){var url;if(total&&total.$has("new_payment"))return killWatch(),scope.bb.payment_status="pending",scope.bb.total=scope.total,scope.link_type=scope.total.$link("new_payment").type,scope.label=attributes.value||"Make Payment",scope.payment_link=scope.total.$href("new_payment"),url=scope.total.$href("new_payment"),$q.when(getTemplate(scope.link_type,scope)).then(function(template){return element.html(template).show(),$compile(element.contents())(scope),setClassAndValue(scope,element,attributes)},function(err){return $log.warn(err.data),element.remove()})})}}}]),angular.module("BB.Directives").directive("bbPaypalExpressButton",["$compile","$sce","$http","$templateCache","$q","$log","$window","UriTemplate",function($compile,$sce,$http,$templateCache,$q,$log,$window,UriTemplate){return{restrict:"EA",replace:!0,template:'<a ng-href="{{href}}" ng-click="showLoader()">Pay</a>',scope:{total:"=",bb:"=",decideNextPage:"=",paypalOptions:"=bbPaypalExpressButton",notLoaded:"="},link:function(scope,element,attributes){var paypalOptions,total;return total=scope.total,paypalOptions=scope.paypalOptions,scope.href=new UriTemplate(total.$link("paypal_express").href).fillFromObject(paypalOptions),scope.showLoader=function(){if(scope.notLoaded)return scope.notLoaded(scope)}}}}])}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbPaypal",["PathSvc",function(PathSvc){return{restrict:"A",replace:!0,scope:{ppDetails:"=bbPaypal"},templateUrl:PathSvc.directivePartial("paypal_button"),link:function(scope,element,attrs){var keys;if(scope.inputs=[],scope.ppDetails)return keys=_.keys(scope.ppDetails),_.each(keys,function(keyName){var obj;return obj={name:keyName,value:scope.ppDetails[keyName]},scope.inputs.push(obj)})}}}])}.call(this),function(){angular.module("BB.Directives").directive("pricepicker",function(){var controller,link;return controller=function($scope){return $scope.$watch("price",function(price){if(null!=price)return $scope.updateModel(price)})},link=function(scope,element,attrs,ngModel){return ngModel.$render=function(){if(ngModel.$viewValue)return scope.price=ngModel.$viewValue},scope.updateModel=function(value){return ngModel.$setViewValue(value)}},{require:"ngModel",link:link,controller:controller,scope:{currency:"@"},template:'<span>{{0 | currency: currency | limitTo: 1}}</span>\n<input type="number" ng-model="price" class="form-control" step="0.01">'}})}.call(this),function(){angular.module("BB.Directives").directive("scoped",["$document","$timeout",function($document,$timeout){var scopeIt;return this.compat=function(){var DOMRules,DOMStyle,changeSelectorTextAllowed,check,e,error,scopeSupported,testSheet,testStyle;check=document.createElement("style"),DOMStyle="undefined"!=typeof check.sheet?"sheet":"undefined"!=typeof check.getSheet?"getSheet":"styleSheet",scopeSupported=void 0!==check.scoped,document.body.appendChild(check),testSheet=check[DOMStyle],testSheet.addRule?testSheet.addRule("c","blink"):testSheet.insertRule("c{}",0),DOMRules=testSheet.rules?"rules":"cssRules",testStyle=testSheet[DOMRules][0];try{testStyle.selectorText="d"}catch(error){e=error}return changeSelectorTextAllowed="d"===testStyle.selectorText.toLowerCase(),check.parentNode.removeChild(check),{scopeSupported:scopeSupported,rules:DOMRules,sheet:DOMStyle,changeSelectorTextAllowed:changeSelectorTextAllowed}}(),scopeIt=function(_this){return function(element){var allRules,glue,id,idCounter,index,par,results,rule,selector,sheet,styleNode,styleRule;if(styleNode=element[0],idCounter=0,sheet=styleNode[_this.compat.sheet]){for(allRules=sheet[_this.compat.rules],par=styleNode.parentNode,id=par.id||(par.id="scopedByScopedPolyfill_"+ ++idCounter),glue="",index=allRules.length||0;par;)par.id&&(glue="#"+par.id+" "+glue),par=par.parentNode;for(results=[];index--;)rule=allRules[index],rule.selectorText?rule.selectorText.match(new RegExp(glue))?results.push(void 0):(selector=glue+" "+rule.selectorText.split(",").join(", "+glue),selector=selector.replace(/[\ ]+:root/gi,""),_this.compat.changeSelectorTextAllowed?results.push(rule.selectorText=selector):rule.type&&1!==rule.type?results.push(void 0):(styleRule=rule.style.cssText,styleRule?(sheet.removeRule?sheet.removeRule(index):sheet.deleteRule(index),sheet.addRule?results.push(sheet.addRule(selector,styleRule)):results.push(sheet.insertRule(selector+"{"+styleRule+"}",index))):results.push(void 0))):results.push(void 0);return results}}}(this),{restrict:"A",link:function(scope,element,attrs){if(scope.scopeSupported=this.compat.scopeSupported,!this.compat.scopeSupported)return $timeout(function(){return scopeIt(element)})},controller:["$scope","$element","$timeout",function($scope,$element,$timeout){$scope.scopeSupported||(this.updateCss=function(){return $timeout(function(){return scopeIt($element)})})}]}}])}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("bbDisplayMode",["$compile","$window","$bbug","ViewportSize",function($compile,$window,$bbug,ViewportSize){return{transclude:!1,restrict:"A",template:'<span class="visible-xs">&nbsp;</span><span class="visible-sm">&nbsp;</span><span class="visible-md">&nbsp;</span><span class="visible-lg">&nbsp;</span>',link:function(scope,elem,attrs){var getCurrentSize,isVisible,markers,t,update;return markers=elem.find("span"),$bbug(elem).addClass("bb-display-mode"),scope.display={},isVisible=function(element){return element&&"none"!==element.style.display&&element.offsetWidth&&element.offsetHeight},getCurrentSize=function(){var currentSize,element,i,len;for(currentSize=!1,i=0,len=markers.length;i<len;i++)if(element=markers[i],isVisible(element)){currentSize=element.className.slice(8,11),ViewportSize.setViewportSize(element.className.slice(8,11));break}return currentSize},update=function(_this){return function(){var nsize;return nsize=getCurrentSize(),nsize!==_this.currentSize&&(_this.currentSize=nsize,scope.display.xs=!1,scope.display.sm=!1,scope.display.md=!1,scope.display.lg=!1,scope.display.not_xs=!0,scope.display.not_sm=!0,scope.display.not_md=!0,scope.display.not_lg=!0,scope.display[nsize]=!0,scope.display["not_"+nsize]=!1,!0)}}(this),t=null,angular.element($window).bind("resize",function(_this){return function(){return window.clearTimeout(t),t=setTimeout(function(){if(update())return scope.$apply()},50)}}(this)),angular.element($window).bind("load",function(_this){return function(){if(update())return scope.$apply()}}(this))}}}])}.call(this),function(){angular.module("BB.Directives").directive("bbToggleEdit",["$compile","$window","$document",function($compile,$window,$document){return{restrict:"AE",link:function(scope,element,attr){return scope.editing=!1,element.on("dblclick",function(_this){return function(event){return scope.$apply(function(){return scope.editing=!0})}}(this)),$document.on("click",function(_this){return function(){if(!element.is(":hover"))return scope.$apply(function(){return scope.editing=!1})}}(this)),!0}}}])}.call(this),function(){angular.module("BB.Directives").directive("popover",function(){var openElement,openScope;return openElement=null,openScope=null,$('div[ng-controller="BBCtrl"]').off(".bbtooltip").on("click.bbtooltip",function(e){var target;return target=$(e.target).closest("[popover]")[0],!target&&openElement&&openScope&&($(openElement).next(".popover").remove(),openScope.tt_isOpen=!1),!0}),{restrict:"EA",priority:-1e3,link:function(scope,element){return element.on("click.bbtooltip",function(e){return openElement===$(e.target).closest("[popover]")[0]?void e.preventDefault():(openElement&&openScope&&($(openElement).next(".popover").remove(),openScope.tt_isOpen=!1),openElement=element[0],openScope=scope)}),scope.$on("$destroy",function(){return $(element).off(".bbtooltip")})}}})}.call(this),function(angular){"use strict";var app=angular.module("BB.Directives");app.directive("appVersion",["version",function(version){return function(scope,elm,attrs){elm.text(version)}}])}(window.angular),function(){var app;app=angular.module("BB.Filters"),angular.module("BB.Filters").filter("stripPostcode",function(){return function(address){var match;return match=address.toLowerCase().match(/[a-z]+\d/),match&&(address=address.substr(0,match.index)),address=$.trim(address),/,$/.test(address)&&(address=address.slice(0,-1)),address}}),angular.module("BB.Filters").filter("labelNumber",function(){return function(input,labels){var response;return response=input,labels[input]&&(response=labels[input]),response}}),angular.module("BB.Filters").filter("interpolate",["version",function(version){return function(text){return String(text).replace(/\%VERSION\%/gm,version)}}]),angular.module("BB.Filters").filter("rag",function(){return function(value,v1,v2){return value<=v1?"red":value<=v2?"amber":"green"}}),angular.module("BB.Filters").filter("time",["$window",function($window){return function(v){return $window.sprintf("%02d:%02d",Math.floor(v/60),v%60)}}]),angular.module("BB.Filters").filter("address_single_line",function(){return function(_this){return function(address){var addr;if(address&&address.address1)return addr="",addr+=address.address1,address.address2&&address.address2.length>0&&(addr+=", ",addr+=address.address2),address.address3&&address.address3.length>0&&(addr+=", ",addr+=address.address3),address.address4&&address.address4.length>0&&(addr+=", ",addr+=address.address4),address.address5&&address.address5.length>0&&(addr+=", ",addr+=address.address5),address.postcode&&address.postcode.length>0&&(addr+=", ",addr+=address.postcode),addr}}(this)}),angular.module("BB.Filters").filter("address_multi_line",function(){return function(_this){return function(address){var str;if(address&&address.address1)return str="",address.address1&&(str+=address.address1),address.address2&&str.length>0&&(str+="<br/>"),address.address2&&(str+=address.address2),address.address3&&str.length>0&&(str+="<br/>"),address.address3&&(str+=address.address3),address.address4&&str.length>0&&(str+="<br/>"),address.address4&&(str+=address.address4),address.address5&&str.length>0&&(str+="<br/>"),address.address5&&(str+=address.address5),address.postcode&&str.length>0&&(str+="<br/>"),address.postcode&&(str+=address.postcode),str}}(this)}),angular.module("BB.Filters").filter("map_lat_long",function(){return function(_this){return function(address){var cord;if(address&&address.map_url)return cord=/([-+]*\d{1,3}[\.]\d*)[, ]([-+]*\d{1,3}[\.]\d*)/.exec(address.map_url),cord[0]}}(this)}),angular.module("BB.Filters").filter("currency",["$filter",function($filter){return function(_this){return function(number,currencyCode){return $filter("icurrency")(number,currencyCode)}}(this)}]),angular.module("BB.Filters").filter("icurrency",["$window","SettingsService",function($window,SettingsService){return function(_this){return function(number,currencyCode){var currency,decimal,format,thousand;return currencyCode||(currencyCode=SettingsService.getCurrency()),currency={USD:"$",GBP:"",AUD:"$",EUR:"",CAD:"$",MIXED:"~"},$.inArray(currencyCode,["USD","AUD","CAD","MIXED","GBP"])>=0?(thousand=",",decimal=".",format="%s%v"):(thousand=".",decimal=",",format="%s%v"),number/=100,$window.accounting.formatMoney(number,currency[currencyCode],2,thousand,decimal,format)}}(this)}]),angular.module("BB.Filters").filter("raw_currency",function(){return function(_this){return function(number){return number/100}}(this)}),angular.module("BB.Filters").filter("pretty_price",["$filter",function($filter){return function(price,symbol){return $filter("ipretty_price")(price,symbol)}}]),angular.module("BB.Filters").filter("ipretty_price",["$window","SettingsService",function($window,SettingsService){return function(price,symbol){var currency;return symbol||(currency={USD:"$",GBP:"",AUD:"$",EUR:"",CAD:"$",MIXED:"~"},symbol=currency[SettingsService.getCurrency()]),price/=100,0===parseFloat(price)?"Free":parseFloat(price)%1===0?symbol+parseFloat(price):symbol+$window.sprintf("%.2f",parseFloat(price))}}]),angular.module("BB.Filters").filter("time_period",function(){return function(v,options){var hour_string,hours,min_string,mins,separator,str,val;if(angular.isNumber(v))return hour_string=options&&options.abbr_units?"hr":"hour",min_string=options&&options.abbr_units?"min":"minute",separator=options&&angular.isString(options.separator)?options.separator:"and",val=parseInt(v),val<60?(str=val+" "+min_string,val>1&&(str+="s"),str):(hours=parseInt(val/60),mins=val%60,0===mins?1===hours?"1 "+hour_string:hours+" "+hour_string+"s":(str=hours+" "+hour_string,hours>1&&(str+="s"),0===mins?str:(separator.length>0&&(str+=" "+separator),str+=" "+mins+" "+min_string,mins>1&&(str+="s"),str)))}}),angular.module("BB.Filters").filter("twelve_hour_time",["$window",function($window){return function(time,options){var h,m,omit_mins_on_hour,separator,suffix,t;if(angular.isNumber(time))return omit_mins_on_hour=options&&options.omit_mins_on_hour||!1,separator=options&&options.separator?options.separator:":",t=time,h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),time=0===m&&omit_mins_on_hour?""+h:""+h+separator+$window.sprintf("%02d",m),time+=suffix}}]),angular.module("BB.Filters").filter("time_period_from_seconds",function(){return function(v){var hours,mins,secs,str,val;if(val=parseInt(v),val<60)return""+val+" seconds";if(hours=Math.floor(val/3600),mins=Math.floor(val%3600/60),secs=Math.floor(val%60),str="",hours>0){if(str+=hours+" hour",hours>1&&(str+="s"),0===mins&&0===secs)return str;str+=" and "}if(mins>0){if(str+=mins+" minute",mins>1&&(str+="s"),0===secs)return str;str+=" and "}return str+=secs+" second",secs>0&&(str+="s"),str}}),angular.module("BB.Filters").filter("round_up",function(){return function(number,interval){var result;return result=number/interval,result=parseInt(result),result*=interval,number%interval>0&&(result+=interval),result}}),angular.module("BB.Filters").filter("exclude_days",function(){return function(days,excluded){return _.filter(days,function(day){return excluded.indexOf(day.date.format("dddd"))===-1})}}),angular.module("BB.Filters").filter("local_phone_number",["SettingsService","ValidatorService",function(SettingsService,ValidatorService){return function(phone_number){var cc;if(phone_number)switch(cc=SettingsService.getCountryCode()){case"gb":return phone_number.replace(/^(\+44 \(0\)|\S{0})/,"0");case"us":return phone_number.replace(ValidatorService.us_phone_number,"($1) $2 $3");default:return phone_number}}}]),angular.module("BB.Filters").filter("datetime",["SettingsService",function(SettingsService){var hardcoded_formats;return hardcoded_formats={datetime:{us:"MM/DD/YYYY, h:mm a",uk:"DD/MM/YYYY, HH:mm"},date:{us:"MM/DD/YYYY",uk:"DD/MM/YYYY"},time:{us:"h:mm a",uk:"HH:mm"}},function(date,format,show_time_zone){var cc,new_date;if(null==format&&(format="LLL"),null==show_time_zone&&(show_time_zone=!1),hardcoded_formats[format]&&(cc="us"===SettingsService.getCountryCode()?"us":"uk",format=hardcoded_formats[format][cc]),date&&moment.isMoment(date))return new_date=date.clone(),new_date.tz(SettingsService.getDisplayTimeZone()),show_time_zone&&(format+=" zz"),new_date.format(format)}}]),angular.module("BB.Filters").filter("range",function(){return function(input,min,max){var i,j,ref,ref1;for(i=j=ref=parseInt(min),ref1=parseInt(max);ref<=ref1?j<=ref1:j>=ref1;i=ref<=ref1?++j:--j)input.push(i);return input}}),angular.module("BB.Filters").filter("international_number",function(){return function(_this){return function(number,prefix){return number&&prefix?prefix+" "+number:number?""+number:""}}(this)}),angular.module("BB.Filters").filter("startFrom",function(){return function(input,start){return void 0===input?input:input.slice(+start)}}),angular.module("BB.Filters").filter("add",function(){return function(_this){return function(item,value){if(item&&value)return item=parseInt(item),item+value}}(this)}),angular.module("BB.Filters").filter("spaces_remaining",function(){return function(spaces){return spaces<1?0:spaces}}),angular.module("BB.Filters").filter("key_translate",function(){return function(input){var add_underscore,remove_punctuations,upper_case;return upper_case=angular.uppercase(input),remove_punctuations=upper_case.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,""),add_underscore=remove_punctuations.replace(/\ /g,"_")}}),angular.module("BB.Filters").filter("nl2br",function(){return function(str){if(str)return str.replace(/\n/g,"<br/>")}}),app.filter("clearTimezone",function(){return function(val,offset){return null!==val&&val.length>19?val.substring(0,19):val}}),app.filter("format_answer",function(){return function(answer){return"boolean"==typeof answer?answer=answer===!0?"Yes":"No":moment(answer,"YYYY-MM-DD",!0).isValid()&&(answer=moment(answer).format("D MMMM YYYY")),answer}})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("AddressModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Address;return Address=function(superClass){function Address(data){Address.__super__.constructor.call(this,data),this.map_url&&""!==this.map_url||this.lat&&this["long"]&&(this.map_url="https://www.google.com/maps/@"+this.lat+","+this["long"]+",17z")}return extend(Address,superClass),Address.prototype.addressSingleLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+=", "),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+=", "),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+=", "),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+=", "),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+=", "),this.postcode&&(str+=this.postcode),str},Address.prototype.hasAddress=function(){return this.address1||this.address2||this.postcode},Address.prototype.addressCsvLine=function(){var str;return str="",this.address1&&(str+=this.address1),str+=", ",this.address2&&(str+=this.address2),str+=", ",this.address3&&(str+=this.address3),str+=", ",this.address4&&(str+=this.address4),str+=", ",this.address5&&(str+=this.address5),str+=", ",this.postcode&&(str+=this.postcode),str+=", ",this.country&&(str+=this.country),str},Address.prototype.addressMultiLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+="<br/>"),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+="<br/>"),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+="<br/>"),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+="<br/>"),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+="<br/>"),this.postcode&&(str+=this.postcode),str},Address}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("AffiliateModel",["$q","BBModel","BaseModel","halClient","$rootScope",function($q,BBModel,BaseModel,halClient,$rootScope){var Affiliate;return Affiliate=function(superClass){function Affiliate(data){Affiliate.__super__.constructor.call(this,data),this.test=1}return extend(Affiliate,superClass),Affiliate.prototype.getCompanyByRef=function(ref){var defer,href,prms,uri;return prms={id:this.cookie,reference:ref},href=$rootScope.bb.api_url+"/api/v1/affiliates/{id}/companies/{reference}",uri=new UriTemplate(href).fillFromObject(prms||{}),defer=$q.defer(),halClient.$get(uri,{}).then(function(company){return company?defer.resolve(new BBModel.Company(company)):defer.reject("No company for ref "+ref)},function(err){return console.log("err ",err),defer.reject(err)}),defer.promise},Affiliate}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("AnswerModel",["$q","BBModel","BaseModel","$bbug",function($q,BBModel,BaseModel,$bbug){var Answer;return Answer=function(superClass){function Answer(data){Answer.__super__.constructor.call(this,data)}return extend(Answer,superClass),Answer.prototype.getQuestion=function(){var defer;return defer=$q.defer(),this.question&&defer.resolve(this.question),this._data.$has("question")?this._data.$get("question").then(function(_this){return function(question){return _this.question=question,defer.resolve(_this.question)}}(this)):defer.resolve([]),defer.promise},Answer}(BaseModel)}])}.call(this),function(){angular.module("BB.Models").service("BBModel",["$q","$injector",function($q,$injector){var admin_models,afuncs,fn,fn1,fn2,fn3,funcs,i,j,k,l,len,len1,len2,len3,member_models,mfuncs,model,models,pfuncs,purchase_models;for(models=["Address","Answer","Affiliate","Basket","BasketItem","BookableItem","Category","Client","ClientDetails","Company","CompanySettings","Day","Event","EventChain","EventGroup","EventTicket","EventSequence","ItemDetails","Person","PurchaseItem","PurchaseTotal","Question","Resource","Service","Slot","Space","Clinic","SurveyQuestion","TimeSlot","BusinessQuestion","Image","Deal","PrePaidBooking","MembershipLevel","Product","BBCollection","ExternalPurchase","PackageItem","BulkPurchase","Pagination","Reason"],funcs={},fn=function(_this){return function(model){return funcs[model]=function(p1,p2){return new($injector.get(model+"Model"))(p1,p2)}}}(this),i=0,len=models.length;i<len;i++)model=models[i],fn(model);for(purchase_models=["Booking","Total","CourseBooking"],pfuncs={},fn1=function(_this){return function(model){return pfuncs[model]=function(init){return new($injector.get("Purchase."+model+"Model"))(init)}}}(this),j=0,len1=purchase_models.length;j<len1;j++)model=purchase_models[j],fn1(model);for(funcs.Purchase=pfuncs,member_models=["Member","Booking","PrePaidBooking","Wallet","WalletLog","Purchase","PurchaseItem","WalletPurchaseBand"],mfuncs={},fn2=function(_this){return function(model){return mfuncs[model]=function(init){return new($injector.get("Member."+model+"Model"))(init)}}}(this),k=0,len2=member_models.length;k<len2;k++)model=member_models[k],fn2(model);for(funcs.Member=mfuncs,admin_models=["Booking","Slot","User","Administrator","Schedule","Address","Resource","Person","Service","Login","EventChain","EventGroup","Event","Queuer","ClientQueue","Clinic"],afuncs={},fn3=function(_this){return function(model){return afuncs[model]=function(init){return new($injector.get("Admin."+model+"Model"))(init)}}}(this),l=0,len3=admin_models.length;l<len3;l++)model=admin_models[l],fn3(model);return funcs.Admin=afuncs,funcs}]),angular.module("BB.Models").service("BaseModel",["$q","$injector","$rootScope","$timeout",function($q,$injector,$rootScope,$timeout){var Base;return Base=function(){function Base(data){this.deleted=!1,this.updateModel(data)}return Base.prototype.updateModel=function(data){var link,links,m,n,name,obj,results;if(data&&(this._data=data),data)for(n in data)m=data[n],this[n]=m;if(this._data&&this._data.$href){this.self=this._data.$href("self"),links=this.$links(),this.__linkedData={},this.__linkedPromises={},results=[];for(link in links)obj=links[link],name=this._snakeToCamel("get_"+link),results.push(function(_this){return function(link,obj,name){if(_this[name]||(_this[name]=function(){return this.$buildOject(link)}),!_this[name+"Promise"])return _this[name+"Promise"]=function(){return this.$buildOjectPromise(link)}}}(this)(link,obj,name));return results}},Base.prototype._snakeToCamel=function(s){return s.replace(/(\_\w)/g,function(m){return m[1].toUpperCase()})},Base.prototype.$buildOject=function(link){return this.__linkedData[link]?this.__linkedData[link]:(this.$buildOjectPromise(link).then(function(_this){return function(ans){return _this.__linkedData[link]=ans,$timeout(function(){return _this.__linkedData[link]=ans})}}(this)),null)},Base.prototype.$buildOjectPromise=function(link){var prom;return this.__linkedPromises[link]?this.__linkedPromises[link]:(prom=$q.defer(),this.__linkedPromises[link]=prom.promise,this.$get(link).then(function(_this){return function(res){var inj;return inj=$injector.get("BB.Service."+link),inj?inj.promise?inj.unwrap(res).then(function(ans){return prom.resolve(ans)},function(err){return prom.reject(err)}):prom.resolve(inj.unwrap(res)):prom.resolve(res)}}(this),function(err){return prom.reject(err)}),this.__linkedPromises[link])},Base.prototype.get=function(ikey){return this._data?this._data[ikey]:null},Base.prototype.set=function(ikey,value){return this._data?this._data[ikey]=value:null},Base.prototype.$href=function(rel,params){
if(this._data)return this._data.$href(rel,params)},Base.prototype.$has=function(rel){if(this._data)return this._data.$has(rel)},Base.prototype.$flush=function(rel,params){if(this._data)return this._data.$href(rel,params)},Base.prototype.$get=function(rel,params){if(this._data)return this._data.$get(rel,params)},Base.prototype.$post=function(rel,params,dat){if(this._data)return this._data.$post(rel,params,dat)},Base.prototype.$put=function(rel,params,dat){if(this._data)return this._data.$put(rel,params,dat)},Base.prototype.$patch=function(rel,params,dat){if(this._data)return this._data.$patch(rel,params,dat)},Base.prototype.$del=function(rel,params,dat){if(this._data)return this._data.$del(rel,params,dat)},Base.prototype.$links=function(){if(this._data)return this._data.$links()},Base.prototype.$toStore=function(){if(this._data)return this._data.$toStore()},Base}()}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BasketModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Basket;return Basket=function(superClass){function Basket(data,scope){scope&&scope.isAdmin?this.is_admin=scope.isAdmin:this.is_admin=!1,null!=scope&&scope.parent_client&&(this.parent_client_id=scope.parent_client.id),this.items=[],Basket.__super__.constructor.call(this,data),this.reviewed=!1}return extend(Basket,superClass),Basket.prototype.addItem=function(item){var i,j,len,ref;for(ref=this.items,j=0,len=ref.length;j<len;j++){if(i=ref[j],i===item)return;if(i.id&&item.id&&i.id===item.id)return}return this.items.push(item)},Basket.prototype.clear=function(){return this.items=[]},Basket.prototype.clearItem=function(item){return this.items=this.items.filter(function(i){return i!==item})},Basket.prototype.itemsReady=function(){var i,j,len,ready,ref;if(this.items.length>0){for(ready=!0,ref=this.items,j=0,len=ref.length;j<len;j++)i=ref[j],i.checkReady()||(ready=!1);return ready}return!1},Basket.prototype.readyToCheckout=function(){var i,j,len,ready,ref;if(this.items.length>0&&this.reviewed){for(ready=!0,ref=this.items,j=0,len=ref.length;j<len;j++)i=ref[j],i.checkReady()||(ready=!1);return ready}return!1},Basket.prototype.timeItems=function(){var i,j,len,ref,titems;for(titems=[],ref=this.items,j=0,len=ref.length;j<len;j++)i=ref[j],i.isTimeItem()&&titems.push(i);return titems},Basket.prototype.hasTimeItems=function(){var i,j,len,ref;for(ref=this.items,j=0,len=ref.length;j<len;j++)if(i=ref[j],i.isTimeItem())return!0;return!1},Basket.prototype.basketItems=function(){var bitems,i,j,len,ref;for(bitems=[],ref=this.items,j=0,len=ref.length;j<len;j++)i=ref[j],i.is_coupon||bitems.push(i);return bitems},Basket.prototype.externalPurchaseItems=function(){var eitems,i,j,len,ref;for(eitems=[],ref=this.items,j=0,len=ref.length;j<len;j++)i=ref[j],i.isExternalPurchase()&&eitems.push(i);return eitems},Basket.prototype.couponItems=function(){var citems,i,j,len,ref;for(citems=[],ref=this.items,j=0,len=ref.length;j<len;j++)i=ref[j],i.is_coupon&&citems.push(i);return citems},Basket.prototype.removeCoupons=function(){return this.items=_.reject(this.items,function(x){return x.is_coupon})},Basket.prototype.setSettings=function(set){if(set)return this.settings||(this.settings={}),$.extend(this.settings,set)},Basket.prototype.setClient=function(client){return this.client=client},Basket.prototype.setClientDetails=function(client_details){return this.client_details=new BBModel.PurchaseItem(client_details)},Basket.prototype.getPostData=function(){var item,j,len,post,ref;for(post={client:this.client.getPostData(),settings:this.settings,reference:this.reference},post.is_admin=this.is_admin,post.parent_client_id=this.parent_client_id,post.take_from_wallet=this.take_from_wallet,post.items=[],ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],post.items.push(item.getPostData());return post},Basket.prototype.dueTotal=function(){var item,j,len,ref,total;for(total=this.totalPrice(),ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.isWaitlist()&&(total-=item.price);return total<0&&(total=0),total},Basket.prototype.length=function(){return this.items.length},Basket.prototype.questionPrice=function(options){var item,j,len,price,ref,unready;for(unready=options&&options.unready,price=0,ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],(!item.ready&&unready||!unready)&&(price+=item.questionPrice());return price},Basket.prototype.totalPrice=function(options){var item,j,len,price,ref,unready;for(unready=options&&options.unready,price=0,ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],(!item.ready&&unready||!unready)&&(price+=item.totalPrice());return price},Basket.prototype.updateTotalPrice=function(options){return this.total_price=this.totalPrice(options)},Basket.prototype.fullPrice=function(){var item,j,len,price,ref;for(price=0,ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],price+=item.fullPrice();return price},Basket.prototype.hasCoupon=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;j<len;j++)if(item=ref[j],item.is_coupon)return!0;return!1},Basket.prototype.totalCoupons=function(){return this.fullPrice()-this.totalPrice()-this.totalDealPaid()},Basket.prototype.totalDuration=function(){var duration,item,j,len,ref;for(duration=0,ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.service&&item.service.listed_duration&&(duration+=item.service.listed_duration);return duration},Basket.prototype.containsDeal=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;j<len;j++)if(item=ref[j],item.deal_id)return!0;return!1},Basket.prototype.hasDeal=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;j<len;j++)if(item=ref[j],item.deal_codes&&item.deal_codes.length>0)return!0;return!1},Basket.prototype.getDealCodes=function(){return this.deals=this.items[0]&&this.items[0].deal_codes?this.items[0].deal_codes:[],this.deals},Basket.prototype.totalDeals=function(){var deal,j,len,ref,value;for(value=0,ref=this.getDealCodes(),j=0,len=ref.length;j<len;j++)deal=ref[j],value+=deal.value;return value},Basket.prototype.totalDealPaid=function(){var item,j,len,ref,total_cert_paid;for(total_cert_paid=0,ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.certificate_paid&&(total_cert_paid+=item.certificate_paid);return total_cert_paid},Basket.prototype.remainingDealBalance=function(){return this.totalDeals()-this.totalDealPaid()},Basket.prototype.hasWaitlistItem=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;j<len;j++)if(item=ref[j],item.isWaitlist())return!0;return!1},Basket.prototype.hasExternalPurchase=function(){var item,j,len,ref;for(ref=this.items,j=0,len=ref.length;j<len;j++)if(item=ref[j],item.isExternalPurchase())return!0;return!1},Basket.prototype.useWallet=function(value,client){return client&&client.$has("wallet")&&value?(this.take_from_wallet=!0,!0):(this.take_from_wallet=!1,!1)},Basket.prototype.voucherRemainder=function(){var amount,item,j,len,ref;for(amount=0,ref=this.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.voucher_remainder&&(amount+=item.voucher_remainder);return amount},Basket}(BaseModel)}])}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BasketItemModel",["$q","$window","BBModel","BookableItemModel","BaseModel","$bbug","DateTimeUtilitiesService","SettingsService",function($q,$window,BBModel,BookableItemModel,BaseModel,$bbug,DateTimeUtilitiesService,SettingsService){var BasketItem;return BasketItem=function(superClass){function BasketItem(data,bb){this.fullPrice=bind(this.fullPrice,this),this.totalPrice=bind(this.totalPrice,this),this.getQty=bind(this.getQty,this),this.questionPrice=bind(this.questionPrice,this);var chain,comp,per,res,serv,t;BasketItem.__super__.constructor.call(this,data),this.ready=!1,this.days_link=null,this.book_link=null,this.parts_links={},this.settings||(this.settings={}),this.has_questions=!1,this.ref||(this.ref=Math.ceil(moment().unix()*Math.random())),this.time&&(this.time=new BBModel.TimeSlot({time:this.time,event_id:this.event_id,selected:!0,avail:1,price:this.price})),this.date&&(this.date=new BBModel.Day({date:this.date,spaces:1})),this.datetime&&(this.date=new BBModel.Day({date:this.datetime.toISODate(),spaces:1}),t=60*this.datetime.hour()+this.datetime.minute(),this.time=new BBModel.TimeSlot({time:t,event_id:this.event_id,selected:!0,avail:1,price:this.price})),this.id&&(this.reserve_ready=!0,this.held={time:this.time,date:this.date,event_id:this.event_id,id:this.id}),this.promises=[],data&&(data.$has("answers")&&data.$get("answers").then(function(_this){return function(answers){var a,i,len,results;for(data.questions=[],results=[],i=0,len=answers.length;i<len;i++)a=answers[i],results.push(data.questions.push({id:a.question_id,answer:a.value}));return results}}(this)),data.$has("company")&&(comp=data.$get("company"),this.promises.push(comp),comp.then(function(_this){return function(comp){var c;return c=new BBModel.Company(comp),_this.promises.push(c.getSettings()),_this.setCompany(c)}}(this))),data.$has("service")&&(serv=data.$get("service"),this.promises.push(serv),serv.then(function(_this){return function(serv){var prom;if(serv.$has("category")&&(prom=serv.$get("category"),_this.promises.push(prom),prom.then(function(cat){return _this.setCategory(new BBModel.Category(cat))})),_this.setService(new BBModel.Service(serv),data.questions),_this.duration&&_this.setDuration(_this.duration),_this.checkReady(),_this.time)return _this.time.service=_this.service}}(this))),data.$has("event_group")&&(serv=data.$get("event_group"),this.promises.push(serv),serv.then(function(_this){return function(serv){var prom;if(serv.$has("category")&&(prom=serv.$get("category"),_this.promises.push(prom),prom.then(function(cat){return _this.setCategory(new BBModel.Category(cat))})),_this.setEventGroup(new BBModel.EventGroup(serv)),_this.time)return _this.time.service=_this.event_group}}(this))),data.$has("event_chain")&&(chain=data.$get("event_chain"),this.promises.push(chain),data.$has("event")||chain.then(function(_this){return function(serv){return _this.setEventChain(new BBModel.EventChain(serv),data.questions)}}(this))),data.$has("resource")&&(res=data.$get("resource"),this.promises.push(res),res.then(function(_this){return function(res){return _this.setResource(new BBModel.Resource(res),!1)}}(this))),data.$has("person")&&(per=data.$get("person"),this.promises.push(per),per.then(function(_this){return function(per){return _this.setPerson(new BBModel.Person(per),!1)}}(this))),data.$has("event")&&data.$get("event").then(function(_this){return function(event){return _this.setEvent(new BBModel.Event(event))}}(this)),data.settings&&(this.settings=$bbug.extend(!0,{},data.settings)),data.attachment_id&&(this.attachment_id=data.attachment_id),data.$has("product")&&data.$get("product").then(function(_this){return function(product){return _this.setProduct(new BBModel.Product(product))}}(this)),data.$has("package_item")&&data.$get("package_item").then(function(_this){return function(package_item){return _this.setPackageItem(new BBModel.PackageItem(package_item))}}(this)),data.$has("bulk_purchase")&&data.$get("bulk_purchase").then(function(_this){return function(bulk_purchase){return _this.setBulkPurchase(new BBModel.BulkPurchase(bulk_purchase))}}(this)),data.$has("deal")&&data.$get("deal").then(function(_this){return function(deal){return _this.setDeal(new BBModel.Deal(deal))}}(this)),data.$has("pre_paid_booking")&&data.$get("pre_paid_booking").then(function(_this){return function(pre_paid_booking){return _this.setPrepaidBooking(new BBModel.PrePaidBooking(pre_paid_booking))}}(this)),data.clinic_id&&(this.clinic_id=data.clinic_id))}return extend(BasketItem,superClass),BasketItem.prototype.setDefaults=function(defaults){var date,time;return defaults.settings&&(this.settings=defaults.settings),defaults.company&&this.setCompany(defaults.company),defaults.merge_resources&&this.setResource(null),defaults.merge_people&&this.setPerson(null),defaults.resource&&this.setResource(defaults.resource),defaults.person&&this.setPerson(defaults.person),defaults.service&&this.setService(defaults.service),defaults.category&&this.setCategory(defaults.category),defaults.date&&(defaults.date=moment(defaults.date)),defaults.time&&(date=defaults.date?defaults.date:moment(),time=defaults.time?parseInt(defaults.time):0,defaults.datetime=DateTimeUtilitiesService.convertTimeSlotToMoment(defaults.date,{time:time})),defaults.service_ref&&(this.service_ref=defaults.service_ref),defaults.group&&(this.group=defaults.group),defaults.clinic&&(this.clinic=defaults.clinic,this.clinic_id=defaults.clinic.id),defaults.private_note&&(this.private_note=defaults.private_note),defaults.event_group&&this.setEventGroup(defaults.event_group),defaults.event&&this.setEvent(defaults.event),this.defaults=defaults},BasketItem.prototype.storeDefaults=function(defaults){return this.defaults=defaults},BasketItem.prototype.defaultService=function(){return this.defaults&&this.defaults.service?this.defaults.service:this.defaults&&this.defaults.event_group?this.defaults.event_group:null},BasketItem.prototype.setSlot=function(slot){var t;return this.date=new BBModel.Day({date:slot.datetime.toISODate(),spaces:1}),t=60*slot.datetime.hour()+slot.datetime.minute(),this.time=new BBModel.TimeSlot({time:t,avail:1,price:this.price}),this.available_slot=slot.id},BasketItem.prototype.setCompany=function(company){if(this.company=company,this.parts_links.company=this.company.$href("self"),this.item_details)return this.item_details.currency_code=this.company.currency_code},BasketItem.prototype.clearExistingItem=function(){var prom;return this.$has("self")&&this.event_id&&(prom=this.$del("self"),this.promises.push(prom),prom.then(function(){})),delete this.earliest_time,delete this.event_id},BasketItem.prototype.setItem=function(item){if(item)return"person"===item.type?this.setPerson(item):"service"===item.type?this.setService(item):"resource"===item.type?this.setResource(item):void 0},BasketItem.prototype.setService=function(serv,default_questions){var prom;if(null==default_questions&&(default_questions=null),this.service){if(this.service.self&&serv.self&&this.service.self===serv.self)return this.service.$has("book")&&(this.book_link=this.service),serv.$has("days")&&(this.days_link=serv),void(serv.$has("book")&&(this.book_link=serv));this.item_details=null,this.clearExistingItem()}if(this.service&&serv&&this.service.self&&serv.self&&this.service.self!==serv.self&&serv.durations&&serv.durations.length>1&&(this.duration=null,this.listed_duration=null),this.service=serv,serv&&serv instanceof BookableItemModel&&(this.service=serv.item),this.parts_links.service=this.service.$href("self"),this.service.$has("book")&&(this.book_link=this.service),serv.$has("days")&&(this.days_link=serv),serv.$has("book")&&(this.book_link=serv),this.service.$has("questions")?(this.has_questions=!0,prom=this.service.$get("questions"),this.promises.push(prom),prom.then(function(_this){return function(details){if(_this.company&&(details.currency_code=_this.company.currency_code),_this.item_details=new BBModel.ItemDetails(details),_this.has_questions=_this.item_details.hasQuestions,default_questions)return _this.item_details.setAnswers(default_questions),_this.setAskedQuestions()}}(this),function(_this){return function(err){return _this.has_questions=!1}}(this))):this.has_questions=!1,this.service&&this.service.durations&&1===this.service.durations.length&&(this.setDuration(this.service.durations[0]),this.listed_duration=this.service.durations[0]),this.service&&this.service.listed_durations&&1===this.service.listed_durations.length&&(this.listed_duration=this.service.listed_durations[0]),this.service.$has("category")&&(prom=this.service.getCategoryPromise()))return this.promises.push(prom)},BasketItem.prototype.setEventGroup=function(event_group){var prom;if(!(this.event_group&&this.event_group.self&&event_group.self&&this.event_group.self===event_group.self))return this.event_group=event_group,this.parts_links.event_group=this.event_group.$href("self").replace("event_group","service"),this.event_group.$has("category")&&(prom=this.event_group.getCategoryPromise())?this.promises.push(prom):void 0},BasketItem.prototype.setEventChain=function(event_chain,default_questions){var prom;if(null==default_questions&&(default_questions=null),!(this.event_chain&&this.event_chain.self&&event_chain.self&&this.event_chain.self===event_chain.self))return this.event_chain=event_chain,this.base_price=parseFloat(event_chain.price),null!=this.price&&this.price!==this.base_price?this.setPrice(this.price):this.setPrice(this.base_price),this.event_chain.isSingleBooking()&&(this.tickets={name:"Admittance",max:1,type:"normal",price:this.base_price},this.tickets.pre_paid_booking_id=this.pre_paid_booking_id,this.num_book&&(this.tickets.qty=this.num_book)),this.event_chain.$has("questions")?(this.has_questions=!0,prom=this.event_chain.$get("questions"),this.promises.push(prom),prom.then(function(_this){return function(details){var a,i,len,q,ref;if(_this.item_details=new BBModel.ItemDetails(details),_this.has_questions=_this.item_details.hasQuestions,_this.questions){for(ref=_this.item_details.questions,i=0,len=ref.length;i<len;i++)q=ref[i],a=_.find(_this.questions,function(c){return c.id===q.id}),(a&&void 0===q.answer||a!==q.answer)&&(q.answer=a.answer);_this.setAskedQuestions()}if(default_questions)return _this.item_details.setAnswers(default_questions),_this.setAskedQuestions()}}(this),function(_this){return function(err){return _this.has_questions=!1}}(this))):this.has_questions=!1},BasketItem.prototype.setEvent=function(event,default_questions){var prom;if(null==default_questions&&(default_questions=null),this.event&&this.event.unselect(),this.event=event,this.event.select(),this.event_chain_id=event.event_chain_id,this.setDate({date:event.date}),this.setTime(event.time),this.setDuration(event.duration),event.$has("book")&&(this.book_link=event),event.qty&&(this.num_book=event.qty),prom=this.event.getChain(),this.promises.push(prom),prom.then(function(_this){return function(chain){return _this.setEventChain(chain,default_questions)}}(this)),prom=this.event.getGroup(),this.promises.push(prom),prom.then(function(_this){return function(group){return _this.setEventGroup(group)}}(this)),this.event.getSpacesLeft()<=0&&!this.company.settings){if(this.company.getSettings().has_waitlists)return this.status=8}else if(this.event.getSpacesLeft()<=0&&this.company.settings&&this.company.settings.has_waitlists)return this.status=8},BasketItem.prototype.setCategory=function(cat){return this.category=cat},BasketItem.prototype.setPerson=function(per,set_selected){if(null==set_selected&&(set_selected=!0),set_selected&&this.earliest_time&&delete this.earliest_time,per){if(this.person=per,set_selected&&(this.settings.person=this.person.id),this.parts_links.person=this.person.$href("self"),per.$has("days")&&(this.days_link=per),per.$has("book")&&(this.book_link=per),this.event_id&&this.$has("person")&&this.$href("person")!==this.person.self&&(delete this.event_id,this.resource&&this.defaults&&this.defaults.merge_resources))return this.setResource(null)}else if(this.person=!0,set_selected&&(this.settings.person=-1),this.parts_links.person=null,this.service&&this.setService(this.service),this.resource&&!this.anyResource()&&this.setResource(this.resource,!1),this.event_id&&(delete this.event_id,this.resource&&this.defaults&&this.defaults.merge_resources))return this.setResource(null)},BasketItem.prototype.setResource=function(res,set_selected){if(null==set_selected&&(set_selected=!0),set_selected&&this.earliest_time&&delete this.earliest_time,res){if(this.resource=res,set_selected&&(this.settings.resource=this.resource.id),this.parts_links.resource=this.resource.$href("self"),res.$has("days")&&(this.days_link=res),res.$has("book")&&(this.book_link=res),this.event_id&&this.$has("resource")&&this.$href("resource")!==this.resource.self&&(delete this.event_id,this.person&&this.defaults&&this.defaults.merge_people))return this.setPerson(null)}else if(this.resource=!0,set_selected&&(this.settings.resource=-1),this.parts_links.resource=null,this.service&&this.setService(this.service),this.person&&!this.anyPerson()&&this.setPerson(this.person,!1),this.event_id&&(delete this.event_id,this.person&&this.defaults&&this.defaults.merge_people))return this.setPerson(null)},BasketItem.prototype.setDuration=function(dur){return this.duration=dur,this.service?this.base_price=this.service.getPriceByDuration(dur):this.time&&this.time.price?this.base_price=this.time.price:this.price&&(this.base_price=this.price),this.setPrice(this.base_price)},BasketItem.prototype.print_time=function(){if(this.time)return this.time.print_time()},BasketItem.prototype.print_end_time=function(){if(this.time)return this.time.print_end_time(this.duration)},BasketItem.prototype.print_time12=function(show_suffix){if(null==show_suffix&&(show_suffix=!0),this.time)return this.time.print_time12(show_suffix)},BasketItem.prototype.print_end_time12=function(show_suffix){if(null==show_suffix&&(show_suffix=!0),this.time)return this.time.print_end_time12(show_suffix,this.duration)},BasketItem.prototype.setTime=function(time){return this.time&&this.time.unselect(),this.time=time,this.time&&(this.time.select(),this.datetime&&(this.datetime=DateTimeUtilitiesService.convertTimeSlotToMoment(this.date.date,this.time)),this.price&&this.time.price&&this.price!==this.time.price?this.setPrice(this.time.price):this.price&&!this.time.price?this.setPrice(this.price):this.time.price&&!this.price?this.setPrice(this.time.price):this.price&&this.time.price?this.setPrice(this.price):this.setPrice(null)),this.checkReady()},BasketItem.prototype.setDate=function(date){return this.date=date,this.date&&(this.date.date=moment(this.date.date),this.datetime&&(this.datetime.date(this.date.date.date()),this.datetime.month(this.date.date.month()),this.datetime.year(this.date.date.year()))),this.checkReady()},BasketItem.prototype.clearDateTime=function(){return delete this.date,delete this.time,delete this.datetime,this.ready=!1,this.reserve_ready=!1},BasketItem.prototype.clearTime=function(){return delete this.time,this.ready=!1,this.reserve_ready=!1},BasketItem.prototype.setGroup=function(group){return this.group=group},BasketItem.prototype.setAskedQuestions=function(){return this.asked_questions=!0,this.checkReady()},BasketItem.prototype.checkReady=function(){return this.ready=!1,!this.checkReserveReady()||!this.asked_questions&&this.has_questions||(this.ready=!0),this.ready},BasketItem.prototype.checkReserveReady=function(){return this.reserve_ready=!1,(this.date&&this.time&&this.service||this.event||this.product||this.package_item||this.bulk_purchase||this.external_purchase||this.deal||this.is_coupon||this.date&&this.service&&"day"===this.service.duration_unit)&&(this.reserve_ready=!0),this.reserve_ready},BasketItem.prototype.getPostData=function(){var data,i,j,len,len1,m_question,o_question,ref,ref1;if(this.cloneAnswersItem)for(ref=this.cloneAnswersItem.item_details.questions,i=0,len=ref.length;i<len;i++)for(o_question=ref[i],ref1=this.item_details.questions,j=0,len1=ref1.length;j<len1;j++)m_question=ref1[j],m_question.id===o_question.id&&(m_question.answer=o_question.answer,this.setAskedQuestions());return data={},this.date&&(data.date=this.date.date.toISODate()),this.time?(data.time=this.time.time,this.time.event_id?data.event_id=this.time.event_id:this.time.event_ids&&(data.event_ids=this.time.event_ids)):this.date&&this.date.event_id&&(data.event_id=this.date.event_id),data.price=this.price,data.paid=this.paid,this.book_link&&(data.book=this.book_link.$href("book")),data.id=this.id,data.duration=this.duration,data.settings=this.settings,data.settings||(data.settings={}),this.earliest_time&&(data.settings.earliest_time=this.earliest_time),this.item_details&&this.asked_questions&&(data.questions=this.item_details.getPostData()),this.move_item_id&&(data.move_item_id=this.move_item_id),this.srcBooking&&(data.move_item_id=this.srcBooking.id),this.service&&(data.service_id=this.service.id),this.resource&&(data.resource_id=this.resource.id),this.person&&(data.person_id=this.person.id),data.length=this.length,this.event&&(data.event_id=this.event.id,null!=this.event.pre_paid_booking_id?data.pre_paid_booking_id=this.event.pre_paid_booking_id:this.tickets&&null!=this.tickets.pre_paid_booking_id&&(data.pre_paid_booking_id=this.tickets.pre_paid_booking_id),data.tickets=this.tickets),null!=this.pre_paid_booking_id&&(data.pre_paid_booking_id=this.pre_paid_booking_id),data.event_chain_id=this.event_chain_id,data.event_group_id=this.event_group_id,data.qty=this.qty,this.status&&(data.status=this.status),null!=this.num_resources&&(data.num_resources=parseInt(this.num_resources)),this.package_item&&(data.package_id=this.package_item.id),this.bulk_purchase&&(data.bulk_purchase_id=this.bulk_purchase.id),data.external_purchase=this.external_purchase,this.deal&&(data.deal=this.deal),this.deal&&this.recipient&&(data.recipient=this.recipient),this.deal&&this.recipient&&this.recipient_mail&&(data.recipient_mail=this.recipient_mail),data.coupon_id=this.coupon_id,data.is_coupon=this.is_coupon,this.attachment_id&&(data.attachment_id=this.attachment_id),this.deal_codes&&(data.vouchers=this.deal_codes),this.product&&(data.product_id=this.product.id),data.ref=this.ref,this.move_reason&&(data.move_reason=this.move_reason),this.email&&(data.email=this.email),this.first_name&&(data.first_name=this.first_name),this.last_name&&(data.last_name=this.last_name),null!=this.email&&(data.email=this.email),null!=this.email_admin&&(data.email_admin=this.email_admin),this.private_note&&(data.private_note=this.private_note),this.available_slot&&(data.available_slot=this.available_slot),this.clinic_id&&(data.clinic_id=this.clinic_id),data},BasketItem.prototype.setPrice=function(nprice){var printed_price;return null==nprice?(this.price=null,this.printed_price=null,this.printed_vat_cal=null,this.printed_vat=null,this.printed_vat_inc=null):(this.price=parseFloat(nprice),printed_price=this.price/100,this.printed_price=printed_price%1===0?""+parseInt(printed_price):$window.sprintf("%.2f",printed_price),this.company&&this.company.settings&&(this.printed_vat_cal=this.company.settings.payment_tax),this.printed_vat_cal&&(this.printed_vat=this.printed_vat_cal/100*printed_price),this.printed_vat_cal?this.printed_vat_inc=this.printed_vat_cal/100*printed_price+printed_price:void 0)},BasketItem.prototype.getStep=function(){var temp;return temp={},temp.service=this.service,temp.category=this.category,temp.person=this.person,temp.resource=this.resource,temp.duration=this.duration,temp.event=this.event,temp.event_group=this.event_group,temp.event_chain=this.event_chain,temp.time=this.time,temp.date=this.date,temp.days_link=this.days_link,temp.book_link=this.book_link,temp.ready=this.ready,temp},BasketItem.prototype.loadStep=function(step){return this.service=step.service,this.category=step.category,this.person=step.person,this.resource=step.resource,this.duration=step.duration,this.event=step.event,this.event_chain=step.event_chain,this.event_group=step.event_group,this.time=step.time,this.date=step.date,this.days_link=step.days_link,this.book_link=step.book_link,this.ready=step.ready},BasketItem.prototype.describe=function(){var title;return title="-",this.service&&(title=this.service.name),this.event_group&&this.event&&"-"===title&&(title=this.event_group.name+" - "+this.event.description),this.product&&(title=this.product.name),this.external_purchase&&(title=this.external_purchase.name),this.deal&&(title=this.deal.name),this.package_item&&(title=this.package_item.name),this.bulk_purchase&&(title=this.bulk_purchase.name),title},BasketItem.prototype.booking_date=function(format){return this.date&&this.date.date?this.date.date.format(format):null},BasketItem.prototype.booking_time=function(seperator){var duration;return null==seperator&&(seperator="-"),this.time?(duration=this.listed_duration?this.listed_duration:this.duration,this.time.print_time()+" "+seperator+" "+this.time.print_end_time(duration)):null},BasketItem.prototype.duePrice=function(){return this.isWaitlist()?0:this.price},BasketItem.prototype.isWaitlist=function(){return this.status&&8===this.status},BasketItem.prototype.start_datetime=function(){return this.date&&this.time?DateTimeUtilitiesService.convertTimeSlotToMoment(this.date.date,this.time):null},BasketItem.prototype.startDatetime=function(){return this.start_datetime()},BasketItem.prototype.end_datetime=function(){var duration,time;return this.date&&this.time&&(this.listed_duration||this.duration)?(duration=this.listed_duration?this.listed_duration:this.duration,time=this.time.time+duration,DateTimeUtilitiesService.convertTimeSlotToMoment(this.date.date,time)):null},BasketItem.prototype.endDatetime=function(){return this.end_datetime()},BasketItem.prototype.setSrcBooking=function(booking){return this.srcBooking=booking,this.duration=booking.duration},BasketItem.prototype.anyPerson=function(){return this.person&&"boolean"==typeof this.person},BasketItem.prototype.anyResource=function(){return this.resource&&"boolean"==typeof this.resource},BasketItem.prototype.isMovingBooking=function(){return this.srcBooking||this.move_item_id},BasketItem.prototype.setCloneAnswers=function(otherItem){return this.cloneAnswersItem=otherItem},BasketItem.prototype.questionPrice=function(){return this.item_details?this.item_details.questionPrice(this.getQty()):0},BasketItem.prototype.getQty=function(){return this.qty?this.qty:this.tickets?this.tickets.qty:1},BasketItem.prototype.totalPrice=function(){var pr;return this.tickets&&this.tickets.pre_paid_booking_id?0:this.pre_paid_booking_id?0:null!=this.discount_price?this.discount_price+this.questionPrice():(pr=this.total_price,angular.isNumber(pr)||(pr=this.price),angular.isNumber(pr)||(pr=0),pr+this.questionPrice())},BasketItem.prototype.fullPrice=function(){var pr;return pr=this.base_price,pr||(pr=this.total_price),pr||(pr=this.price),pr||(pr=0),pr+this.questionPrice()},BasketItem.prototype.setProduct=function(product){if(this.product=product,this.product.$has("book")&&(this.book_link=this.product),product.price)return this.setPrice(product.price)},BasketItem.prototype.setPackageItem=function(package_item){if(this.package_item=package_item,this.package_item.$has("book")&&(this.book_link=this.package_item),package_item.price)return this.setPrice(package_item.price)},BasketItem.prototype.setBulkPurchase=function(bulk_purchase){if(this.bulk_purchase=bulk_purchase,this.bulk_purchase.$has("book")&&(this.book_link=this.bulk_purchase),bulk_purchase.price)return this.setPrice(bulk_purchase.price)},BasketItem.prototype.setExternalPurchase=function(external_purchase){if(this.external_purchase=external_purchase,this.book_link=this.company,external_purchase.price)return this.setPrice(external_purchase.price)},BasketItem.prototype.setDeal=function(deal){if(this.deal=deal,this.deal.$has("book")&&(this.book_link=this.deal),deal.price)return this.setPrice(deal.price)},BasketItem.prototype.hasPrice=function(){return null!=this.price},BasketItem.prototype.getAttachment=function(){return this.attachment?this.attachment:this.$has("attachment")&&this.attachment_id?this._data.$get("attachment").then(function(_this){
return function(att){return _this.attachment=att,_this.attachment}}(this)):void 0},BasketItem.prototype.deleteAttachment=function(){if(this.attachment_id)return this._data.$del("del_attachment",{}),this.attachment_id=null},BasketItem.prototype.setPrepaidBooking=function(pre_paid_booking){return this.pre_paid_booking=pre_paid_booking,this.pre_paid_booking_id=pre_paid_booking.id},BasketItem.prototype.hasPrepaidBooking=function(){return null!=this.pre_paid_booking_id},BasketItem.prototype.getEventId=function(){return this.time&&this.time.event_id?this.time.event_id:this.date&&this.date.event_id?this.date.event_id:this.event?this.event.id:void 0},BasketItem.prototype.isExternalPurchase=function(){return null!=this.external_purchase},BasketItem.prototype.getName=function(){return this.session_name?this.session_name:this.service_name},BasketItem.prototype.getAttendeeName=function(client){return this.first_name?this.first_name+" "+this.last_name:client?client.getName():void 0},BasketItem.prototype.isTimeItem=function(){return this.service||this.event},BasketItem}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BookableItemModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var BookableItem;return BookableItem=function(superClass){function BookableItem(data){BookableItem.__super__.constructor.apply(this,arguments),this.name="-Waiting-",this.ready=$q.defer(),this.promise=this._data.$get("item"),this.promise.then(function(_this){return function(val){var m,n,ref,ref1,ref2;if("person"===val.type){if(_this.item=new BBModel.Person(val),_this.item){ref=_this.item._data;for(n in ref)m=ref[n],_this.item._data.hasOwnProperty(n)&&"function"!=typeof m&&(_this[n]=m);return _this.ready.resolve()}return _this.ready.resolve()}if("resource"===val.type){if(_this.item=new BBModel.Resource(val),_this.item){ref1=_this.item._data;for(n in ref1)m=ref1[n],_this.item._data.hasOwnProperty(n)&&"function"!=typeof m&&(_this[n]=m);return _this.ready.resolve()}return _this.ready.resolve()}if("service"===val.type){if(_this.item=new BBModel.Service(val),_this.item){ref2=_this.item._data;for(n in ref2)m=ref2[n],_this.item._data.hasOwnProperty(n)&&"function"!=typeof m&&(_this[n]=m);return _this.ready.resolve()}return _this.ready.resolve()}}}(this))}return extend(BookableItem,superClass),BookableItem.prototype.item=null,BookableItem.prototype.promise=null,BookableItem}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BulkPurchaseModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var BulkPurchase;return BulkPurchase=function(superClass){function BulkPurchase(){return BulkPurchase.__super__.constructor.apply(this,arguments)}return extend(BulkPurchase,superClass),BulkPurchase}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BusinessQuestionModel",["$q","$filter","BBModel","BaseModel",function($q,$filter,BBModel,BaseModel){var BusinessQuestion;return BusinessQuestion=function(superClass){function BusinessQuestion(data){BusinessQuestion.__super__.constructor.call(this,data)}return extend(BusinessQuestion,superClass),BusinessQuestion}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("CategoryModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Category;return Category=function(superClass){function Category(){return Category.__super__.constructor.apply(this,arguments)}return extend(Category,superClass),Category}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ClientModel",["$q","BBModel","BaseModel","LocaleService",function($q,BBModel,BaseModel,LocaleService){var Client;return Client=function(superClass){function Client(data){Client.__super__.constructor.apply(this,arguments),this.name=this.getName(),data&&data.answers&&data.$has("questions")&&(this.waitingQuestions=$q.defer(),this.gotQuestions=this.waitingQuestions.promise,data.$get("questions").then(function(_this){return function(details){return _this.client_details=new BBModel.ClientDetails(details),_this.client_details.setAnswers(data.answers),_this.questions=_this.client_details.questions,_this.setAskedQuestions(),_this.waitingQuestions.resolve()}}(this)))}return extend(Client,superClass),Client.prototype.setClientDetails=function(details){return this.client_details=details,this.questions=this.client_details.questions},Client.prototype.setDefaults=function(values){if(values.name&&(this.name=values.name),values.first_name&&(this.first_name=values.first_name),values.last_name&&(this.last_name=values.last_name),values.phone&&(this.phone=values.phone),values.mobile&&(this.mobile=values.mobile),values.email&&(this.email=values.email),values.id&&(this.id=values.id),values.ref&&(this.comp_ref=values.ref),values.comp_ref&&(this.comp_ref=values.comp_ref),values.address1&&(this.address1=values.address1),values.address2&&(this.address2=values.address2),values.address3&&(this.address3=values.address3),values.address4&&(this.address4=values.address4),values.address5&&(this.address5=values.address5),values.postcode&&(this.postcode=values.postcode),values.country&&(this.country=values.country),values.answers&&(this.default_answers=values.answers),values.time_zone)return this.time_zone=values.time_zone},Client.prototype.pre_fill_answers=function(details){var i,len,q,ref,results;if(this.default_answers){for(ref=details.questions,results=[],i=0,len=ref.length;i<len;i++)q=ref[i],this.default_answers[q.name]?results.push(q.answer=this.default_answers[q.name]):results.push(void 0);return results}},Client.prototype.getName=function(){var str;return str="",this.first_name&&(str+=this.first_name),str.length>0&&this.last_name&&(str+=" "),this.last_name&&(str+=this.last_name),str},Client.prototype.addressSingleLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+=", "),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+=", "),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+=", "),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+=", "),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+=", "),this.postcode&&(str+=this.postcode),str},Client.prototype.hasAddress=function(){return this.address1||this.address2||this.postcode},Client.prototype.addressCsvLine=function(){var str;return str="",this.address1&&(str+=this.address1),str+=", ",this.address2&&(str+=this.address2),str+=", ",this.address3&&(str+=this.address3),str+=", ",this.address4&&(str+=this.address4),str+=", ",this.address5&&(str+=this.address5),str+=", ",this.postcode&&(str+=this.postcode),str+=", ",this.country&&(str+=this.country),str},Client.prototype.addressMultiLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+="<br/>"),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+="<br/>"),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+="<br/>"),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+="<br/>"),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+="<br/>"),this.postcode&&(str+=this.postcode),str},Client.prototype.getPostData=function(){var i,len,q,ref,x;if(x={},x.first_name=this.first_name,x.last_name=this.last_name,this.house_number?x.address1=this.house_number+" "+this.address1:x.address1=this.address1,x.address2=this.address2,x.address3=this.address3,x.address4=this.address4,x.address5=this.address5,x.postcode=this.postcode,x.country=this.country,x.email=this.email,x.id=this.id,x.comp_ref=this.comp_ref,x.parent_client_id=this.parent_client_id,x.password=this.password,x.notifications=this.notifications,this.member_level_id&&(x.member_level_id=this.member_level_id),this.send_welcome_email&&(x.send_welcome_email=this.send_welcome_email),this.default_company_id&&(x.default_company_id=this.default_company_id),this.time_zone&&(x.time_zone=this.time_zone),this.phone&&(x.phone=this.phone,this.phone_prefix&&(x.phone_prefix=this.phone_prefix)),this.mobile&&(this.remove_prefix(),x.mobile=this.mobile,x.mobile_prefix=this.mobile_prefix),this.questions)for(x.questions=[],ref=this.questions,i=0,len=ref.length;i<len;i++)q=ref[i],x.questions.push(q.getPostData());return x},Client.prototype.valid=function(){return this.isValid?this.isValid:!(!this.email&&!this.hasServerId())},Client.prototype.setValid=function(val){return this.isValid=val},Client.prototype.hasServerId=function(){return this.id},Client.prototype.setAskedQuestions=function(){return this.asked_questions=!0},Client.prototype.fullMobile=function(){if(this.mobile)return this.mobile_prefix?"+"+this.mobile_prefix+this.mobile:this.mobile},Client.prototype.remove_prefix=function(){var pref_arr;if(pref_arr=this.mobile.match(/^(\+|00)(999|998|997|996|995|994|993|992|991|990|979|978|977|976|975|974|973|972|971|970|969|968|967|966|965|964|963|962|961|960|899|898|897|896|895|894|893|892|891|890|889|888|887|886|885|884|883|882|881|880|879|878|877|876|875|874|873|872|871|870|859|858|857|856|855|854|853|852|851|850|839|838|837|836|835|834|833|832|831|830|809|808|807|806|805|804|803|802|801|800|699|698|697|696|695|694|693|692|691|690|689|688|687|686|685|684|683|682|681|680|679|678|677|676|675|674|673|672|671|670|599|598|597|596|595|594|593|592|591|590|509|508|507|506|505|504|503|502|501|500|429|428|427|426|425|424|423|422|421|420|389|388|387|386|385|384|383|382|381|380|379|378|377|376|375|374|373|372|371|370|359|358|357|356|355|354|353|352|351|350|299|298|297|296|295|294|293|292|291|290|289|288|287|286|285|284|283|282|281|280|269|268|267|266|265|264|263|262|261|260|259|258|257|256|255|254|253|252|251|250|249|248|247|246|245|244|243|242|241|240|239|238|237|236|235|234|233|232|231|230|229|228|227|226|225|224|223|222|221|220|219|218|217|216|215|214|213|212|211|210|98|95|94|93|92|91|90|86|84|82|81|66|65|64|63|62|61|60|58|57|56|55|54|53|52|51|49|48|47|46|45|44|43|41|40|39|36|34|33|32|31|30|27|20|7|1)/))return this.mobile.replace(pref_arr[0],""),this.mobile_prefix=pref_arr[0]},Client.prototype.getPrePaidBookingsPromise=function(params){var defer;return defer=$q.defer(),this.$has("pre_paid_bookings")?this.$get("pre_paid_bookings",params).then(function(collection){return collection.$get("pre_paid_bookings").then(function(prepaids){var prepaid;return defer.resolve(function(){var i,len,results;for(results=[],i=0,len=prepaids.length;i<len;i++)prepaid=prepaids[i],results.push(new BBModel.PrePaidBooking(prepaid));return results}())},function(err){return defer.reject(err)})},function(err){return defer.resolve([])}):defer.resolve([]),defer.promise},Client}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ClientDetailsModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var ClientDetails;return ClientDetails=function(superClass){function ClientDetails(data){var i,len,q,ref;if(ClientDetails.__super__.constructor.apply(this,arguments),this.questions=[],this._data)for(ref=data.questions,i=0,len=ref.length;i<len;i++)q=ref[i],this.questions.push(new BBModel.Question(q));this.hasQuestions=this.questions.length>0}return extend(ClientDetails,superClass),ClientDetails.prototype.getPostData=function(questions){var data,i,len,q;for(data=[],i=0,len=questions.length;i<len;i++)q=questions[i],data.push({answer:q.answer,id:q.id,price:q.price});return data},ClientDetails.prototype.setAnswers=function(answers){var a,ahash,i,j,len,len1,q,ref,results;for(ahash={},i=0,len=answers.length;i<len;i++)a=answers[i],ahash[a.question_id]=a;for(ref=this.questions,results=[],j=0,len1=ref.length;j<len1;j++)q=ref[j],ahash[q.id]?results.push(q.answer=ahash[q.id].answer):results.push(void 0);return results},ClientDetails}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ClinicModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Clinic;return Clinic=function(superClass){function Clinic(data){Clinic.__super__.constructor.call(this,data),this.setTimes(),this.setResourcesAndPeople(),this.settings||(this.settings={})}return extend(Clinic,superClass),Clinic.prototype.setResourcesAndPeople=function(){return this.resources=_.reduce(this.resource_ids,function(h,id){return h[id]=!0,h},{}),this.people=_.reduce(this.person_ids,function(h,id){return h[id]=!0,h},{}),this.services=_.reduce(this.service_ids,function(h,id){return h[id]=!0,h},{}),this.uncovered=!this.person_ids||0===this.person_ids.length,this.uncovered?this.className="clinic_uncovered":this.className="clinic_covered"},Clinic.prototype.setTimes=function(){return this.start_time&&(this.start_time=moment(this.start_time),this.start=this.start_time),this.end_time&&(this.end_time=moment(this.end_time),this.end=this.end_time),this.title=this.name},Clinic}(BaseModel)}])}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("BBCollectionModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var BBCollection;return BBCollection=function(superClass){function BBCollection(){return this.getNextPage=bind(this.getNextPage,this),BBCollection.__super__.constructor.apply(this,arguments)}return extend(BBCollection,superClass),BBCollection.prototype.getNextPage=function(params){var deferred;return deferred=$q.defer(),this.$get("next",params).then(function(collection){return deferred.resolve(new BBModel.BBCollection(collection))},function(){return deferred.reject()}),deferred.promise},BBCollection}(BaseModel)}])}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("CompanyModel",["$q","BBModel","BaseModel","halClient","AppConfig","$sessionStorage",function($q,BBModel,BaseModel,halClient,AppConfig,$sessionStorage){var Company;return Company=function(superClass){function Company(data){this.getPusherChannel=bind(this.getPusherChannel,this),this.pusherSubscribe=bind(this.pusherSubscribe,this);var all_companies,c,child,comp,i,j,len,len1,ref1,ref2;if(Company.__super__.constructor.call(this,data),this.companies){for(all_companies=[],this.child_companies=[],ref1=this.companies,i=0,len=ref1.length;i<len;i++)if(comp=ref1[i],c=new BBModel.Company(halClient.$parse(comp)),this.child_companies.push(c),c.companies)for(ref2=c.companies,j=0,len1=ref2.length;j<len1;j++)child=ref2[j],all_companies.push(child);else all_companies.push(c);this.companies=all_companies}}return extend(Company,superClass),Company.prototype.getCompanyByRef=function(ref){var defer;return defer=$q.defer(),this.$get("companies").then(function(companies){var company;return company=_.find(companies,function(c){return c.reference===ref}),company?defer.resolve(company):defer.reject("No company for ref "+ref)},function(err){return console.log("err ",err),defer.reject(err)}),defer.promise},Company.prototype.findChildCompany=function(id){var c,cname,i,j,len,len1,name,ref1,ref2;if(!this.companies)return null;for(ref1=this.companies,i=0,len=ref1.length;i<len;i++){if(c=ref1[i],c.id===parseInt(id))return c;if(c.ref&&c.ref===String(id))return c}if("string"==typeof id)for(name=id.replace(/[\s\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,"").toLowerCase(),ref2=this.companies,j=0,len1=ref2.length;j<len1;j++)if(c=ref2[j],cname=c.name.replace(/[\s\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,"").toLowerCase(),name===cname)return c;return null},Company.prototype.getSettings=function(){var def;return def=$q.defer(),this.settings?def.resolve(this.settings):this.$has("settings")?this.$get("settings").then(function(_this){return function(set){return _this.settings=new BBModel.CompanySettings(set),def.resolve(_this.settings)}}(this)):def.reject("Company has no settings"),def.promise},Company.prototype.pusherSubscribe=function(callback,options){var channelName;return null==options&&(options={}),"undefined"!=typeof Pusher&&null!==Pusher&&null==this.pusher&&(this.pusher=new Pusher("c8d8cea659cc46060608",{encrypted:!options.hasOwnProperty("encrypted")||options.encrypted,authEndpoint:this.$link("pusher").href,auth:{headers:{"App-Id":AppConfig.appId,"App-Key":AppConfig.appKey,"Auth-Token":$sessionStorage.getItem("auth_token")}}})),channelName="private-c"+this.id+"-w"+this.numeric_widget_id,null!=this.pusher.channel(channelName)&&this.pusher.unsubscribe(channelName),this.pusher_channel=this.pusher.subscribe(channelName),this.pusher_channel.bind("booking",callback),this.pusher_channel.bind("cancellation",callback),this.pusher_channel.bind("updating",callback)},Company.prototype.getPusherChannel=function(model,options){var channelName;if(null==options&&(options={}),this.pusher||(this.pusher=new Pusher("c8d8cea659cc46060608",{encrypted:!options.hasOwnProperty("encrypted")||options.encrypted,authEndpoint:this.$link("pusher").href,auth:{headers:{"App-Id":AppConfig.appId,"App-Key":AppConfig.appKey,"Auth-Token":$sessionStorage.getItem("auth_token")}}})),this.$has(model))return channelName=this.$href(model),channelName=channelName.replace(/https?:\/\//,"").replace(/\//g,"-").replace(/:/g,"_"),this.pusher.channel(channelName)?this.pusher.channel(channelName):(this.pusher.subscribe(channelName),this.pusher.channel(channelName))},Company}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("CompanySettingsModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var CompanySettings;return CompanySettings=function(superClass){function CompanySettings(){return CompanySettings.__super__.constructor.apply(this,arguments)}return extend(CompanySettings,superClass),CompanySettings}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("DayModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Day;return Day=function(superClass){function Day(data){Day.__super__.constructor.apply(this,arguments),this.string_date=this.date,this.date=moment(this.date)}return extend(Day,superClass),Day.prototype.day=function(){return this.date.date()},Day.prototype.off=function(month){return this.date.month()!==month},Day.prototype["class"]=function(month){var str;return str="",this.date.month()<month&&(str+="off off-prev"),this.date.month()>month&&(str+="off off-next"),0===this.spaces&&(str+=" not-avail"),str},Day}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("DealModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Deal;return Deal=function(superClass){function Deal(){return Deal.__super__.constructor.apply(this,arguments)}return extend(Deal,superClass),Deal}(BaseModel)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventModel",["$q","BBModel","BaseModel","DateTimeUtilitiesService",function($q,BBModel,BaseModel,DateTimeUtilitiesService){var Event;return Event=function(superClass){function Event(data){Event.__super__.constructor.call(this,data),this.date=moment.parseZone(this.datetime),this.time=new BBModel.TimeSlot({time:DateTimeUtilitiesService.convertMomentToTime(this.date)}),this.duration&&(this.end_datetime=this.date.clone().add(this.duration,"minutes")),this.date_unix=this.date.unix()}return extend(Event,superClass),Event.prototype.getGroup=function(){var defer,event_group;return defer=$q.defer(),this.group?defer.resolve(this.group):this.$has("event_groups")||this.$has("event_group")?(event_group="event_group",this.$has("event_groups")&&(event_group="event_groups"),this.$get(event_group).then(function(_this){return function(group){return _this.group=new BBModel.EventGroup(group),defer.resolve(_this.group)}}(this),function(err){return defer.reject(err)})):defer.reject("No event group"),defer.promise},Event.prototype.getChain=function(params){var defer,event_chain;return defer=$q.defer(),this.chain?defer.resolve(this.chain):this.$has("event_chains")||this.$has("event_chain")?(event_chain="event_chain",this.$has("event_chains")&&(event_chain="event_chains"),this.$get(event_chain,params).then(function(_this){return function(chain){return _this.chain=new BBModel.EventChain(chain),defer.resolve(_this.chain)}}(this))):defer.reject("No event chain"),defer.promise},Event.prototype.getDuration=function(){var defer;return defer=new $q.defer,this.duration?defer.resolve(this.duration):this.getChain().then(function(_this){return function(chain){return _this.duration=chain.duration,defer.resolve(_this.duration)}}(this)),defer.promise},Event.prototype.getNumBooked=function(){return this.spaces_blocked+this.spaces_booked+this.spaces_reserved+this.spaces_held},Event.prototype.getSpacesLeft=function(pool){var x;return null==pool&&(pool=null),pool&&this.ticket_spaces&&this.ticket_spaces[pool]?this.ticket_spaces[pool].left:(x=this.num_spaces-this.getNumBooked(),x<0?0:x)},Event.prototype.getWaitSpacesLeft=function(){var wait;return wait=this.chain.waitlength,wait||(wait=0),wait-=this.spaces_wait,wait<=0?0:wait},Event.prototype.hasSpace=function(){return this.getSpacesLeft()>0},Event.prototype.hasWaitlistSpace=function(){return this.getSpacesLeft()<=0&&this.getChain().waitlength>this.spaces_wait},Event.prototype.getRemainingDescription=function(){var left;return left=this.getSpacesLeft(),left>0&&left<3?"Only "+left+" "+(left>1?"spaces":"space")+" left":this.hasWaitlistSpace()?"Join Waitlist":""},Event.prototype.select=function(){return this.selected=!0},Event.prototype.unselect=function(){if(this.selected)return delete this.selected},Event.prototype.prepEvent=function(params){var def;return def=$q.defer(),this.getChain(params).then(function(_this){return function(){return _this.chain.$has("address")&&_this.chain.getAddressPromise().then(function(address){return _this.chain.address=address}),_this.chain.getTickets().then(function(tickets){var i,len,ref,ticket;if(_this.tickets=tickets,_this.price_range={},tickets&&tickets.length>0)for(ref=_this.tickets,i=0,len=ref.length;i<len;i++)ticket=ref[i],(!_this.price_range.from||_this.price_range.from&&ticket.price<_this.price_range.from)&&(_this.price_range.from=ticket.price),(!_this.price_range.to||_this.price_range.to&&ticket.price>_this.price_range.to)&&(_this.price_range.to=ticket.price),ticket.old_price=ticket.price;else _this.price_range.from=_this.price,_this.price_range.to=_this.price;return _this.ticket_prices=_.indexBy(tickets,"name"),def.resolve(_this)})}}(this)),def.promise},Event.prototype.updatePrice=function(){var i,len,ref,results,ticket;for(ref=this.tickets,results=[],i=0,len=ref.length;i<len;i++)ticket=ref[i],ticket.pre_paid_booking_id?results.push(ticket.price=0):results.push(ticket.price=ticket.old_price);return results},Event.prototype.numTicketsSelected=function(){var i,len,num,ref,ticket;for(num=0,ref=this.tickets,i=0,len=ref.length;i<len;i++)ticket=ref[i],num+=ticket.qty;return num},Event}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventChainModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var EventChain;return EventChain=function(superClass){function EventChain(data){EventChain.__super__.constructor.apply(this,arguments),this.capacity_view=setCapacityView(this.capacity_view),this.start_date&&(this.start_date=moment(this.start_date)),this.end_date&&(this.end_date=moment(this.end_date))}var setCapacityView;return extend(EventChain,superClass),EventChain.prototype.name=function(){return this._data.name},EventChain.prototype.isSingleBooking=function(){return 1===this.max_num_bookings&&!this.$has("ticket_sets")},EventChain.prototype.hasTickets=function(){return this.$has("ticket_sets")},EventChain.prototype.getTickets=function(){var def;return def=$q.defer(),this.tickets?def.resolve(this.tickets):this.$has("ticket_sets")?this.$get("ticket_sets").then(function(_this){return function(tickets){var i,len,ticket;for(_this.tickets=[],i=0,len=tickets.length;i<len;i++)ticket=tickets[i],ticket.ticket_set=!0,_this.tickets.push(new BBModel.EventTicket(ticket));return _this.adjustTicketsForRemaining(),def.resolve(_this.tickets)}}(this)):(this.tickets=[new BBModel.EventTicket({name:"Admittance",min_num_bookings:1,max_num_bookings:this.max_num_bookings,type:"normal",price:this.price})],this.adjustTicketsForRemaining(),def.resolve(this.tickets)),def.promise},EventChain.prototype.adjustTicketsForRemaining=function(){var i,len,ref,results;if(this.tickets){for(ref=this.tickets,results=[],i=0,len=ref.length;i<len;i++)this.ticket=ref[i],results.push(this.ticket.max_spaces=this.spaces);return results}},setCapacityView=function(capacity_view){var capacity_view_str;switch(capacity_view){case 0:capacity_view_str="DO_NOT_DISPLAY";break;case 1:capacity_view_str="NUM_SPACES";break;case 2:capacity_view_str="NUM_SPACES_LEFT";break;case 3:capacity_view_str="NUM_SPACES_AND_SPACES_LEFT";break;default:capacity_view_str="NUM_SPACES_AND_SPACES_LEFT"}return capacity_view_str},EventChain}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventGroupModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var EventGroup;return EventGroup=function(superClass){function EventGroup(){return EventGroup.__super__.constructor.apply(this,arguments)}return extend(EventGroup,superClass),EventGroup.prototype.name=function(){return this._data.name},EventGroup.prototype.colour=function(){return this._data.colour},EventGroup}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventSequenceModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var EventSequence;return EventSequence=function(superClass){function EventSequence(){return EventSequence.__super__.constructor.apply(this,arguments)}return extend(EventSequence,superClass),EventSequence.prototype.name=function(){return this._data.name},EventSequence}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("EventTicketModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var EventTicket;return EventTicket=function(superClass){function EventTicket(data){var ms;EventTicket.__super__.constructor.call(this,data),this.max=this.max_num_bookings,this.max_spaces&&(ms=this.max_spaces,this.counts_as&&(ms=this.max_spaces/this.counts_as),ms<max&&(this.max=ms))}return extend(EventTicket,superClass),EventTicket.prototype.fullName=function(){return this.pool_name?this.pool_name+" - "+this.name:this.name},EventTicket.prototype.getRange=function(event,cap){var max,min,pool,results;if(event)return pool=null,this.ticket_set&&(pool=this.pool_id),max=this.getMax(event,pool,cap),min=max<=this.min_num_bookings?max:this.min_num_bookings,[].concat(function(){results=[];for(var i=min;min<=max?i<=max:i>=max;min<=max?i++:i--)results.push(i);return results}.apply(this))},EventTicket.prototype.getMax=function(ev,pool,cap){var c,i,isAvailable,left,len,live_max,ref,spaces_left,ticket,used,wait_spaces;if(null==pool&&(pool=null),null==cap&&(cap=null),isAvailable=function(event){return _.each(event.ticket_spaces,function(ts){if(ts.left<=0)return!1}),!0},!ev)return 0;for(!isAvailable(ev)||ev.getSpacesLeft()<=0?(spaces_left=ev.getWaitSpacesLeft(),wait_spaces=!0):spaces_left=ev.getSpacesLeft(pool),live_max=spaces_left<=this.max?spaces_left:this.max,used=0,ref=ev.tickets,
i=0,len=ref.length;i<len;i++)ticket=ref[i],(ticket.pool_id===this.pool_id||wait_spaces)&&(used+=ticket.totalQty());return this.qty&&(used-=this.totalQty()),this.counts_as&&(used=Math.ceil(used/this.counts_as)),live_max-=used,live_max<0&&(live_max=0),left-=used,left<0&&(left=0),this.cap&&(cap=this.cap),(!cap||cap>left)&&(cap=left),cap&&(c=cap,this.counts_as&&(c=cap/this.counts_as),c<live_max)?c:live_max},EventTicket.prototype.totalQty=function(){return this.qty?this.counts_as?this.qty*this.counts_as:this.qty:0},EventTicket.prototype.add=function(value){if(this.qty||(this.qty=0),this.qty=parseInt(this.qty),!(angular.isNumber(this.qty)&&this.qty>=this.max&&value>0||0===this.qty&&value<0))return this.qty+=value},EventTicket.prototype.subtract=function(value){return this.add(-value)},EventTicket}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ExternalPurchaseModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var ExternalPurchase;return ExternalPurchase=function(superClass){function ExternalPurchase(){return ExternalPurchase.__super__.constructor.apply(this,arguments)}return extend(ExternalPurchase,superClass),ExternalPurchase}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ImageModel",["$q","$filter","BBModel","BaseModel",function($q,$filter,BBModel,BaseModel){var Image;return Image=function(superClass){function Image(data){Image.__super__.constructor.call(this,data)}return extend(Image,superClass),Image}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ItemDetailsModel",["$q","BBModel","BaseModel","$bbug","QuestionService",function($q,BBModel,BaseModel,$bbug,QuestionService){var ItemDetails;return ItemDetails=function(superClass){function ItemDetails(data){var i,len,q,ref;if(this._data=data,this._data&&(this.self=this._data.$href("self")),this.questions=[],this.survey_questions=[],data)for(ref=data.questions,i=0,len=ref.length;i<len;i++)q=ref[i],q.outcome===!1?(data.currency_code&&(q.currency_code=data.currency_code),this.questions.push(new BBModel.Question(q))):this.survey_questions.push(new BBModel.SurveyQuestion(q));this.hasQuestions=this.questions.length>0,this.hasSurveyQuestions=this.survey_questions.length>0}return extend(ItemDetails,superClass),ItemDetails.prototype.questionPrice=function(qty){var i,len,price,q,ref;for(qty||(qty=1),this.checkConditionalQuestions(),price=0,ref=this.questions,i=0,len=ref.length;i<len;i++)q=ref[i],price+=q.selectedPriceQty(qty);return price},ItemDetails.prototype.checkConditionalQuestions=function(){return QuestionService.checkConditionalQuestions(this.questions)},ItemDetails.prototype.getPostData=function(){var data,i,len,q,ref;for(data=[],ref=this.questions,i=0,len=ref.length;i<len;i++)q=ref[i],q.currentlyShown&&data.push(q.getPostData());return data},ItemDetails.prototype.setAnswers=function(answers){var a,ahash,i,j,len,len1,q,ref;for(ahash={},i=0,len=answers.length;i<len;i++)a=answers[i],ahash[a.id]=a;for(ref=this.questions,j=0,len1=ref.length;j<len1;j++)q=ref[j],ahash[q.id]&&(q.answer=ahash[q.id].answer);return this.checkConditionalQuestions()},ItemDetails.prototype.getQuestion=function(id){return _.findWhere(this.questions,{id:id})},ItemDetails}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("MembershipLevelModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var MembershipLevel;return MembershipLevel=function(superClass){function MembershipLevel(){return MembershipLevel.__super__.constructor.apply(this,arguments)}return extend(MembershipLevel,superClass),MembershipLevel}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PackageItemModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var PackageItem;return PackageItem=function(superClass){function PackageItem(){return PackageItem.__super__.constructor.apply(this,arguments)}return extend(PackageItem,superClass),PackageItem}(BaseModel)}])}.call(this),function(){angular.module("BB.Models").factory("PaginationModel",function(){var Pagination;return Pagination=function(){function Pagination(options){this.current_page=1,this.page_size=options.page_size||10,this.request_page_size=options.request_page_size||this.page_size,this.max_size=options.max_size||5,this.num_pages=null,this.num_items=null,this.items=[]}return Pagination.prototype.initialise=function(items,total_items){return this.current_page=1,this.items=items||[],this.num_items=total_items||0,this.update()},Pagination.prototype.update=function(){var end,page_to_load,start,total;return start=(this.current_page-1)*this.page_size+1,end=this.current_page*this.page_size,end=this.num_items<end?this.num_items:end,total=end>=100?"100+":end,this.summary=start+" - "+end+" of "+total,page_to_load=Math.ceil(this.current_page*this.page_size/this.request_page_size),[null!=this.items[start-1],page_to_load]},Pagination.prototype.add=function(request_page,new_items){var i,index,item,len,results,start;for(start=(request_page-1)*this.request_page_size,results=[],index=i=0,len=new_items.length;i<len;index=++i)item=new_items[index],results.push(this.items[start+index]=item);return results},Pagination}()})}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PersonModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Person;return Person=function(superClass){function Person(){return Person.__super__.constructor.apply(this,arguments)}return extend(Person,superClass),Person}(BaseModel)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PrePaidBookingModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var PrePaidBooking;return PrePaidBooking=function(superClass){function PrePaidBooking(data){PrePaidBooking.__super__.constructor.call(this,data),this.book_by&&(this.book_by=moment(this.book_by)),this.use_by&&(this.use_by=moment(this.use_by)),this.use_from&&(this.use_from=moment(this.use_from)),this.expired=this.book_by&&moment().isAfter(this.book_by,"day")||this.use_by&&moment().isAfter(this.use_by,"day")||!1}return extend(PrePaidBooking,superClass),PrePaidBooking.prototype.checkValidity=function(item){return(!this.service_id||!item.service_id||this.service_id===item.service_id)&&((!this.resource_id||!item.resource_id||this.resource_id===item.resource_id)&&(!this.person_id||!item.person_id||this.person_id===item.person_id))},PrePaidBooking}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ProductModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Product;return Product=function(superClass){function Product(){return Product.__super__.constructor.apply(this,arguments)}return extend(Product,superClass),Product}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PurchaseItemModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var PurchaseItem;return PurchaseItem=function(superClass){function PurchaseItem(data){PurchaseItem.__super__.constructor.call(this,data),this.parts_links={},data&&(data.$has("service")&&(this.parts_links.service=data.$href("service")),data.$has("resource")&&(this.parts_links.resource=data.$href("resource")),data.$has("person")&&(this.parts_links.person=data.$href("person")),data.$has("company")&&(this.parts_links.company=data.$href("company")))}return extend(PurchaseItem,superClass),PurchaseItem.prototype.describe=function(){return this.get("describe")},PurchaseItem.prototype.full_describe=function(){return this.get("full_describe")},PurchaseItem.prototype.hasPrice=function(){return this.price&&this.price>0},PurchaseItem}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("PurchaseTotalModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var PurchaseTotal;return PurchaseTotal=function(superClass){function PurchaseTotal(data){var cprom;PurchaseTotal.__super__.constructor.call(this,data),this.promise=this._data.$get("purchase_items"),this.purchase_items=[],this.promise.then(function(_this){return function(items){var i,item,len,results;for(results=[],i=0,len=items.length;i<len;i++)item=items[i],results.push(_this.purchase_items.push(new BBModel.PurchaseItem(item)));return results}}(this)),this._data.$has("client")&&(cprom=data.$get("client"),cprom.then(function(_this){return function(client){return _this.client=new BBModel.Client(client)}}(this))),this.created_at=moment.parseZone(this.created_at),this.time_zone&&this.created_at.tz(this.time_zone)}return extend(PurchaseTotal,superClass),PurchaseTotal.prototype.icalLink=function(){return this._data.$href("ical")},PurchaseTotal.prototype.webcalLink=function(){return this._data.$href("ical")},PurchaseTotal.prototype.gcalLink=function(){return this._data.$href("gcal")},PurchaseTotal.prototype.id=function(){return this.get("id")},PurchaseTotal}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("QuestionModel",["$q","$filter","BBModel","BaseModel",function($q,$filter,BBModel,BaseModel){var Question;return Question=function(superClass){function Question(data){var currency,i,len,option,ref;if(Question.__super__.constructor.call(this,data),this.price&&(this.price=parseFloat(this.price)),this._data["default"]&&(this.answer=this._data["default"]),this._data.options)for(ref=this._data.options,i=0,len=ref.length;i<len;i++)option=ref[i],option.is_default&&(this.answer=option.name),this.hasPrice()?(option.price=parseFloat(option.price),currency=data.currency_code?data.currency_code:"GBP",option.display_name=option.name+" ("+$filter("currency")(option.price,currency)+")"):option.display_name=option.name;"check"!==this._data.detail_type&&"check-price"!==this._data.detail_type||(this.answer=this._data["default"]&&"1"===this._data["default"]),this.currentlyShown=!0}return extend(Question,superClass),Question.prototype.hasPrice=function(){return"check-price"===this.detail_type||"select-price"===this.detail_type||"radio-price"===this.detail_type},Question.prototype.selectedPrice=function(){var i,len,option,ref;if(!this.hasPrice())return 0;if("check-price"===this.detail_type)return this.answer?this.price:0;for(ref=this._data.options,i=0,len=ref.length;i<len;i++)if(option=ref[i],this.answer===option.name)return option.price;return 0},Question.prototype.selectedPriceQty=function(qty){var p;return qty||(qty=1),p=this.selectedPrice(),this.price_per_booking&&(p*=qty),p},Question.prototype.getAnswerId=function(){var i,len,o,ref;if(!this.answer||!this.options||0===this.options.length)return null;for(ref=this.options,i=0,len=ref.length;i<len;i++)if(o=ref[i],this.answer===o.name)return o.id;return null},Question.prototype.showElement=function(){return this.currentlyShown=!0},Question.prototype.hideElement=function(){return this.currentlyShown=!1},Question.prototype.getPostData=function(){var p,x;return x={},x.id=this.id,x.answer=this.answer,"date"===this.detail_type&&this.answer&&(x.answer=moment(this.answer).toISODate()),p=this.selectedPrice(),p&&(x.price=p),x},Question}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ReasonModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Reason;return Reason=function(superClass){function Reason(){return Reason.__super__.constructor.apply(this,arguments)}return extend(Reason,superClass),Reason}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ResourceModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Resource;return Resource=function(superClass){function Resource(){return Resource.__super__.constructor.apply(this,arguments)}return extend(Resource,superClass),Resource}(BaseModel)}])}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("ServiceModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Service;return Service=function(superClass){function Service(data){this.days_array=bind(this.days_array,this),this.getCategoryPromise=bind(this.getCategoryPromise,this),Service.__super__.constructor.apply(this,arguments),this.prices&&this.prices.length>0&&(this.price=this.prices[0]),this.durations&&this.durations.length>0&&(this.duration=this.durations[0]),this.listed_durations||(this.listed_durations=this.durations),this.listed_durations&&this.listed_durations.length>0&&(this.listed_duration=this.listed_durations[0]),this.min_advance_datetime=moment().add(this.min_advance_period,"seconds"),this.max_advance_datetime=moment().add(this.max_advance_period,"seconds")}return extend(Service,superClass),Service.prototype.getPriceByDuration=function(dur){var d,i,j,len,ref;for(ref=this.durations,i=j=0,len=ref.length;j<len;i=++j)if(d=ref[i],d===dur)return this.prices[i]},Service.prototype.getCategoryPromise=function(){var prom;return this.$has("category")?(prom=this.$get("category"),prom.then(function(_this){return function(cat){return _this.category=new BBModel.Category(cat)}}(this)),prom):null},Service.prototype.days_array=function(){var arr,j,ref,ref1,str,x;for(arr=[],x=j=ref=this.min_bookings,ref1=this.max_bookings;ref<=ref1?j<=ref1:j>=ref1;x=ref<=ref1?++j:--j)str=""+x+" day",x>1&&(str+="s"),arr.push({name:str,val:x});return arr},Service}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("SlotModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Slot;return Slot=function(superClass){function Slot(data){Slot.__super__.constructor.call(this,data),this.datetime=moment(data.datetime)}return extend(Slot,superClass),Slot}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("SpaceModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Space;return Space=function(superClass){function Space(){return Space.__super__.constructor.apply(this,arguments)}return extend(Space,superClass),Space}(BaseModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("SurveyQuestionModel",["$q","$window","BBModel","BaseModel","QuestionModel",function($q,$window,BBModel,BaseModel,QuestionModel){var SurveyQuestion;return SurveyQuestion=function(superClass){function SurveyQuestion(){return SurveyQuestion.__super__.constructor.apply(this,arguments)}return extend(SurveyQuestion,superClass),SurveyQuestion}(QuestionModel)}])}.call(this),function(){"use strict";var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("TimeSlotModel",["$q","$window","BBModel","BaseModel","DateTimeUtilitiesService",function($q,$window,BBModel,BaseModel,DateTimeUtilitiesService){var TimeSlot;return TimeSlot=function(superClass){function TimeSlot(data,service){TimeSlot.__super__.constructor.call(this,data),this.service=service,this.time_12=this.print_time12(),this.time_24=this.print_time(),this.datetime=moment.parseZone(this.datetime),this.time_moment=this.datetime}return extend(TimeSlot,superClass),TimeSlot.prototype.print_time=function(){var min,t;return this.start?this.start.format("h:mm"):(t=this.get("time"),min=t%60<10?"0"+t%60:t%60,""+Math.floor(t/60)+":"+min)},TimeSlot.prototype.print_end_time=function(dur){var min,t;return this.end?this.end.format("h:mm"):(dur||(dur=this.service.listed_durations[0]),t=this.get("time")+dur,min=t%60<10?"0"+t%60:t%60,""+Math.floor(t/60)+":"+min)},TimeSlot.prototype.print_time12=function(show_suffix){var h,m,suffix,t,time;return null==show_suffix&&(show_suffix=!0),t=this.get("time"),h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),time=$window.sprintf("%d.%02d",h,m),show_suffix&&(time+=suffix),time},TimeSlot.prototype.print_end_time12=function(show_suffix,dur){var end_time,h,m,suffix,t;return null==show_suffix&&(show_suffix=!0),dur=null,dur||(dur=null!=this.service.listed_duration?this.service.listed_duration:this.service.listed_durations[0]),t=this.get("time")+dur,h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),end_time=$window.sprintf("%d.%02d",h,m),show_suffix&&(end_time+=suffix),end_time},TimeSlot.prototype.availability=function(){return this.avail},TimeSlot.prototype.select=function(){return this.selected=!0},TimeSlot.prototype.unselect=function(){if(this.selected)return delete this.selected},TimeSlot.prototype.disable=function(reason){return this.disabled=!0,this.disabled_reason=reason},TimeSlot.prototype.enable=function(){if(this.disabled&&delete this.disabled,this.disabled_reason)return delete this.disabled_reason},TimeSlot.prototype.status=function(){return this.selected?"selected":this.disabled?"disabled":this.availability()>0?"enabled":"disabled"},TimeSlot}(BaseModel)}])}.call(this),function(){angular.module("BB.Services").factory("AddressListService",["$q","$window","halClient","UriTemplate",function($q,$window,halClient,UriTemplate){return{query:function(prms){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/company/{company_id}/addresses/{post_code}",uri=new UriTemplate(href).fillFromObject({company_id:prms.company.id,post_code:prms.post_code}),halClient.$get(uri,{}).then(function(addressList){return deferred.resolve(addressList)},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},getAddress:function(prms){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/company/{company_id}/addresses/address/{id}",uri=new UriTemplate(href).fillFromObject({company_id:prms.company.id,id:prms.id}),halClient.$get(uri,{}).then(function(customerAddress){return deferred.resolve(customerAddress)},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("$exceptionHandler",["$log","AirbrakeConfig",function($log,AirbrakeConfig){var airbrake;return airbrake=new airbrakeJs.Client({projectId:AirbrakeConfig.projectId,projectKey:AirbrakeConfig.projectKey}),airbrake.addFilter(function(notice){return!("development"===AirbrakeConfig.environment||!notice.params.from_sdk)&&(notice.context.environment="production",notice)}),function(exception,cause,sdkError){$log.error(exception),airbrake.notify({error:exception,params:{angular_cause:cause,from_sdk:sdkError}})}}])}.call(this),function(){angular.module("BB.Services").factory("AlertService",["$rootScope","ErrorService","$timeout",function($rootScope,ErrorService,$timeout){var alertService,titleLookup;return $rootScope.alerts=[],titleLookup=function(type,title){if(title)return title;switch(type){case"error":case"danger":title="Error";break;default:title=null}return title},alertService={add:function(type,arg){var alert,msg,persist,title;return title=arg.title,msg=arg.msg,persist=arg.persist,null==persist&&(persist=!0),$rootScope.alerts=[],alert={type:type,title:titleLookup(type,title),msg:msg,close:function(){return alertService.closeAlert(this)}},$rootScope.alerts.push(alert),persist||$timeout(function(){return $rootScope.alerts.splice($rootScope.alerts.indexOf(alert),1)},3e3),$rootScope.$broadcast("alert:raised")},closeAlert:function(alert){return this.closeAlertIdx($rootScope.alerts.indexOf(alert))},closeAlertIdx:function(index){return $rootScope.alerts.splice(index,1)},clear:function(){return $rootScope.alerts=[]},error:function(alert){if(alert)return this.add("error",{title:alert.title,msg:alert.msg,persist:alert.persist})},danger:function(alert){if(alert)return this.add("danger",{title:alert.title,msg:alert.msg,persist:alert.persist})},info:function(alert){if(alert)return this.add("info",{title:alert.title,msg:alert.msg,persist:alert.persist})},warning:function(alert){if(alert)return this.add("warning",{title:alert.title,msg:alert.msg,persist:alert.persist})},success:function(alert){if(alert)return this.add("success",{title:alert.title,msg:alert.msg,persist:alert.persist})},raise:function(key){var alert;if(key)return alert=ErrorService.getAlert(key),alert?this.add(alert.type,{title:alert.title,msg:alert.msg,persist:alert.persist}):void 0}}}])}.call(this),function(){angular.module("BB.Services").factory("BasketService",["$q","$rootScope","BBModel","MutexService",function($q,$rootScope,BBModel,MutexService){return{addItem:function(company,params){var data,deferred,lnk;return deferred=$q.defer(),lnk=params.item.book_link,data=params.item.getPostData(),lnk?MutexService.getLock().then(function(mutex){return lnk.$post("book",params,data).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,j,len,promises;for(promises=[],j=0,len=items.length;j<len;j++)i=items[j],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}):deferred.reject("rel book not found for event"),deferred.promise},applyCoupon:function(company,params){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return company.$post("coupon",{},{coupon:params.coupon}).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,j,len,promises;for(promises=[],j=0,len=items.length;j<len;j++)i=items[j],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise},updateBasket:function(company,params){var data,deferred,item,j,len,lnk,ref,xdata;for(deferred=$q.defer(),data={entire_basket:!0,items:[]},ref=params.items,j=0,len=ref.length;j<len;j++)item=ref[j],item.book_link&&(lnk=item.book_link),xdata=item.getPostData(),data.items.push(xdata);return lnk?(MutexService.getLock().then(function(mutex){return lnk.$post("book",params,data).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,k,len1,promises;for(promises=[],k=0,len1=items.length;k<len1;k++)i=items[k],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return $rootScope.$broadcast("basket:updated",mbasket),deferred.resolve(mbasket)}):($rootScope.$broadcast("basket:updated",mbasket),deferred.resolve(mbasket))},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise):(deferred.reject("rel book not found for event"),deferred.promise)},checkPrePaid:function(item,pre_paid_bookings){var booking,j,len,valid_pre_paid;for(valid_pre_paid=null,j=0,len=pre_paid_bookings.length;j<len;j++)if(booking=pre_paid_bookings[j],booking.checkValidity(item)){valid_pre_paid=booking;break}return valid_pre_paid},query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("basket")?company.$get("basket").then(function(basket){return basket=new BBModel.Basket(basket,params.bb),basket.$has("items")&&basket.$get("items").then(function(items){var item,j,len,results;for(results=[],j=0,len=items.length;j<len;j++)item=items[j],results.push(basket.addItem(new BBModel.BasketItem(item,params.bb)));return results}),deferred.resolve(basket)},function(err){return deferred.reject(err)}):deferred.reject("rel basket not found for company"),deferred.promise},deleteItem:function(item,company,params){var deferred;return params||(params={}),params.basket&&params.basket.clearItem(item),deferred=$q.defer(),item.$has("self")?MutexService.getLock().then(function(mutex){return item.$del("self",params).then(function(basket){return MutexService.unlock(mutex),company.$flush("basket"),basket=new BBModel.Basket(basket,params.bb),basket.$has("items")&&basket.$get("items").then(function(items){var j,len,results;for(results=[],j=0,len=items.length;j<len;j++)item=items[j],results.push(basket.addItem(new BBModel.BasketItem(item,params.bb)));return results}),deferred.resolve(basket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)}):deferred.reject("rel self not found for item"),deferred.promise},checkout:function(company,basket,params){var data,deferred;return deferred=$q.defer(),basket.$has("checkout")?(data=basket.getPostData(),params.bb.qudini_booking_id&&(data.qudini_booking_id=params.bb.qudini_booking_id),params.bb.booking_settings&&(data.booking_settings=params.bb.booking_settings),params.bb.no_notifications&&(data.no_notifications=params.bb.no_notifications),data.affiliate_id=$rootScope.affiliate_id||params.affiliate_id,basket.waiting_for_checkout=!0,MutexService.getLock().then(function(mutex){return basket.$post("checkout",params,data).then(function(total){var tot;return MutexService.unlock(mutex),$rootScope.$broadcast("updateBookings"),tot=new BBModel.Purchase.Total(total),$rootScope.$broadcast("newCheckout",tot),basket.clear(),basket.waiting_for_checkout=!1,deferred.resolve(tot)},function(err){return basket.waiting_for_checkout=!1,deferred.reject(err)})},function(err){return basket.waiting_for_checkout=!1,MutexService.unlock(mutex),deferred.reject(err)})):deferred.reject("rel checkout not found for basket"),deferred.promise},empty:function(bb){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return bb.company.$del("basket").then(function(basket){return MutexService.unlock(mutex),bb.company.$flush("basket"),deferred.resolve(new BBModel.Basket(basket,bb))},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)}),deferred.promise},memberCheckout:function(basket,params){var data,deferred,item;return deferred=$q.defer(),basket.$has("checkout")?null===$rootScope.member?deferred.reject("member not set"):(basket._data.setOption("auth_token",$rootScope.member._data.getOption("auth_token")),data={items:function(){var j,len,ref,results;for(ref=basket.items,results=[],j=0,len=ref.length;j<len;j++)item=ref[j],results.push(item._data);return results}()},basket.$post("checkout",params,data).then(function(total){return total.$has("member")&&total.$get("member").then(function(member){return $rootScope.member.flushBookings(),$rootScope.member=new BBModel.Member.Member(member)}),deferred.resolve(total)},function(err){return deferred.reject(err)})):deferred.reject("rel checkout not found for basket"),deferred.promise},applyDeal:function(company,params){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){
return params.bb.basket.$post("deal",{},{deal_code:params.deal_code}).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,j,len,promises;for(promises=[],j=0,len=items.length;j<len;j++)i=items[j],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise},removeDeal:function(company,params){var deferred;return params||(params={}),deferred=$q.defer(),params.bb.basket.$has("deal")?(MutexService.getLock().then(function(mutex){return params.bb.basket.$put("deal",{},{deal_code_id:params.deal_code_id.toString()}).then(function(basket){if(MutexService.unlock(mutex),company.$flush("basket"),basket=new BBModel.Basket(basket,params.bb),basket.$has("items"))return basket.$get("items").then(function(items){var item,j,len;for(j=0,len=items.length;j<len;j++)item=items[j],basket.addItem(new BBModel.BasketItem(item,params.bb));return deferred.resolve(basket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise):deferred.reject("No Remove Deal link found")}}}])}.call(this),function(){angular.module("BB.Services").factory("BreadcrumbService",function(){var current_step;return current_step=1,{setCurrentStep:function(step){return current_step=step},getCurrentStep:function(){return current_step}}})}.call(this),function(){angular.module("BB.Services").factory("BulkPurchaseService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("bulk_purchases")?company.$get("bulk_purchases").then(function(resource){return resource.$get("bulk_purchases").then(function(bulk_purchases){var i;return deferred.resolve(function(){var j,len,results;for(results=[],j=0,len=bulk_purchases.length;j<len;j++)i=bulk_purchases[j],results.push(new BBModel.BulkPurchase(i));return results}())})},function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No bulk purchases found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("CategoryService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("categories")?company.$get("named_categories").then(function(_this){return function(resource){return resource.$get("categories").then(function(items){var _i,cat,categories,i,j,len;for(categories=[],_i=j=0,len=items.length;j<len;_i=++j)i=items[_i],cat=new BBModel.Category(i),cat.order||(cat.order=_i),categories.push(cat);return deferred.resolve(categories)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No categories found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ClientService",["$q","BBModel","MutexService",function($q,BBModel,MutexService){return{create:function(company,client){var deferred;return deferred=$q.defer(),company.$has("client")?MutexService.getLock().then(function(mutex){return company.$post("client",{},client.getPostData()).then(function(_this){return function(cl){return deferred.resolve(new BBModel.Client(cl)),MutexService.unlock(mutex)}}(this),function(_this){return function(err){return deferred.reject(err),MutexService.unlock(mutex)}}(this))}):deferred.reject("Cannot create new people for this company"),deferred.promise},update:function(company,client){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return client.$put("self",{},client.getPostData()).then(function(_this){return function(cl){return deferred.resolve(new BBModel.Client(cl)),MutexService.unlock(mutex)}}(this),function(_this){return function(err){return deferred.reject(err),MutexService.unlock(mutex)}}(this))}),deferred.promise},create_or_update:function(company,client){return client.$has("self")?this.update(company,client):this.create(company,client)},query_by_email:function(company,email){var deferred;return deferred=$q.defer(),null!=company&&null!=email?company.$get("client_by_email",{email:email}).then(function(_this){return function(client){return null!=client?deferred.resolve(new BBModel.Client(client)):deferred.resolve({})}}(this),function(err){return deferred.reject(err)}):deferred.reject("No company or email defined"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ClientDetailsService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("client_details")?company.$get("client_details").then(function(_this){return function(details){return deferred.resolve(new BBModel.ClientDetails(details))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No client_details found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ClinicService",["$q","BBModel","$window",function($q,BBModel,$window){return{query:function(params){var company,defer;return company=params.company,defer=$q.defer(),params.id?company.$get("clinics",params).then(function(clinic){return clinic=new BBModel.Clinic(clinic),defer.resolve(clinic)},function(err){return defer.reject(err)}):company.$get("clinics",params).then(function(collection){return collection.$get("clinics").then(function(clinics){var s;return clinics=function(){var i,len,results;for(results=[],i=0,len=clinics.length;i<len;i++)s=clinics[i],results.push(new BBModel.Clinic(s));return results}(),defer.resolve(clinics)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("CompanyService",["$q","halClient","BBModel",function($q,halClient,BBModel){return{query:function(company_id,options){var deferred,url;return options.root||(options.root=""),url=options.root+"/api/v1/company/"+company_id,deferred=$q.defer(),halClient.$get(url,options).then(function(_this){return function(company){return deferred.resolve(company)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},queryChildren:function(company){var deferred;return deferred=$q.defer(),company.$has("companies")?company.$get("companies").then(function(_this){return function(resource){return resource.$get("companies").then(function(items){var companies,i,j,len;for(companies=[],j=0,len=items.length;j<len;j++)i=items[j],companies.push(new BBModel.Company(i));return deferred.resolve(companies)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No child companies found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("CustomTextService",["$q","BBModel",function($q,BBModel){return{BookingText:function(company,basketItem){var deferred;return deferred=$q.defer(),company.$get("booking_text").then(function(_this){return function(emb){return emb.$get("booking_text").then(function(details){var detail,i,len,link,msgs,name,ref;for(msgs=[],i=0,len=details.length;i<len;i++)if(detail=details[i],"Booking"===detail.message_type){ref=basketItem.parts_links;for(name in ref)link=ref[name],detail.$href("item")===link&&msgs.indexOf(detail.message)===-1&&msgs.push(detail.message)}return deferred.resolve(msgs)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},confirmationText:function(company,total){var deferred;return deferred=$q.defer(),company.$get("booking_text").then(function(emb){return emb.$get("booking_text").then(function(details){return total.getMessages(details,"Confirm").then(function(msgs){return deferred.resolve(msgs)})})},function(err){return deferred.reject(err)}),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("DateTimeUtilitiesService",["SettingsService",function(SettingsService){var checkPerson,checkResource;return checkPerson=function(basket_item,item_defaults){return basket_item.defaults.person&&basket_item.defaults.person.self===basket_item.person.self||_.isBoolean(basket_item.person)||item_defaults.merge_people},checkResource=function(basket_item,item_defaults){return basket_item.defaults.resource&&basket_item.defaults.resource.self===basket_item.resource.self||_.isBoolean(basket_item.resource)||item_defaults.merge_resources},{convertTimeSlotToMoment:function(date,time_slot){var datetime,hours,mins,val;if(date&&moment.isMoment(date)&&time_slot)return datetime=moment(),SettingsService.getDisplayTimeZone()!==SettingsService.getTimeZone()&&(datetime=datetime.tz(SettingsService.getTimeZone())),val=parseInt(time_slot.time),hours=parseInt(val/60),mins=val%60,datetime.hour(hours),datetime.minutes(mins),datetime.seconds(0),datetime.date(date.date()),datetime.month(date.month()),datetime.year(date.year()),datetime},convertMomentToTime:function(datetime){return datetime.minutes()+60*datetime.hours()},checkDefaultTime:function(date,time_slots,basket_item,item_defaults){var found_time_slot,i,len,match,slot,time;if(match=basket_item.defaults.time?checkPerson(basket_item,item_defaults)&&checkResource(basket_item,item_defaults)?"full":"partial":null,found_time_slot=null,basket_item.defaults.time&&(basket_item.defaults.date&&date.isSame(basket_item.defaults.date,"day")||!basket_item.defaults.date))for(time=basket_item.time?basket_item.time.time:basket_item.defaults.time,i=0,len=time_slots.length;i<len;i++)if(slot=time_slots[i],time&&time===slot.time&&1===slot.avail){found_time_slot=slot;break}return{match:match,slot:found_time_slot}}}}])}.call(this),function(){angular.module("BB.Services").factory("DayService",["$q","BBModel",function($q,BBModel){return{query:function(prms){var deferred,extra;return deferred=$q.defer(),prms.cItem.days_link?(extra={},extra.month=prms.month,extra.date=prms.date,extra.edate=prms.edate,prms.client&&(extra.location=prms.client.addressCsvLine()),prms.cItem.person&&!prms.cItem.anyPerson()&&(extra.person_id=prms.cItem.person.id),prms.cItem.resource&&!prms.cItem.anyResource()&&(extra.resource_id=prms.cItem.resource.id),prms.cItem.days_link.$get("days",extra).then(function(_this){return function(found){var afound,days,i,j,len;for(afound=found.days,days=[],j=0,len=afound.length;j<len;j++)i=afound[j],i.type===prms.item&&days.push(new BBModel.Day(i));return deferred.resolve(days)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.reject("No Days Link found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("DealService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("deals")?company.$get("deals").then(function(_this){return function(resource){return resource.$get("deals").then(function(deals){var deal;return deals=function(){var i,len,results;for(results=[],i=0,len=deals.length;i<len;i++)deal=deals[i],results.push(new BBModel.Deal(deal));return results}(),deferred.resolve(deals)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No Deals found"),deferred.promise}}}])}.call(this),function(){angular.module("BB").config(["$logProvider","$injector",function($logProvider,$injector){return $logProvider.debugEnabled(!0)}]),angular.module("BB.Services").factory("DebugUtilsService",["$rootScope","$location","$window","$log","BBModel","$bbug",function($rootScope,$location,$window,$log,BBModel,$bbug){var logObjectKeys,showScopeChain;return logObjectKeys=function(obj,showValue){var key,value;for(key in obj)value=obj[key],!obj.hasOwnProperty(key)||_.isFunction(value)||/^\$\$/.test(key)||(console.log(key),showValue&&console.log("\t",value,"\n"))},showScopeChain=function(){var $root,data,f;$root=$("[ng-app]"),data=$root.data(),data&&data.$scope&&(f=function(scope){return console.log(scope.$id),console.log(scope),scope.$$nextSibling?f(scope.$$nextSibling):scope.$$childHead?f(scope.$$childHead):void 0})(data.$scope)},function(){if(("localhost"===$location.host()||"127.0.0.1"===$location.host())&&3e3===$location.port())return window.setTimeout(function(){var scope;for(scope=$rootScope;scope&&"public.controllers.BBCtrl"!==scope.controller;)scope=scope.$$childHead;return $bbug($window).on("dblclick",function(e){var controller,controllerName,pscope;for(scope=angular.element(e.target).scope(),controller=scope.hasOwnProperty("controller"),pscope=scope,controller&&(controllerName=scope.controller);!controller;)pscope=pscope.$parent,controllerName=pscope.controller,controller=pscope.hasOwnProperty("controller");return $window.bbScope=scope,$log.log(e.target),$log.log($window.bbScope),$log.log("Controller ->",controllerName)}),$window.bbBBCtrlScopeKeyNames=function(prop){return logObjectKeys(scope,prop)},$window.bbBBCtrlScope=function(){return scope},$window.bbCurrentItem=function(){return scope.current_item},$window.bbShowScopeChain=showScopeChain},10)}(),{logObjectKeys:logObjectKeys}}])}.call(this),function(){angular.module("BB.Services").factory("Dialog",["$modal","$log",function($modal,$log){var controller;return controller=function($scope,$modalInstance,model,title,success,fail,body){return $scope.body=body,$scope.ok=function(){return $modalInstance.close(model)},$scope.cancel=function(){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")},$modalInstance.result.then(function(){if(success)return success(model)},function(){if(fail)return fail()})},{confirm:function(config){var templateUrl;return config.templateUrl&&(templateUrl=config.templateUrl),templateUrl||(templateUrl="dialog.html"),$modal.open({templateUrl:templateUrl,controller:controller,size:config.size||"sm",resolve:{model:function(){return config.model},title:function(){return config.title},success:function(){return config.success},fail:function(){return config.fail},body:function(){return config.body}}})}}}])}.call(this),function(){angular.module("BB.Services").factory("ErrorService",["SettingsService",function(SettingsService){var alerts;return alerts=[{key:"GENERIC",type:"error",title:"",persist:!0,msg:"Sorry, it appears that something went wrong. Please try again or call the business you're booking with if the problem persists."},{key:"LOCATION_NOT_FOUND",type:"warning",title:"",persist:!0,msg:"Sorry, we don't recognise that location"},{key:"MISSING_LOCATION",type:"warning",title:"",persist:!0,msg:"Please enter your location"},{key:"MISSING_POSTCODE",type:"warning",title:"",persist:!0,msg:"Please enter a postcode"},{key:"INVALID_POSTCODE",type:"warning",title:"",persist:!0,msg:"Please enter a valid postcode"},{key:"ITEM_NO_LONGER_AVAILABLE",type:"error",title:"",persist:!0,msg:"Sorry. The item you were trying to book is no longer available. Please try again."},{key:"NO_WAITLIST_SPACES_LEFT",type:"error",title:"",persist:!0,msg:"Sorry, the space has now been taken, you are still in the waitlist and we will notify you if more spaces become available"},{key:"FORM_INVALID",type:"warning",title:"",persist:!0,msg:"Please complete all required fields"},{key:"GEOLOCATION_ERROR",type:"error",title:"",persist:!0,msg:"Sorry, we could not determine your location. Please try searching instead."},{key:"EMPTY_BASKET_FOR_CHECKOUT",type:"warning",title:"",persist:!0,msg:"You need to add some items to the basket before you can checkout."},{key:"MAXIMUM_TICKETS",type:"warning",title:"",persist:!0,msg:"Sorry, the maximum number of tickets per person has been reached."},{key:"GIFT_CERTIFICATE_REQUIRED",type:"warning",title:"",persist:!0,msg:"A valid Gift Certificate is required to proceed with this booking"},{key:"TIME_SLOT_NOT_SELECTED",type:"warning",title:"",persist:!0,msg:"You need to select a time slot"},{key:"STORE_NOT_SELECTED",type:"warning",title:"",persist:!0,msg:"You need to select a store"},{key:"APPT_AT_SAME_TIME",type:"warning",title:"",persist:!0,msg:"Your appointment is already booked for this time"},{key:"REQ_TIME_NOT_AVAIL",type:"warning",title:"",persist:!0,msg:"The requested time slot is not available. Please choose a different time."},{key:"TOPUP_SUCCESS",type:"success",title:"",persist:!0,msg:"Your wallet has been topped up"},{key:"TOPUP_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, your topup failed. Please try again."},{key:"UPDATE_SUCCESS",type:"success",title:"",persist:!0,msg:"Updated"},{key:"UPDATE_FAILED",type:"warning",title:"",persist:!0,msg:"Update failed. Please try again"},{key:"ALREADY_REGISTERED",type:"warning",title:"",persist:!0,msg:"You have already registered with this email address. Please login or reset your password."},{key:"LOGIN_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, your email or password was not recognised. Please try again or reset your password."},{key:"SSO_LOGIN_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, the login process failed. Please try again."},{key:"PASSWORD_INVALID",type:"warning",title:"",persist:!0,msg:"Sorry, your chosen password is invalid"},{key:"PASSWORD_RESET_REQ_SUCCESS",type:"success",title:"",persist:!0,msg:"We have sent you an email with instructions on how to reset your password."},{key:"PASSWORD_RESET_REQ_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, we didn't find an account registered with that email."},{key:"PASSWORD_RESET_SUCESS",type:"success",title:"",persist:!0,msg:"Your password has been updated."},{key:"PASSWORD_RESET_FAILED",type:"warning",title:"",persist:!0,msg:"Sorry, we couldn't update your password. Please try again."},{key:"PASSWORD_MISMATCH",type:"warning",title:"",persist:!0,msg:"Your passwords don't match"},{key:"ATTENDEES_CHANGED",type:"info",title:"",persist:!0,msg:"Your booking has been successfully updated"},{key:"PAYMENT_FAILED",type:"danger",title:"",persist:!0,msg:"We were unable to take payment. Please contact your card issuer or try again using a different card"},{key:"ACCOUNT_DISABLED",type:"warning",title:"",persist:!0,msg:"Your account appears to be disabled. Please contact the business you're booking with if the problem persists."},{key:"FB_LOGIN_NOT_A_MEMBER",type:"warning",title:"",persist:!0,msg:"Sorry, we couldn't find a login linked with your Facebook account. You will need to sign up using Facebook first."},{key:"PHONE_NUMBER_ALREADY_REGISTERED_ADMIN",type:"warning",title:"",persist:!0,msg:"There's already an account registered with this phone number. Use the search field to find the customers account."},{key:"EMAIL_ALREADY_REGISTERED_ADMIN",type:"warning",title:"",persist:!0,msg:"There's already an account registered with this email. Use the search field to find the customers account."},{key:"WAITLIST_ACCEPTED",type:"success",title:"",persist:!1,msg:"Your booking is now confirmed!"},{key:"BOOKING_CANCELLED",type:"success",title:"",persist:!1,msg:"Your booking has been cancelled."},{key:"NOT_BOOKABLE_PERSON",type:"warning",title:"",persist:!1,msg:"Sorry, this person does not offer this service, please select another"},{key:"NOT_BOOKABLE_RESOURCE",type:"warning",title:"",persist:!1,msg:"Sorry, resource does not offer this service, pelase select another"}],{getError:function(key){var error,translate;return error=_.findWhere(alerts,{key:key}),error.persist=!0,translate=SettingsService.isInternationalizatonEnabled(),error&&translate?{msg:"ERROR."+key}:error&&!translate?error:translate?{msg:"GENERIC"}:alerts[0]},getAlert:function(key){var alert,translate;return alert=_.findWhere(alerts,{key:key}),translate=SettingsService.isInternationalizatonEnabled(),alert&&translate?{msg:"ALERT."+key}:alert&&!translate?alert:null}}}])}.call(this),function(){angular.module("BB.Services").factory("EventService",["$q","BBModel",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),params.no_cache=!0,company.$get("events",params).then(function(_this){return function(resource){return params.no_cache=!1,resource.$get("events",params).then(function(events){var event;return events=function(){var i,len,results;for(results=[],i=0,len=events.length;i<len;i++)event=events[i],results.push(new BBModel.Event(event));return results}(),deferred.resolve(events)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise},summary:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),params.summary=!0,company.$get("events",params).then(function(_this){return function(resource){return deferred.resolve(resource.events)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise},queryEventCollection:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),company.$get("events",params).then(function(_this){return function(resource){var collection;return collection=new BBModel.BBCollection(resource),deferred.resolve(collection)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("EventChainService",["$q","BBModel",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_chains")?company.$get("event_chains",params).then(function(_this){return function(resource){return resource.$get("event_chains",params).then(function(event_chains){var event_chain;return event_chains=function(){var i,len,results;for(results=[],i=0,len=event_chains.length;i<len;i++)event_chain=event_chains[i],results.push(new BBModel.EventChain(event_chain));return results}(),deferred.resolve(event_chains)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_chains"),deferred.promise},queryEventChainCollection:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_chains")?company.$get("event_chains",params).then(function(_this){return function(resource){var collection;return collection=new BBModel.BBCollection(resource),deferred.resolve(collection)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.resolve([]),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("EventGroupService",["$q","BBModel",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_groups")?company.$get("event_groups",params).then(function(_this){return function(resource){return resource.$get("event_groups",params).then(function(event_groups){var event_group;return event_groups=function(){var i,len,results;for(results=[],i=0,len=event_groups.length;i<len;i++)event_group=event_groups[i],results.push(new BBModel.EventGroup(event_group));return results}(),deferred.resolve(event_groups)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_groups"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("EventSequenceService",["$q","BBModel",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_sequences")?company.$get("event_sequences",params).then(function(_this){return function(resource){return resource.$get("event_sequences",params).then(function(event_sequences){var event_sequence;return event_sequences=function(){var i,len,results;for(results=[],i=0,len=event_sequences.length;i<len;i++)event_sequence=event_sequences[i],results.push(new BBModel.EventSequence(event_sequence));return results}(),deferred.resolve(event_sequences)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_sequences"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("PathSvc",["$sce","AppConfig",function($sce,AppConfig){return{directivePartial:function(fileName){var partial_url;return AppConfig.partial_url?(partial_url=AppConfig.partial_url,$sce.trustAsResourceUrl(partial_url+"/"+fileName+".html")):$sce.trustAsResourceUrl(fileName+".html")}}}])}.call(this),function(){"use strict";angular.module("BB.Services").factory("FormDataStoreService",["$rootScope","$window","$log","$parse",function($rootScope,$window,$log,$parse){var checkForListeners,checkRegisteredWidgets,clear,dataStore,div,getParentScope,init,log,register,registeredWidgetArr,removeWidget,resetValuesOnScope,setIfUndefined,setListeners,setValuesOnScope,showInfo,storeFormData,toId;return registeredWidgetArr=[],dataStore={},toId=0,div="___",log=function(){},showInfo=function(){return log(dataStore)},setIfUndefined=function(keyName,val){var getter,scope;if(scope=this,getter=$parse(keyName),"undefined"==typeof getter(scope))return getter.assign(scope,val)},resetValuesOnScope=function(scope,props){var i,len,prop,setter;for(i=0,len=props.length;i<len;i++)prop=props[i],prop=$parse(prop),(setter=prop.assign)(scope,null)},clear=function(scope,keepScopeValues){var data,key,widgetId;if(!scope)throw new Error("Missing scope object. Cannot clear form data without scope");if(_.isString(scope))return data=dataStore[scope],keepScopeValues||resetValuesOnScope(data[0],data[1]),void delete dataStore[scope];if(scope=getParentScope(scope),scope&&scope.bb){widgetId=scope.bb.uid,removeWidget(scope);for(key in dataStore)data=dataStore[key],key.indexOf(widgetId)!==-1&&(data[3]&&_.each(data[3],function(func){if(_.isFunction(func))return func()}),keepScopeValues||resetValuesOnScope(data[0],data[1]),delete dataStore[key])}},storeFormData=function(){var i,key,len,ndata,prop,props,scope,step,val;log("formDataStore ->",dataStore);for(key in dataStore){for(step=dataStore[key],log("\t",key),scope=step[0],props=step[1],ndata=step[2],ndata||(ndata=step[2]={}),i=0,len=props.length;i<len;i++)prop=props[i],val=ndata[prop],"data:destroyed"===val?ndata[prop]=null:(val=angular.copy(scope.$eval(prop)),ndata[prop]=val),log("\t\t",prop,val);log("\n")}},setValuesOnScope=function(currentPage,scope){var cpage,storedValues;cpage=dataStore[currentPage],storedValues=cpage[2],log("Decorating scope ->",currentPage,storedValues),_.isObject(storedValues)&&_.each(_.keys(storedValues),function(keyName){var getter;if("undefined"!=typeof storedValues[keyName]&&"data:destroyed"!==storedValues[keyName])return getter=$parse(keyName),getter.assign(scope,storedValues[keyName])}),cpage[0]=scope,log(scope),log("\n")},getParentScope=function(scope){for(;scope;){if(scope.hasOwnProperty("cid")&&"BBCtrl"===scope.cid)return scope;scope=scope.$parent}},checkRegisteredWidgets=function(scope){var i,isRegistered,len,rscope;for(isRegistered=!1,scope=getParentScope(scope),i=0,len=registeredWidgetArr.length;i<len;i++)rscope=registeredWidgetArr[i],rscope===scope&&(isRegistered=!0);return isRegistered},checkForListeners=function(propsArr){var watchArr;return watchArr=[],_.each(propsArr,function(propName,index){var split;if(split=propName.split("->"),2===split.length)return watchArr.push(split),propsArr[index]=split[0]}),watchArr},setListeners=function(scope,listenerArr,currentPage){var cpage,listenersArr;if(listenerArr.length)return cpage=dataStore[currentPage],listenersArr=cpage[3]||[],_.each(listenerArr,function(item,index){var func;return func=$rootScope.$on(item[1],function(){var e,error;try{return cpage[2][item[0]]="data:destroyed"}catch(error){return e=error,log(e)}}),listenersArr.push(func)}),cpage[3]=listenersArr},init=function(uid,scope,propsArr){var currentPage,watchArr;if(checkRegisteredWidgets(scope)){if(currentPage=scope.bb.uid+div+scope.bb.current_page+div+uid,currentPage=currentPage.toLowerCase(),watchArr=checkForListeners(propsArr),scope.clearStoredData=function(currentPage){return function(){clear(currentPage)}}(currentPage),!currentPage)throw new Error("Missing current step");if(dataStore[currentPage])return void setValuesOnScope(currentPage,scope);log("Controller registered ->",currentPage,scope,"\n\n"),dataStore[currentPage]=[scope,propsArr],setListeners(scope,watchArr,currentPage)}},removeWidget=function(scope){registeredWidgetArr=_.without(registeredWidgetArr,scope)},register=function(scope){var registered;for(registered=!1,scope&&scope.$$childHead&&(scope=scope.$$childHead);!_.has(scope,"cid");)scope=scope.$parent;if(scope){if("BBCtrl"!==scope.cid)throw new Error("This directive can only be used with the BBCtrl");return _.each(registeredWidgetArr,function(stored){if(scope===stored)return registered=!0}),registered?void 0:(log("Scope registered ->",scope),scope.$on("destroy",removeWidget),registeredWidgetArr.push(scope))}},$rootScope.$watch(function(){$window.clearTimeout(toId),toId=setTimeout(storeFormData,300)}),$rootScope.$on("save:formData",storeFormData),$rootScope.$on("clear:formData",clear),{init:init,destroy:function(scope){return clear(scope,!0)},showInfo:showInfo,register:register,setIfUndefined:setIfUndefined}}])}.call(this),function(){angular.module("BB.Services").provider("GeneralOptions",function(){var options;options={twelve_hour_format:!1,calendar_minute_step:10,calendar_min_time:"09:00",calendar_max_time:"18:00",calendar_slot_duration:5},this.setOption=function(option,value){options.hasOwnProperty(option)&&(options[option]=value)},this.$get=function(){return options}})}.call(this),function(){angular.module("BB.Services").factory("GeolocationService",["$q",function($q){return{haversine:function(position1,position2){var R,a,c,chLat,chLon,d,dLat,dLon,distance,distances,lat1,lat2,lon1,lon2,pi,rLat1,rLat2;return pi=Math.PI,R=6371,distances=[],lat1=position1.lat,lon1=position1["long"],lat2=position2.lat,lon2=position2["long"],chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c,d=.621371192*d,distance=Math.round(d)},geocode:function(address,prms){var deferred,ne,request,sw;return null==prms&&(prms={}),deferred=$q.defer(),request={address:address},prms.region&&(request.region=prms.region),prms.componentRestrictions&&(request.componentRestrictions=prms.componentRestrictions),prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),request.bounds=new google.maps.LatLngBounds(sw,ne)),(new google.maps.Geocoder).geocode(request,function(results,status){return results&&"OK"===status?deferred.resolve({results:results,status:status}):deferred.reject(status)}),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ItemService",["$q","BBModel",function($q,BBModel){
return{query:function(prms){var deferred;return deferred=$q.defer(),prms.cItem.service&&"service"!==prms.item?prms.cItem.service.$has("items")?this.build_items(prms.cItem.service.$get("items"),prms,deferred):prms.cItem.service.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):prms.cItem.resource&&!prms.cItem.anyResource()&&"resource"!==prms.item?prms.cItem.resource.$has("items")?this.build_items(prms.cItem.resource.$get("items"),prms,deferred):prms.cItem.resource.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):prms.cItem.person&&!prms.cItem.anyPerson()&&"person"!==prms.item?prms.cItem.person.$has("items")?this.build_items(prms.cItem.person.$get("items"),prms,deferred):prms.cItem.person.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):deferred.reject("No service link found"),deferred.promise},build_items:function(base_items,prms,deferred){var wait_items;return wait_items=[base_items],prms.wait&&wait_items.push(prms.wait),$q.all(wait_items).then(function(_this){return function(resources){var resource;return resource=resources[0],resource.$get("items").then(function(found){var i,len,m,matching,v,wlist;for(matching=[],wlist=[],i=0,len=found.length;i<len;i++)v=found[i],v.type===prms.item&&matching.push(new BBModel.BookableItem(v));return $q.all(function(){var j,len1,results;for(results=[],j=0,len1=matching.length;j<len1;j++)m=matching[j],results.push(m.ready.promise);return results}()).then(function(){return deferred.resolve(matching)})})}}(this))}}}])}.call(this),function(){angular.module("BB.Services").factory("ItemDetailsService",["$q","BBModel",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.cItem.service?prms.cItem.service.$has("questions")?prms.cItem.service.$get("questions").then(function(_this){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):prms.cItem.event_chain?prms.cItem.event_chain.$has("questions")?prms.cItem.event_chain.$get("questions").then(function(_this){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):prms.cItem.deal?prms.cItem.deal.$has("questions")?prms.cItem.deal.$get("questions").then(function(_this){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):deferred.resolve(),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("LoadingService",["$q","$window","$log","$rootScope","AlertService",function($q,$window,$log,$rootScope,AlertService){return{$loader:function(scope){var item,lservice;return lservice=this,item={scope:scope,setLoaded:function(){return lservice.setLoaded(scope)},setLoadedAndShowError:function(err,error_string){return lservice.setLoadedAndShowError(scope,err,error_string)},notLoaded:function(){return lservice.notLoaded(scope),this}}},setLoaded:function(cscope){var loadingFinished;for(cscope.$emit("hide:loader",cscope),cscope.isLoaded=!0,loadingFinished=!0;cscope;)cscope.hasOwnProperty("scopeLoaded")&&(this.areScopesLoaded(cscope)?cscope.scopeLoaded=!0:loadingFinished=!1),cscope=cscope.$parent;loadingFinished&&$rootScope.$broadcast("loading:finished")},setLoadedAndShowError:function(scope,err,error_string){return $log.warn(err,error_string),scope.setLoaded(scope),err&&409===err.status?AlertService.danger(ErrorService.getError("ITEM_NO_LONGER_AVAILABLE")):err.data&&"Number of Bookings exceeds the maximum"===err.data.error?AlertService.danger(ErrorService.getError("MAXIMUM_TICKETS")):AlertService.danger(ErrorService.getError("GENERIC"))},areScopesLoaded:function(cscope){var child;if(cscope.hasOwnProperty("isLoaded")&&!cscope.isLoaded)return!1;for(child=cscope.$$childHead;child;){if(!this.areScopesLoaded(child))return!1;child=child.$$nextSibling}return!0},notLoaded:function(cscope){for(cscope.$emit("show:loader",cscope),cscope.isLoaded=!1;cscope;)cscope.hasOwnProperty("scopeLoaded")&&(cscope.scopeLoaded=!1),cscope=cscope.$parent}}}])}.call(this),function(){angular.module("BB.Services").factory("LocaleService",["$window",function($window){var locale;return locale=$window.getURIparam("locale"),locale?locale:$window.navigator.language?$window.navigator.language:"en"}])}.call(this),function(){angular.module("BB.Services").factory("LoginService",["$q","halClient","$rootScope","BBModel","$sessionStorage","$localStorage",function($q,halClient,$rootScope,BBModel,$sessionStorage,$localStorage){return{companyLogin:function(company,params,form){var deferred;return deferred=$q.defer(),company.$post("login",params,form).then(function(_this){return function(login){return login.$get("member").then(function(member){return _this.setLogin(member),deferred.resolve(member)},function(err){return deferred.reject(err)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},login:function(form,options){var deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login",halClient.$post(url,options,form).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return _this.setLogin(member),deferred.resolve(member)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},FBLogin:function(company,prms){var deferred;return deferred=$q.defer(),company.$post("facebook_login",{},prms).then(function(_this){return function(login){return login.$get("member").then(function(member){return member=new BBModel.Member.Member(member),$sessionStorage.setItem("fb_user",!0),_this.setLogin(member),deferred.resolve(member)},function(err){return deferred.reject(err)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},companyQuery:function(_this){return function(id){var comp_promise;if(id)return comp_promise=halClient.$get(location.protocol+"//"+location.host+"/api/v1/company/"+id),comp_promise.then(function(company){return company=new BBModel.Company(company)})}}(this),memberQuery:function(_this){return function(params){var member_promise;if(params.member_id&&params.company_id)return member_promise=halClient.$get(location.protocol+"//"+location.host+("/api/v1/"+params.company_id+"/")+"members/"+params.member_id),member_promise.then(function(member){return member=new BBModel.Member.Member(member)})}}(this),ssoLogin:function(options,data){var deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/sso/"+options.company_id,halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return member=new BBModel.Member.Member(member),_this.setLogin(member,!0),deferred.resolve(member)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},isLoggedIn:function(){return this.checkLogin(),$rootScope.member&&(!$rootScope.user||void 0===$rootScope.user)},setLogin:function(member,persist){var auth_token;return auth_token=member.getOption("auth_token"),member=new BBModel.Member.Member(member),$sessionStorage.setItem("login",member.$toStore()),$sessionStorage.setItem("auth_token",auth_token),$rootScope.member=member,persist&&$localStorage.setItem("auth_token",auth_token),member},member:function(){return this.checkLogin(),$rootScope.member},checkLogin:function(){var member;return!!$rootScope.member||(member=$sessionStorage.getItem("login"),!!member&&(member=halClient.createResource(member),$rootScope.member=new BBModel.Member.Member(member),!0))},logout:function(options){var deferred,url;return $rootScope.member=null,deferred=$q.defer(),options||(options={}),options.root||(options.root=""),url=options.root+"/api/v1/logout",$sessionStorage.clear(),$localStorage.clear(),halClient.$del(url,options,{}).then(function(_this){return function(logout){return $sessionStorage.clear(),$localStorage.clear(),deferred.resolve(!0)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},FBLogout:function(options){return $sessionStorage.removeItem("fb_user"),this.logout(options)},sendPasswordReset:function(company,params){var deferred;return deferred=$q.defer(),company.$post("email_password_reset",{},params).then(function(_this){return function(){return deferred.resolve(!0)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},updatePassword:function(member,params){var deferred;if(params.auth_token=member.getOption("auth_token"),member&&params.new_password&&params.confirm_new_password)return deferred=$q.defer(),member.$post("update_password",{},params).then(function(_this){return function(login){return login.$get("member").then(function(member){return _this.setLogin(member,params.persist_login),deferred.resolve(member)},function(err){return deferred.reject(err)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("MembershipLevelsService",["$q","BBModel",function($q,BBModel){return{getMembershipLevels:function(company){var deferred;return deferred=$q.defer(),company.$get("member_levels").then(function(resource){return resource.$get("membership_levels").then(function(_this){return function(membership_levels){var level,levels;return levels=function(){var i,len,results;for(results=[],i=0,len=membership_levels.length;i<len;i++)level=membership_levels[i],results.push(new BBModel.MembershipLevel(level));return results}(),deferred.resolve(levels)}}(this))},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ModalForm",["$modal","$log","Dialog",function($modal,$log,Dialog){var bookForm,editForm,newForm;return newForm=function($scope,$modalInstance,company,title,new_rel,post_rel,success,fail){return $scope.loading=!0,$scope.title=title,$scope.company=company,$scope.company.$has(new_rel)?$scope.company.$get(new_rel).then(function(schema){return $scope.form=_.reject(schema.form,function(x){return"submit"===x.type}),$scope.schema=schema.schema,$scope.form_model={},$scope.loading=!1}):$log.warn("company does not have '"+new_rel+"' rel"),$scope.submit=function(form){return $scope.$broadcast("schemaFormValidate"),$scope.loading=!0,$scope.company.$post(post_rel,{},$scope.form_model).then(function(model){if($scope.loading=!1,$modalInstance.close(model),success)return success(model)},function(err){if($scope.loading=!1,$modalInstance.close(err),$log.error("Failed to create"),fail)return fail(err)})},$scope.cancel=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")}},editForm=function($scope,$modalInstance,model,title,success,fail){return $scope.loading=!0,$scope.title=title,$scope.model=model,$scope.model.$has("edit")?$scope.model.$get("edit").then(function(schema){return $scope.form=_.reject(schema.form,function(x){return"submit"===x.type}),$scope.schema=schema.schema,$scope.form_model=$scope.model,$scope.loading=!1}):$log.warn("model does not have 'edit' rel"),$scope.submit=function(form){return $scope.$broadcast("schemaFormValidate"),$scope.loading=!0,$scope.model.$update?$scope.model.$update($scope.form_model).then(function(){if($scope.loading=!1,$modalInstance.close($scope.model),success)return success($scope.model)},function(err){if($scope.loading=!1,$modalInstance.close(err),$log.error("Failed to create"),fail)return fail()}):$scope.model.$put("self",{},$scope.form_model).then(function(model){if($scope.loading=!1,$modalInstance.close(model),success)return success(model)},function(err){if($scope.loading=!1,$modalInstance.close(err),$log.error("Failed to create"),fail)return fail()})},$scope.cancel=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")},$scope.success=function(response){if(event.preventDefault(),event.stopPropagation(),$modalInstance.close(),success)return success(response)},$scope.cancelEvent=function(event,type){return null==type&&(type="booking"),event.preventDefault(),event.stopPropagation(),$modalInstance.close(),Dialog.confirm({model:model,body:"Are you sure you want to cancel this "+type+"?",success:function(model){return model.$del("self").then(function(response){if(success)return success(response)})}})}},bookForm=function($scope,$modalInstance,model,company,title,success,fail){return $scope.loading=!0,$scope.title=title,$scope.model=model,$scope.company=company,$scope.model.$has("new_booking")?$scope.model.$get("new_booking").then(function(schema){return $scope.form=_.reject(schema.form,function(x){return"submit"===x.type}),$scope.schema=schema.schema,$scope.form_model={},$scope.loading=!1}):$log.warn("model does not have 'new_booking' rel"),$scope.submit=function(form){return $scope.$broadcast("schemaFormValidate"),form.$valid?($scope.loading=!0,$scope.company.$post("bookings",{},$scope.form_model).then(function(booking){if($scope.loading=!1,$modalInstance.close(booking),success)return success(booking)},function(err){if($scope.loading=!1,$modalInstance.close(err),$log.error("Failed to create"),fail)return fail()})):$log.warn("Invalid form")},$scope.cancel=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")}},{"new":function(config){var templateUrl;return config.templateUrl&&(templateUrl=config.templateUrl),templateUrl||(templateUrl="modal_form.html"),$modal.open({templateUrl:templateUrl,controller:newForm,size:config.size,resolve:{company:function(){return config.company},title:function(){return config.title},new_rel:function(){return config.new_rel},post_rel:function(){return config.post_rel},success:function(){return config.success},fail:function(){return config.fail}}})},edit:function(config){var templateUrl;return config.templateUrl&&(templateUrl=config.templateUrl),templateUrl||(templateUrl="modal_form.html"),$modal.open({templateUrl:templateUrl,controller:editForm,size:config.size,resolve:{model:function(){return config.model},title:function(){return config.title},success:function(){return config.success},fail:function(){return config.fail}}})},book:function(config){var templateUrl;return config.templateUrl&&(templateUrl=config.templateUrl),templateUrl||(templateUrl="modal_form.html"),$modal.open({templateUrl:templateUrl,controller:bookForm,size:config.size,resolve:{model:function(){return config.model},company:function(){return config.company},title:function(){return config.title},success:function(){return config.success},fail:function(){return config.fail}}})}}}])}.call(this),function(){angular.module("BB.Services").factory("MutexService",["$q","$window","$rootScope",function($q,$window,$rootScope){return{getLock:function(prms){var iprom,mprom;return mprom=$q.defer(),iprom=$q.defer(),mprom.promise.then(function(){var next_mux;if($rootScope.mutexes.shift(),$rootScope.mutexes.length>0)return next_mux=$rootScope.mutexes[0],next_mux.iprom.resolve(next_mux.mprom)}),$rootScope.mutexes&&0!==$rootScope.mutexes.length?($rootScope.mutexes.push({mprom:mprom,iprom:iprom}),iprom.promise):($rootScope.mutexes=[{mprom:mprom,iprom:iprom}],iprom.resolve(mprom),iprom.promise)},unlock:function(mutex){return mutex.resolve()}}}])}.call(this),function(){angular.module("BB.Services").factory("PackageItemService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("packages")?company.$get("packages").then(function(resource){return resource.$get("packages").then(function(package_items){var i;return deferred.resolve(function(){var j,len,results;for(results=[],j=0,len=package_items.length;j<len;j++)i=package_items[j],results.push(new BBModel.PackageItem(i));return results}())})},function(err){return deferred.reject(err)}):deferred.reject("No packages found"),deferred.promise},getPackageServices:function(package_item){var deferred;return deferred=$q.defer(),package_item.$has("services")?package_item.$get("services").then(function(services){var s;return deferred.resolve(function(){var j,len,results;for(results=[],j=0,len=services.length;j<len;j++)s=services[j],results.push(new BBModel.Service(s));return results}())},function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No services found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("PaginationService",function(){return{initialise:function(options){var paginator;if(options)return paginator={current_page:1,page_size:options.page_size,num_pages:null,max_size:options.max_size,num_items:null}},update:function(paginator,length){var end,start,total;if(paginator&&null!=length)return paginator.num_items=length,start=(paginator.page_size-1)*paginator.current_page-(paginator.page_size-1-paginator.current_page),end=paginator.current_page*paginator.page_size,total=end<paginator.page_size?end:length,end=end>total?total:end,total=total>=100?"100+":total,paginator.summary=start+" - "+end+" of "+total},checkItems:function(paginator,items_loaded){var items_traversed,remaining_items;return items_traversed=paginator.page_size*(paginator.current_page-1),remaining_items=paginator.num_items-items_loaded,items_loaded<items_traversed+paginator.page_size&&remaining_items>0}}})}.call(this),function(){angular.module("BB.Services").factory("PathHelper",["$urlMatcherFactory","$location",function($urlMatcherFactory,$location){return{matchRouteToPath:function(route_format,param){var match,match_test,parts,pattern;if(!$location.path()||!route_format)return!1;for(parts=route_format.split("/"),match=null;parts.length>0&&!match;)match_test=parts.join("/"),pattern=$urlMatcherFactory.compile(match_test),match=pattern.exec($location.path()),parts.pop();return match[param]?match[param]:match}}}])}.call(this),function(){angular.module("BB.Services").factory("PersonService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("people")?company.$get("people").then(function(_this){return function(resource){return resource.$get("people").then(function(items){var i,j,len,people;for(people=[],j=0,len=items.length;j<len;j++)i=items[j],people.push(new BBModel.Person(i));return deferred.resolve(people)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No people found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ProductService",["$q","$window","halClient","UriTemplate","BBModel","$log","$rootScope",function($q,$window,halClient,UriTemplate,BBModel,$log,$rootScope){return{getProduct:function(prms){var deferred,href,uri;return deferred=$q.defer(),prms.id?(href=$rootScope.bb.api_url+"/api/v1/{company_id}/products/{id}",uri=new UriTemplate(href).fillFromObject({company_id:prms.company_id,id:prms.product_id})):prms.sku?(href=$rootScope.bb.api_url+"/api/v1/{company_id}/products/find_by_sku/{sku}",uri=new UriTemplate(href).fillFromObject({company_id:prms.company_id,sku:prms.sku})):($log.warn("id or sku is required"),deferred.reject()),halClient.$get(uri,{}).then(function(product){return deferred.resolve(new BBModel.Product(product))},function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},query:function(company){var deferred;return deferred=$q.defer(),company.$has("products")?company.$get("products").then(function(_this){return function(resource){return resource.$get("products").then(function(items){var i,j,len,resources;for(resources=[],j=0,len=items.length;j<len;j++)i=items[j],resources.push(new BBModel.Product(i));return deferred.resolve(resources)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No products found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("PurchaseTotalService",["$q","BBModel",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.company.$has("total")?prms.company.$get("total",{total_id:prms.total_id}).then(function(_this){return function(total){return deferred.resolve(new BBModel.PurchaseTotal(total))}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No Total link found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("QueryStringService",["$window",function($window){return function(keyName){var hash,hashes,href,i,isNum,len,val,varObj;if(varObj={},href=$window.location.href,!(href.indexOf("?")<0)){for(hashes=href.slice(href.indexOf("?")+1).split(/[#&]/),isNum=function(num){if(null!=num&&"0"!==num.substr(0,1)&&!/[a-zA-Z\-\_\+\.\#\%\*\,]/.test(num)&&!window.isNaN(window.parseInt(num,10)))return!0},i=0,len=hashes.length;i<len;i++)hash=hashes[i],hash=hash.split("="),val=hash[1],val=isNum(val)?window.parseInt(val,10):"true"===val||"false"!==val&&window.decodeURIComponent(val),varObj[hash[0]]=val;return keyName?varObj[keyName]:varObj}}}])}.call(this),function(){"use strict";angular.module("BB.Services").factory("QuestionService",["$window","QueryStringService","$bbug",function($window,QueryStringService,$bbug){var addAnswersById,addAnswersByName,addAnswersFromDefaults,addDynamicAnswersByName,checkConditionalQuestions,convertDates,convertToSnakeCase,defaults,findByQuestionId,storeDefaults;return defaults=QueryStringService()||{},convertDates=function(obj){return _.each(obj,function(val,key){var date;if(date=$window.moment(obj[key]),_.isString(obj[key])&&date.isValid())return obj[key]=date})},$window.bb_setup&&(convertDates($window.bb_setup),angular.extend(defaults,$window.bb_setup)),addAnswersById=function(questions){if(questions)return angular.isArray(questions)?_.each(questions,function(question){var id;if(id=question.id+"",!question.answer&&defaults[id])return question.answer=defaults[id]}):defaults[questions.id+""]?questions.answer=defaults[questions.id+""]:void 0},convertToSnakeCase=function(str){return str=str.toLowerCase(),str=$.trim(str),str=str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,""),str=str.replace(/\s{2,}/g," "),str=str.replace(/\s/g,"_")},addDynamicAnswersByName=function(questions){var keys;if(angular.isArray(questions))return keys=_.keys(defaults),_.each(questions,function(question){var name;return name=convertToSnakeCase(question.name),_.each(keys,function(key){(name.indexOf("_"+key)>=0||name.indexOf("_"+key+"_")>=0||name.indexOf(key+"_")>=0)&&defaults[key]&&!question.answer&&(question.answer=defaults[key],delete defaults[key])})})},addAnswersByName=function(obj,keys){var i,key,len,type;if(type=Object.prototype.toString.call(obj).slice(8,-1),"Object"===type&&angular.isArray(keys))for(i=0,len=keys.length;i<len;i++)key=keys[i],defaults[key]&&!obj[key]&&(obj[key]=defaults[key],delete defaults[key])},addAnswersFromDefaults=function(questions,answers){var i,len,name,question,results;for(results=[],i=0,len=questions.length;i<len;i++)question=questions[i],name=question.help_text,answers[name]&&(question.answer=answers[name]),answers[question.id+""]?results.push(question.answer=answers[question.id+""]):results.push(void 0);return results},storeDefaults=function(obj){return angular.extend(defaults,obj.bb_setup||{})},checkConditionalQuestions=function(questions){var a,ans,cond,found,i,len,q,ref,results,v;for(results=[],i=0,len=questions.length;i<len;i++)if(q=questions[i],q.settings&&q.settings.conditional_question)if(cond=findByQuestionId(questions,parseInt(q.settings.conditional_question))){ans=cond.getAnswerId(),found=!1,$bbug.isEmptyObject(q.settings.conditional_answers)&&"check"===cond.detail_type&&!cond.answer&&(found=!0),ref=q.settings.conditional_answers;for(a in ref)v=ref[a],"c"===a[0]&&1===parseInt(v)&&cond.answer?found=!0:parseInt(a)===ans&&1===parseInt(v)&&(found=!0);found?results.push(q.showElement()):results.push(q.hideElement())}else results.push(void 0);else results.push(void 0);return results},findByQuestionId=function(questions,qid){var i,len,q;for(i=0,len=questions.length;i<len;i++)if(q=questions[i],q.id===qid)return q;return null},{getStoredData:function(){return defaults},storeDefaults:storeDefaults,addAnswersById:addAnswersById,addAnswersByName:addAnswersByName,addDynamicAnswersByName:addDynamicAnswersByName,addAnswersFromDefaults:addAnswersFromDefaults,convertToSnakeCase:convertToSnakeCase,checkConditionalQuestions:checkConditionalQuestions}}])}.call(this),function(){angular.module("BB.Services").factory("ReasonService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("reasons")?company.$get("reasons").then(function(_this){return function(resource){return resource.$get("reasons").then(function(items){var i,j,len,reason,reasons;for(reasons=[],j=0,len=items.length;j<len;j++)i=items[j],reason=new BBModel.Reason(i),reasons.push(reason);return deferred.resolve(reasons)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("Reasons not turned on for this Company."),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("RecaptchaService",["$q","halClient","UriTemplate",function($q,halClient,UriTemplate){return{validateResponse:function(params){var deferred,href,prms,uri;return deferred=$q.defer(),href=params.api_url+"/api/v1/recaptcha",uri=new UriTemplate(href),prms={},prms.response=params.response,halClient.$post(uri,{},prms).then(function(response){return deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ResourceService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("resources")?company.$get("resources").then(function(_this){return function(resource){return resource.$get("resources").then(function(items){var i,j,len,resources;for(resources=[],j=0,len=items.length;j<len;j++)i=items[j],resources.push(new BBModel.Resource(i));return deferred.resolve(resources)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No resource found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ServiceService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("services")?company.$get("services").then(function(_this){return function(resource){return resource.$get("services").then(function(items){var i,j,len,services;for(services=[],j=0,len=items.length;j<len;j++)i=items[j],services.push(new BBModel.Service(i));return deferred.resolve(services)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No services found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("SettingsService",["$modalStack",function($modalStack){var company_time_zone,country_code,currency,display_time_zone,i18n,scroll_offset,use_local_time_zone;return i18n=!1,scroll_offset=0,country_code=null,use_local_time_zone=!1,currency=null,company_time_zone=null,display_time_zone=null,{update_document_title:!1,enableInternationalizaton:function(){return i18n=!0},isInternationalizatonEnabled:function(){return i18n},setScrollOffset:function(value){return scroll_offset=parseInt(value)},getScrollOffset:function(){return scroll_offset},setCountryCode:function(value){if(country_code=value,country_code&&country_code.match(/^(gb|au)$/))return moment.locale("en-"+country_code)},getCountryCode:function(){return country_code},setUseLocalTimeZone:function(value){return use_local_time_zone=value,display_time_zone=moment.tz.guess()},getUseLocalTimeZone:function(){return use_local_time_zone},setCurrency:function(value){return currency=value},getCurrency:function(){return currency},setTimeZone:function(value){return company_time_zone=value},getTimeZone:function(){return company_time_zone},setDisplayTimeZone:function(value){return display_time_zone=value},getDisplayTimeZone:function(){return display_time_zone?display_time_zone:company_time_zone},isModalOpen:function(){return!!$modalStack.getTop()}}}])}.call(this),function(){angular.module("BB.Services").factory("SlotService",["$q","BBModel",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("slots")?(params.item&&(params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),company.$get("slots",params).then(function(_this){return function(resource){return resource.$get("slots",params).then(function(slots){var slot;return slots=function(){var i,len,results;for(results=[],i=0,len=slots.length;i<len;i++)slot=slots[i],results.push(new BBModel.Slot(slot));return results}(),deferred.resolve(slots)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise}}}])}.call(this),function(){"use strict";angular.module("BB.Services").factory("SlotDates",["$q","DayService",function($q,DayService){var cached,getFirstDayWithSlots;return cached={firstSlotDate:null,timesQueried:0},getFirstDayWithSlots=function(cItem,selected_day){var deferred,endDate;return deferred=$q.defer(),null!=cached.firstSlotDate?(deferred.resolve(cached.firstSlotDate),deferred.promise):(endDate=selected_day.clone().add(3,"month"),DayService.query({cItem:cItem,date:selected_day.format("YYYY-MM-DD"),edate:endDate.format("YYYY-MM-DD")}).then(function(days){var firstAvailableSlots;return cached.timesQueried++,firstAvailableSlots=_.find(days,function(day){return day.spaces>0}),firstAvailableSlots?(cached.firstSlotDate=firstAvailableSlots.date,deferred.resolve(cached.firstSlotDate)):cached.timesQueried<=4?getFirstDayWithSlots(cItem,endDate).then(function(day){return deferred.resolve(cached.firstSlotDate)},function(err){return deferred.reject(err)}):deferred.reject(new Error("ERROR.NO_SLOT_AVAILABLE"))},function(err){return deferred.reject(new Error("ERROR.COULDNT_GET_AVAILABLE_DATES"))}),deferred.promise)},{getFirstDayWithSlots:getFirstDayWithSlots}}])}.call(this),function(){angular.module("BB.Services").config(["$provide",function($provide){return $provide.decorator("$sniffer",["$delegate",function($delegate){var regexp,result,webkit_version;return regexp=/Safari\/([\d.]+)/,result=regexp.exec(navigator.userAgent),webkit_version=result?parseFloat(result[1]):null,_.extend($delegate,{webkit:webkit_version}),$delegate}])}])}.call(this),function(){angular.module("BB.Services").factory("SpaceService",["$q","BBModel",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("spaces")?company.$get("spaces").then(function(_this){return function(resource){return resource.$get("spaces").then(function(items){var i,j,len,spaces;for(spaces=[],j=0,len=items.length;j<len;j++)i=items[j],spaces.push(new BBModel.Space(i));return deferred.resolve(spaces)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No spaces found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("SSOService",["$q","$rootScope","halClient","LoginService",function($q,$rootScope,halClient,LoginService){
return{memberLogin:function(options){var data,deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/sso/"+options.company_id,data={token:options.member_sso},halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return member=LoginService.setLogin(member),deferred.resolve(member)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise},adminLogin:function(options){var data,deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/admin_sso/"+options.company_id,data={token:options.admin_sso},halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("administrator").then(function(admin){return deferred.resolve(admin)})}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("TemplateSvc",["$q","$http","$templateCache","BBModel",function($q,$http,$templateCache,BBModel){return{get:function(path){var cacheTmpl,deferred;return deferred=$q.defer(),cacheTmpl=$templateCache.get(path),cacheTmpl?deferred.resolve(angular.element(cacheTmpl)):$http({method:"GET",url:path}).success(function(tmpl,status){return $templateCache.put(path,tmpl),deferred.resolve(angular.element(tmpl))}).error(function(data,status){return deferred.reject(data)}),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("TimeService",["$q","BBModel","halClient","SettingsService","DateTimeUtilitiesService",function($q,BBModel,halClient,SettingsService,DateTimeUtilitiesService){return{query:function(prms){var company_utc_offset,deferred,display_utc_offset,end_date,extra,item_link,start_date;if(deferred=$q.defer(),start_date=null,end_date=null,prms.date)prms.start_date=prms.date;else{if(!prms.cItem.date)return deferred.reject("No date set"),deferred.promise;prms.start_date=prms.cItem.date.date}return start_date=prms.start_date,prms.end_date&&(end_date=prms.end_date),SettingsService.getDisplayTimeZone()!==SettingsService.getTimeZone()&&(display_utc_offset=moment().tz(SettingsService.getDisplayTimeZone()).utcOffset(),company_utc_offset=moment().tz(SettingsService.getTimeZone()).utcOffset(),company_utc_offset<display_utc_offset?start_date=prms.start_date.clone().subtract(1,"day"):company_utc_offset>display_utc_offset&&prms.end_date&&(end_date=prms.end_date.clone().add(1,"day")),prms.time_zone=SettingsService.getDisplayTimeZone()),null==prms.duration&&prms.cItem&&prms.cItem.duration&&(prms.duration=prms.cItem.duration),item_link=prms.item_link,prms.cItem&&prms.cItem.days_link&&!item_link&&(item_link=prms.cItem.days_link),item_link?(extra={date:start_date.toISODate()},prms.location&&(extra.location=prms.location),prms.cItem.event_id&&(extra.event_id=prms.cItem.event_id),!prms.cItem.person||prms.cItem.anyPerson()||item_link.event_id||extra.event_id||(extra.person_id=prms.cItem.person.id),!prms.cItem.resource||prms.cItem.anyResource()||item_link.event_id||extra.event_id||(extra.resource_id=prms.cItem.resource.id),end_date&&(extra.end_date=end_date.toISODate()),extra.duration=prms.duration,extra.resource_ids=prms.resource_ids,extra.num_resources=prms.num_resources,prms.time_zone&&(extra.time_zone=prms.time_zone),prms.cItem.id&&(extra.ignore_booking=prms.cItem.id),extra.event_id&&(item_link=prms.company),item_link.$get("times",extra).then(function(_this){return function(results){var times;return results.$has("date_links")?results.$get("date_links").then(function(all_days){var all_days_def,date_times,day,fn,j,len;for(date_times={},all_days_def=[],fn=function(day){var times;return day.elink=$q.defer(),all_days_def.push(day.elink.promise),day.$has("event_links")?day.$get("event_links").then(function(all_events){var times;return times=_this.merge_times(all_events,prms.cItem.service,prms.cItem,day.date),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),day.elink.resolve(times)}):day.times?(times=_this.merge_times([day],prms.cItem.service,prms.cItem,day.date),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),day.elink.resolve(times)):void 0},j=0,len=all_days.length;j<len;j++)day=all_days[j],fn(day);return $q.all(all_days_def).then(function(times){var d,key,new_date_times;for(date_times=_.chain(times).flatten().sortBy(function(slot){return slot.datetime.unix()}).groupBy(function(slot){return slot.datetime.toISODate()}).value(),new_date_times={},d=prms.start_date.clone();d<=prms.end_date;)key=d.toISODate(),new_date_times[key]=date_times[key]?date_times[key]:[],d=d.clone().add(1,"day");return deferred.resolve(new_date_times)})}):results.$has("event_links")?results.$get("event_links").then(function(all_events){var times;return times=_this.merge_times(all_events,prms.cItem.service,prms.cItem,prms.start_date),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),deferred.resolve(times)}):results.times?(times=_this.merge_times([results],prms.cItem.service,prms.cItem,prms.start_date),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),deferred.resolve(times)):void 0}}(this),function(err){return deferred.reject(err)})):deferred.reject("No day data"),deferred.promise},queryItems:function(prms){var defer,item,j,len,pslots,ref;for(defer=$q.defer(),pslots=[],ref=prms.items,j=0,len=ref.length;j<len;j++)item=ref[j],pslots.push(this.query({company:prms.company,cItem:item,date:prms.start_date,end_date:prms.end_date,client:prms.client,available:1}));return $q.all(pslots).then(function(res){return defer.resolve(res)},function(err){return defer.reject()}),defer.promise},merge_times:function(all_events,service,item,date){var date_times,ev,i,j,k,l,len,len1,len2,ref,sorted_times,times;if(!all_events||0===all_events.length)return[];for(all_events=_.shuffle(all_events),sorted_times=[],j=0,len=all_events.length;j<len;j++)if(ev=all_events[j],ev.times){for(ref=ev.times,k=0,len1=ref.length;k<len1;k++)i=ref[k],(!sorted_times[i.time]||0===sorted_times[i.time].avail||0===Math.floor(Math.random()*all_events.length)&&i.avail>0)&&(i.event_id=ev.event_id,sorted_times[i.time]=i);item.held&&this.checkCurrentItem(item.held,sorted_times,ev),this.checkCurrentItem(item,sorted_times,ev)}for(times=[],date_times={},l=0,len2=sorted_times.length;l<len2;l++)i=sorted_times[l],i&&(i.datetime||(i.datetime=DateTimeUtilitiesService.convertTimeSlotToMoment(moment(date),i)),times.push(new BBModel.TimeSlot(i,service)));return times},checkCurrentItem:function(item,sorted_times,ev){return item&&item.id&&item.event_id===ev.event_id&&item.time&&!sorted_times[item.time.time]&&item.date&&item.date.date.toISODate()===ev.date?(item.time.datetime=DateTimeUtilitiesService.convertTimeSlotToMoment(item.date.date,item.time),sorted_times[item.time.time]=item.time,halClient.clearCache(ev.$href("self"))):item&&item.id&&item.event_id===ev.event_id&&item.time&&sorted_times[item.time.time]&&item.date&&item.date.date.toISODate()===ev.date?sorted_times[item.time.time].avail=1:void 0}}}])}.call(this),function(){angular.module("BB.Services").factory("TimeSlotService",["$q","BBModel",function($q,BBModel){return{query:function(params){var company,defer;return defer=$q.defer(),company=params.company,company.$get("slots",params).then(function(collection){return collection.$get("slots").then(function(slots){var s;return slots=function(){var i,len,results;for(results=[],i=0,len=slots.length;i<len;i++)s=slots[i],results.push(new BBModel.TimeSlot(s));return results}(),defer.resolve(slots)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("BB.Service.address",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Address(resource)}}}]),angular.module("BB.Services").factory("BB.Service.person",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Person(resource)}}}]),angular.module("BB.Services").factory("BB.Service.people",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("people").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Person(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.resource",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Resource(resource)}}}]),angular.module("BB.Services").factory("BB.Service.resources",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("resources").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Resource(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.service",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Service(resource)}}}]),angular.module("BB.Services").factory("BB.Service.services",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred,models,service;return deferred=$q.defer(),angular.isArray(resource)?(models=function(){var j,len,results;for(results=[],j=0,len=resource.length;j<len;j++)service=resource[j],results.push(new BBModel.Service(service));return results}(),deferred.resolve(models)):resource.$get("services").then(function(_this){return function(items){var i,j,len;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Service(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.package_item",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.PackageItem(resource)}}}]),angular.module("BB.Services").factory("BB.Service.package_items",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("package_items").then(function(_this){return function(package_items){var i,j,len,models;for(models=[],j=0,len=package_items.length;j<len;j++)i=package_items[j],models.push(new BBModel.PackageItem(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.bulk_purchase",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.BulkPurchase(resource)}}}]),angular.module("BB.Services").factory("BB.Service.bulk_purchases",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var bulk_purchase,deferred,models;return deferred=$q.defer(),angular.isArray(resource)?(models=function(){var j,len,results;for(results=[],j=0,len=resource.length;j<len;j++)bulk_purchase=resource[j],results.push(new BBModel.BulkPurchase(bulk_purchase));return results}(),deferred.resolve(models)):resource.$get("bulk_purchases").then(function(_this){return function(bulk_purchases){var i,j,len;for(models=[],j=0,len=bulk_purchases.length;j<len;j++)i=bulk_purchases[j],models.push(new BBModel.BulkPurchase(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.event_group",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.EventGroup(resource)}}}]),angular.module("BB.Services").factory("BB.Service.event_groups",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("event_groups").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.EventGroup(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.event_chain",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.EventChain(resource)}}}]),angular.module("BB.Services").factory("BB.Service.event_chains",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.EventChain(resource)}}}]),angular.module("BB.Services").factory("BB.Service.category",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Category(resource)}}}]),angular.module("BB.Services").factory("BB.Service.categories",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("categories").then(function(_this){return function(items){var cat,i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],cat=new BBModel.Category(i),cat.order||(cat.order=_i),models.push(cat);return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.client",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Client(resource)}}}]),angular.module("BB.Services").factory("BB.Service.child_clients",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("clients").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Client(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.clients",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("clients").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Client(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.questions",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){var defer,i,j,k,len,len1,ref,results,results1;if(resource.questions){for(ref=resource.questions,results=[],j=0,len=ref.length;j<len;j++)i=ref[j],results.push(new BBModel.Question(i));return results}if(resource.$has("questions"))return defer=$q.defer(),resource.$get("questions").then(function(items){return defer.resolve(function(){var k,len1,results1;for(results1=[],k=0,len1=items.length;k<len1;k++)i=items[k],results1.push(new BBModel.Question(i));return results1}())},function(err){return defer.reject(err)}),defer.promise;for(results1=[],k=0,len1=resource.length;k<len1;k++)i=resource[k],results1.push(new BBModel.Question(i));return results1}}}]),angular.module("BB.Services").factory("BB.Service.question",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Question(resource)}}}]),angular.module("BB.Services").factory("BB.Service.answers",["$q","BBModel",function($q,BBModel){return{promise:!1,unwrap:function(items){var answers,i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Answer(i));return answers={answers:models,getAnswer:function(question){var a,k,len1,ref;for(ref=this.answers,k=0,len1=ref.length;k<len1;k++)if(a=ref[k],a.question_text===question||a.question_id===question)return a.value}}}}}]),angular.module("BB.Services").factory("BB.Service.administrators",["$q","BBModel",function($q,BBModel){return{unwrap:function(items){var i,j,len,results;for(results=[],j=0,len=items.length;j<len;j++)i=items[j],results.push(new BBModel.Admin.User(i));return results}}}]),angular.module("BB.Services").factory("BB.Service.company",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Company(resource)}}}]),angular.module("BB.Services").factory("BB.Service.parent",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Company(resource)}}}]),angular.module("BB.Services").factory("BB.Service.company_questions",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("company_questions").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.BusinessQuestion(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.company_question",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.BusinessQuestion(resource)}}}]),angular.module("BB.Services").factory("BB.Service.images",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("images").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Image(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.bookings",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("bookings").then(function(_this){return function(items){var i,j,len,models;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Member.Booking(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.wallet",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Member.Wallet(resource)}}}]),angular.module("BB.Services").factory("BB.Service.product",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Product(resource)}}}]),angular.module("BB.Services").factory("BB.Service.products",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("products").then(function(_this){return function(items){var cat,i,index,j,len,models;for(models=[],index=j=0,len=items.length;j<len;index=++j)i=items[index],cat=new BBModel.Product(i),cat.order||(cat.order=index),models.push(cat);return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.pre_paid_booking",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.PrePaidBooking(resource)}}}]),angular.module("BB.Services").factory("BB.Service.pre_paid_bookings",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred,models,pre_paid_booking;return deferred=$q.defer(),angular.isArray(resource)?(models=function(){var j,len,results;for(results=[],j=0,len=resource.length;j<len;j++)pre_paid_booking=resource[j],results.push(new BBModel.PrePaidBooking(pre_paid_booking));return results}(),deferred.resolve(models)):resource.$get("pre_paid_bookings").then(function(_this){return function(items){var i,j,len;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.PrePaidBooking(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.external_purchase",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.ExternalPurchase(resource)}}}]),angular.module("BB.Services").factory("BB.Service.external_purchases",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred,external_purchase,models;return deferred=$q.defer(),angular.isArray(resource)?(models=function(){var j,len,results;for(results=[],j=0,len=resource.length;j<len;j++)external_purchase=resource[j],results.push(new BBModel.ExternalPurchase(external_purchase));return results}(),deferred.resolve(models)):resource.$get("external_purchases").then(function(_this){return function(items){var i,j,len;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.ExternalPurchase(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.purchase_item",["$q","BBModel",function($q,BBModel){return{unwrap:function(resource){return new BBModel.PurchaseItem(resource)}}}]),angular.module("BB.Services").factory("BB.Service.purchase_items",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred,models,purchase_item;return deferred=$q.defer(),angular.isArray(resource)?(models=function(){var j,len,results;for(results=[],j=0,len=resource.length;j<len;j++)purchase_item=resource[j],results.push(new BBModel.PurchaseItem(purchase_item));return results}(),deferred.resolve(models)):resource.$get("purchase_items").then(function(_this){return function(items){var i,j,len;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.PurchaseItem(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}]),angular.module("BB.Services").factory("BB.Service.events",["$q","BBModel",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred,event,models;return deferred=$q.defer(),angular.isArray(resource)?(models=function(){var j,len,results;for(results=[],j=0,len=resource.length;j<len;j++)event=resource[j],results.push(new BBModel.Event(event));return results}(),deferred.resolve(models)):resource.$get("events").then(function(_this){return function(items){var i,j,len;for(models=[],j=0,len=items.length;j<len;j++)i=items[j],models.push(new BBModel.Event(i));return deferred.resolve(models)}}(this),function(_this){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("ValidatorService",["$rootScope","AlertService","SettingsService","BBModel","$q","$bbug",function($rootScope,AlertService,SettingsService,BBModel,$q,$bbug){var alphanumeric,email_regex,geocode_result,international_number,mobile_regex_lenient,number_only_regex,standard_password,uk_landline_regex_lenient,uk_landline_regex_strict,uk_mobile_regex_strict,uk_postcode_regex,uk_postcode_regex_lenient,us_postcode_regex;return uk_postcode_regex=/^(((([A-PR-UWYZ][0-9][0-9A-HJKS-UW]?)|([A-PR-UWYZ][A-HK-Y][0-9][0-9ABEHMNPRV-Y]?))\s{0,1}[0-9]([ABD-HJLNP-UW-Z]{2}))|(GIR\s{0,2}0AA))$/i,us_postcode_regex=/^\d{5}(?:[-\s]\d{4})?$/,uk_postcode_regex_lenient=/^[A-Z]{1,2}[0-9][0-9A-Z]?\s*[0-9][A-Z]{2}$/i,number_only_regex=/^\d+$/,uk_mobile_regex_strict=/^((\+44\s?|0)7([45789]\d{2}|624)\s?\d{3}\s?\d{3})$/,mobile_regex_lenient=/^(0|\+)([\d \(\)]{9,19})$/,uk_landline_regex_strict=/^(\(?(0|\+44)[1-9]{1}\d{1,4}?\)?\s?\d{3,4}\s?\d{3,4})$/,uk_landline_regex_lenient=/^(0|\+)([\d \(\)]{9,19})$/,international_number=/^(\+)([\d \(\)]{9,19})$/,email_regex=/^$|^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i,standard_password=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/,alphanumeric=/^[a-zA-Z0-9]*$/,geocode_result=null,{alpha:/^[a-zA-Z\s]*$/,us_phone_number:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,getEmailPattern:function(){return email_regex},getStandardPassword:function(){return standard_password},getUKPostcodePattern:function(){return uk_postcode_regex_lenient},getMailingPattern:function(){var cc;return cc=SettingsService.getCountryCode(),(cc="us")?us_postcode_regex:uk_postcode_regex_lenient},getNumberOnlyPattern:function(){return number_only_regex},getAlphaNumbericPattern:function(){return alphanumeric},getUKMobilePattern:function(strict){return null==strict&&(strict=!1),strict?uk_mobile_regex_strict:mobile_regex_lenient},getMobilePattern:function(){return mobile_regex_lenient},getUKLandlinePattern:function(strict){return null==strict&&(strict=!1),strict?uk_landline_regex_strict:uk_landline_regex_lenient},getIntPhonePattern:function(){return international_number},getGeocodeResult:function(){if(geocode_result)return geocode_result},validatePostcode:function(form,prms){var deferred,geocoder,ne,postcode,req,sw;return AlertService.clear(),!(!form||!form.postcode)&&(form.$error.required?(AlertService.raise("MISSING_POSTCODE"),!1):form.$error.pattern?(AlertService.raise("INVALID_POSTCODE"),!1):(deferred=$q.defer(),postcode=form.postcode.$viewValue,req={address:postcode},prms.region&&(req.region=prms.region),req.componentRestrictions={postalCode:req.address},prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),req.bounds=new google.maps.LatLngBounds(sw,ne)),geocoder=new google.maps.Geocoder,geocoder.geocode(req,function(results,status){return 1===results.length&&"OK"===status?(geocode_result=results[0],deferred.resolve(!0)):(AlertService.raise("INVALID_POSTCODE"),$rootScope.$apply(),deferred.reject(!1))}),deferred.promise))},validateForm:function(form){return!!form&&(form.submitted=!0,$rootScope.$broadcast("form:validated",form),form.$invalid&&form.raise_alerts&&form.alert?(AlertService.danger(form.alert),!1):form.$invalid&&form.raise_alerts?(AlertService.danger(ErrorService.getError("FORM_INVALID")),!1):!form.$invalid)}}}])}.call(this),function(){"use strict";angular.module("BB.Services").factory("ViewportSize",["$rootScope",function($rootScope){var viewport_size;return viewport_size=null,{setViewportSize:function(size){if(size!==viewport_size)return viewport_size=size,$rootScope.$broadcast("ViewportSize:changed")},getViewportSize:function(){return viewport_size}}}])}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("BB.Models").factory("BBWidget",["$q","BBModel","BasketService","$urlMatcherFactory","$location","BreadcrumbService","$window","$rootScope","PathHelper","SettingsService",function($q,BBModel,BasketService,$urlMatcherFactory,$location,BreadcrumbService,$window,$rootScope,PathHelper,SettingsService){var Widget;return Widget=function(){function Widget(){this.clearAddress=bind(this.clearAddress,this),this.emptyStackedItems=bind(this.emptyStackedItems,this),this.deleteStackedItemByService=bind(this.deleteStackedItemByService,this),this.removeItemFromStack=bind(this.removeItemFromStack,this),this.deleteStackedItem=bind(this.deleteStackedItem,this),this.sortStackedItems=bind(this.sortStackedItems,this),this.setStackedItems=bind(this.setStackedItems,this),this.stackItem=bind(this.stackItem,this),this.waitForRoutes=bind(this.waitForRoutes,this),this.setBasicRoute=bind(this.setBasicRoute,this),this.setRoute=bind(this.setRoute,this),this.calculatePercentageComplete=bind(this.calculatePercentageComplete,this),this.recordStep=bind(this.recordStep,this),this.recordCurrentPage=bind(this.recordCurrentPage,this),this.uid=_.uniqueId("bbwidget_"),this.page_suffix="",this.steps=[],this.allSteps=[],this.item_defaults={},this.usingBasket=!1,this.confirmCheckout=!1,this.isAdmin=!1,this.payment_status=null}return Widget.prototype.pageURL=function(route){return route+".html"},Widget.prototype.updateRoute=function(page){var company,date,event,event_group,pattern,prms,service_name,time,url;if(this.routeFormat)return page||(page=this.current_page),pattern=$urlMatcherFactory.compile(this.routeFormat),service_name="-",event_group="-",event="-",this.current_item&&(this.current_item.service&&(service_name=this.convertToDashSnakeCase(this.current_item.service.name)),this.current_item.event_group&&(event_group=this.convertToDashSnakeCase(this.current_item.event_group.name)),this.current_item.event&&(event=this.current_item.event.id),this.current_item.date&&(date=this.current_item.date.date.toISODate()),this.current_item.time&&(time=this.current_item.time.time),this.current_item.company&&(company=this.convertToDashSnakeCase(this.current_item.company.name))),this.route_values&&(prms=angular.copy(this.route_values)),prms||(prms={}),angular.extend(prms,{page:page,company:company,service:service_name,event_group:event_group,date:date,time:time,event:event}),url=pattern.format(prms),url=url.replace(/\/+$/,""),$location.path(url),this.routing=!0,url},Widget.prototype.setRouteFormat=function(route){var match;if(this.routeFormat=route,this.routeFormat)return this.routing=!0,match=PathHelper.matchRouteToPath(this.routeFormat),match?(match.company&&(this.item_defaults.company=decodeURIComponent(match.company)),match.service&&"-"!==match.service&&(this.item_defaults.service=decodeURIComponent(match.service)),match.event_group&&"-"!==match.event_group&&(this.item_defaults.event_group=match.event_group),match.event&&"-"!==match.event&&(this.item_defaults.event=decodeURIComponent(match.event)),match.person&&(this.item_defaults.person=decodeURIComponent(match.person)),match.resource&&(this.item_defaults.resource=decodeURIComponent(match.resource)),match.resources&&(this.item_defaults.resources=decodeURIComponent(match.resoures)),match.date&&(this.item_defaults.date=match.date),match.time&&(this.item_defaults.time=match.time),this.route_matches=match):void 0},Widget.prototype.matchURLToStep=function(){var page,step;return page=PathHelper.matchRouteToPath(this.routeFormat,"page"),step=_.findWhere(this.allSteps,{page:page}),step?step.number:null},Widget.prototype.convertToDashSnakeCase=function(str){return str=str.toLowerCase(),str=$.trim(str),str=str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,""),str=str.replace(/\s{2,}/g," "),str=str.replace(/\s/g,"-")},Widget.prototype.recordCurrentPage=function(){var j,k,l,len,len1,len2,match,ref,ref1,ref2,setDocumentTitle,step,title;if(setDocumentTitle=function(title){if(SettingsService.update_document_title&&title)return document.title=title},this.current_step||(this.current_step=0),match=!1,this.allSteps)for(ref=this.allSteps,j=0,len=ref.length;j<len;j++)step=ref[j],step.page===this.current_page&&(this.current_step=step.number,setDocumentTitle(step.title),match=!0);if(!match)for(ref1=this.steps,k=0,len1=ref1.length;k<len1;k++)step=ref1[k],step&&step.page===this.current_page&&(this.current_step=step.number,setDocumentTitle(step.title),match=!0);if(match||(this.current_step+=1),title="",this.allSteps){for(ref2=this.allSteps,l=0,len2=ref2.length;l<len2;l++)step=ref2[l],step.active=!1,step.passed=step.number<this.current_step;this.allSteps[this.current_step-1]&&(this.allSteps[this.current_step-1].active=!0,title=this.allSteps[this.current_step-1].title)}return this.recordStep(this.current_step,title)},Widget.prototype.recordStep=function(step_number,title){var j,len,ref,step;for(this.steps[step_number-1]={url:this.updateRoute(this.current_page),
current_item:this.current_item.getStep(),page:this.current_page,number:step_number,title:title,stacked_length:this.stacked_items.length},BreadcrumbService.setCurrentStep(step_number),ref=this.steps,j=0,len=ref.length;j<len;j++)step=ref[j],step&&(step.passed=step.number<this.current_step,step.active=step.number===this.current_step),step&&step.number===step_number&&this.calculatePercentageComplete(step.number);return this.allSteps&&this.allSteps.length===step_number||"checkout"===this.current_page?this.last_step_reached=!0:this.last_step_reached=!1},Widget.prototype.calculatePercentageComplete=function(step_number){return this.percentage_complete=step_number&&this.allSteps?step_number/this.allSteps.length*100:0},Widget.prototype.setRoute=function(rdata){var i,j,k,len,len1,ref,route,step;for(this.allSteps.length=0,this.nextSteps={},void 0!==rdata&&null!==rdata&&void 0!==rdata[0]&&(this.firstStep=rdata[0].page),i=j=0,len=rdata.length;j<len;i=++j)if(step=rdata[i],step.disable_breadcrumbs&&(this.disableGoingBackAtStep=i+1),rdata[i+1]&&(this.nextSteps[step.page]=rdata[i+1].page),this.allSteps.push({number:i+1,title:step.title,page:step.page}),step.when)for(this.routeSteps||(this.routeSteps={}),ref=step.when,k=0,len1=ref.length;k<len1;k++)route=ref[k],this.routeSteps[route]=step.page;if(this.$wait_for_routing)return this.$wait_for_routing.resolve()},Widget.prototype.setBasicRoute=function(routes){var i,j,len,step;for(this.nextSteps={},this.firstStep=routes[0],i=j=0,len=routes.length;j<len;i=++j)step=routes[i],this.nextSteps[step]=routes[i+1];if(this.$wait_for_routing)return this.$wait_for_routing.resolve()},Widget.prototype.waitForRoutes=function(){if(!this.$wait_for_routing)return this.$wait_for_routing=$q.defer()},Widget.prototype.stackItem=function(item){if(this.stacked_items.push(item),this.sortStackedItems(),1===this.stacked_items.length)return this.current_item=item},Widget.prototype.setStackedItems=function(items){return this.stacked_items=items,this.sortStackedItems()},Widget.prototype.sortStackedItems=function(){var arr,item,j,len,ref;for(arr=[],ref=this.stacked_items,j=0,len=ref.length;j<len;j++)item=ref[j],arr=arr.concat(item.promises);return $q.all(arr)["finally"](function(_this){return function(){return _this.stacked_items=_this.stacked_items.sort(function(a,b){var ref1,ref2;return a.time&&b.time?null!=(ref1=a.time.time>b.time.time)?ref1:{1:-1}:a.service.category&&!b.service.category?1:b.service.category&&!a.service.category?-1:b.service.category||a.service.category?null!=(ref2=a.service.category.order>b.service.category.order)?ref2:{1:-1}:1})}}(this))},Widget.prototype.deleteStackedItem=function(item){return item&&item.id&&BasketService.deleteItem(item,this.company,{bb:this}),this.stacked_items=this.stacked_items.filter(function(i){return i!==item})},Widget.prototype.removeItemFromStack=function(item){return this.stacked_items=this.stacked_items.filter(function(i){return i!==item})},Widget.prototype.deleteStackedItemByService=function(item){var i,j,len,ref;for(ref=this.stacked_items,j=0,len=ref.length;j<len;j++)i=ref[j],i&&i.service&&i.service.self===item.self&&i.id&&BasketService.deleteItem(i,this.company,{bb:this});return this.stacked_items=this.stacked_items.filter(function(i){return i&&i.service&&i.service.self!==item.self})},Widget.prototype.emptyStackedItems=function(){return this.stacked_items=[]},Widget.prototype.pushStackToBasket=function(){var i,j,len,ref;for(this.basket||(this.basket=new new BBModel.Basket(null,this)),ref=this.stacked_items,j=0,len=ref.length;j<len;j++)i=ref[j],this.basket.addItem(i);return this.emptyStackedItems()},Widget.prototype.totalStackedItemsDuration=function(){var duration,item,j,len,ref;for(duration=0,ref=this.stacked_items,j=0,len=ref.length;j<len;j++)item=ref[j],item.service&&item.service.listed_duration&&(duration+=item.service.listed_duration);return duration},Widget.prototype.clearStackedItemsDateTime=function(){var item,j,len,ref,results;for(ref=this.stacked_items,results=[],j=0,len=ref.length;j<len;j++)item=ref[j],results.push(item.clearDateTime());return results},Widget.prototype.clearAddress=function(){return delete this.address1,delete this.address2,delete this.address3,delete this.address4,delete this.address5},Widget}()}])}.call(this),function(){var ModalDelete,ModalDeleteAll;angular.module("BB.Directives").directive("bbPurchase",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Purchase",link:function(scope,element,attrs){scope.init(scope.$eval(attrs.bbPurchase))}}}),angular.module("BB.Controllers").controller("Purchase",["$scope","$rootScope","CompanyService","PurchaseService","ClientService","$modal","$location","$timeout","BBWidget","BBModel","$q","QueryStringService","SSOService","AlertService","LoginService","$window","ServiceService","$sessionStorage","SettingsService","$translate","ReasonService",function($scope,$rootScope,CompanyService,PurchaseService,ClientService,$modal,$location,$timeout,BBWidget,BBModel,$q,QueryStringService,SSOService,AlertService,LoginService,$window,ServiceService,$sessionStorage,SettingsService,$translate,ReasonService){var checkIfMoveBooking,checkIfWaitlistBookings,failMsg,getBookings,getCompanyID,getPurchase,getPurchaseID,getReasons,loginRequired,setCancelReasons,setCancelReasonsToBB,setMoveReasons,setMoveReasonsToBB,setPurchaseCompany;return $scope.controller="Purchase",$scope.is_waitlist=!1,$scope.make_payment=!1,setPurchaseCompany=function(company){if($scope.bb.company_id=company.id,$scope.bb.company=new BBModel.Company(company),$scope.company=$scope.bb.company,$scope.bb.item_defaults.company=$scope.bb.company,company.settings&&(company.settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),company.settings.merge_people))return $scope.bb.item_defaults.merge_people=!0},failMsg=function(){return $scope.fail_msg?AlertService.danger({msg:$scope.fail_msg}):SettingsService.isInternationalizatonEnabled()?$translate("ERROR.GENERIC",{}).then(function(translated_text){return AlertService.add("danger",{msg:translated_text})}):AlertService.raise("GENERIC")},$scope.init=function(options){return options||(options={}),$scope.notLoaded($scope),options.move_route&&($scope.move_route=options.move_route),options.move_all&&($scope.move_all=options.move_all),options.fail_msg&&($scope.fail_msg=options.fail_msg),$scope.bb.total?$scope.load($scope.bb.total.long_id):$scope.bb.purchase?($scope.purchase=$scope.bb.purchase,$scope.bookings=$scope.bb.purchase.bookings,$scope.purchase.confirm_messages&&($scope.messages=$scope.purchase.confirm_messages),$scope.cancel_reasons||($scope.cancel_reasons=$scope.bb.cancel_reasons),$scope.move_reasons||($scope.move_reasons=$scope.bb.move_reasons),$scope.setLoaded($scope)):options.member_sso?SSOService.memberLogin(options).then(function(login){return $scope.load()},function(err){return $scope.setLoaded($scope),failMsg()}):$scope.load()},getPurchase=function(params){var deferred;return deferred=$q.defer(),PurchaseService.query(params).then(function(purchase){return deferred.resolve(purchase),purchase.$get("company").then(function(_this){return function(company){return setPurchaseCompany(company)}}(this)),$scope.purchase=purchase,$scope.bb.purchase=purchase,$scope.price=!(0===$scope.purchase.price)},function(err){return $scope.setLoaded($scope),err&&401===err.status?LoginService.isLoggedIn()?failMsg():loginRequired():failMsg()}),deferred.promise},getBookings=function(purchase){return $scope.purchase.getBookingsPromise().then(function(bookings){var booking,i,len,ref,results;for($scope.bookings=bookings,bookings[0]&&bookings[0].getCompanyPromise().then(function(company){return $scope.purchase.bookings[0].company=company,company.$has("reasons")&&getReasons(company).then(function(reasons){return setCancelReasons(),setMoveReasons(),setMoveReasonsToBB(),setCancelReasonsToBB()}),company.getAddressPromise().then(function(address){return $scope.purchase.bookings[0].company.address=address})}),$scope.setLoaded($scope),checkIfMoveBooking(bookings),checkIfWaitlistBookings(bookings),ref=$scope.bookings,results=[],i=0,len=ref.length;i<len;i++)booking=ref[i],results.push(booking.getAnswersPromise().then(function(answers){return booking.answers=answers}));return results},function(err){return $scope.setLoaded($scope),failMsg()}),purchase.$has("client")&&purchase.$get("client").then(function(_this){return function(client){return $scope.setClient(new BBModel.Client(client))}}(this)),$scope.purchase.getConfirmMessages().then(function(messages){return $scope.purchase.confirm_messages=messages,$scope.messages=messages})},$scope.load=function(id){return $scope.notLoaded($scope),id||(id=getPurchaseID()),!$scope.loaded&&id&&$rootScope.widget_started.then(function(_this){return function(){return $scope.waiting_for_conn_started.then(function(){var auth_token,company_id,params;return company_id=getCompanyID(),company_id&&CompanyService.query(company_id,{}).then(function(company){return setPurchaseCompany(company)}),params={purchase_id:id,url_root:$scope.bb.api_url},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),getPurchase(params).then(function(purchase){return getBookings(purchase)})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loaded=!0},checkIfMoveBooking=function(bookings){var b,id,matches,move_booking;if(matches=/^.*(?:\?|&)move_booking=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(id=parseInt(matches[1])),id&&(move_booking=function(){var i,len,results;for(results=[],i=0,len=bookings.length;i<len;i++)b=bookings[i],b.id===id&&results.push(b);return results}(),move_booking.length>0&&$scope.isMovable(bookings[0])))return $scope.move(move_booking[0])},checkIfWaitlistBookings=function(bookings){var booking;return $scope.waitlist_bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;i<len;i++)booking=bookings[i],booking.on_waitlist&&1===booking.settings.sent_waitlist&&results.push(booking);return results}()},loginRequired=function(_this){return function(){if(!$scope.bb.login_required)return window.location=window.location.href+"&login=true"}}(this),getCompanyID=function(){var company_id,matches;return matches=/^.*(?:\?|&)company_id=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(company_id=matches[1]),company_id},getPurchaseID=function(){var id,matches;return matches=/^.*(?:\?|&)id=(.*?)(?:&|$)/.exec($location.absUrl()),matches||(matches=/^.*print_purchase\/(.*?)(?:\?|$)/.exec($location.absUrl())),matches||(matches=/^.*print_purchase_jl\/(.*?)(?:\?|$)/.exec($location.absUrl())),matches?id=matches[1]:QueryStringService("ref")&&(id=QueryStringService("ref")),QueryStringService("booking_id")&&(id=QueryStringService("booking_id")),id},$scope.move=function(booking,route,options){return null==options&&(options={}),route||(route=$scope.move_route),$scope.move_all?$scope.moveAll(route,options):($scope.notLoaded($scope),$scope.initWidget({company_id:booking.company_id,no_route:!0}),$timeout(function(_this){return function(){return $rootScope.connection_started.then(function(){var new_item,proms;return proms=[],$scope.bb.moving_booking=booking,$scope.quickEmptybasket(),new_item=new BBModel.BasketItem(booking,$scope.bb),new_item.setSrcBooking(booking,$scope.bb),new_item.ready=!1,Array.prototype.push.apply(proms,new_item.promises),$scope.bb.basket.addItem(new_item),$scope.setBasketItem(new_item),$q.all(proms).then(function(){return $scope.setLoaded($scope),$rootScope.$broadcast("booking:move"),$scope.decideNextPage(route)},function(err){return $scope.setLoaded($scope),failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this)))},$scope.moveAll=function(route,options){return null==options&&(options={}),route||(route=$scope.move_route),$scope.notLoaded($scope),$scope.initWidget({company_id:$scope.bookings[0].company_id,no_route:!0}),$timeout(function(_this){return function(){return $rootScope.connection_started.then(function(){var booking,i,len,new_item,proms,ref;for(proms=[],1===$scope.bookings.length?$scope.bb.moving_booking=$scope.bookings[0]:$scope.bb.moving_booking=$scope.purchase,_.every(_.map($scope.bookings,function(b){return b.event_id}),function(event_id){return event_id===$scope.bookings[0].event_id})&&($scope.bb.moving_purchase=$scope.purchase),$scope.quickEmptybasket(),ref=$scope.bookings,i=0,len=ref.length;i<len;i++)booking=ref[i],new_item=new BBModel.BasketItem(booking,$scope.bb),new_item.setSrcBooking(booking),new_item.ready=!1,new_item.move_done=!1,Array.prototype.push.apply(proms,new_item.promises),$scope.bb.basket.addItem(new_item);return $scope.bb.sortStackedItems(),$scope.setBasketItem($scope.bb.basket.items[0]),$q.all(proms).then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoaded($scope),failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this))},$scope.bookWaitlistItem=function(booking){var params;return $scope.notLoaded($scope),params={purchase:$scope.purchase,booking:booking},PurchaseService.bookWaitlistItem(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.bb.purchase=purchase,$scope.purchase.getBookingsPromise().then(function(bookings){return $scope.bookings=bookings,$scope.waitlist_bookings=function(){var i,len,ref,results;for(ref=$scope.bookings,results=[],i=0,len=ref.length;i<len;i++)booking=ref[i],booking.on_waitlist&&1===booking.settings.sent_waitlist&&results.push(booking);return results}(),$scope.purchase.$has("new_payment")&&$scope.purchase.due_now>0&&($scope.make_payment=!0),$scope.setLoaded($scope)},function(err){return $scope.setLoaded($scope),failMsg()})},function(_this){return function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}}(this))},$scope["delete"]=function(booking){var modalInstance;return modalInstance=$modal.open({templateUrl:$scope.getPartial("_cancel_modal"),controller:ModalDelete,resolve:{booking:function(){return booking},cancel_reasons:function(){return $scope.cancel_reasons}}}),modalInstance.result.then(function(booking){var cancel_reason,data;return cancel_reason=null,booking.cancel_reason&&(cancel_reason=booking.cancel_reason),data={cancel_reason:cancel_reason},booking.$del("self",{},data).then(function(_this){return function(service){return $scope.bookings=_.without($scope.bookings,booking),$rootScope.$broadcast("booking:cancelled")}}(this))})},$scope.deleteAll=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:$scope.getPartial("_cancel_modal"),controller:ModalDeleteAll,resolve:{purchase:function(){return $scope.purchase}}}),modalInstance.result.then(function(purchase){return PurchaseService.deleteAll(purchase).then(function(purchase){return $scope.purchase=purchase,$scope.bookings=[],$rootScope.$broadcast("booking:cancelled")})})},$scope.isMovable=function(booking){return booking.min_cancellation_time?moment().isBefore(booking.min_cancellation_time):booking.datetime.isAfter(moment())},$scope.createBasketItem=function(booking){var item;return item=new BBModel.BasketItem(booking,$scope.bb),item.setSrcBooking(booking),item},$scope.checkAnswer=function(answer){return"boolean"==typeof answer.value||"string"==typeof answer.value||"number"==typeof answer.value},$scope.changeAttendees=function(route){return $scope.moveAll(route)},getReasons=function(company){return ReasonService.query(company).then(function(reasons){return $scope.company_reasons=reasons,$scope.company_reasons},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong retrieving reasons")})},setCancelReasons=function(){return $scope.cancel_reasons=_.filter($scope.company_reasons,function(r){return 3===r.reason_type}),$scope.cancel_reasons},setMoveReasons=function(){return $scope.move_reasons=_.filter($scope.company_reasons,function(r){return 5===r.reason_type}),$scope.move_reasons},setMoveReasonsToBB=function(){if($scope.move_reasons)return $scope.bb.move_reasons=$scope.move_reasons},setCancelReasonsToBB=function(){if($scope.cancel_reasons)return $scope.bb.cancel_reasons=$scope.cancel_reasons}}]),ModalDelete=function($scope,$rootScope,$modalInstance,booking,AlertService,cancel_reasons){return $scope.controller="ModalDelete",$scope.booking=booking,$scope.cancel_reasons=cancel_reasons,$scope.confirmDelete=function(){return AlertService.clear(),$modalInstance.close(booking)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},ModalDeleteAll=function($scope,$rootScope,$modalInstance,purchase){return $scope.controller="ModalDeleteAll",$scope.purchase=purchase,$scope.confirmDelete=function(){return $modalInstance.close(purchase)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}}}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Purchase.BookingModel",["$q","$window","BBModel","BaseModel","$bbug",function($q,$window,BBModel,BaseModel,$bbug){var Purchase_Booking;return Purchase_Booking=function(superClass){function Purchase_Booking(data){this.getSurveyAnswersPromise=bind(this.getSurveyAnswersPromise,this),this.getAnswersPromise=bind(this.getAnswersPromise,this),Purchase_Booking.__super__.constructor.call(this,data),this.ready=!1,this.datetime=moment.parseZone(this.datetime),this.time_zone&&this.datetime.tz(this.time_zone),this.original_datetime=moment(this.datetime),this.end_datetime=moment.parseZone(this.end_datetime),this.time_zone&&this.end_datetime.tz(this.time_zone),this.min_cancellation_time=moment(this.min_cancellation_time),this.min_cancellation_hours=this.datetime.diff(this.min_cancellation_time,"hours")}return extend(Purchase_Booking,superClass),Purchase_Booking.prototype.getGroup=function(){return this.group?this.group:this._data.$has("event_groups")?this._data.$get("event_groups").then(function(_this){return function(group){return _this.group=group,_this.group}}(this)):void 0},Purchase_Booking.prototype.getColour=function(){return this.getGroup()?this.getGroup().colour:"#FFFFFF"},Purchase_Booking.prototype.getCompany=function(){return this.company?this.company:this.$has("company")?this._data.$get("company").then(function(_this){return function(company){return _this.company=new BBModel.Company(company),_this.company}}(this)):void 0},Purchase_Booking.prototype.getAnswersPromise=function(){var defer;return defer=$q.defer(),null!=this.answers?defer.resolve(this.answers):(this.answers=[],this._data.$has("answers")?this._data.$get("answers").then(function(_this){return function(answers){var a;return _this.answers=function(){var i,len,results;for(results=[],i=0,len=answers.length;i<len;i++)a=answers[i],results.push(new BBModel.Answer(a));return results}(),defer.resolve(_this.answers)}}(this)):defer.resolve([])),defer.promise},Purchase_Booking.prototype.getSurveyAnswersPromise=function(){var defer;return defer=$q.defer(),this.survey_answers&&defer.resolve(this.survey_answers),this._data.$has("survey_answers")?this._data.$get("survey_answers").then(function(_this){return function(survey_answers){var a;return _this.survey_answers=function(){var i,len,results;for(results=[],i=0,len=survey_answers.length;i<len;i++)a=survey_answers[i],results.push(new BBModel.Answer(a));return results}(),defer.resolve(_this.survey_answers)}}(this)):defer.resolve([]),defer.promise},Purchase_Booking.prototype.answer=function(q){var a,i,len,ref;if(null!=this.answers)for(ref=this.answers,i=0,len=ref.length;i<len;i++){if(a=ref[i],a.name&&a.name===q)return a.answer;if(a.question_text&&a.question_text===q)return a.value}else this.getAnswersPromise();return null},Purchase_Booking.prototype.getPostData=function(){var data,formatted_survey_answers,i,len,q,ref;if(data={},data.attended=this.attended,data.client_id=this.client_id,data.company_id=this.company_id,data.time=60*this.datetime.hour()+this.datetime.minute(),data.date=this.datetime.toISODate(),data.deleted=this.deleted,data.describe=this.describe,data.duration=this.duration,data.end_datetime=this.end_datetime,this.time&&this.time.event_id&&!this.isEvent()?data.event_id=this.time.event_id:this.event?data.event_id=this.event.id:data.event_id=this.slot_id,data.full_describe=this.full_describe,data.id=this.id,data.min_cancellation_time=this.min_cancellation_time,data.on_waitlist=this.on_waitlist,data.paid=this.paid,data.person_name=this.person_name,data.price=this.price,data.purchase_id=this.purchase_id,data.purchase_ref=this.purchase_ref,data.quantity=this.quantity,data.self=this.self,this.move_item_id&&(data.move_item_id=this.move_item_id),this.srcBooking&&(data.move_item_id=this.srcBooking.id),this.person&&(data.person_id=this.person.id),this.service&&(data.service_id=this.service.id),this.resource&&(data.resource_id=this.resource.id),this.item_details&&(data.questions=this.item_details.getPostData()),this.move_reason&&(data.move_reason=this.move_reason),data.service_name=this.service_name,data.settings=this.settings,this.status&&(data.status=this.status),null!=this.email&&(data.email=this.email),null!=this.email_admin&&(data.email_admin=this.email_admin),this.first_name&&(data.first_name=this.first_name),this.last_name&&(data.last_name=this.last_name),formatted_survey_answers=[],this.survey_questions){for(data.survey_questions=this.survey_questions,ref=this.survey_questions,i=0,len=ref.length;i<len;i++)q=ref[i],formatted_survey_answers.push({value:q.answer,outcome:q.outcome,detail_type_id:q.id,price:q.price});data.survey_answers=formatted_survey_answers}return data},Purchase_Booking.prototype.checkReady=function(){if(this.datetime&&this.id&&this.purchase_ref)return this.ready=!0},Purchase_Booking.prototype.printed_price=function(){return parseFloat(this.price)%1===0?""+parseInt(this.price):$window.sprintf("%.2f",parseFloat(this.price))},Purchase_Booking.prototype.getDateString=function(){return this.datetime.toISODate()},Purchase_Booking.prototype.getTimeInMins=function(){return 60*this.datetime.hour()+this.datetime.minute()},Purchase_Booking.prototype.getAttachments=function(){return this.attachments?this.attachments:this.$has("attachments")?this._data.$get("attachments").then(function(_this){return function(atts){return _this.attachments=atts.attachments,_this.attachments}}(this)):void 0},Purchase_Booking.prototype.canCancel=function(){return moment(this.min_cancellation_time).isAfter(moment())},Purchase_Booking.prototype.canMove=function(){return this.canCancel()},Purchase_Booking.prototype.getAttendeeName=function(){return this.first_name+" "+this.last_name},Purchase_Booking.prototype.isEvent=function(){return null!=this.event_chain},Purchase_Booking}(BaseModel)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Purchase.CourseBookingModel",["$q","BBModel","BaseModel",function($q,BBModel,BaseModel){var Purchase_Course_Booking;return Purchase_Course_Booking=function(superClass){function Purchase_Course_Booking(data){this.getBookings=bind(this.getBookings,this),Purchase_Course_Booking.__super__.constructor.call(this,data)}return extend(Purchase_Course_Booking,superClass),Purchase_Course_Booking.prototype.getBookings=function(){var defer;return defer=$q.defer(),this.bookings&&defer.resolve(this.bookings),this._data.$has("bookings")?this._data.$get("bookings").then(function(_this){return function(bookings){var b;return _this.bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;i<len;i++)b=bookings[i],results.push(new BBModel.Purchase.Booking(b));return results}(),_this.bookings.sort(function(a,b){return a.datetime.unix()-b.datetime.unix()}),defer.resolve(_this.bookings)}}(this)):(this.bookings=[],defer.resolve(this.bookings)),defer.promise},Purchase_Course_Booking}(BaseModel)}])}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("BB.Models").factory("Purchase.TotalModel",["$q","$window","BBModel","BaseModel","$sce",function($q,$window,BBModel,BaseModel,$sce){var Purchase_Total;return Purchase_Total=function(superClass){function Purchase_Total(data){this.getConfirmMessages=bind(this.getConfirmMessages,this),this.getMember=bind(this.getMember,this),this.getClient=bind(this.getClient,this),this.getMessages=bind(this.getMessages,this),this.getDeals=bind(this.getDeals,this),this.getProducts=bind(this.getProducts,this),this.getPackages=bind(this.getPackages,this),this.getCourseBookingsPromise=bind(this.getCourseBookingsPromise,this),this.getBookingsPromise=bind(this.getBookingsPromise,this),this.getItems=bind(this.getItems,this),Purchase_Total.__super__.constructor.call(this,data),this.getItems().then(function(_this){return function(items){return _this.items=items}}(this)),this.getClient().then(function(_this){return function(client){return _this.client=client}}(this)),this.getMember().then(function(_this){return function(member){return _this.member=member}}(this))}return extend(Purchase_Total,superClass),Purchase_Total.prototype.id=function(){return this.get("id")},Purchase_Total.prototype.icalLink=function(){return this._data.$href("ical")},Purchase_Total.prototype.webcalLink=function(){return this._data.$href("ical")},Purchase_Total.prototype.gcalLink=function(){return this._data.$href("gcal")},Purchase_Total.prototype.getItems=function(){var defer;return defer=$q.defer(),this.items&&defer.resolve(this.items),$q.all([this.getBookingsPromise(),this.getCourseBookingsPromise(),this.getPackages(),this.getProducts(),this.getDeals()]).then(function(result){var items;return items=_.flatten(result),defer.resolve(items)}),defer.promise},Purchase_Total.prototype.getBookingsPromise=function(){var defer;return defer=$q.defer(),this.bookings&&defer.resolve(this.bookings),this._data.$has("bookings")?this._data.$get("bookings").then(function(_this){return function(bookings){var b;return _this.bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;i<len;i++)b=bookings[i],results.push(new BBModel.Purchase.Booking(b));return results}(),_this.bookings.sort(function(a,b){return a.datetime.unix()-b.datetime.unix()}),defer.resolve(_this.bookings)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getCourseBookingsPromise=function(){var defer;return defer=$q.defer(),this.course_bookings&&defer.resolve(this.course_bookings),this._data.$has("course_bookings")?this._data.$get("course_bookings").then(function(_this){return function(bookings){var b;return _this.course_bookings=function(){var i,len,results;for(results=[],i=0,len=bookings.length;i<len;i++)b=bookings[i],results.push(new BBModel.Purchase.CourseBooking(b));return results}(),$q.all(_.map(_this.course_bookings,function(b){return b.getBookings()})).then(function(){return defer.resolve(_this.course_bookings)})}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getPackages=function(){var defer;return defer=$q.defer(),this.packages&&defer.resolve(this.packages),this._data.$has("packages")?this._data.$get("packages").then(function(_this){return function(packages){return _this.packages=packages,defer.resolve(_this.packages)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getProducts=function(){var defer;return defer=$q.defer(),this.products&&defer.resolve(this.products),this._data.$has("products")?this._data.$get("products").then(function(_this){return function(products){return _this.products=products,defer.resolve(_this.products)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getDeals=function(){var defer;return defer=$q.defer(),this.deals&&defer.resolve(this.deals),this._data.$has("deals")?this._data.$get("deals").then(function(_this){return function(deals){return _this.deals=deals,defer.resolve(_this.deals)}}(this)):defer.resolve([]),defer.promise},Purchase_Total.prototype.getMessages=function(booking_texts,msg_type){var bt,defer;return defer=$q.defer(),booking_texts=function(){var i,len,results;for(results=[],i=0,len=booking_texts.length;i<len;i++)bt=booking_texts[i],bt.message_type===msg_type&&results.push(bt);return results}(),0===booking_texts.length?defer.resolve([]):this.getItems().then(function(items){var booking_text,i,item,j,k,len,len1,len2,msgs,ref,type;for(msgs=[],i=0,len=booking_texts.length;i<len;i++)for(booking_text=booking_texts[i],j=0,len1=items.length;j<len1;j++)for(item=items[j],ref=["company","person","resource","service"],k=0,len2=ref.length;k<len2;k++)type=ref[k],item.$has(type)&&item.$href(type)===booking_text.$href("item")&&msgs.indexOf(booking_text.message)===-1&&msgs.push(booking_text.message);return defer.resolve(msgs)}),defer.promise},Purchase_Total.prototype.getClient=function(){var defer;return defer=$q.defer(),this._data.$has("client")?this._data.$get("client").then(function(_this){return function(client){return _this.client=new BBModel.Client(client),defer.resolve(_this.client)}}(this)):defer.reject("No client"),defer.promise},Purchase_Total.prototype.getMember=function(){var defer;return defer=$q.defer(),this._data.$has("member")?this._data.$get("member").then(function(_this){return function(member){return _this.member=new BBModel.Member.Member(member),defer.resolve(_this.member)}}(this)):defer.reject("No member"),defer.promise},Purchase_Total.prototype.getConfirmMessages=function(){var defer;return defer=$q.defer(),this._data.$has("confirm_messages")?this._data.$get("confirm_messages").then(function(_this){return function(msgs){return _this.getMessages(msgs,"Confirm").then(function(filtered_msgs){return defer.resolve(filtered_msgs)})}}(this)):defer.reject("no messages"),defer.promise},Purchase_Total.prototype.printed_total_price=function(){return parseFloat(this.total_price)%1===0?""+parseInt(this.total_price):$window.sprintf("%.2f",parseFloat(this.total_price))},Purchase_Total.prototype.newPaymentUrl=function(){if(this._data.$has("new_payment"))return $sce.trustAsResourceUrl(this._data.$href("new_payment"))},Purchase_Total.prototype.totalDuration=function(){var duration,i,item,len,ref;for(duration=0,ref=this.items,i=0,len=ref.length;i<len;i++)item=ref[i],item.duration&&(duration+=item.duration);return duration},Purchase_Total.prototype.containsWaitlistItems=function(){var i,item,len,ref,waitlist;for(waitlist=[],ref=this.items,i=0,len=ref.length;i<len;i++)item=ref[i],item.on_waitlist===!0&&waitlist.push(item);return waitlist.length>0},Purchase_Total}(BaseModel)}])}.call(this),function(){"use strict";angular.module("BB.Services").factory("PurchaseBookingService",["$q","halClient","BBModel",function($q,halClient,BBModel){return{update:function(booking){var data,deferred;return deferred=$q.defer(),data=booking.getPostData(),booking.srcBooking.$put("self",{},data).then(function(_this){return function(booking){return deferred.resolve(new BBModel.Purchase.Booking(booking))}}(this),function(_this){return function(err){return deferred.reject(err,new BBModel.Purchase.Booking(booking));
}}(this)),deferred.promise},addSurveyAnswersToBooking:function(booking){var data,deferred;return deferred=$q.defer(),data=booking.getPostData(),data.notify=!1,data.notify_admin=!1,booking.$put("self",{},data).then(function(_this){return function(booking){return deferred.resolve(new BBModel.Purchase.Booking(booking))}}(this),function(_this){return function(err){return deferred.reject(err,new BBModel.Purchase.Booking(booking))}}(this)),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("PurchaseService",["$q","halClient","BBModel","$window","UriTemplate",function($q,halClient,BBModel,$window,UriTemplate){return{query:function(params){var defer,uri;return defer=$q.defer(),uri=params.url_root+"/api/v1/purchases/"+params.purchase_id,halClient.$get(uri,params).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise},bookingRefQuery:function(params){var defer,uri;return defer=$q.defer(),uri=new UriTemplate(params.url_root+"/api/v1/purchases/booking_ref/{booking_ref}{?raw}").fillFromObject(params),halClient.$get(uri,params).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise},update:function(params){var bdata,booking,data,defer,i,j,len,len1,ref,ref1;if(defer=$q.defer(),!params.purchase)return defer.reject("No purchase present"),defer.promise;if(data={},params.bookings){for(bdata=[],ref=params.bookings,i=0,len=ref.length;i<len;i++)booking=ref[i],bdata.push(booking.getPostData());data.bookings=bdata}if(params.move_reason)for(ref1=data.bookings,j=0,len1=ref1.length;j<len1;j++)booking=ref1[j],booking.move_reason=params.move_reason;return params.purchase.$put("self",{},data).then(function(_this){return function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)}}(this),function(_this){return function(err){return defer.reject(err)}}(this)),defer.promise},bookWaitlistItem:function(params){var data,defer,uri;return defer=$q.defer(),params.purchase||params.purchase_id||defer.reject("No purchase or purchase_id present"),data={},data.booking_id=params.booking.id,params.purchase?params.purchase.$put("book_waitlist_item",{},data).then(function(_this){return function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)}}(this),function(err){return defer.reject(err)}):params.purchase_id&&params.url_root&&(uri=params.url_root+"/api/v1/purchases/"+params.purchase_id+"/book_waitlist_item",halClient.$put(uri,{},data).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)})),defer.promise},deleteAll:function(purchase){var defer;return defer=$q.defer(),purchase?(purchase.$del("self").then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(_this){return function(err){return defer.reject(err)}}(this)),defer.promise):(defer.reject("No purchase present"),defer.promise)},deleteItem:function(params){var defer,uri;return defer=$q.defer(),uri=params.api_url+"/api/v1/purchases/"+params.long_id+"/purchase_item/"+params.purchase_item_id,halClient.$del(uri,{}).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise}}}])}.call(this),angular.module("BB").run(["$templateCache",function($templateCache){$templateCache.put("accordion-group.html",'<div class="panel panel-default">\r\n  <div class="panel-heading" ng-click="toggleOpen()">\r\n    <h4 class="panel-title">\r\n      <span class="accordion-toggle" bb-accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></span>\r\n    </h4>\r\n  </div>\r\n  <div class="panel-collapse" collapse="!isOpen">\r\n    <div class="panel-body" ng-transclude></div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("bb_date_time_picker.html",'<div class="row bb-date-picker">\r\n  <div class="col-sm-7">\r\n    <div class="input-group">\r\n      <input type="text" ng-model="datetimeWithNoTz" class="form-control"\r\n        datepicker-popup="{{format}}"\r\n        is-open="opened"\r\n        min-date="minDateClean"\r\n        max-date="maxDateClean"\r\n        datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n        show-weeks="false"\r\n        show-button-bar="false"\r\n        ng-disabled="bbDisabled"\r\n      />\r\n      <span class="input-group-btn" ng-click="$event.preventDefault(); $event.stopPropagation(); opened=!opened;">\r\n        <button class="btn btn-default" title="Select date"><span class="fa fa-calendar"></span></button>\r\n      </span>\r\n    </div>\r\n  </div>\r\n  <div class="col-sm-5">\r\n    <div timepicker ng-model="datetimeWithNoTz" show-meridian="showMeridian"\r\n      minute-step="minuteStep" readonly-input="bbDisabled"></div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("bootstrap_ui_datetime_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError(), \'has-success\': !hasError()}">\r\n\t<label class="control-label">{{form.title}}</label>\r\n  <input ng-if="form.readonly" ng-show="form.key" type="text" placeholder="" class="form-control" id="datetime" ng-model="model.datetime" ng-disabled="form.readonly" name="datetime" disabled="disabled"/>\r\n\r\n  <div class="input-group" ng-if="!form.readonly">\r\n   \t<div bb-date-time-picker  date="$$value$$"  bb-disabled="form.readonly" ></div>\r\n\t</div>\r\n\r\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\r\n</div>\r\n'),$templateCache.put("bootstrap_ui_time_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError()}">\r\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n\r\n  <div timepicker ng-model="$$value$$" show-meridian="false"></div>\r\n\r\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\r\n</div>\r\n'),$templateCache.put("date_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError()}">\r\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n\r\n  <p class="input-group" ng-init="datepicker = {isOpen: true}">\r\n    <input datepicker-popup="dd-MMMM-yyyy" ng-model="$$value$$"\r\n    class="form-control" is-open="datepicker.isOpen"\r\n    ng-disabled="form.readonly"></input>\r\n    <span class="input-group-btn">\r\n      <button type="button" class="btn btn-default" bb-debounce\r\n        ng-click="$event.preventDefault(); $event.stopPropagation();\r\n        datepicker.isOpen = !datepicker.isOpen" ng-disabled="form.readonly">\r\n        <i class="glyphicon glyphicon-calendar"></i>\r\n      </button>\r\n    </span>\r\n  </p>\r\n\r\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\r\n</div>\r\n'),$templateCache.put("dialog.html",'<div class="modal-header">\r\n  <h3 class="modal-title">{{title}}</h3>\r\n</div>\r\n<div class="modal-body">{{body}}</div>\r\n<div class="modal-footer">\r\n  <button class="btn btn-primary" ng-click="ok()">Yes</button>\r\n  <button class="btn btn-default" ng-click="cancel()">No</button>\r\n</div>\r\n'),$templateCache.put("file_upload.html",'<!-- label -->\r\n<label for="file_upload" class="control-label col-sm-4">\r\n    File upload:\r\n    <p ng-show="maxSize">should be smaller then {{maxSize}}</p>\r\n</label>\r\n\r\n<div class="col-sm-5">\r\n\r\n  <!-- upload button -->\r\n  <button\r\n    type="file"\r\n    class="btn btn-secondary"\r\n    ngf-max-size="{{maxSize}}"\r\n    ngf-accept="{{accept}}"\r\n    ngf-model-invalid="errorFile"\r\n    ngf-select="uploadFile(item, $file, $invalidFiles, item.attachment_id)">\r\n      Select File\r\n  </button>\r\n\r\n  <!-- progress -->\r\n  <div class="progress"\r\n    ng-show="my_file.progress >= 0 && my_file.progress < 100">\r\n    <div\r\n      class="progress-bar"\r\n      role="progressbar"\r\n      aria-valuenow="{{my_file.progress}}"\r\n      aria-valuemin="0"\r\n      aria-valuemax="100"\r\n      style="width:{{my_file.progress}}%">\r\n    </div>\r\n  </div>\r\n\r\n  <!-- attachment -->\r\n  <div ng-if="item.attachment_id">\r\n    Currently uploaded file:\r\n    <a ng-href="{{item.getAttachment().url}}">\r\n      {{my_file.name}}\r\n    </a>\r\n    <span class="btn btn-link" ng-click="item.deleteAttachment() && clearFileInput()">\r\n      <i class="fa fa-times"></i>\r\n      <span class="sr-only">Delete</span>\r\n    </span>\r\n  </div>\r\n\r\n</div>\r\n\r\n<!-- messages -->\r\n<div class="col-sm-3 messages">\r\n  <p class="text-danger" ng-show="show_error">\r\n    Upload failed\r\n  </p>\r\n  <p class="text-danger" ng-show="err_file">\r\n    The file should be no bigger than {{err_file.$errorParam}}\r\n  </p>\r\n  <p class="text-danger" ng-show="file_type_error">\r\n    The file must be one the following file types: <b>{{prettyAccept}}</b>\r\n  </p>\r\n</div>\r\n\r\n'),$templateCache.put("modal_form.html",'<div class="modal-header">\r\n  <h3 class="modal-title">{{title}}</h3>\r\n</div>\r\n<form name="modal_form" ng-submit="submit(modal_form)">\r\n  <div ng-show="loading" class="loader"></div>\r\n  <div class="modal-body" sf-schema="schema" sf-form="form"\r\n    sf-model="form_model" sf-options="{formDefaults: {feedback: false}}"\r\n    ng-hide="loading">\r\n  </div>\r\n  <div class="modal-footer">\r\n    <input type="submit" class="btn btn-primary" ng-disabled="loading" value="OK">\r\n    <button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\r\n  </div>\r\n</form>\r\n'),$templateCache.put("price_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError()}">\r\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n\r\n  <div pricepicker ng-model="$$value$$" currency="{{form.currency}}"></div>\r\n\r\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\r\n</div>\r\n'),$templateCache.put("radio-buttons.html",'<div class="form-group schema-form-radiobuttons {{form.htmlClass}}"\r\n     ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\r\n  <div>\r\n    <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n  </div>\r\n  <div class="btn-group">\r\n    <label class="btn {{ (item.value === $$value$$) ? form.style.selected || \'btn-default\' : form.style.unselected || \'btn-default\'; }}"\r\n           ng-class="{ active: item.value === $$value$$ }"\r\n           ng-repeat="item in form.titleMap">\r\n      <input type="radio"\r\n             class="{{form.fieldHtmlClass}}"\r\n             sf-changed="form"\r\n             style="display: none;"\r\n             ng-disabled="form.readonly"\r\n             ng-model="$$value$$"\r\n             ng-model-options="form.ngModelOptions"\r\n             ng-value="item.value"\r\n             name="{{form.key.join(\'.\')}}">\r\n      <span ng-bind-html="item.name"></span>\r\n    </label>\r\n  </div>\r\n  <div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div>\r\n</div>\r\n'),$templateCache.put("radios-inline.html",'<div class="form-group schema-form-radios-inline {{form.htmlClass}}"\r\n     ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\r\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n  <div>\r\n      <label class="radio-inline" ng-repeat="item in form.titleMap" >\r\n      <input type="radio"\r\n             class="{{form.fieldHtmlClass}}"\r\n             sf-changed="form"\r\n             ng-disabled="form.readonly"\r\n             ng-model="$$value$$"\r\n             ng-value="item.value"\r\n             name="{{form.key.join(\'.\')}}">\r\n      <span ng-bind-html="item.name"></span>\r\n    </label>\r\n  </div>\r\n  <div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div>\r\n</div>\r\n'),$templateCache.put("radios.html",'<div class="form-group schema-form-radios {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}">\r\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\r\n  <div class="radio" ng-repeat="item in form.titleMap" >\r\n    <label>\r\n      <input type="radio"\r\n             class="{{form.fieldHtmlClass}}" \r\n             sf-changed="form"\r\n             ng-disabled="form.readonly"\r\n             ng-model="$$value$$"\r\n             ng-model-options="form.ngModelOptions"\r\n             ng-value="item.value"\r\n             name="{{form.key.join(\'.\')}}">\r\n      <span ng-bind-html="item.name"></span>\r\n    </label>\r\n  </div>\r\n  <div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div>\r\n</div>\r\n')}]),angular.module("BB").run(["$templateCache",function($templateCache){$templateCache.put("basket.html",'<div bb-basket-list class="bb-basket">\r\n\t<div class="row">\r\n\r\n\r\n\t\t<div class="col-sm-12">\r\n\t\t\t<div class="bb-subcontent">\r\n\r\n\t\t\t\t<h2 class="bb-section-title">Your basket</h2>\r\n\t\t\t\t<div class="bb-empty-basket-full-screen" ng-hide="bb.basket.items">\r\n\t\t\t\t\t<h3>There are no items in the basket</h3>\r\n\t\t\t\t\t<p>Please press the add another item button if you wish to add a product or service.</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<table class="table table-bordered" ng-show="bb.basket.items">\r\n\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<th>Item</th>\r\n\t\t\t\t\t\t\t<th>Price</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</thead>\r\n\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t<tr ng-repeat="item in bb.basket.basketItems()" ng-class="{\'last-item\': $last}">\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t{{item.describe()}}\r\n\t\t\t\t\t\t\t\t\t<br/>\r\n                  <small>{{item.time.time_12}} {{item.date.date | datetime: "dddd Do MMMM"}}</small>\r\n\t\t\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t\t\t<small>{{item.resource.getAddress() | address_single_line }}</small>\r\n\t\t\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t\t\t<small ng-if="item.recipient"> Recipient: {{ item.recipient }} </small>\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td class="text-right">\r\n\t\t\t\t\t\t\t\t{{ item.total_price | currency }}\r\n\t\t\t\t\t\t\t\t<div ng-if="item.certificate_paid > 0">\r\n\t\t\t\t\t\t\t\t\t<small>Certificate Paid: {{ item.certificate_paid | currency }}</small>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td class="text-center">\r\n\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-trash" aria-hidden="true" ng-click="deleteBasketItem(item)"></span>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t<tr ng-if="basket.hasDeal()">\r\n\t\t\t\t\t\t\t<th class="text-left">Gift Certificates</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t<tr ng-if="basket.hasDeal()" ng-repeat="deal_code in basket.getDealCodes()" ng-class="{\'last-item\': $last}">\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t{{deal_code.description}}\r\n\t\t\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t<p></p>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td class="text-right">\r\n\t\t\t\t\t\t\t\t{{ deal_code.value | currency }}\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td class="text-center">\r\n\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-trash" aria-hidden="true" ng-click="removeDeal(deal_code)"></span>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t<tr data-ng-if="basket.hasDeal() || basket.hasCoupon()">\r\n\t\t\t\t\t\t\t<th class="text-right">Original Price</th>\r\n\t\t\t\t\t\t\t<th class="text-right">{{basket.fullPrice() | currency }}</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t<tr data-ng-if="basket.questionPrice()">\r\n\t\t\t\t\t\t\t<th class="text-right">Booking Fee</th>\r\n\t\t\t\t\t\t\t<th class="text-right">{{basket.questionPrice() | currency}}</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\r\n\r\n\t\t\t\t\t\t<tr data-ng-if="basket.hasDeal()">\r\n\t\t\t\t\t\t\t<th class="text-right">Total Gift Certificates</th>\r\n\t\t\t\t\t\t\t<th class="text-right">{{basket.totalDeals() | currency }}</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t<tr data-ng-if="basket.hasDeal()">\r\n\t\t\t\t\t\t\t<th class="text-right">Remaining Value on Gift Certificates</th>\r\n\t\t\t\t\t\t\t<th class="text-right">{{ basket.totalCertificatePaid() | currency }}</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t<tr data-ng-if="basket.hasCoupon()">\r\n\t\t\t\t\t\t\t<th class="text-right">Coupon Discount</th>\r\n\t\t\t\t\t\t\t<th class="text-right">{{(bb.basket.fullPrice() - bb.basket.totalPrice()) | currency}}</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t\t\t<tr data-ng-if="basket.total_price > 0">\r\n\t\t\t\t\t\t\t<th class="text-right">Total</th>\r\n\t\t\t\t\t\t\t<th class="text-right">{{basket.total_price | currency }}</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t<tr data-ng-if="basket.total_due_price != basket.total_price">\r\n\t\t\t\t\t\t\t<th class="text-right">Total Due Now</th>\r\n\t\t\t\t\t\t\t<th class="text-right">{{basket.total_due_price | currency }}</th>\r\n\t\t\t\t\t\t\t<th>&nbsp;</th>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</tbody>\r\n\t\t\t\t</table>\r\n\t\t\t\t<div ng-if="show_wallet">\r\n\t\t\t\t\t<h4> Wallet </h4>\r\n\t\t\t\t\t<div ng-show="client.has_active_wallet">\r\n\t\t\t\t\t\t<p> Current Wallet Balance: {{client.wallet_amount | icurrency}} </p> <small style="color:#ff1919;"ng-if="client.wallet_amount < basket.total_due_price"> (-{{basket.total_due_price - client.wallet_amount | icurrency }})</small>\r\n\t\t\t\t\t\t<small ng-if="client.wallet_amount < basket.total_due_price"><i> Oh no! You do not currently have enough money in your wallet account. You can either pay the full amount, or top up to add more money to your wallet. </i></small>\r\n\t\t\t\t\t\t<small ng-if="client.wallet_amount >= basket.total_due_price"><i> You will have {{(client.wallet_amount - basket.total_price) | icurrency }} left in your wallet after this purchase. </i></small>\r\n\t\t\t\t\t  <button ng-if="client.wallet_amount < basket.total_due_price" type="button" class="btn btn-primary btn-xs" ng-click="topUpWallet()">Top Up</button>\r\n\t\t\t\t\t</div>\r\n      \t</div>\r\n\r\n\t\t\t\t<div ng-if="bb.company_settings.has_coupons" class="bb-coupon-box">\r\n\t\t\t\t\t<span>Apply a coupon </span>\r\n\t\t\t\t\t<input ng-model="coupon_code"/>\r\n\t\t\t\t\t<button type="button" class="btn btn-primary btn-xs" ng-click="applyCoupon(coupon_code)">Apply</button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class="bb-coupon-box" ng-if="bb.company_settings.has_vouchers">\r\n\t\t\t\t\t<form class="form-inline">\r\n\t\t\t\t\t\t<div ng-show="!show_voucher_box">\r\n\t\t\t\t\t\t\t<a ng-click="show_voucher_box = true">Have a gift certificate?</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div ng-show="show_voucher_box" class="form-group">\r\n\t\t\t\t\t\t\t<label ng-if="!basket.hasDeal()" for="deal">Apply a Gift Certificate:</label>\r\n\t\t\t\t\t\t\t<label ng-if="basket.hasDeal()" for="deal">Apply another Gift Certificate:</label>\r\n\t\t\t\t\t\t\t<div class=" input-group">\r\n\t\t\t\t\t\t\t\t<input type="text" class="form-control input-sm" id="deal_code" name="deal_code" ng-model="deal_code" placeholder="Enter a voucher code">\r\n\t\t\t\t\t\t\t\t<span class="input-group-btn">\r\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-primary btn-sm" ng-click="applyDeal(deal_code)">Apply</button>\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="col-sm-12">\r\n\t\t\t<div class="bb-step-navigation">\r\n\t\t\t\t<div class="row">\r\n\t\t\t\t\t<div class="col-sm-9 col-sm-push-3 text-right">\r\n\t\t\t\t\t\t<div ng-if="bb.company.$has(\'events\') && !bb.isAdmin">\r\n\t\t\t\t\t\t\t<button type="button" class="btn btn-primary" ng-click="addAnother(\'event_list\')">Add another event</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div ng-if="bb.company.$has(\'services\') && !bb.isAdmin">\r\n\t\t\t\t\t\t\t<button type="button" class="btn btn-primary" ng-click="addAnother(\'service_list\')">Add another service</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button type="button" class="btn btn-primary" ng-click="checkout(\'checkout\')">Checkout</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="col-sm-3 col-sm-pull-9">\r\n\t\t\t\t\t\t<button type="button" class="btn btn-default" ng-click="loadPreviousStep()" ng-show="bb.current_step > 1"><span>Back</span></button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t</div>\r\n</div>\r\n'),$templateCache.put("basket_summary.html",'<div bb-basket-summary>\r\n\t<h2>Summary</h2>\r\n\t<hr/>\r\n\t<p>Please review the following information</p>\r\n\r\n\t<div class="row">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<div accordion close-others="oneAtATime">\r\n\t\t    <div bb-accordion-group ng-repeat="item in basket_items" is-open="$first">\r\n\t\t    \t<div bb-accordion-heading>\r\n\t\t    \t\t{{item.getName()}} <small>({{item.time.time_moment | datetime: \'llll\'}})</small>\r\n\t\t    \t</div>\r\n\r\n\r\n\t      \t<ul class="bb-list bb-list-bordered-in">\r\n\t      \t\t<li>\r\n\t      \t\t\t<div class="row">\r\n\t\t      \t\t\t<div class="col-sm-4"><b>Duration:</b></div>\r\n\t\t      \t\t\t<div class="col-sm-8">{{item.duration | time_period}}</div>\r\n\t\t      \t\t</div>\r\n      \t\t\t</li>\r\n\t      \t\t<li>\r\n\t      \t\t\t<div class="row">\r\n\t\t      \t\t\t<div class="col-sm-4"><b>Fullname:</b></div>\r\n\t      \t\t\t\t<div class="col-sm-8">{{client.first_name + \' \' + client.last_name}}</div>\r\n\t      \t\t\t</div>\r\n      \t\t\t</li>\r\n\t      \t\t<li>\r\n\t      \t\t\t<div class="row" ng-if="client.email">\r\n\t\t      \t\t\t<div class="col-sm-4"><b>Email:</b></div>\r\n\t      \t\t\t\t<div class="col-sm-8">{{client.email}}</div>\r\n\t      \t\t\t</div>\r\n      \t\t\t</li>\r\n\t      \t\t<li ng-if="item.mobile">\r\n\t      \t\t\t<div class="row">\r\n\t\t      \t\t\t<div class="col-sm-4"><b>Mobile:</b> </div>\r\n\t      \t\t\t\t<div class="col-sm-8">{{item.mobile}}</div>\r\n\t      \t\t\t</div>\r\n      \t\t\t</li>\r\n      \t\t\t<li ng-if="bb.company_settings.ask_address && (client.address1 || client.address2 || client.address3 || client.address4 || client.postcode)">\r\n\t      \t\t\t<div class="row">\r\n\t\t      \t\t\t<div class="col-sm-4"><b>Address:</b> </div>\r\n\t      \t\t\t\t<div class="col-sm-8">{{client.address1}} {{client.address2}} {{client.address3}} {{client.address4}} {{client.postcode}}</div>\r\n\t      \t\t\t</div>\r\n      \t\t\t</li>\r\n      \t\t\t<li ng-repeat="question in item.item_details.questions" ng-if="item.has_questions && question.answer && !question.important">\r\n              <div class="row" ng-if="item.price">\r\n\t\t      \t\t\t<div class="col-sm-4"><b>{{question.name}}:</b> </div>\r\n\t      \t\t\t\t<div class="col-sm-8">{{question.answer | format_answer}}</div>\r\n\t      \t\t\t</div>\r\n            </li>\r\n            <li ng-if="item.price">\r\n\t      \t\t\t<div class="row">\r\n\t\t      \t\t\t<div class="col-sm-4"><b>Price:</b> </div>\r\n\t      \t\t\t\t<div class="col-sm-8">{{item.price | currency}}</div>\r\n\t      \t\t\t</div>\r\n      \t\t\t</li>\r\n\t      \t</ul>\r\n\t\t    </div>\r\n\t\t  </div>\r\n\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<hr/>\r\n\r\n\t<div class="row">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<button class="btn btn-primary pull-right" ng-click="confirm()">Confirm</button>\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n\t</div>\r\n</div>\r\n'),$templateCache.put("basket_wallet.html",'<div bb-wallet-payment="{amount:((bb.basket.total_price - $root.member.wallet_amount) / 100),basket:bb.basket}">\r\n  <div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\r\n  <div ng-hide="loading">\r\n  <div class="bb-head">\r\n    <h3>Make Payment</h3>\r\n  </div>\r\n    <div class="bb-content">\r\n      <div ng-if="error_message" class="alerts">\r\n        <p class="error_message" ng-bind-html="error_message"></p>\r\n      </div>\r\n\r\n      <div ng-form class="form-inline">\r\n        <div ng-show="!showTopUpBox()">\r\n          <button type="button" class="bb-bookings-action" ng-click="(show_topup_box = true);(error_message = false)">Top Up</button>\r\n        </div>\r\n        <div ng-show="showTopUpBox()" class="form-group">\r\n          <label for="amount">Amount:</label>\r\n          <div class=" input-group">\r\n            <input type="number" class="form-control input-sm" id="amount" name="amount" ng-model="amount" placeholder="Enter Top Up Amount">\r\n            <span class="input-group-btn">\r\n              <button type="submit" class="btn btn-primary btn-sm" ng-disabled="!amount && ((amount * 100) < wallet.min_amount)" ng-click="updateWallet(member, amount)">Top Up Wallet</button>\r\n            </span>\r\n          </div>\r\n          <br>\r\n          <small> Minimum top up amount must be greater than {{wallet.min_amount | icurrency }} </small>\r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div class="bb-payment">\r\n        <div id="bb-payment">\r\n          <iframe id="bb-widget" ng-src="{{wallet_payment_url}}" width="100%"scrolling="no" frameborder="0"></iframe>\r\n        </div>\r\n        <script type="text/javascript">\r\n          iFrameResize([{log:true, checkOrigin:false}],[\'#bb-widget\']);\r\n       </script> \r\n      </div>\r\n\r\n    </div>\r\n    <div class="bb-step-navigation">\r\n      <div class="row">\r\n        <div class="col-sm-6 text-left">\r\n          <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()">Back</button>\r\n        </div>\r\n      </div>\r\n    </div> \r\n\r\n  </div>\r\n</div>'),$templateCache.put("book_waitlist.html",' <div class="confirmation-header">\r\n  <h2 class="confirmation-heading">Your Waitlist bookings</h2>\r\n</div>\r\n\r\n<div ng-show="waitlist_bookings">\r\n<ul class="confirmation-summary" ng-repeat="i in waitlist_bookings">\r\n  <li ng-if="i.id" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Booking Reference:</div>\r\n    <div class="col-sm-9">{{i.id}}</div>\r\n  </li>\r\n  <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Service:</div>\r\n    <div class="col-sm-9">{{i.full_describe}}</div>\r\n  </li>\r\n  <li ng-if="i.describe" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Date/Time:</div>\r\n    <div class="col-sm-9">{{i.describe}}</div>\r\n  </li>\r\n  <li ng-if="i.price" class="row confirmation-summary-item">\r\n    <div class="col-sm-3">Price:</div>\r\n    <div class="col-sm-9">{{i.price | currency }}</div>\r\n  </li>\r\n  <li class="row confirmation-summary-item">\r\n  <div class="col-sm-3 pull-right">\r\n    <button type="button" class="btn btn-primary btn-block" ng-click="bookWaitlistItem(i)">Book</button>\r\n  </div>\r\n  </li>\r\n</ul>\r\n<ul class="confirmation-summary">\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.total_price | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total Due Now</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.due_now | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n</ul>\r\n</div>\r\n\r\n<div ng-hide="waitlist_bookings">\r\n <ul class="confirmation-summary">\r\n   <p> Thanks {{purchase.client.first_name }}. You have successully booked onto {{purchase.bookings[0].service_name }}. </p>\r\n</ul>\r\n<ul class="confirmation-summary">\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.total_price | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n<li class="row confirmation-summary-item">\r\n  <div class="row">\r\n    <div class="col-sm-6 col-xs-6 total-label"><strong>Total Due Now</strong></div>\r\n    <div class="col-sm-3 col-xs-6"><strong>{{purchase.due_now | currency }}</strong></div>\r\n  </div>\r\n</li>\r\n</ul>\r\n\r\n</div>\r\n\r\n<div class="hidden-print">\r\n  <div class="bb-step-navigation">\r\n    <div ng-if="make_payment" class="col-sm-12 bb-checkout-pay-button-div">\r\n      <div payment-button \r\n        value="Pay" \r\n        class="btn btn-primary" \r\n        total="total" \r\n        bb="bb"\r\n        decide-next-page="decideNextPage">\r\n      </div>\r\n    </div>\r\n    <button type="button" class="btn btn-link" onclick="window.print()"><span class="glyphicon glyphicon-print"></span> Print</button>\r\n    <div bb-booking-export class="bb-booking-export"></div>\r\n    <div class="col-sm-12 pull-left">\r\n      <button type="button" class="btn btn-default" ng-click="$parent.is_waitlist = false"> Back </button>\r\n    </div>\r\n     </div>\r\n</div>'),$templateCache.put("calendar.html",'<div bb-page>\r\n\r\n  <div class="page-summary">\r\n    <div bb-include="_basket_item_summary">\r\n    </div>\r\n  </div>\r\n\r\n  <div bb-time-ranges="{selected_day: today}" class="bb-calendar" ng-show="days"></div>\r\n\r\n  <div class="bb-step-navigation">\r\n    <div class="row">\r\n      <div class="col-sm-offset-7 col-sm-3 col-sm-push-2 text-right">       \r\n        <button type="button" class="btn btn-primary btn-block" ng-click="checkReady() && routeReady()" bb-debounce ng-disabled="!bb.current_item.time">\r\n          <span ng-if="!bb.moving_booking">Continue</span>\r\n          <span ng-if="bb.moving_booking">Move booking</span>\r\n        </button>\r\n      </div>\r\n      <div class="col-sm-2 col-sm-pull-10 text-left">    \r\n        <button type="button" class="btn btn-default btn-block" bb-debounce ng-click="loadPreviousStep()" ng-if="!bb.moving_booking">Back</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  \r\n</div>\r\n'),$templateCache.put("checkout.html",'<div bb-checkout>\r\n  <div ng-if="total.$has(\'new_payment\')">\r\n    <h1>Payment</h1>\r\n    <div bb-include="_basket_item_summary"></div>\r\n    <h2 class="booking-form-header">Payment details</h2>\r\n    <div class="bb-checkout-pay-button">\r\n      <div bb-payment-button\r\n        class="btn btn-primary"\r\n        total="total"\r\n        bb="bb"\r\n        decide-next-page="decideNextPage"\r\n        value="Pay">\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("checkout_event.html",'<div bb-checkout class="event" ng-show="total">\r\n\r\n  <div class="event-header" ng-style="{\'background-image\': bb.event_details.image.url ? \'url(&quot;\' + bb.event_details.image.url + \'&quot;)\' : \'none\', \'background-size\' : \'cover\', \'background-position\' : \'center\'}">\r\n    <div class="event-details">\r\n      <h1 class="truncate-sm">{{bb.event_details.name}}</h1>\r\n      <ul class="row event-summary-list">\r\n        <li class="col-xs-6 col-sm-3 date truncate-xs">\r\n          <span class="bb-icon icon-calendar"></span>\r\n          <span class="hidden-xs">{{bb.event_details.datetime | datetime: \'dddd \'}}</span>\r\n          <span>{{bb.event_details.datetime | datetime: \'Do MMMM YYYY\'}}</span>\r\n        </li>\r\n        <li class="col-xs-6 col-sm-3 time truncate-xs">\r\n          <span class="glyphicon glyphicon-time" aria-hidden="true"></span>\r\n          <span class="event-time" ng-bind="bb.event_details.datetime | datetime: \'h[:]mma\'"></span>\r\n          &ndash;<span ng-bind="bb.event_details.end_datetime | datetime: \'h[:]mma\'"></span>\r\n        </li>\r\n        <li class="hidden-xs col-sm-3 duration truncate-xs">\r\n          <span class="glyphicon glyphicon-hourglass"></span>\r\n          <span ng-bind="bb.event_details.duration | time_period"></span>\r\n        </li>\r\n        <li class="hidden-xs col-sm-12 location" ng-show="bb.event_details.address">\r\n          <span class="bb-icon icon-location"></span>\r\n          <span ng-bind="bb.event_details.address.addressSingleLine()"></span>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="panel panel-default event-description">\r\n    <div class="panel-body">\r\n      <p>Please complete payment to confirm your booking.</p>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="panel panel-default event-tickets">\r\n    <div class="panel-body">\r\n      <h2 class="heading">Tickets</h2>\r\n      <div>\r\n        <ul class="ticket-list">\r\n          <li class="header">\r\n            <div class="row">\r\n              <div class="col-sm-6 col-xs-6">Type</div>\r\n              <div class="col-sm-3 col-xs-4">Price</div>\r\n              <div class="col-sm-3 col-xs-2">Qty</div>\r\n            </div>\r\n          </li>\r\n          <li ng-repeat="ticket in bb.event_details.tickets">\r\n            <div class="row">\r\n              <div class="col-sm-6 col-xs-6">\r\n                <span>{{ticket.fullName()}}</span>\r\n              </div>\r\n              <div class="col-sm-3 col-xs-4">\r\n                <span ng-if="ticket.price > 0">{{ticket.price | currency}}</span><span ng-if="ticket.price == 0">Free</span>\r\n                <small ng-if="ticket.counts_as"><i>(for {{ticket.counts_as}})</i></small>\r\n              </div>\r\n              <div class="col-sm-3 col-xs-2">\r\n                <span>{{ticket.qty}}</span>\r\n              </div>\r\n            </div>\r\n          </li>\r\n          <!-- <li>\r\n            <div class="row">\r\n              <div class="col-sm-6 col-xs-6 total-label">Gift Certificate</div>\r\n              <div class="col-sm-3 col-xs-6"><strong>{{total.total_price | currency}}</strong></div>\r\n            </div>\r\n          </li> -->\r\n          <li>\r\n            <div class="row">\r\n              <div class="col-sm-6 col-xs-6 total-label">Total</div>\r\n              <div class="col-sm-3 col-xs-6"><strong ng-show="total.due_now">{{total.due_now | currency}}</strong></div>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n\r\n        <div class="button-group">\r\n          <div class="row">\r\n            <div class="col-sm-offset-9 col-sm-3">\r\n               <div ng-if="total.$has(\'new_payment\')" class="bb-checkout-pay-button-div">\r\n                <div bb-payment-button \r\n                  class="btn btn-primary btn-block" \r\n                  total="total" \r\n                  bb="bb"\r\n                  decide-next-page="decideNextPage"\r\n                  value="Pay with WorldPay">\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div> \r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n'),
$templateCache.put("check_items.html",'<div bb-page>\r\n  <div bb-item-details>\r\n\r\n    <h1>Additional Information</h1>\r\n\r\n    <div bb-include="_basket_item_summary">\r\n    </div>\r\n\r\n    <div class="bb-subcontent">\r\n\r\n      <form name="booking_form" role="form" novalidate bb-form class="form-horizontal">\r\n\r\n<!--         <div ng-form name="client_form" class="bb-form" role="form" novalidate>\r\n\r\n          <h2 class="booking-form-header">Your details</h2>\r\n\r\n          <div class="form-group">\r\n            <div class="col-sm-offset-4 col-sm-5">\r\n               <p class="form-control-static">*Required fields</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.first_name.$invalid && (client_form.first_name.$dirty || booking_form.submitted)}">\r\n            <label for="first_name" class="control-label col-sm-4">First Name*:</label>\r\n            <div class="col-sm-5">\r\n              <input type="text" name="first_name" id"first_name" required ng-model="client.first_name" class="form-control"/>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="client_form.first_name.$invalid && booking_form.submitted">\r\n                Please enter your first name\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.last_name.$invalid && (client_form.last_name.$dirty|| booking_form.submitted)}">\r\n            <label for="last_name" class="control-label col-sm-4">Last Name*:</label>\r\n            <div class="col-sm-5">\r\n              <input type="text" name="last_name" id="last_name" required ng-model="client.last_name" class="form-control"/>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="client_form.last_name.$invalid && booking_form.submitted">\r\n                Please enter your last name\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.email.$invalid && (client_form.email.$dirty|| booking_form.submitted)}">\r\n            <label for="email" class="control-label col-sm-4">E-mail*:</label>\r\n            <div class="col-sm-5">\r\n              <input type="email" name="email" id="email" required ng-model="client.email" class="form-control"/>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="client_form.email.$invalid && booking_form.submitted">\r\n                Please enter a valid email address\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class="form-group" ng-class="{\'has-error\': client_form.mobile.$invalid && ((client_form.mobile.$dirty && !client_form.mobile.$focused) || booking_form.submitted)}">\r\n            <label for="mobile" class="control-label col-sm-4">Mobile:</label>\r\n            <div class="col-sm-5">\r\n              <input type="text" name="mobile" id="mobile" ng-pattern="validator.getUKMobilePattern(true)" ng-model="client.mobile" class="form-control" bb-focus/>\r\n            </div>\r\n          </div>\r\n\r\n          <div bb-client-details ng-show="client_details.hasQuestions">\r\n\r\n            <div class="form-group" ng-repeat="question in client_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{ \'check\': question.detail_type == \'check\', \'has-error\': client_form[\'q\' + question.id].$invalid && (client_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n              <label ng-hide="question.detail_type == \'check\'" for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-show="question.required">*</span></label>\r\n              <div ng-show="question.detail_type == \'check\'" class="col-sm-4 hidden-xs">&nbsp;</div>\r\n              <div class="col-sm-5">\r\n                <input bb-question="question"/>\r\n              </div>\r\n              <div class="col-sm-offset-4 messages">\r\n                <div class="error-message" ng-show="client_form[\'q\' + question.id].$invalid && ( client_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                  This field is required\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n\r\n        </div> --><!--client_form-->\r\n\r\n        <div ng-show="item_details.hasQuestions" ng-form name="booking_questions_form" class="bb-form" role="form" novalidate>\r\n\r\n          <h2 class="booking-form-header">Other information</h2>\r\n\r\n          <div class="form-group">\r\n            <div class="col-sm-offset-4 col-sm-5">\r\n               <p class="form-control-static">*Required fields</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div class="form-group" ng-repeat="question in item_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{\'has-error\': booking_questions_form[\'q\' + question.id].$invalid && (booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n            <label for="{{question.id}}" class="control-label col-sm-4" ng-hide="question.detail_type == \'check\'">{{question.name}}<span ng-show="question.required">*</span></label>\r\n            <div ng-show="question.detail_type == \'check\'" class="col-sm-4 hidden-xs">&nbsp;</div>\r\n            <div class="col-sm-5">\r\n              <input bb-question="question"/><span ng-show="question.detail_type == \'check\' && question.required">*</span>\r\n            </div>\r\n            <div class="col-sm-offset-4 messages">\r\n              <div class="error-message" ng-show="booking_questions_form[\'q\' + question.id].$invalid && ( booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                This field is required\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n        </div><!--booking_questions_form-->\r\n\r\n\r\n        <div class="bb-step-navigation">\r\n          <div class="row">\r\n            <div class="col-sm-9 col-sm-push-3 text-right">\r\n              <button type="submit" class="btn btn-primary" ng-click="confirm(booking_form) && validator.validateForm(booking_form) && checkReady() && routeReady()">Confirm</button>\r\n            </div>\r\n            <div class="col-sm-3 col-sm-pull-9">\r\n              <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </form><!--booking_form-->\r\n\r\n\r\n    </div>\r\n\r\n\r\n\r\n  </div>\r\n</div>\r\n'),$templateCache.put("check_move.html",'<div ng-if="!bb.current_item.move_done">\r\n  <div bb-item-details ng-init="confirm_move()">\r\n</div>\r\n'),$templateCache.put("client.html",'<div bb-client-details ng-init="checkStepTitle(\'Your Details\')">\r\n\r\n  <div bb-include="_basket_item_summary" ng-if="bb.service">\r\n  </div>\r\n\r\n  <form name="client_form" ng-submit="validator.validateForm(client_form)" class="form-horizontal" role="form" bb-form-resettable bb-form novalidate>\r\n\r\n    <div>\r\n      <h2 ng-if="!isAdmin()" class="booking-form-header"><span ng-if="!isAdmin()">Your details</span></h2>\r\n      <h2 ng-if="isAdmin()" class="booking-form-header"><span ng-if="isAdmin()">Client details</span></h2>\r\n    </div>\r\n\r\n    <div class="form-group">\r\n      <div class="col-sm-offset-4 col-sm-5">\r\n         <p class="form-control-static">*Required fields</p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="form-group" ng-class="{\'has-error\': client_form.first_name.$invalid && (!client_form.first_name.$pristine || client_form.submitted)}">\r\n      <label bb-question-label="question" for="first_name" class="control-label col-sm-4">First Name*:</label>\r\n      <div class="col-sm-5">\r\n        <input type="text" name="first_name" id="first_name" required ng-model="client.first_name" class="form-control" autofocus bb-resettable ng-pattern="validator.alpha" />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="client_form.first_name.$invalid && client_form.submitted">\r\n          Please enter your first name\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="form-group" ng-class="{\'has-error\': client_form.last_name.$invalid && (!client_form.last_name.$pristine || client_form.submitted)}">\r\n      <label bb-question-label="question" class="control-label col-sm-4" for="last_name">Last Name*:</label>\r\n      <div class="bb-field col-sm-5">\r\n        <input type="text" name="last_name" id="last_name" required ng-model="client.last_name" class="form-control" bb-resettable ng-pattern="validator.alpha" />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="client_form.last_name.$invalid && client_form.submitted">\r\n          Please enter your last name\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="form-group" ng-class="{\'has-error\': client_form.email.$invalid && (!client_form.email.$pristine || client_form.submitted)}">\r\n      <label bb-question-label="question" class="control-label col-sm-4" for="email">Email*:</label>\r\n      <div class="bb-field col-sm-5">\r\n        <input type="email" name="email" id="email" required ng-model="client.email" class="form-control" bb-resettable  ng-pattern="validator.getEmailPattern()" />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="client_form.email.$invalid && client_form.submitted">\r\n          Please enter a valid email address\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="form-group" ng-class="{\'has-error\': (client_form.mobile.$invalid && (!client_form.mobile.$pristine || client_form.submitted)) && (!client_form.mobile.$focused || client_form.mobile.$error.required)}">\r\n      <label bb-question-label="question" class="control-label col-sm-4" for="mobile">Mobile:</label>\r\n      <div class="bb-field col-sm-5">\r\n        <input type="text" name="mobile" id="mobile" ng-model="client.mobile" class="form-control" bb-resettable ng-pattern="validator.getMobilePattern()" />\r\n      </div>\r\n    </div>\r\n    <div ng-show="client_details.hasQuestions" ng-form name="client_questions_form" class="bb-form" role="form" nonvalidate>\r\n\r\n      <h2 class="booking-form-header">Other Information</h2>\r\n\r\n      <div>\r\n        <div class="form-group" ng-repeat="question in client_details.questions" bb-question-line ng-show="question.currentlyShown" ng-class="{\'has-error\': client_questions_form[\'q\' + question.id].$invalid && (client_questions_form[\'q\' + question.id].dirty || client_form.submitted), \'bb-check-space\': (question.detail_type == \'check\')}">\r\n          <label class="control-label col-sm-4" bb-question-label="question" for="{{question.id}}">{{question.name}}<span ng-show="question.required">*</span>:</label>\r\n          <div class="col-sm-5">\r\n            <input bb-question="question" class="form-control"/><br/>\r\n            <small ng-show="question.help_text">{{question.help_text}}</small>\r\n          </div>\r\n          <div class="col-sm-offset-4 messages">\r\n            <div class="error-message" ng-show="client_questions_form[\'q\' + question.id].$invalid && (client_questions_form[\'q\' + question.id].dirty || client_form.submitted)">\r\n              This field is required\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="bb-step-navigation">\r\n      <div class="row">\r\n        <div class="col-sm-9 col-sm-push-3 text-right">\r\n          <button type="submit" class="btn btn-primary" ng-click="validator.validateForm(client_form) && validateClient(client_form)">Continue</button>\r\n        </div>\r\n        <div class="col-sm-3 col-sm-pull-9 text-left">\r\n          <button type="button" class="btn btn-default" ng-click="loadPreviousStep()" ng-show="bb.current_step > 1"><span>Back</span></button>\r\n          <button type="button" class="btn btn-default" ng-click="resetForm()">Clear</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </form>\r\n\r\n</div>\r\n'),$templateCache.put("company_cards.html",'<div bb-companies ng-init="checkStepTitle(\'Select a Company\')">\r\n  <div class="row">\r\n    <div ng-repeat="item in companies | orderBy: name">\r\n      <div class="col-sm-6 col-md-4">\r\n        <div class="card">\r\n          <div bb-address-map="item.address">\r\n            <ui-gmap-google-map center=\'map.center\' zoom=\'map.zoom\' options="options">\r\n              <ui-gmap-marker coords="marker.coords" idkey="marker.id">\r\n              </ui-gmap-marker>\r\n            </ui-gmap-google-map>\r\n            <div class="card-block">\r\n              <h4>{{item.name}}</h4>\r\n              <span ng-show="item.getAddress().address1">{{item.getAddress().address1}}<br /></span>\r\n              <span ng-show="item.getAddress().address2">{{item.getAddress().address2}}<br /></span>\r\n              <span ng-show="item.getAddress().address3">{{item.getAddress().address3}}<br /></span>\r\n              <span ng-show="item.getAddress().address4">{{item.getAddress().address4}}<br /></span>\r\n              <span ng-show="item.getAddress().address5">{{item.getAddress().address5}}<br /></span>\r\n              <span ng-show="item.getAddress().country">{{item.getAddress().country}}</span>\r\n              <span ng-show="item.description">{{item.description}}</span>\r\n              <a ng-click="selectItem(item)" class="btn btn-primary">Select</a>\r\n              <div class="clearfix">\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n<div class="bb-step-navigation" ng-show="bb.current_step > 1">\r\n  <div class="row">\r\n    <div class="col-sm-2">\r\n      <button type="button" class="btn btn-default pull-left" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("company_list.html",'<div bb-companies ng-init="checkStepTitle(\'Select a Company\')">\r\n\r\n  <div class="panel panel-default" ng-repeat="item in companies | orderBy: name">\r\n    <div class="panel-body">\r\n      <!-- add bb-vertical-align-center class below or something similar -->\r\n      <div class="row">\r\n        <div class="col-sm-10">\r\n          <h2 class="panel-title">{{item.name}}</h2>\r\n        </div>\r\n        <div class="col-sm-2">\r\n          <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation" ng-show="bb.current_step > 1">\r\n  <div class="row">\r\n    <div class="col-sm-2">\r\n      <button type="button" class="btn btn-default pull-left" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>'),$templateCache.put("confirmation.html",'<div bb-total ng-init="checkStepTitle(\'Confirmed\')" class="bb-checkout">\r\n  <div class="row">\r\n    <div class="col-xs-offset-1 col-xs-10">\r\n\r\n      <div class="bb-subcontent">\r\n        <div class="confirmation-header bb-confirmation-border-margin">\r\n          <div ng-show="!total.containsWaitlistItems()">\r\n            <h2>Booking Confirmation</h2>\r\n            <p class="bb-confirmation-p-alignment">Thanks {{ total.client.first_name }}. Your booking is now confirmed. We have emailed you the details below.</p>\r\n          </div>\r\n           <div ng-show="total.containsWaitlistItems()">\r\n            <h2>Confirmation</h2>\r\n            <p class="bb-confirmation-p-alignment">Thanks {{ total.client.first_name }}. You have successfully made the following bookings. We have you emailed you the details below.</p>\r\n          </div>\r\n          <div class="row hidden-print text-right">\r\n            <button type="button" class="btn btn-link" onclick="window.print()"><span class="fa fa-print fa-2x"></span> Print</button>\r\n            <div bb-booking-export class="bb-booking-export"></div>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <ul class="confirmation-summary">\r\n            <li class="row confirmation-summary-item">\r\n              <div class="bb-summary-label">Reference: </div>\r\n              <div class="bb-summary-value">{{total.id}}</div>\r\n            </li>\r\n          </ul>\r\n\r\n          <ul class="confirmation-summary" ng-repeat="booking in total.bookings">\r\n            <li ng-show="booking.full_describe" class="row confirmation-summary-item">\r\n              <div class="bb-summary-label">Service: </div>\r\n              <div class="bb-summary-value">{{booking.full_describe}}</div>\r\n            </li>\r\n            <li ng-show="booking.describe" class="row confirmation-summary-item">\r\n              <div class="bb-summary-label">Date/Time:</div>\r\n              <div class="bb-summary-value">{{booking.describe}}</div>\r\n            </li>\r\n            <li ng-show="booking.price" class="row confirmation-summary-item">\r\n              <div class="bb-summary-label">Price:</div>\r\n              <div class="bb-summary-value">{{booking.price | currency}}</div>\r\n            </li>\r\n          </ul>\r\n\r\n\r\n          <ul ng-show="total.bookings[0].address.lat" class="confirmation-summary">\r\n\r\n            <li class="row confirmation-summary-item">\r\n              <div class="col-sm-12">\r\n                <div bb-address-map="total.bookings[0].address">\r\n                  <div ui-gmap-google-map center=\'map.center\' zoom=\'map.zoom\' options="options">\r\n                    <div ui-gmap-marker coords="marker.coords" idkey="marker.id">\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </li>\r\n\r\n            <div class="confirmation-summary-address">\r\n              <div><span class=\'fa fa-map-marker\'></span> {{total.bookings[0].address | address_single_line}}</div>\r\n              <div> <span class=\'fa fa-phone\'></span> {{total.bookings[0].address.phone | local_phone_number}}</div>\r\n            </div>\r\n\r\n          </ul>\r\n\r\n          <div bb-custom-confirmation-text class="bb-message">\r\n            <div ng-repeat="msg in messages" ng-bind-html="msg"></div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("content_main.html",'<div ng-include="bb_main"\r\n      ng-hide="hide_page"\r\n      onload="initPage()"\r\n      bbContent="null">\r\n</div>\r\n'),$templateCache.put("dash.html",'<h1>Dashboard</h1>\r\n  <div class="dashcontainer" ng-controller="DashboardContainer" style="">\r\n\r\n  <div class="row">\r\n\r\n    <div class="col-md-4">\r\n      <h4>Pick a Location/Service</h4>\r\n\r\n      <div ng-controller="CompanyList" ng-init="init()">\r\n\r\n        <div class="" ng-repeat="comp in companies"  >\r\n          <h3>{{comp.name}}</h3>\r\n\r\n          <div ng-controller="PersonList" ng-init="init(comp)">\r\n\r\n            <a class="" ng-repeat="person in all_people"  style="margin-left:20px;font-size:14px;display:block;cursor:pointer;">\r\n              {{person.name}}\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-show="selectedSlot">\r\n        <div ng-controller="SelectedSlotDetails" class="side_details">\r\n          <div ng-include="showItemView">\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class="col-md-8">\r\n\r\n      <div ng-controller="CalendarCtrl" ng-init="init()">\r\n\r\n        <div ui-calendar="uiConfig.calendar" ng-model="eventSources" calendar="myCalendar">\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n    <div id="dialog-modal" title="" display:none;>\r\n\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("day.html",'<div bb-include="_basket_item_summary">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-month-availability ng-init="checkStepTitle(\'Select a date\')" class="bb-day">\r\n    <div class="bb-calendar-navigation">\r\n      <button type="button" class="btn btn-link pull-left" ng-click="subtract(\'months\',1)" ng-disabled="isPast()">\r\n        <span class="glyphicon glyphicon-chevron-left pull-left" aria-hidden="true">\r\n        </span>\r\n        <span class="hidden-xs">Previous Month\r\n        </span>\r\n      </button>\r\n      <button type="button" class="btn btn-link pull-right" ng-click="add(\'months\',1)">\r\n        <span class="hidden-xs">Next Month\r\n        </span>\r\n        <span class="glyphicon glyphicon-chevron-right pull-right" aria-hidden="true">\r\n        </span>\r\n      </button>\r\n    </div>\r\n    <div>\r\n      <h2 class="bb-section-title text-center hidden-xs">{{format_date(\'MMMM YYYY\')}}\r\n      </h2>\r\n      <h2 class="bb-section-title text-center hidden-sm hidden-md hidden-lg">{{format_date(\'MMM YY\')}}\r\n      </h2>\r\n      <table class="table table-bordered">\r\n        <tr ng-repeat="week in weeks">\r\n          <td ng-repeat="day in week" ng-class="{\'bb-today\': day.date.isSame(moment(),\'day\'), \'bb-go-ok\': day.spaces > 0, \'bb-no-go\': day.date.isBefore(moment(),\'day\') || day.spaces == 0, \'bb-month-highlight\': current_date.isSame(day.date,\'month\') }" ng-click="selectDay(day)">\r\n            <p class="pull-right" class="time-slot {{day.class(month)}}"  ng-class="{\'bb-past\': day.date.isBefore(moment(),\'day\') || day.spaces == 0}">\r\n              {{day.day()}}\r\n            </p>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("deal_list.html",'<div bb-deals>\r\n\r\n  <h2 class="deal-list-heading">\r\n    <span> Gift Certificates </span>\r\n  </h2>\r\n\r\n<div ng-if="bb.stacked_items && bb.stacked_items[0].deal">\r\n  <h4> Selected Gift Certificates </h4>\r\n  <table class="table table-bordered">\r\n    <thead>\r\n      <tr>\r\n        <th>Item</th>\r\n        <th>Price</th>\r\n        <th>&nbsp;</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n      <tr ng-repeat="item in bb.stacked_items" ng-class="{\'last-item\': $last}">\r\n        <td>\r\n          <p>\r\n            {{item.deal.name}}\r\n            <br/>\r\n             <form ng-if="!bb.company_settings.no_recipient" name="recipient_form" class="form-horizontal" role="form" bb-form-resettable bb-form novalidate>\r\n              <div ng-hide="recipient_form.submitted && item.recipient">\r\n              <small> Add a Recipient </small>\r\n              <br/>\r\n              <p>\r\n                <label bb-question-label="question" for="recipient_name" class="control-label col-sm-4"> <small> Name: </small> </label> <input type="text" name="recipient_name" id="recipient_name" ng-model="recipient.name" ng-pattern="validator.alpha"/>\r\n                <br/>\r\n              </p>\r\n              <p>\r\n                <label bb-question-label="question" for="recipient_mail" class="control-label col-sm-4"><small> Email: </small> </label> <input type="email" name="recipient_mail" id="recipient_mail" ng-model="recipient.mail"/>\r\n                <br/>\r\n              </p>\r\n              <p>\r\n                <button ng-click="validator.validateForm(recipient_form) && addRecipient(item, recipient)"> Add </button>\r\n                <br/>\r\n              </p>\r\n             <br/>\r\n             <p ng-show="recipient_form.recipient_name.$invalid && recipient_form.submitted" class="error-message"> Please enter the Recipients full name</p>\r\n              <p ng-show="recipient_form.recipient_mail.$invalid && recipient_form.submitted" class="error-message"> Please enter a valid email address</p>\r\n                </div>\r\n              </form>\r\n            <div ng-if="item.recipient">\r\n             <h5>Recipient </h5>\r\n              <p ng-if="item.recipient"> Name: <small> {{ item.recipient }} </small> </p>\r\n              <p ng-if="item.recipient_mail"> Email: <small> {{ item.recipient_mail }} </small> </p>\r\n            </div>\r\n        </p>\r\n        </td>\r\n        <td class="text-right">\r\n          {{ item.deal.price | currency }}\r\n        </td>\r\n        <td class="text-center">\r\n          <span class="glyphicon glyphicon-trash" aria-hidden="true"  ng-click="removeDeal(item)"></span>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<div class="panel panel-default bb-event-card" ng-repeat="deal in deals">\r\n  <div class="panel-body">\r\n    <div class="row vertical-row-align">\r\n\r\n      <div class="col-sm-9 col-xs-12 deal-details">\r\n        <h3 >{{deal.name}}</h3>\r\n        <ul class="deal-summary-list">\r\n          <li class="deal-description">\r\n            <span>{{ deal.description }}</span>\r\n          </li>\r\n          <li class="price">\r\n            <span class="bb-icon icon-price"></span>\r\n            <span>{{deal.price | currency}}</span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n\r\n      <div class="col-sm-3 deal-select">\r\n        <button type="button" ng-click="selectDeal(deal)" class="btn btn-primary btn-block">\r\n          <span >Buy</span>\r\n        </button>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div ng-if="bb.stacked_items && bb.stacked_items[0].deal">\r\n  <button type="button" class="btn btn-primary btn-block" ng-click="purchaseDeals()"><span>Buy Gift Certificates</span></button>\r\n</div>\r\n<div class="row bb-step-navigation">\r\n  <button type="button" class="btn btn-default" ng-click="loadPreviousStep()" ng-show="bb.current_step > 1"><span>Back</span></button>\r\n</div>\r\n\r\n</div>\r\n'),$templateCache.put("duration_list.html",'<div bb-include="_basket_item_summary">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-durations ng-init="checkStepTitle(\'Select Duration\')" class="bb-duration-list">\r\n    <div class="panel panel-default" ng-repeat="duration in durations">\r\n      <div class="panel-body">\r\n        <div class="row">\r\n          <div class="col-sm-8 col-xs-6">\r\n            <h2 class="panel-title">{{duration.pretty}}</h2>\r\n            <div ng-if="duration.description">\r\n              {{duration.description}}\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2 col-xs-6">\r\n            <div class="bb-duration-price">\r\n              <span ng-show="duration.price > 0">{{duration.price | currency}}</span>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2 col-xs-12">\r\n            <button type="button" ng-click="selectDuration(duration)" class="btn btn-primary btn-block">Select</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>'),$templateCache.put("event.html",'<div bb-page>\r\n\r\n  <div bb-event>\r\n\r\n    <div class="event-header" bb-background-image="event.image.url">\r\n      <div class="event-details">\r\n        <h1 class="truncate-sm">{{event.chain.name}}</h1>\r\n        <ul class="row event-summary-list">\r\n          <li class="col-xs-6 col-sm-4 date truncate-xs">\r\n            <span class=\'fa fa-calendar-o\'></span>\r\n            <span class="hidden-xs">{{event.date.format(\'dddd \')}}</span><span>{{event.date.format(\'Do MMMM YYYY\')}}</span>\r\n          </li>\r\n          <li class="col-xs-6 col-sm-4 time truncate-xs">\r\n            <span class="fa fa-clock-o" aria-hidden="true"></span>\r\n            <span class="event-time" ng-bind="event.date.format(\'h[:]mma\')"></span>&ndash;<span ng-bind="event.end_datetime.format(\'h[:]mma\')"></span>\r\n          </li>\r\n          <li class="hidden-xs col-sm-4 duration truncate-xs">\r\n            <span class="fa fa-hourglass-half"></span>\r\n            <span ng-bind="event.duration | time_period"></span>\r\n          </li>\r\n          <li class="col-xs-12 location" ng-show="event.chain.address">\r\n            <span class="fa fa-map-marker"></span>\r\n            <span ng-bind="event.chain.address | address_single_line"></span>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default event-description" ng-show="event.chain.description">\r\n      <div class="panel-body">\r\n        <p ng-bind-html="event.chain.description"></p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default" ng-show="event.chain.long_description">\r\n      <div class="panel-body">\r\n        <div>\r\n          <h2 class="heading">Event details</h2>\r\n          <p ng-bind-html="event.chain.long_description"></p>\r\n        </div>\r\n\r\n        <div bb-custom-booking-text class="bb-custom-booking-text text-block">\r\n          <p ng-repeat="msg in messages" ng-bind-html="msg"></p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="panel panel-default event-tickets">\r\n      <div class="panel-body">\r\n        <h2 ng-show="bb.basket.hasWaitlistItem()" class="heading" ng-bind="!selected_tickets ? \'Waitlist\' : \'Waitlist summary\'"></h2>\r\n        <h2 ng-show="!bb.basket.hasWaitlistItem()" class="heading" ng-bind="!selected_tickets ? \'Tickets\' : \'Ticket summary\'"></h2>\r\n        <div ng-form name="ticket_form" role="form">\r\n\r\n          <ul class="ticket-list">\r\n            <li class="header">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6">Type</div>\r\n                <div class="col-sm-3 col-xs-4">Price</div>\r\n                <div class="col-sm-3 col-xs-2">Qty</div>\r\n              </div> \r\n            </li>\r\n            <li ng-repeat="ticket in event.tickets">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6">\r\n                  <span>{{ticket.fullName()}}</span>\r\n                </div>\r\n                <div class="col-sm-3 col-xs-4">\r\n                  <span ng-show="ticket.price > 0">{{ticket.price | currency}}</span><span ng-show="ticket.price == 0">Free</span>\r\n                  <small ng-show="ticket.counts_as"><i>(for {{ticket.counts_as}})</i></small>\r\n                </div>\r\n                <div ng-show="event.getSpacesLeft() > 0 || event.getWaitSpacesLeft() > 0" class="col-sm-3 col-xs-2">\r\n                  <span ng-show="selected_tickets">{{ticket.qty}}</span>\r\n                  <select ng-if="!selected_tickets" ng-model="ticket.qty" ng-options="n as n for n in ticket.getRange(event)">\r\n                    <option value="">-</option>\r\n                  </select>\r\n                </div>\r\n                <div ng-show="event.getSpacesLeft() == 0 && event.getWaitSpacesLeft() == 0" class="col-sm-3 col-xs-2">\r\n                  <span>Sold Out</span>\r\n                </div>\r\n              </div>\r\n            </li>\r\n            <li ng-show="selected_tickets && bb.basket.questionPrice()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 text-right">Add-ons</div>\r\n                <div class="col-sm-3 col-xs-6">{{bb.basket.questionPrice() | currency}}</div>\r\n              </div>\r\n            </li>\r\n            <li ng-show="selected_tickets && (bb.basket.hasCoupon() || bb.basket.hasDeal())">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Subtotal</div>\r\n                <div class="col-sm-3 col-xs-6">{{bb.basket.fullPrice() | currency}}</div>\r\n              </div>\r\n            </li>\r\n\r\n            <li ng-show="selected_tickets && bb.basket.hasDeal()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 text-right">\r\n                  <div>Gift Certificate</div>\r\n                </div>\r\n                <div class="col-sm-3 col-xs-6">\r\n                  <div>{{bb.basket.totalDealPaid() | currency}}</div>\r\n                </div>\r\n              </div>\r\n            </li>\r\n            <li ng-show="selected_tickets && bb.basket.hasCoupon()">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 text-right">Discount</div>\r\n                <div class="col-sm-3 col-xs-6">-{{bb.basket.totalCoupons() | currency }} <!-- <span>(10%)</span></div> -->\r\n                </div>\r\n              </div>\r\n            </li>\r\n            <li ng-show="selected_tickets">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Total</div>\r\n                <div class="col-sm-3 col-xs-6"><strong>{{bb.basket.totalPrice() | currency}}</strong></div>\r\n              </div>\r\n            </li>\r\n            <li ng-show="selected_tickets">\r\n              <div class="row">\r\n                <div class="col-sm-6 col-xs-6 total-label">Due Total</div>\r\n                <div class="col-sm-3 col-xs-6"><strong>{{bb.basket.dueTotal() | currency}}</strong>\r\n                </div>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n\r\n        </div>\r\n\r\n        <!-- <div bb-basket-list class="row" ng-if="selected_tickets">\r\n          <div class="col-sm-6">\r\n\r\n            <div class="gift-certifcates ">\r\n              <div ng-form class="form-inline">\r\n                <div ng-show="!show_voucher_box">\r\n                  <button type="button" class="btn btn-link" ng-click="show_voucher_box = true">Have a gift certificate?</button>\r\n                </div>\r\n                <div ng-show="show_voucher_box" class="form-group">\r\n                  <label for="deal_code">Apply a gift certificate:</label>\r\n                  <div class=" input-group">\r\n                    <input type="text" class="form-control input-sm" id="deal_code" name="deal_code" ng-model="deal_code" placeholder="Enter your certificate code">\r\n                    <span class="input-group-btn">\r\n                    <button type="submit" class="btn btn-primary btn-sm" ng-disabled="!deal_code" ng-click="applyDeal(deal_code)">Apply</button>\r\n                  </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div class="deals-applied-wrapper" ng-if="bb.basket.hasDeal()">\r\n                <h3>Gift Certificates applied</h3>\r\n                <ul class="deals-applied">\r\n                  <li ng-repeat="deal in bb.basket.getDealCodes()">\r\n                    {{deal.description}} ({{deal.deal_code}})\r\n                    <button  type="button" class="btn btn-link btn-red" ng-click="removeDeal(deal)"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Remove</button>\r\n                  </li>\r\n                </ul>\r\n                <p>Remaining Gift Certificate balance: {{bb.basket.remainingDealBalance() | currency}}</p>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n        </div> -->\r\n\r\n      </div>\r\n    </div>\r\n\r\n    <form name="booking_form" role="form" novalidate bb-form>\r\n\r\n      <div class="panel panel-default event-client-details" ng-if="selected_tickets">\r\n\r\n        <div class="panel-body">\r\n\r\n          <h2>Your details</h2>\r\n\r\n          <div ng-form name="client_form" class="form-horizontal" role="form" novalidate>\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.first_name.$invalid && (client_form.first_name.$dirty || booking_form.submitted)}">\r\n              <label for="first_name" class="control-label col-sm-4">First Name:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="first_name" id="first_name" required ng-model="client.first_name" class="form-control" />\r\n              </div>\r\n              <div class="col-sm-3 messages">\r\n                <div class="error-message" ng-show="client_form.first_name.$invalid && booking_form.submitted">\r\n                  Please enter your first name\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.last_name.$invalid && (client_form.last_name.$dirty|| booking_form.submitted)}">\r\n              <label for="last_name" class="control-label col-sm-4">Last Name:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="last_name" id="last_name" required ng-model="client.last_name" class="form-control" />\r\n              </div>\r\n              <div class="col-sm-3 messages">\r\n                <div class="error-message" ng-show="client_form.last_name.$invalid && booking_form.submitted">\r\n                  Please enter your last name\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.email.$invalid && (client_form.email.$dirty|| booking_form.submitted)}">\r\n              <label for="email" class="control-label col-sm-4">Email*:</label>\r\n              <div class="col-sm-5">\r\n                <input type="email" name="email" id="email" required ng-model="client.email" class="form-control" />\r\n              </div>\r\n              <div class="col-sm-3 messages">\r\n                <div class="error-message" ng-show="client_form.email.$invalid && booking_form.submitted">\r\n                  Please enter a valid email address\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.mobile.$invalid && ((client_form.mobile.$dirty && !client_form.mobile.$focused) || booking_form.submitted)}">\r\n              <label for="mobile" class="control-label col-sm-4">Mobile:</label>\r\n              <div class="col-sm-5">\r\n                <input type="tel" name="mobile" id="mobile" ng-pattern="validator.getUKMobilePattern()" ng-model="client.mobile" class="form-control"/>\r\n              </div>\r\n              <div class="col-sm-3 messages">\r\n                <div class="error-message" ng-show="client_form.mobile.$dirty && client_form.email.$invalid && booking_form.submitted">\r\n                  Please enter a valid mobile number\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.address1.$invalid && ((client_form.address1.$dirty && !client_form.address1.$focused) || booking_form.submitted)}">\r\n              <label for="address1" class="control-label col-sm-4">Address:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="address1" id="address1" ng-model="client.address1" class="form-control"/>\r\n              </div>\r\n              <div class="col-sm-3 messages">\r\n                <div class="error-message" ng-show="client_form.address1.$invalid && booking_form.submitted">\r\n                  Please enter your address\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.address2.$invalid && ((client_form.address2.$dirty && !client_form.address2.$focused) || booking_form.submitted)}">\r\n              <label for="address2" class="control-label col-sm-4"></label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="address2" id="address2" ng-model="client.address2" class="form-control"/>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.address3.$invalid && ((client_form.address3.$dirty && !client_form.address3.$focused) || booking_form.submitted)}">\r\n              <label for="address3" class="control-label col-sm-4">Town:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="address3" id="address3" ng-model="client.address3" class="form-control"/>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.address4.$invalid && booking_form.submitted}">\r\n              <label for="address4" class="control-label col-sm-4">County:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="address4" id="address4" ng-model="client.address4" class="form-control"/>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group" ng-class="{\'has-error\': client_form.postcode.$invalid && ((client_form.postcode.$dirty && !client_form.postcode.$focused) || booking_form.submitted)}">\r\n              <label for="postcode" class="control-label col-sm-4">Postcode:</label>\r\n              <div class="col-sm-5">\r\n                <input type="text" name="postcode" id="postcode" ng-pattern="validator.getUKPostcodePattern()" ng-model="client.postcode" class="form-control" onBlur="javascript:this.value=this.value.toUpperCase()" style="text-transform:uppercase"/>\r\n              </div>\r\n              <div class="col-sm-3 messages">\r\n                <div class="error-message" ng-show="client_form.postcode.$invalid && booking_form.submitted">\r\n                  Please enter a valid postcode\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div bb-client-details ng-show="client_details.hasQuestions">\r\n\r\n              <div class="form-group" ng-repeat="question in client_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{ \'check\': question.detail_type == \'check\', \'has-error\': client_form[\'q\' + question.id].$invalid && (client_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n                <label ng-hide="question.detail_type == \'check\'" for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-show="question.required">*</span></label>\r\n                <div ng-show="question.detail_type == \'check\'" class="col-sm-4 hidden-xs">&nbsp;</div>\r\n                <div class="col-sm-5">\r\n                  <input bb-question="question" />\r\n                </div>\r\n                <div class="col-sm-3 messages">\r\n                  <div class="error-message" ng-show="client_form[\'q\' + question.id].$invalid && ( client_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                    This field is required\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n\r\n          <div accordion close-others="false" ng-init="use_my_details = true">\r\n            <div ng-repeat="item in current_ticket_items" bb-count-ticket-types="current_ticket_items">\r\n              <div ng-form name="client_ticket_form" class="form-horizontal" role="form" novalidate>\r\n                <div ticket-accordion accordion-group is-open="is_open" ng-init="is_open = $first">\r\n                  <div accordion-heading>\r\n                    <h2>Ticket <span ng-show="current_ticket_items.length != 1">{{$index + 1}}</span> details <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': is_open, \'glyphicon-chevron-right\': !is_open}"></i></h2>\r\n                  </div>\r\n\r\n\r\n                  <div ng-if="$first" class="form-group">\r\n                    <label for="use_my_details" class="control-label col-sm-4">Are you the attendee?</label>\r\n                    <div class="col-sm-5">\r\n                      <label><input type="checkbox" name="use_my_details" id="use_my_details" ng-model="$parent.use_my_details"> Yes, use my details</label>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div class="form-group" ng-class="{\'has-error\': (!$first || !use_my_details) && client_ticket_form.attendee_first_name.$invalid && (client_ticket_form.attendee_first_name.$dirty || booking_form.submitted)}">\r\n                    <label for="attendee_first_name" class="control-label col-sm-4">First Name*:</label>\r\n                    <div ng-if="use_my_details && $first"  class="col-sm-5">\r\n                      <input disabled type="text" ng-model="client.first_name" name="attendee_first_name" class="form-control" />\r\n                    </div>\r\n                    <div ng-if="!use_my_details || !$first" class="col-sm-5">\r\n                      <input type="text" ng-model="item.first_name" name="attendee_first_name" class="form-control" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div class="form-group" ng-class="{\'has-error\': (!$first || !use_my_details) && client_ticket_form.attendee_last_name.$invalid && (client_ticket_form.attendee_last_name.$dirty|| booking_form.submitted)}">\r\n                    <label for="attendee_last_name" class="control-label col-sm-4">Last Name*:</label>\r\n                    <div ng-if="use_my_details && $first" class="col-sm-5">\r\n                      <input disabled type="text" ng-model="client.last_name" name="attendee_last_name" class="form-control" />\r\n                    </div>\r\n                    <div ng-if="!use_my_details || !$first" class="col-sm-5">\r\n                      <input type="text" ng-model="item.last_name" name="attendee_last_name" class="form-control" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div class="form-group" ng-class="{\'has-error\': (!$first || !use_my_details) && client_ticket_form.attendee_email.$dirty && client_ticket_form.attendee_email.$invalid}">\r\n                    <label for="attendee_email" class="control-label col-sm-4">Email:</label>\r\n                    <div ng-if="use_my_details && $first" class="col-sm-5">\r\n                      <input disabled type="email" ng-model="client.email" name="attendee_email" required class="form-control" />\r\n                    </div>\r\n                    <div ng-if="!use_my_details || !$first" class="col-sm-5">\r\n                      <input type="email" ng-model="item.email" name="attendee_email" class="form-control" />\r\n                    </div>\r\n                    <div class="col-sm-3 messages">\r\n                      <div class="error-message" ng-show="(!$first || !use_my_details) && client_ticket_form.attendee_email.$dirty && client_ticket_form.attendee_email.$invalid && booking_form.submitted">\r\n                        Please enter a valid email address\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <!-- \\/\\/\\/\\/\\/\\/\\/\\/ -->\r\n                  <!-- CUSTOM QUESTIONS -->\r\n                  <!-- \\/\\/\\/\\/\\/\\/\\/\\/ -->\r\n\r\n                  <div bb-item-details="item" bb-suppress-basket-update="$index">\r\n                    <div ng-form name="booking_questions_form">\r\n                      <div ng-repeat="question in item_details.questions">\r\n                        <div class="form-group" ng-if="question.currentlyShown" bb-question-line ng-class="{\'has-error\': booking_questions_form[\'q\' + question.id].$invalid && (booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted)}">\r\n                          <label for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-show="question.required">*</span>:</label>\r\n                          <div class="col-sm-5">\r\n                            <input bb-question="question" />\r\n                          </div>\r\n                          <div class="col-sm-3 messages">\r\n                            <div class="error-message" ng-show="booking_questions_form[\'q\' + question.id].$invalid && ( booking_questions_form[\'q\' + question.id].$dirty || booking_form.submitted )">\r\n                              This field is required\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n          </div><!-- accordion close -->\r\n\r\n          <div class=\'accordion-bottom-border\'></div>\r\n\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-if="!bb.isAdmin && selected_tickets" ng-form name="terms_and_conditons_form" id="terms_and_conditons_form" role="form" novalidate class="form-horizontal">\r\n        <div class="form-group check" ng-class="{\'has-error\': terms_and_conditons_form.tandc.$invalid && booking_form.submitted}">\r\n          <div class="col-sm-4 hidden-xs">&nbsp;</div>\r\n          <div class="col-sm-5">\r\n            <label>\r\n              <input type="checkbox" required ng-model="tandc" id="tandc" name="tandc" /> I agree to the <a href="#" target="_blank">terms and conditions</a>.\r\n            </label>\r\n          </div>\r\n          <div class="col-sm-3 messages">\r\n            <div class="error-message" ng-show="terms_and_conditons_form.tandc.$invalid && booking_form.submitted">\r\n              You must agree to the terms and conditions\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="button-group">\r\n\r\n        <div class="row">\r\n\r\n          <div class="col-sm-push-9 col-sm-3">\r\n\r\n            <div ng-if="!selected_tickets">\r\n\r\n              <button type="button" class="btn btn-primary btn-block" ng-disabled="event.numTicketsSelected() == 0" ng-click="selectTickets()" ng-show="event.getSpacesLeft() > 0">\r\n                Reserve Ticket<span ng-show="event.numTicketsSelected() > 1">s</span>\r\n                <span class="glyphicon glyphicon-chevron-right"></span>\r\n              </button>\r\n\r\n              <button type="button" class="btn btn-primary btn-block" ng-disabled="event.numTicketsSelected() == 0" ng-click="selectTickets()" ng-show="event.getSpacesLeft() <= 0 && bb.company.settings.has_waitlists">\r\n                Join Waitlist\r\n              </button>\r\n\r\n            </div>\r\n\r\n            <div ng-if="selected_tickets">\r\n\r\n              <button type="submit" class="btn btn-primary btn-block" ng-click="validator.validateForm(booking_form) && checkReady() && routeReady()">\r\n                Book Ticket\r\n              </button>\r\n\r\n            </div>\r\n\r\n          </div>\r\n\r\n          <div class="col-sm-3 col-sm-pull-3">\r\n\r\n            <button type="button" class="btn btn-default" bb-debounce ng-click="decideNextPage(\'event_list\')">\r\n              Back\r\n            </button>\r\n\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </div><!-- button group -->\r\n\r\n    </form>\r\n\r\n  </div>\r\n</div>\r\n'),
$templateCache.put("event_group_list.html",'<div bb-event-groups>\r\n\r\n  <div class="panel panel-default" ng-repeat="item in items">\r\n    <div class="panel-body">\r\n      <h2 class="panel-title item-name">{{item.name}}</h2>\r\n      <div class="row">\r\n<!--         <div class="col-sm-2 service-image">\r\n          <img ng-src="{{item.extra.image_url}}" class="img-responsive"/>\r\n        </div> -->\r\n        <div class="col-sm-8 col-xs-9 item-description">\r\n          {{item.description}}\r\n        </div>\r\n        <div class="col-sm-2 col-xs-3 item-price" ng-if="item.price">\r\n          <span class="currency-symbol"></span>{{item.price}}\r\n        </div>\r\n      </div>\r\n      <div class="row">\r\n        <div class="col-sm-2 col-sm-offset-10 service-select">\r\n          <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n\r\n'),$templateCache.put("event_list.html",'<div bb-events="{mode: 2}" ng-init="bb.basket.clear()">\r\n\r\n  <div class="page-header">\r\n    <h1>Events at {{company.name}}</h1>\r\n  </div>\r\n\r\n  <div class="alert alert-info" bb-time-zone ng-show="is_time_zone_diff">\r\n    All times are shown in {{time_zone_name}}.\r\n  </div>\r\n\r\n  <!-- <div bb-month-picker day-data="item_dates"></div> -->\r\n\r\n  <div class="events" ng-show="items" bb-scroll-to="page:changed" bb-always-scroll>\r\n\r\n  <div class="bb-filters" ng-show="items">\r\n\r\n    <div accordion>\r\n      <div accordion-group is-open="is_open" ng-class="{\'expanded\': is_open, \'selected\': is_selected}" class="store-body">\r\n        <div accordion-heading class="filter-header">\r\n          <span class="glyphicon glyphicon-filter" aria-hidden="true"></span>\r\n          <span>Filter</span>\r\n        </div>\r\n\r\n          <form class="form-inline">\r\n\r\n            <div class="form-group">\r\n              <label class="sr-only" for="event_group">Category</label>\r\n              <select class="form-control" name="event_group" id="event_group" ng-model="filters.event_group" ng-options="event_group.name for (id, event_group) in event_groups" ng-change="filterChanged()">\r\n                <option value="">Any Category</option>\r\n              </select>\r\n            </div>\r\n\r\n          <div class="form-group" ng-repeat="check_filter in dynamic_filters.check">\r\n            <label class="sr-only" for="event_group">{{select_filter.name}}</label>\r\n            <select class="form-control" name="check_filter" id="check_filter" ng-model="dynamic_filters.values[check_filter.name]" ng-options="answer.name for answer in check_filter.question_items | orderBy: \'name\'" ng-change="filterChanged()">\r\n              <option value="">&mdash; Any {{check_filter.name}} &mdash;</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div class="form-group" ng-repeat="select_filter in dynamic_filters.select" ng-show="has_company_questions">\r\n            <label class="sr-only" for="event_group">{{select_filter.name}}</label>\r\n            <select class="form-control" name="select_filter" id="select_filter" ng-model="dynamic_filters.values[select_filter.name]" ng-options="answer.name for answer in select_filter.question_items" ng-change="filterChanged()">\r\n              <option value="">&mdash; Any {{select_filter.name}} &mdash;</option>\r\n            </select>\r\n          </div>\r\n\r\n\r\n          <div class="form-group calendar">\r\n            <label class="sr-only" for="date">Date</label>\r\n            <div class="input-group date-picker">\r\n              <!-- date format: http://docfiddich.angularjs.org/api/ng.filter:date" -->\r\n              <input type="text" ng-model="selected_date" class="form-control"\r\n                bb-datepicker-popup="DD/MM/YYYY"\r\n                datepicker-popup="dd/MM/yyyy"\r\n                is-open="opened"\r\n                min-date="today"\r\n                on-date-change="selectedDateChanged()"\r\n                datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n                show-weeks="false"\r\n                show-button-bar="false"\r\n                ng-readonly="true"\r\n                name="date"\r\n                id="date"\r\n                placeholder="&mdash; Any Date &mdash;"/>\r\n              <span class="input-group-btn" ng-click="$event.preventDefault(); $event.stopPropagation(); opened=!opened;">\r\n                <button class="btn btn-default" type="submit" title="Pick date">\r\n                  <span class="fa fa-calendar-o"></span>\r\n                </button>\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n            <div class="form-group">\r\n              <label class="sr-only" for="price">Price</label>\r\n              <select class="form-control" name="price" id="price" ng-model="filters.price" ng-options="price as (price | currency) for price in price_options" ng-change="filterChanged()">\r\n                <option value="">Any Price</option>\r\n              </select>\r\n            </div>\r\n\r\n\r\n            <div class="form-group">\r\n              <button type="button" class="btn btn-link" ng-click="filters.hide_sold_out_events =! filters.hide_sold_out_events; filterChanged()">\r\n                <span ng-hide="filters.hide_sold_out_events" class="">\r\n                  <span class="glyphicon glyphicon-eye-close" aria-hidden="true">\r\n                  </span>\r\n                   Hide Sold Out Events\r\n                </span>\r\n                <span ng-show="filters.hide_sold_out_events">\r\n                  <span class="glyphicon glyphicon-eye-open " aria-hidden="true">\r\n                  </span>\r\n                   Show Sold Out Events\r\n                </span>\r\n              </button>\r\n            </div>\r\n\r\n            <div class="form-group">\r\n              <button type="button" class="btn btn-link" ng-click="resetFilters()">\r\n                <span class="glyphicon glyphicon-repeat" aria-hidden="true"></span>\r\n                Reset\r\n              </button>\r\n            </div>\r\n\r\n          </form>\r\n\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class="panel panel-default bb-filter-summary">\r\n      <div class="panel-body">\r\n        <div class="row" ng-if="filtered_items.length > 0">\r\n          <div class="col-xs-8">\r\n            <span ng-show="!filter_active">Showing all events</span>\r\n            <span ng-show="filter_active">Showing filtered events</span>\r\n          </div>\r\n          <div class="col-xs-4 text-right">\r\n            {{pagination.summary}}<span class="hidden-xs" >events</span>\r\n            <span class="hidden-xs">\r\n              <button type="button" class="btn btn-icon" ng-disabled="!$root.tiles" ng-click="$root.tiles = !$root.tiles"><span class="glyphicon glyphicon-th-list" aria-hidden="true" ></span></button>\r\n              <button type="button" class="btn btn-icon" ng-disabled="$root.tiles"  ng-click="$root.tiles = !$root.tiles"><span class="glyphicon glyphicon-th-large" aria-hidden="true" ></span></button>\r\n            </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class="row" ng-show="filtered_items.length == 0">\r\n          <div class="col-xs-12">\r\n            No events found\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n   <!--  Gift Cert Button (Needs Styling) -->\r\n   <!-- <div ng-if="bb.company_settings.has_vouchers">\r\n      <button type="button" ng-click="showPage(\'deal_list\')" class="btn btn-primary btn-block">\r\n        <span>Buy Gift Certificates </span>\r\n      </button>\r\n    </div> -->\r\n\r\n    <div class="bb-events-list row">\r\n      <div ng-repeat="item in filtered_items | startFrom: (pagination.current_page - 1) * pagination.page_size | limitTo: pagination.page_size" ng-init="spaces_left = item.getSpacesLeft()" ng-show="pagination.num_items > 0">\r\n        <div class="panel panel-default bb-event-card" ng-class="{\'col-sm-6 col-md-4 col-lg-3\':$root.tiles}">\r\n          <div class="panel-body" style="padding: 20px;">\r\n            <div class="row">\r\n              <div ng-class="{\'col-sm-3\':!$root.tiles}">\r\n                 <div class="event-img" bb-background-image="item.group.getImages()[0].url">\r\n                  <time datetime="{{item.date | datetime: \'YY[-]MM[-]DD\'}}" class="icon" ng-click="selectItem(item)">\r\n                    <em>{{item.date | datetime: \'dddd\' : false}}</em>\r\n                    <span class="date">{{item.date | datetime: \'DD\'}}</span>\r\n                    <strong class="date">{{item.date | datetime: \'MMMM\'}}</strong>\r\n                    <span class="time">{{item.date | datetime: \'h[:]mm\'}}</span>\r\n                    <strong class="time">{{item.date | datetime: \'a\'}}</strong>\r\n                  </time>\r\n                </div>\r\n              </div>\r\n              <div ng-class="{\'col-sm-9\':!$root.tiles}">\r\n                <div class="row">\r\n                  <div class="col-sm-12 event-title">\r\n                    <h3 class="truncate-sm">{{item.description}}</h3>\r\n                  </div>\r\n                </div>\r\n                <div class="row event-details">\r\n                  <ul>\r\n                    <li class="col-xs-6 truncate-xs" ng-class="{\'col-sm-4\':!$root.tiles}">\r\n                      <span class="fa fa-calendar-o"></span>\r\n                      <span class="hidden-xs hidden-sm" ng-class="{\'hidden-md\':$root.tiles, \'hidden-lg\':$root.tiles}">{{item.date | datetime: \'dddd \'}}</span>\r\n                      <span class="truncate-xs hidden-md hidden-lg">{{item.date | datetime: \'Do MMMM \'}}</span>\r\n                      <span class="truncate-xs hidden-xs hidden-sm">{{item.date | datetime: \'Do MMM \'}}</span>\r\n                      <span class="hidden-xs hidden-sm" ng-class="{\'hidden-md\':$root.tiles, \'hidden-lg\':$root.tiles}">{{item.date | datetime: \'YYYY\'}}</span>\r\n                    </li>\r\n                    <li class="col-xs-6 truncate-xs" ng-class="{\'col-sm-4\':!$root.tiles}">\r\n                      <span class="fa fa-clock-o" aria-hidden="true"></span>\r\n                      <span ng-bind="item.date | datetime: \'h[:]mma\'"></span>\r\n                      <span class="hidden-sm" ng-class="{\'hidden-lg\':$root.tiles, \'hidden-md\':$root.tiles}">-</span>\r\n                      <span class="hidden-sm" ng-class="{\'hidden-lg\':$root.tiles, \'hidden-md\':$root.tiles}" ng-bind="item.end_datetime | datetime: \'h[:]mma\'"></span>\r\n                    </li>\r\n                    <li class="hidden-xs truncate-xs" ng-class="{\'col-sm-4\':!$root.tiles, \'hidden-sm\':$root.tiles, \'hidden-md\':$root.tiles, \'hidden-lg\':$root.tiles}">\r\n                      <span class="fa fa-hourglass-half"></span>\r\n                      <span ng-bind="item.duration | time_period"></span>\r\n                    </li>\r\n                    <li class="col-xs-6 truncate-xs" ng-class="{\'col-sm-4\':!$root.tiles}">\r\n                      <span ng-if="spaces_left > 0" class="fa fa-users" aria-hidden="true"></span>\r\n                      <span ng-if="spaces_left < 1" class="fa fa-ban" aria-hidden="true"></span>\r\n                      <span>\r\n                        <span ng-if="spaces_left > 0" ng-bind="spaces_left"></span>\r\n                        <span ng-if="spaces_left < 1" ng-bind="\'No\'"></span> space<span ng-if="spaces_left > 1 || spaces_left < 1" ng-bind="\'s\'"></span>\r\n                        <span ng-class="{\'hidden-lg\':$root.tiles, \'hidden-md\':$root.tiles}">left</span>\r\n                      </span>\r\n                    </li>\r\n                    <li class="col-xs-6 truncate-xs" ng-class="{\'col-sm-4\':!$root.tiles}">\r\n                      <span class="fa fa-ticket" aria-hidden="true"></span>\r\n                      <span>\r\n                        <span ng-show="item.price_range && (item.price_range.from != item.price_range.to) && item.price_range.from && !item.price">From {{item.price_range.from | ipretty_price}}</span>\r\n\r\n                        <span ng-show="item.price_range && (item.price_range.from == item.price_range.to) || !item.price && !item.price_range.from">{{item.price_range.from | ipretty_price}}</span>\r\n                      </span>\r\n                    </li>\r\n                    <li class="hidden-xs truncate-xs " ng-class="{\'col-sm-4\':!$root.tiles, \'col-sm-12\':$root.tiles}">\r\n                      <span class="fa fa-map-marker" aria-hidden="true"></span>\r\n                      <span>\r\n                        {{bb.current_item.company.name}}\r\n                      </span>\r\n                      <span ng-if="$root.tiles">\r\n                        {{bb.current_item.company.getAddress().address4}}\r\n                      </span>\r\n                    </li>\r\n                  </ul>\r\n                </div>\r\n                <div class="row">\r\n                  <div class="event-description col-xs-12" ng-bind="item.chain.description" style="max-height: none; line-height: 1em; height:3em; margin-bottom: 20px; overflow:hidden"  ng-class="{\'col-sm-8\':!$root.tiles}"></div>\r\n                  <div class="event-select col-xs-12"  ng-class="{\'col-sm-4\':!$root.tiles}">\r\n                    <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block" ng-disabled="spaces_left == 0 && !bb.company.settings.has_waitlists">\r\n                      <span ng-show="spaces_left > 0">Book Event</span>\r\n                      <div ng-show="spaces_left <= 0 && !bb.company.settings.has_waitlists">\r\n                        <span class="status-sold-out">Sold out</span>\r\n                      </div>\r\n                      <div ng-show="spaces_left <= 0 && bb.company.settings.has_waitlists">\r\n                        <span>Join Waitlist</span>\r\n                      </div>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- /\\/\\/\\/\\/ -->\r\n        <!-- CLEARFIX! -->\r\n        <!-- /\\/\\/\\/\\/ -->\r\n\r\n        <div ng-if="(($index + 1) % 2) == 0" class="clearfix visible-sm"></div>\r\n        <div ng-if="(($index + 1) % 3) == 0" class="clearfix visible-md"></div>\r\n        <div ng-if="(($index + 1) % 4) == 0" class="clearfix visible-lg"></div>\r\n\r\n\r\n      </div>\r\n    </div>\r\n\r\n    <pagination total-items="pagination.num_items" ng-model="pagination.current_page" items-per-page="pagination.page_size" max-size="pagination.max_size" boundary-links="true" rotate="false" num-pages="pagination.num_pages" ng-show="filtered_items" ng-change="pageChanged()"></pagination>\r\n\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("loader.html","<div class='bb-loader' ng-hide='scopeLoaded'>\r\n  <div id='loading_icon'>\r\n    <div id='wait_graphic'>&nbsp;</div>\r\n  </div>\r\n</div>"),$templateCache.put("main.html",'<div class="header">\r\n\r\n  <div bb-form-data-store></div>\r\n\r\n  <!-- BREADCRUMB ROUTE\r\n  <div bb-breadcrumbs class="breadcrumbs_holder" ng-init="setRoute([\r\n    {page:\'event_list\', title: \'Select an event\'},\r\n    {page:\'event\', title: \'Event\'},\r\n    {page:\'checkout\', title: \'Confirmation\'}\r\n    ])">\r\n\r\n    <ol class="breadcrumb"> \r\n      <li ng-repeat="step in bb.allSteps" ng-class="{\'active\': step.active, \'passed\': step.passed, \'disabled\': isDisabledStep(step)}">\r\n        <button type="button" ng-click="loadStep(step.number)" ng-class="{\'active\': step.active, \'passed\': step.passed}" ng-disabled="isDisabledStep(step)">\r\n          <span class="step-num">{{step.number}}.</span>\r\n          <span class="step-title">{{step.title}}</span>\r\n        </button>\r\n      </li>\r\n    </ol>\r\n  </div> \r\n  -->\r\n\r\n  <!-- PROGRESSBAR\r\n  <div progressbar value="bb.percentage_complete" type="primary"></div>\r\n  -->\r\n\r\n  <!-- STEP INDICATOR\r\n  <div ng-if="bb.current_step" class="step-heading">\r\n    <span ng-if="bb.current_step != 1 && bb.current_step <  bb.allSteps.length" ng-bind="\'Step \' + (bb.current_step - 1) + \' of \' + (bb.allSteps.length - 2)"></span>\r\n    <span ng-if="bb.current_step == bb.allSteps.length" ng-bind="\'Complete\'"></span>\r\n  </div> -->\r\n\r\n  <div class="alerts" bb-scroll-to="alert:raised" bb-always-scroll>\r\n    <div alert ng-repeat="alert in $root.alerts" type="{{alert.type}}" >\r\n      <ul>\r\n        <li ng-bind-html="alert.msg"></li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="content">\r\n\r\n  <div bb-content class="ng-cloak"></div>\r\n  <div bb-display-mode></div>\r\n\r\n  <div bb-loading class="bb-loader" >\r\n    <div id="loading_icon">\r\n      <div id="wait_graphic">&nbsp;</div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div bb-dynamic-footer class="footer">\r\n  <div ng-show="isLoaded" class="powered-by">\r\n    <span>Bookings powered by <a href="http://www.bookingbug.com" style="text-decoration:none" target="_blank"><span style="color:#087f94">booking</span><span style="color:#88c66f">bug</span></a></span>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("main_view_booking.html",'<header>\r\n<!--   <div bb-breadcrumbs class="breadcrumbs_holder" ng-init="setRoute([\r\n      {page:\'purchase\', title: \'Your booking\'}\r\n      ])">\r\n  </div> -->\r\n\r\n  <div class="alerts" bb-scroll-to="alert:raised">\r\n   <div alert ng-repeat="alert in $root.alerts" type="{{alert.type}}">\r\n     <ul>\r\n       <li ng-bind-html="alert.msg"></li>\r\n     </ul>\r\n   </div>\r\n </div>\r\n</header>\r\n<section class="content">\r\n  <div bb-content class="ng-cloak"></div>\r\n  <div bb-display-mode></div>\r\n\r\n  <div bb-loading class="bb-loader" >\r\n    <div id="loading_icon">\r\n      <div id="wait_graphic">&nbsp;</div>\r\n    </div>\r\n  </div>\r\n</section>'),$templateCache.put("map.html",'<div id="map" bb-map="{default_zoom: 6, filter_by_service: true}" class="bb-store-search" ng-init="checkStepTitle(\'Select a company\')">\r\n\r\n  <div class="page-summary">\r\n    <p>Search for a store to begin your booking.</p>\r\n  </div>\r\n\r\n  <div class="panel panel-default">\r\n    <div class="panel-body" >\r\n      <div class="row search-form-wrapper">\r\n        <div class="col-xs-10 col-sm-6 col-sm-offset-3">\r\n          <form role="form" ng-submit="searchAddress({region: \'GB\', componentRestrictions: {\'country\': \'GB\'}, bounds: {sw:{x:\'50.064192\',y:\'-9.711914\'}, ne:{x:\'61.015725\',y:\'3.691406\'}}});">\r\n            <div class="form-group" style="width: 100%;">\r\n              <label class="sr-only" for="search-stores">Search</label>\r\n              <div class="input-group">\r\n                <input type="text" ng-model="address" class="form-control input-lg" id="search-stores" placeholder="Enter a town, city, postcode or store name">\r\n                <span class="input-group-btn">\r\n                  <button class="btn btn-primary btn-lg" type="submit" title="Search"><span class="glyphicon glyphicon-search"></span></button>\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n        <div class="col-xs-2">\r\n          <button type="button" class="btn btn-default btn-lg" title="use current location" ng-click="geolocate()">\r\n            <span class="glyphicon glyphicon-map-marker"></span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-show="loc">\r\n\r\n    <h2 class="company-map-header">{{shownMarkers.length}} results for stores near {{address}}</h2>\r\n\r\n    <div class="row filter-by-service" ng-show="can_filter_by_service">\r\n      <div class="col-xs-12">\r\n        <label>\r\n          <span>Hide stores with no availability</span>   \r\n          &nbsp;&nbsp;<input type=\'checkbox\' ng-model="filter_by_service" ng-change="filterByService()" />\r\n        </label>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="company-map row">\r\n\r\n      <div class="bb-map-block col-sm-8 col-sm-push-4">\r\n        <div ng-delayed="ui-map" ng-delayed-value="myMap" ng-delayed-watch="mapReady" ng-delayed-ready="mapLoaded" ui-options="mapOptions" class="map-canvas"></div>\r\n        <div ng-repeat="marker in mapMarkers" ui-map-marker="mapMarkers[$index]" ui-event="{\'map-click\': \'openMarkerInfo(marker)\'}"> </div>\r\n        <div ui-map-info-window="myInfoWindow" class="clearfix">\r\n          <p><strong>{{currentMarker.company.name}}</strong></p>\r\n\r\n          <div ng-show="currentMarker.company.has_service">\r\n            <p ng-bind-html="currentMarker.company.address | address_multi_line"></p>\r\n            <p><strong>Phone:</strong> {{currentMarker.company.address.phone | local_phone_number}}</p>\r\n            <p>\r\n              <span class="distance">{{roundNumberUp(currentMarker.distance,1) + distance_unit}}</span>\r\n            </p>\r\n          </div>\r\n\r\n          <div ng-show="!currentMarker.company.has_service">\r\n            Sorry, but {{currentMarker.company.service.name}} is not<br />available at this location\r\n          </div>\r\n\r\n          <br />\r\n          <button type="button" ng-click="selectItem(currentMarker.company)" class="btn btn-primary" ng-show="currentMarker.company.has_service">Select</button>\r\n          \r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div class="bb-company-block col-sm-4 col-sm-pull-8">\r\n\r\n        <div accordion close-others="true">\r\n          <div accordion-group is-open="marker.is_open" ng-class="{\'expanded\': marker.is_open, \'selected\': is_selected}" ng-repeat="marker in shownMarkers" class="store-body" ng-click="openMarkerInfo(marker)">\r\n            \r\n            <div accordion-heading class="store-header">\r\n              <span><strong>{{$index+1}}.</strong> {{marker.company.name}}</span>\r\n              <span class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': marker.is_open, \'glyphicon-chevron-right\': !marker.is_open}"></span>\r\n            </div>\r\n\r\n\r\n            <ul ng-show="marker.company.has_service" class="store-details" ng-click="openMarkerInfo(marker)">\r\n              <li ng-bind-html="marker.company.address | address_multi_line"></li>\r\n              <li><strong>Phone:</strong> {{marker.company.address.phone | local_phone_number}}</li>\r\n              <li>\r\n                <span class="distance">{{roundNumberUp(marker.distance,1) + distance_unit}}</span>\r\n              </li>\r\n            </ul>\r\n\r\n            <div ng-show="!marker.company.has_service">Sorry, but {{marker.company.service.name}} is not available at this location</div>\r\n\r\n            <button type="button" ng-show="marker.company.has_service" ng-click="selectItem(marker.company)" ng-show="currentMarker.company.has_service" class="btn btn-primary pull-right">Select</button>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n  <div ng-show="loc"class="bb-step-navigation">\r\n  </div>\r\n</div>\r\n'),$templateCache.put("membership_levels.html",'<div bb-membership-levels>\r\n  <div>\r\n    <h2 class="booking-form-header">Membership Types</h2>\r\n  </div>\r\n  <div>\r\n    <div class="form-group" ng-repeat="level in membership_level">\r\n      <span ng-if="level.name">{{level.name}}</span>\r\n      <button class="btn btn-primary btn-block" ng-click="selectLevel(level)">Select</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("payment.html",'<div bb-payment class="bb-payment">\r\n\r\n  <iframe id="bb-widget-payment" width="100% "scrolling="no" frameborder="0" ng-src="{{url}}" name="Payment Form"></iframe>\r\n  <script type="text/javascript">\r\n    $(\'#bb-widget-payment\').iFrameResize({checkOrigin:false, log: false, enablePublicMethods: true});\r\n  </script>\r\n\r\n</div>\r\n'),$templateCache.put("person_list.html",'<div bb-include="_basket_item_summary">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-people ng-init="checkStepTitle(\'Select a person\')">\r\n    <div class="panel panel-default" ng-repeat="item in bookable_items">\r\n      <div class="panel-body">\r\n        <div class="row">\r\n          <div class="col-sm-10">\r\n            <h2 class="panel-title">{{ item.name }}</h2>\r\n            <div class="row">\r\n              <div class="col-sm-2">\r\n                <image ng-src="" class="img-responsive" />\r\n              </div>\r\n              <div class="col-sm-10">\r\n                <!-- Description? -->\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2">\r\n            <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" ng-show="bb.current_step > 1" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("print_purchase.html",'<% content_for :head do %>\r\n<script src="/assets/widget.js" type="text/javascript"></script>\r\n<link href="/assets/angular/widget/main.css" media="all" rel="stylesheet" type="text/css" />\r\n<% end %>\r\n\r\n<%\r\nscp = {}\r\nif params[:base]\r\n  scp[:page_suffix] = "?base=#{params[:base]}"\r\nend\r\n\r\n%>\r\n\r\n<div bb-widget="<%=scp.to_json%>" >\r\n  <div bb-purchase="{}" class="bb-checkout">\r\n    <div class="container content">\r\n      <div class="row">\r\n        <div class="col-sm-offset-2 col-sm-8 col-md-offset-2 col-md-8">\r\n\r\n          <div class="confirmation-header bb-confirmation-border-margin">\r\n            <h2>Booking Confirmation Details</h2>\r\n            <p class="bb-confirmation-p-alignment">Thanks. Your booking is now confirmed. We have you emailed you the details below.</p>\r\n            <div class="pull-right hidden-print" >\r\n              <button type="button" class="btn btn-link" onclick="window.print()"><span class="glyphicon glyphicon-print"></span> Print</button>\r\n              <button type="button" class="btn btn-link" onclick="" popover="<a class=\'image img_outlook\' title=\'Add this booking to an Outlook Calendar\' href=\'http://blinkbrowbar.bookingbug.com/ical/total/UkICc5s-2yzH09PqNzE%3D\'><img alt=\'\' src=\'https://www.bookingbug.com/assets/outlook.png\'></a> <a class=\'image img_ical\' title=\'Add this booking to an iCal Calendar\' href=\'http://blinkbrowbar.bookingbug.com/ical/total/UkICc5s-2yzH09PqNzE%3D\'><img alt=\'\' src=\'https://www.bookingbug.com/assets/ical.png\'></a> <a class=\'image img_gcal\' title=\'Add this booking to Google Calendar\' href=\'http://www.google.com/calendar/event?dates=20150120T120000Z%2F20150120T123000Z&details=&location=Chair&sprop=www.bookingbug.com&text=Booking%3A+Ayurvedic+Eye+Soother+with+Romana+-+Chair+at+Bristol&trp=false&action=TEMPLATE\' target=\'_blank\'><img src=\'https://www.bookingbug.com/assets/gcal.png\' border=\'0\'></a>" popover-placement="bottom"><span class="glyphicon glyphicon-calendar"></span> Export to calendar</button>\r\n            </div>\r\n          </div>\r\n\r\n          <ul class="confirmation-summary" ng-repeat="i in purchase.items">\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Item:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.full_describe}}</div>\r\n            </li>\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Date and Time:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.describe}}</div>\r\n            </li>\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Quantity:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.quantity}}</div>\r\n            </li>\r\n            <li ng-if="i.full_describe" class="row confirmation-summary-item">\r\n              <div class="col-xs-12 col-sm-3">Booking Reference:</div>\r\n              <div class="col-xs-12 col-sm-9">{{i.id}}</div>\r\n            </li>\r\n          </ul>\r\n\r\n          <div ng-repeat="msg in messages" ng-bind-html="msg" class="bb-message">\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n</div>\r\n\r\n<footer>\r\n  <div class="powered-by hidden-print">\r\n    <p>Bookings powered by <span style="color:#087f94">booking</span><span style="color:#88c66f">bug </span></p>\r\n    <a href="http://www.bookingbug.com" style="text-decoration:none" target="_blank"></a>\r\n  </div>\r\n</footer>\r\n'),$templateCache.put("purchase.html",'<div bb-purchase="{move_route: \'calendar\'}">\r\n\r\n  <div class="bb-checkout">\r\n\r\n    <div class="row">\r\n\r\n      <div class="col-xs-offset-1 col-xs-10">\r\n\r\n        <div ng-show="purchase && bookings.length == 0">\r\n          <div class="confirmation-header">\r\n            <h2 class="confirmation-heading">Your booking has been cancelled</h2>\r\n          </div>\r\n        </div>\r\n\r\n        <div ng-show="bookings">\r\n          <div ng-show="is_waitlist">\r\n            <div bb-include="book_waitlist"></div>\r\n          </div>\r\n          <div ng-hide="is_waitlist">\r\n            <div class="confirmation-header">\r\n              <h3 class="confirmation-heading">Your <span>{{purchase.bookings[0].service_name}}</span> booking</h3>\r\n\r\n              <div class="row hidden-print text-right" >\r\n              <button type="button" class="btn btn-link" onclick="window.print()"><span class="fa fa-print"></span> Print</button>\r\n              <div bb-booking-export class="bb-booking-export"></div>\r\n              </div>\r\n            </div>\r\n\r\n\r\n            <div>\r\n              <ul class="confirmation-summary">\r\n                <li class="row confirmation-summary-item">\r\n                  <div class="bb-summary-label">Name: </div>\r\n                  <div class="bb-summary-value">{{purchase.client.name}}</div>\r\n                </li>\r\n                <li class="row confirmation-summary-item">\r\n                  <div class="bb-summary-label">Email: </div>\r\n                  <div class="bb-summary-value">{{purchase.client.email}}</div>\r\n                </li>\r\n                <li class="row confirmation-summary-item">\r\n                  <div class="bb-summary-label">Service: </div>\r\n                  <div class="bb-summary-value">{{purchase.bookings[0].service_name}}</div>\r\n                </li>\r\n                <li class="row confirmation-summary-item">\r\n                  <div class="bb-summary-label">When: </div>\r\n                  <div class="bb-summary-value">{{purchase.bookings[0].datetime | datetime: "h:mma dddd Do MMMM":false}}</div>\r\n                </li>\r\n                <li class="row confirmation-summary-item" ng-show="purchase.total_price > 0">\r\n                  <div class="bb-summary-label">Price: </div>\r\n                  <div class="bb-summary-value">{{purchase.total_price | currency }}</div>\r\n                </li>\r\n              </ul>\r\n\r\n\r\n              <div bb-address-map="purchase.bookings[0].company.address" class="view-booking-map">\r\n                <ui-gmap-google-map center=\'map.center\' zoom=\'map.zoom\' options="options">\r\n                  <ui-gmap-marker coords="marker.coords" idkey="marker.id">\r\n                  </ui-gmap-marker>\r\n                </ui-gmap-google-map>\r\n              </div>\r\n\r\n              <div class="confirmation-summary-address">\r\n                <div><span class=\'fa fa-map-marker\'></span> {{purchase.bookings[0].company.address | address_single_line}}</div>\r\n                <div> <span class=\'fa fa-phone\'></span> {{purchase.bookings[0].company.address.phone | local_phone_number}}</div>\r\n              </div>\r\n\r\n            </div>\r\n\r\n\r\n            <div class="payment">\r\n              <div bb-custom-confirmation-text class="text-block-sml bb-message-buffer" ng-show="messages">\r\n                <p ng-repeat="msg in messages" ng-bind-html="msg"></p>\r\n              </div>\r\n            </div>\r\n\r\n            <div class="hidden-print">\r\n              <div class="bb-step-navigation">\r\n                <div class=\'row\'>\r\n                  <div class="col-sm-4">\r\n                    <button type="button" class="btn btn-danger btn-block" ng-click="delete(bookings[0])">Cancel Booking</button>\r\n                  </div>\r\n                  <div class="col-sm-4">\r\n                    <button type="button" class="btn btn-primary btn-block" ng-click="move(bookings[0], \'\', {use_resource: true})">Move Booking</button>\r\n                  </div>\r\n                </div>\r\n                <div ng-show="waitlist_bookings"class="col-sm-4">\r\n                  <button type="button" class="btn btn-primary btn-block" ng-click="is_waitlist = true">Book Waitlist Items</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n\r\n        </div>\r\n\r\n       </div>\r\n\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n'),
$templateCache.put("reschedule_reasons.html",'<div bb-page>\r\n<!--   <div bb-people></div> -->\r\n  <div class="page-subheader-var">\r\n    <h1>Move Appointment </h1>\r\n  </div>\r\n  <div bb-include="_basket_item_summary_var"></div>\r\n  <div>\r\n    <p ng-show="bb.move_reasons.length > 0">\r\n      <span class="bb-summary-label3">Please select a reason for moving your appointment:</span>\r\n      <select ng-model="bb.current_item.move_reason" id="cancel_reason" class="form-control" ng-options="option.id as option.text for option in bb.move_reasons">\r\n      </select>\r\n    </p>\r\n  </div>\r\n  <div class="bb-step-navigation">\r\n    <div class="row">\r\n      <div class="col-sm-offset-8 col-sm-3 col-sm-push-1 text-right">\r\n        <button type="button" aria-label="continue button" class="btn btn-primary btn-block" ng-click="checkReady() && routeReady()" bb-debounce>\r\n          <span>Move Appointment</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("resource_list.html",'<div bb-include="_basket_item_summary">\r\n</div>\r\n\r\n  <div class="bb-subcontent">\r\n\r\n    <div bb-resources ng-init="checkStepTitle(\'Select a resource\')">\r\n      <div class="panel panel-default" ng-repeat="item in all_resources">\r\n        <div class="panel-body">\r\n          <div class="row">\r\n            <div class="col-sm-10">\r\n              <h2 class="panel-title">{{ item.name }}</h2>\r\n              <div class="row">\r\n                <div class="col-sm-2">\r\n                  <image ng-src="" class="img-responsive" />\r\n                </div>\r\n                <div class="col-sm-10">\r\n                  <!-- Description? -->\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class="col-sm-2">\r\n              <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("service_list.html",'<div bb-services ng-init="checkStepTitle(\'Select a service\')" class="bb-service-list">\r\n  <div class="bb-subcontent">\r\n\r\n    <!-- <div ng-show="items.length > 8" bb-include="_service_list_filter">\r\n    </div> -->\r\n\r\n    <div class="panel panel-default" ng-repeat="item in filtered_items | orderBy: \'order\'">\r\n      <div class="panel-body">\r\n        <div class="row" ng-class="{\'bb-vertical-align-center\': item.extra.image_url || item.description}">\r\n          <div class="col-sm-8 col-xs-6">\r\n            <h2 class="panel-title bb-service-name">{{item.name}}</h2>\r\n            <div class="row">\r\n              <div class="hidden-xs col-sm-2 bb-service-image" ng-if="item.extra.image_url">\r\n                <img ng-src="{{item.extra.image_url}}" class="img-responsive"/>\r\n              </div>\r\n              <div class="hidden-xs col-sm-10 bb-service-description" ng-if="item.description">\r\n                {{item.description}}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-sm-2 col-xs-6">\r\n            <div class="bb-service-price">\r\n              <span ng-show="item.price > 0">{{item.price | currency: bb.company.currency_code}}</span>\r\n            </div>\r\n          </div>\r\n          <div class="col-xs-12 hidden-sm hidden-md hidden-lg bbb-service-image" ng-if="item.extra.image_url">\r\n            <img ng-src="{{item.extra.image_url}}" class="img-responsive"/>\r\n          </div>\r\n          <div class="col-xs-12 hidden-sm hidden-md hidden-lg bb-service-description" ng-if="item.description">\r\n            {{item.description}}\r\n          </div>\r\n          <div class="col-sm-2 col-xs-12">\r\n            <button type="button" ng-click="selectItem(item)" class="btn btn-primary btn-block">Select</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div>\r\n      <div class="panel-body" ng-show="filtered_items && filtered_items.length == 0">\r\n        <div class="col-sm-12 ">\r\n          <div class="bb-service-unavailable">\r\n            <p>\r\n              No services match your filter criteria.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("survey.html",'<div bb-survey-questions>\r\n\r\n  <div bb-question-setup>\r\n    <div bb-question-id="text_field">\r\n      <div ng-form name="question_form">\r\n        <input type="text" ng-model="question.answer" name="{{\'q\'+question.id}}" id="{{question.id}}" ng-maxlength="250" ng-required="question.currentlyShown && (false || (question.required && !bb.isAdmin))" class="form-question form-control">\r\n      </div>\r\n    </div>\r\n    <div bb-question-id="text_area">\r\n      <div ng-form name="question_form">\r\n        <textarea ng-model="question.answer" name="{{\'q\'+question.id}}" id="{{question.id}}" ng-maxlength="1000" ng-required="question.currentlyShown && (false || (question.required && !bb.isAdmin))" class="form-question form-control"></textarea>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="bb-frame" ng-if="completed" style="margin:10% 3% 10%;">\r\n    <h2 style="text-align:center; margin:10% 3% 10%;"> Thank you for filling out the survey!</h2>\r\n  </div>\r\n\r\n  <div ng-if="purchase" ng-show="bookings[0].survey_questions">\r\n    <div ng-hide="completed">\r\n\r\n      <div class="survey-intro">\r\n      </div>\r\n\r\n\r\n\r\n      <form name="survey_form" class="form-horizontal" role="form" novalidate bb-form>\r\n\r\n        <!--         <h2 class="booking-form-header">Booking Details</h2> -->\r\n\r\n        <ul class="summary-list">\r\n          <li class="row">\r\n            <div class="col-xs-3 col-sm-2 summary-label">Session:</div>\r\n            <div class="col-xs-9 col-sm-10 summary-value"><span class="bold-small">{{bookings[0].service_name}}</span>\r\n            </div>\r\n          </li>\r\n          <li class="row">\r\n            <div class="col-xs-3 col-sm-2 summary-label">Date:</div>\r\n            <div class="col-xs-9 col-sm-10 summary-value">\r\n              <span class="bold-small">{{bookings[0].pretty_date}}</span>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n\r\n        <div ng-show="bookings[0].survey_questions && bookings[0].survey_questions.length > 0">\r\n          <h2 class="booking-form-header">Survey Questions</h2>\r\n\r\n          <div class="form-group" ng-repeat="question in bookings[0].survey_questions" bb-question-line ng-class="{\'check\': question.detail_type == \'check\', \'has-error\': survey_form[\'q\' + question.id].$invalid && (survey_form[\'q\' + question.id].$dirty || survey_form.submitted)}">\r\n            <label ng-if="question.detail_type != \'check\'" for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-if="question.required" class="text-warning">*</span>:</label>\r\n            <div ng-if="question.detail_type == \'check\'" class="col-sm-4 hidden-xs">&nbsp;</div>\r\n            <div class="col-sm-8">\r\n              <input bb-question="question" />\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class="row step-navigation">\r\n          <div class="col-sm-3 col-sm-offset-9">\r\n            <button type="submit" class="btn btn-primary" ng-click="submitSurvey(survey_form)" bb-debounce>Submit Answers</button>\r\n          </div>\r\n        </div>\r\n\r\n      </form>\r\n    </div>\r\n    <h2 ng-if="bookings[0].survey_questions.length < 1">No survey questions for this session.</h2>\r\n\r\n  </div>\r\n  <div bb-loading class="bb-loader">\r\n  <div id="loading_icon">\r\n    <div id="wait_graphic">&nbsp;</div>\r\n  </div>\r\n</div>\r\n</div>\r\n'),$templateCache.put("time.html",'<div bb-include="_basket_item_summary">\r\n</div>\r\n\r\n<div class="bb-subcontent">\r\n\r\n  <div bb-times class="bb-time">\r\n\r\n    <div class="bb-calendar-navigation">\r\n      <button type="button" class="btn btn-link pull-left" ng-click="subtract(\'days\',1)">\r\n        <span class="glyphicon glyphicon-chevron-left pull-left" aria-hidden="true"></span>\r\n        <span class="hidden-xs">Previous Day</span>\r\n      </button>\r\n      <button type="button" class="btn btn-link pull-right" ng-click="add(\'days\',1)">\r\n        <span class="glyphicon glyphicon-chevron-right pull-right" aria-hidden="true" ></span>\r\n        <span class="hidden-xs">Next Day</span>\r\n      </button>\r\n    </div>\r\n\r\n    <div>\r\n\r\n      <h2 class="bb-section-title text-center hidden-xs">{{selected_date | datetime: \'Do MMM YYYY\'}}</h2>\r\n      <h2 class="bb-section-title text-center hidden-sm hidden-md hidden-lg">{{selected_date | datetime: \'Do MMM\'}}</h2>\r\n\r\n      <div ng-show="!slots || (slots && slots.length == 0)" class="bb-service-unavailable">\r\n        <p class="text-center">\r\n          No availablity found\r\n        </p>\r\n      </div>\r\n\r\n      <div ng-if="slots">\r\n\r\n        <div accordion close-others="false">\r\n\r\n          <div bb-accordion-range-group="{heading: \'Morning\', range: [0, 720], slots: slots, collaspe_when_time_selected: true}" day="day" slots="day.slots" select-slot="highlightSlot" ng-init="setFormDataStoreId($index)" class="accordion-group">\r\n          </div>\r\n\r\n          <div bb-accordion-range-group="{heading: \'Afternoon\',range: [720, 1020], slots: slots, collaspe_when_time_selected: true}" day="day" slots="day.slots" select-slot="highlightSlot" ng-init="setFormDataStoreId($index)" class="accordion-group"></div>\r\n\r\n          <div bb-accordion-range-group="{heading: \'Evening\', range: [1020, 1440], slots: slots, collaspe_when_time_selected: true}" day="day" slots="day.slots" select-slot="highlightSlot" ng-init="setFormDataStoreId($index)" class="accordion-group"></div>\r\n\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n\r\n\r\n<div class="clearfix hidden-xs">\r\n</div>\r\n<div class="bb-step-navigation">\r\n  <div class="row">\r\n    <div class="col-sm-3">\r\n      <button type="button" class="btn btn-default" bb-debounce ng-click="loadPreviousStep()" ng-show="bb.current_step > 1">Back</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n'),$templateCache.put("_accordion_range_group.html",'<div bb-accordion-group is-open="is_open" ng-disabled="!has_availability && !is_selected" ng-class="{\'expanded\': is_open, \'selected\': is_selected}">\r\n\r\n  <div bb-accordion-heading>\r\n    <div class="accordion-header">\r\n      <div ng-hide="options.hide_availability_summary && is_selected">\r\n        <span class="period-label">\r\n          <span ng-show="has_availability && !is_open" class="period-label-icon">+</span>\r\n          <span ng-show="has_availability && is_open" class="period-label-icon">-</span>\r\n          {{heading}}\r\n        </span>\r\n        <span class="period-detail" ng-hide="is_selected || (is_open && has_availability) || options.hide_availability_summary">{{accordion_slots.length}} available</span>\r\n      </div>\r\n      <span class="period-detail selected-time" ng-show="is_selected && !is_open">{{selected_slot.time_moment | datetime: \'time\'}}</span>\r\n    </div>\r\n  </div>\r\n\r\n  <ul class="time-slots" ng-show="has_availability">\r\n    <li class="time-slot" ng-class="{\'selected\': slot.selected, \'disabled\': slot.disabled}" ng-disabled="slot.disabled" ng-click="selectSlot(slot, day)" ng-repeat="slot in accordion_slots">\r\n      <span>{{slot.time_moment | datetime: \'time\'}}</span>\r\n    </li>\r\n  </ul>\r\n\r\n</div>\r\n'),$templateCache.put("_add_recipient.html",'<form name="recipient_form" role="form" bb-form novalidate>\r\n\r\n  <div class="modal-header">\r\n    <button type="button" class="close" ng-click="cancel()">&times;</button>\r\n    <h1 class="modal-title">Recipient</h1>\r\n      Who should we send the gift voucher to?\r\n  </div>\r\n\r\n  <div class="modal-body">\r\n\r\n      <div class="radio">\r\n        <label>\r\n          <input type="radio" ng-model="recipient" ng-value="false" checked>\r\n          Me\r\n        </label>\r\n      </div>\r\n      <div class="radio">\r\n        <label>\r\n          <input type="radio" ng-model="recipient" ng-value="true">\r\n          Someone else\r\n        </label>\r\n      </div> \r\n\r\n      <div ng-if="recipient">\r\n        <div class="form-group" ng-class="{\'has-error\': recipient_form.name.$invalid && (!recipient_form.name.$pristine || recipient_form.submitted)}">\r\n          <label for="name">Name:</label>\r\n          <input type="text" name="name" id="name" required ng-model="item.recipient" class="form-control" autofocus />\r\n          <div class="messages">\r\n            <div class="error-message" ng-show="recipient_form.name.$invalid && recipient_form.submitted">\r\n              Please enter the recipients name\r\n            </div>\r\n          </div> \r\n        </div>\r\n\r\n        <div class="form-group" ng-class="{\'has-error\': recipient_form.email.$invalid && (!recipient_form.email.$pristine || recipient_form.submitted)}">\r\n          <label for="email">Email:</label>\r\n          <input type="email" name="email" id="email" required ng-model="item.recipient_mail" class="form-control" />\r\n          <div class="messages">\r\n            <div class="error-message" ng-show="recipient_form.email.$invalid && recipient_form.submitted">\r\n              Please enter the recipients email address\r\n            </div>\r\n          </div> \r\n        </div>\r\n      </div>\r\n\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button class="btn btn-primary" ng-click="addToBasket(recipient_form)">Add to Basket</button>\r\n    <button class="btn btn-secondary" ng-click="cancel()">Cancel</button>\r\n  </div>\r\n</form>'),$templateCache.put("_basket_details.html",'<div bb-basket-list class="modal-content bb-basket-mini">\r\n\r\n  <div class="modal-header">\r\n    <button type="button" class="close" ng-click="cancel()">&times;</button>\r\n    <h5 class="modal-title">Basket Details</h5>\r\n  </div>\r\n\r\n  <div class="modal-body">\r\n    <p ng-hide="bb.basket.items">No items added to basket yet.</p>\r\n    <table class="table table-bordered" ng-show="bb.basket.items">\r\n      <thead>\r\n        <tr>\r\n          <th>Item</th>\r\n          <th>Appointment</th>\r\n          <th>&nbsp;</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="item in bb.basket.items">\r\n          <td >\r\n            {{ item.service_name }}\r\n          </td>\r\n          <td>\r\n            {{ item.date.date | datetime: "ddd Do MMM"}} at {{ item.date.date | datetime: "h:mma"}} for {{ item.duration | time_period }}\r\n          </td>\r\n          <td class="text-center">\r\n            <span class="glyphicon glyphicon-trash" aria-hidden="true" ng-click="deleteBasketItem(item)"></span>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <div class="modal-footer">\r\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\r\n    <button ng-show="bb.basket.items" class="btn btn-primary" ng-click="checkout(\'basket\') && cancel()">Checkout</button>\r\n  </div>\r\n\r\n</div>\r\n'),$templateCache.put("_basket_item_summary.html",'<div class="bb-item-summary">\r\n  <div class="bb-item-summary-header">\r\n    <div class="bb-item-summary-header-text hidden-xs">\r\n      <h3><span>{{bb.current_item.service.name}}</span></h3>\r\n    </div>\r\n  </div>\r\n  <ul class="bb-item-summary-list">\r\n    <li class="visible-xs bb-confirmation-summary-item">\r\n        <div class="bb-summary-label">Service\r\n        </div>\r\n        <div class="bb-summary-value">{{bb.current_item.service.name}}\r\n        </div>\r\n    </li>\r\n    <li class="bb-confirmation-summary-item" ng-show="bb.current_item.duration">\r\n      <div class="bb-summary-label">Duration\r\n      </div>\r\n      <div class="bb-summary-value"><span>{{bb.current_item.duration | time_period}}</span>\r\n      </div>\r\n    </li>\r\n    <li class="bb-confirmation-summary-item" ng-show="bb.current_item.resource && bb.current_item.resource.name">\r\n      <div class="bb-summary-label">Resource\r\n      </div>\r\n      <div class="bb-summary-value"><span>{{bb.current_item.resource.name}}</span>\r\n      </div>\r\n    </li>\r\n    <li class="bb-confirmation-summary-item" ng-show="bb.current_item.person && bb.current_item.person.name">\r\n      <div class="bb-summary-label">Person\r\n      </div>\r\n      <div class="bb-summary-value"><span>{{bb.current_item.person.name}}</span>\r\n      </div>\r\n    </li>\r\n    <li class="bb-confirmation-summary-item" ng-show="bb.current_item.price">\r\n      <div class="bb-summary-label">Price\r\n      </div>\r\n      <div class="bb-summary-value"><span>{{bb.current_item.price | currency}}</span>\r\n      </div>\r\n    </li>\r\n    <li class="bb-confirmation-summary-item" ng-show="bb.current_item.date">\r\n      <div class="bb-summary-label">Date\r\n      </div>\r\n      <div class="bb-summary-value"><span>{{bb.current_item.startDatetime() | datetime: \'dddd D MMMM\'}}</span>\r\n      </div>\r\n    </li>\r\n    <li class="bb-confirmation-summary-item" ng-show="bb.current_item.time">\r\n      <div class="bb-summary-label">Time\r\n      </div>\r\n      <div class="bb-summary-value"><span>{{bb.current_item.startDatetime() | datetime: \'time\'}}</span>\r\n      </div>\r\n    </li>\r\n  </ul>\r\n  <div class="clearfix"></div>\r\n</div>\r\n'),$templateCache.put("_basket_mini.html",'<div class="bb-basket-mini">\r\n  <span class=\'glyphicon glyphicon-shopping-cart pull-right\' ng-class="{\'disabled-cart\': bb.current_page == \'basket\'}" ng-click="showBasketDetails()">\r\n    <span ng-if="basketItemCount" class="badge badge-notify">{{ basketItemCount }}</span>\r\n  </span>\r\n</div>'),$templateCache.put("_breadcrumb.html",'<div class="breadcrumbs-holder" ng-init="setBasicRoute([])">\r\n  <ol class="breadcrumb"> \r\n    <li ng-repeat="step in bb.allSteps" ng-class="{\'active\': step.active, \'passed\': step.passed, \'disabled\': isDisabledStep(step)}">\r\n      <button type="button" ng-click="loadStep(step.number)" ng-class="{\'active\': step.active, \'passed\': step.passed}" ng-disabled="isDisabledStep(step)">\r\n        <span class="step-num">{{step.number}}.</span>\r\n        <span class="step-title">{{step.title}}</span>\r\n      </button>\r\n    </li>\r\n  </ol>\r\n</div>\r\n\r\n\r\n'),$templateCache.put("_breadcrumb_complex.html",'<div class="breadcrumbs" ng-init="setRoute([\r\n  {page:\'service_list\', title: \'Set a Service\'},\r\n  {page:\'person_list\', title: \'Pick a Person\'},\r\n  {page:\'day\', title: \'Select a Date\'}\r\n  ])">\r\n\r\n<!--   <div class="row">\r\n    <tabset>\r\n      <tab ng-repeat="step in allSteps" heading="{{step.title}}" active="step.active" disabled="!step.passed" select="loadStep(step.number)">\r\n      </tab>\r\n    </tabset>\r\n\r\n    <div class="breadcrumbs">\r\n      <span ng-repeat="step in steps">\r\n        <a ng-if="!$last" href="" ng-click="loadStep(step.number)" class="btn default med flat">  {{step.number}}.\r\n        </a>\r\n        <div ng-if="$last" class="step">{{step.number}}. {{step.title}}</div>\r\n      <span>\r\n    </div>\r\n  </div> -->\r\n\r\n  <ol class="breadcrumb"> \r\n    <li ng-repeat="step in bb.allSteps" ng-class="{\'active\': step.active, \'passed\': step.passed, \'disabled\': isDisabledStep(step)}">\r\n      <button type="button" ng-click="loadStep(step.number)" ng-class="{\'active\': step.active, \'passed\': step.passed}" ng-disabled="isDisabledStep(step)">\r\n        <span class="step-num">{{step.number}}.</span>\r\n        <span class="step-title">{{step.title}}</span>\r\n      </button>\r\n    </li>\r\n  </ol>\r\n  \r\n</div>'),$templateCache.put("_cancel_modal.html",'<div class="modal-header">\r\n  <button type="button" class="close" ng-click="cancel()">&times;</button>\r\n  <h1 class="modal-title">Are you sure you want to cancel this booking?</h1>\r\n</div>\r\n\r\n<div class="modal-body">\r\n\r\n  <ul class="confirmation-summary">\r\n    <li class="row confirmation-summary-item">\r\n      <div class="col-xs-3">Service</div>\r\n      <div class="col-xs-9">{{booking.service_name}}</div>\r\n    </li>\r\n    <li class="row confirmation-summary-item">\r\n      <div class="col-xs-3">When</div>\r\n      <div class="col-xs-9">{{booking.datetime | datetime: "h:mma dddd Do MMMM"}}</div>\r\n    </li>\r\n  </ul>\r\n\r\n</div>\r\n\r\n<div class="modal-footer">\r\n  <button class="btn btn-primary" ng-click="confirmDelete()"><span>Cancel Booking</span></button>\r\n  <button class="btn btn-link" ng-click="cancel()">Do not cancel</button>\r\n</div>\r\n'),$templateCache.put("_error_modal.html",'<div class="modal-content">\r\n  <div class="modal-header">\r\n  </div>\r\n  <div class="modal-body text-center">\r\n    <p>{{message}}</p>\r\n  </div>\r\n  <div class="modal-footer">\r\n    <button type="button" class="btn btn-primary" ng-click="ok()"><span>OK</span></button>\r\n  </div>\r\n</div>\r\n'),$templateCache.put("_member_form.html",'<form name="memberForm" ng-submit="submit(memberForm, member)" ng-hide="loading">\r\n\r\n\t<div class="form-group" ng-class="{\'has-error\': memberForm.first_name.$invalid && !memberForm.first_name.$pristine, \'has-success\': memberForm.first_name.$valid}">\r\n\t\t<label class="control-label" for="first_name">First Name</label>\r\n\t\t<input type="text" class="form-control" name="first_name" id="first_name" ng-model="member.first_name" required />\r\n\t</div>\r\n\r\n\t<div class="form-group" ng-class="{\'has-error\': memberForm.last_name.$invalid && !memberForm.last_name.$pristine, \'has-success\': memberForm.last_name.$valid}">\r\n\t\t<label class="control-label" for="last_name">Last Name</label>\r\n\t\t<input type="text" class="form-control" name="last_name" id="last_name" ng-model="member.last_name" required />\r\n\t</div>\r\n\r\n\t<div class="form-group" ng-class="{\'has-error\': memberForm.email.$invalid && !memberForm.email.$pristine, \'has-success\': memberForm.email.$valid}">\r\n\t\t<label class="control-label" for="email">Email</label>\r\n\t\t<input type="email" class="form-control" name="email" id="email" ng-model="member.email"  required />\r\n\t</div>\r\n\r\n\t<div class="form-group" ng-class="{\'has-error\': memberForm.phone.$invalid && !memberForm.phone.$pristine, \'has-success\': memberForm.phone.$valid}">\r\n\t\t<label class="control-label" for="phone">Phone</label>\r\n\t\t<input type="text" class="form-control" name="phone" id="phone" ng-model="member.phone" />\r\n\t</div>\r\n\r\n\t<div class="form-group" ng-class="{\'has-error\': memberForm.mobile.$invalid && !memberForm.mobile.$pristine, \'has-success\': memberForm.mobile.$valid && !memberForm.mobile.$pristine}">\r\n\t\t<label class="control-label" for="mobile">Mobile</label>\r\n\t\t<input type="text" class="form-control" name="mobile" id="mobile" ng-model="member.mobile" />\r\n\t</div>\r\n\r\n\t<div ng-repeat="question in member.questions" class="form-group" ng-class="{\'has-error\': memberForm[\'q\' + question.id].$invalid && !memberForm[\'q\' + question.id].$pristine, \'has-success\': memberForm[\'q\' + question.id].$valid}">\r\n\t\t<label class="control-label" for="{{question.id}}">{{question.name}}</label>\r\n\t\t<input class="form-control" bb-question="question" />\r\n\t</div>\r\n\r\n\t<div class="form-group">\r\n\t\t<input type="submit" class="btn btn-primary" value="Save" />\r\n\t</div>\r\n\r\n</form>\r\n'),$templateCache.put("_member_login_form.html",'<form name="login_form" ng-submit="validator.validateForm(login_form) && submit()" class="form-horizontal" role="form" bb-form novalidate>\r\n\r\n    <div class="form-group" ng-class="{\'has-error\': login_form.email.$invalid && (!login_form.email.$pristine || login_form.submitted)}">\r\n      <label for="email" class="control-label col-sm-4">Email:</label>\r\n      <div class="col-sm-5">\r\n        <input type="text" name="email" id="email" required ng-model="login.email" class="form-control" ng-pattern="validator.getEmailPattern()" />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="login_form.email.$error.required && login_form.submitted">\r\n          Please enter your email\r\n        </div>\r\n        <div class="error-message" ng-show="login_form.email.$error.pattern && login_form.submitted">\r\n          Please enter a valid email\r\n        </div>\r\n      </div> \r\n    </div>\r\n  \r\n    <div class="form-group" ng-class="{\'has-error\': login_form.password.$invalid && (!login_form.password.$pristine || login_form.submitted)}">\r\n      <label for="password" class="control-label col-sm-4">Password:</label>\r\n      <div class="col-sm-5">\r\n        <input type="password" name="password" id="password" required ng-model="login.password" class="form-control"  />\r\n      </div>\r\n      <div class="col-sm-offset-4 messages">\r\n        <div class="error-message" ng-show="login_form.password.$invalid && login_form.submitted">\r\n          Please enter your password\r\n        </div>\r\n      </div> \r\n    </div>\r\n\r\n    <div class="form-group">\r\n      <div class="col-sm-offset-4 col-sm-5">\r\n        <div class="checkbox">\r\n          <label>\r\n            <input type="checkbox" ng-model="login.persist_login"> Remember me\r\n          </label>\r\n        </div>\r\n      </div> \r\n    </div>\r\n\r\n    <div class="form-group">\r\n      <div class="col-sm-offset-4 col-sm-5">\r\n        <button type="submit" class="btn btn-primary btn-block">Login</button>\r\n      </div>\r\n    </div>\r\n\r\n</form>\r\n'),$templateCache.put("_member_login_schema_form.html",'<form name="login_form" ng-submit="submit(login_form)" sf-schema="schema"\r\nsf-form="form" sf-model="login_form" sf-options="{feedback: false}"\r\nng-if="schema && form"></form>'),$templateCache.put("_member_schema_form.html",'<form sf-schema="schema" name="memberForm" sf-form="form" sf-model="member" \r\nng-submit="submit(memberForm, member)" ng-hide="loading"></form>\r\n'),$templateCache.put("_month_picker.html",'<div class="bb-month-picker">\r\n  <div class="bb-month-nav-prev hidden-xs">\r\n    <button type="button" class="btn btn-icon btn-xl month-prev">\r\n      <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> <span class="sr-only">Previous</span>\r\n    </button>\r\n  </div>\r\n  <div class="bb-months">\r\n    <div slick data="months" ng-if="months" settings="slick_config">\r\n\r\n      <div class="bb-month" ng-repeat="month in months" ng-class="{\'hidden-xs\': month.selected}">\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <div class="row">\r\n                <div class="bb-month-nav-prev col-xs-4 visible-xs" style="text-align: right;">\r\n                  <button type="button" class="btn btn-icon month-prev">\r\n                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> \r\n                    <span class="sr-only">Previous</span>\r\n                  </button>\r\n                </div>\r\n                <div class="months text-center col-xs-4 visible-xs"><b>\r\n                  {{month.start_date.format("MMMM")}}</b>\r\n                </div>\r\n                <div class="months text-center hidden-xs"><b>\r\n                  {{month.start_date.format("MMMM")}}</b>\r\n                </div>\r\n                <div class="bb-month-nav-next col-xs-4 visible-xs">\r\n                  <button type="button" class="btn btn-icon month-next">\r\n                    <span class="sr-only">Next</span> \r\n                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </tr>\r\n            <tr>\r\n              <th ng-repeat="day in month.weeks[0].days" class="days">{{day.date | datetime: "ddd" : false}}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr ng-repeat="week in month.weeks">\r\n              <td ng-repeat="day in week.days" \r\n                ng-class="{\'available\': day.available, \r\n                           \'selected\': day.selected,\r\n                           \'today\': day.today,\r\n                           \'past\': day.past,\r\n                           \'disabled\': day.disabled\r\n                          }" \r\n                  ng-click="toggleDay(day)"\r\n                  ng-disabled="day.disabled || day.past">\r\n                <div class="circle">{{day.date.date()}}</div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n  <div class="bb-month-nav-next hidden-xs" style="text-align:left;">\r\n    <button type="button" class="btn btn-icon btn-xl month-next">\r\n      <span class="sr-only">Next</span> \r\n      <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\r\n    </button>\r\n  </div>\r\n</div>'),$templateCache.put("_popout_export_booking.html",'<button type="button" class="btn btn-link" popover="{{html}}" popover-placement="bottom"><span class="fa fa-calendar-o"></span> Export<span class=\'hidden-xs\'> to calendar</span></button>\r\n'),$templateCache.put("_price_filter.html",'<div>\r\n  <label class="sr-only" for="price">Price</label>\r\n  <input name="price" id="price" range-slider min="price_options.min" max="price_options.max" model-min="filters.price.min" model-max="filters.price.max">\r\n  </input>\r\n</div>'),$templateCache.put("_service_list_filter.html",'<div class="bb-filters">\r\n\r\n  <div accordion close-others="true">\r\n    <div accordion-group is-open="is_open" ng-class="{\'expanded\': is_open, \'selected\': is_selected}" class="store-body">\r\n\r\n      <div accordion-heading class="filter-header">\r\n        <span>Filter</span>\r\n        <span class="glyphicon glyphicon-filter" aria-hidden="true"></span>\r\n      </div>\r\n\r\n      <form class="form-inline">\r\n\r\n        <div ng-if="all_categories"class="form-group">\r\n          <label class="sr-only" >Category</label>\r\n          <select class="form-control" type="text" name="category" id="category" ng-model="filters.category_name" ng-options="item.name for item in all_categories" ng-change="filterChanged()">\r\n            <option  value="">Any category</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class="form-group">\r\n          <label class="sr-only">Service</label>\r\n          <input class="form-control" type="text" ng-model="filters.service_name" ng-change="filterChanged()" placeholder="service name"/>\r\n        </div>\r\n\r\n        <div class="form-group">\r\n          <div bb-price-filter></div>\r\n        </div>\r\n\r\n        <div class="form-group">\r\n          <button type="button" class="btn btn-link" ng-click="resetFilters()">\r\n            <span class="glyphicon glyphicon-repeat" aria-hidden="true"></span>\r\n            Reset\r\n          </button>\r\n        </div>\r\n\r\n      </form>\r\n\r\n    </div>\r\n  </div>\r\n\r\n</div>'),$templateCache.put("_week_calendar.html",'<div>\r\n\r\n  <div class="alert alert-info" bb-time-zone ng-show="is_time_zone_diff">\r\n    All times are shown in {{time_zone_name}}.\r\n  </div>\r\n\r\n  <div class="alert alert-info" ng-show="no_slots_in_week"><i class="fa fa-info-circle" aria-hidden="true"></i> Looks like there\'s no availability for the next {{time_range_length}} day<span ng-show="time_range_length > 1">s</span>.\r\n  <button type="button" class="btn btn-default" ng-click="showFirstAvailableDay()">Jump to Next Available Day</button>\r\n  </div>\r\n\r\n  <div class="month-header hidden-xs">\r\n    <h2 class="month-heading">{{pretty_month_title(\'MMMM\', \'YYYY\')}}</h2>\r\n  </div>\r\n\r\n\r\n  <!-- /\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/ -->\r\n  <!-- ANGULAR-UI DATEPICKERS  -->\r\n  <!-- /\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/ -->\r\n\r\n  <!-- =============================== -->\r\n  <!-- DATEPICKER TYPE [1]             -->\r\n  <!-- function: selectedDateChanged() -->\r\n  <!-- accepts user input?: YES        -->\r\n  <!-- =============================== -->\r\n  <!--   <div class="date-select text-block visible-xs">\r\n    <div class="input-group date-picker">\r\n      <input type="text" ng-model="selected_date" class="form-control"\r\n        bb-datepicker-popup="DD/MM/YYYY"\r\n        on-date-change="selectedDateChanged()"\r\n        datepicker-popup="dd/MM/yyyy"\r\n        is-open="opened"\r\n        min-date="today"\r\n        datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n        show-weeks="false"\r\n        show-button-bar="false"\r\n        ng-readonly="false"/>\r\n      <span class="input-group-btn" ng-click="$event.preventDefault(); $event.stopPropagation(); opened=!opened;">\r\n        <button class="btn btn-default" type="submit" title="Select date"><span class="fa fa-calendar-o"></span></button>\r\n      </span>\r\n    </div>\r\n  </div> -->\r\n\r\n   <!-- =============================== -->\r\n   <!-- DATEPICKER TYPE [2]             -->\r\n   <!-- function: selectedDateChanged() -->\r\n   <!-- accepts user input?: NO         -->\r\n   <!-- =============================== -->\r\n   <div class="visible-xs" class="form-group">\r\n      <label class="sr-only" for="date">Date</label>\r\n      <div class="input-group date-picker">\r\n        <!-- date format: http://docs.angularjs.org/api/ng.filter:date" -->\r\n        <input type="text" ng-model="selected_date" class="form-control"\r\n          bb-datepicker-popup="DD/MM/YYYY"\r\n          datepicker-popup="dd/MM/yyyy"\r\n          is-open="opened"\r\n          min-date="today"\r\n          on-date-change="selectedDateChanged()"\r\n          datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n          show-weeks="false"\r\n          show-button-bar="false"\r\n          ng-readonly="true"\r\n          name="date"\r\n          id="date"\r\n          placeholder="&mdash; Any Date &mdash;"/>\r\n        <span class="input-group-btn" ng-click="$event.preventDefault(); $event.stopPropagation(); opened=!opened;">\r\n          <button class="btn btn-default" type="submit" title="Pick date">\r\n            <span class="fa fa-calendar-o"></span>\r\n          </button>\r\n        </span>\r\n      </div>\r\n    </div>\r\n\r\n   <!-- ============================= -->\r\n   <!-- DATEPICKER TYPE [3]           -->\r\n   <!-- function: filterDateChanged() -->\r\n   <!-- accepts user input?: NO       -->\r\n   <!-- ============================= -->\r\n   <!--  <div class="form-group">\r\n      <label class="sr-only" for="date">Date</label>\r\n      <div class="input-group date-picker">\r\n        <input type="text" ng-model="filters.date" class="form-control"\r\n          bb-datepicker-popup="DD/MM/YYYY"\r\n          datepicker-popup="dd/MM/yyyy"\r\n          is-open="opened"\r\n          min-date="today"\r\n          on-date-change="filterDateChanged()"\r\n          datepicker-options="{\'starting-day\': 1, \'show-button-bar\': false}"\r\n          show-weeks="false"\r\n          show-button-bar="false"\r\n          ng-readonly="true"\r\n          name="date"\r\n          id="date"\r\n          placeholder="&mdash; Any Date &mdash;"/>\r\n        <span class="input-group-btn" ng-click="$event.preventDefault(); $event.stopPropagation(); opened=!opened;">\r\n          <button class="btn btn-default" type="submit" title="Pick date">\r\n            <span class="fa fa-calendar-o"></span>\r\n          </button>\r\n        </span>\r\n      </div>\r\n    </div> -->\r\n\r\n  <!-- /\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/ -->\r\n  <!-- end ANGULAR-UI DATEPICKERS  -->\r\n  <!-- /\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/ -->\r\n\r\n  <div class="cal-custom">\r\n    <ul class="week row" ng-show="days">\r\n\r\n      <li class="day navigation hidden-xs">\r\n        <button type="button" class="btn btn-icon visible-sm" ng-click="subtract(\'days\', 3)" ng-disabled="!is_subtract_valid || !isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-left"></span>\r\n        </button>\r\n        <button type="button" class="btn btn-icon visible-md" ng-click="subtract(\'days\', 5)" ng-disabled="!is_subtract_valid || !isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-left"></span>\r\n        </button>\r\n        <button type="button" class="btn btn-icon visible-lg" ng-click="subtract(\'days\', 7)" ng-disabled="!is_subtract_valid || !isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-left"></span>\r\n        </button>\r\n        <span ng-show="!is_subtract_valid || !isLoaded">&nbsp;</span>\r\n      </li>\r\n\r\n      <li class="day cal-col-{{$index + 1}}" ng-repeat="day in days" ng-class="{\'past\': day.date.isBefore(moment(),\'day\')}">\r\n        <div class="day-header row">\r\n          <span class="col-xs-2 previous visible-xs">\r\n            <button type="button" class="btn btn-icon" ng-click="subtract(\'days\', 1)" ng-disabled="day.date.isSame(moment(),\'day\') || !isLoaded">\r\n              <span class="glyphicon glyphicon-chevron-left"></span>\r\n            </button>\r\n          </span>\r\n          <h3 class="day-heading col-xs-8 col-sm-12">\r\n            <span class="visible-xs">{{day.date | datetime: "ddd"}} <strong>{{day.date | datetime: "D"}} </strong>{{day.date | datetime: "MMM"}}</span>\r\n            <span class="hidden-xs">{{day.date | datetime: "ddd"}} <strong>{{day.date | datetime: "D"}} </strong></span>\r\n          </h3>\r\n          <span class="col-xs-2 next visible-xs">\r\n            <button type="button" class="btn btn-icon visible-xs pull-right" ng-click="add(\'days\', 1)" ng-disabled="!isLoaded">\r\n              <span class="glyphicon glyphicon-chevron-right"></span>\r\n            </button>\r\n          </span>\r\n        </div>\r\n\r\n        <div class="times">\r\n\r\n          <!-- if time list has slots -->\r\n          <div accordion close-others="false">\r\n\r\n            <div bb-accordion-range-group="{heading: \'Morning\', range: [0, 720], collaspe_when_time_selected: true}" day="day" slots="day.slots" select-slot="highlightSlot" ng-init="setFormDataStoreId($index)" class="accordion-group">\r\n            </div>\r\n\r\n            <div bb-accordion-range-group="{heading: \'Afternoon\', range: [720, 1020], collaspe_when_time_selected: true}" day="day" slots="day.slots" select-slot="highlightSlot" ng-init="setFormDataStoreId($index)" class="accordion-group">\r\n            </div>\r\n\r\n            <div bb-accordion-range-group="{heading: \'Evening\', range: [1020, 1440], collaspe_when_time_selected: true}" day="day" slots="day.slots" select-slot="highlightSlot" ng-init="setFormDataStoreId($index)" class="accordion-group">\r\n            </div>\r\n\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </li>\r\n\r\n      <li class="day navigation hidden-xs">\r\n        <button type="button" class="btn btn-icon visible-sm" ng-click="add(\'days\', 3)" ng-disabled="!isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-right"></span>\r\n        </button>\r\n        <button type="button" class="btn btn-icon visible-md" ng-click="add(\'days\', 5)" ng-disabled="!isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-right"></span>\r\n        </button>\r\n        <button type="button" class="btn btn-icon visible-lg" ng-click="add(\'days\', 7)" ng-disabled="!isLoaded">\r\n          <span class="glyphicon glyphicon-chevron-right"></span>\r\n        </button>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n');
}]);