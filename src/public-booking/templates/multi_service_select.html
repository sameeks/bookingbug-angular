<div bb-page>
<div bb-services class="bb-service-list">
  <div bb-multi-service-select class="section">

    <div class="section">
      <div ng-show="categories">
        <div bb-include="_category_filter"></div>
      </div>
  
    <!-- If there are no categories configured we should just show all services -->
    <div bb-scroll-to="multi_service_select:categoryChanged" bb-always-scroll>
      <div ng-show="services">
        <div class="section-heading">
        </div>
          <div class="panel">
            <div class="panel-body hidden-xs row">
              <div class="col-sm-6">Service</div>
              <div class="col-sm-2">Duration</div>
              <div class="col-sm-2">Price</div>
              <div class="col-sm-2"></div>
            </div>
          </div>

        <div ng-repeat="service in services">
          <div class="bb-list-item row">
            <div class="col-sm-6">
              <h4>{{service.name}}</h4>
            </div>
            <div class="col-sm-3">
              <span class="visible-xs">Duration: </span>
              <div ng-show="service.durations.length == 1">{{service.listed_duration | time_period}}</div>
              <select 
                class="form-control" 
                ng-show="service.durations.length > 1" 
                ng-model="service.duration" 
                ng-options="duration as (duration | time_period) for duration in service.durations"
                ng-change="selectDuration(service, service.duration)">
                <option value="">{{duration}}</option>
              </select>
            </div>
            <div class="col-xs-12 col-sm-1">
              <span class="visible-xs">Price: </span>{{service.price | icurrency}}
            </div>
            <div class="col-sm-2">
              <button type="button" class="btn btn-block btn-default" ng-if="!service.selected" ng-click="addItem(service, duration)">Add</button>
              <button type="button" class="btn btn-block btn-default" ng-if="service.selected"  ng-click="removeItem(service)">Remove</button>
            </div>
            <div ng-show="item.description">
              <span class="bb-btn bb-btn-link" ng-hide="service.show_more" ng-click="service.show_more = true">
                More
                <i class="fa fa-chevron-down" aria-hidden="true"></i>
              </span>
              <span class="bb-btn bb-btn-link" ng-show="service.show_more" ng-click="service.show_more = false">
                Less
                <i class="fa fa-chevron-up" aria-hidden="true"></i>
              </span>
            </div>
            <div class="item-description col-sm-12">
              <p ng-show="item.show_more">{{service.description}}</p>
            </div>
          </div>
        </div>
      </div>


    <div ng-show="bb.stacked_items.length > 0" class="service-list-selected">
      <div class="section-heading">
        <h2 class="section-title">Your Services</h2>
      </div>

      <div ng-show="bb.stacked_items.length > 0">
        <div class="text-block text-center">
          <p>Below is the sequence of services you have selected:</p>
        </div>

        <div class="row">
          <div class="col-sm-offset-2 col-sm-8">
            <ul>
              <li ng-repeat="item in bb.stacked_items" class="row">
                <div class="col-xs-5">{{item.service.name}}</div>
                <div class="col-xs-3">{{item.service.listed_duration | time_period}}</div>
                <div class="col-xs-2">{{item.service.price | icurrency }}</div>
                <div class="col-xs-2">

                  <button 
                    type="button" 
                    class="btn btn-link" 
                    ng-click="removeItem(item.service)">
                    <span>Remove</span>
                  </button>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="bb-step-navigation">
      <div class="row">
        <div ng-show="bb.stacked_items.length > 0" class="col-sm-9 col-sm-push-3 text-right">
          <button 
            type="button" 
            class="btn btn-primary" 
            ng-click="checkReady() && routeReady()">
            Continue
          </button>
        </div>

        <div class="col-sm-3 col-sm-pull-9">
          <button 
            ng-show="bb.current_step > 1"
            type="button" 
            class="btn btn-default" 
            bb-debounce 
            ng-click="loadPreviousStep()">
            Back
          </button>
        </div>
      </div>
    </div>
  </div>
</div>